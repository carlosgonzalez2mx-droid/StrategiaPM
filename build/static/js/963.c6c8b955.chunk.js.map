{"version":3,"file":"static/js/963.c6c8b955.chunk.js","mappings":"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","sources":["components/ProjectArchive.js","utils/notificationHelpers.js","components/PortfolioDashboard.js","components/ResourceList.js","components/WeeklyPlanningTab.js","hooks/useNotifications.js","components/notifications/NotificationItem.jsx","components/notifications/NotificationPanel.jsx","components/notifications/NotificationBadge.jsx","components/subscription/SubscriptionBadge.js","components/subscription/UsageIndicator.js","components/PortfolioStrategic.js"],"sourcesContent":["import React, { useState, useMemo } from 'react';\nimport useFileStorage from '../hooks/useFileStorage';\n\nconst ProjectArchive = ({ \n  project, \n  workPackages, \n  risks, \n  tasks, \n  purchaseOrders, \n  advances, \n  invoices, \n  contracts,\n  resourceAssignments,\n  onArchiveProject \n}) => {\n  const [isGenerating, setIsGenerating] = useState(false);\n  const [archiveProgress, setArchiveProgress] = useState(0);\n\n  // Obtener audit log del proyecto\n  const getProjectAuditLog = () => {\n    if (!project) return [];\n    try {\n      const savedLog = localStorage.getItem(`audit-log-${project.id}`);\n      return savedLog ? JSON.parse(savedLog) : [];\n    } catch (error) {\n      console.error('Error loading audit log:', error);\n      return [];\n    }\n  };\n\n  const auditLog = getProjectAuditLog();\n\n  // Obtener archivos del proyecto\n  const { files: projectFiles, getFileStats } = useFileStorage(project?.id);\n  const fileStats = getFileStats();\n\n  // Calcular mtricas finales del proyecto\n  const finalMetrics = useMemo(() => {\n    if (!project) return {};\n\n    const totalWorkPackages = workPackages.length;\n    const completedWorkPackages = workPackages.filter(wp => wp.status === 'completed').length;\n    const totalBudget = workPackages.reduce((sum, wp) => sum + (wp.budget || 0), 0);\n    const totalEarned = workPackages.reduce((sum, wp) => sum + (wp.earnedValue || 0), 0);\n    const totalActual = workPackages.reduce((sum, wp) => sum + (wp.actualCost || 0), 0);\n\n    const completionPercentage = totalWorkPackages > 0 ? (completedWorkPackages / totalWorkPackages) * 100 : 0;\n    const budgetUtilization = totalBudget > 0 ? (totalActual / totalBudget) * 100 : 0;\n    const cpi = totalActual > 0 ? totalEarned / totalActual : 1;\n\n    return {\n      totalWorkPackages,\n      completedWorkPackages,\n      completionPercentage,\n      totalBudget,\n      totalEarned,\n      totalActual,\n      budgetUtilization,\n      cpi,\n      totalRisks: risks.length,\n      activeRisks: risks.filter(r => r.status === 'active').length,\n      totalTasks: tasks.length,\n      completedTasks: tasks.filter(t => t.status === 'completed').length,\n      totalFinancialItems: purchaseOrders.length + advances.length + invoices.length + contracts.length,\n      totalResourceAssignments: resourceAssignments.length,\n      totalAuditEvents: auditLog.length,\n      totalFiles: projectFiles.length,\n      totalFileSize: fileStats.totalSizeMB\n    };\n      }, [project, workPackages, risks, tasks, purchaseOrders, advances, invoices, contracts, resourceAssignments, auditLog, projectFiles, fileStats]);\n\n  // Validar que el proyecto est listo para archivado\n  const canArchive = useMemo(() => {\n    if (!project) return false;\n    \n    // El proyecto debe estar completado\n    if (project.status !== 'completed') return false;\n    \n    // Debe tener al menos 90% de completitud\n    if (finalMetrics.completionPercentage < 90) return false;\n    \n    // Debe tener al menos algunos work packages\n    if (finalMetrics.totalWorkPackages === 0) return false;\n    \n    return true;\n  }, [project, finalMetrics]);\n\n  // Generar expediente del proyecto\n  const generateProjectArchive = async () => {\n    if (!canArchive) return;\n\n    setIsGenerating(true);\n    setArchiveProgress(0);\n\n    try {\n      // Simular progreso de generacin\n      const steps = [\n        'Validando datos del proyecto...',\n        'Generando mtricas finales...',\n        'Compilando documentacin...',\n        'Creando expediente...',\n        'Finalizando archivado...'\n      ];\n\n      for (let i = 0; i < steps.length; i++) {\n        setArchiveProgress((i / steps.length) * 100);\n        await new Promise(resolve => setTimeout(resolve, 500));\n      }\n\n      // Crear objeto del expediente\n      const projectArchive = {\n        metadata: {\n          archiveDate: new Date().toISOString(),\n          archiveVersion: '1.0.0',\n          projectId: project.id,\n          projectName: project.name,\n          archiveType: 'project-completion'\n        },\n        project: {\n          ...project,\n          archivedAt: new Date().toISOString(),\n          finalMetrics: finalMetrics\n        },\n        workPackages,\n        risks,\n        tasks,\n        financial: {\n          purchaseOrders,\n          advances,\n          invoices,\n          contracts\n        },\n        resources: resourceAssignments,\n        auditLog,\n        files: projectFiles,\n        summary: {\n          totalDuration: Math.round((new Date(project.endDate) - new Date(project.startDate)) / (1000 * 60 * 60 * 24)),\n          finalBudget: finalMetrics.totalBudget,\n          finalCost: finalMetrics.totalActual,\n          completionRate: finalMetrics.completionPercentage,\n          performanceIndex: finalMetrics.cpi,\n          lessonsLearned: generateLessonsLearned()\n        }\n      };\n\n      // Exportar expediente\n      const dataStr = JSON.stringify(projectArchive, null, 2);\n      const dataBlob = new Blob([dataStr], { type: 'application/json' });\n      \n      const url = URL.createObjectURL(dataBlob);\n      const link = document.createElement('a');\n      link.href = url;\n      link.download = `expediente-${project.name.replace(/[^a-zA-Z0-9]/g, '-')}-${new Date().toISOString().split('T')[0]}.json`;\n      link.click();\n      URL.revokeObjectURL(url);\n\n      setArchiveProgress(100);\n      \n      // Llamar funcin de archivado\n      if (onArchiveProject) {\n        onArchiveProject(project.id, projectArchive);\n      }\n\n    } catch (error) {\n      console.error('Error generando expediente:', error);\n    } finally {\n      setIsGenerating(false);\n    }\n  };\n\n  // Generar lecciones aprendidas basadas en mtricas\n  const generateLessonsLearned = () => {\n    const lessons = [];\n    \n    if (finalMetrics.cpi < 0.9) {\n      lessons.push('El proyecto tuvo sobrecostos significativos. Revisar estimaciones de costos para futuros proyectos similares.');\n    }\n    \n    if (finalMetrics.completionPercentage < 95) {\n      lessons.push('Algunos entregables no se completaron al 100%. Mejorar el seguimiento de work packages.');\n    }\n    \n    if (finalMetrics.activeRisks > 0) {\n      lessons.push('Quedaron riesgos activos al finalizar. Implementar mejor gestin de riesgos desde el inicio.');\n    }\n    \n    if (finalMetrics.totalAuditEvents > 100) {\n      lessons.push('El proyecto tuvo muchos cambios. Implementar mejor control de cambios.');\n    }\n    \n    if (lessons.length === 0) {\n      lessons.push('El proyecto se ejecut exitosamente. Replicar buenas prcticas en futuros proyectos.');\n    }\n    \n    return lessons;\n  };\n\n  if (!project) {\n    return (\n      <div className=\"text-center py-12 text-gray-500\">\n        <div className=\"text-4xl mb-4\"></div>\n        <div className=\"text-lg mb-2\">Selecciona un proyecto para generar su expediente</div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"bg-gradient-to-r from-purple-50 to-indigo-100 rounded-2xl shadow-lg p-6 text-gray-800 relative overflow-hidden\">\n        {/* Elementos decorativos de fondo */}\n        <div className=\"absolute top-0 right-0 w-32 h-32 bg-purple-100/30 rounded-full -translate-y-16 translate-x-16\"></div>\n        <div className=\"absolute bottom-0 left-0 w-24 h-24 bg-indigo-100/30 rounded-full translate-y-12 -translate-x-12\"></div>\n        \n        <div className=\"relative z-10\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center\">\n              <div className=\"bg-white/60 backdrop-blur rounded-2xl p-3 mr-4 shadow-sm\">\n                <span className=\"text-3xl\"></span>\n              </div>\n              <div>\n                <h1 className=\"text-4xl font-bold mb-2 text-gray-800\">Archivado de Proyecto</h1>\n                <p className=\"text-gray-600 text-lg\">\n                  Generar expediente completo y archivar \"{project.name}\"\n                </p>\n              </div>\n            </div>\n            <div className=\"text-right\">\n              <div className=\"text-4xl font-bold text-gray-800\">\n                {finalMetrics.completionPercentage.toFixed(1)}%\n              </div>\n              <div className=\"text-gray-600\">Completitud</div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Estado del Proyecto */}\n      <div className=\"bg-white rounded-lg shadow-sm p-6\">\n        <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">Estado del Proyecto</h3>\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          <div>\n            <div className=\"text-sm text-gray-600 mb-1\">Estado Actual</div>\n            <div className=\"flex items-center space-x-2\">\n              <span className={`px-2 py-1 rounded-full text-xs font-medium border ${getStatusColor(project.status)}`}>\n                {getStatusIcon(project.status)} {project.status}\n              </span>\n            </div>\n          </div>\n          <div>\n            <div className=\"text-sm text-gray-600 mb-1\">Manager</div>\n            <div className=\"font-medium\">{project.manager}</div>\n          </div>\n          <div>\n            <div className=\"text-sm text-gray-600 mb-1\">Presupuesto Original</div>\n            <div className=\"font-medium\">${(project.budget / 1000).toFixed(0)}K USD</div>\n          </div>\n          <div>\n            <div className=\"text-sm text-gray-600 mb-1\">Perodo</div>\n            <div className=\"font-medium\">{project.startDate} - {project.endDate}</div>\n          </div>\n        </div>\n      </div>\n\n      {/* Mtricas Finales */}\n      <div className=\"bg-white rounded-lg shadow-sm p-6\">\n        <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">Mtricas Finales</h3>\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n          <div className=\"text-center p-4 bg-blue-50 rounded-lg\">\n            <div className=\"text-2xl font-bold text-blue-600\">{finalMetrics.totalWorkPackages}</div>\n            <div className=\"text-sm text-gray-600\">Work Packages</div>\n            <div className=\"text-xs text-gray-500\">{finalMetrics.completedWorkPackages} completados</div>\n          </div>\n          <div className=\"text-center p-4 bg-green-50 rounded-lg\">\n            <div className=\"text-2xl font-bold text-green-600\">${(finalMetrics.totalBudget / 1000).toFixed(0)}K</div>\n            <div className=\"text-sm text-gray-600\">Presupuesto Total</div>\n            <div className=\"text-xs text-gray-500\">${(finalMetrics.totalActual / 1000).toFixed(0)}K gastado</div>\n          </div>\n          <div className=\"text-center p-4 bg-purple-50 rounded-lg\">\n            <div className=\"text-2xl font-bold text-purple-600\">{finalMetrics.totalAuditEvents}</div>\n            <div className=\"text-sm text-gray-600\">Eventos de Auditora</div>\n            <div className=\"text-xs text-gray-500\">Registros completos</div>\n          </div>\n        </div>\n      </div>\n\n      {/* Informacin del Audit Log */}\n      {auditLog.length > 0 && (\n        <div className=\"bg-white rounded-lg shadow-sm p-6\">\n          <h3 className=\"text-lg font-semibold text-gray-800 mb-4\"> Registro de Auditora</h3>\n          <div className=\"space-y-3\">\n            <div className=\"flex items-center justify-between\">\n              <span className=\"text-sm text-gray-600\">Total de eventos registrados:</span>\n              <span className=\"font-semibold text-purple-600\">{auditLog.length}</span>\n            </div>\n            <div className=\"flex items-center justify-between\">\n              <span className=\"text-sm text-gray-600\">Primer evento:</span>\n              <span className=\"text-sm text-gray-500\">\n                {auditLog.length > 0 ? new Date(auditLog[auditLog.length - 1].timestamp).toLocaleDateString() : 'N/A'}\n              </span>\n            </div>\n            <div className=\"flex items-center justify-between\">\n              <span className=\"text-sm text-gray-600\">ltimo evento:</span>\n              <span className=\"text-sm text-gray-500\">\n                {auditLog.length > 0 ? new Date(auditLog[0].timestamp).toLocaleDateString() : 'N/A'}\n              </span>\n            </div>\n            <div className=\"mt-3 p-3 bg-purple-50 border border-purple-200 rounded-lg\">\n              <div className=\"text-sm text-purple-800\">\n                <strong> Audit Log incluido:</strong> El expediente incluir todos los eventos de auditora registrados \n                desde la activacin del proyecto hasta su completitud.\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Validacin de Archivado */}\n      <div className=\"bg-white rounded-lg shadow-sm p-6\">\n        <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">Validacin de Archivado</h3>\n        <div className=\"space-y-3\">\n          <div className=\"flex items-center space-x-3\">\n            <span className={`text-xl ${project.status === 'completed' ? 'text-green-500' : 'text-red-500'}`}>\n              {project.status === 'completed' ? '' : ''}\n            </span>\n            <span className=\"text-sm\">Proyecto marcado como completado</span>\n          </div>\n          <div className=\"flex items-center space-x-3\">\n            <span className={`text-xl ${finalMetrics.completionPercentage >= 90 ? 'text-green-500' : 'text-red-500'}`}>\n              {finalMetrics.completionPercentage >= 90 ? '' : ''}\n            </span>\n            <span className=\"text-sm\">Completitud mnima del 90% ({finalMetrics.completionPercentage.toFixed(1)}%)</span>\n          </div>\n          <div className=\"flex items-center space-x-3\">\n            <span className={`text-xl ${finalMetrics.totalWorkPackages > 0 ? 'text-green-500' : 'text-red-500'}`}>\n              {finalMetrics.totalWorkPackages > 0 ? '' : ''}\n            </span>\n            <span className=\"text-sm\">Work packages definidos ({finalMetrics.totalWorkPackages})</span>\n          </div>\n        </div>\n        \n        {!canArchive && (\n          <div className=\"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg\">\n            <div className=\"text-sm text-red-800\">\n              <strong>No se puede archivar:</strong> El proyecto no cumple con los criterios mnimos de archivado.\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* Contenido del Expediente */}\n      <div className=\"bg-white rounded-lg shadow-sm p-6\">\n        <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">Contenido del Expediente</h3>\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          <div className=\"space-y-2\">\n            <div className=\"flex items-center space-x-2\">\n              <span className=\"text-green-500\"></span>\n              <span className=\"text-sm\">Informacin del proyecto</span>\n            </div>\n            <div className=\"flex items-center space-x-2\">\n              <span className=\"text-green-500\"></span>\n              <span className=\"text-sm\">Work packages completos</span>\n            </div>\n            <div className=\"flex items-center space-x-2\">\n              <span className=\"text-green-500\"></span>\n              <span className=\"text-sm\">Gestin de riesgos</span>\n            </div>\n            <div className=\"flex items-center space-x-2\">\n              <span className=\"text-green-500\"></span>\n              <span className=\"text-sm\">Cronograma y tareas</span>\n            </div>\n          </div>\n          <div className=\"space-y-2\">\n            <div className=\"flex items-center space-x-2\">\n              <span className=\"text-green-500\"></span>\n              <span className=\"text-sm\">Documentacin financiera</span>\n            </div>\n            <div className=\"flex items-center space-x-2\">\n              <span className=\"text-green-500\"></span>\n              <span className=\"text-sm\">Asignacin de recursos</span>\n            </div>\n            <div className=\"flex items-center space-x-2\">\n              <span className=\"text-green-500\"></span>\n              <span className=\"text-sm\">Auditora completa ({auditLog.length} eventos)</span>\n            </div>\n            <div className=\"flex items-center space-x-2\">\n              <span className=\"text-green-500\"></span>\n              <span className=\"text-sm\">Archivos adjuntos ({projectFiles.length} archivos, {fileStats.totalSizeMB}MB)</span>\n            </div>\n            <div className=\"flex items-center space-x-2\">\n              <span className=\"text-green-500\"></span>\n              <span className=\"text-sm\">Lecciones aprendidas</span>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Progreso de Generacin */}\n      {isGenerating && (\n        <div className=\"bg-white rounded-lg shadow-sm p-6\">\n          <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">Generando Expediente</h3>\n          <div className=\"space-y-4\">\n            <div className=\"w-full bg-gray-200 rounded-full h-2\">\n              <div \n                className=\"bg-blue-600 h-2 rounded-full transition-all duration-500\"\n                style={{ width: `${archiveProgress}%` }}\n              ></div>\n            </div>\n            <div className=\"text-sm text-gray-600 text-center\">\n              {archiveProgress.toFixed(0)}% completado\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Botn de Archivado */}\n      <div className=\"bg-white rounded-lg shadow-sm p-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h3 className=\"text-lg font-semibold text-gray-800\">Archivar Proyecto</h3>\n            <p className=\"text-sm text-gray-600 mt-1\">\n              Generar expediente completo y cambiar estado a \"Archivado\"\n            </p>\n          </div>\n          <button\n            onClick={generateProjectArchive}\n            disabled={!canArchive || isGenerating}\n            className={`\n              px-6 py-3 rounded-lg font-medium transition-colors\n              ${canArchive && !isGenerating\n                ? 'bg-purple-600 text-white hover:bg-purple-700'\n                : 'bg-gray-300 text-gray-500 cursor-not-allowed'\n              }\n            `}\n          >\n            {isGenerating ? 'Generando...' : ' Generar Expediente y Archivar'}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\n// Funciones helper\nconst getStatusColor = (status) => {\n  switch(status) {\n    case 'active': return 'bg-green-100 text-green-800 border-green-200';\n    case 'inactive': return 'bg-gray-100 text-gray-600 border-gray-300';\n    case 'completed': return 'bg-blue-100 text-blue-800 border-blue-200';\n    case 'on-hold': return 'bg-yellow-100 text-yellow-800 border-yellow-200';\n    case 'cancelled': return 'bg-red-100 text-red-800 border-red-200';\n    case 'archived': return 'bg-purple-100 text-purple-800 border-purple-200';\n    default: return 'bg-gray-100 text-gray-800 border-gray-200';\n  }\n};\n\nconst getStatusIcon = (status) => {\n  switch(status) {\n    case 'active': return '';\n    case 'inactive': return '';\n    case 'completed': return '';\n    case 'on-hold': return '';\n    case 'cancelled': return '';\n    case 'archived': return '';\n    default: return '';\n  }\n};\n\nexport default ProjectArchive;\n","import supabaseService from '../services/SupabaseService';\n\n/**\n * HELPERS PARA GESTIN DE NOTIFICACIONES\n * Funciones para crear, leer y gestionar notificaciones de control de cambios\n */\n\n/**\n * Crea una notificacin en la base de datos\n * @param {Object} notificationData - Datos de la notificacin\n * @returns {Promise<Object>} Resultado de la operacin\n */\nexport const createNotification = async ({\n  userEmail,\n  userId,\n  changeId,\n  changeNumber,\n  changeTitle,\n  notificationType,\n  title,\n  message,\n  priority = 'normal',\n  metadata = {}\n}) => {\n  try {\n    const currentUser = supabaseService.getCurrentUser();\n    const orgId = supabaseService.getCurrentOrganization();\n    \n    if (!orgId) {\n      console.warn('No se puede crear notificacin: organizacin no detectada');\n      return { success: false, error: 'Organizacin no detectada' };\n    }\n    \n    const notification = {\n      organization_id: orgId,\n      user_id: userId,\n      user_email: userEmail,\n      change_id: changeId,\n      change_number: changeNumber,\n      change_title: changeTitle,\n      notification_type: notificationType,\n      title: title,\n      message: message,\n      priority: priority,\n      status: 'unread',\n      metadata: metadata,\n      action_url: `/change-management?changeId=${changeId}`,\n      created_at: new Date().toISOString()\n    };\n    \n    const { data, error } = await supabaseService.supabase\n      .from('change_notifications')\n      .insert(notification)\n      .select()\n      .single();\n    \n    if (error) {\n      console.error('Error creando notificacin:', error);\n      return { success: false, error };\n    }\n    \n    return { success: true, data };\n  } catch (error) {\n    console.error('Error inesperado creando notificacin:', error);\n    return { success: false, error };\n  }\n};\n\n/**\n * Obtiene notificaciones no ledas de un usuario\n * @param {string} userEmail - Email del usuario\n * @returns {Promise<Array>} Lista de notificaciones\n */\nexport const getUnreadNotifications = async (userEmail) => {\n  try {\n    // Verificar que el usuario est autenticado antes de hacer consultas\n    const { data: { session } } = await supabaseService.supabase.auth.getSession();\n\n    if (!session?.user) {\n      console.warn(' getUnreadNotifications: Usuario no autenticado');\n      return [];\n    }\n\n    const { data, error } = await supabaseService.supabase\n      .from('change_notifications')\n      .select('*')\n      .eq('user_email', userEmail)\n      .eq('status', 'unread')\n      .order('created_at', { ascending: false });\n\n    if (error) {\n      console.error('Error obteniendo notificaciones:', error);\n      return [];\n    }\n\n    return data || [];\n  } catch (error) {\n    console.error('Error inesperado obteniendo notificaciones:', error);\n    return [];\n  }\n};\n\n/**\n * Marca una notificacin como leda\n * @param {string} notificationId - ID de la notificacin\n * @returns {Promise<Object>} Resultado de la operacin\n */\nexport const markAsRead = async (notificationId) => {\n  try {\n    const { error } = await supabaseService.supabase\n      .from('change_notifications')\n      .update({\n        status: 'read',\n        read_at: new Date().toISOString(),\n        updated_at: new Date().toISOString()\n      })\n      .eq('id', notificationId);\n    \n    if (error) {\n      console.error('Error marcando notificacin como leda:', error);\n      return { success: false, error };\n    }\n    \n    return { success: true };\n  } catch (error) {\n    console.error('Error inesperado marcando notificacin:', error);\n    return { success: false, error };\n  }\n};\n\n/**\n * Marca todas las notificaciones de un usuario como ledas\n * @param {string} userEmail - Email del usuario\n * @returns {Promise<Object>} Resultado de la operacin\n */\nexport const markAllAsRead = async (userEmail) => {\n  try {\n    const { error } = await supabaseService.supabase\n      .from('change_notifications')\n      .update({\n        status: 'read',\n        read_at: new Date().toISOString(),\n        updated_at: new Date().toISOString()\n      })\n      .eq('user_email', userEmail)\n      .eq('status', 'unread');\n    \n    if (error) {\n      console.error('Error marcando todas como ledas:', error);\n      return { success: false, error };\n    }\n    \n    return { success: true };\n  } catch (error) {\n    console.error('Error inesperado marcando todas como ledas:', error);\n    return { success: false, error };\n  }\n};\n\n/**\n * Obtiene el conteo de notificaciones no ledas\n * @param {string} userEmail - Email del usuario\n * @returns {Promise<number>} Nmero de notificaciones no ledas\n */\nexport const getUnreadCount = async (userEmail) => {\n  try {\n    // Verificar que el usuario est autenticado antes de hacer consultas\n    const { data: { session } } = await supabaseService.supabase.auth.getSession();\n\n    if (!session?.user) {\n      console.warn(' getUnreadCount: Usuario no autenticado');\n      return 0;\n    }\n\n    const { count, error } = await supabaseService.supabase\n      .from('change_notifications')\n      .select('*', { count: 'exact', head: true })\n      .eq('user_email', userEmail)\n      .eq('status', 'unread');\n\n    if (error) {\n      console.error('Error obteniendo conteo:', error);\n      return 0;\n    }\n\n    return count || 0;\n  } catch (error) {\n    console.error('Error inesperado obteniendo conteo:', error);\n    return 0;\n  }\n};\n\n/**\n * Notifica a un usuario sobre asignacin de cambio\n * @param {Object} params - Parmetros de la notificacin\n */\nexport const notifyChangeAssigned = async ({ userEmail, userId, change, assignedBy }) => {\n  return createNotification({\n    userEmail,\n    userId,\n    changeId: change.id,\n    changeNumber: change.changeNumber,\n    changeTitle: change.title,\n    notificationType: 'assigned',\n    title: 'Cambio Asignado',\n    message: `${assignedBy} te ha asignado el cambio \"${change.title}\"`,\n    priority: 'high',\n    metadata: { assignedBy, changeStatus: change.status }\n  });\n};\n\n/**\n * Notifica a un usuario que requiere su aprobacin\n * @param {Object} params - Parmetros de la notificacin\n */\nexport const notifyApprovalRequired = async ({ userEmail, userId, change }) => {\n  return createNotification({\n    userEmail,\n    userId,\n    changeId: change.id,\n    changeNumber: change.changeNumber,\n    changeTitle: change.title,\n    notificationType: 'approval_required',\n    title: 'Aprobacin Requerida',\n    message: `El cambio \"${change.title}\" requiere tu aprobacin`,\n    priority: 'urgent',\n    metadata: { \n      costImpact: change.impactCost, \n      scheduleImpact: change.impactSchedule \n    }\n  });\n};\n\n/**\n * Notifica a un usuario que requiere su voto en CCB\n * @param {Object} params - Parmetros de la notificacin\n */\nexport const notifyCCBVoteRequired = async ({ userEmail, userId, change }) => {\n  return createNotification({\n    userEmail,\n    userId,\n    changeId: change.id,\n    changeNumber: change.changeNumber,\n    changeTitle: change.title,\n    notificationType: 'ccb_vote_required',\n    title: 'Voto CCB Requerido',\n    message: `Tu voto es requerido en el CCB para \"${change.title}\"`,\n    priority: 'high',\n    metadata: { changeStatus: change.status }\n  });\n};\n\n/**\n * Notifica cambio de estado\n * @param {Object} params - Parmetros de la notificacin\n */\nexport const notifyStatusChanged = async ({ userEmail, userId, change, oldStatus, newStatus, changedBy }) => {\n  return createNotification({\n    userEmail,\n    userId,\n    changeId: change.id,\n    changeNumber: change.changeNumber,\n    changeTitle: change.title,\n    notificationType: 'status_changed',\n    title: 'Estado de Cambio Actualizado',\n    message: `El cambio \"${change.title}\" pas de ${oldStatus} a ${newStatus}`,\n    priority: 'normal',\n    metadata: { oldStatus, newStatus, changedBy }\n  });\n};\n\nconst notificationHelpers = {\n  createNotification,\n  getUnreadNotifications,\n  markAsRead,\n  markAllAsRead,\n  getUnreadCount,\n  notifyChangeAssigned,\n  notifyApprovalRequired,\n  notifyCCBVoteRequired,\n  notifyStatusChanged\n};\n\nexport default notificationHelpers;\n","import { logger } from '../utils/logger';\n\n/**\n * PortfolioDashboard.js\n *\n * Componente que muestra la lista de proyectos en formato de tabla/dashboard.\n * Se usa dentro del TAB \"Lista de Proyectos\" en PortfolioStrategic.\n *\n * Contiene su propio modal de creacin/edicin de proyectos que se abre desde:\n * - Botn \"Nuevo Proyecto\" en la barra superior\n * - Botn \"Editar\" () en cada fila de proyecto\n *\n * NOTA: Este componente es diferente de PortfolioStrategic que tiene su propio modal\n * para crear proyectos desde la vista Overview.\n */\n\nimport React, { useMemo, useState, useEffect } from 'react';\nimport PortfolioCharts from './PortfolioCharts';\nimport CorporateAlerts from './CorporateAlerts';\nimport FileManager from './FileManager';\nimport usePermissions from '../hooks/usePermissions';\nimport subscriptionService from '../services/SubscriptionService';\nimport supabaseService from '../services/SupabaseService';\n\n// Componente para mostrar errores de validacin\nconst ErrorMessage = ({ error }) => {\n  if (!error) return null;\n  return <p className=\"text-red-500 text-xs mt-1\">{error}</p>;\n};\n\nconst PortfolioDashboard = ({\n  projects,\n  currentProjectId,\n  setCurrentProjectId,\n  portfolioMetrics, // Nuevo prop para mtricas actualizadas\n  workPackages, // Nuevo prop para work packages\n  risks, // Nuevo prop para riesgos\n  globalResources, // Nuevo prop para recursos globales\n  setGlobalResources, // Nuevo prop para actualizar recursos\n  tasksByProject, // Nuevo prop para tareas por proyecto\n  createProject,\n  updateProject,\n  deleteProject,\n  duplicateProject,\n  archiveProject,\n  includeWeekendsByProject,\n  setIncludeWeekendsByProject,\n  getCurrentProjectIncludeWeekends,\n  triggerNewProject = false, // Nueva prop para abrir modal externamente\n  onNewProjectTriggered // Callback para notificar que se proces el trigger\n}) => {\n  const [showFileManager, setShowFileManager] = useState(false);\n  const [selectedProjectForFiles, setSelectedProjectForFiles] = useState(null);\n  const [showProjectModal, setShowProjectModal] = useState(false);\n  const [editingProject, setEditingProjectInternal] = useState(null);\n  const [errors, setErrors] = useState({});\n  const [organizationId, setOrganizationId] = useState(null);\n  const [showUpgradeModal, setShowUpgradeModal] = useState(false);\n  const [subscriptionLimit, setSubscriptionLimit] = useState(null);\n\n  // Wrapper para setEditingProject que siempre usa patrn callback\n  // Esto previene el bug de campos que se borran al editar\n  const setEditingProject = (updater) => {\n    if (typeof updater === 'function') {\n      // Ya es una funcin, usar directamente\n      setEditingProjectInternal(updater);\n    } else {\n      // Es un objeto, convertir a funcin callback que preserve estado anterior\n      setEditingProjectInternal(prev => {\n        // Si es null (resetear), usar directamente\n        if (updater === null) return null;\n        // Si no hay estado previo, usar el nuevo objeto\n        if (!prev) return updater;\n        // Merge: preservar prev y sobrescribir con updater\n        return { ...prev, ...updater };\n      });\n    }\n  };\n\n  // Hook de permisos\n  const { permissions, isReadOnly, isLoading: permissionsLoading } = usePermissions();\n\n  // Funcin para ordenar proyectos: primero nmeros (ascendente), luego letras (A-Z)\n  const sortProjects = (projectList) => {\n    return [...projectList].sort((a, b) => {\n      const nameA = a.name.trim();\n      const nameB = b.name.trim();\n\n      const startsWithNumberA = /^\\d/.test(nameA);\n      const startsWithNumberB = /^\\d/.test(nameB);\n\n      // Si ambos inician con nmero, ordenar numricamente\n      if (startsWithNumberA && startsWithNumberB) {\n        const numA = parseInt(nameA.match(/^\\d+/)[0]);\n        const numB = parseInt(nameB.match(/^\\d+/)[0]);\n        if (numA !== numB) return numA - numB;\n        // Si los nmeros son iguales, ordenar alfabticamente el resto\n        return nameA.localeCompare(nameB, 'es', { sensitivity: 'base' });\n      }\n\n      // Si solo A inicia con nmero, A va primero\n      if (startsWithNumberA) return -1;\n\n      // Si solo B inicia con nmero, B va primero\n      if (startsWithNumberB) return 1;\n\n      // Si ambos inician con letra, ordenar alfabticamente (A-Z)\n      return nameA.localeCompare(nameB, 'es', { sensitivity: 'base' });\n    });\n  };\n\n  const getPriorityColor = (priority) => {\n    switch(priority) {\n      case 'high': return 'bg-red-100 text-red-800 border-red-200';\n      case 'medium': return 'bg-yellow-100 text-yellow-800 border-yellow-200';\n      case 'low': return 'bg-green-100 text-green-800 border-green-200';\n      default: return 'bg-gray-100 text-gray-800 border-gray-200';\n    }\n  };\n\n  const getStatusColor = (status) => {\n    switch(status) {\n      case 'active': return 'bg-blue-100 text-blue-800 border-blue-200';\n      case 'completed': return 'bg-green-100 text-green-800 border-green-200';\n      case 'on-hold': return 'bg-yellow-100 text-yellow-800 border-yellow-200';\n      case 'cancelled': return 'bg-red-100 text-red-800 border-red-200';\n      default: return 'bg-gray-100 text-gray-800 border-gray-200';\n    }\n  };\n\n  const getStatusIcon = (status) => {\n    switch(status) {\n      case 'active': return '';\n      case 'completed': return '';\n      case 'on-hold': return '';\n      case 'cancelled': return '';\n      default: return '';\n    }\n  };\n\n  // Funcin auxiliar para actualizar campos del proyecto de forma segura\n  const updateProjectField = (fieldName, value) => {\n    setEditingProject(prev => ({\n      ...prev,\n      [fieldName]: value\n    }));\n  };\n\n  // Funcin para validar campos en tiempo real\n  const validateField = (fieldName, value) => {\n    const newErrors = Object.assign({}, errors);\n    \n    switch (fieldName) {\n      case 'name':\n        if (!value || value.trim().length < 3) {\n          newErrors.name = 'El nombre debe tener al menos 3 caracteres';\n        } else {\n          delete newErrors.name;\n        }\n        break;\n      case 'manager':\n        if (!value || value.trim().length < 2) {\n          newErrors.manager = 'El manager debe tener al menos 2 caracteres';\n        } else {\n          delete newErrors.manager;\n        }\n        break;\n      case 'sponsor':\n        if (!value || value.trim().length < 2) {\n          newErrors.sponsor = 'El sponsor debe tener al menos 2 caracteres';\n        } else {\n          delete newErrors.sponsor;\n        }\n        break;\n      case 'startDate':\n        if (!value) {\n          newErrors.startDate = 'La fecha de inicio es requerida';\n        } else {\n          delete newErrors.startDate;\n        }\n        break;\n      case 'endDate':\n        if (!value) {\n          newErrors.endDate = 'La fecha de fin es requerida';\n        } else if (editingProject?.startDate && value <= editingProject.startDate) {\n          newErrors.endDate = 'La fecha de fin debe ser posterior a la fecha de inicio';\n        } else {\n          delete newErrors.endDate;\n        }\n        break;\n      case 'budget':\n        if (!value || value <= 0) {\n          newErrors.budget = 'El presupuesto debe ser mayor a 0';\n        } else {\n          delete newErrors.budget;\n        }\n        break;\n      case 'irr':\n        if (value && (value < 0 || value > 100)) {\n          newErrors.irr = 'La TIR debe estar entre 0% y 100%';\n        } else {\n          delete newErrors.irr;\n        }\n        break;\n      default:\n        break;\n    }\n    \n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  // Funcin para manejar la edicin de proyecto\n  const handleEditProject = (project) => {\n    logger.debug(' Proyecto original para editar:', project);\n    logger.debug(' Estado del proyecto original:', project.status);\n    \n    // Preservar el estado actual del proyecto al editar\n    // NO usar valores por defecto que sobrescriban el estado real\n    const projectToEdit = { \n      ...project,\n      // Solo usar valores por defecto para campos que realmente no existan\n      description: project.description || '',\n      objective: project.objective || '',\n      businessCase: project.businessCase || '',\n      kickoffDate: project.kickoffDate || '',\n      stakeholders: project.stakeholders || [],\n      // NO sobrescribir campos crticos como status, priority, etc.\n      // Estos deben mantenerse exactamente como estn en el proyecto original\n    };\n    \n    logger.debug(' Proyecto preparado para editar:', projectToEdit);\n    logger.debug(' Estado del proyecto preparado:', projectToEdit.status);\n    \n    setEditingProject(projectToEdit);\n    setErrors({});\n    setShowProjectModal(true);\n  };\n\n  // Funcin para manejar la creacin de nuevo proyecto\n  const handleNewProject = () => {\n    setEditingProject({\n      id: '',\n      name: '',\n      description: '',\n      status: 'inactive',\n      priority: 'medium',\n      startDate: new Date().toISOString().split('T')[0],\n      endDate: new Date(Date.now() + 90 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],\n      budget: 100000,\n      contingencyReserve: 10000,\n      managementReserve: 5000,\n      manager: '',\n      sponsor: '',\n      objective: '',\n      businessCase: '',\n      irr: 0,\n      roi: 0,\n      kickoffDate: '',\n      stakeholders: [],\n      createdAt: new Date().toISOString(),\n      updatedAt: new Date().toISOString(),\n      version: '1.0.0'\n    });\n    setErrors({});\n    setShowProjectModal(true);\n  };\n\n  // useEffect para manejar trigger externo de nuevo proyecto\n  React.useEffect(() => {\n    if (triggerNewProject) {\n      handleNewProject();\n      // Notificar al padre que se proces el trigger\n      if (onNewProjectTriggered) {\n        onNewProjectTriggered();\n      }\n    }\n  }, [triggerNewProject, onNewProjectTriggered]);\n\n  // useEffect para obtener organizationId desde SupabaseService\n  useEffect(() => {\n    const fetchOrganizationId = () => {\n      try {\n        // Obtener desde SupabaseService (fuente principal)\n        const orgId = supabaseService.getCurrentOrganization();\n\n        if (orgId) {\n          setOrganizationId(orgId);\n          logger.debug(' PortfolioDashboard - Organization ID cargado:', orgId);\n        } else {\n          logger.warn(' PortfolioDashboard - No se encontr organization ID');\n        }\n      } catch (error) {\n        logger.error(' Error obteniendo organizationId:', error);\n      }\n    };\n\n    // Intentar obtener inmediatamente\n    fetchOrganizationId();\n\n    // Si no se encuentra, reintentar despus de 1 segundo\n    const timer = setTimeout(() => {\n      if (!organizationId) {\n        logger.debug(' PortfolioDashboard - Reintentando obtener organization ID...');\n        fetchOrganizationId();\n      }\n    }, 1000);\n\n    return () => clearTimeout(timer);\n  }, []);\n\n  // Funcin para guardar proyecto\n  const handleSaveProject = async () => {\n    // Limpiar errores previos\n    setErrors({});\n\n    // Validar todos los campos obligatorios\n    const newErrors = {};\n\n    if (!editingProject.name || editingProject.name.trim().length < 3) {\n      newErrors.name = 'El nombre debe tener al menos 3 caracteres';\n    }\n\n    if (!editingProject.manager || editingProject.manager.trim().length < 2) {\n      newErrors.manager = 'El manager debe tener al menos 2 caracteres';\n    }\n\n    if (!editingProject.sponsor || editingProject.sponsor.trim().length < 2) {\n      newErrors.sponsor = 'El sponsor debe tener al menos 2 caracteres';\n    }\n\n    if (!editingProject.startDate) {\n      newErrors.startDate = 'La fecha de inicio es requerida';\n    }\n\n    if (!editingProject.endDate) {\n      newErrors.endDate = 'La fecha de fin es requerida';\n    } else if (editingProject.startDate && editingProject.endDate <= editingProject.startDate) {\n      newErrors.endDate = 'La fecha de fin debe ser posterior a la fecha de inicio';\n    }\n\n    if (!editingProject.budget || editingProject.budget <= 0) {\n      newErrors.budget = 'El presupuesto debe ser mayor a 0';\n    }\n\n    if (editingProject.irr && (editingProject.irr < 0 || editingProject.irr > 100)) {\n      newErrors.irr = 'La TIR debe estar entre 0% y 100%';\n    }\n\n    // Si hay errores, mostrarlos y no guardar\n    if (Object.keys(newErrors).length > 0) {\n      setErrors(newErrors);\n      // Mostrar alerta con el nmero de errores\n      alert(` No se puede guardar el proyecto. Hay ${Object.keys(newErrors).length} errores de validacin.`);\n      return;\n    }\n\n    // Validar lmites de suscripcin si es un proyecto nuevo\n    if (!editingProject.id && organizationId) {\n      logger.debug(' Validando lmites de suscripcin para organizationId:', organizationId);\n      try {\n        const canCreate = await subscriptionService.canCreateProject(organizationId);\n        logger.debug(' Resultado de validacin:', canCreate);\n\n        if (!canCreate.allowed) {\n          logger.warn(' Lmite alcanzado - Mostrando modal de upgrade');\n          // Guardar informacin del lmite para mostrar en el modal\n          setSubscriptionLimit(canCreate);\n          setShowUpgradeModal(true);\n          return;\n        }\n        logger.debug(' Validacin pasada - Puede crear proyecto');\n      } catch (error) {\n        logger.error(' Error verificando lmites de suscripcin:', error);\n        // Continuar con la creacin en caso de error (fail-safe)\n      }\n    } else {\n      logger.warn(' No se valid suscripcin - editingProject.id:', editingProject.id, 'organizationId:', organizationId);\n    }\n\n    // Si no hay errores, proceder a guardar\n    try {\n      if (editingProject.id) {\n        // Actualizar proyecto existente\n        updateProject(editingProject.id, editingProject);\n        alert(' Proyecto actualizado exitosamente');\n      } else {\n        // Crear nuevo proyecto\n        createProject(editingProject);\n        alert(' Proyecto creado exitosamente');\n      }\n\n      setShowProjectModal(false);\n      setEditingProject(null);\n      setErrors({});\n    } catch (error) {\n      alert(` Error al guardar el proyecto: ${error.message}`);\n    }\n  };\n\n  // Calcular mtricas del portfolio con datos actualizados\n  const calculatedMetrics = useMemo(() => {\n    if (!projects || projects.length === 0) {\n      return {\n        totalProjects: 0,\n        activeProjects: 0,\n        completedProjects: 0,\n        totalBudget: 0,\n        averageProgress: 0,\n        totalWorkPackages: 0,\n        totalRisks: 0,\n        activeRisks: 0\n      };\n    }\n\n    const totalProjects = projects.length;\n    const activeProjects = projects.filter(p => p.status === 'active').length;\n    const completedProjects = projects.filter(p => p.status === 'completed').length;\n    const activeProjectsList = projects.filter(p => p.status === 'active');\n    const totalBudget = activeProjectsList.reduce((sum, p) => sum + (p.budget || 0), 0);\n    const averageProgress = activeProjectsList.length > 0 \n      ? activeProjectsList.reduce((sum, p) => sum + (p.progress || 0), 0) / activeProjectsList.length \n      : 0;\n\n    // Mtricas adicionales de work packages y riesgos\n    const totalWorkPackages = workPackages ? workPackages.length : 0;\n    const totalRisks = risks ? risks.length : 0;\n    const activeRisks = risks ? risks.filter(r => r.status === 'active').length : 0;\n\n    return {\n      totalProjects,\n      activeProjects,\n      completedProjects,\n      totalBudget,\n      averageProgress: Math.round(averageProgress),\n      totalWorkPackages,\n      totalRisks,\n      activeRisks\n    };\n  }, [projects, workPackages, risks]);\n\n  // Usar mtricas del portfolio si estn disponibles, sino usar las calculadas\n  const metrics = portfolioMetrics || calculatedMetrics;\n\n  return (\n    <div className=\"space-y-6 max-w-full overflow-hidden\">\n\n      {/* Nota Informativa */}\n      <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\n        <div className=\"flex items-center\">\n          <div className=\"text-blue-600 text-xl mr-3\"></div>\n          <div className=\"text-blue-800\">\n            <strong>Nota:</strong> Las mtricas financieras y KPIs solo consideran proyectos con estado \"Activo\". \n            Los proyectos \"Inactivos\" o \"Completados\" no influyen en los indicadores financieros.\n          </div>\n        </div>\n      </div>\n\n      {/* KPIs del Portfolio */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n        <div className=\"bg-white rounded-lg shadow-sm p-4 border-l-4 border-blue-500\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <div className=\"text-xs text-gray-500 mb-1\">Total Proyectos</div>\n              <div className=\"text-2xl font-bold text-gray-800\">\n                {metrics.totalProjects}\n              </div>\n            </div>\n            <div className=\"text-blue-500 text-2xl\"></div>\n          </div>\n        </div>\n\n        <div className=\"bg-white rounded-lg shadow-sm p-4 border-l-4 border-green-500\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <div className=\"text-xs text-gray-500 mb-1\">Proyectos Activos</div>\n              <div className=\"text-2xl font-bold text-gray-800\">\n                {metrics.activeProjects}\n              </div>\n            </div>\n            <div className=\"text-green-500 text-2xl\"></div>\n          </div>\n        </div>\n\n        <div className=\"bg-white rounded-lg shadow-sm p-4 border-l-4 border-purple-500\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <div className=\"text-xs text-gray-500 mb-1\">Completados</div>\n              <div className=\"text-2xl font-bold text-gray-800\">\n                {metrics.completedProjects}\n              </div>\n            </div>\n            <div className=\"text-purple-500 text-2xl\"></div>\n          </div>\n        </div>\n\n        <div className=\"bg-white rounded-lg shadow-sm p-4 border-l-4 border-indigo-500\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <div className=\"text-xs text-gray-500 mb-1\">Presupuesto Proyectos Activos</div>\n              <div className=\"text-2xl font-bold text-gray-800\">\n                ${(metrics.totalBudget / 1000).toFixed(0)}K\n              </div>\n            </div>\n            <div className=\"text-indigo-500 text-2xl\"></div>\n          </div>\n        </div>\n      </div>\n\n      {/* Acciones del Portfolio */}\n      <div className=\"bg-white rounded-lg shadow-sm p-4\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h2 className=\"text-lg font-semibold text-gray-800\">Acciones del Portfolio</h2>\n          <div className=\"flex space-x-2\">\n            {/* Solo mostrar botn crear si tiene permisos */}\n            {permissions.canEdit && (\n              <button\n                onClick={handleNewProject}\n                className=\"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 flex items-center space-x-2\"\n              >\n                <span></span>\n                <span>Nuevo Proyecto</span>\n              </button>\n            )}\n            {isReadOnly() && (\n              <div className=\"text-sm text-gray-500 italic bg-gray-50 px-3 py-2 rounded-lg border\">\n                <span></span> Modo solo lectura\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n\n      {/* Lista de Proyectos */}\n      <div className=\"bg-white rounded-lg shadow-sm p-4\">\n        <h2 className=\"text-lg font-semibold text-gray-800 mb-4\">Proyectos del Portfolio</h2>\n        \n        {projects.length === 0 ? (\n          <div className=\"text-center py-8 text-gray-500\">\n            <div className=\"text-4xl mb-2\"></div>\n            <div>No hay proyectos en el portfolio</div>\n            <button\n              onClick={handleNewProject}\n              className=\"mt-4 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700\"\n            >\n              Crear Primer Proyecto\n            </button>\n          </div>\n        ) : (\n          <div className=\"space-y-3\">\n            {sortProjects(projects).map((project) => (\n              <div\n                key={project.id}\n                className={`border rounded-lg p-4 transition-all duration-200 cursor-pointer hover:shadow-md ${\n                  currentProjectId === project.id \n                    ? 'border-blue-500 bg-blue-50' \n                    : 'border-gray-200 hover:border-gray-300'\n                }`}\n                onClick={() => setCurrentProjectId(project.id)}\n              >\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center space-x-3 mb-2\">\n                      <h3 className=\"font-semibold text-gray-900\">{project.name}</h3>\n                      <span className={`px-2 py-1 rounded-full text-xs font-medium border ${getPriorityColor(project.priority)}`}>\n                        {project.priority}\n                      </span>\n                      <span className={`px-2 py-1 rounded-full text-xs font-medium border ${getStatusColor(project.status)}`}>\n                        {getStatusIcon(project.status)} {project.status}\n                      </span>\n                    </div>\n                    \n                    <div className=\"text-sm text-gray-600 mb-2\">\n                      {project.description}\n                    </div>\n                    \n                    <div className=\"flex items-center space-x-4 text-xs text-gray-500\">\n                      <span> {project.startDate} - {project.endDate}</span>\n                      <span> ${(project.budget / 1000).toFixed(0)}K</span>\n                      <span> {project.manager}</span>\n                    </div>\n                  </div>\n                  \n                  <div className=\"flex items-center space-x-2\">\n                    <button\n                      onClick={(e) => {\n                        e.stopPropagation();\n                        setSelectedProjectForFiles(project);\n                        setShowFileManager(true);\n                      }}\n                      className=\"p-2 text-gray-400 hover:text-purple-600 hover:bg-purple-50 rounded transition-colors\"\n                      title=\"Ver archivos del proyecto\"\n                    >\n                      \n                    </button>\n                    <button\n                      onClick={(e) => {\n                        e.stopPropagation();\n                        duplicateProject(project.id);\n                      }}\n                      className=\"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded\"\n                      title=\"Duplicar proyecto\"\n                    >\n                      \n                    </button>\n                    <button\n                      onClick={(e) => {\n                        e.stopPropagation();\n                        handleEditProject(project);\n                      }}\n                      className=\"p-2 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded\"\n                      title=\"Editar proyecto\"\n                    >\n                      \n                    </button>\n                    <button\n                      onClick={(e) => {\n                        e.stopPropagation();\n                        if (window.confirm(`Archivar proyecto \"${project.name}\"? Se mover al archivo y se limpiarn sus datos del sistema activo.`)) {\n                          archiveProject(project.id);\n                        }\n                      }}\n                      className=\"p-2 text-gray-400 hover:text-orange-600 hover:bg-orange-50 rounded\"\n                      title=\"Archivar proyecto\"\n                    >\n                      \n                    </button>\n                    <button\n                      onClick={(e) => {\n                        e.stopPropagation();\n                        if (window.confirm(`Eliminar proyecto \"${project.name}\"? Esta accin no se puede deshacer.`)) {\n                          deleteProject(project.id);\n                        }\n                      }}\n                      className=\"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded\"\n                      title=\"Eliminar proyecto\"\n                    >\n                      \n                    </button>\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Mtricas del Proyecto Actual */}\n      {currentProjectId && (\n        <div className=\"bg-white rounded-lg shadow-sm p-4\">\n          <h2 className=\"text-lg font-semibold text-gray-800 mb-4\">Mtricas del Proyecto Actual</h2>\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n            <div className=\"text-center p-3 bg-gray-50 rounded-lg\">\n              <div className=\"text-2xl font-bold text-gray-800\">\n                {portfolioMetrics?.currentProjectCPI?.toFixed(2) || 'N/A'}\n              </div>\n              <div className=\"text-xs text-gray-600\">CPI</div>\n            </div>\n            <div className=\"text-center p-3 bg-gray-50 rounded-lg\">\n              <div className=\"text-2xl font-bold text-gray-800\">\n                {portfolioMetrics?.currentProjectSPI?.toFixed(2) || 'N/A'}\n              </div>\n              <div className=\"text-xs text-gray-600\">SPI</div>\n            </div>\n            <div className=\"text-center p-3 bg-gray-50 rounded-lg\">\n              <div className=\"text-2xl font-bold text-gray-800\">\n                ${(portfolioMetrics?.currentProjectCV / 1000).toFixed(0)}K\n              </div>\n              <div className=\"text-xs text-gray-600\">CV</div>\n            </div>\n            <div className=\"text-center p-3 bg-gray-50 rounded-lg\">\n              <div className=\"text-2xl font-bold text-gray-800\">\n                ${(portfolioMetrics?.currentProjectSV / 1000).toFixed(0)}K\n              </div>\n              <div className=\"text-xs text-gray-600\">SV</div>\n            </div>\n          </div>\n        </div>\n      )}\n\n\n      {/* Alertas Corporativas */}\n      <CorporateAlerts projects={projects} portfolioMetrics={portfolioMetrics} />\n\n      {/* Grficos y Anlisis */}\n      <PortfolioCharts projects={projects} portfolioMetrics={portfolioMetrics} workPackages={workPackages} risks={risks} tasksByProject={tasksByProject} includeWeekendsByProject={includeWeekendsByProject} setIncludeWeekendsByProject={setIncludeWeekendsByProject} getCurrentProjectIncludeWeekends={getCurrentProjectIncludeWeekends} />\n\n      {/* Gestor de Archivos del Proyecto Seleccionado */}\n      {showFileManager && selectedProjectForFiles && (\n        <div className=\"bg-white rounded-lg shadow-sm p-6\">\n          <div className=\"flex items-center justify-between mb-6\">\n            <div className=\"flex items-center space-x-3\">\n              <div className=\"p-3 bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl text-white\">\n                <span className=\"text-2xl\"></span>\n              </div>\n              <div>\n                <h3 className=\"text-xl font-bold text-gray-800\">\n                  Archivos del Proyecto: {selectedProjectForFiles.name}\n                </h3>\n                <p className=\"text-sm text-gray-600\">\n                  Gestin completa de documentos y archivos adjuntos\n                </p>\n              </div>\n            </div>\n            \n            <button\n              onClick={() => {\n                setShowFileManager(false);\n                setSelectedProjectForFiles(null);\n              }}\n              className=\"px-4 py-2 bg-gradient-to-r from-gray-500 to-gray-600 text-white rounded-lg hover:from-gray-600 hover:to-gray-700 transition-all duration-200 shadow-sm hover:shadow-md\"\n            >\n               Cerrar\n            </button>\n          </div>\n          \n          <FileManager \n            projectId={selectedProjectForFiles.id}\n            category=\"general\"\n            isContextual={true}\n            title={` Archivos de ${selectedProjectForFiles.name}`}\n            onFileUploaded={() => {\n              // Archivo subido exitosamente desde portfolio de proyectos\n            }}\n          />\n        </div>\n      )}\n\n      {/* Modal para Crear/Editar Proyecto */}\n      {showProjectModal && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 z-[9999] flex items-center justify-center p-4\">\n          <div className=\"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto\">\n            <div className=\"p-6\">\n              <div className=\"flex justify-between items-center mb-6\">\n                <h2 className=\"text-xl font-bold\">\n                  {editingProject?.id ? 'Editar Proyecto' : 'Nuevo Proyecto'}\n                </h2>\n                <button\n                  onClick={() => {\n                    setShowProjectModal(false);\n                    setEditingProject(null);\n                  }}\n                  className=\"text-gray-500 hover:text-gray-700 text-2xl font-bold\"\n                >\n                  \n                </button>\n              </div>\n\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Nombre del Proyecto *</label>\n                  <input\n                    type=\"text\"\n                    className={`w-full border rounded px-3 py-2 ${errors.name ? 'border-red-500' : 'border-red-300'}`}\n                    value={editingProject?.name || ''}\n                    onChange={(e) => {\n                      updateProjectField('name', e.target.value);\n                      validateField('name', e.target.value);\n                    }}\n                    onBlur={(e) => validateField('name', e.target.value)}\n                    placeholder=\"Nombre del proyecto\"\n                  />\n                  <ErrorMessage error={errors.name} />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Manager *</label>\n                  <input\n                    type=\"text\"\n                    className={`w-full border rounded px-3 py-2 ${errors.manager ? 'border-red-500' : 'border-gray-300'}`}\n                    value={editingProject?.manager || ''}\n                    onChange={(e) => {\n                      updateProjectField('manager', e.target.value);\n                      validateField('manager', e.target.value);\n                    }}\n                    onBlur={(e) => validateField('manager', e.target.value)}\n                    placeholder=\"Gerente del proyecto\"\n                  />\n                  <ErrorMessage error={errors.manager} />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Sponsor *</label>\n                  <input\n                    type=\"text\"\n                    className={`w-full border rounded px-3 py-2 ${errors.sponsor ? 'border-red-500' : 'border-gray-300'}`}\n                    value={editingProject?.sponsor || ''}\n                    onChange={(e) => {\n                      updateProjectField('sponsor', e.target.value);\n                      validateField('sponsor', e.target.value);\n                    }}\n                    onBlur={(e) => validateField('sponsor', e.target.value)}\n                    placeholder=\"Patrocinador del proyecto\"\n                  />\n                  <ErrorMessage error={errors.sponsor} />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Prioridad</label>\n                  <select\n                    className=\"w-full border rounded px-3 py-2\"\n                    value={editingProject?.priority || 'medium'}\n                    onChange={(e) => updateProjectField('priority', e.target.value)}\n                  >\n                    <option value=\"low\">Baja</option>\n                    <option value=\"medium\">Media</option>\n                    <option value=\"high\">Alta</option>\n                  </select>\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Estado del Proyecto *</label>\n                  <select\n                    className=\"w-full border rounded px-3 py-2\"\n                    value={editingProject?.status || 'inactive'}\n                    onChange={(e) => updateProjectField('status', e.target.value)}\n                  >\n                    <option value=\"inactive\"> Inactivo</option>\n                    <option value=\"active\"> Activo</option>\n                  </select>\n                  <p className=\"text-xs text-gray-500 mt-1\">\n                    <strong>Por defecto:</strong> Los proyectos nuevos y duplicados aparecen como \"Inactivos\"\n                    para revisin. Solo los proyectos \"Activos\" suman al dashboard consolidado y aparecen en Gestin de Proyectos.\n                  </p>\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Fecha de Inicio *</label>\n                  <input\n                    type=\"date\"\n                    className={`w-full border rounded px-3 py-2 ${errors.startDate ? 'border-red-500' : 'border-gray-300'}`}\n                    value={editingProject?.startDate || ''}\n                    onChange={(e) => {\n                      updateProjectField('startDate', e.target.value);\n                      validateField('startDate', e.target.value);\n                      // Revalidar fecha fin si ya existe\n                      if (editingProject?.endDate) {\n                        validateField('endDate', editingProject.endDate);\n                      }\n                    }}\n                    onBlur={(e) => validateField('startDate', e.target.value)}\n                  />\n                  <ErrorMessage error={errors.startDate} />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Fecha de Fin *</label>\n                  <input\n                    type=\"text\"\n                    className={`w-full border rounded px-3 py-2 ${errors.endDate ? 'border-red-500' : 'border-gray-300'}`}\n                    value={editingProject?.endDate || ''}\n                    onChange={(e) => {\n                      updateProjectField('endDate', e.target.value);\n                      validateField('endDate', e.target.value);\n                    }}\n                    onBlur={(e) => validateField('endDate', e.target.value)}\n                    placeholder=\"YYYY-MM-DD\"\n                  />\n                  <ErrorMessage error={errors.endDate} />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Presupuesto (USD) *</label>\n                  <input\n                    type=\"number\"\n                    className={`w-full border rounded px-3 py-2 ${errors.budget ? 'border-red-500' : 'border-gray-300'}`}\n                    value={editingProject?.budget || ''}\n                    onChange={(e) => {\n                      const inputValue = e.target.value;\n                      // Solo permitir nmeros y vaco\n                      if (inputValue === '' || /^\\d+$/.test(inputValue)) {\n                        const numValue = inputValue === '' ? '' : Number(inputValue);\n                        updateProjectField('budget', numValue);\n                        validateField('budget', numValue);\n                      }\n                    }}\n                    onBlur={(e) => {\n                      const value = e.target.value === '' ? '' : Number(e.target.value);\n                      validateField('budget', value);\n                    }}\n                    placeholder=\"Presupuesto en USD (ej: 100000)\"\n                    min=\"0\"\n                  />\n                  <ErrorMessage error={errors.budget} />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">TIR (%)</label>\n                  <input\n                    type=\"number\"\n                    className={`w-full border rounded px-3 py-2 ${errors.irr ? 'border-red-500' : 'border-gray-300'}`}\n                    value={editingProject?.irr || ''}\n                    onChange={(e) => {\n                      const inputValue = e.target.value;\n                      // Solo permitir nmeros, punto decimal y vaco\n                      if (inputValue === '' || /^\\d*\\.?\\d*$/.test(inputValue)) {\n                        const numValue = inputValue === '' ? '' : Number(inputValue);\n\n                        // Calcular plannedValue automticamente\n                        const period = editingProject?.period || 3;\n                        const budget = editingProject?.budget || 0;\n                        const newPlannedValue = budget * Math.pow(1 + (numValue / 100), period);\n\n                        updateProjectField('irr', numValue);\n                        updateProjectField('plannedValue', Math.round(newPlannedValue));\n                        validateField('irr', numValue);\n                      }\n                    }}\n                    onBlur={(e) => {\n                      const value = e.target.value === '' ? '' : Number(e.target.value);\n                      validateField('irr', value);\n                    }}\n                    placeholder=\"Tasa Interna de Retorno (ej: 15.5)\"\n                    min=\"0\"\n                    max=\"100\"\n                    step=\"0.01\"\n                  />\n                  <ErrorMessage error={errors.irr} />\n                </div>\n\n                {/* Campo: Periodo del Proyecto */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                    Periodo del Proyecto (aos)\n                  </label>\n                  <input\n                    type=\"number\"\n                    className=\"w-full border rounded px-3 py-2 border-gray-300\"\n                    value={editingProject?.period || 3}\n                    onChange={(e) => {\n                      const newPeriod = parseInt(e.target.value) || 3;\n\n                      // Recalcular plannedValue con nuevo periodo\n                      const budget = editingProject?.budget || 0;\n                      const irr = editingProject?.irr || 0;\n                      const newPlannedValue = budget * Math.pow(1 + (irr / 100), newPeriod);\n\n                      updateProjectField('period', newPeriod);\n                      updateProjectField('plannedValue', Math.round(newPlannedValue));\n                    }}\n                    placeholder=\"Ej: 3\"\n                    min=\"1\"\n                    max=\"20\"\n                  />\n                  <p className=\"text-xs text-gray-500 mt-1\">\n                    Duracin estimada del proyecto para clculo de valor con TIR\n                  </p>\n                </div>\n\n                {/* Campo: Valor Planificado del Proyecto - ANCHO COMPLETO */}\n                <div className=\"md:col-span-2 bg-blue-50 p-4 rounded-lg border-2 border-blue-200\">\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1 flex items-center\">\n                     Valor Planificado del Proyecto (USD)\n                    <span className=\"ml-2 text-blue-600 text-xs font-semibold\">\n                      (Auto-calculado con TIR)\n                    </span>\n                  </label>\n                  <div className=\"relative\">\n                    <input\n                      type=\"number\"\n                      className=\"w-full border-2 rounded px-3 py-2 border-blue-300 bg-white text-lg font-semibold\"\n                      value={editingProject?.plannedValue || 0}\n                      onChange={(e) => {\n                        updateProjectField('plannedValue', parseFloat(e.target.value) || 0);\n                      }}\n                      placeholder=\"Calculado automticamente\"\n                      min=\"0\"\n                      step=\"10000\"\n                    />\n                    <button\n                      type=\"button\"\n                      onClick={() => {\n                        const budget = editingProject?.budget || 0;\n                        const irr = editingProject?.irr || 0;\n                        const period = editingProject?.period || 3;\n                        const calculated = budget * Math.pow(1 + (irr / 100), period);\n                        updateProjectField('plannedValue', Math.round(calculated));\n                      }}\n                      className=\"absolute right-2 top-2 text-xs bg-blue-500 text-white px-3 py-1.5 rounded hover:bg-blue-600 font-medium\"\n                      title=\"Recalcular automticamente\"\n                    >\n                       Recalcular\n                    </button>\n                  </div>\n                  <p className=\"text-xs text-blue-700 mt-2 font-medium\">\n                    Frmula: ${(editingProject?.budget || 0).toLocaleString()}  (1 + {editingProject?.irr || 0}%)^{editingProject?.period || 3} = <span className=\"text-green-600 font-bold\">${(editingProject?.plannedValue || 0).toLocaleString()}</span>\n                  </p>\n                  <p className=\"text-xs text-gray-600 mt-1\">\n                    Este valor se distribuir automticamente entre todas las tareas del cronograma segn su costo y prioridad.\n                  </p>\n                </div>\n\n                <div className=\"md:col-span-2\">\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Descripcin</label>\n                  <textarea\n                    className=\"w-full border rounded px-3 py-2\"\n                    rows=\"3\"\n                    value={editingProject?.description || ''}\n                    onChange={(e) => updateProjectField('description', e.target.value)}\n                    placeholder=\"Descripcin detallada del proyecto\"\n                  />\n                </div>\n\n                <div className=\"md:col-span-2\">\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Objetivo del Proyecto</label>\n                  <textarea\n                    className=\"w-full border rounded px-3 py-2\"\n                    rows=\"3\"\n                    value={editingProject?.objective || ''}\n                    onChange={(e) => updateProjectField('objective', e.target.value)}\n                    placeholder=\"Qu se busca lograr con este proyecto?\"\n                  />\n                </div>\n\n                <div className=\"md:col-span-2\">\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Caso de Negocio</label>\n                  <textarea\n                    className=\"w-full border rounded px-3 py-2\"\n                    rows=\"3\"\n                    value={editingProject?.businessCase || ''}\n                    onChange={(e) => updateProjectField('businessCase', e.target.value)}\n                    placeholder=\"Justificacin del proyecto desde el punto de vista del negocio\"\n                  />\n                </div>\n              </div>\n\n              <div className=\"flex justify-end space-x-3 mt-6\">\n                <button\n                  onClick={() => {\n                    setShowProjectModal(false);\n                    setEditingProject(null);\n                  }}\n                  className=\"px-4 py-2 border border-gray-300 rounded text-gray-700 hover:bg-gray-50\"\n                >\n                  Cancelar\n                </button>\n                <button\n                  onClick={handleSaveProject}\n                  disabled={Object.keys(errors).length > 0}\n                  className={`px-4 py-2 rounded transition-colors ${\n                    Object.keys(errors).length > 0\n                      ? 'bg-gray-400 text-gray-200 cursor-not-allowed'\n                      : 'bg-blue-600 text-white hover:bg-blue-700'\n                  }`}\n                >\n                  Guardar Proyecto {Object.keys(errors).length > 0 && `(${Object.keys(errors).length} errores)`}\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Modal de Upgrade cuando se alcanza el lmite */}\n      {showUpgradeModal && subscriptionLimit && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 z-[10000] flex items-center justify-center p-4\">\n          <div className=\"bg-white rounded-lg shadow-xl w-full max-w-md\">\n            <div className=\"p-6\">\n              <div className=\"flex items-center justify-center mb-4\">\n                <div className=\"w-16 h-16 bg-yellow-100 rounded-full flex items-center justify-center\">\n                  <span className=\"text-4xl\"></span>\n                </div>\n              </div>\n\n              <h2 className=\"text-xl font-bold text-center mb-2\">Lmite Alcanzado</h2>\n              <p className=\"text-gray-600 text-center mb-4\">{subscriptionLimit.message}</p>\n\n              <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4\">\n                <div className=\"flex justify-between items-center mb-2\">\n                  <span className=\"text-sm font-medium text-gray-700\">Proyectos actuales:</span>\n                  <span className=\"text-sm font-bold text-blue-600\">\n                    {subscriptionLimit.currentCount} / {subscriptionLimit.maxCount}\n                  </span>\n                </div>\n                <div className=\"w-full bg-gray-200 rounded-full h-2\">\n                  <div\n                    className=\"bg-blue-600 h-2 rounded-full\"\n                    style={{ width: `${(subscriptionLimit.currentCount / subscriptionLimit.maxCount) * 100}%` }}\n                  ></div>\n                </div>\n              </div>\n\n              <p className=\"text-sm text-gray-600 text-center mb-6\">{subscriptionLimit.suggestion}</p>\n\n              <div className=\"flex space-x-3\">\n                <button\n                  onClick={() => {\n                    setShowUpgradeModal(false);\n                    setSubscriptionLimit(null);\n                  }}\n                  className=\"flex-1 px-4 py-2 border border-gray-300 rounded text-gray-700 hover:bg-gray-50\"\n                >\n                  Cancelar\n                </button>\n                <button\n                  onClick={() => {\n                    // TODO: Redirigir a pgina de planes/upgrade\n                    alert(' Funcin de upgrade en desarrollo. Aqu se redigira a la pgina de planes.');\n                    setShowUpgradeModal(false);\n                    setSubscriptionLimit(null);\n                  }}\n                  className=\"flex-1 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700\"\n                >\n                  Ver Planes\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default PortfolioDashboard;\n","import React, { useState, useMemo } from 'react';\n\nconst ResourceList = ({ \n  globalResources, \n  setGlobalResources \n}) => {\n  const [showAddModal, setShowAddModal] = useState(false);\n  const [showEditModal, setShowEditModal] = useState(false);\n  const [editingResource, setEditingResource] = useState(null);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [roleFilter, setRoleFilter] = useState('all');\n  const [statusFilter, setStatusFilter] = useState('all');\n\n  // Estados para nuevo recurso\n  const [newResource, setNewResource] = useState({\n    name: '',\n    role: '',\n    skills: '',\n    availability: 100,\n    hourlyRate: 0,\n    status: 'active',\n    email: '',\n    phone: '',\n    department: '',\n    experience: '',\n    certifications: '',\n    notes: ''\n  });\n\n  // Filtrar recursos\n  const filteredResources = useMemo(() => {\n    return globalResources.filter(resource => {\n      const matchesSearch = !searchTerm || \n        resource.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        resource.role.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        (resource.email && resource.email.toLowerCase().includes(searchTerm.toLowerCase()));\n      \n      const matchesRole = roleFilter === 'all' || resource.role === roleFilter;\n      const matchesStatus = statusFilter === 'all' || resource.status === statusFilter;\n      \n      return matchesSearch && matchesRole && matchesStatus;\n    });\n  }, [globalResources, searchTerm, roleFilter, statusFilter]);\n\n  // Obtener roles nicos\n  const uniqueRoles = useMemo(() => {\n    const roles = globalResources.map(r => r.role);\n    return Array.from(new Set(roles));\n  }, [globalResources]);\n\n  // Calcular mtricas de recursos\n  const resourceMetrics = useMemo(() => {\n    const totalResources = globalResources.length;\n    const activeResources = globalResources.filter(r => r.status === 'active').length;\n    const inactiveResources = globalResources.filter(r => r.status === 'inactive').length;\n    const onLeaveResources = globalResources.filter(r => r.status === 'on-leave').length;\n    \n    const totalCost = globalResources.reduce((sum, r) => {\n      const monthlyHours = r.availability * 160; // 160 horas por mes\n      return sum + (monthlyHours * r.hourlyRate);\n    }, 0);\n\n    return {\n      totalResources,\n      activeResources,\n      inactiveResources,\n      onLeaveResources,\n      totalCost\n    };\n  }, [globalResources]);\n\n  // Agregar nuevo recurso\n  const handleAddResource = () => {\n    if (!newResource.name || !newResource.role) return;\n\n    const resource = {\n      id: 'res-' + String(Date.now()).slice(-6),\n      name: newResource.name,\n      role: newResource.role,\n      skills: newResource.skills.split(',').map(s => s.trim()).filter(s => s),\n      experience: newResource.experience,\n      certifications: newResource.certifications ? newResource.certifications.split(',').map(s => s.trim()).filter(s => s) : [],\n      notes: newResource.notes\n    };\n    \n    console.log(' Agregando nuevo recurso:', resource);\n    console.log(' Recursos actuales antes de agregar:', globalResources);\n    \n    setGlobalResources(prev => {\n      const newResources = prev.slice();\n      newResources.push(resource);\n      console.log(' Nuevos recursos despus de agregar:', newResources);\n      return newResources;\n    });\n    \n    setShowAddModal(false);\n    setNewResource({\n      name: '',\n      role: '',\n      skills: '',\n      availability: 100,\n      hourlyRate: 0,\n      status: 'active',\n      email: '',\n      phone: '',\n      department: '',\n      experience: '',\n      certifications: '',\n      notes: ''\n    });\n  };\n\n  // Editar recurso existente\n  const handleEditResource = () => {\n    if (!editingResource) return;\n\n    setGlobalResources(prev => prev.map(resource => {\n      if (resource.id === editingResource.id) {\n        return Object.assign({}, resource, {\n          name: editingResource.name,\n          role: editingResource.role,\n          skills: editingResource.skills.split(',').map(s => s.trim()).filter(s => s),\n          availability: editingResource.availability,\n          hourlyRate: editingResource.hourlyRate,\n          status: editingResource.status,\n          email: editingResource.email || resource.email,\n          phone: editingResource.phone || resource.phone,\n          department: editingResource.department || resource.department,\n          experience: editingResource.experience || resource.experience,\n          certifications: editingResource.certifications ? editingResource.certifications.split(',').map(s => s.trim()).filter(s => s) : resource.certifications,\n          notes: editingResource.notes || resource.notes\n        });\n      }\n      return resource;\n    }));\n\n    setShowEditModal(false);\n    setEditingResource(null);\n  };\n\n  // Abrir modal de edicin\n  const openEditModal = (resource) => {\n    setEditingResource(Object.assign({}, resource, {\n      skills: Array.isArray(resource.skills) ? resource.skills.join(', ') : resource.skills,\n      certifications: Array.isArray(resource.certifications) ? resource.certifications.join(', ') : resource.certifications\n    }));\n    setShowEditModal(true);\n  };\n\n  // Eliminar recurso\n  const handleDeleteResource = (id) => {\n    if (window.confirm('Ests seguro de que quieres eliminar este recurso?')) {\n      setGlobalResources(prev => prev.filter(r => r.id !== id));\n    }\n  };\n\n  // Obtener color de estado\n  const getStatusColor = (status) => {\n    switch(status) {\n      case 'active': return 'bg-green-100 text-green-800';\n      case 'inactive': return 'bg-gray-100 text-gray-800';\n      case 'on-leave': return 'bg-yellow-100 text-yellow-800';\n      case 'terminated': return 'bg-red-100 text-red-800';\n      default: return 'bg-gray-100 text-gray-800';\n    }\n  };\n\n  // Obtener icono de estado\n  const getStatusIcon = (status) => {\n    switch(status) {\n      case 'active': return '';\n      case 'inactive': return '';\n      case 'on-leave': return '';\n      case 'terminated': return '';\n      default: return '';\n    }\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex items-center mb-6\">\n        <div className=\"bg-blue-100 rounded-2xl p-3 mr-4 shadow-sm\">\n          <span className=\"text-3xl\"></span>\n        </div>\n        <div>\n          <p className=\"text-gray-600 text-lg\">Gestin global de recursos humanos del portafolio</p>\n        </div>\n      </div>\n\n      {/* Mtricas de Recursos */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4\">\n        <div className=\"bg-white rounded-xl p-4 border border-blue-200 hover:shadow-md transition-all duration-300\">\n          <div className=\"flex items-center space-x-2 mb-2\">\n            <span className=\"text-lg\"></span>\n            <span className=\"text-sm font-medium text-blue-600\">Total Recursos</span>\n          </div>\n          <div className=\"text-2xl font-bold text-gray-800\">{resourceMetrics.totalResources}</div>\n        </div>\n\n        <div className=\"bg-white rounded-xl p-4 border border-green-200 hover:shadow-md transition-all duration-300\">\n          <div className=\"flex items-center space-x-2 mb-2\">\n            <span className=\"text-lg\"></span>\n            <span className=\"text-sm font-medium text-green-600\">Activos</span>\n          </div>\n          <div className=\"text-2xl font-bold text-gray-800\">{resourceMetrics.activeResources}</div>\n        </div>\n\n        <div className=\"bg-white rounded-xl p-4 border border-gray-200 hover:shadow-md transition-all duration-300\">\n          <div className=\"flex items-center space-x-2 mb-2\">\n            <span className=\"text-lg\"></span>\n            <span className=\"text-sm font-medium text-gray-600\">Inactivos</span>\n          </div>\n          <div className=\"text-2xl font-bold text-gray-800\">{resourceMetrics.inactiveResources}</div>\n        </div>\n\n        <div className=\"bg-white rounded-xl p-4 border border-yellow-200 hover:shadow-md transition-all duration-300\">\n          <div className=\"flex items-center space-x-2 mb-2\">\n            <span className=\"text-lg\"></span>\n            <span className=\"text-sm font-medium text-yellow-600\">En Licencia</span>\n          </div>\n          <div className=\"text-2xl font-bold text-gray-800\">{resourceMetrics.onLeaveResources}</div>\n        </div>\n\n        <div className=\"bg-white rounded-xl p-4 border border-purple-200 hover:shadow-md transition-all duration-300\">\n          <div className=\"flex items-center space-x-2 mb-2\">\n            <span className=\"text-lg\"></span>\n            <span className=\"text-sm font-medium text-purple-600\">Costo Mensual</span>\n          </div>\n          <div className=\"text-2xl font-bold text-gray-800\">${(resourceMetrics.totalCost / 1000).toFixed(0)}K</div>\n        </div>\n      </div>\n\n      {/* Controles */}\n      <div className=\"bg-white rounded-xl p-4 border border-blue-200\">\n        <div className=\"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0\">\n          <div className=\"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-4\">\n            <input\n              type=\"text\"\n              placeholder=\"Buscar recursos...\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n              className=\"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n            />\n            \n            <select\n              value={roleFilter}\n              onChange={(e) => setRoleFilter(e.target.value)}\n              className=\"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n            >\n              <option value=\"all\">Todos los roles</option>\n              {uniqueRoles.map(role => (\n                <option key={role} value={role}>{role}</option>\n              ))}\n            </select>\n\n            <select\n              value={statusFilter}\n              onChange={(e) => setStatusFilter(e.target.value)}\n              className=\"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n            >\n              <option value=\"all\">Todos los estados</option>\n              <option value=\"active\">Activo</option>\n              <option value=\"inactive\">Inactivo</option>\n              <option value=\"on-leave\">En licencia</option>\n              <option value=\"terminated\">Terminado</option>\n            </select>\n          </div>\n          \n          <div className=\"flex space-x-2\">\n            <button\n              onClick={() => setShowAddModal(true)}\n              className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2\"\n            >\n              <span></span>\n              <span>Agregar Recurso</span>\n            </button>\n          </div>\n        </div>\n      </div>\n\n      {/* Tabla de Recursos */}\n      <div className=\"bg-white rounded-xl shadow-sm overflow-hidden border border-gray-200\">\n        <div className=\"overflow-x-auto\">\n          <table className=\"min-w-full divide-y divide-gray-200\">\n            <thead className=\"bg-gray-50\">\n              <tr>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Recurso\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Rol\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Disponibilidad\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Costo/Hora\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Estado\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Acciones\n                </th>\n              </tr>\n            </thead>\n            <tbody className=\"bg-white divide-y divide-gray-200\">\n              {filteredResources.length === 0 ? (\n                <tr>\n                  <td colSpan=\"6\" className=\"px-6 py-12 text-center text-gray-500\">\n                    <div className=\"flex flex-col items-center\">\n                      <span className=\"text-4xl mb-2\"></span>\n                      <p className=\"text-lg font-medium\">No hay recursos registrados</p>\n                      <p className=\"text-sm\">Agrega tu primer recurso para comenzar</p>\n                    </div>\n                  </td>\n                </tr>\n              ) : (\n                filteredResources.map((resource) => (\n                  <tr key={resource.id} className=\"hover:bg-gray-50\">\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <div className=\"flex items-center\">\n                        <div className=\"flex-shrink-0 h-10 w-10\">\n                          <div className=\"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center\">\n                            <span className=\"text-sm font-medium text-blue-700\">\n                              {resource.name.split(' ').map(n => n[0]).join('')}\n                            </span>\n                          </div>\n                        </div>\n                        <div className=\"ml-4\">\n                          <div className=\"text-sm font-medium text-gray-900\">\n                            {resource.name}\n                          </div>\n                          <div className=\"text-sm text-gray-500\">\n                            {resource.email || 'Sin email'}\n                          </div>\n                        </div>\n                      </div>\n                    </td>\n                    \n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <span className=\"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full\">\n                        {resource.role}\n                      </span>\n                    </td>\n                    \n                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                      {resource.availability}%\n                    </td>\n                    \n                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                      ${resource.hourlyRate}/h\n                    </td>\n                    \n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <span className={`px-2 py-1 text-xs font-medium rounded-full ${getStatusColor(resource.status)}`}>\n                        {getStatusIcon(resource.status)} {resource.status === 'active' ? 'Activo' :\n                         resource.status === 'inactive' ? 'Inactivo' :\n                         resource.status === 'on-leave' ? 'Licencia' :\n                         'Terminado'}\n                      </span>\n                    </td>\n                    \n                    <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium\">\n                      <div className=\"flex space-x-2\">\n                        <button\n                          onClick={() => openEditModal(resource)}\n                          className=\"text-blue-600 hover:text-blue-900\"\n                          title=\"Editar recurso\"\n                        >\n                          \n                        </button>\n                        <button\n                          onClick={() => handleDeleteResource(resource.id)}\n                          className=\"text-red-600 hover:text-red-900\"\n                          title=\"Eliminar recurso\"\n                        >\n                          \n                        </button>\n                      </div>\n                    </td>\n                  </tr>\n                ))\n              )}\n            </tbody>\n          </table>\n        </div>\n      </div>\n\n      {/* Modal para agregar recurso */}\n      {showAddModal && (\n        <div className=\"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50\">\n          <div className=\"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white\">\n            <div className=\"mt-3\">\n              <h3 className=\"text-lg font-medium text-gray-900 mb-4\">Agregar Nuevo Recurso</h3>\n              \n              <div className=\"space-y-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700\">Nombre *</label>\n                  <input\n                    type=\"text\"\n                    value={newResource.name}\n                    onChange={(e) => setNewResource({\n                      id: newResource.id,\n                      role: newResource.role,\n                      email: newResource.email,\n                      skills: newResource.skills,\n                      availability: newResource.availability,\n                      hourlyRate: newResource.hourlyRate,\n                      status: newResource.status,\n                      name: e.target.value})}\n                    className=\"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                    placeholder=\"Nombre completo\"\n                  />\n                </div>\n                \n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700\">Rol *</label>\n                  <input\n                    type=\"text\"\n                    value={newResource.role}\n                    onChange={(e) => setNewResource({\n                      id: newResource.id,\n                      name: newResource.name,\n                      email: newResource.email,\n                      skills: newResource.skills,\n                      availability: newResource.availability,\n                      hourlyRate: newResource.hourlyRate,\n                      status: newResource.status,\n                      role: e.target.value})}\n                    className=\"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                    placeholder=\"Ej: Project Manager, Desarrollador, etc.\"\n                  />\n                </div>\n                \n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700\">Email</label>\n                  <input\n                    type=\"email\"\n                    value={newResource.email}\n                    onChange={(e) => setNewResource({\n                      id: newResource.id,\n                      name: newResource.name,\n                      role: newResource.role,\n                      skills: newResource.skills,\n                      availability: newResource.availability,\n                      hourlyRate: newResource.hourlyRate,\n                      status: newResource.status,\n                      email: e.target.value})}\n                    className=\"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                    placeholder=\"email@empresa.com\"\n                  />\n                </div>\n                \n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700\">Habilidades (separadas por comas)</label>\n                  <input\n                    type=\"text\"\n                    value={newResource.skills}\n                    onChange={(e) => setNewResource({\n                      id: newResource.id,\n                      name: newResource.name,\n                      role: newResource.role,\n                      email: newResource.email,\n                      availability: newResource.availability,\n                      hourlyRate: newResource.hourlyRate,\n                      status: newResource.status,\n                      skills: e.target.value})}\n                    className=\"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                    placeholder=\"React, JavaScript, PMBOK, etc.\"\n                  />\n                </div>\n                \n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700\">Disponibilidad (%)</label>\n                    <input\n                      type=\"number\"\n                      min=\"0\"\n                      max=\"100\"\n                      value={newResource.availability}\n                      onChange={(e) => setNewResource({\n                      id: newResource.id,\n                      name: newResource.name,\n                      role: newResource.role,\n                      email: newResource.email,\n                      skills: newResource.skills,\n                      hourlyRate: newResource.hourlyRate,\n                      status: newResource.status,\n                      availability: Number(e.target.value)})}\n                      className=\"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                    />\n                  </div>\n                  \n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700\">Costo por Hora ($)</label>\n                    <input\n                      type=\"number\"\n                      min=\"0\"\n                      value={newResource.hourlyRate}\n                      onChange={(e) => setNewResource({\n                      id: newResource.id,\n                      name: newResource.name,\n                      role: newResource.role,\n                      email: newResource.email,\n                      skills: newResource.skills,\n                      availability: newResource.availability,\n                      status: newResource.status,\n                      hourlyRate: Number(e.target.value)})}\n                      className=\"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                    />\n                  </div>\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700\">Estado</label>\n                  <select\n                    value={newResource.status}\n                    onChange={(e) => setNewResource({\n                      id: newResource.id,\n                      name: newResource.name,\n                      role: newResource.role,\n                      email: newResource.email,\n                      skills: newResource.skills,\n                      availability: newResource.availability,\n                      hourlyRate: newResource.hourlyRate,\n                      status: e.target.value})}\n                    className=\"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                  >\n                    <option value=\"active\">Activo</option>\n                    <option value=\"inactive\">Inactivo</option>\n                    <option value=\"on-leave\">En licencia</option>\n                    <option value=\"terminated\">Terminado</option>\n                  </select>\n                </div>\n              </div>\n              \n              <div className=\"flex justify-end space-x-3 mt-6\">\n                <button\n                  onClick={() => setShowAddModal(false)}\n                  className=\"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 transition-colors\"\n                >\n                  Cancelar\n                </button>\n                <button\n                  onClick={handleAddResource}\n                  className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors\"\n                >\n                  Agregar\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Modal para editar recurso */}\n      {showEditModal && editingResource && (\n        <div className=\"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50\">\n          <div className=\"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white\">\n            <div className=\"mt-3\">\n              <h3 className=\"text-lg font-medium text-gray-900 mb-4\">Editar Recurso</h3>\n              \n              <div className=\"space-y-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700\">Nombre *</label>\n                  <input\n                    type=\"text\"\n                    value={editingResource.name}\n                    onChange={(e) => setEditingResource({\n                      id: editingResource.id,\n                      role: editingResource.role,\n                      email: editingResource.email,\n                      skills: editingResource.skills,\n                      availability: editingResource.availability,\n                      hourlyRate: editingResource.hourlyRate,\n                      status: editingResource.status,\n                      name: e.target.value})}\n                    className=\"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                  />\n                </div>\n                \n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700\">Rol *</label>\n                  <input\n                    type=\"text\"\n                    value={editingResource.role}\n                    onChange={(e) => setEditingResource({\n                      id: editingResource.id,\n                      name: editingResource.name,\n                      email: editingResource.email,\n                      skills: editingResource.skills,\n                      availability: editingResource.availability,\n                      hourlyRate: editingResource.hourlyRate,\n                      status: editingResource.status,\n                      role: e.target.value})}\n                    className=\"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                  />\n                </div>\n                \n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700\">Email</label>\n                  <input\n                    type=\"email\"\n                    value={editingResource.email}\n                    onChange={(e) => setEditingResource({\n                      id: editingResource.id,\n                      name: editingResource.name,\n                      role: editingResource.role,\n                      skills: editingResource.skills,\n                      availability: editingResource.availability,\n                      hourlyRate: editingResource.hourlyRate,\n                      status: editingResource.status,\n                      email: e.target.value})}\n                    className=\"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                  />\n                </div>\n                \n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700\">Habilidades (separadas por comas)</label>\n                  <input\n                    type=\"text\"\n                    value={editingResource.skills}\n                    onChange={(e) => setEditingResource({\n                      id: editingResource.id,\n                      name: editingResource.name,\n                      role: editingResource.role,\n                      email: editingResource.email,\n                      availability: editingResource.availability,\n                      hourlyRate: editingResource.hourlyRate,\n                      status: editingResource.status,\n                      skills: e.target.value})}\n                    className=\"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                  />\n                </div>\n                \n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700\">Disponibilidad (%)</label>\n                    <input\n                      type=\"number\"\n                      min=\"0\"\n                      max=\"100\"\n                      value={editingResource.availability}\n                      onChange={(e) => setEditingResource({\n                      id: editingResource.id,\n                      name: editingResource.name,\n                      role: editingResource.role,\n                      email: editingResource.email,\n                      skills: editingResource.skills,\n                      hourlyRate: editingResource.hourlyRate,\n                      status: editingResource.status,\n                      availability: Number(e.target.value)})}\n                      className=\"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                    />\n                  </div>\n                  \n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700\">Costo por Hora ($)</label>\n                    <input\n                      type=\"number\"\n                      min=\"0\"\n                      value={editingResource.hourlyRate}\n                      onChange={(e) => setEditingResource({\n                      id: editingResource.id,\n                      name: editingResource.name,\n                      role: editingResource.role,\n                      email: editingResource.email,\n                      skills: editingResource.skills,\n                      availability: editingResource.availability,\n                      status: editingResource.status,\n                      hourlyRate: Number(e.target.value)})}\n                      className=\"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                    />\n                  </div>\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700\">Estado</label>\n                  <select\n                    value={editingResource.status}\n                    onChange={(e) => setEditingResource({\n                      id: editingResource.id,\n                      name: editingResource.name,\n                      role: editingResource.role,\n                      email: editingResource.email,\n                      skills: editingResource.skills,\n                      availability: editingResource.availability,\n                      hourlyRate: editingResource.hourlyRate,\n                      status: e.target.value})}\n                    className=\"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                  >\n                    <option value=\"active\">Activo</option>\n                    <option value=\"inactive\">Inactivo</option>\n                    <option value=\"on-leave\">En licencia</option>\n                    <option value=\"terminated\">Terminado</option>\n                  </select>\n                </div>\n              </div>\n              \n              <div className=\"flex justify-end space-x-3 mt-6\">\n                <button\n                  onClick={() => {\n                    setShowEditModal(false);\n                    setEditingResource(null);\n                  }}\n                  className=\"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 transition-colors\"\n                >\n                  Cancelar\n                </button>\n                <button\n                  onClick={handleEditResource}\n                  className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors\"\n                >\n                  Guardar Cambios\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default ResourceList;\n","import React, { useState, useEffect, useMemo, useCallback } from 'react';\nimport { Calendar, Clock, CheckCircle, AlertCircle, Users, FileText, TrendingUp, Download } from 'lucide-react';\n//  OPCIONAL: Descomentar si quieres usar el indicador de carga\n// import { Calendar, Clock, CheckCircle, AlertCircle, Users, FileText, TrendingUp, Download, Loader2 } from 'lucide-react';\nimport { jsPDF } from 'jspdf';\n\n// ============================================================================\n// UTILIDADES - Movidas fuera del componente para mejor rendimiento\n// ============================================================================\n\nconst DEBUG_MODE = false; //  Control centralizado de logs\n\nconst log = (...args) => {\n  if (DEBUG_MODE) console.log(...args);\n};\n\nconst isValidDate = (dateString) => {\n  if (!dateString) return false;\n  const date = new Date(dateString);\n  return !isNaN(date.getTime()) && date.getFullYear() > 1900;\n};\n\nconst normalizeDate = (dateString) => {\n  if (!isValidDate(dateString)) return null;\n  const date = new Date(dateString);\n  date.setHours(0, 0, 0, 0);\n  return date;\n};\n\nconst getStartOfWeek = (date) => {\n  const d = new Date(date);\n  const day = d.getDay();\n  const diff = d.getDate() - day + (day === 0 ? -6 : 1);\n  d.setDate(diff);\n  d.setHours(0, 0, 0, 0);\n  return d;\n};\n\nconst getEndOfWeek = (date) => {\n  const d = new Date(date);\n  const day = d.getDay();\n  const diff = d.getDate() - day + (day === 0 ? -6 : 1) + 6;\n  d.setDate(diff);\n  d.setHours(0, 0, 0, 0); //  Normalizado a medianoche para consistencia\n  return d;\n};\n\nconst formatDate = (date) => {\n  if (!date) return 'N/A';\n  return new Date(date).toLocaleDateString('es-ES', {\n    day: '2-digit',\n    month: '2-digit',\n    year: 'numeric'\n  });\n};\n\n//  Funciones centralizadas para estado de tareas\nconst isTaskCompleted = (task, isMinuteTask = false) => {\n  if (isMinuteTask) {\n    const estatus = (task.estatus || '').toLowerCase().trim();\n    return estatus === 'completado' || estatus === 'completada';\n  }\n  return task.progress === 100;\n};\n\nconst isTaskPending = (task, isMinuteTask = false) => {\n  return !isTaskCompleted(task, isMinuteTask);\n};\n\n// ============================================================================\n// COMPONENTE PRINCIPAL\n// ============================================================================\n\nconst WeeklyPlanningTab = ({ \n  projects, \n  tasksByProject, \n  minutasByProject, \n  weeklyPlanningData, \n  setWeeklyPlanningData,\n  useSupabase = false //  Nuevo prop para determinar fuente de datos\n}) => {\n  // Estado\n  const [dateRange, setDateRange] = useState(weeklyPlanningData?.dateRange || {\n    start: getStartOfWeek(new Date()),\n    end: getEndOfWeek(new Date())\n  });\n  const [previousWeekData, setPreviousWeekData] = useState(null);\n  const [isLoading, setIsLoading] = useState(false);\n  \n  //  NUEVO: Estado local para minutas (independiente de props)\n  const [localMinutaTasks, setLocalMinutaTasks] = useState({});\n  const [loadingMinutas, setLoadingMinutas] = useState(false);\n  \n  //  OPCIONAL: Descomenta si quieres manejo de errores en UI\n  // const [error, setError] = useState(null);\n\n  //  NUEVO: Escuchar eventos de actualizacin de tareas de minutas\n  useEffect(() => {\n    const handleMinutaStatusChanged = (event) => {\n      const { tareaId, newStatus, projectId, timestamp } = event.detail;\n      console.log(' WeeklyPlanningTab: Evento minutaStatusChanged recibido:', { tareaId, newStatus, projectId, timestamp });\n      \n      // Forzar re-render del componente para actualizar las tareas de minutas\n      console.log(' WeeklyPlanningTab: Forzando re-render de tareas de minutas...');\n      // El componente se re-renderizar automticamente cuando cambien los datos\n    };\n\n    // Agregar listener\n    window.addEventListener('minutaStatusChanged', handleMinutaStatusChanged);\n\n    // Cleanup\n    return () => {\n      window.removeEventListener('minutaStatusChanged', handleMinutaStatusChanged);\n    };\n  }, []);\n\n  //  Proyectos activos memoizados\n  const activeProjects = useMemo(() => {\n    const filtered = projects.filter(p => p.status === 'active');\n    \n    log(' PROYECTOS ACTIVOS:', {\n      total: projects.length,\n      active: filtered.length,\n      projects: filtered.map(p => ({ id: p.id, name: p.name }))\n    });\n    \n    log(' ESTRUCTURA DE DATOS:', {\n      tasksByProjectKeys: Object.keys(tasksByProject || {}),\n      minutasByProjectKeys: Object.keys(localMinutaTasks || {}),\n      tasksByProject: tasksByProject,\n      localMinutaTasks: localMinutaTasks\n    });\n    \n    return filtered;\n  }, [projects, tasksByProject, localMinutaTasks]);\n\n  //  Rango de semana anterior memoizado\n  const previousWeekRange = useMemo(() => {\n    const start = new Date(dateRange.start);\n    start.setDate(start.getDate() - 7);\n    const end = new Date(dateRange.end);\n    end.setDate(end.getDate() - 7);\n    return { start, end };\n  }, [dateRange]);\n\n  //  Fecha actual memoizada\n  const today = useMemo(() => {\n    const d = new Date();\n    d.setHours(0, 0, 0, 0);\n    return d;\n  }, []);\n\n  // ============================================================================\n  // FUNCIONES DE FILTRADO - Ahora con useCallback para evitar recreacin\n  // ============================================================================\n\n  //  Funcin genrica para filtrar tareas por rango de fechas\n  const filterTasksByDateRange = useCallback((tasks, startDate, endDate, isMinuteTask = false) => {\n    return tasks.filter(task => {\n      const taskDate = normalizeDate(\n        isMinuteTask ? task.fecha : (task.endDate || task.startDate)\n      );\n      \n      if (!taskDate) {\n        log(` Fecha invlida en tarea:`, task.name || task.tarea);\n        return false;\n      }\n      \n      return taskDate >= startDate && taskDate <= endDate;\n    });\n  }, []);\n\n  //  Funcin genrica para filtrar tareas vencidas\n  const filterOverdueTasks = useCallback((tasks, isMinuteTask = false) => {\n    return tasks.filter(task => {\n      const dueDate = normalizeDate(\n        isMinuteTask ? task.fecha : (task.endDate || task.startDate)\n      );\n      \n      if (!dueDate) {\n        log(` Fecha invlida en tarea vencida:`, task.name || task.tarea);\n        return false;\n      }\n      \n      const isPending = isTaskPending(task, isMinuteTask);\n      return dueDate < today && isPending;\n    });\n  }, [today]);\n\n  //  Obtener tareas de la semana actual (memoizado por proyecto)\n  const getCurrentWeekTasks = useCallback((projectId) => {\n    const projectTasks = tasksByProject[projectId] || [];\n    const projectMinuteTasks = localMinutaTasks[projectId] || [];\n    \n    log(' getCurrentWeekTasks:', {\n      projectId,\n      totalScheduleTasks: projectTasks.length,\n      totalMinuteTasks: projectMinuteTasks.length,\n      dateRange: {\n        start: dateRange.start.toISOString().split('T')[0],\n        end: dateRange.end.toISOString().split('T')[0]\n      }\n    });\n    \n    // Debug detallado de tareas del proyecto\n    if (projectTasks.length > 0) {\n      log(' Tareas de cronograma del proyecto:', projectTasks.map(t => ({\n        id: t.id,\n        name: t.name,\n        endDate: t.endDate,\n        progress: t.progress\n      })));\n    }\n    \n    if (projectMinuteTasks.length > 0) {\n      log(' Tareas de minutas del proyecto:', projectMinuteTasks.map(t => ({\n        id: t.id,\n        tarea: t.tarea,\n        fecha: t.fecha,\n        estatus: t.estatus\n      })));\n    }\n    \n    // Filtrar tareas pendientes de cronograma\n    const scheduleTasks = filterTasksByDateRange(projectTasks, dateRange.start, dateRange.end)\n      .filter(task => isTaskPending(task, false));\n    \n    // Filtrar tareas pendientes de minutas\n    const minuteTasks = filterTasksByDateRange(projectMinuteTasks, dateRange.start, dateRange.end, true)\n      .filter(task => isTaskPending(task, true));\n\n    log(' Tareas de semana actual:', {\n      projectId,\n      scheduleTasks: scheduleTasks.length,\n      minuteTasks: minuteTasks.length,\n      totalFiltered: scheduleTasks.length + minuteTasks.length\n    });\n\n    return { scheduleTasks, minuteTasks };\n  }, [tasksByProject, localMinutaTasks, dateRange, filterTasksByDateRange]);\n\n  //  Obtener tareas vencidas (memoizado por proyecto)\n  const getOverdueTasks = useCallback((projectId) => {\n    const projectTasks = tasksByProject[projectId] || [];\n    const projectMinuteTasks = localMinutaTasks[projectId] || [];\n    \n    log(' getOverdueTasks:', { projectId, today: today.toISOString().split('T')[0] });\n    \n    const scheduleTasks = filterOverdueTasks(projectTasks, false);\n    const minuteTasks = filterOverdueTasks(projectMinuteTasks, true);\n\n    log(' Tareas vencidas:', {\n      projectId,\n      scheduleTasks: scheduleTasks.length,\n      minuteTasks: minuteTasks.length\n    });\n\n    return { scheduleTasks, minuteTasks };\n  }, [tasksByProject, localMinutaTasks, today, filterOverdueTasks]);\n\n  // ============================================================================\n  // CLCULO DE CUMPLIMIENTO SEMANA PASADA\n  // ============================================================================\n\n  const calculatePreviousWeekCompliance = useCallback(async () => {\n    const compliance = {\n      totalTasks: 0,\n      completedTasks: 0,\n      pendingTasks: 0,\n      overdueTasks: 0,\n      byProject: {}\n    };\n\n    for (const project of activeProjects) {\n      const projectTasks = tasksByProject[project.id] || [];\n      const projectMinuteTasks = localMinutaTasks[project.id] || [];\n      \n      // Tareas que vencan en la semana pasada\n      const previousWeekScheduleTasks = filterTasksByDateRange(\n        projectTasks, \n        previousWeekRange.start, \n        previousWeekRange.end\n      );\n      \n      const previousWeekMinuteTasks = filterTasksByDateRange(\n        projectMinuteTasks, \n        previousWeekRange.start, \n        previousWeekRange.end, \n        true\n      );\n\n      const allPreviousTasks = [...previousWeekScheduleTasks, ...previousWeekMinuteTasks];\n      \n      // Contar por estado\n      const completed = allPreviousTasks.filter((task, idx) => \n        isTaskCompleted(task, idx >= previousWeekScheduleTasks.length)\n      ).length;\n      \n      const pending = allPreviousTasks.filter((task, idx) => \n        isTaskPending(task, idx >= previousWeekScheduleTasks.length)\n      ).length;\n      \n      // Tareas que vencieron la semana pasada y SIGUEN pendientes hoy\n      const overdue = allPreviousTasks.filter((task, idx) => {\n        const isMinute = idx >= previousWeekScheduleTasks.length;\n        const dueDate = normalizeDate(isMinute ? task.fecha : (task.endDate || task.startDate));\n        return dueDate < today && isTaskPending(task, isMinute);\n      }).length;\n      \n      compliance.byProject[project.id] = {\n        projectName: project.name,\n        total: allPreviousTasks.length,\n        completed,\n        pending,\n        overdue\n      };\n\n      compliance.totalTasks += allPreviousTasks.length;\n      compliance.completedTasks += completed;\n      compliance.pendingTasks += pending;\n      compliance.overdueTasks += overdue;\n    }\n\n    return compliance;\n  }, [activeProjects, tasksByProject, localMinutaTasks, previousWeekRange, today, filterTasksByDateRange]);\n\n  //  Cargar datos con manejo de errores mejorado\n  const loadPreviousWeekData = useCallback(async () => {\n    setIsLoading(true);\n    // if (setError) setError(null); // Descomentar si usas error state\n    \n    try {\n      const complianceData = await calculatePreviousWeekCompliance();\n      setPreviousWeekData(complianceData);\n    } catch (err) {\n      console.error('Error cargando datos de la semana pasada:', err);\n      // if (setError) setError('No se pudieron cargar los datos de la semana anterior'); // Descomentar si usas error state\n    } finally {\n      setIsLoading(false);\n    }\n  }, [calculatePreviousWeekCompliance]);\n\n  // Efecto para cargar datos\n  useEffect(() => {\n    loadPreviousWeekData();\n  }, [loadPreviousWeekData]);\n\n  //  Sincronizar estado con componente padre (para persistencia o estado global)\n  useEffect(() => {\n    if (setWeeklyPlanningData) {\n      setWeeklyPlanningData({ dateRange, previousWeekData });\n    }\n  }, [dateRange, previousWeekData, setWeeklyPlanningData]);\n\n  //  NUEVO: Cargar minutas independientemente (replicando lgica de ProjectManagementTabs.js)\n  useEffect(() => {\n    const loadMinutasForAllProjects = async () => {\n      if (!projects || projects.length === 0) return;\n\n      setLoadingMinutas(true);\n      try {\n        log(' WeeklyPlanningTab - Iniciando carga independiente de minutas para todos los proyectos activos');\n        \n        const minutasByProjectLocal = {};\n        \n        for (const project of activeProjects) {\n          try {\n            if (useSupabase) {\n              // Cargar desde Supabase si est habilitado\n              log(` Cargando minutas desde Supabase para proyecto: ${project.id}`);\n              const { default: supabaseService } = await import('../services/SupabaseService');\n              const { success, minutas } = await supabaseService.loadMinutasByProject(project.id);\n              if (success) {\n                minutasByProjectLocal[project.id] = minutas || [];\n                log(` Minutas cargadas desde Supabase para ${project.name}: ${minutas?.length || 0}`);\n              } else {\n                log(` Error cargando minutas desde Supabase para ${project.name}`);\n                minutasByProjectLocal[project.id] = [];\n              }\n            } else {\n              // Cargar desde portfolioData si est en modo local\n              const portfolioData = JSON.parse(localStorage.getItem('portfolioData') || '{}');\n              const minutasFromStorage = portfolioData.minutasByProject?.[project.id] || [];\n              minutasByProjectLocal[project.id] = minutasFromStorage;\n              log(` Minutas cargadas desde localStorage para ${project.name}: ${minutasFromStorage.length}`);\n            }\n          } catch (error) {\n            console.error(` Error cargando minutas para proyecto ${project.name}:`, error);\n            minutasByProjectLocal[project.id] = [];\n          }\n        }\n        \n        setLocalMinutaTasks(minutasByProjectLocal);\n        log(' WeeklyPlanningTab - Carga independiente de minutas completada:', {\n          totalProjects: activeProjects.length,\n          minutasByProject: Object.keys(minutasByProjectLocal).reduce((acc, key) => {\n            acc[key] = minutasByProjectLocal[key].length;\n            return acc;\n          }, {})\n        });\n        \n      } catch (error) {\n        console.error(' Error general cargando minutas en WeeklyPlanningTab:', error);\n        setLocalMinutaTasks({});\n      } finally {\n        setLoadingMinutas(false);\n      }\n    };\n\n    loadMinutasForAllProjects();\n  }, [projects, activeProjects, useSupabase]); //  Dependencias correctas\n\n  // ============================================================================\n  // FUNCIONES AUXILIARES\n  // ============================================================================\n\n  const getCompletionPercentage = () => {\n    if (!previousWeekData || previousWeekData.totalTasks === 0) return 0;\n    return Math.round((previousWeekData.completedTasks / previousWeekData.totalTasks) * 100);\n  };\n\n  //  Exportar PDF con manejo de errores\n  const exportToPDF = useCallback(() => {\n    try {\n      const doc = new jsPDF();\n      const pageWidth = doc.internal.pageSize.getWidth();\n      const pageHeight = doc.internal.pageSize.getHeight();\n      let yPosition = 20;\n\n      // Ttulo\n      doc.setFontSize(20);\n      doc.setFont(undefined, 'bold');\n      doc.text('Planificacin Semanal', pageWidth / 2, yPosition, { align: 'center' });\n      yPosition += 10;\n\n      // Fechas\n      doc.setFontSize(12);\n      doc.setFont(undefined, 'normal');\n      doc.text(`Perodo: ${formatDate(dateRange.start)} - ${formatDate(dateRange.end)}`, pageWidth / 2, yPosition, { align: 'center' });\n      yPosition += 20;\n\n      // Tareas por proyecto\n      doc.setFontSize(14);\n      doc.setFont(undefined, 'bold');\n      doc.text('Tareas de la Semana Actual', 20, yPosition);\n      yPosition += 15;\n\n      activeProjects.forEach((project) => {\n        const currentTasks = getCurrentWeekTasks(project.id);\n        const overdueTasks = getOverdueTasks(project.id);\n        \n        const allTasks = [\n          ...overdueTasks.scheduleTasks.map(t => ({ ...t, type: 'Cronograma', isOverdue: true })),\n          ...overdueTasks.minuteTasks.map(t => ({ \n            ...t, \n            type: 'Minuta', \n            name: t.tarea, \n            description: t.responsable, \n            endDate: t.fecha, \n            isOverdue: true \n          })),\n          ...currentTasks.scheduleTasks.map(t => ({ ...t, type: 'Cronograma', isOverdue: false })),\n          ...currentTasks.minuteTasks.map(t => ({ \n            ...t, \n            type: 'Minuta', \n            name: t.tarea, \n            description: t.responsable, \n            endDate: t.fecha, \n            isOverdue: false \n          }))\n        ];\n\n        if (allTasks.length === 0) return;\n\n        // Nueva pgina si es necesario\n        if (yPosition > pageHeight - 60) {\n          doc.addPage();\n          yPosition = 20;\n        }\n\n        // Nombre del proyecto\n        doc.setFontSize(12);\n        doc.setFont(undefined, 'bold');\n        doc.text(`${project.name}`, 20, yPosition);\n        yPosition += 8;\n\n        // Tareas vencidas\n        const overdueList = allTasks.filter(t => t.isOverdue);\n        if (overdueList.length > 0) {\n          doc.setFontSize(10);\n          doc.setFont(undefined, 'bold');\n          doc.setTextColor(220, 38, 38);\n          doc.text('Tareas Vencidas:', 25, yPosition);\n          yPosition += 6;\n\n          overdueList.forEach((task) => {\n            if (yPosition > pageHeight - 20) {\n              doc.addPage();\n              yPosition = 20;\n            }\n\n            // Dibujar checkbox\n            doc.setDrawColor(220, 38, 38); // Color rojo para tareas vencidas\n            doc.setLineWidth(0.3);\n            doc.rect(30, yPosition - 3, 3, 3); // Recuadro de 3x3mm\n\n            doc.setFontSize(9);\n            doc.setFont(undefined, 'normal');\n            doc.setTextColor(0, 0, 0);\n            doc.text(`${task.name} (${task.type})`, 35, yPosition);\n            yPosition += 4;\n            doc.text(`  Vence: ${formatDate(task.endDate)}`, 35, yPosition);\n            yPosition += 4;\n          });\n          yPosition += 5;\n        }\n\n        // Tareas de la semana\n        const currentList = allTasks.filter(t => !t.isOverdue);\n        if (currentList.length > 0) {\n          doc.setFontSize(10);\n          doc.setFont(undefined, 'bold');\n          doc.setTextColor(59, 130, 246);\n          doc.text('Tareas de la Semana:', 25, yPosition);\n          yPosition += 6;\n\n          currentList.forEach((task) => {\n            if (yPosition > pageHeight - 20) {\n              doc.addPage();\n              yPosition = 20;\n            }\n\n            // Dibujar checkbox\n            doc.setDrawColor(59, 130, 246); // Color azul para tareas de la semana\n            doc.setLineWidth(0.3);\n            doc.rect(30, yPosition - 3, 3, 3); // Recuadro de 3x3mm\n\n            doc.setFontSize(9);\n            doc.setFont(undefined, 'normal');\n            doc.setTextColor(0, 0, 0);\n            doc.text(`${task.name} (${task.type})`, 35, yPosition);\n            yPosition += 4;\n            doc.text(`  Vence: ${formatDate(task.endDate)}`, 35, yPosition);\n            if (task.description) {\n              yPosition += 4;\n              doc.text(`  Responsable: ${task.description}`, 35, yPosition);\n            }\n            yPosition += 4;\n          });\n        }\n\n        yPosition += 10;\n      });\n\n      // Guardar\n      const fileName = `Planificacion_Semanal_${formatDate(dateRange.start).replace(/\\//g, '-')}_${formatDate(dateRange.end).replace(/\\//g, '-')}.pdf`;\n      doc.save(fileName);\n    } catch (err) {\n      console.error('Error al exportar PDF:', err);\n      alert('Error al generar el PDF. Por favor intenta de nuevo.');\n    }\n  }, [dateRange, previousWeekData, activeProjects, getCurrentWeekTasks, getOverdueTasks]);\n\n  // ============================================================================\n  // RENDER\n  // ============================================================================\n\n  return (\n    <div className=\"weekly-planning-tab bg-gray-50 min-h-screen p-6\">\n      {/* Header */}\n      <div className=\"bg-white rounded-lg shadow-sm p-6 mb-6\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h2 className=\"text-2xl font-bold text-gray-900 flex items-center\">\n            <Calendar className=\"mr-3 h-8 w-8 text-blue-600\" />\n            Planificacin Semanal\n          </h2>\n          <div className=\"flex items-center space-x-4\">\n            <div className=\"flex items-center space-x-2\">\n              <label className=\"text-sm font-medium text-gray-700\">Desde:</label>\n              <input\n                type=\"date\"\n                value={dateRange.start.toISOString().split('T')[0]}\n                onChange={(e) => setDateRange(prev => ({ ...prev, start: new Date(e.target.value) }))}\n                className=\"px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n              />\n            </div>\n            <div className=\"flex items-center space-x-2\">\n              <label className=\"text-sm font-medium text-gray-700\">Hasta:</label>\n              <input\n                type=\"date\"\n                value={dateRange.end.toISOString().split('T')[0]}\n                onChange={(e) => setDateRange(prev => ({ ...prev, end: new Date(e.target.value) }))}\n                className=\"px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n              />\n            </div>\n            <button\n              onClick={exportToPDF}\n              // disabled={isLoading} //  OPCIONAL: Descomentar para deshabilitar durante carga\n              className=\"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              <Download className=\"w-4 h-4\" />\n              Exportar PDF\n            </button>\n          </div>\n        </div>\n      </div>\n\n      {/*  OPCIONAL: Indicador de carga - Descomenta si quieres mostrar loading */}\n      {/* {isLoading && (\n        <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6 flex items-center gap-3\">\n          <Loader2 className=\"w-5 h-5 text-blue-600 animate-spin\" />\n          <span className=\"text-blue-800\">Cargando datos de la semana...</span>\n        </div>\n      )} */}\n\n      {/*  OPCIONAL: Manejo de errores - Descomenta si agregas el estado 'error' */}\n      {/* {error && (\n        <div className=\"bg-red-50 border border-red-200 rounded-lg p-4 mb-6 flex items-center gap-3\">\n          <AlertCircle className=\"w-5 h-5 text-red-600\" />\n          <span className=\"text-red-800\">{error}</span>\n        </div>\n      )} */}\n\n      {/* Lista de Tareas por Proyecto */}\n      <div className=\"space-y-6\">\n        <div className=\"bg-white rounded-lg shadow-sm p-6\">\n          <h3 className=\"text-xl font-semibold text-gray-900 mb-6 flex items-center\">\n            <FileText className=\"mr-2 h-6 w-6 text-blue-600\" />\n            Tareas de la Semana Actual\n            <span className=\"ml-2 text-sm font-normal text-gray-500\">\n              ({formatDate(dateRange.start)} - {formatDate(dateRange.end)})\n            </span>\n          </h3>\n          \n          <div className=\"space-y-6\">\n            {activeProjects.map((project) => {\n              const currentTasks = getCurrentWeekTasks(project.id);\n              const overdueTasks = getOverdueTasks(project.id);\n              const totalTasks = currentTasks.scheduleTasks.length + currentTasks.minuteTasks.length + \n                               overdueTasks.scheduleTasks.length + overdueTasks.minuteTasks.length;\n              \n              if (totalTasks === 0) return null;\n              \n              return (\n                <ProjectTasksList\n                  key={project.id}\n                  project={project}\n                  currentTasks={currentTasks}\n                  overdueTasks={overdueTasks}\n                />\n              );\n            })}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\n// ============================================================================\n// COMPONENTE DE LISTA DE TAREAS DEL PROYECTO\n// ============================================================================\n\nconst ProjectTasksList = React.memo(({ project, currentTasks, overdueTasks }) => {\n  const allTasks = useMemo(() => [\n    ...overdueTasks.scheduleTasks.map(t => ({ ...t, type: 'Cronograma', isOverdue: true })),\n    ...overdueTasks.minuteTasks.map(t => ({ \n      ...t, \n      type: 'Minuta', \n      name: t.tarea, \n      description: t.responsable, \n      endDate: t.fecha, \n      isOverdue: true \n    })),\n    ...currentTasks.scheduleTasks.map(t => ({ ...t, type: 'Cronograma', isOverdue: false })),\n    ...currentTasks.minuteTasks.map(t => ({ \n      ...t, \n      type: 'Minuta', \n      name: t.tarea, \n      description: t.responsable, \n      endDate: t.fecha, \n      isOverdue: false \n    }))\n  ], [currentTasks, overdueTasks]);\n\n  if (allTasks.length === 0) {\n    return (\n      <div className=\"text-center py-8 text-gray-500\">\n        <FileText className=\"mx-auto h-12 w-12 text-gray-300 mb-4\" />\n        <p>No hay tareas para este proyecto en el perodo seleccionado.</p>\n      </div>\n    );\n  }\n\n  const overdueList = allTasks.filter(t => t.isOverdue);\n  const currentWeekTasks = allTasks.filter(t => !t.isOverdue);\n\n  return (\n    <div className=\"border border-gray-200 rounded-lg overflow-hidden\">\n      {/* Header del proyecto */}\n      <div className=\"bg-gray-50 px-6 py-4 border-b border-gray-200\">\n        <h4 className=\"text-lg font-semibold text-gray-900 flex items-center\">\n          <div className=\"w-3 h-3 bg-blue-500 rounded-full mr-3\"></div>\n          {project.name}\n          <span className=\"ml-2 text-sm font-normal text-gray-500\">\n            ({allTasks.length} tareas)\n          </span>\n        </h4>\n      </div>\n\n      <div className=\"divide-y divide-gray-200\">\n        {/* Tareas vencidas */}\n        {overdueList.length > 0 && (\n          <div className=\"p-6 bg-red-50\">\n            <h5 className=\"text-md font-semibold text-red-800 mb-4 flex items-center\">\n              <AlertCircle className=\"w-4 h-4 mr-2\" />\n              Tareas Vencidas ({overdueList.length})\n            </h5>\n            <div className=\"space-y-3\">\n              {overdueList.map((task, index) => (\n                <TaskCard key={`overdue-${index}`} task={task} isOverdue={true} />\n              ))}\n            </div>\n          </div>\n        )}\n\n        {/* Tareas de la semana actual */}\n        {currentWeekTasks.length > 0 && (\n          <div className=\"p-6\">\n            <h5 className=\"text-md font-semibold text-blue-800 mb-4 flex items-center\">\n              <Clock className=\"w-4 h-4 mr-2\" />\n              Tareas de la Semana ({currentWeekTasks.length})\n            </h5>\n            <div className=\"space-y-3\">\n              {currentWeekTasks.map((task, index) => (\n                <TaskCard key={`current-${index}`} task={task} isOverdue={false} />\n              ))}\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n});\n\n//  Componente reutilizable para tarjetas de tareas\nconst TaskCard = React.memo(({ task, isOverdue }) => (\n  <div className={`bg-white p-4 rounded-lg border ${\n    isOverdue ? 'border-red-200' : 'border-gray-200 hover:border-blue-300'\n  } transition-colors`}>\n    <div className=\"flex items-start justify-between\">\n      <div className=\"flex-1\">\n        <h6 className=\"font-medium text-gray-900 mb-1\">{task.name}</h6>\n        {task.description && (\n          <p className=\"text-sm text-gray-600 mb-2\">{task.description}</p>\n        )}\n        <div className=\"flex items-center space-x-4 text-xs text-gray-500\">\n          <span className=\"flex items-center\">\n            <Calendar className=\"w-3 h-3 mr-1\" />\n            Vence: {formatDate(task.endDate)}\n          </span>\n          <span className={`px-2 py-1 rounded-full text-xs ${\n            task.type === 'Cronograma' \n              ? 'bg-blue-100 text-blue-800' \n              : 'bg-purple-100 text-purple-800'\n          }`}>\n            {task.type}\n          </span>\n          {task.priority && (\n            <span className=\"px-2 py-1 bg-orange-100 text-orange-800 rounded-full text-xs\">\n              {task.priority}\n            </span>\n          )}\n        </div>\n      </div>\n      <span className={`px-2 py-1 text-xs rounded-full font-medium ${\n        isOverdue \n          ? 'bg-red-100 text-red-800' \n          : 'bg-green-100 text-green-800'\n      }`}>\n        {isOverdue ? 'Vencida' : 'Pendiente'}\n      </span>\n    </div>\n  </div>\n));\n\nProjectTasksList.displayName = 'ProjectTasksList';\nTaskCard.displayName = 'TaskCard';\n\nexport default WeeklyPlanningTab;","import { useState, useEffect, useCallback, useRef } from 'react';\nimport supabaseService from '../services/SupabaseService';\nimport { getUnreadNotifications, getUnreadCount, markAsRead, markAllAsRead } from '../utils/notificationHelpers';\n\n/**\n * Hook para gestionar notificaciones del usuario actual\n * Hace polling cada 30 segundos para no sobrecargar el servidor\n */\nconst useNotifications = () => {\n  const [notifications, setNotifications] = useState([]);\n  const [unreadCount, setUnreadCount] = useState(0);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  \n  // Evitar mltiples cargas simultneas\n  const isLoadingRef = useRef(false);\n  const lastFetchTime = useRef(null);\n\n  /**\n   * Carga notificaciones del usuario actual\n   */\n  const loadNotifications = useCallback(async (force = false) => {\n    // Evitar cargas duplicadas\n    if (isLoadingRef.current && !force) {\n      return;\n    }\n\n    // Throttle: No cargar ms de una vez cada 5 segundos\n    const now = Date.now();\n    if (!force && lastFetchTime.current && (now - lastFetchTime.current) < 5000) {\n      return;\n    }\n\n    try {\n      isLoadingRef.current = true;\n      setLoading(true);\n      \n      const currentUser = supabaseService.getCurrentUser();\n      \n      if (!currentUser || !currentUser.email) {\n        setNotifications([]);\n        setUnreadCount(0);\n        return;\n      }\n\n      const userEmail = currentUser.email;\n\n      // Obtener notificaciones no ledas\n      const unreadNotifications = await getUnreadNotifications(userEmail);\n      \n      // Obtener conteo total\n      const count = await getUnreadCount(userEmail);\n      \n      setNotifications(unreadNotifications);\n      setUnreadCount(count);\n      setError(null);\n      \n      lastFetchTime.current = now;\n      \n    } catch (error) {\n      console.error('Error cargando notificaciones:', error);\n      setError('Error cargando notificaciones');\n    } finally {\n      setLoading(false);\n      isLoadingRef.current = false;\n    }\n  }, []);\n\n  /**\n   * Marca una notificacin como leda\n   */\n  const markNotificationAsRead = useCallback(async (notificationId) => {\n    try {\n      const result = await markAsRead(notificationId);\n      \n      if (result.success) {\n        // Actualizar estado local\n        setNotifications(prev => prev.filter(n => n.id !== notificationId));\n        setUnreadCount(prev => Math.max(0, prev - 1));\n      }\n      \n      return result;\n    } catch (error) {\n      console.error('Error marcando notificacin:', error);\n      return { success: false, error };\n    }\n  }, []);\n\n  /**\n   * Marca todas las notificaciones como ledas\n   */\n  const markAllNotificationsAsRead = useCallback(async () => {\n    try {\n      const currentUser = supabaseService.getCurrentUser();\n      if (!currentUser || !currentUser.email) return { success: false };\n      \n      const result = await markAllAsRead(currentUser.email);\n      \n      if (result.success) {\n        setNotifications([]);\n        setUnreadCount(0);\n      }\n      \n      return result;\n    } catch (error) {\n      console.error('Error marcando todas como ledas:', error);\n      return { success: false, error };\n    }\n  }, []);\n\n  /**\n   * Recarga notificaciones manualmente\n   */\n  const refreshNotifications = useCallback(() => {\n    loadNotifications(true);\n  }, [loadNotifications]);\n\n  // Cargar inicialmente\n  useEffect(() => {\n    loadNotifications();\n  }, []); // Solo ejecutar una vez al montar\n\n  // Polling cada 30 segundos (no agresivo)\n  useEffect(() => {\n    const interval = setInterval(() => {\n      loadNotifications();\n    }, 30000); // 30 segundos\n\n    return () => clearInterval(interval);\n  }, []); // Solo configurar el interval una vez\n\n  // Recargar cuando el usuario cambie (login/logout)\n  useEffect(() => {\n    const checkUserChange = setInterval(() => {\n      const currentUser = supabaseService.getCurrentUser();\n      const currentEmail = currentUser?.email;\n      \n      // Si cambi el usuario, recargar\n      if (currentEmail !== lastFetchTime.current?.email) {\n        lastFetchTime.current = { ...lastFetchTime.current, email: currentEmail };\n        loadNotifications(true);\n      }\n    }, 5000); // Cada 5 segundos verificar cambio de usuario\n\n    return () => clearInterval(checkUserChange);\n  }, []); // Solo configurar el interval una vez\n\n  return {\n    notifications,\n    unreadCount,\n    loading,\n    error,\n    markAsRead: markNotificationAsRead,\n    markAllAsRead: markAllNotificationsAsRead,\n    refresh: refreshNotifications\n  };\n};\n\nexport default useNotifications;\n","import React from 'react';\n\n/**\n * Componente para mostrar un item individual de notificacin\n */\nconst NotificationItem = ({ notification, onMarkAsRead, onClose }) => {\n  const handleClick = async () => {\n    // Marcar como leda\n    await onMarkAsRead(notification.id);\n    \n    // Si tiene URL de accin, navegar\n    if (notification.action_url) {\n      // Cerrar panel\n      onClose && onClose();\n      \n      // Navegar (usar router si est disponible, sino window.location)\n      window.location.href = notification.action_url;\n    }\n  };\n\n  const getNotificationIcon = (type) => {\n    switch (type) {\n      case 'assigned':\n        return '';\n      case 'approval_required':\n        return '';\n      case 'ccb_vote_required':\n        return '';\n      case 'status_changed':\n        return '';\n      case 'comment_added':\n        return '';\n      case 'implemented':\n        return '';\n      default:\n        return '';\n    }\n  };\n\n  const getPriorityColor = (priority) => {\n    switch (priority) {\n      case 'urgent':\n        return 'bg-red-50 border-red-200';\n      case 'high':\n        return 'bg-orange-50 border-orange-200';\n      case 'normal':\n        return 'bg-blue-50 border-blue-200';\n      case 'low':\n        return 'bg-gray-50 border-gray-200';\n      default:\n        return 'bg-gray-50 border-gray-200';\n    }\n  };\n\n  const getTimeAgo = (timestamp) => {\n    const now = new Date();\n    const notificationTime = new Date(timestamp);\n    const diffMs = now - notificationTime;\n    const diffMins = Math.floor(diffMs / 60000);\n    const diffHours = Math.floor(diffMs / 3600000);\n    const diffDays = Math.floor(diffMs / 86400000);\n\n    if (diffMins < 1) return 'Hace un momento';\n    if (diffMins < 60) return `Hace ${diffMins} min`;\n    if (diffHours < 24) return `Hace ${diffHours}h`;\n    return `Hace ${diffDays} da${diffDays > 1 ? 's' : ''}`;\n  };\n\n  return (\n    <div\n      onClick={handleClick}\n      className={`p-4 border rounded-lg cursor-pointer transition-all hover:shadow-md ${getPriorityColor(notification.priority)}`}\n    >\n      <div className=\"flex items-start space-x-3\">\n        <div className=\"text-2xl flex-shrink-0\">\n          {getNotificationIcon(notification.notification_type)}\n        </div>\n        \n        <div className=\"flex-1 min-w-0\">\n          <div className=\"flex items-start justify-between mb-1\">\n            <h4 className=\"font-semibold text-gray-800 text-sm truncate\">\n              {notification.title}\n            </h4>\n            {notification.priority === 'urgent' && (\n              <span className=\"ml-2 px-2 py-0.5 bg-red-100 text-red-800 text-xs rounded-full flex-shrink-0\">\n                Urgente\n              </span>\n            )}\n          </div>\n          \n          <p className=\"text-sm text-gray-600 mb-2 line-clamp-2\">\n            {notification.message}\n          </p>\n          \n          <div className=\"flex items-center justify-between text-xs text-gray-500\">\n            <span>{getTimeAgo(notification.created_at)}</span>\n            {notification.change_number && (\n              <span className=\"font-mono bg-white px-2 py-0.5 rounded\">\n                {notification.change_number}\n              </span>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default NotificationItem;\n","import React from 'react';\nimport NotificationItem from './NotificationItem';\n\n/**\n * Panel desplegable de notificaciones\n */\nconst NotificationPanel = ({ \n  isOpen, \n  onClose, \n  notifications, \n  unreadCount,\n  loading,\n  onMarkAsRead,\n  onMarkAllAsRead\n}) => {\n  if (!isOpen) return null;\n\n  const handleBackdropClick = (e) => {\n    if (e.target === e.currentTarget) {\n      onClose();\n    }\n  };\n\n  return (\n    <>\n      {/* Backdrop */}\n      <div \n        className=\"fixed inset-0 z-40\" \n        onClick={handleBackdropClick}\n      />\n      \n      {/* Panel */}\n      <div className=\"fixed right-4 top-20 w-96 max-w-full bg-white rounded-lg shadow-2xl border border-gray-200 z-[9999] max-h-[600px] flex flex-col\">\n        {/* Header */}\n        <div className=\"p-4 border-b border-gray-200 flex items-center justify-between bg-gradient-to-r from-blue-50 to-indigo-50\">\n          <div className=\"flex items-center space-x-2\">\n            <span className=\"text-xl\"></span>\n            <h3 className=\"font-bold text-gray-800\">Notificaciones</h3>\n            {unreadCount > 0 && (\n              <span className=\"bg-red-500 text-white text-xs font-bold px-2 py-0.5 rounded-full\">\n                {unreadCount}\n              </span>\n            )}\n          </div>\n          \n          <div className=\"flex items-center space-x-2\">\n            {unreadCount > 0 && (\n              <button\n                onClick={onMarkAllAsRead}\n                className=\"text-xs text-blue-600 hover:text-blue-800 font-medium\"\n              >\n                Marcar todas\n              </button>\n            )}\n            <button\n              onClick={onClose}\n              className=\"text-gray-400 hover:text-gray-600 transition-colors\"\n            >\n              \n            </button>\n          </div>\n        </div>\n\n        {/* Content */}\n        <div className=\"flex-1 overflow-y-auto p-4\">\n          {loading && notifications.length === 0 ? (\n            <div className=\"flex flex-col items-center justify-center py-12\">\n              <div className=\"animate-spin rounded-full h-8 w-8 border-2 border-blue-500 border-t-transparent mb-4\"></div>\n              <p className=\"text-gray-500 text-sm\">Cargando notificaciones...</p>\n            </div>\n          ) : notifications.length === 0 ? (\n            <div className=\"flex flex-col items-center justify-center py-12\">\n              <div className=\"text-6xl mb-4\"></div>\n              <p className=\"text-gray-600 font-medium mb-1\">No hay notificaciones</p>\n              <p className=\"text-gray-500 text-sm\">Ests al da con todo</p>\n            </div>\n          ) : (\n            <div className=\"space-y-3\">\n              {notifications.map((notification) => (\n                <NotificationItem\n                  key={notification.id}\n                  notification={notification}\n                  onMarkAsRead={onMarkAsRead}\n                  onClose={onClose}\n                />\n              ))}\n            </div>\n          )}\n        </div>\n\n        {/* Footer */}\n        {notifications.length > 0 && (\n          <div className=\"p-3 border-t border-gray-200 bg-gray-50\">\n            <button\n              onClick={onClose}\n              className=\"w-full text-center text-sm text-blue-600 hover:text-blue-800 font-medium\"\n            >\n              Ver todas las notificaciones\n            </button>\n          </div>\n        )}\n      </div>\n    </>\n  );\n};\n\nexport default NotificationPanel;\n","import React, { useState } from 'react';\nimport useNotifications from '../../hooks/useNotifications';\nimport NotificationPanel from './NotificationPanel';\n\n/**\n * Badge de notificaciones con contador\n * Se puede colocar en cualquier parte del navbar/header\n */\nconst NotificationBadge = ({ className = '' }) => {\n  const [isPanelOpen, setIsPanelOpen] = useState(false);\n  \n  const {\n    notifications,\n    unreadCount,\n    loading,\n    error,\n    markAsRead,\n    markAllAsRead,\n    refresh\n  } = useNotifications();\n\n  const handleTogglePanel = () => {\n    setIsPanelOpen(!isPanelOpen);\n    \n    // Si se abre el panel, refrescar notificaciones\n    if (!isPanelOpen) {\n      refresh();\n    }\n  };\n\n  return (\n    <div className={`relative ${className}`}>\n      {/* Badge Button */}\n      <button\n        onClick={handleTogglePanel}\n        className=\"relative p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors\"\n        title=\"Notificaciones\"\n      >\n        <span className=\"text-2xl\"></span>\n        \n        {/* Contador */}\n        {unreadCount > 0 && (\n          <span className=\"absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold rounded-full min-w-[20px] h-5 flex items-center justify-center px-1 shadow-lg animate-pulse\">\n            {unreadCount > 99 ? '99+' : unreadCount}\n          </span>\n        )}\n        \n        {/* Indicador de carga */}\n        {loading && (\n          <span className=\"absolute -bottom-1 -right-1 bg-blue-500 rounded-full w-2 h-2 animate-pulse\"></span>\n        )}\n      </button>\n\n      {/* Panel de Notificaciones */}\n      <NotificationPanel\n        isOpen={isPanelOpen}\n        onClose={() => setIsPanelOpen(false)}\n        notifications={notifications}\n        unreadCount={unreadCount}\n        loading={loading}\n        onMarkAsRead={markAsRead}\n        onMarkAllAsRead={markAllAsRead}\n      />\n\n      {/* Error toast (opcional) */}\n      {error && (\n        <div className=\"absolute top-full right-0 mt-2 bg-red-50 border border-red-200 text-red-700 px-3 py-2 rounded-lg text-sm shadow-lg\">\n          {error}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default NotificationBadge;\n","// src/components/subscription/SubscriptionBadge.js\nimport React from 'react';\nimport { Crown, Zap, Rocket, Shield } from 'lucide-react';\n\n/**\n * Componente para mostrar el badge del plan de suscripcin\n *\n * @param {Object} props\n * @param {string} props.plan - Plan de suscripcin (legacy, free, professional, enterprise)\n * @param {string} props.status - Estado de suscripcin (active, trialing, past_due, canceled, expired)\n * @param {string} props.size - Tamao del badge (sm, md, lg)\n * @param {boolean} props.showIcon - Mostrar icono del plan\n * @param {boolean} props.showStatus - Mostrar estado debajo del plan\n */\nconst SubscriptionBadge = ({\n  plan = 'free',\n  status = 'active',\n  size = 'md',\n  showIcon = true,\n  showStatus = false,\n  className = ''\n}) => {\n\n  // Configuracin de planes\n  const planConfig = {\n    legacy: {\n      label: 'Legacy',\n      icon: Shield,\n      bgColor: 'bg-gradient-to-r from-purple-600 to-indigo-600',\n      textColor: 'text-white',\n      description: 'Plan exclusivo sin lmites'\n    },\n    free: {\n      label: 'Free',\n      icon: Zap,\n      bgColor: 'bg-gray-100',\n      textColor: 'text-gray-800',\n      description: '1 proyecto, 3 usuarios'\n    },\n    professional: {\n      label: 'Professional',\n      icon: Rocket,\n      bgColor: 'bg-gradient-to-r from-blue-600 to-cyan-600',\n      textColor: 'text-white',\n      description: 'Proyectos ilimitados'\n    }\n  };\n\n  // Configuracin de estados\n  const statusConfig = {\n    active: {\n      label: 'Activo',\n      color: 'text-green-600',\n      dotColor: 'bg-green-600'\n    },\n    trialing: {\n      label: 'Periodo de prueba',\n      color: 'text-blue-600',\n      dotColor: 'bg-blue-600'\n    },\n    past_due: {\n      label: 'Pago pendiente',\n      color: 'text-yellow-600',\n      dotColor: 'bg-yellow-600'\n    },\n    canceled: {\n      label: 'Cancelado',\n      color: 'text-red-600',\n      dotColor: 'bg-red-600'\n    },\n    expired: {\n      label: 'Expirado',\n      color: 'text-gray-600',\n      dotColor: 'bg-gray-600'\n    }\n  };\n\n  // Tamaos\n  const sizes = {\n    sm: {\n      container: 'px-2 py-1 text-xs',\n      icon: 'w-3 h-3',\n      gap: 'gap-1'\n    },\n    md: {\n      container: 'px-3 py-1.5 text-sm',\n      icon: 'w-4 h-4',\n      gap: 'gap-1.5'\n    },\n    lg: {\n      container: 'px-4 py-2 text-base',\n      icon: 'w-5 h-5',\n      gap: 'gap-2'\n    }\n  };\n\n  const config = planConfig[plan] || planConfig.free;\n  const statusConf = statusConfig[status] || statusConfig.active;\n  const sizeConf = sizes[size] || sizes.md;\n  const Icon = config.icon;\n\n  return (\n    <div className={`inline-flex flex-col ${className}`}>\n      {/* Badge principal */}\n      <div\n        className={`\n          inline-flex items-center ${sizeConf.gap}\n          ${config.bgColor} ${config.textColor}\n          ${sizeConf.container}\n          rounded-full font-semibold shadow-sm\n        `}\n        title={config.description}\n      >\n        {showIcon && <Icon className={sizeConf.icon} />}\n        <span>{config.label}</span>\n      </div>\n\n      {/* Estado (opcional) */}\n      {showStatus && (\n        <div className={`flex items-center ${sizeConf.gap} mt-1 text-xs ${statusConf.color}`}>\n          <span className={`w-2 h-2 rounded-full ${statusConf.dotColor}`}></span>\n          <span>{statusConf.label}</span>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default SubscriptionBadge;\n","import React, { useState, useEffect } from 'react';\nimport subscriptionService from '../../services/SubscriptionService';\nimport SubscriptionBadge from './SubscriptionBadge';\nimport './UsageIndicator.css';\n\nconst UsageIndicator = ({ organizationId, variant = 'full' }) => {\n  const [stats, setStats] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [organization, setOrganization] = useState(null);\n\n  useEffect(() => {\n    const loadUsageStats = async () => {\n      if (!organizationId) {\n        setLoading(false);\n        return;\n      }\n\n      try {\n        // Obtener estadsticas de uso\n        const usageStats = await subscriptionService.getUsageStats(organizationId);\n        setStats(usageStats);\n\n        // Obtener datos de la organizacin desde localStorage\n        const portfolioData = localStorage.getItem('strategiapm_portfolio_data');\n        if (portfolioData) {\n          const portfolio = JSON.parse(portfolioData);\n          setOrganization(portfolio?.organization);\n        }\n      } catch (error) {\n        console.error('Error cargando estadsticas de uso:', error);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    loadUsageStats();\n  }, [organizationId]);\n\n  if (loading) {\n    return (\n      <div className=\"usage-indicator usage-indicator-loading\">\n        <div className=\"usage-spinner\"></div>\n      </div>\n    );\n  }\n\n  if (!stats || !organization) {\n    return null;\n  }\n\n  const plan = organization.subscriptionPlan || 'free';\n  const status = organization.subscriptionStatus || 'active';\n\n  // Extraer datos de uso (el servicio retorna un objeto con projects y users)\n  const currentProjects = stats.projects?.current || 0;\n  const maxProjects = stats.projects?.max;\n  const currentUsers = stats.users?.current || 0;\n  const maxUsers = stats.users?.max;\n\n  // Calcular porcentajes de uso\n  const projectUsagePercent = maxProjects === null ? 0 : (currentProjects / maxProjects) * 100;\n  const userUsagePercent = maxUsers === null ? 0 : (currentUsers / maxUsers) * 100;\n\n  // Determinar color basado en porcentaje\n  const getUsageColor = (percent) => {\n    if (percent >= 90) return 'usage-danger';\n    if (percent >= 70) return 'usage-warning';\n    return 'usage-safe';\n  };\n\n  // Variante compacta (solo nmeros)\n  if (variant === 'compact') {\n    return (\n      <div className=\"usage-indicator usage-indicator-compact\">\n        <SubscriptionBadge plan={plan} status={status} size=\"sm\" showIcon={false} />\n        <div className=\"usage-stats-compact\">\n          <span className={`usage-stat ${getUsageColor(projectUsagePercent)}`}>\n             {currentProjects}{maxProjects !== null ? `/${maxProjects}` : ''}\n          </span>\n          <span className={`usage-stat ${getUsageColor(userUsagePercent)}`}>\n             {currentUsers}{maxUsers !== null ? `/${maxUsers}` : ''}\n          </span>\n        </div>\n      </div>\n    );\n  }\n\n  // Variante completa (con barras de progreso)\n  return (\n    <div className=\"usage-indicator usage-indicator-full\">\n      <div className=\"usage-header\">\n        <h3 className=\"usage-title\">Uso del Plan</h3>\n        <SubscriptionBadge plan={plan} status={status} size=\"sm\" showIcon={true} />\n      </div>\n\n      <div className=\"usage-items\">\n        {/* Proyectos */}\n        <div className=\"usage-item\">\n          <div className=\"usage-item-header\">\n            <span className=\"usage-item-label\">\n              <span className=\"usage-item-icon\"></span>\n              Proyectos\n            </span>\n            <span className=\"usage-item-count\">\n              {currentProjects}\n              {maxProjects !== null && (\n                <span className=\"usage-item-limit\"> / {maxProjects}</span>\n              )}\n              {maxProjects === null && (\n                <span className=\"usage-item-unlimited\"> / ilimitados</span>\n              )}\n            </span>\n          </div>\n          {maxProjects !== null && (\n            <div className=\"usage-progress-bar\">\n              <div\n                className={`usage-progress-fill ${getUsageColor(projectUsagePercent)}`}\n                style={{ width: `${Math.min(projectUsagePercent, 100)}%` }}\n              ></div>\n            </div>\n          )}\n        </div>\n\n        {/* Usuarios */}\n        <div className=\"usage-item\">\n          <div className=\"usage-item-header\">\n            <span className=\"usage-item-label\">\n              <span className=\"usage-item-icon\"></span>\n              Usuarios\n            </span>\n            <span className=\"usage-item-count\">\n              {currentUsers}\n              {maxUsers !== null && (\n                <span className=\"usage-item-limit\"> / {maxUsers}</span>\n              )}\n              {maxUsers === null && (\n                <span className=\"usage-item-unlimited\"> / ilimitados</span>\n              )}\n            </span>\n          </div>\n          {maxUsers !== null && (\n            <div className=\"usage-progress-bar\">\n              <div\n                className={`usage-progress-fill ${getUsageColor(userUsagePercent)}`}\n                style={{ width: `${Math.min(userUsagePercent, 100)}%` }}\n              ></div>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Mensaje de advertencia si est cerca del lmite */}\n      {(projectUsagePercent >= 80 || userUsagePercent >= 80) && plan === 'free' && (\n        <div className=\"usage-warning-message\">\n          <span className=\"usage-warning-icon\"></span>\n          <span>Te ests acercando al lmite de tu plan.</span>\n          <button className=\"usage-upgrade-link\" onClick={() => {\n            // TODO: Abrir modal de upgrade\n            console.log('Abrir modal de upgrade');\n          }}>\n            Actualizar\n          </button>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default UsageIndicator;\n","import { logger } from '../utils/logger';\n\n/**\n * PortfolioStrategic.js\n *\n * Componente principal del Portfolio que contiene los TABS:\n * - Overview: Vista estratgica con mtricas y proyecto destacado\n * - Lista de Proyectos: Muestra PortfolioDashboard (tabla de proyectos)\n * - Recursos: Gestin de recursos\n * - Archivo: Proyectos archivados\n * - Planeacin Semanal: Planificacin semanal\n *\n * Creacin de proyectos:\n * - El botn \"Crear Primer Proyecto\" (cuando no hay proyectos) cambia al tab\n *   \"Lista de Proyectos\" y abre el modal de PortfolioDashboard.\n * - Todas las operaciones de creacin/edicin usan el modal de PortfolioDashboard.\n */\n\nimport React, { useState, useEffect } from 'react';\nimport PortfolioDashboard from './PortfolioDashboard';\nimport ResourceList from './ResourceList';\nimport ProjectArchive from './ProjectArchive';\nimport WeeklyPlanningTab from './WeeklyPlanningTab';\nimport NotificationBadge from './notifications/NotificationBadge';\nimport UsageIndicator from './subscription/UsageIndicator';\nimport { calculatePlannedValueFromIRR } from '../utils/businessValueCalculator';\n\n\nconst PortfolioStrategic = ({ \n  projects, \n  setProjects,\n  currentProjectId, \n  setCurrentProjectId,\n  portfolioMetrics,\n  workPackages,\n  risks,\n  globalResources,\n  setGlobalResources,\n  createProject,\n  updateProject,\n  deleteProject,\n  duplicateProject,\n  tasks,\n  tasksByProject,\n  minutasByProject,\n  purchaseOrders,\n  advances,\n  invoices,\n  contracts,\n  auditLogs,\n  includeWeekendsByProject,\n  setIncludeWeekendsByProject,\n  getCurrentProjectIncludeWeekends,\n  useSupabase\n}) => {\n  const [activeTab, setActiveTab] = useState('overview');\n  const [statusFilter, setStatusFilter] = useState('all');\n  const [triggerNewProject, setTriggerNewProject] = useState(false); // Para triggear modal en PortfolioDashboard\n  const [archivedProjects, setArchivedProjects] = useState([]);\n  const [selectedArchivedProject, setSelectedArchivedProject] = useState(null);\n  const [showArchivedDetails, setShowArchivedDetails] = useState(false);\n  const [weeklyPlanningData, setWeeklyPlanningData] = useState({\n    dateRange: {\n      start: getStartOfWeek(new Date()),\n      end: getEndOfWeek(new Date())\n    },\n    previousWeekCompliance: null,\n    projectTasks: {}\n  });\n  const [organizationId, setOrganizationId] = useState(null);\n\n  // Funcin para manejar la creacin de nuevo proyecto\n  // Cambia al tab \"projects\" y triggerea el modal de PortfolioDashboard\n  const handleNewProject = () => {\n    setActiveTab('projects');\n    setTriggerNewProject(true);\n  };\n\n  // Callback para resetear el trigger despus de que se procese\n  const handleNewProjectTriggered = () => {\n    setTriggerNewProject(false);\n  };\n\n  // Obtener organizationId al cargar\n  useEffect(() => {\n    try {\n      const portfolioData = localStorage.getItem('strategiapm_portfolio_data');\n      if (portfolioData) {\n        const portfolio = JSON.parse(portfolioData);\n        setOrganizationId(portfolio?.organization?.id);\n      }\n    } catch (error) {\n      logger.error('Error obteniendo organizationId:', error);\n    }\n  }, []);\n\n\n  //  NUEVO: Escuchar eventos de actualizacin de tareas de minutas\n  useEffect(() => {\n    const handleMinutaStatusChanged = (event) => {\n      const { tareaId, newStatus, projectId, timestamp } = event.detail;\n      logger.debug(' PortfolioStrategic: Evento minutaStatusChanged recibido:', { tareaId, newStatus, projectId, timestamp });\n      \n      // Forzar re-render del componente para actualizar el Dashboard resumen\n      logger.debug(' PortfolioStrategic: Forzando re-render del Dashboard resumen...');\n      // El componente se re-renderizar automticamente cuando cambien los datos\n    };\n\n    // Agregar listener\n    window.addEventListener('minutaStatusChanged', handleMinutaStatusChanged);\n\n    // Cleanup\n    return () => {\n      window.removeEventListener('minutaStatusChanged', handleMinutaStatusChanged);\n    };\n  }, []);\n\n  const currentProject = projects.find(p => p.id === currentProjectId);\n\n  // Funcin para validar si un proyecto puede ser archivado\n  const canArchiveProject = (project) => {\n    const validations = [];\n    \n    logger.debug(' VALIDANDO ARCHIVADO para proyecto:', project.name);\n    logger.debug(' Progreso del proyecto:', project.progress);\n    logger.debug(' Total de tareas disponibles:', tasks.length);\n    \n    // 1. Verificar que el proyecto est completado (100% de progreso)\n    if (project.progress < 100) {\n      validations.push(`El proyecto debe estar 100% completado (actual: ${project.progress}%)`);\n    }\n    \n    // 2. Verificar que todas las tareas estn finalizadas\n    // Filtrar tareas del proyecto actual\n    const projectTasks = tasks.filter(task => \n      task.workPackageId === project.id || task.projectId === project.id\n    );\n    \n    logger.debug(' Tareas del proyecto:', projectTasks.length);\n    \n    const incompleteTasks = projectTasks.filter(task => \n      task.progress < 100 && task.status !== 'completed'\n    );\n    \n    logger.debug(' Tareas incompletas:', incompleteTasks.length);\n    \n    if (incompleteTasks.length > 0) {\n      validations.push(`Todas las tareas deben estar completadas (${incompleteTasks.length} tareas pendientes)`);\n    }\n    \n    // 3. Verificar que no haya dependencias activas\n    // Verificar si hay tareas con dependencias no completadas\n    const tasksWithDependencies = projectTasks.filter(task => \n      task.predecessors && task.predecessors.length > 0\n    );\n    \n    const tasksWithIncompleteDependencies = tasksWithDependencies.filter(task => {\n      const predecessorTasks = task.predecessors.map(predId => \n        projectTasks.find(t => t.id === predId)\n      ).filter(Boolean);\n      \n      return predecessorTasks.some(pred => pred.progress < 100);\n    });\n    \n    if (tasksWithIncompleteDependencies.length > 0) {\n      validations.push('No debe haber dependencias activas con tareas incompletas');\n    }\n    \n    // 4. Verificar que la documentacin est completa\n    // Verificar si hay archivos pendientes o documentacin incompleta\n    const projectFiles = []; // Placeholder - en implementacin real se conectara con FileManager\n    const requiredDocuments = ['Acta de Inicio', 'Cronograma', 'Presupuesto', 'Acta de Cierre'];\n    const missingDocuments = requiredDocuments.filter(doc => \n      !projectFiles.some(file => file.name.includes(doc))\n    );\n    \n    if (missingDocuments.length > 0) {\n      validations.push(`Documentacin incompleta: ${missingDocuments.join(', ')}`);\n    }\n    \n    // 5. Verificar que tenga las aprobaciones necesarias\n    // Verificar si hay rdenes de compra, facturas o contratos pendientes\n    const projectPurchaseOrders = purchaseOrders.filter(po => \n      po.projectId === project.id || po.workPackageId === project.id\n    );\n    const projectInvoices = invoices.filter(inv => \n      inv.projectId === project.id || inv.workPackageId === project.id\n    );\n    const projectContracts = contracts.filter(contract => \n      contract.projectId === project.id || contract.workPackageId === project.id\n    );\n    \n    const pendingApprovals = [];\n    if (projectPurchaseOrders.some(po => po.status === 'pending')) {\n      pendingApprovals.push('rdenes de compra pendientes');\n    }\n    if (projectInvoices.some(inv => inv.status === 'pending')) {\n      pendingApprovals.push('Facturas pendientes');\n    }\n    if (projectContracts.some(contract => contract.status === 'pending')) {\n      pendingApprovals.push('Contratos pendientes');\n    }\n    \n    if (pendingApprovals.length > 0) {\n      validations.push(`Aprobaciones pendientes: ${pendingApprovals.join(', ')}`);\n    }\n    \n    logger.debug(' Validaciones encontradas:', validations);\n    logger.debug(' Puede archivar:', validations.length === 0);\n    \n    return {\n      canArchive: validations.length === 0,\n      validations: validations\n    };\n  };\n\n  // Funcin para archivar proyecto\n  const handleArchiveProject = (projectId) => {\n    const projectToArchive = projects.find(p => p.id === projectId);\n    if (!projectToArchive) return;\n\n    // Validar si el proyecto puede ser archivado\n    const validation = canArchiveProject(projectToArchive);\n    \n    if (!validation.canArchive) {\n      // Mostrar modal de validacin\n      const validationMessage = validation.validations.join('\\n ');\n      alert(` No se puede archivar el proyecto \"${projectToArchive.name}\"\\n\\nRazones:\\n ${validationMessage}\\n\\nPor favor, complete todos los requisitos antes de archivar.`);\n      return;\n    }\n\n    // Confirmar archivado\n    const confirmMessage = `Est seguro de que desea archivar el proyecto \"${projectToArchive.name}\"?\\n\\nEste proyecto ser movido al archivo y ya no estar disponible para edicin.`;\n    if (!window.confirm(confirmMessage)) {\n      return;\n    }\n\n    // Agregar a la lista de archivados\n    const archivedProject = {\n      id: projectToArchive.id,\n      name: projectToArchive.name,\n      description: projectToArchive.description,\n      startDate: projectToArchive.startDate,\n      endDate: projectToArchive.endDate,\n      budget: projectToArchive.budget,\n      status: projectToArchive.status,\n      priority: projectToArchive.priority,\n      manager: projectToArchive.manager,\n      team: projectToArchive.team,\n      createdAt: projectToArchive.createdAt,\n      updatedAt: projectToArchive.updatedAt,\n      version: projectToArchive.version,\n      progress: projectToArchive.progress,\n      archivedAt: new Date().toISOString(),\n      archivedBy: 'Usuario Actual' // En un sistema real, esto vendra del contexto de usuario\n    };\n    \n    setArchivedProjects(prev => {\n      const newArchived = prev.slice();\n      newArchived.push(archivedProject);\n      return newArchived;\n    });\n    \n    // Cambiar el estado del proyecto a 'archived'\n    const updatedProjects = projects.map(p => \n      p.id === projectId \n        ? { \n            id: p.id,\n            name: p.name,\n            description: p.description,\n            startDate: p.startDate,\n            endDate: p.endDate,\n            budget: p.budget,\n            status: 'archived',\n            priority: p.priority,\n            manager: p.manager,\n            team: p.team,\n            createdAt: p.createdAt,\n            updatedAt: p.updatedAt,\n            version: p.version,\n            progress: p.progress,\n            archivedAt: new Date().toISOString()\n          }\n        : p\n    );\n    \n    setProjects(updatedProjects);\n    \n    // Si el proyecto archivado era el actual, cambiar a otro proyecto activo\n    if (currentProjectId === projectId) {\n      const activeProjects = updatedProjects.filter(p => p.status === 'active');\n      if (activeProjects.length > 0) {\n        setCurrentProjectId(activeProjects[0].id);\n      }\n    }\n\n    // Mostrar confirmacin de archivado exitoso\n    alert(` Proyecto \"${projectToArchive.name}\" archivado exitosamente.`);\n  };\n\n  // Funcin para ver detalles de proyecto archivado\n  const viewArchivedProject = (project) => {\n    setSelectedArchivedProject(project);\n    setShowArchivedDetails(true);\n  };\n\n  // Funcin para cerrar detalles de proyecto archivado\n  const closeArchivedDetails = () => {\n    setSelectedArchivedProject(null);\n    setShowArchivedDetails(false);\n  };\n\n  const getStatusColor = (status) => {\n    switch(status) {\n      case 'active': return 'bg-green-100 text-green-800 border-green-200';\n      case 'inactive': return 'bg-gray-100 text-gray-600 border-gray-300';\n      case 'completed': return 'bg-blue-100 text-blue-800 border-blue-200';\n      case 'on-hold': return 'bg-yellow-100 text-yellow-800 border-yellow-200';\n      case 'cancelled': return 'bg-red-100 text-red-800 border-red-200';\n      case 'archived': return 'bg-purple-100 text-purple-800 border-purple-200';\n      default: return 'bg-gray-100 text-gray-800 border-gray-200';\n    }\n  };\n\n  const getPriorityColor = (priority) => {\n    switch(priority) {\n      case 'high': return 'bg-red-100 text-red-800 border-red-200';\n      case 'medium': return 'bg-yellow-100 text-yellow-800 border-yellow-200';\n      case 'low': return 'bg-green-100 text-green-800 border-green-200';\n      default: return 'bg-gray-100 text-gray-800 border-gray-200';\n    }\n  };\n\n  const getStatusIcon = (status) => {\n    switch(status) {\n      case 'active': return '';\n      case 'inactive': return '';\n      case 'completed': return '';\n      case 'on-hold': return '';\n      case 'cancelled': return '';\n      case 'archived': return '';\n      default: return '';\n    }\n  };\n\n  const handleDuplicateProject = (projectId) => {\n    logger.debug(' Duplicando proyecto con ID:', projectId);\n\n    const projectToDuplicate = projects.find(p => p.id === projectId);\n    if (!projectToDuplicate) {\n      logger.error(' Proyecto no encontrado para duplicar');\n      return;\n    }\n\n    // Crear una copia del proyecto con nuevo ID y nombre\n    const duplicatedProject = {\n      id: 'proj-' + String(Date.now()).slice(-6),\n      name: `${projectToDuplicate.name} (Copia)`,\n      description: projectToDuplicate.description,\n      startDate: projectToDuplicate.startDate,\n      endDate: projectToDuplicate.endDate,\n      budget: projectToDuplicate.budget,\n      status: projectToDuplicate.status,\n      priority: projectToDuplicate.priority,\n      manager: projectToDuplicate.manager,\n      team: projectToDuplicate.team,\n      createdAt: projectToDuplicate.createdAt,\n      updatedAt: projectToDuplicate.updatedAt,\n      version: projectToDuplicate.version,\n      progress: projectToDuplicate.progress\n    };\n\n    logger.debug(' Proyecto duplicado creado:', duplicatedProject);\n\n    // Agregar el proyecto duplicado\n    createProject(duplicatedProject);\n  };\n\n  return (\n    <div className=\"space-y-6 max-w-full overflow-hidden\">\n      {/* Header del Portfolio */}\n      <div className=\"bg-gradient-to-r from-blue-50 to-indigo-100 rounded-2xl shadow-lg p-6 text-gray-800 relative overflow-hidden\">\n        {/* Elementos decorativos de fondo */}\n        <div className=\"absolute top-0 right-0 w-32 h-32 bg-blue-100/30 rounded-full -translate-y-16 translate-x-16\"></div>\n        <div className=\"absolute bottom-0 left-0 w-24 h-24 bg-indigo-100/30 rounded-full translate-y-12 -translate-x-12\"></div>\n        \n        <div className=\"relative z-10\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center\">\n              <div className=\"bg-white/60 backdrop-blur rounded-2xl p-3 mr-4 shadow-sm\">\n                <span className=\"text-3xl\"></span>\n              </div>\n              <div>\n                <h1 className=\"text-4xl font-bold mb-2 text-gray-800\">Portafolio de Proyectos</h1>\n                <p className=\"text-gray-600 text-lg\">Gestin estratgica y configuracin de proyectos</p>\n              </div>\n            </div>\n            <div className=\"flex items-center gap-4\">\n              {organizationId && (\n                <UsageIndicator\n                  organizationId={organizationId}\n                  variant=\"compact\"\n                />\n              )}\n              <NotificationBadge />\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Tabs de Navegacin */}\n      <div className=\"bg-white rounded-lg shadow-sm\">\n        <div className=\"border-b border-gray-200\">\n          <nav className=\"flex space-x-8 px-6\">\n            {[\n              { id: 'overview', name: 'Vista General', icon: '' },\n              { id: 'projects', name: 'Lista de Proyectos', icon: '' },\n              { id: 'resources', name: 'Lista de Recursos', icon: '' },\n              { id: 'weekly-planning', name: 'Planificacin Semanal', icon: '' },\n              { id: 'archive', name: 'Archivado de Proyectos', icon: '' },\n              { id: 'metrics', name: 'Mtricas del Portfolio', icon: '' }\n            ].map((tab) => (\n              <button\n                key={tab.id}\n                onClick={() => setActiveTab(tab.id)}\n                className={`py-4 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 ${\n                  activeTab === tab.id\n                    ? 'border-blue-500 text-blue-600'\n                    : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n                }`}\n              >\n                <span>{tab.icon}</span>\n                <span>{tab.name}</span>\n              </button>\n            ))}\n          </nav>\n        </div>\n\n        <div className=\"p-6\">\n          {/* Tab: Vista General */}\n          {activeTab === 'overview' && (\n            <div className=\"space-y-6\">\n              {/* Mensaje de bienvenida cuando no hay proyectos */}\n              {projects.length === 0 && (\n                <div className=\"text-center py-12 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300\">\n                  <div className=\"text-6xl mb-4\"></div>\n                  <h3 className=\"text-2xl font-bold text-gray-700 mb-2\">\n                    Bienvenido a tu Portfolio de Proyectos!\n                  </h3>\n                  <p className=\"text-gray-600 mb-6\">\n                    Comienza creando tu primer proyecto para gestionar cronogramas, riesgos, presupuestos y ms.\n                  </p>\n                  <button\n                    onClick={handleNewProject}\n                    className=\"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 text-lg font-semibold shadow-lg transition-colors\"\n                  >\n                     Crear Primer Proyecto\n                  </button>\n                </div>\n              )}\n\n              {/* Mtricas - solo mostrar si hay proyectos */}\n              {projects.length > 0 && (\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n                <div className=\"bg-blue-50 p-6 rounded-lg border border-blue-200\">\n                  <div className=\"flex items-center space-x-3 mb-3\">\n                    <span className=\"text-2xl\"></span>\n                    <h3 className=\"text-lg font-semibold text-blue-800\">Total Proyectos</h3>\n                  </div>\n                  <div className=\"text-3xl font-bold text-blue-600 mb-2\">{projects.length}</div>\n                  <div className=\"text-sm text-blue-600\">\n                    {projects.filter(p => p.status === 'active').length} activos\n                  </div>\n                </div>\n\n                <div className=\"bg-green-50 p-6 rounded-lg border border-green-200\">\n                  <div className=\"flex items-center space-x-3 mb-3\">\n                    <span className=\"text-2xl\"></span>\n                    <h3 className=\"text-lg font-semibold text-green-800\">Presupuesto Total</h3>\n                  </div>\n                  <div className=\"text-3xl font-bold text-green-600 mb-2\">\n                    ${(projects.filter(p => p.status === 'active').reduce((sum, p) => sum + p.budget, 0) / 1000).toFixed(0)}K USD\n                  </div>\n                  <div className=\"text-sm text-green-600\">\n                    Solo proyectos activos\n                  </div>\n                </div>\n\n                <div className=\"bg-purple-50 p-6 rounded-lg border border-purple-200\">\n                  <div className=\"flex items-center space-x-3 mb-3\">\n                    <span className=\"text-2xl\"></span>\n                    <h3 className=\"text-lg font-semibold text-purple-800\">Proyectos Prioritarios</h3>\n                  </div>\n                  <div className=\"text-3xl font-bold text-purple-600 mb-2\">\n                    {projects.filter(p => p.priority === 'high' && p.status === 'active').length}\n                  </div>\n                  <div className=\"text-sm text-purple-600\">\n                    Prioridad alta (activos)\n                  </div>\n                </div>\n              </div>\n              )}\n\n              {/* Proyecto Destacado */}\n              {projects.length > 0 && currentProject && (\n                <div className=\"bg-white border border-gray-200 rounded-lg p-6\">\n                  <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">Proyecto Destacado</h3>\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                    <div>\n                      <h4 className=\"font-medium text-gray-700 mb-2\">Informacin General</h4>\n                      <div className=\"space-y-2 text-sm\">\n                        <div><span className=\"font-medium\">Nombre:</span> {currentProject.name}</div>\n                        <div><span className=\"font-medium\">Manager:</span> {currentProject.manager}</div>\n                        <div><span className=\"font-medium\">Sponsor:</span> {currentProject.sponsor}</div>\n                        <div><span className=\"font-medium\">Estado:</span> \n                          <span className={`ml-2 px-2 py-1 rounded-full text-xs ${getStatusColor(currentProject.status)}`}>\n                            {getStatusIcon(currentProject.status)} {currentProject.status}\n                          </span>\n                        </div>\n                      </div>\n                    </div>\n                    <div>\n                      <h4 className=\"font-medium text-gray-700 mb-2\">Mtricas Financieras</h4>\n                      <div className=\"space-y-2 text-sm\">\n                        <div><span className=\"font-medium\">Presupuesto:</span> ${(currentProject.budget / 1000).toFixed(0)}K USD</div>\n                        <div><span className=\"font-medium\">Reserva Contingencia:</span> ${(currentProject.contingencyReserve / 1000).toFixed(0)}K USD</div>\n                        <div><span className=\"font-medium\">Reserva Gestin:</span> ${(currentProject.managementReserve / 1000).toFixed(0)}K USD</div>\n                        {currentProject.irr > 0 && (\n                          <div><span className=\"font-medium\">TIR:</span> {currentProject.irr.toFixed(2)}%</div>\n                        )}\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* Tab: Lista de Proyectos */}\n          {activeTab === 'projects' && (\n            <PortfolioDashboard\n              projects={projects}\n              currentProjectId={currentProjectId}\n              setCurrentProjectId={setCurrentProjectId}\n              portfolioMetrics={portfolioMetrics}\n              workPackages={workPackages}\n              risks={risks}\n              globalResources={globalResources}\n              setGlobalResources={setGlobalResources}\n              tasksByProject={tasksByProject}\n              createProject={createProject}\n              updateProject={updateProject}\n              deleteProject={deleteProject}\n              duplicateProject={handleDuplicateProject}\n              archiveProject={handleArchiveProject}\n              includeWeekendsByProject={includeWeekendsByProject}\n              setIncludeWeekendsByProject={setIncludeWeekendsByProject}\n              getCurrentProjectIncludeWeekends={getCurrentProjectIncludeWeekends}\n              triggerNewProject={triggerNewProject}\n              onNewProjectTriggered={handleNewProjectTriggered}\n            />\n          )}\n\n          {/* Tab: Lista de Recursos */}\n          {activeTab === 'resources' && (\n            <ResourceList \n              globalResources={globalResources}\n              setGlobalResources={setGlobalResources}\n            />\n          )}\n\n          {/* Tab: Planificacin Semanal */}\n          {activeTab === 'weekly-planning' && (\n            <>\n              {(() => {\n                logger.debug(' DEBUG - Datos que se pasan a WeeklyPlanningTab:');\n                logger.debug('   projects:', projects);\n                logger.debug('   tasksByProject:', tasksByProject);\n                logger.debug('   minutasByProject:', minutasByProject);\n                logger.debug('   Estructura minutasByProject:', Object.keys(minutasByProject || {}));\n\n                // Ver ejemplo de minutas de un proyecto\n                const firstProjectId = Object.keys(minutasByProject || {})[0];\n                if (firstProjectId) {\n                  logger.debug(`   Ejemplo minutas proyecto ${firstProjectId}:`, minutasByProject[firstProjectId]);\n                }\n                return null;\n              })()}\n              <WeeklyPlanningTab \n                projects={projects}\n                tasksByProject={tasksByProject}\n                minutasByProject={minutasByProject}\n                weeklyPlanningData={weeklyPlanningData}\n                setWeeklyPlanningData={setWeeklyPlanningData}\n                useSupabase={useSupabase}\n              />\n            </>\n          )}\n\n          {/* Tab: Archivado de Proyectos */}\n          {activeTab === 'archive' && (\n            <div className=\"space-y-6\">\n              <div className=\"bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg p-6 border border-purple-200\">\n                <div className=\"flex items-center space-x-3 mb-4\">\n                  <span className=\"text-3xl\"></span>\n                  <div>\n                    <h3 className=\"text-xl font-semibold text-gray-800\">Archivado de Proyectos</h3>\n                    <p className=\"text-gray-600\">Gestin centralizada del ciclo de vida completo de proyectos</p>\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n                {/* Proyectos Activos - Lista para Archivar */}\n                <div className=\"bg-white rounded-lg shadow-sm border border-gray-200\">\n                  <div className=\"p-6 border-b border-gray-200\">\n                    <h4 className=\"text-lg font-semibold text-gray-800 flex items-center space-x-2\">\n                      <span></span>\n                      <span>Proyectos Activos</span>\n                    </h4>\n                    <p className=\"text-sm text-gray-600 mt-1\">Selecciona un proyecto para archivarlo</p>\n                  </div>\n                  <div className=\"p-6\">\n                    {projects.filter(p => p.status === 'active').length === 0 ? (\n                      <div className=\"text-center py-8 text-gray-500\">\n                        <span className=\"text-4xl mb-2 block\"></span>\n                        <p>No hay proyectos activos para archivar</p>\n                      </div>\n                    ) : (\n                      <div className=\"space-y-3\">\n                        {projects.filter(p => p.status === 'active').map(project => {\n                          const validation = canArchiveProject(project);\n                          const canArchive = validation.canArchive;\n                          \n                          return (\n                            <div key={project.id} className={`flex items-center justify-between p-4 rounded-lg border ${\n                              canArchive \n                                ? 'bg-gray-50 border-gray-200' \n                                : 'bg-red-50 border-red-200'\n                            }`}>\n                              <div className=\"flex-1\">\n                                <h5 className=\"font-medium text-gray-800\">{project.name}</h5>\n                                <p className=\"text-sm text-gray-600\">{project.description}</p>\n                                <div className=\"flex items-center space-x-4 mt-2\">\n                                  <span className={`px-2 py-1 rounded-full text-xs font-medium ${getStatusColor(project.status)}`}>\n                                    {project.status}\n                                  </span>\n                                  <span className=\"text-xs text-gray-500\">\n                                    Progreso: {project.progress}%\n                                  </span>\n                                  <span className=\"text-xs text-gray-500\">\n                                    Creado: {new Date(project.createdAt).toLocaleDateString()}\n                                  </span>\n                                </div>\n                                \n                                {/* Mostrar validaciones si no puede ser archivado */}\n                                {!canArchive && (\n                                  <div className=\"mt-2 p-2 bg-red-100 rounded border border-red-200\">\n                                    <p className=\"text-xs text-red-700 font-medium mb-1\"> Requisitos pendientes para archivado:</p>\n                                    <ul className=\"text-xs text-red-600 space-y-1\">\n                                      {validation.validations.map((validation, index) => (\n                                        <li key={index} className=\"flex items-start\">\n                                          <span className=\"mr-1\"></span>\n                                          <span>{validation}</span>\n                                        </li>\n                                      ))}\n                                    </ul>\n                                  </div>\n                                )}\n                              </div>\n                              \n                              <div className=\"ml-4 flex flex-col space-y-2\">\n                                <button\n                                  onClick={() => handleArchiveProject(project.id)}\n                                  disabled={!canArchive}\n                                  className={`px-4 py-2 rounded-lg transition-colors flex items-center space-x-2 ${\n                                    canArchive\n                                      ? 'bg-purple-600 text-white hover:bg-purple-700'\n                                      : 'bg-gray-300 text-gray-500 cursor-not-allowed'\n                                  }`}\n                                  title={canArchive ? 'Archivar proyecto' : 'No cumple requisitos para archivado'}\n                                >\n                                  <span></span>\n                                  <span>Archivar</span>\n                                </button>\n                                \n                                {!canArchive && (\n                                  <span className=\"text-xs text-red-600 text-center\">\n                                    No disponible\n                                  </span>\n                                )}\n                              </div>\n                            </div>\n                          );\n                        })}\n                      </div>\n                    )}\n                  </div>\n                </div>\n\n                {/* Proyectos Archivados */}\n                <div className=\"bg-white rounded-lg shadow-sm border border-gray-200\">\n                  <div className=\"p-6 border-b border-gray-200\">\n                    <h4 className=\"text-lg font-semibold text-gray-800 flex items-center space-x-2\">\n                      <span></span>\n                      <span>Proyectos Archivados</span>\n                    </h4>\n                    <p className=\"text-sm text-gray-600 mt-1\">Historial de proyectos archivados</p>\n                  </div>\n                  <div className=\"p-6\">\n                    {archivedProjects.length === 0 ? (\n                      <div className=\"text-center py-8 text-gray-500\">\n                        <span className=\"text-4xl mb-2 block\"></span>\n                        <p>No hay proyectos archivados</p>\n                      </div>\n                    ) : (\n                      <div className=\"space-y-3\">\n                        {archivedProjects.map(project => (\n                          <div key={project.id} className=\"p-4 bg-gray-50 rounded-lg border border-gray-200\">\n                            <div className=\"flex items-start justify-between\">\n                              <div className=\"flex-1\">\n                                <h5 className=\"font-medium text-gray-800\">{project.name}</h5>\n                                <p className=\"text-sm text-gray-600\">{project.description}</p>\n                                <div className=\"flex items-center space-x-4 mt-2\">\n                                  <span className=\"px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800\">\n                                    Archivado\n                                  </span>\n                                  <span className=\"text-xs text-gray-500\">\n                                    Archivado: {new Date(project.archivedAt).toLocaleDateString()}\n                                  </span>\n                                  <span className=\"text-xs text-gray-500\">\n                                    Por: {project.archivedBy}\n                                  </span>\n                                </div>\n                              </div>\n                              <div className=\"ml-4 flex space-x-2\">\n                                <button\n                                  onClick={() => viewArchivedProject(project)}\n                                  className=\"px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700 transition-colors flex items-center space-x-1\"\n                                  title=\"Ver detalles del proyecto archivado\"\n                                >\n                                  <span></span>\n                                  <span>Ver</span>\n                                </button>\n                              </div>\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n                    )}\n                  </div>\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* Tab: Mtricas del Portfolio */}\n          {activeTab === 'metrics' && (\n            <div className=\"space-y-6\">\n              <h3 className=\"text-lg font-semibold text-gray-800\">Mtricas del Portfolio</h3>\n              \n              {/* Alerta Informativa */}\n              <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\n                <div className=\"flex items-center\">\n                  <div className=\"text-blue-600 text-xl mr-3\"></div>\n                  <div className=\"text-blue-800 text-sm\">\n                    <strong>Importante:</strong> Las mtricas financieras solo consideran proyectos con estado \"Activo\". \n                    Los proyectos \"Inactivos\" no suman al presupuesto total ni a las reservas del portfolio.\n                  </div>\n                </div>\n              </div>\n              \n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                <div className=\"bg-white border border-gray-200 rounded-lg p-6\">\n                  <h4 className=\"font-semibold text-gray-800 mb-4\">Distribucin por Estado</h4>\n                  <div className=\"space-y-3\">\n                    {['active', 'completed', 'on-hold', 'cancelled'].map(status => {\n                      const count = projects.filter(p => p.status === status).length;\n                      const percentage = projects.length > 0 ? (count / projects.length) * 100 : 0;\n                      return (\n                        <div key={status} className=\"flex items-center justify-between\">\n                          <div className=\"flex items-center space-x-2\">\n                            <span>{getStatusIcon(status)}</span>\n                            <span className=\"capitalize\">{status}</span>\n                          </div>\n                          <div className=\"flex items-center space-x-2\">\n                            <div className=\"w-24 bg-gray-200 rounded-full h-2\">\n                              <div\n                                className=\"bg-blue-500 h-2 rounded-full\"\n                                style={{ width: `${percentage}%` }}\n                              ></div>\n                            </div>\n                            <span className=\"text-sm text-gray-600 w-8 text-right\">\n                              {count}\n                            </span>\n                          </div>\n                        </div>\n                      );\n                    })}\n                  </div>\n                </div>\n\n                <div className=\"bg-white border border-gray-200 rounded-lg p-6\">\n                  <h4 className=\"font-semibold text-gray-800 mb-4\">Distribucin por Prioridad</h4>\n                  <div className=\"space-y-3\">\n                    {['high', 'medium', 'low'].map(priority => {\n                      const count = projects.filter(p => p.priority === priority).length;\n                      const percentage = projects.length > 0 ? (count / projects.length) * 100 : 0;\n                      return (\n                        <div key={priority} className=\"flex items-center justify-between\">\n                          <div className=\"flex items-center space-x-2\">\n                            <span className=\"capitalize\">{priority}</span>\n                          </div>\n                          <div className=\"flex items-center space-x-2\">\n                            <div className=\"w-24 bg-gray-200 rounded-full h-2\">\n                              <div\n                                className=\"bg-green-500 h-2 rounded-full\"\n                                style={{ width: `${percentage}%` }}\n                              ></div>\n                            </div>\n                            <span className=\"text-sm text-gray-600 w-8 text-right\">\n                              {count}\n                            </span>\n                          </div>\n                        </div>\n                      );\n                    })}\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"bg-white border border-gray-200 rounded-lg p-6\">\n                <h4 className=\"font-semibold text-gray-800 mb-4\">Anlisis Financiero (Solo Proyectos Activos)</h4>\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n                  <div className=\"text-center\">\n                    <div className=\"text-2xl font-bold text-blue-600\">\n                      ${(projects.filter(p => p.status === 'active').reduce((sum, p) => sum + p.budget, 0) / 1000).toFixed(0)}K USD\n                    </div>\n                    <div className=\"text-sm text-gray-600\">Presupuesto Total</div>\n                  </div>\n                  <div className=\"text-center\">\n                    <div className=\"text-2xl font-bold text-green-600\">\n                      ${(projects.filter(p => p.status === 'active').reduce((sum, p) => sum + p.contingencyReserve + p.managementReserve, 0) / 1000).toFixed(0)}K USD\n                    </div>\n                    <div className=\"text-sm text-gray-600\">Reservas Totales</div>\n                  </div>\n                  <div className=\"text-center\">\n                    <div className=\"text-2xl font-bold text-purple-600\">\n                      {projects.filter(p => p.status === 'active' && p.irr > 0).length}\n                    </div>\n                    <div className=\"text-sm text-gray-600\">Proyectos con TIR</div>\n                  </div>\n                </div>\n                <div className=\"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg\">\n                  <div className=\"text-sm text-blue-800\">\n                    <strong>Nota:</strong> Las mtricas financieras solo consideran proyectos con estado \"Activo\". \n                    Los proyectos \"Inactivos\" o \"Completados\" no influyen en los indicadores financieros.\n                  </div>\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Modal de Detalles de Proyecto Archivado */}\n      {showArchivedDetails && selectedArchivedProject && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n          <div className=\"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto\">\n            <div className=\"p-6 border-b border-gray-200\">\n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center space-x-3\">\n                  <span className=\"text-3xl\"></span>\n                  <div>\n                    <h3 className=\"text-xl font-semibold text-gray-800\">\n                      {selectedArchivedProject.name}\n                    </h3>\n                    <p className=\"text-sm text-gray-600\">Proyecto Archivado</p>\n                  </div>\n                </div>\n                <button\n                  onClick={closeArchivedDetails}\n                  className=\"text-gray-400 hover:text-gray-600 text-2xl\"\n                >\n                  \n                </button>\n              </div>\n            </div>\n\n            <div className=\"p-6 space-y-6\">\n              {/* Informacin General */}\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                <div className=\"bg-gray-50 p-4 rounded-lg\">\n                  <h4 className=\"font-semibold text-gray-800 mb-3\"> Informacin General</h4>\n                  <div className=\"space-y-2 text-sm\">\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-gray-600\">Estado:</span>\n                      <span className=\"px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800\">\n                        Archivado\n                      </span>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-gray-600\">Progreso:</span>\n                      <span className=\"font-medium\">{selectedArchivedProject.progress}%</span>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-gray-600\">Archivado:</span>\n                      <span>{new Date(selectedArchivedProject.archivedAt).toLocaleDateString()}</span>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-gray-600\">Archivado por:</span>\n                      <span>{selectedArchivedProject.archivedBy}</span>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-gray-600\">Creado:</span>\n                      <span>{new Date(selectedArchivedProject.createdAt).toLocaleDateString()}</span>\n                    </div>\n                  </div>\n                </div>\n\n                <div className=\"bg-gray-50 p-4 rounded-lg\">\n                  <h4 className=\"font-semibold text-gray-800 mb-3\"> Descripcin</h4>\n                  <p className=\"text-sm text-gray-600\">\n                    {selectedArchivedProject.description || 'Sin descripcin disponible'}\n                  </p>\n                </div>\n              </div>\n\n              {/* Datos del Proyecto */}\n              <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n                {/* Tareas del Proyecto */}\n                <div className=\"bg-blue-50 p-4 rounded-lg\">\n                  <h4 className=\"font-semibold text-gray-800 mb-3 flex items-center space-x-2\">\n                    <span></span>\n                    <span>Tareas del Cronograma</span>\n                  </h4>\n                  <div className=\"space-y-2\">\n                    {(() => {\n                      const projectTasks = tasks.filter(task => \n                        task.workPackageId === selectedArchivedProject.id || \n                        task.projectId === selectedArchivedProject.id\n                      );\n                      \n                      if (projectTasks.length === 0) {\n                        return (\n                          <p className=\"text-sm text-gray-500 italic\">\n                            No hay tareas registradas para este proyecto\n                          </p>\n                        );\n                      }\n                      \n                      return (\n                        <div className=\"space-y-1\">\n                          <p className=\"text-sm text-gray-600\">\n                            Total: {projectTasks.length} tareas\n                          </p>\n                          <p className=\"text-sm text-gray-600\">\n                            Completadas: {projectTasks.filter(t => t.progress === 100).length}\n                          </p>\n                          <p className=\"text-sm text-gray-600\">\n                            Pendientes: {projectTasks.filter(t => t.progress < 100).length}\n                          </p>\n                        </div>\n                      );\n                    })()}\n                  </div>\n                </div>\n\n                {/* Documentos y Archivos */}\n                <div className=\"bg-green-50 p-4 rounded-lg\">\n                  <h4 className=\"font-semibold text-gray-800 mb-3 flex items-center space-x-2\">\n                    <span></span>\n                    <span>Auditora Documental</span>\n                  </h4>\n                  <div className=\"space-y-2\">\n                    {(() => {\n                      const projectAuditLogs = auditLogs.filter(log => \n                        log.projectId === selectedArchivedProject.id || \n                        log.workPackageId === selectedArchivedProject.id\n                      );\n                      \n                      if (projectAuditLogs.length === 0) {\n                        return (\n                          <p className=\"text-sm text-gray-500 italic\">\n                            No hay registros de auditora para este proyecto\n                          </p>\n                        );\n                      }\n                      \n                      // Agrupar por tipo de documento\n                      const documentTypes = projectAuditLogs.reduce((acc, log) => {\n                        const type = log.documentType || 'Otros';\n                        if (!acc[type]) acc[type] = [];\n                        acc[type].push(log);\n                        return acc;\n                      }, {});\n                      \n                      return (\n                        <div className=\"space-y-2\">\n                          <p className=\"text-sm text-gray-600 font-medium\">\n                            Total de documentos: {projectAuditLogs.length}\n                          </p>\n                          <div className=\"space-y-1\">\n                            {Object.entries(documentTypes).map(([type, logs]) => (\n                              <div key={type} className=\"flex items-center justify-between text-xs\">\n                                <span className=\"text-gray-600\">{type}:</span>\n                                <span className=\"font-medium\">{logs.length}</span>\n                              </div>\n                            ))}\n                          </div>\n                        </div>\n                      );\n                    })()}\n                  </div>\n                </div>\n              </div>\n\n              {/* Mtricas Finales */}\n              <div className=\"bg-yellow-50 p-4 rounded-lg\">\n                <h4 className=\"font-semibold text-gray-800 mb-3 flex items-center space-x-2\">\n                  <span></span>\n                  <span>Mtricas Finales</span>\n                </h4>\n                <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm\">\n                  <div className=\"text-center\">\n                    <div className=\"text-2xl font-bold text-blue-600\">\n                      {selectedArchivedProject.progress}%\n                    </div>\n                    <div className=\"text-gray-600\">Progreso Final</div>\n                  </div>\n                  <div className=\"text-center\">\n                    <div className=\"text-2xl font-bold text-green-600\">\n                      {(() => {\n                        const projectTasks = tasks.filter(task => \n                          task.workPackageId === selectedArchivedProject.id || \n                          task.projectId === selectedArchivedProject.id\n                        );\n                        return projectTasks.length;\n                      })()}\n                    </div>\n                    <div className=\"text-gray-600\">Tareas Totales</div>\n                  </div>\n                  <div className=\"text-center\">\n                    <div className=\"text-2xl font-bold text-purple-600\">\n                      {new Date(selectedArchivedProject.archivedAt).toLocaleDateString()}\n                    </div>\n                    <div className=\"text-gray-600\">Fecha de Archivado</div>\n                  </div>\n                  <div className=\"text-center\">\n                    <div className=\"text-2xl font-bold text-orange-600\">\n                      {selectedArchivedProject.archivedBy}\n                    </div>\n                    <div className=\"text-gray-600\">Responsable</div>\n                  </div>\n                </div>\n              </div>\n\n              {/* Auditora Documental Detallada */}\n              <div className=\"bg-blue-50 p-4 rounded-lg\">\n                <h4 className=\"font-semibold text-gray-800 mb-3 flex items-center space-x-2\">\n                  <span></span>\n                  <span>Registro de Auditora Documental</span>\n                </h4>\n                <div className=\"space-y-3\">\n                  {(() => {\n                    const projectAuditLogs = auditLogs.filter(log => \n                      log.projectId === selectedArchivedProject.id || \n                      log.workPackageId === selectedArchivedProject.id\n                    );\n                    \n                    if (projectAuditLogs.length === 0) {\n                      return (\n                        <p className=\"text-sm text-gray-500 italic text-center py-4\">\n                          No hay registros de auditora documental para este proyecto\n                        </p>\n                      );\n                    }\n                    \n                    // Ordenar por fecha (ms reciente primero)\n                    const sortedLogs = projectAuditLogs.sort((a, b) => \n                      new Date(b.timestamp) - new Date(a.timestamp)\n                    );\n                    \n                    return (\n                      <div className=\"space-y-2 max-h-64 overflow-y-auto\">\n                        {sortedLogs.map((log, index) => (\n                          <div key={index} className=\"bg-white p-3 rounded border border-gray-200\">\n                            <div className=\"flex items-start justify-between\">\n                              <div className=\"flex-1\">\n                                <div className=\"flex items-center space-x-2 mb-1\">\n                                  <span className=\"text-sm font-medium text-gray-800\">\n                                    {log.documentType || 'Documento'}\n                                  </span>\n                                  <span className={`px-2 py-1 rounded-full text-xs font-medium ${\n                                    log.action === 'create' ? 'bg-green-100 text-green-800' :\n                                    log.action === 'update' ? 'bg-blue-100 text-blue-800' :\n                                    log.action === 'delete' ? 'bg-red-100 text-red-800' :\n                                    'bg-gray-100 text-gray-800'\n                                  }`}>\n                                    {log.action === 'create' ? 'Creado' :\n                                     log.action === 'update' ? 'Modificado' :\n                                     log.action === 'delete' ? 'Eliminado' : 'Accin'}\n                                  </span>\n                                </div>\n                                <p className=\"text-xs text-gray-600 mb-1\">\n                                  {log.description || 'Sin descripcin'}\n                                </p>\n                                <div className=\"flex items-center space-x-4 text-xs text-gray-500\">\n                                  <span>Por: {log.user || 'Sistema'}</span>\n                                  <span></span>\n                                  <span>{new Date(log.timestamp).toLocaleString()}</span>\n                                </div>\n                              </div>\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n                    );\n                  })()}\n                </div>\n              </div>\n\n              {/* Nota de Solo Lectura */}\n              <div className=\"bg-gray-100 p-4 rounded-lg border-l-4 border-gray-400\">\n                <div className=\"flex items-start space-x-2\">\n                  <span className=\"text-yellow-600 text-xl\"></span>\n                  <div>\n                    <h5 className=\"font-medium text-gray-800\">Proyecto Archivado</h5>\n                    <p className=\"text-sm text-gray-600 mt-1\">\n                      Este proyecto est archivado y es de solo lectura. Los datos se mantienen \n                      para consulta histrica y auditora, pero no se puede modificar.\n                    </p>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"p-6 border-t border-gray-200 flex justify-end space-x-3\">\n              <button\n                onClick={closeArchivedDetails}\n                className=\"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors\"\n              >\n                Cerrar\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\n// Funciones auxiliares para fechas\nconst getStartOfWeek = (date) => {\n  const d = new Date(date);\n  const day = d.getDay();\n  const diff = d.getDate() - day + (day === 0 ? -6 : 1); // Ajustar para que lunes sea el primer da\n  d.setDate(diff);\n  d.setHours(0, 0, 0, 0);\n  return d;\n};\n\nconst getEndOfWeek = (date) => {\n  const d = new Date(date);\n  const day = d.getDay();\n  const diff = d.getDate() - day + (day === 0 ? -6 : 1) + 6; // Domingo de la misma semana\n  d.setDate(diff);\n  d.setHours(23, 59, 59, 999);\n  return d;\n};\n\nexport default PortfolioStrategic;\n"],"names":["getStatusColor","status","getStatusIcon","_ref","project","workPackages","risks","tasks","purchaseOrders","advances","invoices","contracts","resourceAssignments","onArchiveProject","isGenerating","setIsGenerating","useState","archiveProgress","setArchiveProgress","auditLog","getProjectAuditLog","savedLog","localStorage","getItem","concat","id","JSON","parse","error","console","files","projectFiles","getFileStats","useFileStorage","fileStats","finalMetrics","useMemo","totalWorkPackages","length","completedWorkPackages","filter","wp","totalBudget","reduce","sum","budget","totalEarned","earnedValue","totalActual","actualCost","completionPercentage","budgetUtilization","cpi","totalRisks","activeRisks","r","totalTasks","completedTasks","t","totalFinancialItems","totalResourceAssignments","totalAuditEvents","totalFiles","totalFileSize","totalSizeMB","canArchive","generateLessonsLearned","lessons","push","_jsxs","className","children","_jsx","name","toFixed","manager","startDate","endDate","Date","timestamp","toLocaleDateString","style","width","onClick","async","steps","i","Promise","resolve","setTimeout","projectArchive","metadata","archiveDate","toISOString","archiveVersion","projectId","projectName","archiveType","_objectSpread","archivedAt","financial","resources","summary","totalDuration","Math","round","finalBudget","finalCost","completionRate","performanceIndex","lessonsLearned","dataStr","stringify","dataBlob","Blob","type","url","URL","createObjectURL","link","document","createElement","href","download","replace","split","click","revokeObjectURL","disabled","createNotification","userEmail","userId","changeId","changeNumber","changeTitle","notificationType","title","message","priority","supabaseService","getCurrentUser","orgId","getCurrentOrganization","warn","success","notification","organization_id","user_id","user_email","change_id","change_number","change_title","notification_type","action_url","created_at","data","supabase","from","insert","select","single","getUnreadNotifications","session","auth","getSession","user","eq","order","ascending","markAsRead","update","read_at","updated_at","notificationId","markAllAsRead","getUnreadCount","count","head","notifyChangeAssigned","change","assignedBy","_ref2","changeStatus","notifyApprovalRequired","_ref3","costImpact","impactCost","scheduleImpact","impactSchedule","notifyCCBVoteRequired","_ref4","notifyStatusChanged","oldStatus","newStatus","changedBy","_ref5","ErrorMessage","_portfolioMetrics$cur","_portfolioMetrics$cur2","projects","currentProjectId","setCurrentProjectId","portfolioMetrics","globalResources","setGlobalResources","tasksByProject","createProject","updateProject","deleteProject","duplicateProject","archiveProject","includeWeekendsByProject","setIncludeWeekendsByProject","getCurrentProjectIncludeWeekends","triggerNewProject","onNewProjectTriggered","showFileManager","setShowFileManager","selectedProjectForFiles","setSelectedProjectForFiles","showProjectModal","setShowProjectModal","editingProject","setEditingProjectInternal","errors","setErrors","organizationId","setOrganizationId","showUpgradeModal","setShowUpgradeModal","subscriptionLimit","setSubscriptionLimit","setEditingProject","updater","prev","permissions","isReadOnly","isLoading","permissionsLoading","usePermissions","getPriorityColor","updateProjectField","fieldName","value","validateField","newErrors","Object","assign","trim","sponsor","irr","keys","handleNewProject","description","now","contingencyReserve","managementReserve","objective","businessCase","roi","kickoffDate","stakeholders","createdAt","updatedAt","version","React","useEffect","fetchOrganizationId","logger","debug","timer","clearTimeout","calculatedMetrics","totalProjects","activeProjects","completedProjects","averageProgress","p","activeProjectsList","progress","metrics","canEdit","projectList","sort","a","b","nameA","nameB","startsWithNumberA","test","startsWithNumberB","numA","parseInt","match","numB","localeCompare","sensitivity","map","e","stopPropagation","projectToEdit","handleEditProject","window","confirm","currentProjectCPI","currentProjectSPI","currentProjectCV","currentProjectSV","CorporateAlerts","PortfolioCharts","FileManager","category","isContextual","onFileUploaded","onChange","target","onBlur","placeholder","inputValue","numValue","Number","min","period","newPlannedValue","pow","max","step","newPeriod","plannedValue","parseFloat","calculated","toLocaleString","rows","alert","canCreate","subscriptionService","canCreateProject","allowed","currentCount","maxCount","suggestion","showAddModal","setShowAddModal","showEditModal","setShowEditModal","editingResource","setEditingResource","searchTerm","setSearchTerm","roleFilter","setRoleFilter","statusFilter","setStatusFilter","newResource","setNewResource","role","skills","availability","hourlyRate","email","phone","department","experience","certifications","notes","filteredResources","resource","matchesSearch","toLowerCase","includes","matchesRole","matchesStatus","uniqueRoles","roles","Array","Set","resourceMetrics","totalResources","activeResources","inactiveResources","onLeaveResources","totalCost","colSpan","n","join","isArray","openEditModal","handleDeleteResource","handleAddResource","String","slice","s","log","newResources","handleEditResource","normalizeDate","dateString","date","isNaN","getTime","getFullYear","isValidDate","setHours","getStartOfWeek","d","day","getDay","diff","getDate","setDate","getEndOfWeek","formatDate","month","year","isTaskCompleted","task","arguments","undefined","estatus","isTaskPending","ProjectTasksList","currentTasks","overdueTasks","allTasks","scheduleTasks","isOverdue","minuteTasks","tarea","responsable","fecha","FileText","overdueList","currentWeekTasks","AlertCircle","index","TaskCard","Clock","Calendar","displayName","minutasByProject","weeklyPlanningData","setWeeklyPlanningData","useSupabase","dateRange","setDateRange","start","end","previousWeekData","setPreviousWeekData","setIsLoading","localMinutaTasks","setLocalMinutaTasks","loadingMinutas","setLoadingMinutas","handleMinutaStatusChanged","event","tareaId","detail","addEventListener","removeEventListener","filtered","total","active","tasksByProjectKeys","minutasByProjectKeys","previousWeekRange","today","filterTasksByDateRange","useCallback","isMinuteTask","taskDate","filterOverdueTasks","dueDate","isPending","getCurrentWeekTasks","projectTasks","projectMinuteTasks","totalScheduleTasks","totalMinuteTasks","totalFiltered","getOverdueTasks","calculatePreviousWeekCompliance","compliance","pendingTasks","byProject","previousWeekScheduleTasks","previousWeekMinuteTasks","allPreviousTasks","completed","idx","pending","overdue","isMinute","loadPreviousWeekData","complianceData","err","minutasByProjectLocal","default","minutas","loadMinutasByProject","_portfolioData$minuta","minutasFromStorage","acc","key","loadMinutasForAllProjects","exportToPDF","doc","jsPDF","pageWidth","internal","pageSize","getWidth","pageHeight","getHeight","yPosition","setFontSize","setFont","text","align","forEach","addPage","setTextColor","setDrawColor","setLineWidth","rect","currentList","fileName","save","Download","useNotifications","notifications","setNotifications","unreadCount","setUnreadCount","loading","setLoading","setError","isLoadingRef","useRef","lastFetchTime","loadNotifications","force","current","currentUser","unreadNotifications","markNotificationAsRead","result","markAllNotificationsAsRead","refreshNotifications","interval","setInterval","clearInterval","checkUserChange","_lastFetchTime$curren","currentEmail","refresh","onMarkAsRead","onClose","location","getNotificationIcon","diffMs","diffMins","floor","diffHours","diffDays","getTimeAgo","isOpen","onMarkAllAsRead","_Fragment","currentTarget","NotificationItem","isPanelOpen","setIsPanelOpen","handleTogglePanel","NotificationPanel","plan","size","showIcon","showStatus","planConfig","legacy","label","icon","Shield","bgColor","textColor","free","Zap","professional","Rocket","statusConfig","color","dotColor","trialing","past_due","canceled","expired","sizes","sm","container","gap","md","lg","config","statusConf","sizeConf","Icon","_stats$projects","_stats$projects2","_stats$users","_stats$users2","variant","stats","setStats","organization","setOrganization","usageStats","getUsageStats","portfolioData","portfolio","loadUsageStats","subscriptionPlan","subscriptionStatus","currentProjects","maxProjects","currentUsers","users","maxUsers","projectUsagePercent","userUsagePercent","getUsageColor","percent","SubscriptionBadge","setProjects","auditLogs","activeTab","setActiveTab","setTriggerNewProject","archivedProjects","setArchivedProjects","selectedArchivedProject","setSelectedArchivedProject","showArchivedDetails","setShowArchivedDetails","previousWeekCompliance","_portfolio$organizati","currentProject","find","canArchiveProject","validations","workPackageId","incompleteTasks","predecessors","predId","Boolean","some","pred","missingDocuments","file","projectPurchaseOrders","po","projectInvoices","inv","projectContracts","contract","pendingApprovals","handleArchiveProject","projectToArchive","validation","validationMessage","confirmMessage","archivedProject","team","archivedBy","newArchived","updatedProjects","closeArchivedDetails","UsageIndicator","NotificationBadge","tab","PortfolioDashboard","projectToDuplicate","duplicatedProject","handleNewProjectTriggered","ResourceList","firstProjectId","WeeklyPlanningTab","viewArchivedProject","percentage","projectAuditLogs","documentTypes","documentType","entries","logs","sortedLogs","action"],"sourceRoot":""}