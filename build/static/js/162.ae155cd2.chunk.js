/*! For license information please see 162.ae155cd2.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkmi_dashboard=self.webpackChunkmi_dashboard||[]).push([[162],{1946:(e,s,a)=>{a.d(s,{A:()=>r});const r=(0,a(6230).A)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},3147:(e,s,a)=>{a.d(s,{A:()=>r});const r=(0,a(6230).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},4814:(e,s,a)=>{a.d(s,{A:()=>r});const r=(0,a(6230).A)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])},5924:(e,s,a)=>{a.d(s,{A:()=>r});const r=(0,a(6230).A)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},6162:(e,s,a)=>{a.r(s),a.d(s,{default:()=>C});var r=a(9379),t=a(9950),l=a(1403),i=a(7902),o=a(6230);const n=(0,o.A)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),d=(0,o.A)("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);var c=a(9975),u=a(2828),x=a(9201);const m=(0,o.A)("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);var g=a(7637),p=a(5924),h=a(1946);const b=(0,o.A)("shuffle",[["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22",key:"1ailkh"}],["path",{d:"M2 6h1.972a4 4 0 0 1 3.6 2.2",key:"km57vx"}],["path",{d:"M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45",key:"os18l9"}]]),v=(0,o.A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);var y=a(3147);const j=(0,o.A)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);var f=a(4814);const N=(0,o.A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),k=(0,o.A)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);var w=a(4414);const C=e=>{var s;let{projects:o,currentProjectId:C,setCurrentProjectId:A,risks:M,setRisks:R,setProjects:P,useSupabase:z=!1}=e;console.log("RiskManagement - risks recibidos:",M),console.log("RiskManagement - tipo de risks:",typeof M),console.log("RiskManagement - es array:",Array.isArray(M));const[I,S]=(0,t.useState)(null),[F,E]=(0,t.useState)("matrix"),[q,D]=(0,t.useState)("all"),[K,O]=(0,t.useState)("all"),[H,T]=(0,t.useState)("all"),[$,B]=(0,t.useState)(!1),[L,V]=(0,t.useState)(null),[G,U]=(0,t.useState)(!1),[_,Q]=(0,t.useState)(null),[W,Z]=(0,t.useState)(""),[J,X]=(0,t.useState)(!1),{logRiskCreated:Y}=((0,t.useRef)(null),(0,i.A)(C,z)),ee=(e,s)=>{Q(a=>(0,r.A)((0,r.A)({},a),{},{[e]:s}))},se={technical:{label:"T\xe9cnico",color:"blue",icon:n},financial:{label:"Financiero",color:"green",icon:d},organizational:{label:"Organizacional",color:"purple",icon:c.A},external:{label:"Externo",color:"orange",icon:u.A},schedule:{label:"Cronograma",color:"yellow",icon:x.A},resource:{label:"Recursos",color:"indigo",icon:c.A},quality:{label:"Calidad",color:"pink",icon:m},scope:{label:"Alcance",color:"teal",icon:g.A}},ae={avoid:{label:"Evitar",color:"red",description:"Eliminar la amenaza o proteger el proyecto"},mitigate:{label:"Mitigar",color:"yellow",description:"Reducir probabilidad o impacto"},transfer:{label:"Transferir",color:"blue",description:"Trasladar el riesgo a un tercero"},accept:{label:"Aceptar",color:"green",description:"Reconocer el riesgo sin acci\xf3n"},exploit:{label:"Explotar",color:"emerald",description:"Aprovechar la oportunidad"},enhance:{label:"Mejorar",color:"cyan",description:"Aumentar probabilidad o impacto positivo"},share:{label:"Compartir",color:"violet",description:"Compartir la oportunidad con terceros"}},re={initiation:"Iniciaci\xf3n",planning:"Planificaci\xf3n",execution:"Ejecuci\xf3n",monitoring:"Monitoreo y Control",closure:"Cierre"},te=(0,t.useMemo)(()=>{if(!M||!Array.isArray(M))return{totalRisks:0,activeRisks:0,highPriority:0,totalExposure:0,avgRiskScore:"0.00",mitigatedRisks:0,occurredRisks:0};const e=M.filter(e=>"active"===e.status),s=e.filter(e=>"high"===e.priority).length,a=e.reduce((e,s)=>e+s.costImpact*s.probability,0),r=e.reduce((e,s)=>e+s.riskScore,0)/e.length,t=M.filter(e=>"mitigated"===e.status).length,l=M.filter(e=>e.actualOccurred).length;return{totalRisks:M.length,activeRisks:e.length,highPriority:s,totalExposure:Math.round(a),avgRiskScore:r.toFixed(2),mitigatedRisks:t,occurredRisks:l}},[M]),le=null===o||void 0===o?void 0:o.find(e=>e.id===C),ie=()=>{if(!M||!Array.isArray(M))return.05*(null===le||void 0===le?void 0:le.budget)||0;const e=M.filter(e=>"active"===e.status);if(0===e.length)return.05*(null===le||void 0===le?void 0:le.budget)||0;return.05*((null===le||void 0===le?void 0:le.budget)||0)+e.reduce((e,s)=>e+s.probability*s.costImpact*("high"===s.priority?1.5:"medium"===s.priority?1.2:1),0)},oe=()=>{if(!le)return 0;const e=le.budget||0;if(!M||!Array.isArray(M))return.1*e;const s=M.filter(e=>"active"===e.status);let a=.1*e;s.length>10?a*=1.2:s.length>5&&(a*=1.1);return s.filter(e=>"high"===e.priority).length>3&&(a*=1.15),a},ne=()=>{U(!1),Q(null)},de=(0,t.useMemo)(()=>M&&Array.isArray(M)?M.filter(e=>{const s="all"===q||e.category===q,a="all"===K||e.status===K,r="all"===H||e.priority===H,t=e.name.toLowerCase().includes(W.toLowerCase())||e.description.toLowerCase().includes(W.toLowerCase())||e.code.toLowerCase().includes(W.toLowerCase());return s&&a&&r&&t}):[],[M,q,K,H,W]),ce=e=>{if(!e||!le||!P)return;const s=Math.max(0,e.p80-e.baseBudget),a=Math.max(0,e.p95-e.p80);if(console.log("\ud83d\udd04 Actualizando reservas bas\xe1ndose en Monte Carlo:"),console.log("\ud83d\udcca P80 Contingency:",s),console.log("\ud83d\udcca P95 Management:",a),le&&P){const t=(0,r.A)((0,r.A)({},le),{},{contingencyReserve:s,managementReserve:a,monteCarloResults:{lastUpdate:(new Date).toISOString(),p80Contingency:s,p95Management:a,recommendedBudget:e.p95}});P(e=>e.map(e=>e.id===le.id?t:e)),alert("\u2705 Reservas actualizadas bas\xe1ndose en an\xe1lisis Monte Carlo:\n      \n\ud83d\udcca Reserva de Contingencia: $".concat((s/1e3).toFixed(1),"K (P80)\n\ud83d\udcca Reserva de Gesti\xf3n: $").concat((a/1e3).toFixed(1),"K (P95)\n\ud83d\udcca Presupuesto Total Recomendado: $").concat((e.p95/1e3).toFixed(1),"K\n\nLas reservas se han actualizado en el proyecto y se reflejar\xe1n en todos los m\xf3dulos.")),console.log("\u2705 Proyecto actualizado con nuevas reservas de Monte Carlo")}};return(0,w.jsxs)("div",{className:"min-h-screen bg-gray-50 p-4",children:[(0,w.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,w.jsxs)("div",{className:"bg-gradient-to-r from-red-50 to-orange-100 rounded-2xl shadow-lg p-6 mb-6 text-gray-800 relative overflow-hidden",children:[(0,w.jsx)("div",{className:"absolute top-0 right-0 w-32 h-32 bg-red-100/30 rounded-full -translate-y-16 translate-x-16"}),(0,w.jsx)("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-orange-100/30 rounded-full translate-y-12 -translate-x-12"}),(0,w.jsx)("div",{className:"relative z-10",children:(0,w.jsxs)("div",{className:"flex items-center justify-between",children:[(0,w.jsxs)("div",{className:"flex items-center",children:[(0,w.jsx)("div",{className:"bg-white/60 backdrop-blur rounded-2xl p-3 mr-4 shadow-sm",children:(0,w.jsx)("span",{className:"text-3xl",children:"\ud83d\udee1\ufe0f"})}),(0,w.jsxs)("div",{children:[(0,w.jsx)("h1",{className:"text-4xl font-bold mb-2 text-gray-800",children:"Gesti\xf3n de Riesgos"}),(0,w.jsx)("p",{className:"text-gray-600 text-lg",children:"Identificaci\xf3n, an\xe1lisis y respuesta a riesgos del proyecto seg\xfan PMBOK"})]})]}),(0,w.jsx)("div",{className:"flex items-center space-x-4",children:(0,w.jsxs)("select",{value:C||"",onChange:e=>A(e.target.value),className:"px-4 py-2 rounded-lg bg-white text-gray-800 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-red-500 shadow-sm",children:[(0,w.jsx)("option",{value:"",children:"Seleccionar Proyecto"}),null===o||void 0===o?void 0:o.filter(e=>"active"===e.status).map(e=>(0,w.jsx)("option",{value:e.id,children:e.name},e.id))]})})]})})]}),(0,w.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-6",children:[(0,w.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-red-500",children:(0,w.jsxs)("div",{className:"flex items-center justify-between",children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:te.activeRisks}),(0,w.jsx)("div",{className:"text-sm text-gray-600",children:"Riesgos Activos"})]}),(0,w.jsx)(p.A,{className:"text-red-500",size:32})]})}),(0,w.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-orange-500",children:(0,w.jsxs)("div",{className:"flex items-center justify-between",children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:te.highPriority}),(0,w.jsx)("div",{className:"text-sm text-gray-600",children:"Alta Prioridad"})]}),(0,w.jsx)(n,{className:"text-orange-500",size:32})]})}),(0,w.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-yellow-500",children:(0,w.jsxs)("div",{className:"flex items-center justify-between",children:[(0,w.jsxs)("div",{children:[(0,w.jsxs)("div",{className:"text-2xl font-bold text-gray-800",children:["$",(te.totalExposure/1e3).toFixed(0),"K"]}),(0,w.jsx)("div",{className:"text-sm text-gray-600",children:"Exposici\xf3n Total"})]}),(0,w.jsx)(d,{className:"text-yellow-500",size:32})]})}),(0,w.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-green-500",children:(0,w.jsxs)("div",{className:"flex items-center justify-between",children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:te.mitigatedRisks}),(0,w.jsx)("div",{className:"text-sm text-gray-600",children:"Mitigados"})]}),(0,w.jsx)(h.A,{className:"text-green-500",size:32})]})}),(0,w.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-purple-500",children:(0,w.jsxs)("div",{className:"flex items-center justify-between",children:[(0,w.jsxs)("div",{children:[(0,w.jsxs)("div",{className:"text-2xl font-bold text-gray-800",children:["$",((()=>{if(!le)return 0;const e=le.budget||0;if(!M||!Array.isArray(M))return 1.15*e;return e+ie()+oe()})()/1e3).toFixed(0),"K"]}),(0,w.jsx)("div",{className:"text-sm text-gray-600",children:"Presupuesto Total"})]}),(0,w.jsx)(d,{className:"text-purple-500",size:32})]})})]}),(0,w.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[(0,w.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Reservas de Costos"}),le?(0,w.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,w.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,w.jsx)("h4",{className:"font-medium text-gray-800 mb-2",children:"Presupuesto Base"}),(0,w.jsxs)("div",{className:"text-2xl font-bold text-gray-900",children:["$",((le.budget||0)/1e3).toFixed(0),"K"]}),(0,w.jsx)("p",{className:"text-sm text-gray-700 mt-1",children:"Presupuesto asignado al proyecto"})]}),(0,w.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4",children:[(0,w.jsx)("h4",{className:"font-medium text-blue-800 mb-2",children:"Reserva de Contingencia"}),(0,w.jsxs)("div",{className:"text-2xl font-bold text-blue-900",children:["$",(ie()/1e3).toFixed(0),"K"]}),(0,w.jsx)("p",{className:"text-sm text-blue-700 mt-1",children:"Basada en an\xe1lisis cuantitativo de riesgos activos"})]}),(0,w.jsxs)("div",{className:"bg-green-50 rounded-lg p-4",children:[(0,w.jsx)("h4",{className:"font-medium text-green-800 mb-2",children:"Reserva de Gesti\xf3n"}),(0,w.jsxs)("div",{className:"text-2xl font-bold text-green-900",children:["$",(oe()/1e3).toFixed(0),"K"]}),(0,w.jsx)("p",{className:"text-sm text-green-700 mt-1",children:"10% del presupuesto base del proyecto"})]})]}):(0,w.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,w.jsx)(h.A,{size:48,className:"mx-auto mb-4 text-gray-300"}),(0,w.jsx)("p",{children:"Selecciona un proyecto para ver las reservas de costos"})]})]}),(0,w.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[(0,w.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,w.jsx)("h3",{className:"text-lg font-semibold",children:"An\xe1lisis Monte Carlo"}),(0,w.jsxs)("button",{onClick:()=>{if(!le||!M||!Array.isArray(M))return;const e=1e4,s=le.budget||0,a=M.filter(e=>"active"===e.status);if(0===a.length)return void V({averageCost:s,p50:s,p80:s,p95:s,iterations:e,note:"No hay riesgos activos para simular"});let r=0,t=[];for(let o=0;o<e;o++){let e=s;a.forEach(s=>{if(Math.random()<s.probability){const a=.8+.4*Math.random();e+=s.costImpact*a}}),r+=e,t.push(e)}t.sort((e,s)=>e-s);const l=r/e,i={averageCost:l,p50:t[Math.floor(5e3)],p80:t[Math.floor(8e3)],p95:t[Math.floor(9500)],iterations:e,riskCount:a.length,baseBudget:s,riskImpact:l-s};V(i),ce(i)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center space-x-2",children:[(0,w.jsx)(b,{size:16}),(0,w.jsx)("span",{children:"Ejecutar Simulaci\xf3n"})]})]}),L?(0,w.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,w.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4",children:[(0,w.jsx)("h4",{className:"font-medium text-blue-800 mb-2",children:"Costo Promedio"}),(0,w.jsxs)("div",{className:"text-2xl font-bold text-blue-900",children:["$",(L.averageCost/1e3).toFixed(0),"K"]})]}),(0,w.jsxs)("div",{className:"bg-green-50 rounded-lg p-4",children:[(0,w.jsx)("h4",{className:"font-medium text-green-800 mb-2",children:"P50 (Mediana)"}),(0,w.jsxs)("div",{className:"text-2xl font-bold text-green-900",children:["$",(L.p50/1e3).toFixed(0),"K"]})]}),(0,w.jsxs)("div",{className:"bg-yellow-50 rounded-lg p-4",children:[(0,w.jsx)("h4",{className:"font-medium text-yellow-800 mb-2",children:"P80"}),(0,w.jsxs)("div",{className:"text-2xl font-bold text-yellow-900",children:["$",(L.p80/1e3).toFixed(0),"K"]})]}),(0,w.jsxs)("div",{className:"bg-red-50 rounded-lg p-4",children:[(0,w.jsx)("h4",{className:"font-medium text-red-800 mb-2",children:"P95"}),(0,w.jsxs)("div",{className:"text-2xl font-bold text-red-900",children:["$",(L.p95/1e3).toFixed(0),"K"]})]})]}):(0,w.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,w.jsx)(b,{size:48,className:"mx-auto mb-4 text-gray-300"}),(0,w.jsx)("p",{children:"Ejecuta la simulaci\xf3n Monte Carlo para ver los resultados"})]})]}),(0,w.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[(0,w.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,w.jsx)("h3",{className:"text-lg font-semibold",children:"Gesti\xf3n de Riesgos"}),(0,w.jsxs)("button",{onClick:()=>{Q({id:"R".concat(Date.now()),code:"",name:"",description:"",category:"technical",phase:"planning",probability:.5,impact:.5,riskScore:.25,status:"active",priority:"medium",owner:"",identifiedDate:(new Date).toISOString().split("T")[0],reviewDate:"",response:"mitigate",responsePlan:"",contingencyPlan:"",triggerConditions:"",costImpact:0,scheduleImpact:0,residualProbability:0,residualImpact:0,monitoringFrequency:"weekly",earlyWarnings:[],actualOccurred:!1,stakeholders:[],assumptions:[],constraints:[],projectId:C}),U(!0)},className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center space-x-2",children:[(0,w.jsx)(v,{size:16}),(0,w.jsx)("span",{children:"Nuevo Riesgo"})]})]}),(0,w.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-4",children:[(0,w.jsxs)("div",{className:"relative",children:[(0,w.jsx)(y.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),(0,w.jsx)("input",{type:"text",placeholder:"Buscar riesgos...",value:W,onChange:e=>Z(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,w.jsxs)("select",{value:q,onChange:e=>D(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,w.jsx)("option",{value:"all",children:"Todas las Categor\xedas"}),Object.entries(se).map(e=>{let[s,a]=e;return(0,w.jsx)("option",{value:s,children:a.label},s)})]}),(0,w.jsxs)("select",{value:K,onChange:e=>O(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,w.jsx)("option",{value:"all",children:"Todos los Estados"}),(0,w.jsx)("option",{value:"active",children:"Activo"}),(0,w.jsx)("option",{value:"mitigated",children:"Mitigado"}),(0,w.jsx)("option",{value:"closed",children:"Cerrado"})]}),(0,w.jsxs)("select",{value:H,onChange:e=>T(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,w.jsx)("option",{value:"all",children:"Todas las Prioridades"}),(0,w.jsx)("option",{value:"high",children:"Alta"}),(0,w.jsx)("option",{value:"medium",children:"Media"}),(0,w.jsx)("option",{value:"low",children:"Baja"})]}),(0,w.jsxs)("select",{value:F,onChange:e=>E(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,w.jsx)("option",{value:"matrix",children:"Vista Matriz"}),(0,w.jsx)("option",{value:"list",children:"Vista Lista"})]})]}),(0,w.jsxs)("div",{className:"space-y-4",children:[de.map(e=>(0,w.jsx)("div",{className:"border rounded-lg p-4 hover:bg-gray-50",children:(0,w.jsxs)("div",{className:"flex items-center justify-between",children:[(0,w.jsxs)("div",{className:"flex-1",children:[(0,w.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,w.jsx)("span",{className:"font-medium text-gray-900",children:e.code}),(0,w.jsx)("span",{className:"font-medium text-gray-900",children:e.name}),(0,w.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("high"===e.priority?"bg-red-100 text-red-700":"medium"===e.priority?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"),children:e.priority.toUpperCase()}),(0,w.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("active"===e.status?"bg-red-100 text-red-700":"mitigated"===e.status?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"),children:e.status.toUpperCase()})]}),(0,w.jsx)("div",{className:"text-sm text-gray-600 mb-2",children:e.description}),(0,w.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4 text-xs text-gray-500",children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("span",{className:"font-medium",children:"Probabilidad:"})," ",(100*e.probability).toFixed(0),"%"]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("span",{className:"font-medium",children:"Impacto:"})," ",(100*e.impact).toFixed(0),"%"]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("span",{className:"font-medium",children:"Costo:"})," $",(e.costImpact/1e3).toFixed(0),"K"]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("span",{className:"font-medium",children:"Cronograma:"})," ",e.scheduleImpact," d\xedas"]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("span",{className:"font-medium",children:"Responsable:"})," ",e.owner]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("span",{className:"font-medium",children:"Fase:"})," ",re[e.phase]]})]})]}),(0,w.jsxs)("div",{className:"flex items-center space-x-2 ml-4",children:[(0,w.jsxs)("div",{className:"text-right",children:[(0,w.jsx)("div",{className:"text-lg font-bold text-gray-900",children:e.riskScore.toFixed(2)}),(0,w.jsx)("div",{className:"text-xs text-gray-500",children:"Risk Score"})]}),(0,w.jsxs)("div",{className:"flex flex-col space-y-1",children:[(0,w.jsx)("button",{onClick:()=>(e=>{Q(Object.assign({},e,{projectId:C})),U(!0)})(e),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg",title:"Editar",children:(0,w.jsx)(j,{size:16})}),(0,w.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("\xbfEst\xe1s seguro de que quieres eliminar este riesgo?"))try{const{default:s}=await Promise.resolve().then(a.bind(a,9874)),r=await s.deleteRisk(e);r.success?M&&Array.isArray(M)&&(R(M.filter(s=>s.id!==e)),console.log("\u2705 Riesgo eliminado localmente y de Supabase")):(console.error("\u274c Error eliminando riesgo de Supabase:",r.error),alert("Error eliminando el riesgo. Int\xe9ntalo de nuevo."))}catch(s){console.error("\u274c Error inesperado eliminando riesgo:",s),alert("Error inesperado eliminando el riesgo. Int\xe9ntalo de nuevo.")}})(e.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",title:"Eliminar",children:(0,w.jsx)(f.A,{size:16})})]})]})]})},e.id)),0===de.length&&(0,w.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,w.jsx)(p.A,{size:48,className:"mx-auto mb-4 text-gray-300"}),(0,w.jsx)("p",{children:"No se encontraron riesgos con los filtros aplicados"})]})]})]})]}),G&&(0,w.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,w.jsx)("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:(0,w.jsxs)("div",{className:"p-6",children:[(0,w.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,w.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:null!==_&&void 0!==_&&_.id&&M&&Array.isArray(M)&&M.find(e=>e.id===_.id)?"Editar Riesgo":"Nuevo Riesgo"}),(0,w.jsx)("button",{onClick:ne,className:"text-gray-400 hover:text-gray-600",children:(0,w.jsx)(N,{size:24})})]}),(0,w.jsxs)("form",{onSubmit:e=>{e.preventDefault(),(()=>{if(_){const e=_.probability*_.impact,s=Object.assign({},_,{riskScore:e});if(M&&Array.isArray(M))if(M.find(e=>e.id===_.id))R(M.map(e=>e.id===_.id?s:e));else{const e=M.slice();e.push(s),R(e),Y&&le&&Y(s,le)}else R([s]);U(!1),Q(null)}})()},children:[(0,w.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,w.jsxs)("div",{className:"space-y-4",children:[(0,w.jsx)("h3",{className:"text-lg font-semibold text-gray-800 border-b pb-2",children:"Informaci\xf3n B\xe1sica"}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"C\xf3digo del Riesgo"}),(0,w.jsx)("input",{type:"text",value:(null===_||void 0===_?void 0:_.code)||"",onChange:e=>ee("code",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Ej: TECH-001",required:!0})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre del Riesgo"}),(0,w.jsx)("input",{type:"text",value:(null===_||void 0===_?void 0:_.name)||"",onChange:e=>ee("name",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Descripci\xf3n breve del riesgo",required:!0})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripci\xf3n"}),(0,w.jsx)("textarea",{value:(null===_||void 0===_?void 0:_.description)||"",onChange:e=>ee("description",e.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Descripci\xf3n detallada del riesgo",required:!0})]}),(0,w.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Categor\xeda"}),(0,w.jsx)("select",{value:(null===_||void 0===_?void 0:_.category)||"technical",onChange:e=>ee("category",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:Object.entries(se).map(e=>{let[s,a]=e;return(0,w.jsx)("option",{value:s,children:a.label},s)})})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fase del Proyecto"}),(0,w.jsx)("select",{value:(null===_||void 0===_?void 0:_.phase)||"planning",onChange:e=>ee("phase",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:Object.entries(re).map(e=>{let[s,a]=e;return(0,w.jsx)("option",{value:s,children:a},s)})})]})]})]}),(0,w.jsxs)("div",{className:"space-y-4",children:[(0,w.jsx)("h3",{className:"text-lg font-semibold text-gray-800 border-b pb-2",children:"An\xe1lisis Cualitativo"}),(0,w.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Probabilidad (0-1)"}),(0,w.jsx)("input",{type:"number",step:"0.1",min:"0",max:"1",value:(null===_||void 0===_?void 0:_.probability)||.5,onChange:e=>ee("probability",parseFloat(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Impacto (0-1)"}),(0,w.jsx)("input",{type:"number",step:"0.1",min:"0",max:"1",value:(null===_||void 0===_?void 0:_.impact)||.5,onChange:e=>ee("impact",parseFloat(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]})]}),(0,w.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prioridad"}),(0,w.jsxs)("select",{value:(null===_||void 0===_?void 0:_.priority)||"medium",onChange:e=>ee("priority",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,w.jsx)("option",{value:"high",children:"Alta"}),(0,w.jsx)("option",{value:"medium",children:"Media"}),(0,w.jsx)("option",{value:"low",children:"Baja"})]})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estado"}),(0,w.jsxs)("select",{value:(null===_||void 0===_?void 0:_.status)||"active",onChange:e=>ee("status",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,w.jsx)("option",{value:"active",children:"Activo"}),(0,w.jsx)("option",{value:"mitigated",children:"Mitigado"}),(0,w.jsx)("option",{value:"closed",children:"Cerrado"})]})]})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Responsable"}),(0,w.jsx)("input",{type:"text",value:(null===_||void 0===_?void 0:_.owner)||"",onChange:e=>ee("owner",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Nombre del responsable",required:!0})]})]})]}),(0,w.jsxs)("div",{className:"mt-6 space-y-4",children:[(0,w.jsx)("h3",{className:"text-lg font-semibold text-gray-800 border-b pb-2",children:"An\xe1lisis Cuantitativo"}),(0,w.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Impacto en Costos (USD)"}),(0,w.jsx)("input",{type:"number",value:(null===_||void 0===_?void 0:_.costImpact)||0,onChange:e=>ee("costImpact",parseInt(e.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0"})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Impacto en Cronograma (d\xedas)"}),(0,w.jsx)("input",{type:"number",value:(null===_||void 0===_?void 0:_.scheduleImpact)||0,onChange:e=>ee("scheduleImpact",parseInt(e.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0"})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Frecuencia de Monitoreo"}),(0,w.jsx)("select",{value:(null===_||void 0===_?void 0:_.monitoringFrequency)||"weekly",onChange:e=>ee("monitoringFrequency",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:Object.entries({daily:"Diario",weekly:"Semanal",biweekly:"Quincenal",monthly:"Mensual",quarterly:"Trimestral"}).map(e=>{let[s,a]=e;return(0,w.jsx)("option",{value:s,children:a},s)})})]})]})]}),(0,w.jsxs)("div",{className:"mt-6 space-y-4",children:[(0,w.jsx)("h3",{className:"text-lg font-semibold text-gray-800 border-b pb-2",children:"Plan de Respuesta"}),(0,w.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estrategia de Respuesta"}),(0,w.jsx)("select",{value:(null===_||void 0===_?void 0:_.response)||"mitigate",onChange:e=>ee("response",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:Object.entries(ae).map(e=>{let[s,a]=e;return(0,w.jsx)("option",{value:s,children:a.label},s)})}),(0,w.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:null===(s=ae[(null===_||void 0===_?void 0:_.response)||"mitigate"])||void 0===s?void 0:s.description})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha de Revisi\xf3n"}),(0,w.jsx)("input",{type:"date",value:(null===_||void 0===_?void 0:_.reviewDate)||"",onChange:e=>ee("reviewDate",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Plan de Respuesta"}),(0,w.jsx)("textarea",{value:(null===_||void 0===_?void 0:_.responsePlan)||"",onChange:e=>ee("responsePlan",e.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Describe las acciones espec\xedficas para responder al riesgo"})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Plan de Contingencia"}),(0,w.jsx)("textarea",{value:(null===_||void 0===_?void 0:_.contingencyPlan)||"",onChange:e=>ee("contingencyPlan",e.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Describe las acciones a tomar si el riesgo se materializa"})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Condiciones Trigger"}),(0,w.jsx)("textarea",{value:(null===_||void 0===_?void 0:_.triggerConditions)||"",onChange:e=>ee("triggerConditions",e.target.value),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Describe las condiciones que activan el plan de contingencia"})]})]}),(0,w.jsxs)("div",{className:"flex justify-end space-x-3 mt-8 pt-6 border-t",children:[(0,w.jsx)("button",{type:"button",onClick:ne,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Cancelar"}),(0,w.jsxs)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center space-x-2",children:[(0,w.jsx)(k,{size:16}),(0,w.jsx)("span",{children:"Guardar Riesgo"})]})]})]})]})})}),(0,w.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[(0,w.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,w.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"\ud83d\udcce Evidencia y Documentos de Riesgos"}),(0,w.jsxs)("button",{onClick:()=>X(!J),className:"bg-gradient-to-r from-red-600 to-orange-600 text-white px-4 py-2 rounded-lg text-sm hover:from-red-700 hover:to-orange-700 transition-all duration-200 shadow-sm hover:shadow-md",children:[J?"Ocultar":"Mostrar"," Gestor"]})]}),J&&(0,w.jsx)(l.default,{projectId:C,category:"risk-evidence",isContextual:!0,title:"\ud83d\udee1\ufe0f Documentos de Riesgos del Proyecto",onFileUploaded:()=>{}})]})]})}},7637:(e,s,a)=>{a.d(s,{A:()=>r});const r=(0,a(6230).A)("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},9201:(e,s,a)=>{a.d(s,{A:()=>r});const r=(0,a(6230).A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},9975:(e,s,a)=>{a.d(s,{A:()=>r});const r=(0,a(6230).A)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])}}]);