"use strict";(self.webpackChunkmi_dashboard=self.webpackChunkmi_dashboard||[]).push([[538],{2331:(e,t,s)=>{s.d(t,{A:()=>m});var a=s(9379),l=s(9950),r=s(4414);const n=864e5,i=e=>e?"string"===typeof e?e:e.toISOString().split("T")[0]:(new Date).toISOString().split("T")[0],c=e=>{const t=e.getDay();return 0!==t&&6!==t},o=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e||!t)return 0;const a=new Date(e),l=new Date(t);if(s)return Math.ceil((l-a)/n);{let e=0;const t=new Date(a);for(;t<l;)c(t)&&e++,t.setDate(t.getDate()+1);return e}},d=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const a=new Date(e);if(s)return a.setDate(a.getDate()+t),i(a);{let e=0;for(;e<t;)a.setDate(a.getDate()+1),c(a)&&e++;return i(a)}},m=e=>{let{projects:t,portfolioMetrics:s={},workPackages:c=[],risks:m=[],tasksByProject:u={}}=e;const x=[{name:"Activos",count:(null===s||void 0===s?void 0:s.activeProjects)||t.filter(e=>"active"===e.status).length,color:"#3B82F6"},{name:"Completados",count:(null===s||void 0===s?void 0:s.completedProjects)||t.filter(e=>"completed"===e.status).length,color:"#10B981"},{name:"En Pausa",count:t.filter(e=>"on-hold"===e.status).length,color:"#F59E0B"},{name:"Cancelados",count:t.filter(e=>"cancelled"===e.status).length,color:"#EF4444"}].filter(e=>e.count>0),h=[{name:"Alta",count:t.filter(e=>"high"===e.priority).length,color:"#EF4444"},{name:"Media",count:t.filter(e=>"medium"===e.priority).length,color:"#F59E0B"},{name:"Baja",count:t.filter(e=>"low"===e.priority).length,color:"#10B981"}].filter(e=>e.count>0),g=t.filter(e=>"active"===e.status).map((e,t)=>{const s=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#06B6D4"];return{name:e.name.length>20?e.name.substring(0,20)+"...":e.name,budget:e.budget/1e3,status:e.status,color:s[t%s.length]}}),p=[{name:"Completados",count:c.filter(e=>"completed"===e.status).length,color:"#10B981"},{name:"En Progreso",count:c.filter(e=>"in-progress"===e.status).length,color:"#3B82F6"},{name:"Pendientes",count:c.filter(e=>"pending"===e.status).length,color:"#F59E0B"},{name:"Retrasados",count:c.filter(e=>"delayed"===e.status).length,color:"#EF4444"}].filter(e=>e.count>0),f=[{name:"Alta",count:m.filter(e=>"high"===e.priority).length,color:"#EF4444"},{name:"Media",count:m.filter(e=>"medium"===e.priority).length,color:"#F59E0B"},{name:"Baja",count:m.filter(e=>"low"===e.priority).length,color:"#10B981"}].filter(e=>e.count>0),v=[{name:"Activos",count:m.filter(e=>"active"===e.status).length,color:"#EF4444"},{name:"Mitigados",count:m.filter(e=>"mitigated"===e.status).length,color:"#10B981"},{name:"Cerrados",count:m.filter(e=>"closed"===e.status).length,color:"#6B7280"}].filter(e=>e.count>0),j=e=>{let{data:t,title:s,valueKey:a,colorKey:l="color",height:n=200}=e;const i=Math.max(...t.map(e=>e[a]));return(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:s}),(0,r.jsx)("div",{className:"space-y-3",children:t.map((e,t)=>{const s=((e,t)=>{if(e[l])return e[l];const s=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#06B6D4"];return s[t%s.length]})(e,t),n=i>0?"".concat(e[a]/i*100,"%"):"0%",c="number"===typeof e[a]?e[a].toFixed(0):e[a];return(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"w-24 text-sm text-gray-600 truncate",children:e.name}),(0,r.jsx)("div",{className:"flex-1 mx-3",children:(0,r.jsx)("div",{className:"bg-gray-200 rounded-full h-6 relative",children:(0,r.jsx)("div",{className:"h-6 rounded-full flex items-center justify-end pr-2 text-white text-xs font-medium transition-all duration-300",style:{backgroundColor:s,width:n,minWidth:"40px"},children:c})})}),(0,r.jsx)("div",{className:"w-16 text-sm text-gray-600 text-right font-medium",children:c})]},t)})})]})},b=e=>{let{data:t,title:s}=e;const a=t.reduce((e,t)=>e+t.count,0);let l=0;return(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:s}),(0,r.jsxs)("div",{className:"flex items-center justify-center",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("svg",{width:"150",height:"150",className:"transform -rotate-90",children:t.map((e,t)=>{const s=e.count/a*100/100*360,n=2*Math.PI*60,i=s/360*n,c="".concat(i," ").concat(n-i),o=-l;return l+=i,(0,r.jsx)("circle",{cx:"75",cy:"75",r:"60",fill:"transparent",stroke:e.color,strokeWidth:"20",strokeDasharray:c,strokeDashoffset:o,className:"transition-all duration-500"},t)})}),(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:a}),(0,r.jsx)("div",{className:"text-xs text-gray-600",children:"Total"})]})})]}),(0,r.jsx)("div",{className:"ml-6 space-y-2",children:t.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"w-3 h-3 rounded-full mr-2",style:{backgroundColor:e.color}}),(0,r.jsxs)("div",{className:"text-sm text-gray-700",children:[e.name,": ",e.count," (",(e.count/a*100).toFixed(1),"%)"]})]},t))})]})]})},w=()=>{const e=20,s=!1,c=(0,l.useRef)(null),m=(0,l.useRef)(null),x=(0,l.useRef)(!1),h=(0,l.useMemo)(()=>{if(0===t.length)return{start:new Date,end:new Date};const e=t.flatMap(e=>[new Date(e.startDate),new Date(e.endDate)]);return{start:new Date(Math.min(...e.map(e=>e.getTime()))),end:new Date(Math.max(...e.map(e=>e.getTime())))}},[t]),g=(0,l.useMemo)(()=>i(h.start),[h.start]),p=(0,l.useMemo)(()=>{const e=g,t=i(h.end);return Math.max(1,o(e,d(t,1,s),s))},[g,h.end,s]),f=(0,l.useMemo)(()=>p*e,[p]),v=(0,l.useMemo)(()=>{const t=i(new Date),s=new Date(t),a=new Date(g),l=Math.floor((s-a)/n);return Math.min(Math.max(0,l*e),f)},[g,e,f]),j="#10B981",b="#EF4444",w="#4A5568",y=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date;const s=(u[e]||[]).filter(e=>new Date(e.endDate)<=t);if(0===s.length)return w;return s.every(e=>100===e.progress)?j:b},N=(0,l.useMemo)(()=>t.map(t=>{const s=new Date(t.startDate),l=new Date(t.endDate),r=new Date(g),i=Math.floor((s-r)/n),c=Math.floor((l-r)/n),o=Math.max(1,c-i+1),d=(u[t.id]||[]).filter(e=>e.isMilestone).sort((e,t)=>new Date(e.startDate)-new Date(t.startDate)).map((t,s)=>{const l=new Date(t.startDate),i=Math.floor((l-r)/n);return(0,a.A)((0,a.A)({},t),{},{leftPx:i*e,number:s+1})});return{id:t.id,name:t.name,startDate:t.startDate,endDate:t.endDate,leftPx:i*e,widthPx:o*e,progressPercentage:t.progressPercentage,progressColor:y(t.id),milestones:d,totalDays:o}}),[t,g,e,s,u]),D=(0,l.useMemo)(()=>{const t=[],a=new Date(g),l=new Date(i(h.end)),r=new Date(a);for(;r<=l;){const a=new Date(r),n=new Date(r);n.setDate(n.getDate()+6);const i=Math.min(7,o(a,d(l,1,s),s));t.push({label:"S ".concat(a.getDate(),"\u2014").concat(n.getDate()),sub:a.toLocaleDateString("es",{month:"short"}),width:i*e}),r.setDate(r.getDate()+7)}return t},[g,h.end,e,s]);return(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"\ud83d\udcc5 Timeline de Proyectos"}),(0,r.jsx)("div",{className:"rounded-lg p-2 max-w-full overflow-hidden",style:{maxWidth:"calc(100vw - 150px)"},children:(0,r.jsx)("div",{className:"rounded-lg p-2 max-w-full overflow-x-auto overflow-hidden",children:(0,r.jsxs)("div",{className:"rounded-lg p-2 flex flex-col",children:[(0,r.jsxs)("div",{className:"flex mb-2 max-w-full overflow-hidden",children:[(0,r.jsx)("div",{className:"rounded-lg p-2 w-64 flex-shrink-0 flex items-center",children:(0,r.jsx)("div",{className:"text-sm font-semibold text-gray-700",children:"Proyectos"})}),(0,r.jsx)("div",{className:"rounded-lg p-2 flex-1 ml-2 min-w-0",children:(0,r.jsx)("div",{ref:c,onScroll:e=>{m.current&&!x.current&&(x.current=!0,m.current.scrollLeft=e.currentTarget.scrollLeft,setTimeout(()=>{x.current=!1},10))},className:"overflow-x-auto scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-200",children:(0,r.jsx)("div",{className:"flex",style:{width:f},children:D.map((e,t)=>(0,r.jsxs)("div",{className:"text-xs text-gray-600 text-center border-r border-gray-200 flex-shrink-0 py-2",style:{width:e.width,minWidth:e.width},children:[(0,r.jsx)("div",{className:"font-medium",children:e.label}),(0,r.jsx)("div",{className:"text-gray-400",children:e.sub})]},t))})})})]}),(0,r.jsxs)("div",{className:"flex max-w-full overflow-hidden",children:[(0,r.jsx)("div",{className:"rounded-lg p-2 w-64 flex-shrink-0",children:(0,r.jsx)("div",{className:"relative",style:{height:"400px"},children:N.map((e,t)=>(0,r.jsx)("div",{className:"absolute text-sm font-medium text-gray-700 truncate flex items-center",style:{top:10+58*t,height:50,width:"100%"},children:e.name},e.id))})}),(0,r.jsx)("div",{className:"rounded-lg p-2 flex-1 ml-2 min-w-0",children:(0,r.jsx)("div",{ref:m,onScroll:e=>{c.current&&!x.current&&(x.current=!0,c.current.scrollLeft=e.currentTarget.scrollLeft,setTimeout(()=>{x.current=!1},10))},className:"overflow-x-auto overflow-y-auto scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-200",style:{height:"400px"},children:(0,r.jsxs)("div",{style:{width:f,position:"relative"},children:[v>0&&v<f&&(0,r.jsx)("div",{className:"absolute z-10 w-0.5 bg-red-500",style:{left:v,top:0,height:"".concat(58*t.length+10,"px")},children:(0,r.jsx)("div",{className:"bg-red-500 text-white text-xs px-1 py-0.5 rounded -mt-2 -ml-6 whitespace-nowrap",children:"HOY 500"})}),N.map((e,t)=>(0,r.jsx)("div",{className:"absolute",style:{left:e.leftPx,top:10+58*t,width:e.widthPx,height:46},children:(0,r.jsx)("div",{className:"relative rounded flex items-center px-2 text-white text-xs font-medium h-full",style:{backgroundColor:e.progressColor},children:e.milestones.map(t=>(0,r.jsx)("div",{className:"absolute top-1/2 transform -translate-y-1/2 bg-white border-2 border-blue-600 rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold text-blue-600 shadow-sm z-10",style:{left:t.leftPx-e.leftPx},title:"Hito ".concat(t.number,": ").concat(t.name),children:t.number},t.id))})},e.id))]})})})]})]})})}),(0,r.jsxs)("div",{className:"mt-4 text-xs text-gray-500 flex justify-between",children:[(0,r.jsxs)("span",{children:["Inicio: ",new Date(h.start).toLocaleDateString("es")]}),(0,r.jsxs)("span",{children:["Fin: ",new Date(h.end).toLocaleDateString("es")]})]})]})},y=()=>{const e=t.reduce((e,t)=>e+t.budget,0),s=t.reduce((e,t)=>e+t.contingencyReserve,0)+t.reduce((e,t)=>e+t.managementReserve,0);return(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"\ud83d\udcb0 M\xe9tricas Financieras Consolidadas"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,r.jsxs)("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[(0,r.jsxs)("div",{className:"text-2xl font-bold text-blue-600",children:["$",(e/1e3).toFixed(0),"K"]}),(0,r.jsx)("div",{className:"text-sm text-blue-600",children:"Presupuesto Total"})]}),(0,r.jsxs)("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[(0,r.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:["$",(s/1e3).toFixed(0),"K"]}),(0,r.jsx)("div",{className:"text-sm text-green-600",children:"Reservas Totales"})]})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("div",{className:"flex items-center justify-between",children:(0,r.jsx)("span",{className:"text-sm font-medium",children:"Distribuci\xf3n del Presupuesto:"})}),t.map((t,s)=>{const a=t.budget/e*100;return(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"w-24 text-sm text-gray-600 truncate",children:t.name}),(0,r.jsx)("div",{className:"flex-1 mx-3",children:(0,r.jsx)("div",{className:"bg-gray-200 rounded-full h-4 relative",children:(0,r.jsxs)("div",{className:"h-4 bg-blue-500 rounded-full flex items-center justify-end pr-2 text-white text-xs",style:{width:"".concat(a,"%"),minWidth:"40px"},children:[a.toFixed(1),"%"]})})}),(0,r.jsxs)("div",{className:"w-16 text-sm text-gray-600 text-right",children:["$",(t.budget/1e3).toFixed(0),"K"]})]},t.id)})]})]})};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[x.length>0&&(0,r.jsx)(b,{data:x,title:"\ud83d\udcca Distribuci\xf3n por Estado"}),h.length>0&&(0,r.jsx)(b,{data:h,title:"\u26a1 Distribuci\xf3n por Prioridad"})]}),g.length>0&&(0,r.jsx)(j,{data:g,title:"\ud83d\udcb0 Presupuesto por Proyecto (K$)",valueKey:"budget",colorKey:"color"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[p.length>0&&(0,r.jsx)(b,{data:p,title:"\ud83d\udccb Estado de Work Packages"}),v.length>0&&(0,r.jsx)(b,{data:v,title:"\u26a0\ufe0f Estado de Riesgos"})]}),f.length>0&&(0,r.jsx)(j,{data:f,title:"\ud83c\udfaf Prioridad de Riesgos",valueKey:"count"}),(0,r.jsx)(w,{}),(0,r.jsx)(y,{})]})}},4634:(e,t,s)=>{s.d(t,{A:()=>l});s(9950);var a=s(4414);const l=e=>{let{projects:t,portfolioMetrics:s={}}=e;const l=t.filter(e=>{const t=new Date(e.endDate)<new Date&&"completed"!==e.status,s="high"===e.priority;return t||s&&"active"===e.status}),r=t.filter(e=>!(null===s||void 0===s||!s.totalBudget||s.totalBudget<=0)&&e.budget>.3*s.totalBudget),n=t.filter(e=>{const t=(new Date(e.endDate)-new Date)/864e5;return t>0&&t<=30&&"active"===e.status}),i=[];l.length>0&&i.push({type:"critical",title:"Proyectos Cr\xedticos",message:"".concat(l.length," proyecto(s) requieren atenci\xf3n inmediata"),details:l.map(e=>e.name),icon:"\ud83d\udea8",color:"red"}),r.length>0&&i.push({type:"budget",title:"Concentraci\xf3n de Presupuesto",message:"".concat(r.length," proyecto(s) concentran >30% del presupuesto total"),details:r.map(e=>"".concat(e.name,": $").concat((e.budget/1e3).toFixed(0),"K")),icon:"\ud83d\udcb0",color:"yellow"}),n.length>0&&i.push({type:"deadline",title:"Deadlines Pr\xf3ximos",message:"".concat(n.length," proyecto(s) terminan en los pr\xf3ximos 30 d\xedas"),details:n.map(e=>{const t=Math.ceil((new Date(e.endDate)-new Date)/864e5);return"".concat(e.name,": ").concat(t," d\xedas")}),icon:"\u23f0",color:"blue"}),(null===s||void 0===s?void 0:s.activeProjects)>5&&i.push({type:"capacity",title:"Alta Carga de Proyectos",message:"".concat(s.activeProjects," proyectos activos pueden sobrecargar recursos"),details:["Considerar priorizaci\xf3n de proyectos","Evaluar capacidad de recursos"],icon:"\u26a1",color:"purple"}),(null===s||void 0===s?void 0:s.completedProjects)>0&&0===l.length&&i.push({type:"success",title:"Portfolio Saludable",message:"".concat(s.completedProjects," proyecto(s) completado(s) sin alertas cr\xedticas"),details:["Excelente gesti\xf3n del portfolio","Continuar con las mejores pr\xe1cticas"],icon:"\u2705",color:"green"});const c=e=>{switch(e){case"red":return"bg-red-50 border-red-500 text-red-700";case"yellow":return"bg-yellow-50 border-yellow-500 text-yellow-700";case"blue":return"bg-blue-50 border-blue-500 text-blue-700";case"purple":return"bg-purple-50 border-purple-500 text-purple-700";case"green":return"bg-green-50 border-green-500 text-green-700";default:return"bg-gray-50 border-gray-500 text-gray-700"}},o=e=>{switch(e){case"red":return"text-red-500";case"yellow":return"text-yellow-500";case"blue":return"text-blue-500";case"purple":return"text-purple-500";case"green":return"text-green-500";default:return"text-gray-500"}};return 0===i.length?(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"\ud83d\udd14 Alertas Corporativas"}),(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,a.jsx)("div",{className:"text-4xl mb-2",children:"\u2705"}),(0,a.jsx)("div",{children:"No hay alertas activas"}),(0,a.jsx)("div",{className:"text-sm mt-1",children:"El portfolio est\xe1 funcionando correctamente"})]})]}):(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:["\ud83d\udd14 Alertas Corporativas",(0,a.jsx)("span",{className:"ml-2 bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:i.filter(e=>"critical"===e.type).length})]}),(0,a.jsx)("div",{className:"space-y-4",children:i.map((e,t)=>(0,a.jsx)("div",{className:"border-l-4 p-4 rounded-lg ".concat(c(e.color)),children:(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)("span",{className:"text-xl mr-3 ".concat(o(e.color)),children:e.icon}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"font-semibold mb-1",children:e.title}),(0,a.jsx)("div",{className:"text-sm mb-2",children:e.message}),e.details&&e.details.length>0&&(0,a.jsx)("div",{className:"text-xs space-y-1",children:e.details.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"w-2 h-2 bg-current rounded-full mr-2 opacity-50"}),e]},t))})]})]})},t))}),(0,a.jsx)("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"font-medium text-gray-700",children:"Resumen de Alertas:"}),(0,a.jsxs)("div",{className:"flex space-x-4",children:[(0,a.jsxs)("span",{className:"text-red-600",children:["\ud83d\udea8 ",i.filter(e=>"critical"===e.type).length," Cr\xedticas"]}),(0,a.jsxs)("span",{className:"text-yellow-600",children:["\u26a0\ufe0f ",i.filter(e=>"yellow"===e.color).length," Advertencias"]}),(0,a.jsxs)("span",{className:"text-blue-600",children:["\u2139\ufe0f ",i.filter(e=>"blue"===e.color).length," Informativas"]})]})]})})]})}}}]);