{"version":3,"file":"static/js/218.058c8daf.chunk.js","mappings":"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","sources":["constants/unifiedRoles.js","components/subscription/UpgradeModal.js","constants/roles.js","hooks/useOrganizationId.js","hooks/useRoleMapping.js","hooks/useCurrentUserPermissions.js","hooks/useInviteModal.js","utils/config.js","components/InvitationModal.jsx","components/OrganizationMembers.js","hooks/useAuditLog.js"],"sourcesContent":["/**\n * SISTEMA UNIFICADO DE ROLES\n * Define roles organizacionales, funcionales y permisos para control de cambios\n * NO hardcodea datos, solo define la estructura de permisos\n */\n\n// Roles organizacionales (en organization_members.role)\nexport const ORG_ROLES = {\n  OWNER: 'owner',\n  ADMIN: 'admin',\n  MEMBER_WRITE: 'organization_member_write',\n  MEMBER_READ: 'organization_member_read'\n};\n\n// Roles funcionales (en organization_members.functional_role)\nexport const FUNCTIONAL_ROLES = {\n  // Roles de gesti√≥n\n  EXECUTIVE: 'executive',\n  SPONSOR: 'sponsor',\n  PROJECT_MANAGER: 'project_manager',\n  \n  // Roles especializados\n  FINANCE_MANAGER: 'finance_manager',\n  QUALITY_MANAGER: 'quality_manager',\n  TECHNICAL_LEAD: 'technical_lead',\n  \n  // Roles operativos\n  PMO_ASSISTANT: 'pmo_assistant',\n  PROJECT_COORDINATOR: 'project_coordinator',\n  TEAM_MEMBER: 'team_member',\n  \n  // Roles de supervisi√≥n\n  AUDITOR: 'auditor'\n};\n\n// Labels y metadata de roles funcionales\nexport const FUNCTIONAL_ROLE_LABELS = {\n  [FUNCTIONAL_ROLES.EXECUTIVE]: {\n    label: 'Ejecutivo',\n    description: 'Toma decisiones estrat√©gicas y aprueba cambios cr√≠ticos',\n    icon: 'üëî',\n    color: 'purple',\n    badge: 'bg-purple-100 text-purple-800'\n  },\n  [FUNCTIONAL_ROLES.SPONSOR]: {\n    label: 'Patrocinador',\n    description: 'Aprueba cambios mayores del proyecto',\n    icon: 'üéØ',\n    color: 'blue',\n    badge: 'bg-blue-100 text-blue-800'\n  },\n  [FUNCTIONAL_ROLES.PROJECT_MANAGER]: {\n    label: 'Project Manager',\n    description: 'Gestiona proyectos y aprueba cambios menores',\n    icon: 'üìä',\n    color: 'indigo',\n    badge: 'bg-indigo-100 text-indigo-800'\n  },\n  [FUNCTIONAL_ROLES.FINANCE_MANAGER]: {\n    label: 'Gerente Financiero',\n    description: 'Aprueba impacto financiero de cambios',\n    icon: 'üí∞',\n    color: 'green',\n    badge: 'bg-green-100 text-green-800'\n  },\n  [FUNCTIONAL_ROLES.QUALITY_MANAGER]: {\n    label: 'Gerente de Calidad',\n    description: 'Valida impacto en calidad',\n    icon: '‚≠ê',\n    color: 'yellow',\n    badge: 'bg-yellow-100 text-yellow-800'\n  },\n  [FUNCTIONAL_ROLES.TECHNICAL_LEAD]: {\n    label: 'L√≠der T√©cnico',\n    description: 'Realiza an√°lisis t√©cnico de cambios',\n    icon: 'üîß',\n    color: 'cyan',\n    badge: 'bg-cyan-100 text-cyan-800'\n  },\n  [FUNCTIONAL_ROLES.PMO_ASSISTANT]: {\n    label: 'Asistente PMO',\n    description: 'Soporte operativo y seguimiento',\n    icon: 'üìã',\n    color: 'teal',\n    badge: 'bg-teal-100 text-teal-800'\n  },\n  [FUNCTIONAL_ROLES.PROJECT_COORDINATOR]: {\n    label: 'Coordinador de Proyectos',\n    description: 'Coordina tareas y actividades',\n    icon: 'üìÖ',\n    color: 'orange',\n    badge: 'bg-orange-100 text-orange-800'\n  },\n  [FUNCTIONAL_ROLES.TEAM_MEMBER]: {\n    label: 'Miembro de Equipo',\n    description: 'Participa en el proyecto y solicita cambios',\n    icon: 'üë§',\n    color: 'gray',\n    badge: 'bg-gray-100 text-gray-800'\n  },\n  [FUNCTIONAL_ROLES.AUDITOR]: {\n    label: 'Auditor',\n    description: 'Solo lectura para auditor√≠a',\n    icon: 'üîç',\n    color: 'slate',\n    badge: 'bg-slate-100 text-slate-800'\n  }\n};\n\n// Matriz de permisos para control de cambios\n// Define QU√â puede hacer cada rol, NO asigna roles a usuarios\nexport const CHANGE_PERMISSIONS_MATRIX = {\n  // OWNER tiene acceso completo\n  [ORG_ROLES.OWNER]: {\n    canCreate: true,\n    canApprove: true,\n    canReject: true,\n    canImplement: true,\n    canVoteInCCB: true,\n    canAssign: true,\n    canComment: true,\n    canViewAll: true,\n    approvalLimit: { cost: Infinity, schedule: Infinity },\n    changeRole: 'executive_board',\n    level: 'unlimited'\n  },\n  \n  // ADMIN tiene acceso completo\n  [ORG_ROLES.ADMIN]: {\n    canCreate: true,\n    canApprove: true,\n    canReject: true,\n    canImplement: true,\n    canVoteInCCB: true,\n    canAssign: true,\n    canComment: true,\n    canViewAll: true,\n    approvalLimit: { cost: Infinity, schedule: Infinity },\n    changeRole: 'executive_board',\n    level: 'unlimited'\n  },\n  \n  // MEMBER_WRITE depende de functional_role\n  [ORG_ROLES.MEMBER_WRITE]: {\n    // Default (sin functional_role espec√≠fico)\n    default: {\n      canCreate: true,\n      canApprove: false,\n      canReject: false,\n      canImplement: true,\n      canVoteInCCB: false,\n      canAssign: false,\n      canComment: true,\n      canViewAll: false,\n      approvalLimit: { cost: 0, schedule: 0 },\n      changeRole: 'team_member',\n      level: 'basic'\n    },\n    \n    // Permisos espec√≠ficos por functional_role\n    [FUNCTIONAL_ROLES.EXECUTIVE]: {\n      canCreate: true,\n      canApprove: true,\n      canReject: true,\n      canImplement: false,\n      canVoteInCCB: true,\n      canAssign: true,\n      canComment: true,\n      canViewAll: true,\n      approvalLimit: { cost: Infinity, schedule: Infinity },\n      changeRole: 'executive_board',\n      level: 'executive'\n    },\n    \n    [FUNCTIONAL_ROLES.SPONSOR]: {\n      canCreate: true,\n      canApprove: true,\n      canReject: true,\n      canImplement: false,\n      canVoteInCCB: true,\n      canAssign: true,\n      canComment: true,\n      canViewAll: true,\n      approvalLimit: { cost: 100000, schedule: 30 },\n      changeRole: 'sponsor',\n      level: 'high'\n    },\n    \n    [FUNCTIONAL_ROLES.PROJECT_MANAGER]: {\n      canCreate: true,\n      canApprove: true,\n      canReject: true,\n      canImplement: true,\n      canVoteInCCB: true,\n      canAssign: true,\n      canComment: true,\n      canViewAll: true,\n      approvalLimit: { cost: 25000, schedule: 15 },\n      changeRole: 'project_manager',\n      level: 'medium'\n    },\n    \n    [FUNCTIONAL_ROLES.FINANCE_MANAGER]: {\n      canCreate: true,\n      canApprove: true,\n      canReject: true,\n      canImplement: false,\n      canVoteInCCB: true,\n      canAssign: false,\n      canComment: true,\n      canViewAll: true,\n      approvalLimit: { cost: 100000, schedule: 0 },\n      changeRole: 'finance_manager',\n      level: 'specialized'\n    },\n    \n    [FUNCTIONAL_ROLES.QUALITY_MANAGER]: {\n      canCreate: true,\n      canApprove: true,\n      canReject: true,\n      canImplement: false,\n      canVoteInCCB: true,\n      canAssign: false,\n      canComment: true,\n      canViewAll: true,\n      approvalLimit: { cost: 0, schedule: 0 },\n      changeRole: 'quality_manager',\n      level: 'specialized'\n    },\n    \n    [FUNCTIONAL_ROLES.TECHNICAL_LEAD]: {\n      canCreate: true,\n      canApprove: false,\n      canReject: false,\n      canImplement: true,\n      canVoteInCCB: true,\n      canAssign: false,\n      canComment: true,\n      canViewAll: false,\n      approvalLimit: { cost: 0, schedule: 0 },\n      changeRole: 'technical_lead',\n      level: 'technical'\n    },\n    \n    [FUNCTIONAL_ROLES.PMO_ASSISTANT]: {\n      canCreate: true,\n      canApprove: false,\n      canReject: false,\n      canImplement: true,\n      canVoteInCCB: false,\n      canAssign: false,\n      canComment: true,\n      canViewAll: false,\n      approvalLimit: { cost: 0, schedule: 0 },\n      changeRole: 'pmo_assistant',\n      level: 'operational'\n    },\n    \n    [FUNCTIONAL_ROLES.PROJECT_COORDINATOR]: {\n      canCreate: true,\n      canApprove: false,\n      canReject: false,\n      canImplement: true,\n      canVoteInCCB: false,\n      canAssign: false,\n      canComment: true,\n      canViewAll: false,\n      approvalLimit: { cost: 0, schedule: 0 },\n      changeRole: 'project_coordinator',\n      level: 'operational'\n    },\n    \n    [FUNCTIONAL_ROLES.TEAM_MEMBER]: {\n      canCreate: true,\n      canApprove: false,\n      canReject: false,\n      canImplement: false,\n      canVoteInCCB: false,\n      canAssign: false,\n      canComment: true,\n      canViewAll: false,\n      approvalLimit: { cost: 0, schedule: 0 },\n      changeRole: 'team_member',\n      level: 'basic'\n    }\n  },\n  \n  // MEMBER_READ tiene permisos limitados\n  [ORG_ROLES.MEMBER_READ]: {\n    default: {\n      canCreate: true, // Puede solicitar cambios\n      canApprove: false,\n      canReject: false,\n      canImplement: false,\n      canVoteInCCB: false,\n      canAssign: false,\n      canComment: true,\n      canViewAll: false,\n      approvalLimit: { cost: 0, schedule: 0 },\n      changeRole: 'observer',\n      level: 'readonly'\n    },\n    \n    [FUNCTIONAL_ROLES.AUDITOR]: {\n      canCreate: false,\n      canApprove: false,\n      canReject: false,\n      canImplement: false,\n      canVoteInCCB: false,\n      canAssign: false,\n      canComment: true,\n      canViewAll: true,\n      approvalLimit: { cost: 0, schedule: 0 },\n      changeRole: 'auditor',\n      level: 'audit'\n    }\n  }\n};\n\n/**\n * Obtiene los permisos de control de cambios para un usuario\n * @param {string} orgRole - Rol organizacional (owner, admin, organization_member_write, organization_member_read)\n * @param {string|null} functionalRole - Rol funcional opcional\n * @returns {Object} Objeto con permisos\n */\nexport const getUserChangePermissions = (orgRole, functionalRole = null) => {\n  // Si no hay rol organizacional, denegar todo\n  if (!orgRole) {\n    return {\n      canCreate: false,\n      canApprove: false,\n      canReject: false,\n      canImplement: false,\n      canVoteInCCB: false,\n      canAssign: false,\n      canComment: false,\n      canViewAll: false,\n      approvalLimit: { cost: 0, schedule: 0 },\n      changeRole: 'none',\n      level: 'none'\n    };\n  }\n  \n  const basePermissions = CHANGE_PERMISSIONS_MATRIX[orgRole];\n  \n  if (!basePermissions) {\n    return CHANGE_PERMISSIONS_MATRIX[ORG_ROLES.MEMBER_READ].default;\n  }\n  \n  // Si es OWNER o ADMIN, retornar permisos directos\n  if (orgRole === ORG_ROLES.OWNER || orgRole === ORG_ROLES.ADMIN) {\n    return basePermissions;\n  }\n  \n  // Si tiene functional_role, buscar permisos espec√≠ficos\n  if (functionalRole && basePermissions[functionalRole]) {\n    return basePermissions[functionalRole];\n  }\n  \n  // Si no tiene functional_role, usar default\n  return basePermissions.default || basePermissions;\n};\n\n/**\n * Verifica si un usuario puede aprobar un cambio espec√≠fico\n * @param {Object} permissions - Permisos del usuario\n * @param {number} costImpact - Impacto en costo del cambio\n * @param {number} scheduleImpact - Impacto en cronograma del cambio\n * @returns {boolean} true si puede aprobar\n */\nexport const canApproveChange = (permissions, costImpact, scheduleImpact) => {\n  if (!permissions.canApprove) return false;\n  \n  const cost = parseFloat(costImpact) || 0;\n  const schedule = parseFloat(scheduleImpact) || 0;\n  \n  const withinCostLimit = cost <= permissions.approvalLimit.cost;\n  const withinScheduleLimit = schedule <= permissions.approvalLimit.schedule;\n  \n  return withinCostLimit && withinScheduleLimit;\n};\n\n/**\n * Obtiene el label de un rol funcional\n * @param {string} functionalRole - Rol funcional\n * @returns {string} Label amigable\n */\nexport const getFunctionalRoleLabel = (functionalRole) => {\n  if (!functionalRole) return 'Sin rol espec√≠fico';\n  return FUNCTIONAL_ROLE_LABELS[functionalRole]?.label || functionalRole;\n};\n\n/**\n * Obtiene metadata completa de un rol funcional\n * @param {string} functionalRole - Rol funcional\n * @returns {Object|null} Metadata del rol\n */\nexport const getFunctionalRoleMetadata = (functionalRole) => {\n  if (!functionalRole) return null;\n  return FUNCTIONAL_ROLE_LABELS[functionalRole] || null;\n};\n\nconst unifiedRoles = {\n  ORG_ROLES,\n  FUNCTIONAL_ROLES,\n  FUNCTIONAL_ROLE_LABELS,\n  CHANGE_PERMISSIONS_MATRIX,\n  getUserChangePermissions,\n  canApproveChange,\n  getFunctionalRoleLabel,\n  getFunctionalRoleMetadata\n};\n\nexport default unifiedRoles;\n","import React, { useState } from 'react';\nimport './UpgradeModal.css';\nimport subscriptionService from '../../services/SubscriptionService';\nimport { createClient } from '@supabase/supabase-js';\n\n// Inicializar Supabase client\nconst supabaseUrl = process.env.REACT_APP_SUPABASE_URL;\nconst supabaseAnonKey = process.env.REACT_APP_SUPABASE_ANON_KEY;\nconst supabase = supabaseUrl && supabaseAnonKey ? createClient(supabaseUrl, supabaseAnonKey) : null;\n\n// IMPORTANTE: Este es tu Price ID de Stripe\n// Debes reemplazarlo con el real despu√©s de crear el producto en Stripe Dashboard\nconst STRIPE_PRICE_ID = process.env.REACT_APP_STRIPE_PRICE_ID || 'price_XXXXXX';\n\nconst UpgradeModal = ({\n  isOpen,\n  onClose,\n  limitType = 'project', // 'project' or 'user'\n  currentPlan = 'free',\n  currentCount = 0,\n  maxCount = 0,\n  organizationId = null,\n  onUpgradeSuccess = null\n}) => {\n  const [isUpgrading, setIsUpgrading] = useState(false);\n  const [paymentMode, setPaymentMode] = useState('stripe'); // 'stripe' or 'simulation'\n\n  if (!isOpen) return null;\n\n  const messages = {\n    project: {\n      title: '¬°Alcanzaste el l√≠mite de proyectos!',\n      current: `Tienes ${currentCount} de ${maxCount} proyectos`,\n      benefit: 'Proyectos ilimitados'\n    },\n    user: {\n      title: '¬°Alcanzaste el l√≠mite de usuarios!',\n      current: `Tienes ${currentCount} de ${maxCount} usuarios`,\n      benefit: 'Usuarios ilimitados'\n    }\n  };\n\n  const message = messages[limitType] || messages.project;\n\n  // Funci√≥n para crear sesi√≥n de Stripe Checkout\n  const handleStripeCheckout = async () => {\n    if (!organizationId) {\n      alert('‚ùå Error: No se pudo identificar la organizaci√≥n. Intenta recargar la p√°gina.');\n      return;\n    }\n\n    if (!supabase) {\n      alert('‚ùå Error: Supabase no est√° configurado correctamente.');\n      return;\n    }\n\n    setIsUpgrading(true);\n\n    try {\n      // Obtener el usuario actual de Supabase\n      const { data: { user } } = await supabase.auth.getUser();\n      const userEmail = user?.email || 'noemail@example.com';\n\n      // Obtener informaci√≥n de la organizaci√≥n desde localStorage\n      const portfolioData = localStorage.getItem('strategiapm_portfolio_data');\n      let organizationName = 'Organization';\n\n      if (portfolioData) {\n        const portfolio = JSON.parse(portfolioData);\n        organizationName = portfolio?.organization?.name || organizationName;\n      }\n\n      console.log('[UpgradeModal] Creando sesi√≥n de checkout para:', {\n        organizationId,\n        organizationName,\n        userEmail\n      });\n\n      // Llamar a la Edge Function para crear sesi√≥n de checkout\n      const { data, error } = await supabase.functions.invoke('create-checkout-session', {\n        body: {\n          organizationId,\n          organizationName,\n          userEmail,\n          priceId: STRIPE_PRICE_ID,\n          plan: 'professional'\n        }\n      });\n\n      if (error) {\n        throw new Error(error.message || 'Error al crear sesi√≥n de checkout');\n      }\n\n      if (!data || !data.url) {\n        throw new Error('No se recibi√≥ URL de checkout de Stripe');\n      }\n\n      console.log('[UpgradeModal] Sesi√≥n creada, redirigiendo a Stripe...');\n\n      // Redirigir a Stripe Checkout\n      window.location.href = data.url;\n\n    } catch (error) {\n      console.error('[UpgradeModal] Error en checkout:', error);\n      alert(`‚ùå Error al procesar el pago: ${error.message}\\n\\nPor favor intenta de nuevo o contacta con soporte.`);\n      setIsUpgrading(false);\n    }\n  };\n\n  // Funci√≥n para simulaci√≥n (desarrollo/testing)\n  const handleSimulatedUpgrade = async () => {\n    if (!organizationId) {\n      alert('‚ùå Error: No se pudo identificar la organizaci√≥n. Intenta recargar la p√°gina.');\n      return;\n    }\n\n    // Confirmar con el usuario\n    const confirmMessage = '‚ö†Ô∏è MODO SIMULACI√ìN (Solo para desarrollo)\\n\\n¬øConfirmas que deseas actualizar al Plan Professional?\\n\\nüìä Beneficios:\\n‚Ä¢ Proyectos ilimitados\\n‚Ä¢ Usuarios ilimitados\\n‚Ä¢ Soporte prioritario\\n‚Ä¢ Reportes avanzados\\n\\nNOTA: Esto es una simulaci√≥n SIN PAGO REAL.\\n\\n¬øContinuar?';\n\n    if (!window.confirm(confirmMessage)) {\n      return;\n    }\n\n    setIsUpgrading(true);\n\n    try {\n      // Obtener el usuario actual desde localStorage\n      const portfolioData = localStorage.getItem('strategiapm_portfolio_data');\n      let userId = null;\n\n      if (portfolioData) {\n        const portfolio = JSON.parse(portfolioData);\n        userId = portfolio?.user?.id;\n      }\n\n      // Cambiar plan usando el servicio\n      const result = await subscriptionService.changePlan(organizationId, 'professional', userId);\n\n      if (result.success) {\n        alert('‚úÖ ¬°Plan actualizado exitosamente a Professional!\\n\\nBeneficios activados:\\n‚Ä¢ Proyectos ilimitados ‚úì\\n‚Ä¢ Usuarios ilimitados ‚úì\\n‚Ä¢ Soporte prioritario ‚úì\\n\\nüîÑ Recarga la p√°gina para ver los cambios reflejados.');\n\n        // Llamar callback si existe\n        if (onUpgradeSuccess) {\n          onUpgradeSuccess();\n        }\n\n        // Cerrar modal\n        onClose();\n\n        // Recargar la p√°gina despu√©s de 2 segundos\n        setTimeout(() => {\n          window.location.reload();\n        }, 2000);\n      } else {\n        throw new Error(result.error || 'Error desconocido');\n      }\n    } catch (error) {\n      console.error('Error actualizando plan:', error);\n      alert(`‚ùå Error al actualizar el plan: ${error.message}\\n\\nPor favor intenta de nuevo o contacta con soporte.`);\n    } finally {\n      setIsUpgrading(false);\n    }\n  };\n\n  // Funci√≥n principal que decide qu√© m√©todo usar\n  const handleUpgrade = () => {\n    if (paymentMode === 'stripe') {\n      handleStripeCheckout();\n    } else {\n      handleSimulatedUpgrade();\n    }\n  };\n\n  return (\n    <div className=\"upgrade-modal-overlay\" onClick={onClose}>\n      <div className=\"upgrade-modal-content\" onClick={(e) => e.stopPropagation()}>\n        <button className=\"upgrade-modal-close\" onClick={onClose}>√ó</button>\n\n        <div className=\"upgrade-modal-icon\">\n          <svg width=\"64\" height=\"64\" viewBox=\"0 0 64 64\" fill=\"none\">\n            <circle cx=\"32\" cy=\"32\" r=\"30\" fill=\"#FEF3C7\" />\n            <path d=\"M32 16L38 28H26L32 16Z\" fill=\"#F59E0B\" />\n            <circle cx=\"32\" cy=\"36\" r=\"2\" fill=\"#F59E0B\" />\n            <rect x=\"30\" y=\"42\" width=\"4\" height=\"8\" rx=\"2\" fill=\"#F59E0B\" />\n          </svg>\n        </div>\n\n        <h2 className=\"upgrade-modal-title\">{message.title}</h2>\n        <p className=\"upgrade-modal-subtitle\">{message.current}</p>\n\n        <div className=\"upgrade-plans-comparison\">\n          {/* Plan Actual */}\n          <div className=\"upgrade-plan-card upgrade-plan-current\">\n            <div className=\"upgrade-plan-header\">\n              <h3>Plan Free</h3>\n              <span className=\"upgrade-plan-badge\">Plan Actual</span>\n            </div>\n            <div className=\"upgrade-plan-price\">$0<span>/mes</span></div>\n            <ul className=\"upgrade-plan-features\">\n              <li className=\"upgrade-feature-limited\">\n                <span className=\"upgrade-feature-icon\">üìä</span>\n                <span>1 proyecto</span>\n              </li>\n              <li className=\"upgrade-feature-limited\">\n                <span className=\"upgrade-feature-icon\">üë•</span>\n                <span>3 usuarios</span>\n              </li>\n              <li className=\"upgrade-feature-included\">\n                <span className=\"upgrade-feature-icon\">‚úì</span>\n                <span>Todas las funciones b√°sicas</span>\n              </li>\n            </ul>\n          </div>\n\n          {/* Plan Professional */}\n          <div className=\"upgrade-plan-card upgrade-plan-recommended\">\n            <div className=\"upgrade-plan-header\">\n              <h3>Plan Professional</h3>\n              <span className=\"upgrade-plan-badge upgrade-plan-badge-pro\">Recomendado</span>\n            </div>\n            <div className=\"upgrade-plan-price\">$39<span>/mes</span></div>\n            <ul className=\"upgrade-plan-features\">\n              <li className=\"upgrade-feature-included\">\n                <span className=\"upgrade-feature-icon\">‚úì</span>\n                <span><strong>Proyectos ilimitados</strong></span>\n              </li>\n              <li className=\"upgrade-feature-included\">\n                <span className=\"upgrade-feature-icon\">‚úì</span>\n                <span><strong>Usuarios ilimitados</strong></span>\n              </li>\n              <li className=\"upgrade-feature-included\">\n                <span className=\"upgrade-feature-icon\">‚úì</span>\n                <span>Soporte prioritario</span>\n              </li>\n              <li className=\"upgrade-feature-included\">\n                <span className=\"upgrade-feature-icon\">‚úì</span>\n                <span>Reportes avanzados</span>\n              </li>\n            </ul>\n            <button\n              className=\"upgrade-btn-primary\"\n              onClick={handleUpgrade}\n              disabled={isUpgrading}\n            >\n              {isUpgrading\n                ? (paymentMode === 'stripe' ? 'Procesando...' : 'Actualizando...')\n                : (paymentMode === 'stripe' ? 'Ir a Checkout de Stripe' : 'Actualizar a Professional (Simulaci√≥n)')\n              }\n            </button>\n          </div>\n        </div>\n\n        {/* Toggle para modo de pago (solo visible en desarrollo) */}\n        {process.env.NODE_ENV === 'development' && (\n          <div style={{\n            marginTop: '20px',\n            padding: '12px',\n            backgroundColor: '#f3f4f6',\n            borderRadius: '8px',\n            border: '1px dashed #9ca3af'\n          }}>\n            <label style={{\n              display: 'flex',\n              alignItems: 'center',\n              gap: '10px',\n              fontSize: '14px',\n              color: '#4b5563',\n              cursor: 'pointer'\n            }}>\n              <input\n                type=\"checkbox\"\n                checked={paymentMode === 'simulation'}\n                onChange={(e) => setPaymentMode(e.target.checked ? 'simulation' : 'stripe')}\n                style={{ width: '16px', height: '16px' }}\n              />\n              <span>\n                {paymentMode === 'stripe'\n                  ? 'üí≥ Modo: Stripe (Pago real)'\n                  : '‚ö†Ô∏è Modo: Simulaci√≥n (Sin pago)'\n                }\n              </span>\n            </label>\n          </div>\n        )}\n\n        <p className=\"upgrade-modal-footer\">\n          ¬øPreguntas? <a href=\"mailto:soporte@strategiapm.com\">Contacta con soporte</a>\n        </p>\n\n        <button className=\"upgrade-btn-secondary\" onClick={onClose}>\n          Ahora no\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default UpgradeModal;\n","/**\n * Sistema de constantes de roles para StrategiaPM\n * Centraliza la definici√≥n de roles y sus etiquetas\n * \n * @version 1.0.0\n * @created 2025-01-27\n */\n\n// ==========================================\n// ROLES PRINCIPALES\n// ==========================================\nexport const ROLES = {\n  OWNER: 'owner',\n  ADMIN: 'admin',\n  MEMBER_WRITE: 'member_write',\n  MEMBER_READ: 'member_read'\n};\n\n// ==========================================\n// ETIQUETAS DE ROLES (Para UI)\n// ==========================================\nexport const ROLE_LABELS = {\n  [ROLES.OWNER]: 'üëë Propietario',\n  [ROLES.ADMIN]: 'üëë Administrador',\n  [ROLES.MEMBER_WRITE]: '‚úèÔ∏è Miembro (Editar)',\n  [ROLES.MEMBER_READ]: 'üëÄ Miembro (Solo lectura)'\n};\n\n// ==========================================\n// DESCRIPCIONES DE ROLES\n// ==========================================\nexport const ROLE_DESCRIPTIONS = {\n  [ROLES.OWNER]: 'Control total de la organizaci√≥n, puede gestionar miembros y proyectos',\n  [ROLES.ADMIN]: 'Puede gestionar usuarios y proyectos de la organizaci√≥n',\n  [ROLES.MEMBER_WRITE]: 'Puede crear, editar y eliminar proyectos de la organizaci√≥n',\n  [ROLES.MEMBER_READ]: 'Solo puede ver proyectos de la organizaci√≥n'\n};\n\n// ==========================================\n// PERMISOS POR ROL\n// ==========================================\nexport const ROLE_PERMISSIONS = {\n  [ROLES.OWNER]: {\n    canInvite: true,\n    canEditRoles: true,\n    canRemoveMembers: true,\n    canEditProjects: true,\n    canDeleteProjects: true,\n    canViewAll: true\n  },\n  [ROLES.ADMIN]: {\n    canInvite: true,\n    canEditRoles: true,\n    canRemoveMembers: false, // No puede eliminar owners\n    canEditProjects: true,\n    canDeleteProjects: true,\n    canViewAll: true\n  },\n  [ROLES.MEMBER_WRITE]: {\n    canInvite: false,\n    canEditRoles: false,\n    canRemoveMembers: false,\n    canEditProjects: true,\n    canDeleteProjects: false,\n    canViewAll: true\n  },\n  [ROLES.MEMBER_READ]: {\n    canInvite: false,\n    canEditRoles: false,\n    canRemoveMembers: false,\n    canEditProjects: false,\n    canDeleteProjects: false,\n    canViewAll: true\n  }\n};\n\n// ==========================================\n// MAPEO DE ROLES LEGACY (Para migraci√≥n)\n// ==========================================\nexport const LEGACY_ROLE_MAPPING = {\n  'organization_owner': ROLES.OWNER,\n  'organization_member_write': ROLES.MEMBER_WRITE,\n  'organization_member_read': ROLES.MEMBER_READ,\n  'admin': ROLES.ADMIN,\n  'owner': ROLES.OWNER,\n  'member': ROLES.MEMBER_WRITE\n};\n\n// ==========================================\n// OPCIONES PARA FORMULARIOS\n// ==========================================\nexport const ROLE_OPTIONS = [\n  { \n    value: ROLES.OWNER, \n    label: ROLE_LABELS[ROLES.OWNER],\n    description: ROLE_DESCRIPTIONS[ROLES.OWNER]\n  },\n  { \n    value: ROLES.ADMIN, \n    label: ROLE_LABELS[ROLES.ADMIN],\n    description: ROLE_DESCRIPTIONS[ROLES.ADMIN]\n  },\n  { \n    value: ROLES.MEMBER_WRITE, \n    label: ROLE_LABELS[ROLES.MEMBER_WRITE],\n    description: ROLE_DESCRIPTIONS[ROLES.MEMBER_WRITE]\n  },\n  { \n    value: ROLES.MEMBER_READ, \n    label: ROLE_LABELS[ROLES.MEMBER_READ],\n    description: ROLE_DESCRIPTIONS[ROLES.MEMBER_READ]\n  }\n];\n\n// ==========================================\n// FUNCIONES AUXILIARES\n// ==========================================\n\n/**\n * Mapea un rol legacy a un rol est√°ndar\n * @param {string} legacyRole - Rol legacy de la BD\n * @returns {string} Rol est√°ndar\n */\nexport const mapLegacyRole = (legacyRole) => {\n  return LEGACY_ROLE_MAPPING[legacyRole] || ROLES.MEMBER_READ;\n};\n\n/**\n * Verifica si un rol es v√°lido\n * @param {string} role - Rol a verificar\n * @returns {boolean} True si es v√°lido\n */\nexport const isValidRole = (role) => {\n  return Object.values(ROLES).includes(role);\n};\n\n/**\n * Obtiene los permisos de un rol\n * @param {string} role - Rol\n * @returns {object} Permisos del rol\n */\nexport const getRolePermissions = (role) => {\n  return ROLE_PERMISSIONS[role] || ROLE_PERMISSIONS[ROLES.MEMBER_READ];\n};\n\n/**\n * Verifica si un rol tiene un permiso espec√≠fico\n * @param {string} role - Rol\n * @param {string} permission - Permiso a verificar\n * @returns {boolean} True si tiene el permiso\n */\nexport const hasPermission = (role, permission) => {\n  const permissions = getRolePermissions(role);\n  return permissions[permission] === true;\n};\n","// ==========================================\n// üÜï NUEVO ARCHIVO: hooks/useOrganizationId.js\n// ==========================================\n// Hook personalizado para detectar organization_id\n// sin hardcodeo y con manejo de errores\n\nimport { useState, useEffect } from 'react';\nimport supabaseService from '../services/SupabaseService';\n\n/**\n * Hook para obtener el organization_id actual del usuario\n * Reemplaza el hardcodeo '73bf164f-f3e8-4207-95a6-e3e3d385148d'\n * \n * @param {Object} options - Opciones de configuraci√≥n\n * @param {string} options.fallbackFromProject - Organization ID del proyecto actual\n * @param {boolean} options.required - Si es requerido (muestra error si no se encuentra)\n * @returns {Object} { organizationId, loading, error }\n */\nconst useOrganizationId = (options = {}) => {\n  const {\n    fallbackFromProject = null,\n    required = true\n  } = options;\n\n  const [organizationId, setOrganizationId] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    const detectOrganization = async () => {\n      try {\n        console.log('üîç useOrganizationId - Iniciando detecci√≥n', { fallbackFromProject, required });\n        setLoading(true);\n        setError(null);\n\n        // PRIORIDAD 1: Organization ID del proyecto actual\n        if (fallbackFromProject) {\n          console.log('‚úÖ Organization ID detectado desde proyecto:', fallbackFromProject);\n          setOrganizationId(fallbackFromProject);\n          setLoading(false);\n          return;\n        }\n        \n        console.log('‚è≠Ô∏è No hay fallbackFromProject, intentando desde servicio...');\n\n        // PRIORIDAD 2: Organization ID del servicio Supabase\n        const detectedOrgId = supabaseService.getCurrentOrganization();\n        \n        if (detectedOrgId) {\n          console.log('‚úÖ Organization ID detectado desde servicio:', detectedOrgId);\n          setOrganizationId(detectedOrgId);\n          setLoading(false);\n          return;\n        }\n\n        // PRIORIDAD 3: Forzar detecci√≥n autom√°tica\n        console.log('üîç Intentando detectar organizaci√≥n autom√°ticamente...');\n        const autoDetectedOrg = await supabaseService.detectUserOrganization();\n        \n        if (autoDetectedOrg && autoDetectedOrg.id) {\n          console.log('‚úÖ Organization ID auto-detectado:', autoDetectedOrg.id);\n          console.log('‚úÖ Nombre de organizaci√≥n:', autoDetectedOrg.name);\n          console.log('‚úÖ Rol del usuario:', autoDetectedOrg.role);\n          setOrganizationId(autoDetectedOrg.id);\n          setLoading(false);\n          return;\n        }\n\n        // NO SE ENCONTR√ì ORGANIZACI√ìN\n        const errorMsg = 'No se pudo detectar organization_id. El usuario no pertenece a ninguna organizaci√≥n.';\n        console.error('‚ùå', errorMsg);\n        \n        if (required) {\n          setError(errorMsg);\n        }\n        \n        setOrganizationId(null);\n        setLoading(false);\n\n      } catch (err) {\n        console.error('‚ùå Error detectando organizaci√≥n:', err);\n        setError(err.message);\n        setOrganizationId(null);\n        setLoading(false);\n      }\n    };\n\n    detectOrganization();\n  }, [fallbackFromProject, required]);\n\n  return {\n    organizationId,\n    loading,\n    error,\n    // Funciones auxiliares\n    isValid: !!organizationId,\n    hasError: !!error\n  };\n};\n\nexport default useOrganizationId;\n","/**\n * Hook para mapeo de roles legacy a roles est√°ndar\n * Proporciona funciones para manejar la transici√≥n de roles\n * \n * @version 1.0.0\n * @created 2025-01-27\n */\n\nimport { useMemo } from 'react';\nimport { mapLegacyRole, isValidRole, getRolePermissions, hasPermission } from '../constants/roles';\n\n/**\n * Hook para mapeo y validaci√≥n de roles\n * @returns {object} Funciones de mapeo y validaci√≥n\n */\nexport const useRoleMapping = () => {\n  return useMemo(() => ({\n    /**\n     * Mapea un rol legacy a un rol est√°ndar\n     * @param {string} dbRole - Rol de la base de datos\n     * @returns {string} Rol est√°ndar mapeado\n     */\n    mapRole: (dbRole) => {\n      if (!dbRole) return 'member_read';\n      return mapLegacyRole(dbRole);\n    },\n\n    /**\n     * Verifica si un rol es v√°lido\n     * @param {string} role - Rol a verificar\n     * @returns {boolean} True si es v√°lido\n     */\n    isValidRole,\n\n    /**\n     * Obtiene los permisos de un rol\n     * @param {string} role - Rol\n     * @returns {object} Permisos del rol\n     */\n    getRolePermissions,\n\n    /**\n     * Verifica si un rol tiene un permiso espec√≠fico\n     * @param {string} role - Rol\n     * @param {string} permission - Permiso a verificar\n     * @returns {boolean} True si tiene el permiso\n     */\n    hasPermission,\n\n    /**\n     * Valida la consistencia de roles en una lista de miembros\n     * @param {Array} members - Lista de miembros\n     * @returns {object} Resultado de la validaci√≥n\n     */\n    validateRoleConsistency: (members) => {\n      const issues = [];\n      const stats = {\n        total: members.length,\n        valid: 0,\n        invalid: 0,\n        legacy: 0\n      };\n\n      members.forEach(member => {\n        const originalRole = member.role;\n        const mappedRole = mapLegacyRole(originalRole);\n        \n        // Contar roles legacy\n        if (originalRole !== mappedRole) {\n          stats.legacy++;\n        }\n\n        // Verificar si el rol mapeado es v√°lido\n        if (isValidRole(mappedRole)) {\n          stats.valid++;\n        } else {\n          stats.invalid++;\n          issues.push({\n            user: member.user_email || member.email,\n            originalRole,\n            mappedRole,\n            issue: 'Mapped role is not valid'\n          });\n        }\n      });\n\n      return {\n        issues,\n        stats,\n        isConsistent: issues.length === 0\n      };\n    }\n  }), []);\n};\n\nexport default useRoleMapping;\n","// ==========================================\n// üÜï NUEVO ARCHIVO: hooks/useCurrentUserPermissions.js\n// ==========================================\n// Hook para obtener permisos del usuario actual\n// Elimina verificaciones duplicadas de isOwnerOrAdmin\n// V3: Refactorizado para usar useAuthUser como base\n\nimport { useMemo } from 'react';\nimport useAuthUser from './useAuthUser';\nimport { useRoleMapping } from './useRoleMapping';\nimport { ROLES } from '../constants/roles';\n\n/**\n * Hook para verificar permisos del usuario actual en la organizaci√≥n\n *\n * Busca la membres√≠a del usuario actual en la lista de miembros, mapea su rol\n * a un rol est√°ndar y calcula permisos espec√≠ficos para gesti√≥n de usuarios.\n *\n * Elimina la necesidad de verificaciones duplicadas de isOwnerOrAdmin en componentes.\n * Usa useAuthUser para autenticaci√≥n y useRoleMapping para normalizaci√≥n de roles.\n *\n * @param {Array<Object>} members - Lista de miembros de la organizaci√≥n\n * @param {string} members[].user_email - Email del miembro\n * @param {string} members[].role - Rol del miembro en la organizaci√≥n\n *\n * @returns {Object} Permisos y metadata del usuario actual\n * @returns {Object|null} return.currentUser - Objeto de usuario de Supabase\n * @returns {Object|null} return.currentUserMembership - Objeto de membres√≠a del usuario\n * @returns {string|null} return.currentUserRole - Rol original del usuario (de DB)\n * @returns {string|null} return.mappedRole - Rol mapeado a est√°ndar (OWNER, ADMIN, MEMBER_WRITE, MEMBER_READ)\n * @returns {boolean} return.isOwnerOrAdmin - Si es owner o admin\n * @returns {boolean} return.isOwner - Si es owner\n * @returns {boolean} return.isAdmin - Si es admin\n * @returns {boolean} return.isMember - Si es miembro (write o read)\n * @returns {boolean} return.canInvite - Puede invitar usuarios\n * @returns {boolean} return.canEditRoles - Puede editar roles de usuarios\n * @returns {boolean} return.canRemoveMembers - Puede eliminar miembros\n * @returns {Function} return.canEditMember - Verifica si puede editar un miembro espec√≠fico\n * @returns {Function} return.canRemoveMember - Verifica si puede eliminar un miembro espec√≠fico\n *\n * @example\n * const { isOwnerOrAdmin, canInvite, canEditMember, canRemoveMember } = useCurrentUserPermissions(members);\n *\n * return (\n *   <div>\n *     {canInvite && <InviteButton />}\n *     {members.map(member => (\n *       <MemberRow key={member.id}>\n *         {canEditMember(member) && <EditButton />}\n *         {canRemoveMember(member) && <RemoveButton />}\n *       </MemberRow>\n *     ))}\n *   </div>\n * );\n */\nconst useCurrentUserPermissions = (members = []) => {\n  // Hook base de autenticaci√≥n\n  const { currentUser, userEmail, isAuthenticated } = useAuthUser();\n  const { mapRole, hasPermission } = useRoleMapping();\n\n  return useMemo(() => {\n    // Verificar si hay usuario autenticado\n    if (!isAuthenticated || !userEmail) {\n      return {\n        currentUser: null,\n        currentUserMembership: null,\n        currentUserRole: null,\n        mappedRole: null,\n        isOwnerOrAdmin: false,\n        isOwner: false,\n        isAdmin: false,\n        isMember: false,\n        canInvite: false,\n        canEditRoles: false,\n        canRemoveMembers: false\n      };\n    }\n\n    // Buscar membres√≠a del usuario actual\n    const currentUserMembership = members.find(\n      m => m.user_email === userEmail\n    );\n\n    if (!currentUserMembership) {\n      return {\n        currentUser,\n        currentUserMembership: null,\n        currentUserRole: null,\n        mappedRole: null,\n        isOwnerOrAdmin: false,\n        isOwner: false,\n        isAdmin: false,\n        isMember: false,\n        canInvite: false,\n        canEditRoles: false,\n        canRemoveMembers: false\n      };\n    }\n\n    const originalRole = currentUserMembership.role;\n    const mappedRole = mapRole(originalRole);\n    \n    // Calcular permisos basados en el rol mapeado\n    const isOwner = mappedRole === ROLES.OWNER;\n    const isAdmin = mappedRole === ROLES.ADMIN;\n    const isOwnerOrAdmin = isOwner || isAdmin;\n    const isMember = mappedRole === ROLES.MEMBER_WRITE || mappedRole === ROLES.MEMBER_READ;\n\n    return {\n      currentUser,\n      currentUserMembership,\n      currentUserRole: originalRole,\n      mappedRole,\n      \n      // Permisos b√°sicos\n      isOwnerOrAdmin,\n      isOwner,\n      isAdmin,\n      isMember,\n      \n      // Permisos espec√≠ficos usando el sistema de permisos\n      canInvite: hasPermission(mappedRole, 'canInvite'),\n      canEditRoles: hasPermission(mappedRole, 'canEditRoles'),\n      canRemoveMembers: hasPermission(mappedRole, 'canRemoveMembers'),\n      \n      // Funci√≥n helper para verificar si puede editar un miembro espec√≠fico\n      canEditMember: (targetMember) => {\n        if (!hasPermission(mappedRole, 'canEditRoles')) return false;\n        // Owner puede editar a todos\n        if (isOwner) return true;\n        // Admin no puede editar a owner\n        const targetMappedRole = mapRole(targetMember?.role);\n        if (targetMappedRole === ROLES.OWNER) return false;\n        return true;\n      },\n      \n      // Funci√≥n helper para verificar si puede eliminar un miembro espec√≠fico\n      canRemoveMember: (targetMember) => {\n        if (!hasPermission(mappedRole, 'canRemoveMembers')) return false;\n        // No puede eliminarse a s√≠ mismo\n        if (targetMember?.user_email === userEmail) return false;\n        // Owner puede eliminar a todos (excepto a s√≠ mismo)\n        if (isOwner) return true;\n        // Admin no puede eliminar a owner ni a otros admins\n        const targetMappedRole = mapRole(targetMember?.role);\n        if (targetMappedRole === ROLES.OWNER || targetMappedRole === ROLES.ADMIN) return false;\n        return true;\n      }\n    };\n  }, [members, currentUser, userEmail, isAuthenticated, mapRole, hasPermission]);\n};\n\nexport default useCurrentUserPermissions;\n\n","// ==========================================\n// üÜï NUEVO ARCHIVO: hooks/useInviteModal.js\n// ==========================================\n// Hook con useReducer para gestionar el estado del modal de invitaci√≥n\n// Consolida m√∫ltiples useState en un solo reducer\n\nimport { useReducer } from 'react';\n\n// Estado inicial del modal\nconst initialState = {\n  showModal: false,\n  email: '',\n  role: 'organization_member_write',\n  functionalRole: '',\n  isLoading: false,\n  error: null\n};\n\n// Tipos de acciones\nconst ACTIONS = {\n  OPEN_MODAL: 'OPEN_MODAL',\n  CLOSE_MODAL: 'CLOSE_MODAL',\n  SET_EMAIL: 'SET_EMAIL',\n  SET_ROLE: 'SET_ROLE',\n  SET_FUNCTIONAL_ROLE: 'SET_FUNCTIONAL_ROLE',\n  SET_LOADING: 'SET_LOADING',\n  SET_ERROR: 'SET_ERROR',\n  RESET_FORM: 'RESET_FORM'\n};\n\n// Reducer function\nfunction inviteModalReducer(state, action) {\n  switch (action.type) {\n    case ACTIONS.OPEN_MODAL:\n      return { ...state, showModal: true };\n    \n    case ACTIONS.CLOSE_MODAL:\n      return { ...state, showModal: false };\n    \n    case ACTIONS.SET_EMAIL:\n      return { ...state, email: action.payload };\n    \n    case ACTIONS.SET_ROLE:\n      return { ...state, role: action.payload };\n    \n    case ACTIONS.SET_FUNCTIONAL_ROLE:\n      return { ...state, functionalRole: action.payload };\n    \n    case ACTIONS.SET_LOADING:\n      return { ...state, isLoading: action.payload };\n    \n    case ACTIONS.SET_ERROR:\n      return { ...state, error: action.payload };\n    \n    case ACTIONS.RESET_FORM:\n      return {\n        ...initialState,\n        showModal: state.showModal // Mantener el estado del modal\n      };\n    \n    default:\n      return state;\n  }\n}\n\n/**\n * Hook personalizado para gestionar el estado del modal de invitaci√≥n\n * Usa useReducer para consolidar m√∫ltiples useState\n * \n * @returns {Object} { state, actions }\n */\nconst useInviteModal = () => {\n  const [state, dispatch] = useReducer(inviteModalReducer, initialState);\n\n  // Actions helpers\n  const actions = {\n    openModal: () => dispatch({ type: ACTIONS.OPEN_MODAL }),\n    closeModal: () => dispatch({ type: ACTIONS.CLOSE_MODAL }),\n    setEmail: (email) => dispatch({ type: ACTIONS.SET_EMAIL, payload: email }),\n    setRole: (role) => dispatch({ type: ACTIONS.SET_ROLE, payload: role }),\n    setFunctionalRole: (functionalRole) => dispatch({ type: ACTIONS.SET_FUNCTIONAL_ROLE, payload: functionalRole }),\n    setLoading: (isLoading) => dispatch({ type: ACTIONS.SET_LOADING, payload: isLoading }),\n    setError: (error) => dispatch({ type: ACTIONS.SET_ERROR, payload: error }),\n    resetForm: () => dispatch({ type: ACTIONS.RESET_FORM })\n  };\n\n  return {\n    state,\n    actions\n  };\n};\n\nexport default useInviteModal;\nexport { ACTIONS };\n\n","/**\n * Obtiene la URL base de la aplicaci√≥n seg√∫n el ambiente\n */\nexport function getAppBaseUrl() {\n  // 1. Intentar obtener de variable de entorno\n  const envUrl = import.meta.env?.VITE_BASE_URL || process.env.REACT_APP_BASE_URL;\n  \n  if (envUrl) {\n    return envUrl;\n  }\n  \n  // 2. Detectar autom√°ticamente seg√∫n el hostname\n  const hostname = window.location.hostname;\n  \n  // Si estamos en localhost o 127.0.0.1 ‚Üí desarrollo\n  if (hostname === 'localhost' || hostname === '127.0.0.1') {\n    return `http://${hostname}:${window.location.port || 3000}`;\n  }\n  \n  // Si estamos en Vercel o cualquier dominio real ‚Üí usar origin\n  return window.location.origin;\n}\n\n/**\n * Genera URL completa con path\n */\nexport function getAppUrl(path = '') {\n  const baseUrl = getAppBaseUrl();\n  const cleanPath = path.startsWith('/') ? path : `/${path}`;\n  return `${baseUrl}${cleanPath}`;\n}\n","import React, { useState } from 'react';\nimport './InvitationModal.css';\nimport { getAppUrl } from '../utils/config';\n\nfunction InvitationModal({ isOpen, onClose, invitation }) {\n  const [copied, setCopied] = useState(false);\n  \n  if (!isOpen || !invitation) return null;\n  \n  // Generar URL de invitaci√≥n con query params usando helper de configuraci√≥n\n  const invitationUrl = getAppUrl(\n    `/signup?email=${encodeURIComponent(invitation.user_email)}&invited=true&org=${invitation.organization_id}`\n  );\n  \n  const handleCopyLink = async () => {\n    try {\n      await navigator.clipboard.writeText(invitationUrl);\n      setCopied(true);\n      setTimeout(() => setCopied(false), 3000);\n    } catch (err) {\n      console.error('Error copiando enlace:', err);\n      // Fallback para navegadores antiguos\n      const textArea = document.createElement('textarea');\n      textArea.value = invitationUrl;\n      document.body.appendChild(textArea);\n      textArea.select();\n      document.execCommand('copy');\n      document.body.removeChild(textArea);\n      setCopied(true);\n      setTimeout(() => setCopied(false), 3000);\n    }\n  };\n  \n  const handleShareWhatsApp = () => {\n    const message = encodeURIComponent(\n      `üéâ ¬°Has sido invitado a unirte a nuestra organizaci√≥n en StrategiaPM!\\n\\n` +\n      `Haz clic en este enlace para registrarte:\\n${invitationUrl}\\n\\n` +\n      `Importante: Usa el email ${invitation.user_email} al registrarte.`\n    );\n    window.open(`https://wa.me/?text=${message}`, '_blank');\n  };\n  \n  const handleShareEmail = () => {\n    const subject = encodeURIComponent('Invitaci√≥n a StrategiaPM');\n    const body = encodeURIComponent(\n      `Has sido invitado a unirte a nuestra organizaci√≥n en StrategiaPM.\\n\\n` +\n      `Haz clic en este enlace para registrarte:\\n${invitationUrl}\\n\\n` +\n      `Importante: Debes registrarte usando el email ${invitation.user_email}\\n\\n` +\n      `Una vez registrado, tendr√°s acceso autom√°tico a la organizaci√≥n.`\n    );\n    window.location.href = `mailto:${invitation.user_email}?subject=${subject}&body=${body}`;\n  };\n  \n  return (\n    <div className=\"invitation-modal-overlay\" onClick={onClose}>\n      <div className=\"invitation-modal\" onClick={(e) => e.stopPropagation()}>\n        <div className=\"invitation-modal-header\">\n          <h2>‚úÖ Invitaci√≥n Creada</h2>\n          <button className=\"close-button\" onClick={onClose}>√ó</button>\n        </div>\n        \n        <div className=\"invitation-modal-body\">\n          <div className=\"invitation-info\">\n            <p className=\"invited-email\">\n              üìß <strong>{invitation.user_email}</strong>\n            </p>\n            <p className=\"invited-role\">\n              Rol: <span className=\"role-badge\">{invitation.role}</span>\n            </p>\n          </div>\n          \n          <div className=\"invitation-instructions\">\n            <h3>üìã C√≥mo compartir esta invitaci√≥n:</h3>\n            <ol>\n              <li>Copia el enlace de abajo</li>\n              <li>Env√≠alo al usuario por WhatsApp, email, o Slack</li>\n              <li>El usuario solo debe hacer clic y registrarse</li>\n              <li>Una vez registrado, tendr√° acceso autom√°tico</li>\n            </ol>\n          </div>\n          \n          <div className=\"invitation-link-section\">\n            <label>üîó Enlace de invitaci√≥n:</label>\n            <div className=\"link-container\">\n              <input \n                type=\"text\" \n                value={invitationUrl}\n                readOnly\n                className=\"invitation-link-input\"\n              />\n              <button \n                className={`copy-button ${copied ? 'copied' : ''}`}\n                onClick={handleCopyLink}\n              >\n                {copied ? '‚úÖ Copiado' : 'üìã Copiar'}\n              </button>\n            </div>\n          </div>\n          \n          <div className=\"share-options\">\n            <h4>O compartir directamente:</h4>\n            <div className=\"share-buttons\">\n              <button className=\"share-btn whatsapp\" onClick={handleShareWhatsApp}>\n                üí¨ WhatsApp\n              </button>\n              <button className=\"share-btn email\" onClick={handleShareEmail}>\n                üìß Email\n              </button>\n            </div>\n          </div>\n          \n          <div className=\"invitation-note\">\n            <p>‚ö†Ô∏è <strong>Importante:</strong> El usuario debe registrarse usando exactamente el email <strong>{invitation.user_email}</strong></p>\n          </div>\n        </div>\n        \n        <div className=\"invitation-modal-footer\">\n          <button className=\"btn-primary\" onClick={onClose}>\n            Entendido\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default InvitationModal;\n","import { logger } from '../utils/logger';\n\nimport React, { useState, useEffect } from 'react';\nimport useAuditLog from '../hooks/useAuditLog';\nimport supabaseService from '../services/SupabaseService';\nimport subscriptionService from '../services/SubscriptionService';\nimport { FUNCTIONAL_ROLES, FUNCTIONAL_ROLE_LABELS } from '../constants/unifiedRoles';\nimport { ROLES, ROLE_LABELS, ROLE_OPTIONS, mapLegacyRole } from '../constants/roles';\nimport useOrganizationId from '../hooks/useOrganizationId';\nimport useCurrentUserPermissions from '../hooks/useCurrentUserPermissions';\nimport useInviteModal from '../hooks/useInviteModal';\nimport { debugLog, debugError, debugSuccess } from '../utils/debugLog';\nimport InvitationModal from './InvitationModal';\nimport UpgradeModal from './subscription/UpgradeModal';\n\nconst OrganizationMembers = ({ \n  currentProject, \n  useSupabase = false,\n  onMemberAdded \n}) => {\n  const [members, setMembers] = useState([]);\n  const [invitations, setInvitations] = useState([]);\n  \n  // Hook del modal de invitaci√≥n - consolida 4 useState en un reducer\n  const { \n    state: inviteModalState, \n    actions: inviteModalActions \n  } = useInviteModal();\n  \n  // Extraer valores para compatibilidad con c√≥digo existente\n  const showInviteModal = inviteModalState.showModal;\n  const inviteEmail = inviteModalState.email;\n  const inviteRole = inviteModalState.role;\n  const inviteFunctionalRole = inviteModalState.functionalRole;\n  \n  // Extraer acciones para usar en lugar de setters\n  const setShowInviteModal = (show) => show ? inviteModalActions.openModal() : inviteModalActions.closeModal();\n  const setInviteEmail = inviteModalActions.setEmail;\n  const setInviteRole = inviteModalActions.setRole;\n  const setInviteFunctionalRole = inviteModalActions.setFunctionalRole;\n  \n  // Estados para editar roles\n  const [showEditRoleModal, setShowEditRoleModal] = useState(false);\n  const [editingMember, setEditingMember] = useState(null);\n  const [newRole, setNewRole] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [showUpgradeModal, setShowUpgradeModal] = useState(false);\n  const [upgradeModalData, setUpgradeModalData] = useState({});\n\n  // Estados para roles funcionales\n  const [editingMemberRole, setEditingMemberRole] = useState(null);\n  const [selectedFunctionalRole, setSelectedFunctionalRole] = useState('');\n  \n  // Estados para el modal de invitaci√≥n mejorado\n  const [showInvitationModal, setShowInvitationModal] = useState(false);\n  const [lastInvitation, setLastInvitation] = useState(null);\n\n  // Hook de auditor√≠a\n  const { addAuditEvent } = useAuditLog(currentProject?.id, useSupabase);\n\n  // DETECCI√ìN AUTOM√ÅTICA: Usar hook sin hardcodeo\n  const { \n    organizationId, \n    loading: orgLoading, \n    error: orgError \n  } = useOrganizationId({ \n    fallbackFromProject: currentProject?.organization_id,\n    required: true \n  });\n\n  // üîç LOGS DE DEBUG PARA DIAGNOSTICAR\n  useEffect(() => {\n    logger.debug('üîç OrganizationMembers - Estado actual:', {\n      hasCurrentProject: !!currentProject,\n      currentProjectOrgId: currentProject?.organization_id,\n      organizationId: organizationId,\n      orgLoading: orgLoading,\n      orgError: orgError,\n      useSupabase: useSupabase\n    });\n  }, [currentProject, organizationId, orgLoading, orgError, useSupabase]);\n\n  // Hook de permisos - elimina 6 verificaciones duplicadas\n  const { \n    isOwnerOrAdmin, \n    canInvite, \n    canEditRoles, \n    canRemoveMembers,\n    canEditMember,\n    canRemoveMember \n  } = useCurrentUserPermissions(members);\n\n  // Cargar miembros de la organizaci√≥n\n  const loadOrganizationMembers = async () => {\n    logger.debug('üîÑ loadOrganizationMembers ejecut√°ndose', { useSupabase, organizationId });\n    \n    if (!useSupabase) {\n      logger.warn('‚ö†Ô∏è Supabase no est√° habilitado, no se cargar√°n miembros');\n      return;\n    }\n    \n    if (!organizationId) {\n      logger.warn('‚ö†Ô∏è organizationId es null/undefined, esperando detecci√≥n...');\n      logger.warn('‚ö†Ô∏è Estado actual:', { \n        orgLoading, \n        orgError,\n        currentProjectOrgId: currentProject?.organization_id \n      });\n      return;\n    }\n    \n    logger.debug('‚úÖ Iniciando carga de miembros para organization_id:', organizationId);\n\n    try {\n      setIsLoading(true);\n      const { default: supabaseService } = await import('../services/SupabaseService');\n      \n      if (supabaseService.isAuthenticated()) {\n        debugLog('OrganizationMembers', 'Usuario autenticado', supabaseService.getCurrentUser());\n        debugLog('OrganizationMembers', 'Organization ID', organizationId);\n        \n        // Probar consulta directa sin filtros para ver si es problema de RLS\n        const { data: allMembers, error: allError } = await supabaseService.supabase\n          .from('organization_members')\n          .select('*');\n        debugLog('OrganizationMembers', 'Todos los miembros (sin filtro)', { allMembers, allError });\n        \n        const { data: membersData, error: membersError } = await supabaseService.supabase\n          .from('organization_members')\n          .select('*')\n          .eq('organization_id', organizationId)\n          .order('joined_at', { ascending: false });\n\n        if (membersError) {\n          debugError('OrganizationMembers', 'Error cargando miembros', membersError);\n          setError('Error cargando miembros de la organizaci√≥n');\n        } else {\n          debugLog('OrganizationMembers', 'Datos cargados', membersData);\n          \n          // Filtrar solo miembros activos para mostrar\n          const activeMembers = (membersData || []).filter(member => member.status === 'active');\n          setMembers(activeMembers);\n          \n          // Separar invitaciones pendientes\n          const pendingInvitations = (membersData || []).filter(member => member.status === 'pending');\n          setInvitations(pendingInvitations);\n          \n          // Logs de verificaci√≥n\n          logger.debug('‚úÖ Total de miembros cargados:', membersData?.length || 0);\n          logger.debug('‚úÖ Miembros activos:', activeMembers.length);\n          logger.debug('‚è≥ Invitaciones pendientes:', pendingInvitations.length);\n          \n          debugLog('OrganizationMembers', 'Miembros activos', activeMembers);\n          debugLog('OrganizationMembers', 'Invitaciones pendientes', pendingInvitations);\n        }\n      }\n    } catch (error) {\n      debugError('OrganizationMembers', 'Error cargando miembros', error);\n      setError('Error cargando miembros de la organizaci√≥n');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Invitar nuevo miembro\n  const inviteMember = async (e) => {\n    e.preventDefault();\n    if (!inviteEmail || !organizationId) return;\n\n    // VERIFICAR PERMISOS: Usar hook de permisos\n    if (!canInvite) {\n      alert('‚ùå No tienes permisos para invitar miembros. Solo owners y administradores pueden realizar esta acci√≥n.');\n      return;\n    }\n\n    // VERIFICAR L√çMITES DE SUSCRIPCI√ìN\n    try {\n      const canAdd = await subscriptionService.canAddUser(organizationId);\n      if (!canAdd.allowed) {\n        // Obtener estad√≠sticas de uso para el modal\n        const stats = await subscriptionService.getUsageStats(organizationId);\n        const portfolioData = localStorage.getItem('strategiapm_portfolio_data');\n        const portfolio = portfolioData ? JSON.parse(portfolioData) : {};\n\n        setUpgradeModalData({\n          limitType: 'user',\n          currentPlan: portfolio?.organization?.subscriptionPlan || 'free',\n          currentCount: stats.currentUsers,\n          maxCount: stats.maxUsers\n        });\n        setShowUpgradeModal(true);\n        return;\n      }\n    } catch (limitError) {\n      logger.error('Error verificando l√≠mites:', limitError);\n      // En caso de error, permitir continuar (fail-safe)\n    }\n\n    try {\n      setIsLoading(true);\n      setError(null);\n\n      const { default: supabaseService } = await import('../services/SupabaseService');\n      \n      if (supabaseService.isAuthenticated()) {\n        debugLog('inviteMember', 'Usuario autenticado', supabaseService.getCurrentUser());\n        debugLog('inviteMember', 'Organization ID', organizationId);\n        \n        // Verificar contexto de RLS\n        const { data: rlsTest, error: rlsError } = await supabaseService.supabase\n          .from('user_organization_roles')\n          .select('role, organization_id')\n          .eq('user_id', supabaseService.getCurrentUser()?.id);\n        debugLog('inviteMember', 'RLS Context', { rlsTest, rlsError });\n        \n        // Verificar si el usuario ya est√° en la organizaci√≥n\n        const { data: existingMember, error: memberError } = await supabaseService.supabase\n          .from('organization_members')\n          .select('*')\n          .eq('organization_id', organizationId)\n          .eq('user_email', inviteEmail)\n          .single();\n\n        if (existingMember) {\n          alert(`‚ö†Ô∏è El usuario ${inviteEmail} ya es miembro de esta organizaci√≥n.`);\n          return;\n        }\n\n        // Crear invitaci√≥n usando funci√≥n personalizada\n        debugLog('inviteMember', 'Datos de inserci√≥n', {\n          organization_id: organizationId,\n          user_id: null,\n          user_email: inviteEmail,\n          role: inviteRole,\n          status: 'pending'\n        });\n        \n        const { data: inviteResult, error: insertError } = await supabaseService.supabase\n          .rpc('invite_member', {\n            p_organization_id: organizationId,\n            p_user_email: inviteEmail,\n            p_role: inviteRole,\n            p_functional_role: inviteFunctionalRole || null\n          });\n\n        if (insertError) {\n          throw insertError;\n        }\n\n        // Verificar el resultado de la funci√≥n\n        if (inviteResult && !inviteResult.success) {\n          throw new Error(inviteResult.error || 'Error al invitar miembro');\n        }\n\n        // Registrar evento de auditor√≠a\n        if (addAuditEvent) {\n          addAuditEvent({\n            category: 'organization',\n            action: 'member-invited',\n            description: `Invitaci√≥n enviada a \"${inviteEmail}\" con rol \"${inviteRole}\"`,\n              details: {\n                userEmail: inviteEmail,\n                role: inviteRole,\n                organizationId: organizationId\n              },\n            severity: 'medium',\n            user: supabaseService.getCurrentUser()?.email || 'Sistema'\n          });\n        }\n\n        // Guardar datos de la invitaci√≥n y mostrar modal mejorado\n        setLastInvitation({\n          user_email: inviteEmail,\n          role: inviteRole,\n          organization_id: organizationId\n        });\n        setShowInvitationModal(true);\n\n        // Recargar miembros\n        await loadOrganizationMembers();\n        \n        // Limpiar formulario usando reducer\n        inviteModalActions.resetForm();\n        inviteModalActions.closeModal();\n\n        // Notificar al componente padre\n        if (onMemberAdded) {\n          onMemberAdded();\n        }\n      }\n    } catch (error) {\n      logger.error('Error invitando miembro:', error);\n      setError(`Error invitando miembro: ${error.message}`);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Reenviar invitaci√≥n\n  const handleResendInvitation = async (invitationId) => {\n    try {\n      const invitation = invitations.find(inv => inv.id === invitationId);\n      if (!invitation) return;\n\n      // L√≥gica para reenviar el email de invitaci√≥n\n      logger.debug('Reenviando invitaci√≥n:', invitationId);\n      \n      const registrationUrl = window.location.hostname === 'localhost' \n        ? 'https://strategiapm.vercel.app' \n        : window.location.origin;\n\n      alert(`üìß Recordatorio de invitaci√≥n\n      \nSe ha notificado nuevamente a ${invitation.user_email}\n\nComparte este enlace para que se registren:\n${registrationUrl}\n\nUna vez registrado con ese email, tendr√° acceso autom√°ticamente.`);\n      \n      // TODO: Implementar env√≠o de email real\n    } catch (error) {\n      logger.error('Error reenviando invitaci√≥n:', error);\n      alert('Error al reenviar invitaci√≥n');\n    }\n  };\n\n  // Cancelar invitaci√≥n\n  const handleCancelInvitation = async (invitationId, userEmail) => {\n    try {\n      // Confirmar con el usuario\n      const confirmed = window.confirm(\n        `¬øEst√°s seguro de cancelar la invitaci√≥n para ${userEmail}?`\n      );\n      \n      if (!confirmed) return;\n      \n      logger.debug('üóëÔ∏è Cancelando invitaci√≥n:', invitationId);\n      \n      // Eliminar la invitaci√≥n\n      const { error } = await supabaseService.supabase\n        .from('organization_members')\n        .delete()\n        .eq('id', invitationId);\n      \n      if (error) {\n        logger.error('‚ùå Error cancelando invitaci√≥n:', error);\n        alert(`Error al cancelar invitaci√≥n: ${error.message}`);\n        return;\n      }\n      \n      logger.debug('‚úÖ Invitaci√≥n cancelada exitosamente');\n      alert('‚úÖ Invitaci√≥n cancelada');\n      \n      // Recargar la lista de miembros\n      loadOrganizationMembers();\n      \n    } catch (err) {\n      logger.error('‚ùå Error inesperado:', err);\n      alert(`Error: ${err.message}`);\n    }\n  };\n\n  // Eliminar miembro COMPLETAMENTE de todas las tablas relacionadas\n  const removeMember = async (memberId, memberEmail) => {\n    const memberToDelete = members.find(m => m.id === memberId);\n    \n    // VERIFICAR PERMISOS: Usar hook de permisos\n    if (!canRemoveMember(memberToDelete)) {\n      const mappedRole = mapLegacyRole(memberToDelete?.role);\n      if (mappedRole === ROLES.OWNER) {\n        alert('‚ùå No se puede eliminar al propietario de la organizaci√≥n.');\n      } else {\n        alert('‚ùå No tienes permisos para eliminar este miembro.');\n      }\n      return;\n    }\n    \n    if (!window.confirm(`‚ö†Ô∏è ELIMINACI√ìN COMPLETA DE USUARIO\\n\\n¬øEst√°s seguro de que quieres eliminar COMPLETAMENTE a ${memberEmail}?\\n\\nEsto eliminar√°:\\n‚Ä¢ Su membres√≠a en la organizaci√≥n\\n‚Ä¢ Todos sus roles y permisos\\n‚Ä¢ Su acceso a todos los proyectos\\n\\nEsta acci√≥n NO se puede deshacer.`)) {\n      return;\n    }\n\n    try {\n      setIsLoading(true);\n      const { default: supabaseService } = await import('../services/SupabaseService');\n      \n      if (supabaseService.isAuthenticated()) {\n        debugLog('removeMember', 'Iniciando eliminaci√≥n completa de usuario', memberEmail);\n        \n        // PASO 1: Eliminar de organization_members\n        debugLog('removeMember', 'Eliminando de organization_members');\n        const { error: membersError } = await supabaseService.supabase\n          .from('organization_members')\n          .delete()\n          .eq('id', memberId);\n\n        if (membersError) {\n          debugError('removeMember', 'Error eliminando de organization_members', membersError);\n          throw new Error(`Error eliminando membres√≠a: ${membersError.message}`);\n        }\n\n        // PASO 2: Eliminar de user_organization_roles (si existe)\n        debugLog('removeMember', 'Eliminando de user_organization_roles');\n        const { error: rolesError } = await supabaseService.supabase\n          .from('user_organization_roles')\n          .delete()\n          .eq('user_email', memberEmail)\n          .eq('organization_id', organizationId);\n\n        if (rolesError) {\n          logger.warn('‚ö†Ô∏è Error eliminando de user_organization_roles (puede no existir):', rolesError);\n          // No lanzar error aqu√≠, ya que la tabla puede no existir\n        }\n\n        // PASO 3: Buscar y eliminar referencias en otras tablas relacionadas\n        debugLog('removeMember', 'Buscando referencias adicionales');\n        \n        // Eliminar tareas asignadas al usuario (si las hay)\n        const { error: tasksError } = await supabaseService.supabase\n          .from('tasks')\n          .update({ assigned_to: null })\n          .eq('assigned_to', memberEmail);\n\n        if (tasksError) {\n          logger.warn('‚ö†Ô∏è Error actualizando tareas:', tasksError);\n        }\n\n        // Eliminar riesgos asignados al usuario (si los hay)\n        const { error: risksError } = await supabaseService.supabase\n          .from('risks')\n          .update({ owner: null })\n          .eq('owner', memberEmail);\n\n        if (risksError) {\n          logger.warn('‚ö†Ô∏è Error actualizando riesgos:', risksError);\n        }\n\n        // PASO 4: Limpiar cach√© local del usuario eliminado\n        debugLog('removeMember', 'Limpiando cach√© local del usuario eliminado');\n        try {\n          // Limpiar localStorage del usuario eliminado\n          const localStorageKeys = [\n            'mi-dashboard-portfolio',\n            'lastSelectedProjectId',\n            'portfolioData',\n            'audit-log-' + memberEmail,\n            'user-preferences-' + memberEmail\n          ];\n          \n          localStorageKeys.forEach(key => {\n            const data = localStorage.getItem(key);\n            if (data) {\n              try {\n                const parsedData = JSON.parse(data);\n                // Si los datos contienen referencias al usuario eliminado, limpiarlos\n                if (JSON.stringify(parsedData).includes(memberEmail)) {\n                  logger.debug(`üóëÔ∏è Limpiando localStorage key: ${key}`);\n                  localStorage.removeItem(key);\n                }\n              } catch (e) {\n                // Si no se puede parsear, eliminar directamente\n                logger.debug(`üóëÔ∏è Limpiando localStorage key (raw): ${key}`);\n                localStorage.removeItem(key);\n              }\n            }\n          });\n          \n          // Limpiar sessionStorage tambi√©n\n          const sessionStorageKeys = [\n            'currentUser',\n            'userSession',\n            'organizationData'\n          ];\n          \n          sessionStorageKeys.forEach(key => {\n            const data = sessionStorage.getItem(key);\n            if (data && data.includes(memberEmail)) {\n              logger.debug(`üóëÔ∏è Limpiando sessionStorage key: ${key}`);\n              sessionStorage.removeItem(key);\n            }\n          });\n          \n          debugSuccess('removeMember', 'Cach√© local limpiado para usuario eliminado');\n        } catch (cacheError) {\n          debugError('removeMember', 'Error limpiando cach√© local', cacheError);\n        }\n\n        // PASO 5: Registrar evento de auditor√≠a\n        if (addAuditEvent) {\n          addAuditEvent({\n            category: 'organization',\n            action: 'member-completely-removed',\n            description: `Usuario \"${memberEmail}\" eliminado COMPLETAMENTE de la organizaci√≥n`,\n            details: {\n              userEmail: memberEmail,\n              organizationId: organizationId,\n              tablesCleaned: ['organization_members', 'user_organization_roles', 'tasks', 'risks'],\n              localCacheCleaned: true\n            },\n            severity: 'high',\n            user: supabaseService.getCurrentUser()?.email || 'Sistema'\n          });\n        }\n\n        debugSuccess('removeMember', 'Usuario eliminado completamente de todas las tablas y cach√© local');\n        \n        // Mostrar mensaje detallado con instrucciones\n        const detailedMessage = `‚úÖ Usuario ${memberEmail} eliminado COMPLETAMENTE de la organizaci√≥n\n\nSe elimin√≥ de:\n‚Ä¢ organization_members (membres√≠a principal)\n‚Ä¢ user_organization_roles (roles y permisos)\n‚Ä¢ Referencias en tareas y riesgos\n‚Ä¢ Cach√© local del navegador\n\n‚ö†Ô∏è IMPORTANTE: El usuario eliminado debe:\n1. Cerrar sesi√≥n completamente\n2. Cerrar el navegador\n3. Volver a abrir el navegador\n4. Iniciar sesi√≥n nuevamente\n\nSolo as√≠ ver√° que ya no tiene acceso a la organizaci√≥n.`;\n        \n        alert(detailedMessage);\n        \n        // Recargar miembros\n        await loadOrganizationMembers();\n      }\n    } catch (error) {\n      logger.error('‚ùå Error eliminando miembro:', error);\n      setError(`Error eliminando miembro: ${error.message}`);\n      alert(`‚ùå Error eliminando usuario: ${error.message}\\n\\nPor favor, intenta nuevamente o contacta al administrador.`);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Editar rol de miembro\n  const editMemberRole = async () => {\n    if (!editingMember || !newRole) return;\n    \n    // VERIFICAR PERMISOS: Usar hook de permisos\n    if (!canEditMember(editingMember)) {\n      const mappedRole = mapLegacyRole(editingMember.role);\n      if (mappedRole === ROLES.OWNER) {\n        alert('‚ùå No se puede cambiar el rol del propietario de la organizaci√≥n.');\n      } else {\n        alert('‚ùå No tienes permisos para cambiar el rol de este miembro.');\n      }\n      return;\n    }\n\n    try {\n      setIsLoading(true);\n      const { default: supabaseService } = await import('../services/SupabaseService');\n      \n      if (supabaseService.isAuthenticated()) {\n        const { error } = await supabaseService.supabase\n          .from('organization_members')\n          .update({ role: newRole })\n          .eq('id', editingMember.id);\n\n        if (error) {\n          throw error;\n        }\n\n        // Registrar evento de auditor√≠a\n        if (addAuditEvent) {\n          addAuditEvent({\n            category: 'organization',\n            action: 'member-role-updated',\n            description: `Rol de \"${editingMember.user_email}\" cambiado a \"${getRoleLabel(newRole)}\"`,\n            details: {\n              userEmail: editingMember.user_email,\n              oldRole: editingMember.role,\n              newRole: newRole,\n              organizationId: organizationId\n            },\n            severity: 'medium',\n            user: supabaseService.getCurrentUser()?.email || 'Sistema'\n          });\n        }\n\n        alert(`‚úÖ Rol de ${editingMember.user_email} actualizado exitosamente`);\n        \n        // Recargar miembros\n        await loadOrganizationMembers();\n        \n        // Cerrar modal\n        setShowEditRoleModal(false);\n        setEditingMember(null);\n        setNewRole('');\n      }\n    } catch (error) {\n      logger.error('Error actualizando rol:', error);\n      setError(`Error actualizando rol: ${error.message}`);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Actualizar rol funcional de miembro\n  const handleUpdateFunctionalRole = async (memberId, newFunctionalRole) => {\n    try {\n      setIsLoading(true);\n      \n      const { error } = await supabaseService.supabase\n        .from('organization_members')\n        .update({ \n          functional_role: newFunctionalRole || null,\n          updated_at: new Date().toISOString()\n        })\n        .eq('id', memberId)\n        .eq('organization_id', organizationId);\n\n      if (error) {\n        logger.error('Error actualizando rol funcional:', error);\n        alert('Error actualizando rol funcional: ' + error.message);\n        return;\n      }\n\n      // Recargar miembros\n      await loadOrganizationMembers();\n      \n      // Limpiar estado de edici√≥n\n      setEditingMemberRole(null);\n      setSelectedFunctionalRole('');\n      \n      alert('Rol funcional actualizado exitosamente');\n    } catch (error) {\n      logger.error('Error actualizando rol funcional:', error);\n      alert('Error actualizando rol funcional');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Componente selector de rol funcional\n  const FunctionalRoleSelector = ({ member, isInviteForm = false, value, onChange }) => {\n    const currentUserRole = members.find(m => m.user_email === supabaseService.getCurrentUser()?.email)?.role;\n    const canEdit = currentUserRole === 'owner' || currentUserRole === 'admin';\n    \n    if (isInviteForm) {\n      // Selector en formulario de invitaci√≥n\n      return (\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n            Rol Funcional (Opcional)\n          </label>\n          <select\n            value={value || ''}\n            onChange={(e) => onChange(e.target.value)}\n            className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n          >\n            <option value=\"\">Sin rol espec√≠fico</option>\n            <optgroup label=\"Roles de Gesti√≥n\">\n              <option value={FUNCTIONAL_ROLES.EXECUTIVE}>\n                {FUNCTIONAL_ROLE_LABELS[FUNCTIONAL_ROLES.EXECUTIVE].icon} {FUNCTIONAL_ROLE_LABELS[FUNCTIONAL_ROLES.EXECUTIVE].label}\n              </option>\n              <option value={FUNCTIONAL_ROLES.SPONSOR}>\n                {FUNCTIONAL_ROLE_LABELS[FUNCTIONAL_ROLES.SPONSOR].icon} {FUNCTIONAL_ROLE_LABELS[FUNCTIONAL_ROLES.SPONSOR].label}\n              </option>\n              <option value={FUNCTIONAL_ROLES.PROJECT_MANAGER}>\n                {FUNCTIONAL_ROLE_LABELS[FUNCTIONAL_ROLES.PROJECT_MANAGER].icon} {FUNCTIONAL_ROLE_LABELS[FUNCTIONAL_ROLES.PROJECT_MANAGER].label}\n              </option>\n            </optgroup>\n            <optgroup label=\"Roles Especializados\">\n              <option value={FUNCTIONAL_ROLES.FINANCE_MANAGER}>\n                {FUNCTIONAL_ROLE_LABELS[FUNCTIONAL_ROLES.FINANCE_MANAGER].icon} {FUNCTIONAL_ROLE_LABELS[FUNCTIONAL_ROLES.FINANCE_MANAGER].label}\n              </option>\n              <option value={FUNCTIONAL_ROLES.QUALITY_MANAGER}>\n                {FUNCTIONAL_ROLE_LABELS[FUNCTIONAL_ROLES.QUALITY_MANAGER].icon} {FUNCTIONAL_ROLE_LABELS[FUNCTIONAL_ROLES.QUALITY_MANAGER].label}\n              </option>\n              <option value={FUNCTIONAL_ROLES.TECHNICAL_LEAD}>\n                {FUNCTIONAL_ROLE_LABELS[FUNCTIONAL_ROLES.TECHNICAL_LEAD].icon} {FUNCTIONAL_ROLE_LABELS[FUNCTIONAL_ROLES.TECHNICAL_LEAD].label}\n              </option>\n            </optgroup>\n            <optgroup label=\"Roles Operativos\">\n              <option value={FUNCTIONAL_ROLES.PMO_ASSISTANT}>\n                {FUNCTIONAL_ROLE_LABELS[FUNCTIONAL_ROLES.PMO_ASSISTANT].icon} {FUNCTIONAL_ROLE_LABELS[FUNCTIONAL_ROLES.PMO_ASSISTANT].label}\n              </option>\n              <option value={FUNCTIONAL_ROLES.PROJECT_COORDINATOR}>\n                {FUNCTIONAL_ROLE_LABELS[FUNCTIONAL_ROLES.PROJECT_COORDINATOR].icon} {FUNCTIONAL_ROLE_LABELS[FUNCTIONAL_ROLES.PROJECT_COORDINATOR].label}\n              </option>\n              <option value={FUNCTIONAL_ROLES.TEAM_MEMBER}>\n                {FUNCTIONAL_ROLE_LABELS[FUNCTIONAL_ROLES.TEAM_MEMBER].icon} {FUNCTIONAL_ROLE_LABELS[FUNCTIONAL_ROLES.TEAM_MEMBER].label}\n              </option>\n            </optgroup>\n            <optgroup label=\"Roles de Supervisi√≥n\">\n              <option value={FUNCTIONAL_ROLES.AUDITOR}>\n                {FUNCTIONAL_ROLE_LABELS[FUNCTIONAL_ROLES.AUDITOR].icon} {FUNCTIONAL_ROLE_LABELS[FUNCTIONAL_ROLES.AUDITOR].label}\n              </option>\n            </optgroup>\n          </select>\n          <p className=\"text-xs text-gray-500 mt-1\">\n            {value && FUNCTIONAL_ROLE_LABELS[value] \n              ? FUNCTIONAL_ROLE_LABELS[value].description \n              : 'El rol funcional determina los permisos en control de cambios'}\n          </p>\n        </div>\n      );\n    }\n    \n    // Visualizaci√≥n en la lista de miembros\n    if (editingMemberRole === member.id) {\n      return (\n        <div className=\"flex items-center space-x-2\">\n          <select\n            value={selectedFunctionalRole}\n            onChange={(e) => setSelectedFunctionalRole(e.target.value)}\n            className=\"px-2 py-1 border border-gray-300 rounded text-sm\"\n          >\n            <option value=\"\">Sin rol espec√≠fico</option>\n            <optgroup label=\"Gesti√≥n\">\n              <option value={FUNCTIONAL_ROLES.EXECUTIVE}>\n                {FUNCTIONAL_ROLE_LABELS[FUNCTIONAL_ROLES.EXECUTIVE].icon} {FUNCTIONAL_ROLE_LABELS[FUNCTIONAL_ROLES.EXECUTIVE].label}\n              </option>\n              <option value={FUNCTIONAL_ROLES.SPONSOR}>\n                {FUNCTIONAL_ROLE_LABELS[FUNCTIONAL_ROLES.SPONSOR].icon} {FUNCTIONAL_ROLE_LABELS[FUNCTIONAL_ROLES.SPONSOR].label}\n              </option>\n              <option value={FUNCTIONAL_ROLES.PROJECT_MANAGER}>\n                {FUNCTIONAL_ROLE_LABELS[FUNCTIONAL_ROLES.PROJECT_MANAGER].icon} {FUNCTIONAL_ROLE_LABELS[FUNCTIONAL_ROLES.PROJECT_MANAGER].label}\n              </option>\n            </optgroup>\n            <optgroup label=\"Especializados\">\n              <option value={FUNCTIONAL_ROLES.FINANCE_MANAGER}>\n                {FUNCTIONAL_ROLE_LABELS[FUNCTIONAL_ROLES.FINANCE_MANAGER].icon} {FUNCTIONAL_ROLE_LABELS[FUNCTIONAL_ROLES.FINANCE_MANAGER].label}\n              </option>\n              <option value={FUNCTIONAL_ROLES.QUALITY_MANAGER}>\n                {FUNCTIONAL_ROLE_LABELS[FUNCTIONAL_ROLES.QUALITY_MANAGER].icon} {FUNCTIONAL_ROLE_LABELS[FUNCTIONAL_ROLES.QUALITY_MANAGER].label}\n              </option>\n              <option value={FUNCTIONAL_ROLES.TECHNICAL_LEAD}>\n                {FUNCTIONAL_ROLE_LABELS[FUNCTIONAL_ROLES.TECHNICAL_LEAD].icon} {FUNCTIONAL_ROLE_LABELS[FUNCTIONAL_ROLES.TECHNICAL_LEAD].label}\n              </option>\n            </optgroup>\n            <optgroup label=\"Operativos\">\n              <option value={FUNCTIONAL_ROLES.PMO_ASSISTANT}>\n                {FUNCTIONAL_ROLE_LABELS[FUNCTIONAL_ROLES.PMO_ASSISTANT].icon} {FUNCTIONAL_ROLE_LABELS[FUNCTIONAL_ROLES.PMO_ASSISTANT].label}\n              </option>\n              <option value={FUNCTIONAL_ROLES.PROJECT_COORDINATOR}>\n                {FUNCTIONAL_ROLE_LABELS[FUNCTIONAL_ROLES.PROJECT_COORDINATOR].icon} {FUNCTIONAL_ROLE_LABELS[FUNCTIONAL_ROLES.PROJECT_COORDINATOR].label}\n              </option>\n              <option value={FUNCTIONAL_ROLES.TEAM_MEMBER}>\n                {FUNCTIONAL_ROLE_LABELS[FUNCTIONAL_ROLES.TEAM_MEMBER].icon} {FUNCTIONAL_ROLE_LABELS[FUNCTIONAL_ROLES.TEAM_MEMBER].label}\n              </option>\n            </optgroup>\n            <optgroup label=\"Supervisi√≥n\">\n              <option value={FUNCTIONAL_ROLES.AUDITOR}>\n                {FUNCTIONAL_ROLE_LABELS[FUNCTIONAL_ROLES.AUDITOR].icon} {FUNCTIONAL_ROLE_LABELS[FUNCTIONAL_ROLES.AUDITOR].label}\n              </option>\n            </optgroup>\n          </select>\n          <button\n            onClick={() => handleUpdateFunctionalRole(member.id, selectedFunctionalRole)}\n            className=\"px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700\"\n          >\n            ‚úì\n          </button>\n          <button\n            onClick={() => {\n              setEditingMemberRole(null);\n              setSelectedFunctionalRole('');\n            }}\n            className=\"px-3 py-1 bg-gray-300 text-gray-700 rounded text-sm hover:bg-gray-400\"\n          >\n            ‚úï\n          </button>\n        </div>\n      );\n    }\n    \n    // Mostrar rol funcional actual\n    const roleInfo = member.functional_role \n      ? FUNCTIONAL_ROLE_LABELS[member.functional_role]\n      : null;\n    \n    return (\n      <div className=\"flex items-center justify-between\">\n        <div>\n          {roleInfo ? (\n            <span className={`px-3 py-1 rounded-full text-xs font-medium ${roleInfo.badge}`}>\n              {roleInfo.icon} {roleInfo.label}\n            </span>\n          ) : (\n            <span className=\"text-gray-400 text-sm italic\">Sin rol espec√≠fico</span>\n          )}\n        </div>\n        {canEdit && member.status === 'active' && (\n          <button\n            onClick={() => {\n              setEditingMemberRole(member.id);\n              setSelectedFunctionalRole(member.functional_role || '');\n            }}\n            className=\"ml-2 text-blue-600 hover:text-blue-800 text-sm\"\n            title=\"Editar rol funcional\"\n          >\n            ‚úèÔ∏è\n          </button>\n        )}\n      </div>\n    );\n  };\n\n  // Abrir modal de edici√≥n de rol\n  const openEditRoleModal = (member) => {\n    setEditingMember(member);\n    setNewRole(member.role);\n    setShowEditRoleModal(true);\n  };\n\n  // Cargar miembros al montar el componente\n  useEffect(() => {\n    debugLog('OrganizationMembers', 'useEffect ejecut√°ndose');\n    loadOrganizationMembers();\n  }, [organizationId, useSupabase]);\n\n  if (!useSupabase) {\n    return (\n      <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-4\">\n        <div className=\"flex items-center\">\n          <span className=\"text-yellow-600 text-xl mr-3\">‚ö†Ô∏è</span>\n          <div>\n            <h3 className=\"text-yellow-800 font-medium\">Supabase no habilitado</h3>\n            <p className=\"text-yellow-700 text-sm\">Para compartir proyectos con otros usuarios, necesitas habilitar Supabase en la configuraci√≥n.</p>\n          </div>\n        </div>\n      </div>\n    );\n  }\n  \n  // Mostrar loading mientras detecta organizaci√≥n\n  if (orgLoading) {\n    return (\n      <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\n        <div className=\"flex items-center\">\n          <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600 mr-3\"></div>\n          <p className=\"text-blue-700\">Detectando organizaci√≥n...</p>\n        </div>\n      </div>\n    );\n  }\n  \n  // Mostrar error si no se pudo detectar organizaci√≥n\n  if (!organizationId || orgError) {\n    return (\n      <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\">\n        <div className=\"flex items-center\">\n          <span className=\"text-red-600 text-xl mr-3\">‚ùå</span>\n          <div>\n            <h3 className=\"text-red-800 font-medium\">No se detect√≥ organizaci√≥n</h3>\n            <p className=\"text-red-700 text-sm\">\n              {orgError || 'Este usuario no pertenece a ninguna organizaci√≥n. Por favor, solicita una invitaci√≥n.'}\n            </p>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  const getRoleColor = (role) => {\n    switch (role) {\n      case 'owner': return 'bg-purple-100 text-purple-800';\n      case 'admin': return 'bg-blue-100 text-blue-800';\n      case 'member': return 'bg-green-100 text-green-800';\n      default: return 'bg-gray-100 text-gray-800';\n    }\n  };\n\n  const getRoleLabel = (role) => {\n    // Mapear rol legacy a rol est√°ndar y obtener su etiqueta\n    const mappedRole = mapLegacyRole(role);\n    return ROLE_LABELS[mappedRole] || role;\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h2 className=\"text-2xl font-bold text-gray-800\">Miembros de la Organizaci√≥n</h2>\n          <p className=\"text-gray-600\">Gestiona qui√©n puede ver y editar los proyectos de tu organizaci√≥n</p>\n        </div>\n        {/* Solo mostrar bot√≥n invitar si es owner o admin */}\n        {canInvite ? (\n          <button\n            onClick={() => setShowInviteModal(true)}\n            className=\"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center space-x-2\"\n          >\n            <span>+</span>\n            <span>Invitar Miembro</span>\n          </button>\n        ) : (\n          <div className=\"text-sm text-gray-500 italic bg-gray-50 px-3 py-2 rounded-lg border\">\n            <span>üîí</span> Solo administradores pueden invitar miembros\n          </div>\n        )}\n      </div>\n\n      {/* Error Message */}\n      {error && (\n        <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\">\n          <div className=\"flex items-center\">\n            <span className=\"text-red-600 text-xl mr-3\">‚ùå</span>\n            <div>\n              <h3 className=\"text-red-800 font-medium\">Error</h3>\n              <p className=\"text-red-700 text-sm\">{error}</p>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Panel informativo sobre roles funcionales */}\n      <div className=\"mb-6 bg-blue-50 border border-blue-200 rounded-lg p-4\">\n        <div className=\"flex items-start\">\n          <span className=\"text-blue-500 text-xl mr-3\">‚ÑπÔ∏è</span>\n          <div>\n            <h4 className=\"font-semibold text-blue-800 mb-2\">\n              Roles Funcionales en Control de Cambios\n            </h4>\n            <p className=\"text-sm text-blue-700 mb-2\">\n              Los roles funcionales determinan los permisos espec√≠ficos en el m√≥dulo de Control de Cambios:\n            </p>\n            <ul className=\"text-sm text-blue-700 space-y-1\">\n              <li><strong>Ejecutivo/Sponsor:</strong> Aprueban cambios mayores sin l√≠mite</li>\n              <li><strong>Project Manager:</strong> Aprueban cambios hasta $25K / 15 d√≠as</li>\n              <li><strong>Gerente Financiero:</strong> Validan impacto financiero</li>\n              <li><strong>Miembro de Equipo:</strong> Solo pueden solicitar cambios</li>\n              <li><strong>Sin rol espec√≠fico:</strong> Permisos b√°sicos seg√∫n rol organizacional</li>\n            </ul>\n          </div>\n        </div>\n      </div>\n\n      {/* Invitaciones Pendientes */}\n      {invitations.length > 0 && (\n        <div className=\"bg-yellow-50 rounded-lg shadow-sm border border-yellow-200\">\n          <div className=\"p-4 border-b border-yellow-200\">\n            <h3 className=\"text-lg font-semibold text-yellow-800 flex items-center\">\n              <span className=\"mr-2\">‚è≥</span>\n              Invitaciones Pendientes ({invitations.length})\n            </h3>\n            <p className=\"text-sm text-yellow-700 mt-1\">\n              Estas personas fueron invitadas pero a√∫n no han aceptado\n            </p>\n          </div>\n          \n          <div className=\"divide-y divide-yellow-200\">\n            {invitations.map((invitation) => (\n              <div key={invitation.id} className=\"p-4\">\n                <div className=\"flex items-start justify-between\">\n                  {/* Informaci√≥n de la invitaci√≥n */}\n                  <div className=\"flex items-start space-x-4 flex-1\">\n                    <div className=\"w-12 h-12 bg-yellow-300 rounded-full flex items-center justify-center flex-shrink-0\">\n                      <span className=\"text-yellow-800 font-bold text-lg\">‚úâÔ∏è</span>\n                    </div>\n                    <div className=\"flex-1\">\n                      <div className=\"flex items-center space-x-2 mb-1\">\n                        <p className=\"font-semibold text-yellow-900 text-lg\">\n                          {invitation.user_email}\n                        </p>\n                        <span className=\"px-2 py-0.5 rounded-full text-xs font-medium bg-yellow-200 text-yellow-800\">\n                          ‚è≥ Pendiente\n                        </span>\n                      </div>\n                      \n                      <div className=\"space-y-1\">\n                        <p className=\"text-sm text-yellow-700\">\n                          <span className=\"font-medium\">Rol:</span> {getRoleLabel(invitation.role)}\n                        </p>\n                        \n                        {invitation.functional_role && (\n                          <p className=\"text-sm text-yellow-700\">\n                            <span className=\"font-medium\">Rol Funcional:</span>{' '}\n                            {FUNCTIONAL_ROLE_LABELS[invitation.functional_role]?.icon}{' '}\n                            {FUNCTIONAL_ROLE_LABELS[invitation.functional_role]?.label}\n                          </p>\n                        )}\n                        \n                        {invitation.invited_by && (\n                          <p className=\"text-xs text-yellow-600 mt-2\">\n                            Invitado por <span className=\"font-medium\">{invitation.invited_by}</span>\n                            {invitation.invited_at && (\n                              <span> el {new Date(invitation.invited_at).toLocaleDateString('es-MX', { \n                                year: 'numeric', \n                                month: 'long', \n                                day: 'numeric' \n                              })}</span>\n                            )}\n                          </p>\n                        )}\n                        \n                        {invitation.created_at && !invitation.invited_at && (\n                          <p className=\"text-xs text-yellow-600 mt-2\">\n                            Invitado el {new Date(invitation.created_at).toLocaleDateString('es-MX', { \n                              year: 'numeric', \n                              month: 'long', \n                              day: 'numeric' \n                            })}\n                          </p>\n                        )}\n                      </div>\n                    </div>\n                  </div>\n                  \n                  {/* Botones de acci√≥n */}\n                  {canRemoveMembers && (\n                    <div className=\"flex flex-col space-y-2 ml-4\">\n                      <button\n                        onClick={() => handleResendInvitation(invitation.id)}\n                        className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm font-medium flex items-center space-x-1 transition-colors\"\n                        title=\"Reenviar invitaci√≥n\"\n                      >\n                        <span>üîÑ</span>\n                        <span>Reenviar</span>\n                      </button>\n                      <button\n                        onClick={() => handleCancelInvitation(invitation.id, invitation.user_email)}\n                        className=\"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 text-sm font-medium flex items-center space-x-1 transition-colors\"\n                        title=\"Cancelar invitaci√≥n\"\n                      >\n                        <span>‚ùå</span>\n                        <span>Cancelar</span>\n                      </button>\n                    </div>\n                  )}\n                </div>\n              </div>\n            ))}\n          </div>\n        </div>\n      )}\n\n      {/* Lista de Miembros */}\n      <div className=\"bg-white rounded-lg shadow-sm border\">\n        <div className=\"p-4 border-b\">\n          <h3 className=\"text-lg font-semibold text-gray-800\">\n            Miembros Activos ({members.length})\n          </h3>\n        </div>\n        \n        <div className=\"divide-y divide-gray-200\">\n          {isLoading ? (\n            <div className=\"p-8 text-center\">\n              <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto\"></div>\n              <p className=\"text-gray-600 mt-2\">Cargando miembros...</p>\n            </div>\n          ) : members.length === 0 ? (\n            <div className=\"p-8 text-center text-gray-500\">\n              <span className=\"text-4xl mb-4 block\">üë•</span>\n              <p>No hay miembros en la organizaci√≥n</p>\n              <p className=\"text-sm\">Invita a otros usuarios para compartir tus proyectos</p>\n            </div>\n          ) : (\n            members.map((member) => (\n              <div key={member.id} className=\"p-4 flex items-center justify-between\">\n                <div className=\"flex items-center space-x-4\">\n                  <div className=\"w-10 h-10 bg-gray-200 rounded-full flex items-center justify-center\">\n                    <span className=\"text-gray-600 font-medium\">\n                      {member.user_email.charAt(0).toUpperCase()}\n                    </span>\n                  </div>\n                  <div>\n                    <p className=\"font-medium text-gray-900\">{member.user_email}</p>\n                    <p className=\"text-sm text-gray-500\">\n                      Se uni√≥ el {new Date(member.joined_at).toLocaleDateString()}\n                    </p>\n                  </div>\n                </div>\n                \n                <div className=\"flex items-center space-x-3\">\n                  <span className={`px-2 py-1 rounded-full text-xs font-medium ${getRoleColor(member.role)}`}>\n                    {getRoleLabel(member.role)}\n                  </span>\n                  \n                  {/* Rol Funcional */}\n                  <FunctionalRoleSelector member={member} />\n                  \n                  {/* Botones de acci√≥n para owners y admins */}\n                  <div className=\"flex items-center space-x-2\">\n                    {/* Bot√≥n editar rol */}\n                    {canEditMember(member) && (\n                      <button\n                        onClick={() => openEditRoleModal(member)}\n                        className=\"text-blue-600 hover:text-blue-800 text-sm\"\n                        title=\"Cambiar rol\"\n                      >\n                        ‚úèÔ∏è\n                      </button>\n                    )}\n                    \n                    {/* Bot√≥n eliminar */}\n                    {canRemoveMember(member) && (\n                      <button\n                        onClick={() => removeMember(member.id, member.user_email)}\n                        className=\"text-red-600 hover:text-red-800 text-sm\"\n                        title=\"Eliminar miembro\"\n                      >\n                        üóëÔ∏è\n                      </button>\n                    )}\n                  </div>\n                </div>\n              </div>\n            ))\n          )}\n        </div>\n      </div>\n\n      {/* Modal de Invitaci√≥n */}\n      {showInviteModal && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4\">\n          <div className=\"bg-white rounded-lg max-w-md w-full\">\n            <div className=\"p-6\">\n              <div className=\"flex justify-between items-center mb-4\">\n                <h2 className=\"text-xl font-bold\">Invitar Miembro</h2>\n                <button \n                  onClick={() => setShowInviteModal(false)}\n                  className=\"text-gray-500 hover:text-gray-700 text-xl\"\n                >\n                  ‚úï\n                </button>\n              </div>\n              \n              <form onSubmit={inviteMember}>\n                <div className=\"space-y-4\">\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                      Email del Usuario *\n                    </label>\n                    <input\n                      type=\"email\"\n                      className=\"w-full border rounded px-3 py-2\"\n                      value={inviteEmail}\n                      onChange={(e) => setInviteEmail(e.target.value)}\n                      placeholder=\"usuario@ejemplo.com\"\n                      required\n                    />\n                  </div>\n                  \n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                      Rol\n                    </label>\n                    <select\n                      className=\"w-full border rounded px-3 py-2\"\n                      value={inviteRole}\n                      onChange={(e) => setInviteRole(e.target.value)}\n                    >\n                      {ROLE_OPTIONS.map(option => (\n                        <option key={option.value} value={option.value}>\n                          {option.label}\n                        </option>\n                      ))}\n                    </select>\n                  </div>\n                </div>\n\n                {/* Selector de Rol Funcional */}\n                <FunctionalRoleSelector \n                  isInviteForm={true}\n                  value={inviteFunctionalRole}\n                  onChange={(value) => setInviteFunctionalRole(value)}\n                />\n                \n                <div className=\"flex justify-end space-x-3 mt-6\">\n                  <button\n                    type=\"button\"\n                    onClick={() => setShowInviteModal(false)}\n                    className=\"px-4 py-2 border border-gray-300 rounded text-gray-700 hover:bg-gray-50\"\n                    disabled={isLoading}\n                  >\n                    Cancelar\n                  </button>\n                  <button\n                    type=\"submit\"\n                    className=\"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50\"\n                    disabled={isLoading}\n                  >\n                    {isLoading ? 'Enviando...' : 'Invitar'}\n                  </button>\n                </div>\n              </form>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Modal para editar rol */}\n      {showEditRoleModal && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n          <div className=\"bg-white rounded-lg max-w-md w-full mx-4\">\n            <div className=\"p-6\">\n              <div className=\"flex justify-between items-center mb-4\">\n                <h2 className=\"text-xl font-bold\">Cambiar Rol de Usuario</h2>\n                <button \n                  onClick={() => {\n                    setShowEditRoleModal(false);\n                    setEditingMember(null);\n                    setNewRole('');\n                  }}\n                  className=\"text-gray-500 hover:text-gray-700 text-xl\"\n                >\n                  ‚úï\n                </button>\n              </div>\n\n              <div className=\"mb-4\">\n                <p className=\"text-gray-600 mb-2\">\n                  Cambiando rol de: <strong>{editingMember?.user_email}</strong>\n                </p>\n                <p className=\"text-sm text-gray-500\">\n                  Rol actual: <span className=\"font-medium\">{editingMember ? getRoleLabel(editingMember.role) : ''}</span>\n                </p>\n              </div>\n\n              <div className=\"mb-6\">\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Nuevo Rol\n                </label>\n                <select\n                  value={newRole}\n                  onChange={(e) => setNewRole(e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                >\n                  {ROLE_OPTIONS.map(option => (\n                    <option key={option.value} value={option.value}>\n                      {option.label}\n                    </option>\n                  ))}\n                </select>\n                \n                <div className=\"mt-2 text-xs text-gray-500\">\n                  <p><strong>Solo lectura:</strong> Puede ver proyectos pero no editarlos</p>\n                  <p><strong>Editar:</strong> Puede ver y modificar proyectos</p>\n                  <p><strong>Administrador:</strong> Puede gestionar usuarios y proyectos</p>\n                </div>\n              </div>\n\n              <div className=\"flex justify-end space-x-3\">\n                <button\n                  onClick={() => {\n                    setShowEditRoleModal(false);\n                    setEditingMember(null);\n                    setNewRole('');\n                  }}\n                  className=\"px-4 py-2 text-gray-600 border border-gray-300 rounded hover:bg-gray-50\"\n                  disabled={isLoading}\n                >\n                  Cancelar\n                </button>\n                <button\n                  onClick={editMemberRole}\n                  className=\"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50\"\n                  disabled={isLoading || !newRole || newRole === editingMember?.role}\n                >\n                  {isLoading ? 'Actualizando...' : 'Cambiar Rol'}\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n      \n      {/* Modal de invitaci√≥n mejorado */}\n      <InvitationModal\n        isOpen={showInvitationModal}\n        onClose={() => setShowInvitationModal(false)}\n        invitation={lastInvitation}\n      />\n\n      {/* Modal de Upgrade */}\n      <UpgradeModal\n        isOpen={showUpgradeModal}\n        onClose={() => setShowUpgradeModal(false)}\n        limitType={upgradeModalData.limitType}\n        currentPlan={upgradeModalData.currentPlan}\n        currentCount={upgradeModalData.currentCount}\n        maxCount={upgradeModalData.maxCount}\n        organizationId={organizationId}\n        onUpgradeSuccess={() => {\n          // Recargar miembros despu√©s de actualizar\n          loadOrganizationMembers();\n        }}\n      />\n    </div>\n  );\n};\n\nexport default OrganizationMembers;\n","import { useState, useEffect, useCallback } from 'react';\n\nconst useAuditLog = (projectId, useSupabase = false) => {\n  const [auditLog, setAuditLog] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n\n  // Cargar log de auditor√≠a desde localStorage o Supabase\n  useEffect(() => {\n    const loadAuditLog = async () => {\n      if (!projectId) return;\n      \n      setIsLoading(true);\n      \n      try {\n        if (useSupabase) {\n          // Cargar desde Supabase usando los nuevos m√©todos\n          const { default: supabaseService } = await import('../services/SupabaseService');\n          if (supabaseService.isAuthenticated()) {\n            const result = await supabaseService.loadAuditEvents(projectId);\n            if (result.success) {\n              setAuditLog(result.events);\n              console.log(`‚úÖ Logs de auditor√≠a cargados desde Supabase para proyecto ${projectId}: ${result.events.length} eventos`);\n            } else {\n              // Fallback a localStorage si Supabase falla\n              const savedLog = localStorage.getItem(`audit-log-${projectId}`);\n              if (savedLog) {\n                setAuditLog(JSON.parse(savedLog));\n              } else {\n                setAuditLog([]);\n              }\n            }\n          } else {\n            // Fallback a localStorage si no hay autenticaci√≥n\n            const savedLog = localStorage.getItem(`audit-log-${projectId}`);\n            if (savedLog) {\n              setAuditLog(JSON.parse(savedLog));\n            } else {\n              setAuditLog([]);\n            }\n          }\n        } else {\n          // Cargar desde localStorage\n          const savedLog = localStorage.getItem(`audit-log-${projectId}`);\n          if (savedLog) {\n            setAuditLog(JSON.parse(savedLog));\n          } else {\n            setAuditLog([]);\n          }\n        }\n      } catch (error) {\n        console.error('Error loading audit log:', error);\n        // Fallback a localStorage en caso de error\n        const savedLog = localStorage.getItem(`audit-log-${projectId}`);\n        if (savedLog) {\n          setAuditLog(JSON.parse(savedLog));\n        }\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    loadAuditLog();\n  }, [projectId, useSupabase]);\n\n  // Guardar log de auditor√≠a en localStorage y/o Supabase\n  const saveAuditLog = useCallback(async (log) => {\n    // Siempre guardar en localStorage como backup\n    localStorage.setItem(`audit-log-${projectId}`, JSON.stringify(log));\n\n    // NOTA: La sincronizaci√≥n con Supabase se hace individualmente por evento\n    // No enviamos toda la lista para evitar duplicados\n    console.log(`üìã Logs de auditor√≠a guardados en localStorage para proyecto ${projectId}: ${log.length} eventos`);\n  }, [projectId]);\n\n  // Guardar un evento individual en Supabase\n  const saveEventToSupabase = useCallback(async (event) => {\n    if (!useSupabase) return;\n\n    try {\n      const { default: supabaseService } = await import('../services/SupabaseService');\n      if (supabaseService.isAuthenticated()) {\n        // Guardar solo este evento espec√≠fico\n        const result = await supabaseService.saveAuditEvents(projectId, [event]);\n        if (result.success) {\n          console.log(`‚úÖ Evento de auditor√≠a guardado en Supabase: ${event.action}`);\n        } else {\n          console.warn('‚ö†Ô∏è Error guardando evento en Supabase:', result.error);\n        }\n      }\n    } catch (error) {\n      console.error('Error guardando evento en Supabase:', error);\n    }\n  }, [projectId, useSupabase]);\n\n  // Agregar evento de auditor√≠a\n  const addAuditEvent = useCallback(async (event) => {\n    const newEvent = {\n      id: crypto.randomUUID(), // Generar UUID v√°lido para Supabase\n      timestamp: new Date().toISOString(),\n      projectId,\n      ...event\n    };\n\n    setAuditLog(prevLog => {\n      const updatedLog = [newEvent, ...prevLog];\n      // Guardar de forma as√≠ncrona en localStorage\n      saveAuditLog(updatedLog);\n      return updatedLog;\n    });\n\n    // Guardar este evento espec√≠fico en Supabase\n    saveEventToSupabase(newEvent);\n\n    return newEvent;\n  }, [projectId, saveAuditLog, saveEventToSupabase]);\n\n  // Registrar cambio de estado del proyecto\n  const logProjectStatusChange = useCallback((previousStatus, newStatus, projectData) => {\n    addAuditEvent({\n      category: 'project-status',\n      action: 'status-changed',\n      description: `Estado del proyecto cambiado de \"${previousStatus}\" a \"${newStatus}\"`,\n      details: {\n        previousStatus,\n        newStatus,\n        projectName: projectData.name,\n        manager: projectData.manager,\n        budget: projectData.budget\n      },\n      severity: 'high',\n      user: projectData.manager || 'Sistema'\n    });\n  }, [addAuditEvent]);\n\n  // Registrar creaci√≥n de work package\n  const logWorkPackageCreated = useCallback((workPackage, projectData) => {\n    addAuditEvent({\n      category: 'work-package',\n      action: 'created',\n      description: `Work Package \"${workPackage.name}\" creado`,\n      details: {\n        workPackageId: workPackage.id,\n        name: workPackage.name,\n        budget: workPackage.budget,\n        status: workPackage.status\n      },\n      severity: 'medium',\n      user: projectData.manager || 'Sistema'\n    });\n  }, [addAuditEvent]);\n\n  // Registrar modificaci√≥n de work package\n  const logWorkPackageModified = useCallback((workPackage, changes, projectData) => {\n    addAuditEvent({\n      category: 'work-package',\n      action: 'modified',\n      description: `Work Package \"${workPackage.name}\" modificado`,\n      details: {\n        workPackageId: workPackage.id,\n        name: workPackage.name,\n        changes: Object.keys(changes),\n        previousValues: changes\n      },\n      severity: 'medium',\n      user: projectData.manager || 'Sistema'\n    });\n  }, [addAuditEvent]);\n\n  // Registrar creaci√≥n de riesgo\n  const logRiskCreated = useCallback((risk, projectData) => {\n    addAuditEvent({\n      category: 'risk',\n      action: 'created',\n      description: `Riesgo \"${risk.name}\" identificado`,\n      details: {\n        riskId: risk.id,\n        name: risk.name,\n        probability: risk.probability,\n        impact: risk.impact,\n        priority: risk.priority\n      },\n      severity: risk.priority === 'high' ? 'high' : 'medium',\n      user: projectData.manager || 'Sistema'\n    });\n  }, [addAuditEvent]);\n\n  // Registrar evento financiero\n  const logFinancialEvent = useCallback((type, item, projectData) => {\n    const eventMap = {\n      'purchase-order': {\n        action: 'created',\n        description: `Orden de Compra \"${item.description}\" creada`,\n        details: {\n          poId: item.id,\n          description: item.description,\n          amount: item.amount,\n          supplier: item.supplier\n        }\n      },\n      'advance': {\n        action: 'created',\n        description: `Anticipo \"${item.description}\" creado`,\n        details: {\n          advanceId: item.id,\n          description: item.description,\n          amount: item.amount,\n          recipient: item.recipient\n        }\n      },\n      'invoice': {\n        action: 'created',\n        description: `Factura \"${item.description}\" creada`,\n        details: {\n          invoiceId: item.id,\n          description: item.description,\n          amount: item.amount,\n          supplier: item.supplier\n        }\n      },\n      'contract': {\n        action: 'created',\n        description: `Contrato \"${item.name}\" creado`,\n        details: {\n          contractId: item.id,\n          name: item.name,\n          value: item.value,\n          contractor: item.contractor\n        }\n      }\n    };\n\n    const eventConfig = eventMap[type];\n    if (eventConfig) {\n      addAuditEvent({\n        category: 'financial',\n        action: eventConfig.action,\n        description: eventConfig.description,\n        details: eventConfig.details,\n        severity: 'high',\n        user: projectData.manager || 'Sistema'\n      });\n    }\n  }, [addAuditEvent]);\n\n  // Registrar asignaci√≥n de recursos\n  const logResourceAssignment = useCallback((assignment, projectData) => {\n    addAuditEvent({\n      category: 'resources',\n      action: 'assigned',\n      description: `Recurso asignado al proyecto`,\n      details: {\n        assignmentId: assignment.id,\n        resourceId: assignment.resourceId,\n        role: assignment.role,\n        allocation: assignment.allocation\n      },\n      severity: 'medium',\n      user: projectData.manager || 'Sistema'\n    });\n  }, [addAuditEvent]);\n\n  // Registrar creaci√≥n de tarea de minuta\n  const logMinutaTaskCreated = useCallback((minutaTask, projectData) => {\n    addAuditEvent({\n      category: 'minutes',\n      action: 'minute-task-created',\n      description: `Tarea de minuta \"${minutaTask.tarea}\" creada`,\n      details: {\n        taskId: minutaTask.id,\n        tarea: minutaTask.tarea,\n        responsable: minutaTask.responsable,\n        fecha: minutaTask.fecha,\n        hitoId: minutaTask.hitoId,\n        estatus: minutaTask.estatus\n      },\n      severity: 'medium',\n      user: projectData.manager || 'Sistema'\n    });\n  }, [addAuditEvent]);\n\n  // Registrar actualizaci√≥n de tarea de minuta\n  const logMinutaTaskUpdated = useCallback((minutaTask, changes, projectData) => {\n    addAuditEvent({\n      category: 'minutes',\n      action: 'minute-task-updated',\n      description: `Tarea de minuta \"${minutaTask.tarea}\" actualizada`,\n      details: {\n        taskId: minutaTask.id,\n        tarea: minutaTask.tarea,\n        changes: changes,\n        newStatus: minutaTask.estatus\n      },\n      severity: 'medium',\n      user: projectData.manager || 'Sistema'\n    });\n  }, [addAuditEvent]);\n\n  // Limpiar log de auditor√≠a\n  const clearAuditLog = useCallback(() => {\n    setAuditLog([]);\n    localStorage.removeItem(`audit-log-${projectId}`);\n  }, [projectId]);\n\n  // Exportar log de auditor√≠a\n  const exportAuditLog = useCallback(() => {\n    const exportData = {\n      projectId,\n      exportDate: new Date().toISOString(),\n      totalEvents: auditLog.length,\n      events: auditLog\n    };\n\n    const dataStr = JSON.stringify(exportData, null, 2);\n    const dataBlob = new Blob([dataStr], { type: 'application/json' });\n    \n    const url = URL.createObjectURL(dataBlob);\n    const link = document.createElement('a');\n    link.href = url;\n    link.download = `audit-log-${projectId}-${new Date().toISOString().split('T')[0]}.json`;\n    link.click();\n    URL.revokeObjectURL(url);\n  }, [auditLog, projectId]);\n\n  return {\n    auditLog,\n    isLoading,\n    addAuditEvent,\n    logProjectStatusChange,\n    logWorkPackageCreated,\n    logWorkPackageModified,\n    logRiskCreated,\n    logFinancialEvent,\n    logResourceAssignment,\n    logMinutaTaskCreated,\n    logMinutaTaskUpdated,\n    clearAuditLog,\n    exportAuditLog\n  };\n};\n\nexport default useAuditLog;\n"],"names":["ORG_ROLES","OWNER","ADMIN","MEMBER_WRITE","MEMBER_READ","FUNCTIONAL_ROLES","EXECUTIVE","SPONSOR","PROJECT_MANAGER","FINANCE_MANAGER","QUALITY_MANAGER","TECHNICAL_LEAD","PMO_ASSISTANT","PROJECT_COORDINATOR","TEAM_MEMBER","AUDITOR","FUNCTIONAL_ROLE_LABELS","label","description","icon","color","badge","CHANGE_PERMISSIONS_MATRIX","canCreate","canApprove","canReject","canImplement","canVoteInCCB","canAssign","canComment","canViewAll","approvalLimit","cost","Infinity","schedule","changeRole","level","default","getUserChangePermissions","orgRole","functionalRole","arguments","length","undefined","basePermissions","getFunctionalRoleLabel","_FUNCTIONAL_ROLE_LABE","supabaseUrl","process","supabaseAnonKey","supabase","createClient","_ref","isOpen","onClose","limitType","currentPlan","currentCount","maxCount","organizationId","onUpgradeSuccess","isUpgrading","setIsUpgrading","useState","paymentMode","setPaymentMode","messages","project","title","current","concat","benefit","user","message","_jsx","className","onClick","children","_jsxs","e","stopPropagation","width","height","viewBox","fill","cx","cy","r","d","x","y","rx","handleUpgrade","async","data","auth","getUser","userEmail","email","portfolioData","localStorage","getItem","organizationName","_portfolio$organizati","portfolio","JSON","parse","organization","name","console","log","error","functions","invoke","body","priceId","plan","Error","url","window","location","href","alert","handleStripeCheckout","confirm","userId","_portfolio$user","id","result","subscriptionService","changePlan","success","setTimeout","reload","handleSimulatedUpgrade","disabled","ROLES","ROLE_LABELS","ROLE_DESCRIPTIONS","ROLE_PERMISSIONS","canInvite","canEditRoles","canRemoveMembers","canEditProjects","canDeleteProjects","LEGACY_ROLE_MAPPING","ROLE_OPTIONS","value","mapLegacyRole","legacyRole","isValidRole","role","Object","values","includes","getRolePermissions","hasPermission","permission","options","fallbackFromProject","required","setOrganizationId","loading","setLoading","setError","useEffect","detectedOrgId","supabaseService","getCurrentOrganization","autoDetectedOrg","detectUserOrganization","errorMsg","err","detectOrganization","isValid","hasError","useRoleMapping","useMemo","mapRole","dbRole","validateRoleConsistency","members","issues","stats","total","valid","invalid","legacy","forEach","member","originalRole","mappedRole","push","user_email","issue","isConsistent","currentUser","isAuthenticated","useAuthUser","currentUserMembership","currentUserRole","isOwnerOrAdmin","isOwner","isAdmin","isMember","find","m","canEditMember","targetMember","canRemoveMember","targetMappedRole","initialState","showModal","isLoading","ACTIONS","inviteModalReducer","state","action","type","_objectSpread","payload","useInviteModal","dispatch","useReducer","actions","openModal","closeModal","setEmail","setRole","setFunctionalRole","resetForm","getAppUrl","path","baseUrl","envUrl","REACT_APP_BASE_URL","hostname","port","origin","getAppBaseUrl","cleanPath","startsWith","invitation","copied","setCopied","invitationUrl","encodeURIComponent","organization_id","readOnly","navigator","clipboard","writeText","textArea","document","createElement","appendChild","select","execCommand","removeChild","handleShareWhatsApp","open","handleShareEmail","subject","currentProject","useSupabase","onMemberAdded","setMembers","invitations","setInvitations","inviteModalState","inviteModalActions","showInviteModal","inviteEmail","inviteRole","inviteFunctionalRole","setShowInviteModal","show","setInviteEmail","setInviteRole","setInviteFunctionalRole","showEditRoleModal","setShowEditRoleModal","editingMember","setEditingMember","newRole","setNewRole","setIsLoading","showUpgradeModal","setShowUpgradeModal","upgradeModalData","setUpgradeModalData","editingMemberRole","setEditingMemberRole","selectedFunctionalRole","setSelectedFunctionalRole","showInvitationModal","setShowInvitationModal","lastInvitation","setLastInvitation","addAuditEvent","useAuditLog","orgLoading","orgError","useOrganizationId","logger","debug","hasCurrentProject","currentProjectOrgId","useCurrentUserPermissions","loadOrganizationMembers","warn","getCurrentUser","allMembers","allError","from","membersData","membersError","eq","order","ascending","activeMembers","filter","status","pendingInvitations","FunctionalRoleSelector","_ref2","_members$find","isInviteForm","onChange","_supabaseService$getC5","canEdit","target","memberId","newFunctionalRole","update","functional_role","updated_at","Date","toISOString","handleUpdateFunctionalRole","roleInfo","getRoleColor","getRoleLabel","map","_FUNCTIONAL_ROLE_LABE2","invited_by","invited_at","toLocaleDateString","year","month","day","created_at","inv","invitationId","registrationUrl","handleResendInvitation","delete","handleCancelInvitation","charAt","toUpperCase","joined_at","openEditRoleModal","memberEmail","memberToDelete","rolesError","tasksError","assigned_to","risksError","owner","key","parsedData","stringify","removeItem","sessionStorage","cacheError","_supabaseService$getC3","category","details","tablesCleaned","localCacheCleaned","severity","detailedMessage","removeMember","onSubmit","preventDefault","canAddUser","allowed","getUsageStats","subscriptionPlan","currentUsers","maxUsers","limitError","_supabaseService$getC","rlsTest","rlsError","existingMember","memberError","single","inviteResult","insertError","rpc","p_organization_id","p_user_email","p_role","p_functional_role","_supabaseService$getC2","placeholder","option","_supabaseService$getC4","oldRole","InvitationModal","UpgradeModal","projectId","auditLog","setAuditLog","loadAuditEvents","events","savedLog","loadAuditLog","saveAuditLog","useCallback","setItem","saveEventToSupabase","saveAuditEvents","event","newEvent","crypto","randomUUID","timestamp","prevLog","updatedLog","logProjectStatusChange","previousStatus","newStatus","projectData","projectName","manager","budget","logWorkPackageCreated","workPackage","workPackageId","logWorkPackageModified","changes","keys","previousValues","logRiskCreated","risk","riskId","probability","impact","priority","logFinancialEvent","item","eventConfig","poId","amount","supplier","advanceId","recipient","invoiceId","contractId","contractor","logResourceAssignment","assignment","assignmentId","resourceId","allocation","logMinutaTaskCreated","minutaTask","tarea","taskId","responsable","fecha","hitoId","estatus","logMinutaTaskUpdated","clearAuditLog","exportAuditLog","exportData","exportDate","totalEvents","dataStr","dataBlob","Blob","URL","createObjectURL","link","download","split","click","revokeObjectURL"],"sourceRoot":""}