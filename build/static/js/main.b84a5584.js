/*! For license information please see main.b84a5584.js.LICENSE.txt */
(()=>{"use strict";var e={11:function(e,t,r){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=a(r(427));class n extends s.default{eq(e,t){return this.url.searchParams.append(e,"eq.".concat(t)),this}neq(e,t){return this.url.searchParams.append(e,"neq.".concat(t)),this}gt(e,t){return this.url.searchParams.append(e,"gt.".concat(t)),this}gte(e,t){return this.url.searchParams.append(e,"gte.".concat(t)),this}lt(e,t){return this.url.searchParams.append(e,"lt.".concat(t)),this}lte(e,t){return this.url.searchParams.append(e,"lte.".concat(t)),this}like(e,t){return this.url.searchParams.append(e,"like.".concat(t)),this}likeAllOf(e,t){return this.url.searchParams.append(e,"like(all).{".concat(t.join(","),"}")),this}likeAnyOf(e,t){return this.url.searchParams.append(e,"like(any).{".concat(t.join(","),"}")),this}ilike(e,t){return this.url.searchParams.append(e,"ilike.".concat(t)),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,"ilike(all).{".concat(t.join(","),"}")),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,"ilike(any).{".concat(t.join(","),"}")),this}is(e,t){return this.url.searchParams.append(e,"is.".concat(t)),this}in(e,t){const r=Array.from(new Set(t)).map(e=>"string"===typeof e&&new RegExp("[,()]").test(e)?'"'.concat(e,'"'):"".concat(e)).join(",");return this.url.searchParams.append(e,"in.(".concat(r,")")),this}contains(e,t){return"string"===typeof t?this.url.searchParams.append(e,"cs.".concat(t)):Array.isArray(t)?this.url.searchParams.append(e,"cs.{".concat(t.join(","),"}")):this.url.searchParams.append(e,"cs.".concat(JSON.stringify(t))),this}containedBy(e,t){return"string"===typeof t?this.url.searchParams.append(e,"cd.".concat(t)):Array.isArray(t)?this.url.searchParams.append(e,"cd.{".concat(t.join(","),"}")):this.url.searchParams.append(e,"cd.".concat(JSON.stringify(t))),this}rangeGt(e,t){return this.url.searchParams.append(e,"sr.".concat(t)),this}rangeGte(e,t){return this.url.searchParams.append(e,"nxl.".concat(t)),this}rangeLt(e,t){return this.url.searchParams.append(e,"sl.".concat(t)),this}rangeLte(e,t){return this.url.searchParams.append(e,"nxr.".concat(t)),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,"adj.".concat(t)),this}overlaps(e,t){return"string"===typeof t?this.url.searchParams.append(e,"ov.".concat(t)):this.url.searchParams.append(e,"ov.{".concat(t.join(","),"}")),this}textSearch(e,t){let{config:r,type:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s="";"plain"===a?s="pl":"phrase"===a?s="ph":"websearch"===a&&(s="w");const n=void 0===r?"":"(".concat(r,")");return this.url.searchParams.append(e,"".concat(s,"fts").concat(n,".").concat(t)),this}match(e){return Object.entries(e).forEach(e=>{let[t,r]=e;this.url.searchParams.append(t,"eq.".concat(r))}),this}not(e,t,r){return this.url.searchParams.append(e,"not.".concat(t,".").concat(r)),this}or(e){let{foreignTable:t,referencedTable:r=t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=r?"".concat(r,".or"):"or";return this.url.searchParams.append(a,"(".concat(e,")")),this}filter(e,t,r){return this.url.searchParams.append(e,"".concat(t,".").concat(r)),this}}t.default=n},47:function(e,t,r){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=a(r(11));t.default=class{constructor(e,t){let{headers:r={},schema:a,fetch:s}=t;this.url=e,this.headers=new Headers(r),this.schema=a,this.fetch=s}select(e){let{head:t=!1,count:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=t?"HEAD":"GET";let n=!1;const i=(null!==e&&void 0!==e?e:"*").split("").map(e=>/\s/.test(e)&&!n?"":('"'===e&&(n=!n),e)).join("");return this.url.searchParams.set("select",i),r&&this.headers.append("Prefer","count=".concat(r)),new s.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e){let{count:t,defaultToNull:r=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var a;if(t&&this.headers.append("Prefer","count=".concat(t)),r||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>'"'.concat(e,'"'));this.url.searchParams.set("columns",e.join(","))}}return new s.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(a=this.fetch)&&void 0!==a?a:fetch})}upsert(e){let{onConflict:t,ignoreDuplicates:r=!1,count:a,defaultToNull:n=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var i;if(this.headers.append("Prefer","resolution=".concat(r?"ignore":"merge","-duplicates")),void 0!==t&&this.url.searchParams.set("on_conflict",t),a&&this.headers.append("Prefer","count=".concat(a)),n||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>'"'.concat(e,'"'));this.url.searchParams.set("columns",e.join(","))}}return new s.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(i=this.fetch)&&void 0!==i?i:fetch})}update(e){let{count:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var r;return t&&this.headers.append("Prefer","count=".concat(t)),new s.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(r=this.fetch)&&void 0!==r?r:fetch})}delete(){let{count:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t;return e&&this.headers.append("Prefer","count=".concat(e)),new s.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:null!==(t=this.fetch)&&void 0!==t?t:fetch})}}},53:function(e,t,r){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PostgrestError=t.PostgrestBuilder=t.PostgrestTransformBuilder=t.PostgrestFilterBuilder=t.PostgrestQueryBuilder=t.PostgrestClient=void 0;const s=a(r(71));t.PostgrestClient=s.default;const n=a(r(47));t.PostgrestQueryBuilder=n.default;const i=a(r(11));t.PostgrestFilterBuilder=i.default;const o=a(r(427));t.PostgrestTransformBuilder=o.default;const l=a(r(569));t.PostgrestBuilder=l.default;const c=a(r(732));t.PostgrestError=c.default,t.default={PostgrestClient:s.default,PostgrestQueryBuilder:n.default,PostgrestFilterBuilder:i.default,PostgrestTransformBuilder:o.default,PostgrestBuilder:l.default,PostgrestError:c.default}},71:function(e,t,r){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=a(r(47)),n=a(r(11));class i{constructor(e){let{headers:t={},schema:r,fetch:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.headers=new Headers(t),this.schemaName=r,this.fetch=a}from(e){const t=new URL("".concat(this.url,"/").concat(e));return new s.default(t,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new i(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{head:r=!1,get:a=!1,count:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var i;let o;const l=new URL("".concat(this.url,"/rpc/").concat(e));let c;r||a?(o=r?"HEAD":"GET",Object.entries(t).filter(e=>{let[t,r]=e;return void 0!==r}).map(e=>{let[t,r]=e;return[t,Array.isArray(r)?"{".concat(r.join(","),"}"):"".concat(r)]}).forEach(e=>{let[t,r]=e;l.searchParams.append(t,r)})):(o="POST",c=t);const d=new Headers(this.headers);return s&&d.set("Prefer","count=".concat(s)),new n.default({method:o,url:l,headers:d,schema:this.schemaName,body:c,fetch:null!==(i=this.fetch)&&void 0!==i?i:fetch})}}t.default=i},85:(e,t,r)=>{var a=r(340),s=r(950),n=r(119);function i(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function l(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(r=t.return),e=t.return}while(e)}return 3===t.tag?r:null}function c(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function d(e){if(l(e)!==e)throw Error(i(188))}function u(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=u(e)))return t;e=e.sibling}return null}var h=Object.assign,f=Symbol.for("react.element"),m=Symbol.for("react.transitional.element"),p=Symbol.for("react.portal"),g=Symbol.for("react.fragment"),x=Symbol.for("react.strict_mode"),b=Symbol.for("react.profiler"),v=Symbol.for("react.provider"),y=Symbol.for("react.consumer"),w=Symbol.for("react.context"),j=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),k=Symbol.for("react.suspense_list"),S=Symbol.for("react.memo"),E=Symbol.for("react.lazy");Symbol.for("react.scope");var T=Symbol.for("react.activity");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var _=Symbol.for("react.memo_cache_sentinel");Symbol.for("react.view_transition");var C=Symbol.iterator;function A(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=C&&e[C]||e["@@iterator"])?e:null}var D=Symbol.for("react.client.reference");function P(e){if(null==e)return null;if("function"===typeof e)return e.$$typeof===D?null:e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case g:return"Fragment";case b:return"Profiler";case x:return"StrictMode";case N:return"Suspense";case k:return"SuspenseList";case T:return"Activity"}if("object"===typeof e)switch(e.$$typeof){case p:return"Portal";case w:return(e.displayName||"Context")+".Provider";case y:return(e._context.displayName||"Context")+".Consumer";case j:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case S:return null!==(t=e.displayName||null)?t:P(e.type)||"Memo";case E:t=e._payload,e=e._init;try{return P(e(t))}catch(r){}}return null}var I=Array.isArray,O=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,R=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,M={pending:!1,data:null,method:null,action:null},F=[],L=-1;function z(e){return{current:e}}function B(e){0>L||(e.current=F[L],F[L]=null,L--)}function U(e,t){L++,F[L]=e.current,e.current=t}var W=z(null),H=z(null),V=z(null),G=z(null);function q(e,t){switch(U(V,t),U(H,e),U(W,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?nu(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=iu(t=nu(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}B(W),U(W,e)}function $(){B(W),B(H),B(V)}function K(e){null!==e.memoizedState&&U(G,e);var t=W.current,r=iu(t,e.type);t!==r&&(U(H,e),U(W,r))}function Y(e){H.current===e&&(B(W),B(H)),G.current===e&&(B(G),Yu._currentValue=M)}var J=Object.prototype.hasOwnProperty,X=a.unstable_scheduleCallback,Q=a.unstable_cancelCallback,Z=a.unstable_shouldYield,ee=a.unstable_requestPaint,te=a.unstable_now,re=a.unstable_getCurrentPriorityLevel,ae=a.unstable_ImmediatePriority,se=a.unstable_UserBlockingPriority,ne=a.unstable_NormalPriority,ie=a.unstable_LowPriority,oe=a.unstable_IdlePriority,le=a.log,ce=a.unstable_setDisableYieldValue,de=null,ue=null;function he(e){if("function"===typeof le&&ce(e),ue&&"function"===typeof ue.setStrictMode)try{ue.setStrictMode(de,e)}catch(t){}}var fe=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(me(e)/pe|0)|0},me=Math.log,pe=Math.LN2;var ge=256,xe=4194304;function be(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194048&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function ve(e,t,r){var a=e.pendingLanes;if(0===a)return 0;var s=0,n=e.suspendedLanes,i=e.pingedLanes;e=e.warmLanes;var o=134217727&a;return 0!==o?0!==(a=o&~n)?s=be(a):0!==(i&=o)?s=be(i):r||0!==(r=o&~e)&&(s=be(r)):0!==(o=a&~n)?s=be(o):0!==i?s=be(i):r||0!==(r=a&~e)&&(s=be(r)),0===s?0:0!==t&&t!==s&&0===(t&n)&&((n=s&-s)>=(r=t&-t)||32===n&&0!==(4194048&r))?t:s}function ye(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function we(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function je(){var e=ge;return 0===(4194048&(ge<<=1))&&(ge=256),e}function Ne(){var e=xe;return 0===(62914560&(xe<<=1))&&(xe=4194304),e}function ke(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Se(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Ee(e,t,r){e.pendingLanes|=t,e.suspendedLanes&=~t;var a=31-fe(t);e.entangledLanes|=t,e.entanglements[a]=1073741824|e.entanglements[a]|4194090&r}function Te(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var a=31-fe(r),s=1<<a;s&t|e[a]&t&&(e[a]|=t),r&=~s}}function _e(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Ce(e){return 2<(e&=-e)?8<e?0!==(134217727&e)?32:268435456:8:2}function Ae(){var e=R.p;return 0!==e?e:void 0===(e=window.event)?32:dh(e.type)}var De=Math.random().toString(36).slice(2),Pe="__reactFiber$"+De,Ie="__reactProps$"+De,Oe="__reactContainer$"+De,Re="__reactEvents$"+De,Me="__reactListeners$"+De,Fe="__reactHandles$"+De,Le="__reactResources$"+De,ze="__reactMarker$"+De;function Be(e){delete e[Pe],delete e[Ie],delete e[Re],delete e[Me],delete e[Fe]}function Ue(e){var t=e[Pe];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Oe]||r[Pe]){if(r=t.alternate,null!==t.child||null!==r&&null!==r.child)for(e=yu(e);null!==e;){if(r=e[Pe])return r;e=yu(e)}return t}r=(e=r).parentNode}return null}function We(e){if(e=e[Pe]||e[Oe]){var t=e.tag;if(5===t||6===t||13===t||26===t||27===t||3===t)return e}return null}function He(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(i(33))}function Ve(e){var t=e[Le];return t||(t=e[Le]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Ge(e){e[ze]=!0}var qe=new Set,$e={};function Ke(e,t){Ye(e,t),Ye(e+"Capture",t)}function Ye(e,t){for($e[e]=t,e=0;e<t.length;e++)qe.add(t[e])}var Je,Xe,Qe=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ze={},et={};function tt(e,t,r){if(s=t,J.call(et,s)||!J.call(Ze,s)&&(Qe.test(s)?et[s]=!0:(Ze[s]=!0,0)))if(null===r)e.removeAttribute(t);else{switch(typeof r){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var a=t.toLowerCase().slice(0,5);if("data-"!==a&&"aria-"!==a)return void e.removeAttribute(t)}e.setAttribute(t,""+r)}var s}function rt(e,t,r){if(null===r)e.removeAttribute(t);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+r)}}function at(e,t,r,a){if(null===a)e.removeAttribute(r);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(r)}e.setAttributeNS(t,r,""+a)}}function st(e){if(void 0===Je)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Je=t&&t[1]||"",Xe=-1<r.stack.indexOf("\n    at")?" (<anonymous>)":-1<r.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+Je+e+Xe}var nt=!1;function it(e,t){if(!e||nt)return"";nt=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var a={DetermineComponentFrameRoot:function(){try{if(t){var r=function(){throw Error()};if(Object.defineProperty(r.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(r,[])}catch(s){var a=s}Reflect.construct(e,[],r)}else{try{r.call()}catch(n){a=n}e.call(r.prototype)}}else{try{throw Error()}catch(i){a=i}(r=e())&&"function"===typeof r.catch&&r.catch(function(){})}}catch(Si){if(Si&&a&&"string"===typeof Si.stack)return[Si.stack,a.stack]}return[null,null]}};a.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var s=Object.getOwnPropertyDescriptor(a.DetermineComponentFrameRoot,"name");s&&s.configurable&&Object.defineProperty(a.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var n=a.DetermineComponentFrameRoot(),i=n[0],o=n[1];if(i&&o){var l=i.split("\n"),c=o.split("\n");for(s=a=0;a<l.length&&!l[a].includes("DetermineComponentFrameRoot");)a++;for(;s<c.length&&!c[s].includes("DetermineComponentFrameRoot");)s++;if(a===l.length||s===c.length)for(a=l.length-1,s=c.length-1;1<=a&&0<=s&&l[a]!==c[s];)s--;for(;1<=a&&0<=s;a--,s--)if(l[a]!==c[s]){if(1!==a||1!==s)do{if(a--,0>--s||l[a]!==c[s]){var d="\n"+l[a].replace(" at new "," at ");return e.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",e.displayName)),d}}while(1<=a&&0<=s);break}}}finally{nt=!1,Error.prepareStackTrace=r}return(r=e?e.displayName||e.name:"")?st(r):""}function ot(e){switch(e.tag){case 26:case 27:case 5:return st(e.type);case 16:return st("Lazy");case 13:return st("Suspense");case 19:return st("SuspenseList");case 0:case 15:return it(e.type,!1);case 11:return it(e.type.render,!1);case 1:return it(e.type,!0);case 31:return st("Activity");default:return""}}function lt(e){try{var t="";do{t+=ot(e),e=e.return}while(e);return t}catch(r){return"\nError generating stack: "+r.message+"\n"+r.stack}}function ct(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function dt(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function ut(e){e._valueTracker||(e._valueTracker=function(e){var t=dt(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),a=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof r&&"function"===typeof r.get&&"function"===typeof r.set){var s=r.get,n=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(e){a=""+e,n.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return a},setValue:function(e){a=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function ht(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),a="";return e&&(a=dt(e)?e.checked?"true":"false":e.value),(e=a)!==r&&(t.setValue(e),!0)}function ft(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var mt=/[\n"\\]/g;function pt(e){return e.replace(mt,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function gt(e,t,r,a,s,n,i,o){e.name="",null!=i&&"function"!==typeof i&&"symbol"!==typeof i&&"boolean"!==typeof i?e.type=i:e.removeAttribute("type"),null!=t?"number"===i?(0===t&&""===e.value||e.value!=t)&&(e.value=""+ct(t)):e.value!==""+ct(t)&&(e.value=""+ct(t)):"submit"!==i&&"reset"!==i||e.removeAttribute("value"),null!=t?bt(e,i,ct(t)):null!=r?bt(e,i,ct(r)):null!=a&&e.removeAttribute("value"),null==s&&null!=n&&(e.defaultChecked=!!n),null!=s&&(e.checked=s&&"function"!==typeof s&&"symbol"!==typeof s),null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o?e.name=""+ct(o):e.removeAttribute("name")}function xt(e,t,r,a,s,n,i,o){if(null!=n&&"function"!==typeof n&&"symbol"!==typeof n&&"boolean"!==typeof n&&(e.type=n),null!=t||null!=r){if(!("submit"!==n&&"reset"!==n||void 0!==t&&null!==t))return;r=null!=r?""+ct(r):"",t=null!=t?""+ct(t):r,o||t===e.value||(e.value=t),e.defaultValue=t}a="function"!==typeof(a=null!=a?a:s)&&"symbol"!==typeof a&&!!a,e.checked=o?e.checked:!!a,e.defaultChecked=!!a,null!=i&&"function"!==typeof i&&"symbol"!==typeof i&&"boolean"!==typeof i&&(e.name=i)}function bt(e,t,r){"number"===t&&ft(e.ownerDocument)===e||e.defaultValue===""+r||(e.defaultValue=""+r)}function vt(e,t,r,a){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&a&&(e[r].defaultSelected=!0)}else{for(r=""+ct(r),t=null,s=0;s<e.length;s++){if(e[s].value===r)return e[s].selected=!0,void(a&&(e[s].defaultSelected=!0));null!==t||e[s].disabled||(t=e[s])}null!==t&&(t.selected=!0)}}function yt(e,t,r){null==t||((t=""+ct(t))!==e.value&&(e.value=t),null!=r)?e.defaultValue=null!=r?""+ct(r):"":e.defaultValue!==t&&(e.defaultValue=t)}function wt(e,t,r,a){if(null==t){if(null!=a){if(null!=r)throw Error(i(92));if(I(a)){if(1<a.length)throw Error(i(93));a=a[0]}r=a}null==r&&(r=""),t=r}r=ct(t),e.defaultValue=r,(a=e.textContent)===r&&""!==a&&null!==a&&(e.value=a)}function jt(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&3===r.nodeType)return void(r.nodeValue=t)}e.textContent=t}var Nt=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function kt(e,t,r){var a=0===t.indexOf("--");null==r||"boolean"===typeof r||""===r?a?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":a?e.setProperty(t,r):"number"!==typeof r||0===r||Nt.has(t)?"float"===t?e.cssFloat=r:e[t]=(""+r).trim():e[t]=r+"px"}function St(e,t,r){if(null!=t&&"object"!==typeof t)throw Error(i(62));if(e=e.style,null!=r){for(var a in r)!r.hasOwnProperty(a)||null!=t&&t.hasOwnProperty(a)||(0===a.indexOf("--")?e.setProperty(a,""):"float"===a?e.cssFloat="":e[a]="");for(var s in t)a=t[s],t.hasOwnProperty(s)&&r[s]!==a&&kt(e,s,a)}else for(var n in t)t.hasOwnProperty(n)&&kt(e,n,t[n])}function Et(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Tt=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),_t=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ct(e){return _t.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var At=null;function Dt(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Pt=null,It=null;function Ot(e){var t=We(e);if(t&&(e=t.stateNode)){var r=e[Ie]||null;e:switch(e=t.stateNode,t.type){case"input":if(gt(e,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name),t=r.name,"radio"===r.type&&null!=t){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll('input[name="'+pt(""+t)+'"][type="radio"]'),t=0;t<r.length;t++){var a=r[t];if(a!==e&&a.form===e.form){var s=a[Ie]||null;if(!s)throw Error(i(90));gt(a,s.value,s.defaultValue,s.defaultValue,s.checked,s.defaultChecked,s.type,s.name)}}for(t=0;t<r.length;t++)(a=r[t]).form===e.form&&ht(a)}break e;case"textarea":yt(e,r.value,r.defaultValue);break e;case"select":null!=(t=r.value)&&vt(e,!!r.multiple,t,!1)}}}var Rt=!1;function Mt(e,t,r){if(Rt)return e(t,r);Rt=!0;try{return e(t)}finally{if(Rt=!1,(null!==Pt||null!==It)&&(Wc(),Pt&&(t=Pt,e=It,It=Pt=null,Ot(t),e)))for(t=0;t<e.length;t++)Ot(e[t])}}function Ft(e,t){var r=e.stateNode;if(null===r)return null;var a=r[Ie]||null;if(null===a)return null;r=a[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(a=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!a;break e;default:e=!1}if(e)return null;if(r&&"function"!==typeof r)throw Error(i(231,t,typeof r));return r}var Lt=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),zt=!1;if(Lt)try{var Bt={};Object.defineProperty(Bt,"passive",{get:function(){zt=!0}}),window.addEventListener("test",Bt,Bt),window.removeEventListener("test",Bt,Bt)}catch(Oh){zt=!1}var Ut=null,Wt=null,Ht=null;function Vt(){if(Ht)return Ht;var e,t,r=Wt,a=r.length,s="value"in Ut?Ut.value:Ut.textContent,n=s.length;for(e=0;e<a&&r[e]===s[e];e++);var i=a-e;for(t=1;t<=i&&r[a-t]===s[n-t];t++);return Ht=s.slice(e,1<t?1-t:void 0)}function Gt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function qt(){return!0}function $t(){return!1}function Kt(e){function t(t,r,a,s,n){for(var i in this._reactName=t,this._targetInst=a,this.type=r,this.nativeEvent=s,this.target=n,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(s):s[i]);return this.isDefaultPrevented=(null!=s.defaultPrevented?s.defaultPrevented:!1===s.returnValue)?qt:$t,this.isPropagationStopped=$t,this}return h(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=qt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=qt)},persist:function(){},isPersistent:qt}),t}var Yt,Jt,Xt,Qt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zt=Kt(Qt),er=h({},Qt,{view:0,detail:0}),tr=Kt(er),rr=h({},er,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fr,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Xt&&(Xt&&"mousemove"===e.type?(Yt=e.screenX-Xt.screenX,Jt=e.screenY-Xt.screenY):Jt=Yt=0,Xt=e),Yt)},movementY:function(e){return"movementY"in e?e.movementY:Jt}}),ar=Kt(rr),sr=Kt(h({},rr,{dataTransfer:0})),nr=Kt(h({},er,{relatedTarget:0})),ir=Kt(h({},Qt,{animationName:0,elapsedTime:0,pseudoElement:0})),or=Kt(h({},Qt,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),lr=Kt(h({},Qt,{data:0})),cr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},dr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ur={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function hr(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=ur[e])&&!!t[e]}function fr(){return hr}var mr=Kt(h({},er,{key:function(e){if(e.key){var t=cr[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Gt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?dr[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fr,charCode:function(e){return"keypress"===e.type?Gt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Gt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),pr=Kt(h({},rr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),gr=Kt(h({},er,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fr})),xr=Kt(h({},Qt,{propertyName:0,elapsedTime:0,pseudoElement:0})),br=Kt(h({},rr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),vr=Kt(h({},Qt,{newState:0,oldState:0})),yr=[9,13,27,32],wr=Lt&&"CompositionEvent"in window,jr=null;Lt&&"documentMode"in document&&(jr=document.documentMode);var Nr=Lt&&"TextEvent"in window&&!jr,kr=Lt&&(!wr||jr&&8<jr&&11>=jr),Sr=String.fromCharCode(32),Er=!1;function Tr(e,t){switch(e){case"keyup":return-1!==yr.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function _r(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Cr=!1;var Ar={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Dr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Ar[e.type]:"textarea"===t}function Pr(e,t,r,a){Pt?It?It.push(a):It=[a]:Pt=a,0<(t=Gd(t,"onChange")).length&&(r=new Zt("onChange","change",null,r,a),e.push({event:r,listeners:t}))}var Ir=null,Or=null;function Rr(e){Fd(e,0)}function Mr(e){if(ht(He(e)))return e}function Fr(e,t){if("change"===e)return t}var Lr=!1;if(Lt){var zr;if(Lt){var Br="oninput"in document;if(!Br){var Ur=document.createElement("div");Ur.setAttribute("oninput","return;"),Br="function"===typeof Ur.oninput}zr=Br}else zr=!1;Lr=zr&&(!document.documentMode||9<document.documentMode)}function Wr(){Ir&&(Ir.detachEvent("onpropertychange",Hr),Or=Ir=null)}function Hr(e){if("value"===e.propertyName&&Mr(Or)){var t=[];Pr(t,Or,e,Dt(e)),Mt(Rr,t)}}function Vr(e,t,r){"focusin"===e?(Wr(),Or=r,(Ir=t).attachEvent("onpropertychange",Hr)):"focusout"===e&&Wr()}function Gr(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Mr(Or)}function qr(e,t){if("click"===e)return Mr(t)}function $r(e,t){if("input"===e||"change"===e)return Mr(t)}var Kr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function Yr(e,t){if(Kr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var r=Object.keys(e),a=Object.keys(t);if(r.length!==a.length)return!1;for(a=0;a<r.length;a++){var s=r[a];if(!J.call(t,s)||!Kr(e[s],t[s]))return!1}return!0}function Jr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Xr(e,t){var r,a=Jr(e);for(e=0;a;){if(3===a.nodeType){if(r=e+a.textContent.length,e<=t&&r>=t)return{node:a,offset:t-e};e=r}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=Jr(a)}}function Qr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?Qr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function Zr(e){for(var t=ft((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var r="string"===typeof t.contentWindow.location.href}catch(a){r=!1}if(!r)break;t=ft((e=t.contentWindow).document)}return t}function ea(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var ta=Lt&&"documentMode"in document&&11>=document.documentMode,ra=null,aa=null,sa=null,na=!1;function ia(e,t,r){var a=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;na||null==ra||ra!==ft(a)||("selectionStart"in(a=ra)&&ea(a)?a={start:a.selectionStart,end:a.selectionEnd}:a={anchorNode:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset},sa&&Yr(sa,a)||(sa=a,0<(a=Gd(aa,"onSelect")).length&&(t=new Zt("onSelect","select",null,t,r),e.push({event:t,listeners:a}),t.target=ra)))}function oa(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var la={animationend:oa("Animation","AnimationEnd"),animationiteration:oa("Animation","AnimationIteration"),animationstart:oa("Animation","AnimationStart"),transitionrun:oa("Transition","TransitionRun"),transitionstart:oa("Transition","TransitionStart"),transitioncancel:oa("Transition","TransitionCancel"),transitionend:oa("Transition","TransitionEnd")},ca={},da={};function ua(e){if(ca[e])return ca[e];if(!la[e])return e;var t,r=la[e];for(t in r)if(r.hasOwnProperty(t)&&t in da)return ca[e]=r[t];return e}Lt&&(da=document.createElement("div").style,"AnimationEvent"in window||(delete la.animationend.animation,delete la.animationiteration.animation,delete la.animationstart.animation),"TransitionEvent"in window||delete la.transitionend.transition);var ha=ua("animationend"),fa=ua("animationiteration"),ma=ua("animationstart"),pa=ua("transitionrun"),ga=ua("transitionstart"),xa=ua("transitioncancel"),ba=ua("transitionend"),va=new Map,ya="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function wa(e,t){va.set(e,t),Ke(t,[e])}ya.push("scrollEnd");var ja=new WeakMap;function Na(e,t){if("object"===typeof e&&null!==e){var r=ja.get(e);return void 0!==r?r:(t={value:e,source:t,stack:lt(t)},ja.set(e,t),t)}return{value:e,source:t,stack:lt(t)}}var ka=[],Sa=0,Ea=0;function Ta(){for(var e=Sa,t=Ea=Sa=0;t<e;){var r=ka[t];ka[t++]=null;var a=ka[t];ka[t++]=null;var s=ka[t];ka[t++]=null;var n=ka[t];if(ka[t++]=null,null!==a&&null!==s){var i=a.pending;null===i?s.next=s:(s.next=i.next,i.next=s),a.pending=s}0!==n&&Da(r,s,n)}}function _a(e,t,r,a){ka[Sa++]=e,ka[Sa++]=t,ka[Sa++]=r,ka[Sa++]=a,Ea|=a,e.lanes|=a,null!==(e=e.alternate)&&(e.lanes|=a)}function Ca(e,t,r,a){return _a(e,t,r,a),Pa(e)}function Aa(e,t){return _a(e,null,null,t),Pa(e)}function Da(e,t,r){e.lanes|=r;var a=e.alternate;null!==a&&(a.lanes|=r);for(var s=!1,n=e.return;null!==n;)n.childLanes|=r,null!==(a=n.alternate)&&(a.childLanes|=r),22===n.tag&&(null===(e=n.stateNode)||1&e._visibility||(s=!0)),e=n,n=n.return;return 3===e.tag?(n=e.stateNode,s&&null!==t&&(s=31-fe(r),null===(a=(e=n.hiddenUpdates)[s])?e[s]=[t]:a.push(t),t.lane=536870912|r),n):null}function Pa(e){if(50<Ic)throw Ic=0,Oc=null,Error(i(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Ia={};function Oa(e,t,r,a){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ra(e,t,r,a){return new Oa(e,t,r,a)}function Ma(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Fa(e,t){var r=e.alternate;return null===r?((r=Ra(e.tag,t,e.key,e.mode)).elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=65011712&e.flags,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r.refCleanup=e.refCleanup,r}function La(e,t){e.flags&=65011714;var r=e.alternate;return null===r?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=r.childLanes,e.lanes=r.lanes,e.child=r.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=r.memoizedProps,e.memoizedState=r.memoizedState,e.updateQueue=r.updateQueue,e.type=r.type,t=r.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function za(e,t,r,a,s,n){var o=0;if(a=e,"function"===typeof e)Ma(e)&&(o=1);else if("string"===typeof e)o=function(e,t,r){if(1===r||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!==typeof t.precedence||"string"!==typeof t.href||""===t.href)break;return!0;case"link":if("string"!==typeof t.rel||"string"!==typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"===typeof t.precedence&&null==e);case"script":if(t.async&&"function"!==typeof t.async&&"symbol"!==typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"===typeof t.src)return!0}return!1}(e,r,W.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case T:return(e=Ra(31,r,t,s)).elementType=T,e.lanes=n,e;case g:return Ba(r.children,s,n,t);case x:o=8,s|=24;break;case b:return(e=Ra(12,r,t,2|s)).elementType=b,e.lanes=n,e;case N:return(e=Ra(13,r,t,s)).elementType=N,e.lanes=n,e;case k:return(e=Ra(19,r,t,s)).elementType=k,e.lanes=n,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case v:case w:o=10;break e;case y:o=9;break e;case j:o=11;break e;case S:o=14;break e;case E:o=16,a=null;break e}o=29,r=Error(i(130,null===e?"null":typeof e,"")),a=null}return(t=Ra(o,r,t,s)).elementType=e,t.type=a,t.lanes=n,t}function Ba(e,t,r,a){return(e=Ra(7,e,a,t)).lanes=r,e}function Ua(e,t,r){return(e=Ra(6,e,null,t)).lanes=r,e}function Wa(e,t,r){return(t=Ra(4,null!==e.children?e.children:[],e.key,t)).lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Ha=[],Va=0,Ga=null,qa=0,$a=[],Ka=0,Ya=null,Ja=1,Xa="";function Qa(e,t){Ha[Va++]=qa,Ha[Va++]=Ga,Ga=e,qa=t}function Za(e,t,r){$a[Ka++]=Ja,$a[Ka++]=Xa,$a[Ka++]=Ya,Ya=e;var a=Ja;e=Xa;var s=32-fe(a)-1;a&=~(1<<s),r+=1;var n=32-fe(t)+s;if(30<n){var i=s-s%5;n=(a&(1<<i)-1).toString(32),a>>=i,s-=i,Ja=1<<32-fe(t)+s|r<<s|a,Xa=n+e}else Ja=1<<n|r<<s|a,Xa=e}function es(e){null!==e.return&&(Qa(e,1),Za(e,1,0))}function ts(e){for(;e===Ga;)Ga=Ha[--Va],Ha[Va]=null,qa=Ha[--Va],Ha[Va]=null;for(;e===Ya;)Ya=$a[--Ka],$a[Ka]=null,Xa=$a[--Ka],$a[Ka]=null,Ja=$a[--Ka],$a[Ka]=null}var rs=null,as=null,ss=!1,ns=null,is=!1,os=Error(i(519));function ls(e){throw ms(Na(Error(i(418,"")),e)),os}function cs(e){var t=e.stateNode,r=e.type,a=e.memoizedProps;switch(t[Pe]=e,t[Ie]=a,r){case"dialog":Ld("cancel",t),Ld("close",t);break;case"iframe":case"object":case"embed":Ld("load",t);break;case"video":case"audio":for(r=0;r<Rd.length;r++)Ld(Rd[r],t);break;case"source":Ld("error",t);break;case"img":case"image":case"link":Ld("error",t),Ld("load",t);break;case"details":Ld("toggle",t);break;case"input":Ld("invalid",t),xt(t,a.value,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name,!0),ut(t);break;case"select":Ld("invalid",t);break;case"textarea":Ld("invalid",t),wt(t,a.value,a.defaultValue,a.children),ut(t)}"string"!==typeof(r=a.children)&&"number"!==typeof r&&"bigint"!==typeof r||t.textContent===""+r||!0===a.suppressHydrationWarning||Xd(t.textContent,r)?(null!=a.popover&&(Ld("beforetoggle",t),Ld("toggle",t)),null!=a.onScroll&&Ld("scroll",t),null!=a.onScrollEnd&&Ld("scrollend",t),null!=a.onClick&&(t.onclick=Qd),t=!0):t=!1,t||ls(e)}function ds(e){for(rs=e.return;rs;)switch(rs.tag){case 5:case 13:return void(is=!1);case 27:case 3:return void(is=!0);default:rs=rs.return}}function us(e){if(e!==rs)return!1;if(!ss)return ds(e),ss=!0,!1;var t,r=e.tag;if((t=3!==r&&27!==r)&&((t=5===r)&&(t=!("form"!==(t=e.type)&&"button"!==t)||ou(e.type,e.memoizedProps)),t=!t),t&&as&&ls(e),ds(e),13===r){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,r=0;e;){if(8===e.nodeType)if("/$"===(t=e.data)){if(0===r){as=bu(e.nextSibling);break e}r--}else"$"!==t&&"$!"!==t&&"$?"!==t||r++;e=e.nextSibling}as=null}}else 27===r?(r=as,mu(e.type)?(e=vu,vu=null,as=e):as=r):as=rs?bu(e.stateNode.nextSibling):null;return!0}function hs(){as=rs=null,ss=!1}function fs(){var e=ns;return null!==e&&(null===yc?yc=e:yc.push.apply(yc,e),ns=null),e}function ms(e){null===ns?ns=[e]:ns.push(e)}var ps=z(null),gs=null,xs=null;function bs(e,t,r){U(ps,t._currentValue),t._currentValue=r}function vs(e){e._currentValue=ps.current,B(ps)}function ys(e,t,r){for(;null!==e;){var a=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==a&&(a.childLanes|=t)):null!==a&&(a.childLanes&t)!==t&&(a.childLanes|=t),e===r)break;e=e.return}}function ws(e,t,r,a){var s=e.child;for(null!==s&&(s.return=e);null!==s;){var n=s.dependencies;if(null!==n){var o=s.child;n=n.firstContext;e:for(;null!==n;){var l=n;n=s;for(var c=0;c<t.length;c++)if(l.context===t[c]){n.lanes|=r,null!==(l=n.alternate)&&(l.lanes|=r),ys(n.return,r,e),a||(o=null);break e}n=l.next}}else if(18===s.tag){if(null===(o=s.return))throw Error(i(341));o.lanes|=r,null!==(n=o.alternate)&&(n.lanes|=r),ys(o,r,e),o=null}else o=s.child;if(null!==o)o.return=s;else for(o=s;null!==o;){if(o===e){o=null;break}if(null!==(s=o.sibling)){s.return=o.return,o=s;break}o=o.return}s=o}}function js(e,t,r,a){e=null;for(var s=t,n=!1;null!==s;){if(!n)if(0!==(524288&s.flags))n=!0;else if(0!==(262144&s.flags))break;if(10===s.tag){var o=s.alternate;if(null===o)throw Error(i(387));if(null!==(o=o.memoizedProps)){var l=s.type;Kr(s.pendingProps.value,o.value)||(null!==e?e.push(l):e=[l])}}else if(s===G.current){if(null===(o=s.alternate))throw Error(i(387));o.memoizedState.memoizedState!==s.memoizedState.memoizedState&&(null!==e?e.push(Yu):e=[Yu])}s=s.return}null!==e&&ws(t,e,r,a),t.flags|=262144}function Ns(e){for(e=e.firstContext;null!==e;){if(!Kr(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function ks(e){gs=e,xs=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function Ss(e){return Ts(gs,e)}function Es(e,t){return null===gs&&ks(e),Ts(e,t)}function Ts(e,t){var r=t._currentValue;if(t={context:t,memoizedValue:r,next:null},null===xs){if(null===e)throw Error(i(308));xs=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else xs=xs.next=t;return r}var _s="undefined"!==typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,r){e.push(r)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},Cs=a.unstable_scheduleCallback,As=a.unstable_NormalPriority,Ds={$$typeof:w,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ps(){return{controller:new _s,data:new Map,refCount:0}}function Is(e){e.refCount--,0===e.refCount&&Cs(As,function(){e.controller.abort()})}var Os=null,Rs=0,Ms=0,Fs=null;function Ls(){if(0===--Rs&&null!==Os){null!==Fs&&(Fs.status="fulfilled");var e=Os;Os=null,Ms=0,Fs=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var zs=O.S;O.S=function(e,t){"object"===typeof t&&null!==t&&"function"===typeof t.then&&function(e,t){if(null===Os){var r=Os=[];Rs=0,Ms=Ad(),Fs={status:"pending",value:void 0,then:function(e){r.push(e)}}}Rs++,t.then(Ls,Ls)}(0,t),null!==zs&&zs(e,t)};var Bs=z(null);function Us(){var e=Bs.current;return null!==e?e:sc.pooledCache}function Ws(e,t){U(Bs,null===t?Bs.current:t.pool)}function Hs(){var e=Us();return null===e?null:{parent:Ds._currentValue,pool:e}}var Vs=Error(i(460)),Gs=Error(i(474)),qs=Error(i(542)),$s={then:function(){}};function Ks(e){return"fulfilled"===(e=e.status)||"rejected"===e}function Ys(){}function Js(e,t,r){switch(void 0===(r=e[r])?e.push(t):r!==t&&(t.then(Ys,Ys),t=r),t.status){case"fulfilled":return t.value;case"rejected":throw Zs(e=t.reason),e;default:if("string"===typeof t.status)t.then(Ys,Ys);else{if(null!==(e=sc)&&100<e.shellSuspendCounter)throw Error(i(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var r=t;r.status="fulfilled",r.value=e}},function(e){if("pending"===t.status){var r=t;r.status="rejected",r.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw Zs(e=t.reason),e}throw Xs=t,Vs}}var Xs=null;function Qs(){if(null===Xs)throw Error(i(459));var e=Xs;return Xs=null,e}function Zs(e){if(e===Vs||e===qs)throw Error(i(483))}var en=!1;function tn(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function rn(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function an(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function sn(e,t,r){var a=e.updateQueue;if(null===a)return null;if(a=a.shared,0!==(2&ac)){var s=a.pending;return null===s?t.next=t:(t.next=s.next,s.next=t),a.pending=t,t=Pa(e),Da(e,null,r),t}return _a(e,a,t,r),Pa(e)}function nn(e,t,r){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194048&r))){var a=t.lanes;r|=a&=e.pendingLanes,t.lanes=r,Te(e,r)}}function on(e,t){var r=e.updateQueue,a=e.alternate;if(null!==a&&r===(a=a.updateQueue)){var s=null,n=null;if(null!==(r=r.firstBaseUpdate)){do{var i={lane:r.lane,tag:r.tag,payload:r.payload,callback:null,next:null};null===n?s=n=i:n=n.next=i,r=r.next}while(null!==r);null===n?s=n=t:n=n.next=t}else s=n=t;return r={baseState:a.baseState,firstBaseUpdate:s,lastBaseUpdate:n,shared:a.shared,callbacks:a.callbacks},void(e.updateQueue=r)}null===(e=r.lastBaseUpdate)?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}var ln=!1;function cn(){if(ln){if(null!==Fs)throw Fs}}function dn(e,t,r,a){ln=!1;var s=e.updateQueue;en=!1;var n=s.firstBaseUpdate,i=s.lastBaseUpdate,o=s.shared.pending;if(null!==o){s.shared.pending=null;var l=o,c=l.next;l.next=null,null===i?n=c:i.next=c,i=l;var d=e.alternate;null!==d&&((o=(d=d.updateQueue).lastBaseUpdate)!==i&&(null===o?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=l))}if(null!==n){var u=s.baseState;for(i=0,d=c=l=null,o=n;;){var f=-536870913&o.lane,m=f!==o.lane;if(m?(ic&f)===f:(a&f)===f){0!==f&&f===Ms&&(ln=!0),null!==d&&(d=d.next={lane:0,tag:o.tag,payload:o.payload,callback:null,next:null});e:{var p=e,g=o;f=t;var x=r;switch(g.tag){case 1:if("function"===typeof(p=g.payload)){u=p.call(x,u,f);break e}u=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(f="function"===typeof(p=g.payload)?p.call(x,u,f):p)||void 0===f)break e;u=h({},u,f);break e;case 2:en=!0}}null!==(f=o.callback)&&(e.flags|=64,m&&(e.flags|=8192),null===(m=s.callbacks)?s.callbacks=[f]:m.push(f))}else m={lane:f,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===d?(c=d=m,l=u):d=d.next=m,i|=f;if(null===(o=o.next)){if(null===(o=s.shared.pending))break;o=(m=o).next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}null===d&&(l=u),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=d,null===n&&(s.shared.lanes=0),mc|=i,e.lanes=i,e.memoizedState=u}}function un(e,t){if("function"!==typeof e)throw Error(i(191,e));e.call(t)}function hn(e,t){var r=e.callbacks;if(null!==r)for(e.callbacks=null,e=0;e<r.length;e++)un(r[e],t)}var fn=z(null),mn=z(0);function pn(e,t){U(mn,e=hc),U(fn,t),hc=e|t.baseLanes}function gn(){U(mn,hc),U(fn,fn.current)}function xn(){hc=mn.current,B(fn),B(mn)}var bn=0,vn=null,yn=null,wn=null,jn=!1,Nn=!1,kn=!1,Sn=0,En=0,Tn=null,_n=0;function Cn(){throw Error(i(321))}function An(e,t){if(null===t)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Kr(e[r],t[r]))return!1;return!0}function Dn(e,t,r,a,s,n){return bn=n,vn=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,O.H=null===e||null===e.memoizedState?qi:$i,kn=!1,n=r(a,s),kn=!1,Nn&&(n=In(t,r,a,s)),Pn(e),n}function Pn(e){O.H=Gi;var t=null!==yn&&null!==yn.next;if(bn=0,wn=yn=vn=null,jn=!1,En=0,Tn=null,t)throw Error(i(300));null===e||_o||null!==(e=e.dependencies)&&Ns(e)&&(_o=!0)}function In(e,t,r,a){vn=e;var s=0;do{if(Nn&&(Tn=null),En=0,Nn=!1,25<=s)throw Error(i(301));if(s+=1,wn=yn=null,null!=e.updateQueue){var n=e.updateQueue;n.lastEffect=null,n.events=null,n.stores=null,null!=n.memoCache&&(n.memoCache.index=0)}O.H=Ki,n=t(r,a)}while(Nn);return n}function On(){var e=O.H,t=e.useState()[0];return t="function"===typeof t.then?Bn(t):t,e=e.useState()[0],(null!==yn?yn.memoizedState:null)!==e&&(vn.flags|=1024),t}function Rn(){var e=0!==Sn;return Sn=0,e}function Mn(e,t,r){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r}function Fn(e){if(jn){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}jn=!1}bn=0,wn=yn=vn=null,Nn=!1,En=Sn=0,Tn=null}function Ln(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===wn?vn.memoizedState=wn=e:wn=wn.next=e,wn}function zn(){if(null===yn){var e=vn.alternate;e=null!==e?e.memoizedState:null}else e=yn.next;var t=null===wn?vn.memoizedState:wn.next;if(null!==t)wn=t,yn=e;else{if(null===e){if(null===vn.alternate)throw Error(i(467));throw Error(i(310))}e={memoizedState:(yn=e).memoizedState,baseState:yn.baseState,baseQueue:yn.baseQueue,queue:yn.queue,next:null},null===wn?vn.memoizedState=wn=e:wn=wn.next=e}return wn}function Bn(e){var t=En;return En+=1,null===Tn&&(Tn=[]),e=Js(Tn,e,t),t=vn,null===(null===wn?t.memoizedState:wn.next)&&(t=t.alternate,O.H=null===t||null===t.memoizedState?qi:$i),e}function Un(e){if(null!==e&&"object"===typeof e){if("function"===typeof e.then)return Bn(e);if(e.$$typeof===w)return Ss(e)}throw Error(i(438,String(e)))}function Wn(e){var t=null,r=vn.updateQueue;if(null!==r&&(t=r.memoCache),null==t){var a=vn.alternate;null!==a&&(null!==(a=a.updateQueue)&&(null!=(a=a.memoCache)&&(t={data:a.data.map(function(e){return e.slice()}),index:0})))}if(null==t&&(t={data:[],index:0}),null===r&&(r={lastEffect:null,events:null,stores:null,memoCache:null},vn.updateQueue=r),r.memoCache=t,void 0===(r=t.data[t.index]))for(r=t.data[t.index]=Array(e),a=0;a<e;a++)r[a]=_;return t.index++,r}function Hn(e,t){return"function"===typeof t?t(e):t}function Vn(e){return Gn(zn(),yn,e)}function Gn(e,t,r){var a=e.queue;if(null===a)throw Error(i(311));a.lastRenderedReducer=r;var s=e.baseQueue,n=a.pending;if(null!==n){if(null!==s){var o=s.next;s.next=n.next,n.next=o}t.baseQueue=s=n,a.pending=null}if(n=e.baseState,null===s)e.memoizedState=n;else{var l=o=null,c=null,d=t=s.next,u=!1;do{var h=-536870913&d.lane;if(h!==d.lane?(ic&h)===h:(bn&h)===h){var f=d.revertLane;if(0===f)null!==c&&(c=c.next={lane:0,revertLane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),h===Ms&&(u=!0);else{if((bn&f)===f){d=d.next,f===Ms&&(u=!0);continue}h={lane:0,revertLane:d.revertLane,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null},null===c?(l=c=h,o=n):c=c.next=h,vn.lanes|=f,mc|=f}h=d.action,kn&&r(n,h),n=d.hasEagerState?d.eagerState:r(n,h)}else f={lane:h,revertLane:d.revertLane,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null},null===c?(l=c=f,o=n):c=c.next=f,vn.lanes|=h,mc|=h;d=d.next}while(null!==d&&d!==t);if(null===c?o=n:c.next=l,!Kr(n,e.memoizedState)&&(_o=!0,u&&null!==(r=Fs)))throw r;e.memoizedState=n,e.baseState=o,e.baseQueue=c,a.lastRenderedState=n}return null===s&&(a.lanes=0),[e.memoizedState,a.dispatch]}function qn(e){var t=zn(),r=t.queue;if(null===r)throw Error(i(311));r.lastRenderedReducer=e;var a=r.dispatch,s=r.pending,n=t.memoizedState;if(null!==s){r.pending=null;var o=s=s.next;do{n=e(n,o.action),o=o.next}while(o!==s);Kr(n,t.memoizedState)||(_o=!0),t.memoizedState=n,null===t.baseQueue&&(t.baseState=n),r.lastRenderedState=n}return[n,a]}function $n(e,t,r){var a=vn,s=zn(),n=ss;if(n){if(void 0===r)throw Error(i(407));r=r()}else r=t();var o=!Kr((yn||s).memoizedState,r);if(o&&(s.memoizedState=r,_o=!0),s=s.queue,gi(2048,8,Jn.bind(null,a,s,e),[e]),s.getSnapshot!==t||o||null!==wn&&1&wn.memoizedState.tag){if(a.flags|=2048,fi(9,{destroy:void 0,resource:void 0},Yn.bind(null,a,s,r,t),null),null===sc)throw Error(i(349));n||0!==(124&bn)||Kn(a,t,r)}return r}function Kn(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},null===(t=vn.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},vn.updateQueue=t,t.stores=[e]):null===(r=t.stores)?t.stores=[e]:r.push(e)}function Yn(e,t,r,a){t.value=r,t.getSnapshot=a,Xn(t)&&Qn(e)}function Jn(e,t,r){return r(function(){Xn(t)&&Qn(e)})}function Xn(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Kr(e,r)}catch(a){return!0}}function Qn(e){var t=Aa(e,2);null!==t&&Fc(t,e,2)}function Zn(e){var t=Ln();if("function"===typeof e){var r=e;if(e=r(),kn){he(!0);try{r()}finally{he(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hn,lastRenderedState:e},t}function ei(e,t,r,a){return e.baseState=r,Gn(e,yn,"function"===typeof a?a:Hn)}function ti(e,t,r,a,s){if(Wi(e))throw Error(i(485));if(null!==(e=t.action)){var n={payload:s,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){n.listeners.push(e)}};null!==O.T?r(!0):n.isTransition=!1,a(n),null===(r=t.pending)?(n.next=t.pending=n,ri(t,n)):(n.next=r.next,t.pending=r.next=n)}}function ri(e,t){var r=t.action,a=t.payload,s=e.state;if(t.isTransition){var n=O.T,i={};O.T=i;try{var o=r(s,a),l=O.S;null!==l&&l(i,o),ai(e,t,o)}catch(c){ni(e,t,c)}finally{O.T=n}}else try{ai(e,t,n=r(s,a))}catch(d){ni(e,t,d)}}function ai(e,t,r){null!==r&&"object"===typeof r&&"function"===typeof r.then?r.then(function(r){si(e,t,r)},function(r){return ni(e,t,r)}):si(e,t,r)}function si(e,t,r){t.status="fulfilled",t.value=r,ii(t),e.state=r,null!==(t=e.pending)&&((r=t.next)===t?e.pending=null:(r=r.next,t.next=r,ri(e,r)))}function ni(e,t,r){var a=e.pending;if(e.pending=null,null!==a){a=a.next;do{t.status="rejected",t.reason=r,ii(t),t=t.next}while(t!==a)}e.action=null}function ii(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function oi(e,t){return t}function li(e,t){if(ss){var r=sc.formState;if(null!==r){e:{var a=vn;if(ss){if(as){t:{for(var s=as,n=is;8!==s.nodeType;){if(!n){s=null;break t}if(null===(s=bu(s.nextSibling))){s=null;break t}}s="F!"===(n=s.data)||"F"===n?s:null}if(s){as=bu(s.nextSibling),a="F!"===s.data;break e}}ls(a)}a=!1}a&&(t=r[0])}}return(r=Ln()).memoizedState=r.baseState=t,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:oi,lastRenderedState:t},r.queue=a,r=zi.bind(null,vn,a),a.dispatch=r,a=Zn(!1),n=Ui.bind(null,vn,!1,a.queue),s={state:t,dispatch:null,action:e,pending:null},(a=Ln()).queue=s,r=ti.bind(null,vn,s,n,r),s.dispatch=r,a.memoizedState=e,[t,r,!1]}function ci(e){return di(zn(),yn,e)}function di(e,t,r){if(t=Gn(e,t,oi)[0],e=Vn(Hn)[0],"object"===typeof t&&null!==t&&"function"===typeof t.then)try{var a=Bn(t)}catch(i){if(i===Vs)throw qs;throw i}else a=t;var s=(t=zn()).queue,n=s.dispatch;return r!==t.memoizedState&&(vn.flags|=2048,fi(9,{destroy:void 0,resource:void 0},ui.bind(null,s,r),null)),[a,n,e]}function ui(e,t){e.action=t}function hi(e){var t=zn(),r=yn;if(null!==r)return di(t,r,e);zn(),t=t.memoizedState;var a=(r=zn()).queue.dispatch;return r.memoizedState=e,[t,a,!1]}function fi(e,t,r,a){return e={tag:e,create:r,deps:a,inst:t,next:null},null===(t=vn.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},vn.updateQueue=t),null===(r=t.lastEffect)?t.lastEffect=e.next=e:(a=r.next,r.next=e,e.next=a,t.lastEffect=e),e}function mi(){return zn().memoizedState}function pi(e,t,r,a){var s=Ln();a=void 0===a?null:a,vn.flags|=e,s.memoizedState=fi(1|t,{destroy:void 0,resource:void 0},r,a)}function gi(e,t,r,a){var s=zn();a=void 0===a?null:a;var n=s.memoizedState.inst;null!==yn&&null!==a&&An(a,yn.memoizedState.deps)?s.memoizedState=fi(t,n,r,a):(vn.flags|=e,s.memoizedState=fi(1|t,n,r,a))}function xi(e,t){pi(8390656,8,e,t)}function bi(e,t){gi(2048,8,e,t)}function vi(e,t){return gi(4,2,e,t)}function yi(e,t){return gi(4,4,e,t)}function wi(e,t){if("function"===typeof t){e=e();var r=t(e);return function(){"function"===typeof r?r():t(null)}}if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function ji(e,t,r){r=null!==r&&void 0!==r?r.concat([e]):null,gi(4,4,wi.bind(null,t,e),r)}function Ni(){}function ki(e,t){var r=zn();t=void 0===t?null:t;var a=r.memoizedState;return null!==t&&An(t,a[1])?a[0]:(r.memoizedState=[e,t],e)}function Ei(e,t){var r=zn();t=void 0===t?null:t;var a=r.memoizedState;if(null!==t&&An(t,a[1]))return a[0];if(a=e(),kn){he(!0);try{e()}finally{he(!1)}}return r.memoizedState=[a,t],a}function Ti(e,t,r){return void 0===r||0!==(1073741824&bn)?e.memoizedState=t:(e.memoizedState=r,e=Mc(),vn.lanes|=e,mc|=e,r)}function _i(e,t,r,a){return Kr(r,t)?r:null!==fn.current?(e=Ti(e,r,a),Kr(e,t)||(_o=!0),e):0===(42&bn)?(_o=!0,e.memoizedState=r):(e=Mc(),vn.lanes|=e,mc|=e,t)}function Ci(e,t,r,a,s){var n=R.p;R.p=0!==n&&8>n?n:8;var i=O.T,o={};O.T=o,Ui(e,!1,t,r);try{var l=s(),c=O.S;if(null!==c&&c(o,l),null!==l&&"object"===typeof l&&"function"===typeof l.then){var d=function(e,t){var r=[],a={status:"pending",value:null,reason:null,then:function(e){r.push(e)}};return e.then(function(){a.status="fulfilled",a.value=t;for(var e=0;e<r.length;e++)(0,r[e])(t)},function(e){for(a.status="rejected",a.reason=e,e=0;e<r.length;e++)(0,r[e])(void 0)}),a}(l,a);Bi(e,t,d,Rc())}else Bi(e,t,a,Rc())}catch(u){Bi(e,t,{then:function(){},status:"rejected",reason:u},Rc())}finally{R.p=n,O.T=i}}function Ai(){}function Di(e,t,r,a){if(5!==e.tag)throw Error(i(476));var s=Pi(e).queue;Ci(e,s,t,M,null===r?Ai:function(){return Ii(e),r(a)})}function Pi(e){var t=e.memoizedState;if(null!==t)return t;var r={};return(t={memoizedState:M,baseState:M,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hn,lastRenderedState:M},next:null}).next={memoizedState:r,baseState:r,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hn,lastRenderedState:r},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function Ii(e){Bi(e,Pi(e).next.queue,{},Rc())}function Oi(){return Ss(Yu)}function Ri(){return zn().memoizedState}function Mi(){return zn().memoizedState}function Fi(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var r=Rc(),a=sn(t,e=an(r),r);return null!==a&&(Fc(a,t,r),nn(a,t,r)),t={cache:Ps()},void(e.payload=t)}t=t.return}}function Li(e,t,r){var a=Rc();r={lane:a,revertLane:0,action:r,hasEagerState:!1,eagerState:null,next:null},Wi(e)?Hi(t,r):null!==(r=Ca(e,t,r,a))&&(Fc(r,e,a),Vi(r,t,a))}function zi(e,t,r){Bi(e,t,r,Rc())}function Bi(e,t,r,a){var s={lane:a,revertLane:0,action:r,hasEagerState:!1,eagerState:null,next:null};if(Wi(e))Hi(t,s);else{var n=e.alternate;if(0===e.lanes&&(null===n||0===n.lanes)&&null!==(n=t.lastRenderedReducer))try{var i=t.lastRenderedState,o=n(i,r);if(s.hasEagerState=!0,s.eagerState=o,Kr(o,i))return _a(e,t,s,0),null===sc&&Ta(),!1}catch(l){}if(null!==(r=Ca(e,t,s,a)))return Fc(r,e,a),Vi(r,t,a),!0}return!1}function Ui(e,t,r,a){if(a={lane:2,revertLane:Ad(),action:a,hasEagerState:!1,eagerState:null,next:null},Wi(e)){if(t)throw Error(i(479))}else null!==(t=Ca(e,r,a,2))&&Fc(t,e,2)}function Wi(e){var t=e.alternate;return e===vn||null!==t&&t===vn}function Hi(e,t){Nn=jn=!0;var r=e.pending;null===r?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Vi(e,t,r){if(0!==(4194048&r)){var a=t.lanes;r|=a&=e.pendingLanes,t.lanes=r,Te(e,r)}}var Gi={readContext:Ss,use:Un,useCallback:Cn,useContext:Cn,useEffect:Cn,useImperativeHandle:Cn,useLayoutEffect:Cn,useInsertionEffect:Cn,useMemo:Cn,useReducer:Cn,useRef:Cn,useState:Cn,useDebugValue:Cn,useDeferredValue:Cn,useTransition:Cn,useSyncExternalStore:Cn,useId:Cn,useHostTransitionStatus:Cn,useFormState:Cn,useActionState:Cn,useOptimistic:Cn,useMemoCache:Cn,useCacheRefresh:Cn},qi={readContext:Ss,use:Un,useCallback:function(e,t){return Ln().memoizedState=[e,void 0===t?null:t],e},useContext:Ss,useEffect:xi,useImperativeHandle:function(e,t,r){r=null!==r&&void 0!==r?r.concat([e]):null,pi(4194308,4,wi.bind(null,t,e),r)},useLayoutEffect:function(e,t){return pi(4194308,4,e,t)},useInsertionEffect:function(e,t){pi(4,2,e,t)},useMemo:function(e,t){var r=Ln();t=void 0===t?null:t;var a=e();if(kn){he(!0);try{e()}finally{he(!1)}}return r.memoizedState=[a,t],a},useReducer:function(e,t,r){var a=Ln();if(void 0!==r){var s=r(t);if(kn){he(!0);try{r(t)}finally{he(!1)}}}else s=t;return a.memoizedState=a.baseState=s,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:s},a.queue=e,e=e.dispatch=Li.bind(null,vn,e),[a.memoizedState,e]},useRef:function(e){return e={current:e},Ln().memoizedState=e},useState:function(e){var t=(e=Zn(e)).queue,r=zi.bind(null,vn,t);return t.dispatch=r,[e.memoizedState,r]},useDebugValue:Ni,useDeferredValue:function(e,t){return Ti(Ln(),e,t)},useTransition:function(){var e=Zn(!1);return e=Ci.bind(null,vn,e.queue,!0,!1),Ln().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,r){var a=vn,s=Ln();if(ss){if(void 0===r)throw Error(i(407));r=r()}else{if(r=t(),null===sc)throw Error(i(349));0!==(124&ic)||Kn(a,t,r)}s.memoizedState=r;var n={value:r,getSnapshot:t};return s.queue=n,xi(Jn.bind(null,a,n,e),[e]),a.flags|=2048,fi(9,{destroy:void 0,resource:void 0},Yn.bind(null,a,n,r,t),null),r},useId:function(){var e=Ln(),t=sc.identifierPrefix;if(ss){var r=Xa;t="\xab"+t+"R"+(r=(Ja&~(1<<32-fe(Ja)-1)).toString(32)+r),0<(r=Sn++)&&(t+="H"+r.toString(32)),t+="\xbb"}else t="\xab"+t+"r"+(r=_n++).toString(32)+"\xbb";return e.memoizedState=t},useHostTransitionStatus:Oi,useFormState:li,useActionState:li,useOptimistic:function(e){var t=Ln();t.memoizedState=t.baseState=e;var r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=r,t=Ui.bind(null,vn,!0,r),r.dispatch=t,[e,t]},useMemoCache:Wn,useCacheRefresh:function(){return Ln().memoizedState=Fi.bind(null,vn)}},$i={readContext:Ss,use:Un,useCallback:ki,useContext:Ss,useEffect:bi,useImperativeHandle:ji,useInsertionEffect:vi,useLayoutEffect:yi,useMemo:Ei,useReducer:Vn,useRef:mi,useState:function(){return Vn(Hn)},useDebugValue:Ni,useDeferredValue:function(e,t){return _i(zn(),yn.memoizedState,e,t)},useTransition:function(){var e=Vn(Hn)[0],t=zn().memoizedState;return["boolean"===typeof e?e:Bn(e),t]},useSyncExternalStore:$n,useId:Ri,useHostTransitionStatus:Oi,useFormState:ci,useActionState:ci,useOptimistic:function(e,t){return ei(zn(),0,e,t)},useMemoCache:Wn,useCacheRefresh:Mi},Ki={readContext:Ss,use:Un,useCallback:ki,useContext:Ss,useEffect:bi,useImperativeHandle:ji,useInsertionEffect:vi,useLayoutEffect:yi,useMemo:Ei,useReducer:qn,useRef:mi,useState:function(){return qn(Hn)},useDebugValue:Ni,useDeferredValue:function(e,t){var r=zn();return null===yn?Ti(r,e,t):_i(r,yn.memoizedState,e,t)},useTransition:function(){var e=qn(Hn)[0],t=zn().memoizedState;return["boolean"===typeof e?e:Bn(e),t]},useSyncExternalStore:$n,useId:Ri,useHostTransitionStatus:Oi,useFormState:hi,useActionState:hi,useOptimistic:function(e,t){var r=zn();return null!==yn?ei(r,0,e,t):(r.baseState=e,[e,r.queue.dispatch])},useMemoCache:Wn,useCacheRefresh:Mi},Yi=null,Ji=0;function Xi(e){var t=Ji;return Ji+=1,null===Yi&&(Yi=[]),Js(Yi,e,t)}function Qi(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function Zi(e,t){if(t.$$typeof===f)throw Error(i(525));throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function eo(e){return(0,e._init)(e._payload)}function to(e){function t(t,r){if(e){var a=t.deletions;null===a?(t.deletions=[r],t.flags|=16):a.push(r)}}function r(r,a){if(!e)return null;for(;null!==a;)t(r,a),a=a.sibling;return null}function a(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function s(e,t){return(e=Fa(e,t)).index=0,e.sibling=null,e}function n(t,r,a){return t.index=a,e?null!==(a=t.alternate)?(a=a.index)<r?(t.flags|=67108866,r):a:(t.flags|=67108866,r):(t.flags|=1048576,r)}function o(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function l(e,t,r,a){return null===t||6!==t.tag?((t=Ua(r,e.mode,a)).return=e,t):((t=s(t,r)).return=e,t)}function c(e,t,r,a){var n=r.type;return n===g?u(e,t,r.props.children,a,r.key):null!==t&&(t.elementType===n||"object"===typeof n&&null!==n&&n.$$typeof===E&&eo(n)===t.type)?(Qi(t=s(t,r.props),r),t.return=e,t):(Qi(t=za(r.type,r.key,r.props,null,e.mode,a),r),t.return=e,t)}function d(e,t,r,a){return null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation?((t=Wa(r,e.mode,a)).return=e,t):((t=s(t,r.children||[])).return=e,t)}function u(e,t,r,a,n){return null===t||7!==t.tag?((t=Ba(r,e.mode,a,n)).return=e,t):((t=s(t,r)).return=e,t)}function h(e,t,r){if("string"===typeof t&&""!==t||"number"===typeof t||"bigint"===typeof t)return(t=Ua(""+t,e.mode,r)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case m:return Qi(r=za(t.type,t.key,t.props,null,e.mode,r),t),r.return=e,r;case p:return(t=Wa(t,e.mode,r)).return=e,t;case E:return h(e,t=(0,t._init)(t._payload),r)}if(I(t)||A(t))return(t=Ba(t,e.mode,r,null)).return=e,t;if("function"===typeof t.then)return h(e,Xi(t),r);if(t.$$typeof===w)return h(e,Es(e,t),r);Zi(e,t)}return null}function f(e,t,r,a){var s=null!==t?t.key:null;if("string"===typeof r&&""!==r||"number"===typeof r||"bigint"===typeof r)return null!==s?null:l(e,t,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case m:return r.key===s?c(e,t,r,a):null;case p:return r.key===s?d(e,t,r,a):null;case E:return f(e,t,r=(s=r._init)(r._payload),a)}if(I(r)||A(r))return null!==s?null:u(e,t,r,a,null);if("function"===typeof r.then)return f(e,t,Xi(r),a);if(r.$$typeof===w)return f(e,t,Es(e,r),a);Zi(e,r)}return null}function x(e,t,r,a,s){if("string"===typeof a&&""!==a||"number"===typeof a||"bigint"===typeof a)return l(t,e=e.get(r)||null,""+a,s);if("object"===typeof a&&null!==a){switch(a.$$typeof){case m:return c(t,e=e.get(null===a.key?r:a.key)||null,a,s);case p:return d(t,e=e.get(null===a.key?r:a.key)||null,a,s);case E:return x(e,t,r,a=(0,a._init)(a._payload),s)}if(I(a)||A(a))return u(t,e=e.get(r)||null,a,s,null);if("function"===typeof a.then)return x(e,t,r,Xi(a),s);if(a.$$typeof===w)return x(e,t,r,Es(t,a),s);Zi(t,a)}return null}function b(l,c,d,u){if("object"===typeof d&&null!==d&&d.type===g&&null===d.key&&(d=d.props.children),"object"===typeof d&&null!==d){switch(d.$$typeof){case m:e:{for(var v=d.key;null!==c;){if(c.key===v){if((v=d.type)===g){if(7===c.tag){r(l,c.sibling),(u=s(c,d.props.children)).return=l,l=u;break e}}else if(c.elementType===v||"object"===typeof v&&null!==v&&v.$$typeof===E&&eo(v)===c.type){r(l,c.sibling),Qi(u=s(c,d.props),d),u.return=l,l=u;break e}r(l,c);break}t(l,c),c=c.sibling}d.type===g?((u=Ba(d.props.children,l.mode,u,d.key)).return=l,l=u):(Qi(u=za(d.type,d.key,d.props,null,l.mode,u),d),u.return=l,l=u)}return o(l);case p:e:{for(v=d.key;null!==c;){if(c.key===v){if(4===c.tag&&c.stateNode.containerInfo===d.containerInfo&&c.stateNode.implementation===d.implementation){r(l,c.sibling),(u=s(c,d.children||[])).return=l,l=u;break e}r(l,c);break}t(l,c),c=c.sibling}(u=Wa(d,l.mode,u)).return=l,l=u}return o(l);case E:return b(l,c,d=(v=d._init)(d._payload),u)}if(I(d))return function(s,i,o,l){for(var c=null,d=null,u=i,m=i=0,p=null;null!==u&&m<o.length;m++){u.index>m?(p=u,u=null):p=u.sibling;var g=f(s,u,o[m],l);if(null===g){null===u&&(u=p);break}e&&u&&null===g.alternate&&t(s,u),i=n(g,i,m),null===d?c=g:d.sibling=g,d=g,u=p}if(m===o.length)return r(s,u),ss&&Qa(s,m),c;if(null===u){for(;m<o.length;m++)null!==(u=h(s,o[m],l))&&(i=n(u,i,m),null===d?c=u:d.sibling=u,d=u);return ss&&Qa(s,m),c}for(u=a(u);m<o.length;m++)null!==(p=x(u,s,m,o[m],l))&&(e&&null!==p.alternate&&u.delete(null===p.key?m:p.key),i=n(p,i,m),null===d?c=p:d.sibling=p,d=p);return e&&u.forEach(function(e){return t(s,e)}),ss&&Qa(s,m),c}(l,c,d,u);if(A(d)){if("function"!==typeof(v=A(d)))throw Error(i(150));return function(s,o,l,c){if(null==l)throw Error(i(151));for(var d=null,u=null,m=o,p=o=0,g=null,b=l.next();null!==m&&!b.done;p++,b=l.next()){m.index>p?(g=m,m=null):g=m.sibling;var v=f(s,m,b.value,c);if(null===v){null===m&&(m=g);break}e&&m&&null===v.alternate&&t(s,m),o=n(v,o,p),null===u?d=v:u.sibling=v,u=v,m=g}if(b.done)return r(s,m),ss&&Qa(s,p),d;if(null===m){for(;!b.done;p++,b=l.next())null!==(b=h(s,b.value,c))&&(o=n(b,o,p),null===u?d=b:u.sibling=b,u=b);return ss&&Qa(s,p),d}for(m=a(m);!b.done;p++,b=l.next())null!==(b=x(m,s,p,b.value,c))&&(e&&null!==b.alternate&&m.delete(null===b.key?p:b.key),o=n(b,o,p),null===u?d=b:u.sibling=b,u=b);return e&&m.forEach(function(e){return t(s,e)}),ss&&Qa(s,p),d}(l,c,d=v.call(d),u)}if("function"===typeof d.then)return b(l,c,Xi(d),u);if(d.$$typeof===w)return b(l,c,Es(l,d),u);Zi(l,d)}return"string"===typeof d&&""!==d||"number"===typeof d||"bigint"===typeof d?(d=""+d,null!==c&&6===c.tag?(r(l,c.sibling),(u=s(c,d)).return=l,l=u):(r(l,c),(u=Ua(d,l.mode,u)).return=l,l=u),o(l)):r(l,c)}return function(e,t,r,a){try{Ji=0;var s=b(e,t,r,a);return Yi=null,s}catch(i){if(i===Vs||i===qs)throw i;var n=Ra(29,i,null,e.mode);return n.lanes=a,n.return=e,n}}}var ro=to(!0),ao=to(!1),so=z(null),no=null;function io(e){var t=e.alternate;U(uo,1&uo.current),U(so,e),null===no&&(null===t||null!==fn.current||null!==t.memoizedState)&&(no=e)}function oo(e){if(22===e.tag){if(U(uo,uo.current),U(so,e),null===no){var t=e.alternate;null!==t&&null!==t.memoizedState&&(no=e)}}else lo()}function lo(){U(uo,uo.current),U(so,so.current)}function co(e){B(so),no===e&&(no=null),B(uo)}var uo=z(0);function ho(e){for(var t=e;null!==t;){if(13===t.tag){var r=t.memoizedState;if(null!==r&&(null===(r=r.dehydrated)||"$?"===r.data||xu(r)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function fo(e,t,r,a){r=null===(r=r(a,t=e.memoizedState))||void 0===r?t:h({},t,r),e.memoizedState=r,0===e.lanes&&(e.updateQueue.baseState=r)}var mo={enqueueSetState:function(e,t,r){e=e._reactInternals;var a=Rc(),s=an(a);s.payload=t,void 0!==r&&null!==r&&(s.callback=r),null!==(t=sn(e,s,a))&&(Fc(t,e,a),nn(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var a=Rc(),s=an(a);s.tag=1,s.payload=t,void 0!==r&&null!==r&&(s.callback=r),null!==(t=sn(e,s,a))&&(Fc(t,e,a),nn(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Rc(),a=an(r);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),null!==(t=sn(e,a,r))&&(Fc(t,e,r),nn(t,e,r))}};function po(e,t,r,a,s,n,i){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(a,n,i):!t.prototype||!t.prototype.isPureReactComponent||(!Yr(r,a)||!Yr(s,n))}function go(e,t,r,a){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,a),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,a),t.state!==e&&mo.enqueueReplaceState(t,t.state,null)}function xo(e,t){var r=t;if("ref"in t)for(var a in r={},t)"ref"!==a&&(r[a]=t[a]);if(e=e.defaultProps)for(var s in r===t&&(r=h({},r)),e)void 0===r[s]&&(r[s]=e[s]);return r}var bo="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function vo(e){bo(e)}function yo(e){console.error(e)}function wo(e){bo(e)}function jo(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(r){setTimeout(function(){throw r})}}function No(e,t,r){try{(0,e.onCaughtError)(r.value,{componentStack:r.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(a){setTimeout(function(){throw a})}}function ko(e,t,r){return(r=an(r)).tag=3,r.payload={element:null},r.callback=function(){jo(e,t)},r}function So(e){return(e=an(e)).tag=3,e}function Eo(e,t,r,a){var s=r.type.getDerivedStateFromError;if("function"===typeof s){var n=a.value;e.payload=function(){return s(n)},e.callback=function(){No(t,r,a)}}var i=r.stateNode;null!==i&&"function"===typeof i.componentDidCatch&&(e.callback=function(){No(t,r,a),"function"!==typeof s&&(null===Sc?Sc=new Set([this]):Sc.add(this));var e=a.stack;this.componentDidCatch(a.value,{componentStack:null!==e?e:""})})}var To=Error(i(461)),_o=!1;function Co(e,t,r,a){t.child=null===e?ao(t,null,r,a):ro(t,e.child,r,a)}function Ao(e,t,r,a,s){r=r.render;var n=t.ref;if("ref"in a){var i={};for(var o in a)"ref"!==o&&(i[o]=a[o])}else i=a;return ks(t),a=Dn(e,t,r,i,n,s),o=Rn(),null===e||_o?(ss&&o&&es(t),t.flags|=1,Co(e,t,a,s),t.child):(Mn(e,t,s),Jo(e,t,s))}function Do(e,t,r,a,s){if(null===e){var n=r.type;return"function"!==typeof n||Ma(n)||void 0!==n.defaultProps||null!==r.compare?((e=za(r.type,null,a,t,t.mode,s)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=n,Po(e,t,n,a,s))}if(n=e.child,!Xo(e,s)){var i=n.memoizedProps;if((r=null!==(r=r.compare)?r:Yr)(i,a)&&e.ref===t.ref)return Jo(e,t,s)}return t.flags|=1,(e=Fa(n,a)).ref=t.ref,e.return=t,t.child=e}function Po(e,t,r,a,s){if(null!==e){var n=e.memoizedProps;if(Yr(n,a)&&e.ref===t.ref){if(_o=!1,t.pendingProps=a=n,!Xo(e,s))return t.lanes=e.lanes,Jo(e,t,s);0!==(131072&e.flags)&&(_o=!0)}}return Mo(e,t,r,a,s)}function Io(e,t,r){var a=t.pendingProps,s=a.children,n=null!==e?e.memoizedState:null;if("hidden"===a.mode){if(0!==(128&t.flags)){if(a=null!==n?n.baseLanes|r:r,null!==e){for(s=t.child=e.child,n=0;null!==s;)n=n|s.lanes|s.childLanes,s=s.sibling;t.childLanes=n&~a}else t.childLanes=0,t.child=null;return Oo(e,t,a,r)}if(0===(536870912&r))return t.lanes=t.childLanes=536870912,Oo(e,t,null!==n?n.baseLanes|r:r,r);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Ws(0,null!==n?n.cachePool:null),null!==n?pn(t,n):gn(),oo(t)}else null!==n?(Ws(0,n.cachePool),pn(t,n),lo(),t.memoizedState=null):(null!==e&&Ws(0,null),gn(),lo());return Co(e,t,s,r),t.child}function Oo(e,t,r,a){var s=Us();return s=null===s?null:{parent:Ds._currentValue,pool:s},t.memoizedState={baseLanes:r,cachePool:s},null!==e&&Ws(0,null),gn(),oo(t),null!==e&&js(e,t,a,!0),null}function Ro(e,t){var r=t.ref;if(null===r)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!==typeof r&&"object"!==typeof r)throw Error(i(284));null!==e&&e.ref===r||(t.flags|=4194816)}}function Mo(e,t,r,a,s){return ks(t),r=Dn(e,t,r,a,void 0,s),a=Rn(),null===e||_o?(ss&&a&&es(t),t.flags|=1,Co(e,t,r,s),t.child):(Mn(e,t,s),Jo(e,t,s))}function Fo(e,t,r,a,s,n){return ks(t),t.updateQueue=null,r=In(t,a,r,s),Pn(e),a=Rn(),null===e||_o?(ss&&a&&es(t),t.flags|=1,Co(e,t,r,n),t.child):(Mn(e,t,n),Jo(e,t,n))}function Lo(e,t,r,a,s){if(ks(t),null===t.stateNode){var n=Ia,i=r.contextType;"object"===typeof i&&null!==i&&(n=Ss(i)),n=new r(a,n),t.memoizedState=null!==n.state&&void 0!==n.state?n.state:null,n.updater=mo,t.stateNode=n,n._reactInternals=t,(n=t.stateNode).props=a,n.state=t.memoizedState,n.refs={},tn(t),i=r.contextType,n.context="object"===typeof i&&null!==i?Ss(i):Ia,n.state=t.memoizedState,"function"===typeof(i=r.getDerivedStateFromProps)&&(fo(t,r,i,a),n.state=t.memoizedState),"function"===typeof r.getDerivedStateFromProps||"function"===typeof n.getSnapshotBeforeUpdate||"function"!==typeof n.UNSAFE_componentWillMount&&"function"!==typeof n.componentWillMount||(i=n.state,"function"===typeof n.componentWillMount&&n.componentWillMount(),"function"===typeof n.UNSAFE_componentWillMount&&n.UNSAFE_componentWillMount(),i!==n.state&&mo.enqueueReplaceState(n,n.state,null),dn(t,a,n,s),cn(),n.state=t.memoizedState),"function"===typeof n.componentDidMount&&(t.flags|=4194308),a=!0}else if(null===e){n=t.stateNode;var o=t.memoizedProps,l=xo(r,o);n.props=l;var c=n.context,d=r.contextType;i=Ia,"object"===typeof d&&null!==d&&(i=Ss(d));var u=r.getDerivedStateFromProps;d="function"===typeof u||"function"===typeof n.getSnapshotBeforeUpdate,o=t.pendingProps!==o,d||"function"!==typeof n.UNSAFE_componentWillReceiveProps&&"function"!==typeof n.componentWillReceiveProps||(o||c!==i)&&go(t,n,a,i),en=!1;var h=t.memoizedState;n.state=h,dn(t,a,n,s),cn(),c=t.memoizedState,o||h!==c||en?("function"===typeof u&&(fo(t,r,u,a),c=t.memoizedState),(l=en||po(t,r,l,a,h,c,i))?(d||"function"!==typeof n.UNSAFE_componentWillMount&&"function"!==typeof n.componentWillMount||("function"===typeof n.componentWillMount&&n.componentWillMount(),"function"===typeof n.UNSAFE_componentWillMount&&n.UNSAFE_componentWillMount()),"function"===typeof n.componentDidMount&&(t.flags|=4194308)):("function"===typeof n.componentDidMount&&(t.flags|=4194308),t.memoizedProps=a,t.memoizedState=c),n.props=a,n.state=c,n.context=i,a=l):("function"===typeof n.componentDidMount&&(t.flags|=4194308),a=!1)}else{n=t.stateNode,rn(e,t),d=xo(r,i=t.memoizedProps),n.props=d,u=t.pendingProps,h=n.context,c=r.contextType,l=Ia,"object"===typeof c&&null!==c&&(l=Ss(c)),(c="function"===typeof(o=r.getDerivedStateFromProps)||"function"===typeof n.getSnapshotBeforeUpdate)||"function"!==typeof n.UNSAFE_componentWillReceiveProps&&"function"!==typeof n.componentWillReceiveProps||(i!==u||h!==l)&&go(t,n,a,l),en=!1,h=t.memoizedState,n.state=h,dn(t,a,n,s),cn();var f=t.memoizedState;i!==u||h!==f||en||null!==e&&null!==e.dependencies&&Ns(e.dependencies)?("function"===typeof o&&(fo(t,r,o,a),f=t.memoizedState),(d=en||po(t,r,d,a,h,f,l)||null!==e&&null!==e.dependencies&&Ns(e.dependencies))?(c||"function"!==typeof n.UNSAFE_componentWillUpdate&&"function"!==typeof n.componentWillUpdate||("function"===typeof n.componentWillUpdate&&n.componentWillUpdate(a,f,l),"function"===typeof n.UNSAFE_componentWillUpdate&&n.UNSAFE_componentWillUpdate(a,f,l)),"function"===typeof n.componentDidUpdate&&(t.flags|=4),"function"===typeof n.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof n.componentDidUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof n.getSnapshotBeforeUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=a,t.memoizedState=f),n.props=a,n.state=f,n.context=l,a=d):("function"!==typeof n.componentDidUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof n.getSnapshotBeforeUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),a=!1)}return n=a,Ro(e,t),a=0!==(128&t.flags),n||a?(n=t.stateNode,r=a&&"function"!==typeof r.getDerivedStateFromError?null:n.render(),t.flags|=1,null!==e&&a?(t.child=ro(t,e.child,null,s),t.child=ro(t,null,r,s)):Co(e,t,r,s),t.memoizedState=n.state,e=t.child):e=Jo(e,t,s),e}function zo(e,t,r,a){return hs(),t.flags|=256,Co(e,t,r,a),t.child}var Bo={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Uo(e){return{baseLanes:e,cachePool:Hs()}}function Wo(e,t,r){return e=null!==e?e.childLanes&~r:0,t&&(e|=xc),e}function Ho(e,t,r){var a,s=t.pendingProps,n=!1,o=0!==(128&t.flags);if((a=o)||(a=(null===e||null!==e.memoizedState)&&0!==(2&uo.current)),a&&(n=!0,t.flags&=-129),a=0!==(32&t.flags),t.flags&=-33,null===e){if(ss){if(n?io(t):lo(),ss){var l,c=as;if(l=c){e:{for(l=c,c=is;8!==l.nodeType;){if(!c){c=null;break e}if(null===(l=bu(l.nextSibling))){c=null;break e}}c=l}null!==c?(t.memoizedState={dehydrated:c,treeContext:null!==Ya?{id:Ja,overflow:Xa}:null,retryLane:536870912,hydrationErrors:null},(l=Ra(18,null,null,0)).stateNode=c,l.return=t,t.child=l,rs=t,as=null,l=!0):l=!1}l||ls(t)}if(null!==(c=t.memoizedState)&&null!==(c=c.dehydrated))return xu(c)?t.lanes=32:t.lanes=536870912,null;co(t)}return c=s.children,s=s.fallback,n?(lo(),c=Go({mode:"hidden",children:c},n=t.mode),s=Ba(s,n,r,null),c.return=t,s.return=t,c.sibling=s,t.child=c,(n=t.child).memoizedState=Uo(r),n.childLanes=Wo(e,a,r),t.memoizedState=Bo,s):(io(t),Vo(t,c))}if(null!==(l=e.memoizedState)&&null!==(c=l.dehydrated)){if(o)256&t.flags?(io(t),t.flags&=-257,t=qo(e,t,r)):null!==t.memoizedState?(lo(),t.child=e.child,t.flags|=128,t=null):(lo(),n=s.fallback,c=t.mode,s=Go({mode:"visible",children:s.children},c),(n=Ba(n,c,r,null)).flags|=2,s.return=t,n.return=t,s.sibling=n,t.child=s,ro(t,e.child,null,r),(s=t.child).memoizedState=Uo(r),s.childLanes=Wo(e,a,r),t.memoizedState=Bo,t=n);else if(io(t),xu(c)){if(a=c.nextSibling&&c.nextSibling.dataset)var d=a.dgst;a=d,(s=Error(i(419))).stack="",s.digest=a,ms({value:s,source:null,stack:null}),t=qo(e,t,r)}else if(_o||js(e,t,r,!1),a=0!==(r&e.childLanes),_o||a){if(null!==(a=sc)&&(0!==(s=0!==((s=0!==(42&(s=r&-r))?1:_e(s))&(a.suspendedLanes|r))?0:s)&&s!==l.retryLane))throw l.retryLane=s,Aa(e,s),Fc(a,e,s),To;"$?"===c.data||Kc(),t=qo(e,t,r)}else"$?"===c.data?(t.flags|=192,t.child=e.child,t=null):(e=l.treeContext,as=bu(c.nextSibling),rs=t,ss=!0,ns=null,is=!1,null!==e&&($a[Ka++]=Ja,$a[Ka++]=Xa,$a[Ka++]=Ya,Ja=e.id,Xa=e.overflow,Ya=t),(t=Vo(t,s.children)).flags|=4096);return t}return n?(lo(),n=s.fallback,c=t.mode,d=(l=e.child).sibling,(s=Fa(l,{mode:"hidden",children:s.children})).subtreeFlags=65011712&l.subtreeFlags,null!==d?n=Fa(d,n):(n=Ba(n,c,r,null)).flags|=2,n.return=t,s.return=t,s.sibling=n,t.child=s,s=n,n=t.child,null===(c=e.child.memoizedState)?c=Uo(r):(null!==(l=c.cachePool)?(d=Ds._currentValue,l=l.parent!==d?{parent:d,pool:d}:l):l=Hs(),c={baseLanes:c.baseLanes|r,cachePool:l}),n.memoizedState=c,n.childLanes=Wo(e,a,r),t.memoizedState=Bo,s):(io(t),e=(r=e.child).sibling,(r=Fa(r,{mode:"visible",children:s.children})).return=t,r.sibling=null,null!==e&&(null===(a=t.deletions)?(t.deletions=[e],t.flags|=16):a.push(e)),t.child=r,t.memoizedState=null,r)}function Vo(e,t){return(t=Go({mode:"visible",children:t},e.mode)).return=e,e.child=t}function Go(e,t){return(e=Ra(22,e,null,t)).lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function qo(e,t,r){return ro(t,e.child,null,r),(e=Vo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function $o(e,t,r){e.lanes|=t;var a=e.alternate;null!==a&&(a.lanes|=t),ys(e.return,t,r)}function Ko(e,t,r,a,s){var n=e.memoizedState;null===n?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:a,tail:r,tailMode:s}:(n.isBackwards=t,n.rendering=null,n.renderingStartTime=0,n.last=a,n.tail=r,n.tailMode=s)}function Yo(e,t,r){var a=t.pendingProps,s=a.revealOrder,n=a.tail;if(Co(e,t,a.children,r),0!==(2&(a=uo.current)))a=1&a|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&$o(e,r,t);else if(19===e.tag)$o(e,r,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}a&=1}switch(U(uo,a),s){case"forwards":for(r=t.child,s=null;null!==r;)null!==(e=r.alternate)&&null===ho(e)&&(s=r),r=r.sibling;null===(r=s)?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),Ko(t,!1,s,r,n);break;case"backwards":for(r=null,s=t.child,t.child=null;null!==s;){if(null!==(e=s.alternate)&&null===ho(e)){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}Ko(t,!0,r,null,n);break;case"together":Ko(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Jo(e,t,r){if(null!==e&&(t.dependencies=e.dependencies),mc|=t.lanes,0===(r&t.childLanes)){if(null===e)return null;if(js(e,t,r,!1),0===(r&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(r=Fa(e=t.child,e.pendingProps),t.child=r,r.return=t;null!==e.sibling;)e=e.sibling,(r=r.sibling=Fa(e,e.pendingProps)).return=t;r.sibling=null}return t.child}function Xo(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Ns(e))}function Qo(e,t,r){if(null!==e)if(e.memoizedProps!==t.pendingProps)_o=!0;else{if(!Xo(e,r)&&0===(128&t.flags))return _o=!1,function(e,t,r){switch(t.tag){case 3:q(t,t.stateNode.containerInfo),bs(0,Ds,e.memoizedState.cache),hs();break;case 27:case 5:K(t);break;case 4:q(t,t.stateNode.containerInfo);break;case 10:bs(0,t.type,t.memoizedProps.value);break;case 13:var a=t.memoizedState;if(null!==a)return null!==a.dehydrated?(io(t),t.flags|=128,null):0!==(r&t.child.childLanes)?Ho(e,t,r):(io(t),null!==(e=Jo(e,t,r))?e.sibling:null);io(t);break;case 19:var s=0!==(128&e.flags);if((a=0!==(r&t.childLanes))||(js(e,t,r,!1),a=0!==(r&t.childLanes)),s){if(a)return Yo(e,t,r);t.flags|=128}if(null!==(s=t.memoizedState)&&(s.rendering=null,s.tail=null,s.lastEffect=null),U(uo,uo.current),a)break;return null;case 22:case 23:return t.lanes=0,Io(e,t,r);case 24:bs(0,Ds,e.memoizedState.cache)}return Jo(e,t,r)}(e,t,r);_o=0!==(131072&e.flags)}else _o=!1,ss&&0!==(1048576&t.flags)&&Za(t,qa,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var a=t.elementType,s=a._init;if(a=s(a._payload),t.type=a,"function"!==typeof a){if(void 0!==a&&null!==a){if((s=a.$$typeof)===j){t.tag=11,t=Ao(null,t,a,e,r);break e}if(s===S){t.tag=14,t=Do(null,t,a,e,r);break e}}throw t=P(a)||a,Error(i(306,t,""))}Ma(a)?(e=xo(a,e),t.tag=1,t=Lo(null,t,a,e,r)):(t.tag=0,t=Mo(null,t,a,e,r))}return t;case 0:return Mo(e,t,t.type,t.pendingProps,r);case 1:return Lo(e,t,a=t.type,s=xo(a,t.pendingProps),r);case 3:e:{if(q(t,t.stateNode.containerInfo),null===e)throw Error(i(387));a=t.pendingProps;var n=t.memoizedState;s=n.element,rn(e,t),dn(t,a,null,r);var o=t.memoizedState;if(a=o.cache,bs(0,Ds,a),a!==n.cache&&ws(t,[Ds],r,!0),cn(),a=o.element,n.isDehydrated){if(n={element:a,isDehydrated:!1,cache:o.cache},t.updateQueue.baseState=n,t.memoizedState=n,256&t.flags){t=zo(e,t,a,r);break e}if(a!==s){ms(s=Na(Error(i(424)),t)),t=zo(e,t,a,r);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(as=bu(e.firstChild),rs=t,ss=!0,ns=null,is=!0,r=ao(t,null,a,r),t.child=r;r;)r.flags=-3&r.flags|4096,r=r.sibling}else{if(hs(),a===s){t=Jo(e,t,r);break e}Co(e,t,a,r)}t=t.child}return t;case 26:return Ro(e,t),null===e?(r=Cu(t.type,null,t.pendingProps,null))?t.memoizedState=r:ss||(r=t.type,e=t.pendingProps,(a=su(V.current).createElement(r))[Pe]=t,a[Ie]=e,tu(a,r,e),Ge(a),t.stateNode=a):t.memoizedState=Cu(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return K(t),null===e&&ss&&(a=t.stateNode=wu(t.type,t.pendingProps,V.current),rs=t,is=!0,s=as,mu(t.type)?(vu=s,as=bu(a.firstChild)):as=s),Co(e,t,t.pendingProps.children,r),Ro(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&ss&&((s=a=as)&&(null!==(a=function(e,t,r,a){for(;1===e.nodeType;){var s=r;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!a&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(a){if(!e[ze])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(n=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(n!==s.rel||e.getAttribute("href")!==(null==s.href||""===s.href?null:s.href)||e.getAttribute("crossorigin")!==(null==s.crossOrigin?null:s.crossOrigin)||e.getAttribute("title")!==(null==s.title?null:s.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((n=e.getAttribute("src"))!==(null==s.src?null:s.src)||e.getAttribute("type")!==(null==s.type?null:s.type)||e.getAttribute("crossorigin")!==(null==s.crossOrigin?null:s.crossOrigin))&&n&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var n=null==s.name?null:""+s.name;if("hidden"===s.type&&e.getAttribute("name")===n)return e}if(null===(e=bu(e.nextSibling)))break}return null}(a,t.type,t.pendingProps,is))?(t.stateNode=a,rs=t,as=bu(a.firstChild),is=!1,s=!0):s=!1),s||ls(t)),K(t),s=t.type,n=t.pendingProps,o=null!==e?e.memoizedProps:null,a=n.children,ou(s,n)?a=null:null!==o&&ou(s,o)&&(t.flags|=32),null!==t.memoizedState&&(s=Dn(e,t,On,null,null,r),Yu._currentValue=s),Ro(e,t),Co(e,t,a,r),t.child;case 6:return null===e&&ss&&((e=r=as)&&(null!==(r=function(e,t,r){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!r)return null;if(null===(e=bu(e.nextSibling)))return null}return e}(r,t.pendingProps,is))?(t.stateNode=r,rs=t,as=null,e=!0):e=!1),e||ls(t)),null;case 13:return Ho(e,t,r);case 4:return q(t,t.stateNode.containerInfo),a=t.pendingProps,null===e?t.child=ro(t,null,a,r):Co(e,t,a,r),t.child;case 11:return Ao(e,t,t.type,t.pendingProps,r);case 7:return Co(e,t,t.pendingProps,r),t.child;case 8:case 12:return Co(e,t,t.pendingProps.children,r),t.child;case 10:return a=t.pendingProps,bs(0,t.type,a.value),Co(e,t,a.children,r),t.child;case 9:return s=t.type._context,a=t.pendingProps.children,ks(t),a=a(s=Ss(s)),t.flags|=1,Co(e,t,a,r),t.child;case 14:return Do(e,t,t.type,t.pendingProps,r);case 15:return Po(e,t,t.type,t.pendingProps,r);case 19:return Yo(e,t,r);case 31:return a=t.pendingProps,r=t.mode,a={mode:a.mode,children:a.children},null===e?((r=Go(a,r)).ref=t.ref,t.child=r,r.return=t,t=r):((r=Fa(e.child,a)).ref=t.ref,t.child=r,r.return=t,t=r),t;case 22:return Io(e,t,r);case 24:return ks(t),a=Ss(Ds),null===e?(null===(s=Us())&&(s=sc,n=Ps(),s.pooledCache=n,n.refCount++,null!==n&&(s.pooledCacheLanes|=r),s=n),t.memoizedState={parent:a,cache:s},tn(t),bs(0,Ds,s)):(0!==(e.lanes&r)&&(rn(e,t),dn(t,null,null,r),cn()),s=e.memoizedState,n=t.memoizedState,s.parent!==a?(s={parent:a,cache:a},t.memoizedState=s,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=s),bs(0,Ds,a)):(a=n.cache,bs(0,Ds,a),a!==s.cache&&ws(t,[Ds],r,!0))),Co(e,t,t.pendingProps.children,r),t.child;case 29:throw t.pendingProps}throw Error(i(156,t.tag))}function Zo(e){e.flags|=4}function el(e,t){if("stylesheet"!==t.type||0!==(4&t.state.loading))e.flags&=-16777217;else if(e.flags|=16777216,!Wu(t)){if(null!==(t=so.current)&&((4194048&ic)===ic?null!==no:(62914560&ic)!==ic&&0===(536870912&ic)||t!==no))throw Xs=$s,Gs;e.flags|=8192}}function tl(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?Ne():536870912,e.lanes|=t,bc|=t)}function rl(e,t){if(!ss)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var a=null;null!==r;)null!==r.alternate&&(a=r),r=r.sibling;null===a?t||null===e.tail?e.tail=null:e.tail.sibling=null:a.sibling=null}}function al(e){var t=null!==e.alternate&&e.alternate.child===e.child,r=0,a=0;if(t)for(var s=e.child;null!==s;)r|=s.lanes|s.childLanes,a|=65011712&s.subtreeFlags,a|=65011712&s.flags,s.return=e,s=s.sibling;else for(s=e.child;null!==s;)r|=s.lanes|s.childLanes,a|=s.subtreeFlags,a|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=a,e.childLanes=r,t}function sl(e,t,r){var a=t.pendingProps;switch(ts(t),t.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return al(t),null;case 3:return r=t.stateNode,a=null,null!==e&&(a=e.memoizedState.cache),t.memoizedState.cache!==a&&(t.flags|=2048),vs(Ds),$(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(us(t)?Zo(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,fs())),al(t),null;case 26:return r=t.memoizedState,null===e?(Zo(t),null!==r?(al(t),el(t,r)):(al(t),t.flags&=-16777217)):r?r!==e.memoizedState?(Zo(t),al(t),el(t,r)):(al(t),t.flags&=-16777217):(e.memoizedProps!==a&&Zo(t),al(t),t.flags&=-16777217),null;case 27:Y(t),r=V.current;var s=t.type;if(null!==e&&null!=t.stateNode)e.memoizedProps!==a&&Zo(t);else{if(!a){if(null===t.stateNode)throw Error(i(166));return al(t),null}e=W.current,us(t)?cs(t):(e=wu(s,a,r),t.stateNode=e,Zo(t))}return al(t),null;case 5:if(Y(t),r=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==a&&Zo(t);else{if(!a){if(null===t.stateNode)throw Error(i(166));return al(t),null}if(e=W.current,us(t))cs(t);else{switch(s=su(V.current),e){case 1:e=s.createElementNS("http://www.w3.org/2000/svg",r);break;case 2:e=s.createElementNS("http://www.w3.org/1998/Math/MathML",r);break;default:switch(r){case"svg":e=s.createElementNS("http://www.w3.org/2000/svg",r);break;case"math":e=s.createElementNS("http://www.w3.org/1998/Math/MathML",r);break;case"script":(e=s.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e="string"===typeof a.is?s.createElement("select",{is:a.is}):s.createElement("select"),a.multiple?e.multiple=!0:a.size&&(e.size=a.size);break;default:e="string"===typeof a.is?s.createElement(r,{is:a.is}):s.createElement(r)}}e[Pe]=t,e[Ie]=a;e:for(s=t.child;null!==s;){if(5===s.tag||6===s.tag)e.appendChild(s.stateNode);else if(4!==s.tag&&27!==s.tag&&null!==s.child){s.child.return=s,s=s.child;continue}if(s===t)break e;for(;null===s.sibling;){if(null===s.return||s.return===t)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}t.stateNode=e;e:switch(tu(e,r,a),r){case"button":case"input":case"select":case"textarea":e=!!a.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&Zo(t)}}return al(t),t.flags&=-16777217,null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==a&&Zo(t);else{if("string"!==typeof a&&null===t.stateNode)throw Error(i(166));if(e=V.current,us(t)){if(e=t.stateNode,r=t.memoizedProps,a=null,null!==(s=rs))switch(s.tag){case 27:case 5:a=s.memoizedProps}e[Pe]=t,(e=!!(e.nodeValue===r||null!==a&&!0===a.suppressHydrationWarning||Xd(e.nodeValue,r)))||ls(t)}else(e=su(e).createTextNode(a))[Pe]=t,t.stateNode=e}return al(t),null;case 13:if(a=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(s=us(t),null!==a&&null!==a.dehydrated){if(null===e){if(!s)throw Error(i(318));if(!(s=null!==(s=t.memoizedState)?s.dehydrated:null))throw Error(i(317));s[Pe]=t}else hs(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;al(t),s=!1}else s=fs(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=s),s=!0;if(!s)return 256&t.flags?(co(t),t):(co(t),null)}if(co(t),0!==(128&t.flags))return t.lanes=r,t;if(r=null!==a,e=null!==e&&null!==e.memoizedState,r){s=null,null!==(a=t.child).alternate&&null!==a.alternate.memoizedState&&null!==a.alternate.memoizedState.cachePool&&(s=a.alternate.memoizedState.cachePool.pool);var n=null;null!==a.memoizedState&&null!==a.memoizedState.cachePool&&(n=a.memoizedState.cachePool.pool),n!==s&&(a.flags|=2048)}return r!==e&&r&&(t.child.flags|=8192),tl(t,t.updateQueue),al(t),null;case 4:return $(),null===e&&Ud(t.stateNode.containerInfo),al(t),null;case 10:return vs(t.type),al(t),null;case 19:if(B(uo),null===(s=t.memoizedState))return al(t),null;if(a=0!==(128&t.flags),null===(n=s.rendering))if(a)rl(s,!1);else{if(0!==fc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(n=ho(e))){for(t.flags|=128,rl(s,!1),e=n.updateQueue,t.updateQueue=e,tl(t,e),t.subtreeFlags=0,e=r,r=t.child;null!==r;)La(r,e),r=r.sibling;return U(uo,1&uo.current|2),t.child}e=e.sibling}null!==s.tail&&te()>Nc&&(t.flags|=128,a=!0,rl(s,!1),t.lanes=4194304)}else{if(!a)if(null!==(e=ho(n))){if(t.flags|=128,a=!0,e=e.updateQueue,t.updateQueue=e,tl(t,e),rl(s,!0),null===s.tail&&"hidden"===s.tailMode&&!n.alternate&&!ss)return al(t),null}else 2*te()-s.renderingStartTime>Nc&&536870912!==r&&(t.flags|=128,a=!0,rl(s,!1),t.lanes=4194304);s.isBackwards?(n.sibling=t.child,t.child=n):(null!==(e=s.last)?e.sibling=n:t.child=n,s.last=n)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=te(),t.sibling=null,e=uo.current,U(uo,a?1&e|2:1&e),t):(al(t),null);case 22:case 23:return co(t),xn(),a=null!==t.memoizedState,null!==e?null!==e.memoizedState!==a&&(t.flags|=8192):a&&(t.flags|=8192),a?0!==(536870912&r)&&0===(128&t.flags)&&(al(t),6&t.subtreeFlags&&(t.flags|=8192)):al(t),null!==(r=t.updateQueue)&&tl(t,r.retryQueue),r=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(r=e.memoizedState.cachePool.pool),a=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(a=t.memoizedState.cachePool.pool),a!==r&&(t.flags|=2048),null!==e&&B(Bs),null;case 24:return r=null,null!==e&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),vs(Ds),al(t),null;case 25:case 30:return null}throw Error(i(156,t.tag))}function nl(e,t){switch(ts(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return vs(Ds),$(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return Y(t),null;case 13:if(co(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));hs()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return B(uo),null;case 4:return $(),null;case 10:return vs(t.type),null;case 22:case 23:return co(t),xn(),null!==e&&B(Bs),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return vs(Ds),null;default:return null}}function il(e,t){switch(ts(t),t.tag){case 3:vs(Ds),$();break;case 26:case 27:case 5:Y(t);break;case 4:$();break;case 13:co(t);break;case 19:B(uo);break;case 10:vs(t.type);break;case 22:case 23:co(t),xn(),null!==e&&B(Bs);break;case 24:vs(Ds)}}function ol(e,t){try{var r=t.updateQueue,a=null!==r?r.lastEffect:null;if(null!==a){var s=a.next;r=s;do{if((r.tag&e)===e){a=void 0;var n=r.create,i=r.inst;a=n(),i.destroy=a}r=r.next}while(r!==s)}}catch(o){ud(t,t.return,o)}}function ll(e,t,r){try{var a=t.updateQueue,s=null!==a?a.lastEffect:null;if(null!==s){var n=s.next;a=n;do{if((a.tag&e)===e){var i=a.inst,o=i.destroy;if(void 0!==o){i.destroy=void 0,s=t;var l=r,c=o;try{c()}catch(d){ud(s,l,d)}}}a=a.next}while(a!==n)}}catch(d){ud(t,t.return,d)}}function cl(e){var t=e.updateQueue;if(null!==t){var r=e.stateNode;try{hn(t,r)}catch(a){ud(e,e.return,a)}}}function dl(e,t,r){r.props=xo(e.type,e.memoizedProps),r.state=e.memoizedState;try{r.componentWillUnmount()}catch(a){ud(e,t,a)}}function ul(e,t){try{var r=e.ref;if(null!==r){switch(e.tag){case 26:case 27:case 5:var a=e.stateNode;break;default:a=e.stateNode}"function"===typeof r?e.refCleanup=r(a):r.current=a}}catch(s){ud(e,t,s)}}function hl(e,t){var r=e.ref,a=e.refCleanup;if(null!==r)if("function"===typeof a)try{a()}catch(s){ud(e,t,s)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"===typeof r)try{r(null)}catch(n){ud(e,t,n)}else r.current=null}function fl(e){var t=e.type,r=e.memoizedProps,a=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":r.autoFocus&&a.focus();break e;case"img":r.src?a.src=r.src:r.srcSet&&(a.srcset=r.srcSet)}}catch(s){ud(e,e.return,s)}}function ml(e,t,r){try{var a=e.stateNode;!function(e,t,r,a){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var s=null,n=null,o=null,l=null,c=null,d=null,u=null;for(m in r){var h=r[m];if(r.hasOwnProperty(m)&&null!=h)switch(m){case"checked":case"value":break;case"defaultValue":c=h;default:a.hasOwnProperty(m)||Zd(e,t,m,null,a,h)}}for(var f in a){var m=a[f];if(h=r[f],a.hasOwnProperty(f)&&(null!=m||null!=h))switch(f){case"type":n=m;break;case"name":s=m;break;case"checked":d=m;break;case"defaultChecked":u=m;break;case"value":o=m;break;case"defaultValue":l=m;break;case"children":case"dangerouslySetInnerHTML":if(null!=m)throw Error(i(137,t));break;default:m!==h&&Zd(e,t,f,m,a,h)}}return void gt(e,o,l,c,d,u,n,s);case"select":for(n in m=o=l=f=null,r)if(c=r[n],r.hasOwnProperty(n)&&null!=c)switch(n){case"value":break;case"multiple":m=c;default:a.hasOwnProperty(n)||Zd(e,t,n,null,a,c)}for(s in a)if(n=a[s],c=r[s],a.hasOwnProperty(s)&&(null!=n||null!=c))switch(s){case"value":f=n;break;case"defaultValue":l=n;break;case"multiple":o=n;default:n!==c&&Zd(e,t,s,n,a,c)}return t=l,r=o,a=m,void(null!=f?vt(e,!!r,f,!1):!!a!==!!r&&(null!=t?vt(e,!!r,t,!0):vt(e,!!r,r?[]:"",!1)));case"textarea":for(l in m=f=null,r)if(s=r[l],r.hasOwnProperty(l)&&null!=s&&!a.hasOwnProperty(l))switch(l){case"value":case"children":break;default:Zd(e,t,l,null,a,s)}for(o in a)if(s=a[o],n=r[o],a.hasOwnProperty(o)&&(null!=s||null!=n))switch(o){case"value":f=s;break;case"defaultValue":m=s;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=s)throw Error(i(91));break;default:s!==n&&Zd(e,t,o,s,a,n)}return void yt(e,f,m);case"option":for(var p in r)if(f=r[p],r.hasOwnProperty(p)&&null!=f&&!a.hasOwnProperty(p))if("selected"===p)e.selected=!1;else Zd(e,t,p,null,a,f);for(c in a)if(f=a[c],m=r[c],a.hasOwnProperty(c)&&f!==m&&(null!=f||null!=m))if("selected"===c)e.selected=f&&"function"!==typeof f&&"symbol"!==typeof f;else Zd(e,t,c,f,a,m);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in r)f=r[g],r.hasOwnProperty(g)&&null!=f&&!a.hasOwnProperty(g)&&Zd(e,t,g,null,a,f);for(d in a)if(f=a[d],m=r[d],a.hasOwnProperty(d)&&f!==m&&(null!=f||null!=m))switch(d){case"children":case"dangerouslySetInnerHTML":if(null!=f)throw Error(i(137,t));break;default:Zd(e,t,d,f,a,m)}return;default:if(Et(t)){for(var x in r)f=r[x],r.hasOwnProperty(x)&&void 0!==f&&!a.hasOwnProperty(x)&&eu(e,t,x,void 0,a,f);for(u in a)f=a[u],m=r[u],!a.hasOwnProperty(u)||f===m||void 0===f&&void 0===m||eu(e,t,u,f,a,m);return}}for(var b in r)f=r[b],r.hasOwnProperty(b)&&null!=f&&!a.hasOwnProperty(b)&&Zd(e,t,b,null,a,f);for(h in a)f=a[h],m=r[h],!a.hasOwnProperty(h)||f===m||null==f&&null==m||Zd(e,t,h,f,a,m)}(a,e.type,r,t),a[Ie]=t}catch(s){ud(e,e.return,s)}}function pl(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&mu(e.type)||4===e.tag}function gl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||pl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&mu(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function xl(e,t,r){var a=e.tag;if(5===a||6===a)e=e.stateNode,t?(9===r.nodeType?r.body:"HTML"===r.nodeName?r.ownerDocument.body:r).insertBefore(e,t):((t=9===r.nodeType?r.body:"HTML"===r.nodeName?r.ownerDocument.body:r).appendChild(e),null!==(r=r._reactRootContainer)&&void 0!==r||null!==t.onclick||(t.onclick=Qd));else if(4!==a&&(27===a&&mu(e.type)&&(r=e.stateNode,t=null),null!==(e=e.child)))for(xl(e,t,r),e=e.sibling;null!==e;)xl(e,t,r),e=e.sibling}function bl(e,t,r){var a=e.tag;if(5===a||6===a)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(4!==a&&(27===a&&mu(e.type)&&(r=e.stateNode),null!==(e=e.child)))for(bl(e,t,r),e=e.sibling;null!==e;)bl(e,t,r),e=e.sibling}function vl(e){var t=e.stateNode,r=e.memoizedProps;try{for(var a=e.type,s=t.attributes;s.length;)t.removeAttributeNode(s[0]);tu(t,a,r),t[Pe]=e,t[Ie]=r}catch(n){ud(e,e.return,n)}}var yl=!1,wl=!1,jl=!1,Nl="function"===typeof WeakSet?WeakSet:Set,kl=null;function Sl(e,t,r){var a=r.flags;switch(r.tag){case 0:case 11:case 15:Ll(e,r),4&a&&ol(5,r);break;case 1:if(Ll(e,r),4&a)if(e=r.stateNode,null===t)try{e.componentDidMount()}catch(i){ud(r,r.return,i)}else{var s=xo(r.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(s,t,e.__reactInternalSnapshotBeforeUpdate)}catch(o){ud(r,r.return,o)}}64&a&&cl(r),512&a&&ul(r,r.return);break;case 3:if(Ll(e,r),64&a&&null!==(e=r.updateQueue)){if(t=null,null!==r.child)switch(r.child.tag){case 27:case 5:case 1:t=r.child.stateNode}try{hn(e,t)}catch(i){ud(r,r.return,i)}}break;case 27:null===t&&4&a&&vl(r);case 26:case 5:Ll(e,r),null===t&&4&a&&fl(r),512&a&&ul(r,r.return);break;case 12:Ll(e,r);break;case 13:Ll(e,r),4&a&&Dl(e,r),64&a&&(null!==(e=r.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var r=e.ownerDocument;if("$?"!==e.data||"complete"===r.readyState)t();else{var a=function(){t(),r.removeEventListener("DOMContentLoaded",a)};r.addEventListener("DOMContentLoaded",a),e._reactRetry=a}}(e,r=pd.bind(null,r))));break;case 22:if(!(a=null!==r.memoizedState||yl)){t=null!==t&&null!==t.memoizedState||wl,s=yl;var n=wl;yl=a,(wl=t)&&!n?Bl(e,r,0!==(8772&r.subtreeFlags)):Ll(e,r),yl=s,wl=n}break;case 30:break;default:Ll(e,r)}}function El(e){var t=e.alternate;null!==t&&(e.alternate=null,El(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&Be(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Tl=null,_l=!1;function Cl(e,t,r){for(r=r.child;null!==r;)Al(e,t,r),r=r.sibling}function Al(e,t,r){if(ue&&"function"===typeof ue.onCommitFiberUnmount)try{ue.onCommitFiberUnmount(de,r)}catch(n){}switch(r.tag){case 26:wl||hl(r,t),Cl(e,t,r),r.memoizedState?r.memoizedState.count--:r.stateNode&&(r=r.stateNode).parentNode.removeChild(r);break;case 27:wl||hl(r,t);var a=Tl,s=_l;mu(r.type)&&(Tl=r.stateNode,_l=!1),Cl(e,t,r),ju(r.stateNode),Tl=a,_l=s;break;case 5:wl||hl(r,t);case 6:if(a=Tl,s=_l,Tl=null,Cl(e,t,r),_l=s,null!==(Tl=a))if(_l)try{(9===Tl.nodeType?Tl.body:"HTML"===Tl.nodeName?Tl.ownerDocument.body:Tl).removeChild(r.stateNode)}catch(i){ud(r,t,i)}else try{Tl.removeChild(r.stateNode)}catch(i){ud(r,t,i)}break;case 18:null!==Tl&&(_l?(pu(9===(e=Tl).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,r.stateNode),_h(e)):pu(Tl,r.stateNode));break;case 4:a=Tl,s=_l,Tl=r.stateNode.containerInfo,_l=!0,Cl(e,t,r),Tl=a,_l=s;break;case 0:case 11:case 14:case 15:wl||ll(2,r,t),wl||ll(4,r,t),Cl(e,t,r);break;case 1:wl||(hl(r,t),"function"===typeof(a=r.stateNode).componentWillUnmount&&dl(r,t,a)),Cl(e,t,r);break;case 21:Cl(e,t,r);break;case 22:wl=(a=wl)||null!==r.memoizedState,Cl(e,t,r),wl=a;break;default:Cl(e,t,r)}}function Dl(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{_h(e)}catch(r){ud(t,t.return,r)}}function Pl(e,t){var r=function(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new Nl),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new Nl),t;default:throw Error(i(435,e.tag))}}(e);t.forEach(function(t){var a=gd.bind(null,e,t);r.has(t)||(r.add(t),t.then(a,a))})}function Il(e,t){var r=t.deletions;if(null!==r)for(var a=0;a<r.length;a++){var s=r[a],n=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 27:if(mu(l.type)){Tl=l.stateNode,_l=!1;break e}break;case 5:Tl=l.stateNode,_l=!1;break e;case 3:case 4:Tl=l.stateNode.containerInfo,_l=!0;break e}l=l.return}if(null===Tl)throw Error(i(160));Al(n,o,s),Tl=null,_l=!1,null!==(n=s.alternate)&&(n.return=null),s.return=null}if(13878&t.subtreeFlags)for(t=t.child;null!==t;)Rl(t,e),t=t.sibling}var Ol=null;function Rl(e,t){var r=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Il(t,e),Ml(e),4&a&&(ll(3,e,e.return),ol(3,e),ll(5,e,e.return));break;case 1:Il(t,e),Ml(e),512&a&&(wl||null===r||hl(r,r.return)),64&a&&yl&&(null!==(e=e.updateQueue)&&(null!==(a=e.callbacks)&&(r=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===r?a:r.concat(a))));break;case 26:var s=Ol;if(Il(t,e),Ml(e),512&a&&(wl||null===r||hl(r,r.return)),4&a){var n=null!==r?r.memoizedState:null;if(a=e.memoizedState,null===r)if(null===a)if(null===e.stateNode){e:{a=e.type,r=e.memoizedProps,s=s.ownerDocument||s;t:switch(a){case"title":(!(n=s.getElementsByTagName("title")[0])||n[ze]||n[Pe]||"http://www.w3.org/2000/svg"===n.namespaceURI||n.hasAttribute("itemprop"))&&(n=s.createElement(a),s.head.insertBefore(n,s.querySelector("head > title"))),tu(n,a,r),n[Pe]=e,Ge(n),a=n;break e;case"link":var o=Bu("link","href",s).get(a+(r.href||""));if(o)for(var l=0;l<o.length;l++)if((n=o[l]).getAttribute("href")===(null==r.href||""===r.href?null:r.href)&&n.getAttribute("rel")===(null==r.rel?null:r.rel)&&n.getAttribute("title")===(null==r.title?null:r.title)&&n.getAttribute("crossorigin")===(null==r.crossOrigin?null:r.crossOrigin)){o.splice(l,1);break t}tu(n=s.createElement(a),a,r),s.head.appendChild(n);break;case"meta":if(o=Bu("meta","content",s).get(a+(r.content||"")))for(l=0;l<o.length;l++)if((n=o[l]).getAttribute("content")===(null==r.content?null:""+r.content)&&n.getAttribute("name")===(null==r.name?null:r.name)&&n.getAttribute("property")===(null==r.property?null:r.property)&&n.getAttribute("http-equiv")===(null==r.httpEquiv?null:r.httpEquiv)&&n.getAttribute("charset")===(null==r.charSet?null:r.charSet)){o.splice(l,1);break t}tu(n=s.createElement(a),a,r),s.head.appendChild(n);break;default:throw Error(i(468,a))}n[Pe]=e,Ge(n),a=n}e.stateNode=a}else Uu(s,e.type,e.stateNode);else e.stateNode=Ru(s,a,e.memoizedProps);else n!==a?(null===n?null!==r.stateNode&&(r=r.stateNode).parentNode.removeChild(r):n.count--,null===a?Uu(s,e.type,e.stateNode):Ru(s,a,e.memoizedProps)):null===a&&null!==e.stateNode&&ml(e,e.memoizedProps,r.memoizedProps)}break;case 27:Il(t,e),Ml(e),512&a&&(wl||null===r||hl(r,r.return)),null!==r&&4&a&&ml(e,e.memoizedProps,r.memoizedProps);break;case 5:if(Il(t,e),Ml(e),512&a&&(wl||null===r||hl(r,r.return)),32&e.flags){s=e.stateNode;try{jt(s,"")}catch(m){ud(e,e.return,m)}}4&a&&null!=e.stateNode&&ml(e,s=e.memoizedProps,null!==r?r.memoizedProps:s),1024&a&&(jl=!0);break;case 6:if(Il(t,e),Ml(e),4&a){if(null===e.stateNode)throw Error(i(162));a=e.memoizedProps,r=e.stateNode;try{r.nodeValue=a}catch(m){ud(e,e.return,m)}}break;case 3:if(zu=null,s=Ol,Ol=Su(t.containerInfo),Il(t,e),Ol=s,Ml(e),4&a&&null!==r&&r.memoizedState.isDehydrated)try{_h(t.containerInfo)}catch(m){ud(e,e.return,m)}jl&&(jl=!1,Fl(e));break;case 4:a=Ol,Ol=Su(e.stateNode.containerInfo),Il(t,e),Ml(e),Ol=a;break;case 12:default:Il(t,e),Ml(e);break;case 13:Il(t,e),Ml(e),8192&e.child.flags&&null!==e.memoizedState!==(null!==r&&null!==r.memoizedState)&&(jc=te()),4&a&&(null!==(a=e.updateQueue)&&(e.updateQueue=null,Pl(e,a)));break;case 22:s=null!==e.memoizedState;var c=null!==r&&null!==r.memoizedState,d=yl,u=wl;if(yl=d||s,wl=u||c,Il(t,e),wl=u,yl=d,Ml(e),8192&a)e:for(t=e.stateNode,t._visibility=s?-2&t._visibility:1|t._visibility,s&&(null===r||c||yl||wl||zl(e)),r=null,t=e;;){if(5===t.tag||26===t.tag){if(null===r){c=r=t;try{if(n=c.stateNode,s)"function"===typeof(o=n.style).setProperty?o.setProperty("display","none","important"):o.display="none";else{l=c.stateNode;var h=c.memoizedProps.style,f=void 0!==h&&null!==h&&h.hasOwnProperty("display")?h.display:null;l.style.display=null==f||"boolean"===typeof f?"":(""+f).trim()}}catch(m){ud(c,c.return,m)}}}else if(6===t.tag){if(null===r){c=t;try{c.stateNode.nodeValue=s?"":c.memoizedProps}catch(m){ud(c,c.return,m)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;r===t&&(r=null),t=t.return}r===t&&(r=null),t.sibling.return=t.return,t=t.sibling}4&a&&(null!==(a=e.updateQueue)&&(null!==(r=a.retryQueue)&&(a.retryQueue=null,Pl(e,r))));break;case 19:Il(t,e),Ml(e),4&a&&(null!==(a=e.updateQueue)&&(e.updateQueue=null,Pl(e,a)));case 30:case 21:}}function Ml(e){var t=e.flags;if(2&t){try{for(var r,a=e.return;null!==a;){if(pl(a)){r=a;break}a=a.return}if(null==r)throw Error(i(160));switch(r.tag){case 27:var s=r.stateNode;bl(e,gl(e),s);break;case 5:var n=r.stateNode;32&r.flags&&(jt(n,""),r.flags&=-33),bl(e,gl(e),n);break;case 3:case 4:var o=r.stateNode.containerInfo;xl(e,gl(e),o);break;default:throw Error(i(161))}}catch(l){ud(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Fl(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Fl(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function Ll(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)Sl(e,t.alternate,t),t=t.sibling}function zl(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:ll(4,t,t.return),zl(t);break;case 1:hl(t,t.return);var r=t.stateNode;"function"===typeof r.componentWillUnmount&&dl(t,t.return,r),zl(t);break;case 27:ju(t.stateNode);case 26:case 5:hl(t,t.return),zl(t);break;case 22:null===t.memoizedState&&zl(t);break;default:zl(t)}e=e.sibling}}function Bl(e,t,r){for(r=r&&0!==(8772&t.subtreeFlags),t=t.child;null!==t;){var a=t.alternate,s=e,n=t,i=n.flags;switch(n.tag){case 0:case 11:case 15:Bl(s,n,r),ol(4,n);break;case 1:if(Bl(s,n,r),"function"===typeof(s=(a=n).stateNode).componentDidMount)try{s.componentDidMount()}catch(c){ud(a,a.return,c)}if(null!==(s=(a=n).updateQueue)){var o=a.stateNode;try{var l=s.shared.hiddenCallbacks;if(null!==l)for(s.shared.hiddenCallbacks=null,s=0;s<l.length;s++)un(l[s],o)}catch(c){ud(a,a.return,c)}}r&&64&i&&cl(n),ul(n,n.return);break;case 27:vl(n);case 26:case 5:Bl(s,n,r),r&&null===a&&4&i&&fl(n),ul(n,n.return);break;case 12:Bl(s,n,r);break;case 13:Bl(s,n,r),r&&4&i&&Dl(s,n);break;case 22:null===n.memoizedState&&Bl(s,n,r),ul(n,n.return);break;case 30:break;default:Bl(s,n,r)}t=t.sibling}}function Ul(e,t){var r=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(r=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==r&&(null!=e&&e.refCount++,null!=r&&Is(r))}function Wl(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Is(e))}function Hl(e,t,r,a){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)Vl(e,t,r,a),t=t.sibling}function Vl(e,t,r,a){var s=t.flags;switch(t.tag){case 0:case 11:case 15:Hl(e,t,r,a),2048&s&&ol(9,t);break;case 1:case 13:default:Hl(e,t,r,a);break;case 3:Hl(e,t,r,a),2048&s&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Is(e)));break;case 12:if(2048&s){Hl(e,t,r,a),e=t.stateNode;try{var n=t.memoizedProps,i=n.id,o=n.onPostCommit;"function"===typeof o&&o(i,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(l){ud(t,t.return,l)}}else Hl(e,t,r,a);break;case 23:break;case 22:n=t.stateNode,i=t.alternate,null!==t.memoizedState?2&n._visibility?Hl(e,t,r,a):ql(e,t):2&n._visibility?Hl(e,t,r,a):(n._visibility|=2,Gl(e,t,r,a,0!==(10256&t.subtreeFlags))),2048&s&&Ul(i,t);break;case 24:Hl(e,t,r,a),2048&s&&Wl(t.alternate,t)}}function Gl(e,t,r,a,s){for(s=s&&0!==(10256&t.subtreeFlags),t=t.child;null!==t;){var n=e,i=t,o=r,l=a,c=i.flags;switch(i.tag){case 0:case 11:case 15:Gl(n,i,o,l,s),ol(8,i);break;case 23:break;case 22:var d=i.stateNode;null!==i.memoizedState?2&d._visibility?Gl(n,i,o,l,s):ql(n,i):(d._visibility|=2,Gl(n,i,o,l,s)),s&&2048&c&&Ul(i.alternate,i);break;case 24:Gl(n,i,o,l,s),s&&2048&c&&Wl(i.alternate,i);break;default:Gl(n,i,o,l,s)}t=t.sibling}}function ql(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var r=e,a=t,s=a.flags;switch(a.tag){case 22:ql(r,a),2048&s&&Ul(a.alternate,a);break;case 24:ql(r,a),2048&s&&Wl(a.alternate,a);break;default:ql(r,a)}t=t.sibling}}var $l=8192;function Kl(e){if(e.subtreeFlags&$l)for(e=e.child;null!==e;)Yl(e),e=e.sibling}function Yl(e){switch(e.tag){case 26:Kl(e),e.flags&$l&&null!==e.memoizedState&&function(e,t,r){if(null===Hu)throw Error(i(475));var a=Hu;if("stylesheet"===t.type&&("string"!==typeof r.media||!1!==matchMedia(r.media).matches)&&0===(4&t.state.loading)){if(null===t.instance){var s=Au(r.href),n=e.querySelector(Du(s));if(n)return null!==(e=n._p)&&"object"===typeof e&&"function"===typeof e.then&&(a.count++,a=Gu.bind(a),e.then(a,a)),t.state.loading|=4,t.instance=n,void Ge(n);n=e.ownerDocument||e,r=Pu(r),(s=Nu.get(s))&&Fu(r,s),Ge(n=n.createElement("link"));var o=n;o._p=new Promise(function(e,t){o.onload=e,o.onerror=t}),tu(n,"link",r),t.instance=n}null===a.stylesheets&&(a.stylesheets=new Map),a.stylesheets.set(t,e),(e=t.state.preload)&&0===(3&t.state.loading)&&(a.count++,t=Gu.bind(a),e.addEventListener("load",t),e.addEventListener("error",t))}}(Ol,e.memoizedState,e.memoizedProps);break;case 5:default:Kl(e);break;case 3:case 4:var t=Ol;Ol=Su(e.stateNode.containerInfo),Kl(e),Ol=t;break;case 22:null===e.memoizedState&&(null!==(t=e.alternate)&&null!==t.memoizedState?(t=$l,$l=16777216,Kl(e),$l=t):Kl(e))}}function Jl(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function Xl(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var r=0;r<t.length;r++){var a=t[r];kl=a,ec(a,e)}Jl(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)Ql(e),e=e.sibling}function Ql(e){switch(e.tag){case 0:case 11:case 15:Xl(e),2048&e.flags&&ll(9,e,e.return);break;case 3:case 12:default:Xl(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,Zl(e)):Xl(e)}}function Zl(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var r=0;r<t.length;r++){var a=t[r];kl=a,ec(a,e)}Jl(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:ll(8,t,t.return),Zl(t);break;case 22:2&(r=t.stateNode)._visibility&&(r._visibility&=-3,Zl(t));break;default:Zl(t)}e=e.sibling}}function ec(e,t){for(;null!==kl;){var r=kl;switch(r.tag){case 0:case 11:case 15:ll(8,r,t);break;case 23:case 22:if(null!==r.memoizedState&&null!==r.memoizedState.cachePool){var a=r.memoizedState.cachePool.pool;null!=a&&a.refCount++}break;case 24:Is(r.memoizedState.cache)}if(null!==(a=r.child))a.return=r,kl=a;else e:for(r=e;null!==kl;){var s=(a=kl).sibling,n=a.return;if(El(a),a===r){kl=null;break e}if(null!==s){s.return=n,kl=s;break e}kl=n}}}var tc={getCacheForType:function(e){var t=Ss(Ds),r=t.data.get(e);return void 0===r&&(r=e(),t.data.set(e,r)),r}},rc="function"===typeof WeakMap?WeakMap:Map,ac=0,sc=null,nc=null,ic=0,oc=0,lc=null,cc=!1,dc=!1,uc=!1,hc=0,fc=0,mc=0,pc=0,gc=0,xc=0,bc=0,vc=null,yc=null,wc=!1,jc=0,Nc=1/0,kc=null,Sc=null,Ec=0,Tc=null,_c=null,Cc=0,Ac=0,Dc=null,Pc=null,Ic=0,Oc=null;function Rc(){if(0!==(2&ac)&&0!==ic)return ic&-ic;if(null!==O.T){return 0!==Ms?Ms:Ad()}return Ae()}function Mc(){0===xc&&(xc=0===(536870912&ic)||ss?je():536870912);var e=so.current;return null!==e&&(e.flags|=32),xc}function Fc(e,t,r){(e!==sc||2!==oc&&9!==oc)&&null===e.cancelPendingCommit||(Vc(e,0),Uc(e,ic,xc,!1)),Se(e,r),0!==(2&ac)&&e===sc||(e===sc&&(0===(2&ac)&&(pc|=r),4===fc&&Uc(e,ic,xc,!1)),Nd(e))}function Lc(e,t,r){if(0!==(6&ac))throw Error(i(327));for(var a=!r&&0===(124&t)&&0===(t&e.expiredLanes)||ye(e,t),s=a?function(e,t){var r=ac;ac|=2;var a=qc(),s=$c();sc!==e||ic!==t?(kc=null,Nc=te()+500,Vc(e,t)):dc=ye(e,t);e:for(;;)try{if(0!==oc&&null!==nc){t=nc;var n=lc;t:switch(oc){case 1:oc=0,lc=null,ed(e,t,n,1);break;case 2:case 9:if(Ks(n)){oc=0,lc=null,Zc(t);break}t=function(){2!==oc&&9!==oc||sc!==e||(oc=7),Nd(e)},n.then(t,t);break e;case 3:oc=7;break e;case 4:oc=5;break e;case 7:Ks(n)?(oc=0,lc=null,Zc(t)):(oc=0,lc=null,ed(e,t,n,7));break;case 5:var o=null;switch(nc.tag){case 26:o=nc.memoizedState;case 5:case 27:var l=nc;if(!o||Wu(o)){oc=0,lc=null;var c=l.sibling;if(null!==c)nc=c;else{var d=l.return;null!==d?(nc=d,td(d)):nc=null}break t}}oc=0,lc=null,ed(e,t,n,5);break;case 6:oc=0,lc=null,ed(e,t,n,6);break;case 8:Hc(),fc=6;break e;default:throw Error(i(462))}}Xc();break}catch(u){Gc(e,u)}return xs=gs=null,O.H=a,O.A=s,ac=r,null!==nc?0:(sc=null,ic=0,Ta(),fc)}(e,t):Yc(e,t,!0),n=a;;){if(0===s){dc&&!a&&Uc(e,t,0,!1);break}if(r=e.current.alternate,!n||Bc(r)){if(2===s){if(n=t,e.errorRecoveryDisabledLanes&n)var o=0;else o=0!==(o=-536870913&e.pendingLanes)?o:536870912&o?536870912:0;if(0!==o){t=o;e:{var l=e;s=vc;var c=l.current.memoizedState.isDehydrated;if(c&&(Vc(l,o).flags|=256),2!==(o=Yc(l,o,!1))){if(uc&&!c){l.errorRecoveryDisabledLanes|=n,pc|=n,s=4;break e}n=yc,yc=s,null!==n&&(null===yc?yc=n:yc.push.apply(yc,n))}s=o}if(n=!1,2!==s)continue}}if(1===s){Vc(e,0),Uc(e,t,0,!0);break}e:{switch(a=e,n=s){case 0:case 1:throw Error(i(345));case 4:if((4194048&t)!==t)break;case 6:Uc(a,t,xc,!cc);break e;case 2:yc=null;break;case 3:case 5:break;default:throw Error(i(329))}if((62914560&t)===t&&10<(s=jc+300-te())){if(Uc(a,t,xc,!cc),0!==ve(a,0,!0))break e;a.timeoutHandle=cu(zc.bind(null,a,r,yc,kc,wc,t,xc,pc,bc,cc,n,2,-0,0),s)}else zc(a,r,yc,kc,wc,t,xc,pc,bc,cc,n,0,-0,0)}break}s=Yc(e,t,!1),n=!1}Nd(e)}function zc(e,t,r,a,s,n,o,l,c,d,u,h,f,m){if(e.timeoutHandle=-1,(8192&(h=t.subtreeFlags)||16785408===(16785408&h))&&(Hu={stylesheets:null,count:0,unsuspend:Vu},Yl(t),null!==(h=function(){if(null===Hu)throw Error(i(475));var e=Hu;return e.stylesheets&&0===e.count&&$u(e,e.stylesheets),0<e.count?function(t){var r=setTimeout(function(){if(e.stylesheets&&$u(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(r)}}:null}())))return e.cancelPendingCommit=h(ad.bind(null,e,t,n,r,a,s,o,l,c,u,1,f,m)),void Uc(e,n,o,!d);ad(e,t,n,r,a,s,o,l,c)}function Bc(e){for(var t=e;;){var r=t.tag;if((0===r||11===r||15===r)&&16384&t.flags&&(null!==(r=t.updateQueue)&&null!==(r=r.stores)))for(var a=0;a<r.length;a++){var s=r[a],n=s.getSnapshot;s=s.value;try{if(!Kr(n(),s))return!1}catch(i){return!1}}if(r=t.child,16384&t.subtreeFlags&&null!==r)r.return=t,t=r;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Uc(e,t,r,a){t&=~gc,t&=~pc,e.suspendedLanes|=t,e.pingedLanes&=~t,a&&(e.warmLanes|=t),a=e.expirationTimes;for(var s=t;0<s;){var n=31-fe(s),i=1<<n;a[n]=-1,s&=~i}0!==r&&Ee(e,r,t)}function Wc(){return 0!==(6&ac)||(kd(0,!1),!1)}function Hc(){if(null!==nc){if(0===oc)var e=nc.return;else xs=gs=null,Fn(e=nc),Yi=null,Ji=0,e=nc;for(;null!==e;)il(e.alternate,e),e=e.return;nc=null}}function Vc(e,t){var r=e.timeoutHandle;-1!==r&&(e.timeoutHandle=-1,du(r)),null!==(r=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,r()),Hc(),sc=e,nc=r=Fa(e.current,null),ic=t,oc=0,lc=null,cc=!1,dc=ye(e,t),uc=!1,bc=xc=gc=pc=mc=fc=0,yc=vc=null,wc=!1,0!==(8&t)&&(t|=32&t);var a=e.entangledLanes;if(0!==a)for(e=e.entanglements,a&=t;0<a;){var s=31-fe(a),n=1<<s;t|=e[s],a&=~n}return hc=t,Ta(),r}function Gc(e,t){vn=null,O.H=Gi,t===Vs||t===qs?(t=Qs(),oc=3):t===Gs?(t=Qs(),oc=4):oc=t===To?8:null!==t&&"object"===typeof t&&"function"===typeof t.then?6:1,lc=t,null===nc&&(fc=1,jo(e,Na(t,e.current)))}function qc(){var e=O.H;return O.H=Gi,null===e?Gi:e}function $c(){var e=O.A;return O.A=tc,e}function Kc(){fc=4,cc||(4194048&ic)!==ic&&null!==so.current||(dc=!0),0===(134217727&mc)&&0===(134217727&pc)||null===sc||Uc(sc,ic,xc,!1)}function Yc(e,t,r){var a=ac;ac|=2;var s=qc(),n=$c();sc===e&&ic===t||(kc=null,Vc(e,t)),t=!1;var i=fc;e:for(;;)try{if(0!==oc&&null!==nc){var o=nc,l=lc;switch(oc){case 8:Hc(),i=6;break e;case 3:case 2:case 9:case 6:null===so.current&&(t=!0);var c=oc;if(oc=0,lc=null,ed(e,o,l,c),r&&dc){i=0;break e}break;default:c=oc,oc=0,lc=null,ed(e,o,l,c)}}Jc(),i=fc;break}catch(d){Gc(e,d)}return t&&e.shellSuspendCounter++,xs=gs=null,ac=a,O.H=s,O.A=n,null===nc&&(sc=null,ic=0,Ta()),i}function Jc(){for(;null!==nc;)Qc(nc)}function Xc(){for(;null!==nc&&!Z();)Qc(nc)}function Qc(e){var t=Qo(e.alternate,e,hc);e.memoizedProps=e.pendingProps,null===t?td(e):nc=t}function Zc(e){var t=e,r=t.alternate;switch(t.tag){case 15:case 0:t=Fo(r,t,t.pendingProps,t.type,void 0,ic);break;case 11:t=Fo(r,t,t.pendingProps,t.type.render,t.ref,ic);break;case 5:Fn(t);default:il(r,t),t=Qo(r,t=nc=La(t,hc),hc)}e.memoizedProps=e.pendingProps,null===t?td(e):nc=t}function ed(e,t,r,a){xs=gs=null,Fn(t),Yi=null,Ji=0;var s=t.return;try{if(function(e,t,r,a,s){if(r.flags|=32768,null!==a&&"object"===typeof a&&"function"===typeof a.then){if(null!==(t=r.alternate)&&js(t,r,s,!0),null!==(r=so.current)){switch(r.tag){case 13:return null===no?Kc():null===r.alternate&&0===fc&&(fc=3),r.flags&=-257,r.flags|=65536,r.lanes=s,a===$s?r.flags|=16384:(null===(t=r.updateQueue)?r.updateQueue=new Set([a]):t.add(a),hd(e,a,s)),!1;case 22:return r.flags|=65536,a===$s?r.flags|=16384:(null===(t=r.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([a])},r.updateQueue=t):null===(r=t.retryQueue)?t.retryQueue=new Set([a]):r.add(a),hd(e,a,s)),!1}throw Error(i(435,r.tag))}return hd(e,a,s),Kc(),!1}if(ss)return null!==(t=so.current)?(0===(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=s,a!==os&&ms(Na(e=Error(i(422),{cause:a}),r))):(a!==os&&ms(Na(t=Error(i(423),{cause:a}),r)),(e=e.current.alternate).flags|=65536,s&=-s,e.lanes|=s,a=Na(a,r),on(e,s=ko(e.stateNode,a,s)),4!==fc&&(fc=2)),!1;var n=Error(i(520),{cause:a});if(n=Na(n,r),null===vc?vc=[n]:vc.push(n),4!==fc&&(fc=2),null===t)return!0;a=Na(a,r),r=t;do{switch(r.tag){case 3:return r.flags|=65536,e=s&-s,r.lanes|=e,on(r,e=ko(r.stateNode,a,e)),!1;case 1:if(t=r.type,n=r.stateNode,0===(128&r.flags)&&("function"===typeof t.getDerivedStateFromError||null!==n&&"function"===typeof n.componentDidCatch&&(null===Sc||!Sc.has(n))))return r.flags|=65536,s&=-s,r.lanes|=s,Eo(s=So(s),e,r,a),on(r,s),!1}r=r.return}while(null!==r);return!1}(e,s,t,r,ic))return fc=1,jo(e,Na(r,e.current)),void(nc=null)}catch(n){if(null!==s)throw nc=s,n;return fc=1,jo(e,Na(r,e.current)),void(nc=null)}32768&t.flags?(ss||1===a?e=!0:dc||0!==(536870912&ic)?e=!1:(cc=e=!0,(2===a||9===a||3===a||6===a)&&(null!==(a=so.current)&&13===a.tag&&(a.flags|=16384))),rd(t,e)):td(t)}function td(e){var t=e;do{if(0!==(32768&t.flags))return void rd(t,cc);e=t.return;var r=sl(t.alternate,t,hc);if(null!==r)return void(nc=r);if(null!==(t=t.sibling))return void(nc=t);nc=t=e}while(null!==t);0===fc&&(fc=5)}function rd(e,t){do{var r=nl(e.alternate,e);if(null!==r)return r.flags&=32767,void(nc=r);if(null!==(r=e.return)&&(r.flags|=32768,r.subtreeFlags=0,r.deletions=null),!t&&null!==(e=e.sibling))return void(nc=e);nc=e=r}while(null!==e);fc=6,nc=null}function ad(e,t,r,a,s,n,o,l,c){e.cancelPendingCommit=null;do{ld()}while(0!==Ec);if(0!==(6&ac))throw Error(i(327));if(null!==t){if(t===e.current)throw Error(i(177));if(n=t.lanes|t.childLanes,function(e,t,r,a,s,n){var i=e.pendingLanes;e.pendingLanes=r,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=r,e.entangledLanes&=r,e.errorRecoveryDisabledLanes&=r,e.shellSuspendCounter=0;var o=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(r=i&~r;0<r;){var d=31-fe(r),u=1<<d;o[d]=0,l[d]=-1;var h=c[d];if(null!==h)for(c[d]=null,d=0;d<h.length;d++){var f=h[d];null!==f&&(f.lane&=-536870913)}r&=~u}0!==a&&Ee(e,a,0),0!==n&&0===s&&0!==e.tag&&(e.suspendedLanes|=n&~(i&~t))}(e,r,n|=Ea,o,l,c),e===sc&&(nc=sc=null,ic=0),_c=t,Tc=e,Cc=r,Ac=n,Dc=s,Pc=a,0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?(e.callbackNode=null,e.callbackPriority=0,function(e,t){X(e,t)}(ne,function(){return cd(),null})):(e.callbackNode=null,e.callbackPriority=0),a=0!==(13878&t.flags),0!==(13878&t.subtreeFlags)||a){a=O.T,O.T=null,s=R.p,R.p=2,o=ac,ac|=4;try{!function(e,t){if(e=e.containerInfo,ru=ah,ea(e=Zr(e))){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{var a=(r=(r=e.ownerDocument)&&r.defaultView||window).getSelection&&r.getSelection();if(a&&0!==a.rangeCount){r=a.anchorNode;var s=a.anchorOffset,n=a.focusNode;a=a.focusOffset;try{r.nodeType,n.nodeType}catch(g){r=null;break e}var o=0,l=-1,c=-1,d=0,u=0,h=e,f=null;t:for(;;){for(var m;h!==r||0!==s&&3!==h.nodeType||(l=o+s),h!==n||0!==a&&3!==h.nodeType||(c=o+a),3===h.nodeType&&(o+=h.nodeValue.length),null!==(m=h.firstChild);)f=h,h=m;for(;;){if(h===e)break t;if(f===r&&++d===s&&(l=o),f===n&&++u===a&&(c=o),null!==(m=h.nextSibling))break;f=(h=f).parentNode}h=m}r=-1===l||-1===c?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(au={focusedElem:e,selectionRange:r},ah=!1,kl=t;null!==kl;)if(e=(t=kl).child,0!==(1024&t.subtreeFlags)&&null!==e)e.return=t,kl=e;else for(;null!==kl;){switch(n=(t=kl).alternate,e=t.flags,t.tag){case 0:case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&e)&&null!==n){e=void 0,r=t,s=n.memoizedProps,n=n.memoizedState,a=r.stateNode;try{var p=xo(r.type,s,(r.elementType,r.type));e=a.getSnapshotBeforeUpdate(p,n),a.__reactInternalSnapshotBeforeUpdate=e}catch(x){ud(r,r.return,x)}}break;case 3:if(0!==(1024&e))if(9===(r=(e=t.stateNode.containerInfo).nodeType))gu(e);else if(1===r)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":gu(e);break;default:e.textContent=""}break;default:if(0!==(1024&e))throw Error(i(163))}if(null!==(e=t.sibling)){e.return=t.return,kl=e;break}kl=t.return}}(e,t)}finally{ac=o,R.p=s,O.T=a}}Ec=1,sd(),nd(),id()}}function sd(){if(1===Ec){Ec=0;var e=Tc,t=_c,r=0!==(13878&t.flags);if(0!==(13878&t.subtreeFlags)||r){r=O.T,O.T=null;var a=R.p;R.p=2;var s=ac;ac|=4;try{Rl(t,e);var n=au,i=Zr(e.containerInfo),o=n.focusedElem,l=n.selectionRange;if(i!==o&&o&&o.ownerDocument&&Qr(o.ownerDocument.documentElement,o)){if(null!==l&&ea(o)){var c=l.start,d=l.end;if(void 0===d&&(d=c),"selectionStart"in o)o.selectionStart=c,o.selectionEnd=Math.min(d,o.value.length);else{var u=o.ownerDocument||document,h=u&&u.defaultView||window;if(h.getSelection){var f=h.getSelection(),m=o.textContent.length,p=Math.min(l.start,m),g=void 0===l.end?p:Math.min(l.end,m);!f.extend&&p>g&&(i=g,g=p,p=i);var x=Xr(o,p),b=Xr(o,g);if(x&&b&&(1!==f.rangeCount||f.anchorNode!==x.node||f.anchorOffset!==x.offset||f.focusNode!==b.node||f.focusOffset!==b.offset)){var v=u.createRange();v.setStart(x.node,x.offset),f.removeAllRanges(),p>g?(f.addRange(v),f.extend(b.node,b.offset)):(v.setEnd(b.node,b.offset),f.addRange(v))}}}}for(u=[],f=o;f=f.parentNode;)1===f.nodeType&&u.push({element:f,left:f.scrollLeft,top:f.scrollTop});for("function"===typeof o.focus&&o.focus(),o=0;o<u.length;o++){var y=u[o];y.element.scrollLeft=y.left,y.element.scrollTop=y.top}}ah=!!ru,au=ru=null}finally{ac=s,R.p=a,O.T=r}}e.current=t,Ec=2}}function nd(){if(2===Ec){Ec=0;var e=Tc,t=_c,r=0!==(8772&t.flags);if(0!==(8772&t.subtreeFlags)||r){r=O.T,O.T=null;var a=R.p;R.p=2;var s=ac;ac|=4;try{Sl(e,t.alternate,t)}finally{ac=s,R.p=a,O.T=r}}Ec=3}}function id(){if(4===Ec||3===Ec){Ec=0,ee();var e=Tc,t=_c,r=Cc,a=Pc;0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?Ec=5:(Ec=0,_c=Tc=null,od(e,e.pendingLanes));var s=e.pendingLanes;if(0===s&&(Sc=null),Ce(r),t=t.stateNode,ue&&"function"===typeof ue.onCommitFiberRoot)try{ue.onCommitFiberRoot(de,t,void 0,128===(128&t.current.flags))}catch(l){}if(null!==a){t=O.T,s=R.p,R.p=2,O.T=null;try{for(var n=e.onRecoverableError,i=0;i<a.length;i++){var o=a[i];n(o.value,{componentStack:o.stack})}}finally{O.T=t,R.p=s}}0!==(3&Cc)&&ld(),Nd(e),s=e.pendingLanes,0!==(4194090&r)&&0!==(42&s)?e===Oc?Ic++:(Ic=0,Oc=e):Ic=0,kd(0,!1)}}function od(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Is(t)))}function ld(e){return sd(),nd(),id(),cd()}function cd(){if(5!==Ec)return!1;var e=Tc,t=Ac;Ac=0;var r=Ce(Cc),a=O.T,s=R.p;try{R.p=32>r?32:r,O.T=null,r=Dc,Dc=null;var n=Tc,o=Cc;if(Ec=0,_c=Tc=null,Cc=0,0!==(6&ac))throw Error(i(331));var l=ac;if(ac|=4,Ql(n.current),Vl(n,n.current,o,r),ac=l,kd(0,!1),ue&&"function"===typeof ue.onPostCommitFiberRoot)try{ue.onPostCommitFiberRoot(de,n)}catch(c){}return!0}finally{R.p=s,O.T=a,od(e,t)}}function dd(e,t,r){t=Na(r,t),null!==(e=sn(e,t=ko(e.stateNode,t,2),2))&&(Se(e,2),Nd(e))}function ud(e,t,r){if(3===e.tag)dd(e,e,r);else for(;null!==t;){if(3===t.tag){dd(t,e,r);break}if(1===t.tag){var a=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof a.componentDidCatch&&(null===Sc||!Sc.has(a))){e=Na(r,e),null!==(a=sn(t,r=So(2),2))&&(Eo(r,a,t,e),Se(a,2),Nd(a));break}}t=t.return}}function hd(e,t,r){var a=e.pingCache;if(null===a){a=e.pingCache=new rc;var s=new Set;a.set(t,s)}else void 0===(s=a.get(t))&&(s=new Set,a.set(t,s));s.has(r)||(uc=!0,s.add(r),e=fd.bind(null,e,t,r),t.then(e,e))}function fd(e,t,r){var a=e.pingCache;null!==a&&a.delete(t),e.pingedLanes|=e.suspendedLanes&r,e.warmLanes&=~r,sc===e&&(ic&r)===r&&(4===fc||3===fc&&(62914560&ic)===ic&&300>te()-jc?0===(2&ac)&&Vc(e,0):gc|=r,bc===ic&&(bc=0)),Nd(e)}function md(e,t){0===t&&(t=Ne()),null!==(e=Aa(e,t))&&(Se(e,t),Nd(e))}function pd(e){var t=e.memoizedState,r=0;null!==t&&(r=t.retryLane),md(e,r)}function gd(e,t){var r=0;switch(e.tag){case 13:var a=e.stateNode,s=e.memoizedState;null!==s&&(r=s.retryLane);break;case 19:a=e.stateNode;break;case 22:a=e.stateNode._retryCache;break;default:throw Error(i(314))}null!==a&&a.delete(t),md(e,r)}var xd=null,bd=null,vd=!1,yd=!1,wd=!1,jd=0;function Nd(e){e!==bd&&null===e.next&&(null===bd?xd=bd=e:bd=bd.next=e),yd=!0,vd||(vd=!0,hu(function(){0!==(6&ac)?X(ae,Sd):Ed()}))}function kd(e,t){if(!wd&&yd){wd=!0;do{for(var r=!1,a=xd;null!==a;){if(!t)if(0!==e){var s=a.pendingLanes;if(0===s)var n=0;else{var i=a.suspendedLanes,o=a.pingedLanes;n=(1<<31-fe(42|e)+1)-1,n=201326741&(n&=s&~(i&~o))?201326741&n|1:n?2|n:0}0!==n&&(r=!0,Cd(a,n))}else n=ic,0===(3&(n=ve(a,a===sc?n:0,null!==a.cancelPendingCommit||-1!==a.timeoutHandle)))||ye(a,n)||(r=!0,Cd(a,n));a=a.next}}while(r);wd=!1}}function Sd(){Ed()}function Ed(){yd=vd=!1;var e=0;0!==jd&&(function(){var e=window.event;if(e&&"popstate"===e.type)return e!==lu&&(lu=e,!0);return lu=null,!1}()&&(e=jd),jd=0);for(var t=te(),r=null,a=xd;null!==a;){var s=a.next,n=Td(a,t);0===n?(a.next=null,null===r?xd=s:r.next=s,null===s&&(bd=r)):(r=a,(0!==e||0!==(3&n))&&(yd=!0)),a=s}kd(e,!1)}function Td(e,t){for(var r=e.suspendedLanes,a=e.pingedLanes,s=e.expirationTimes,n=-62914561&e.pendingLanes;0<n;){var i=31-fe(n),o=1<<i,l=s[i];-1===l?0!==(o&r)&&0===(o&a)||(s[i]=we(o,t)):l<=t&&(e.expiredLanes|=o),n&=~o}if(r=ic,r=ve(e,e===(t=sc)?r:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),a=e.callbackNode,0===r||e===t&&(2===oc||9===oc)||null!==e.cancelPendingCommit)return null!==a&&null!==a&&Q(a),e.callbackNode=null,e.callbackPriority=0;if(0===(3&r)||ye(e,r)){if((t=r&-r)===e.callbackPriority)return t;switch(null!==a&&Q(a),Ce(r)){case 2:case 8:r=se;break;case 32:default:r=ne;break;case 268435456:r=oe}return a=_d.bind(null,e),r=X(r,a),e.callbackPriority=t,e.callbackNode=r,t}return null!==a&&null!==a&&Q(a),e.callbackPriority=2,e.callbackNode=null,2}function _d(e,t){if(0!==Ec&&5!==Ec)return e.callbackNode=null,e.callbackPriority=0,null;var r=e.callbackNode;if(ld()&&e.callbackNode!==r)return null;var a=ic;return 0===(a=ve(e,e===sc?a:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(Lc(e,a,t),Td(e,te()),null!=e.callbackNode&&e.callbackNode===r?_d.bind(null,e):null)}function Cd(e,t){if(ld())return null;Lc(e,t,!0)}function Ad(){return 0===jd&&(jd=je()),jd}function Dd(e){return null==e||"symbol"===typeof e||"boolean"===typeof e?null:"function"===typeof e?e:Ct(""+e)}function Pd(e,t){var r=t.ownerDocument.createElement("input");return r.name=t.name,r.value=t.value,e.id&&r.setAttribute("form",e.id),t.parentNode.insertBefore(r,t),e=new FormData(e),r.parentNode.removeChild(r),e}for(var Id=0;Id<ya.length;Id++){var Od=ya[Id];wa(Od.toLowerCase(),"on"+(Od[0].toUpperCase()+Od.slice(1)))}wa(ha,"onAnimationEnd"),wa(fa,"onAnimationIteration"),wa(ma,"onAnimationStart"),wa("dblclick","onDoubleClick"),wa("focusin","onFocus"),wa("focusout","onBlur"),wa(pa,"onTransitionRun"),wa(ga,"onTransitionStart"),wa(xa,"onTransitionCancel"),wa(ba,"onTransitionEnd"),Ye("onMouseEnter",["mouseout","mouseover"]),Ye("onMouseLeave",["mouseout","mouseover"]),Ye("onPointerEnter",["pointerout","pointerover"]),Ye("onPointerLeave",["pointerout","pointerover"]),Ke("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ke("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ke("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ke("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ke("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ke("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Md=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Rd));function Fd(e,t){t=0!==(4&t);for(var r=0;r<e.length;r++){var a=e[r],s=a.event;a=a.listeners;e:{var n=void 0;if(t)for(var i=a.length-1;0<=i;i--){var o=a[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==n&&s.isPropagationStopped())break e;n=o,s.currentTarget=c;try{n(s)}catch(d){bo(d)}s.currentTarget=null,n=l}else for(i=0;i<a.length;i++){if(l=(o=a[i]).instance,c=o.currentTarget,o=o.listener,l!==n&&s.isPropagationStopped())break e;n=o,s.currentTarget=c;try{n(s)}catch(d){bo(d)}s.currentTarget=null,n=l}}}}function Ld(e,t){var r=t[Re];void 0===r&&(r=t[Re]=new Set);var a=e+"__bubble";r.has(a)||(Wd(t,e,2,!1),r.add(a))}function zd(e,t,r){var a=0;t&&(a|=4),Wd(r,e,a,t)}var Bd="_reactListening"+Math.random().toString(36).slice(2);function Ud(e){if(!e[Bd]){e[Bd]=!0,qe.forEach(function(t){"selectionchange"!==t&&(Md.has(t)||zd(t,!1,e),zd(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Bd]||(t[Bd]=!0,zd("selectionchange",!1,t))}}function Wd(e,t,r,a){switch(dh(t)){case 2:var s=sh;break;case 8:s=nh;break;default:s=ih}r=s.bind(null,t,r,e),s=void 0,!zt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(s=!0),a?void 0!==s?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):void 0!==s?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function Hd(e,t,r,a,s){var n=a;if(0===(1&t)&&0===(2&t)&&null!==a)e:for(;;){if(null===a)return;var i=a.tag;if(3===i||4===i){var o=a.stateNode.containerInfo;if(o===s)break;if(4===i)for(i=a.return;null!==i;){var c=i.tag;if((3===c||4===c)&&i.stateNode.containerInfo===s)return;i=i.return}for(;null!==o;){if(null===(i=Ue(o)))return;if(5===(c=i.tag)||6===c||26===c||27===c){a=n=i;continue e}o=o.parentNode}}a=a.return}Mt(function(){var a=n,s=Dt(r),i=[];e:{var o=va.get(e);if(void 0!==o){var c=Zt,d=e;switch(e){case"keypress":if(0===Gt(r))break e;case"keydown":case"keyup":c=mr;break;case"focusin":d="focus",c=nr;break;case"focusout":d="blur",c=nr;break;case"beforeblur":case"afterblur":c=nr;break;case"click":if(2===r.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=ar;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=sr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=gr;break;case ha:case fa:case ma:c=ir;break;case ba:c=xr;break;case"scroll":case"scrollend":c=tr;break;case"wheel":c=br;break;case"copy":case"cut":case"paste":c=or;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=pr;break;case"toggle":case"beforetoggle":c=vr}var u=0!==(4&t),h=!u&&("scroll"===e||"scrollend"===e),f=u?null!==o?o+"Capture":null:o;u=[];for(var m,p=a;null!==p;){var g=p;if(m=g.stateNode,5!==(g=g.tag)&&26!==g&&27!==g||null===m||null===f||null!=(g=Ft(p,f))&&u.push(Vd(p,g,m)),h)break;p=p.return}0<u.length&&(o=new c(o,d,null,r,s),i.push({event:o,listeners:u}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||r===At||!(d=r.relatedTarget||r.fromElement)||!Ue(d)&&!d[Oe])&&(c||o)&&(o=s.window===s?s:(o=s.ownerDocument)?o.defaultView||o.parentWindow:window,c?(c=a,null!==(d=(d=r.relatedTarget||r.toElement)?Ue(d):null)&&(h=l(d),u=d.tag,d!==h||5!==u&&27!==u&&6!==u)&&(d=null)):(c=null,d=a),c!==d)){if(u=ar,g="onMouseLeave",f="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=pr,g="onPointerLeave",f="onPointerEnter",p="pointer"),h=null==c?o:He(c),m=null==d?o:He(d),(o=new u(g,p+"leave",c,r,s)).target=h,o.relatedTarget=m,g=null,Ue(s)===a&&((u=new u(f,p+"enter",d,r,s)).target=m,u.relatedTarget=h,g=u),h=g,c&&d)e:{for(f=d,p=0,m=u=c;m;m=qd(m))p++;for(m=0,g=f;g;g=qd(g))m++;for(;0<p-m;)u=qd(u),p--;for(;0<m-p;)f=qd(f),m--;for(;p--;){if(u===f||null!==f&&u===f.alternate)break e;u=qd(u),f=qd(f)}u=null}else u=null;null!==c&&$d(i,o,c,u,!1),null!==d&&null!==h&&$d(i,h,d,u,!0)}if("select"===(c=(o=a?He(a):window).nodeName&&o.nodeName.toLowerCase())||"input"===c&&"file"===o.type)var x=Fr;else if(Dr(o))if(Lr)x=$r;else{x=Gr;var b=Vr}else!(c=o.nodeName)||"input"!==c.toLowerCase()||"checkbox"!==o.type&&"radio"!==o.type?a&&Et(a.elementType)&&(x=Fr):x=qr;switch(x&&(x=x(e,a))?Pr(i,x,r,s):(b&&b(e,o,a),"focusout"===e&&a&&"number"===o.type&&null!=a.memoizedProps.value&&bt(o,"number",o.value)),b=a?He(a):window,e){case"focusin":(Dr(b)||"true"===b.contentEditable)&&(ra=b,aa=a,sa=null);break;case"focusout":sa=aa=ra=null;break;case"mousedown":na=!0;break;case"contextmenu":case"mouseup":case"dragend":na=!1,ia(i,r,s);break;case"selectionchange":if(ta)break;case"keydown":case"keyup":ia(i,r,s)}var v;if(wr)e:{switch(e){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else Cr?Tr(e,r)&&(y="onCompositionEnd"):"keydown"===e&&229===r.keyCode&&(y="onCompositionStart");y&&(kr&&"ko"!==r.locale&&(Cr||"onCompositionStart"!==y?"onCompositionEnd"===y&&Cr&&(v=Vt()):(Wt="value"in(Ut=s)?Ut.value:Ut.textContent,Cr=!0)),0<(b=Gd(a,y)).length&&(y=new lr(y,e,null,r,s),i.push({event:y,listeners:b}),v?y.data=v:null!==(v=_r(r))&&(y.data=v))),(v=Nr?function(e,t){switch(e){case"compositionend":return _r(t);case"keypress":return 32!==t.which?null:(Er=!0,Sr);case"textInput":return(e=t.data)===Sr&&Er?null:e;default:return null}}(e,r):function(e,t){if(Cr)return"compositionend"===e||!wr&&Tr(e,t)?(e=Vt(),Ht=Wt=Ut=null,Cr=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return kr&&"ko"!==t.locale?null:t.data}}(e,r))&&(0<(y=Gd(a,"onBeforeInput")).length&&(b=new lr("onBeforeInput","beforeinput",null,r,s),i.push({event:b,listeners:y}),b.data=v)),function(e,t,r,a,s){if("submit"===t&&r&&r.stateNode===s){var n=Dd((s[Ie]||null).action),i=a.submitter;i&&null!==(t=(t=i[Ie]||null)?Dd(t.formAction):i.getAttribute("formAction"))&&(n=t,i=null);var o=new Zt("action","action",null,a,s);e.push({event:o,listeners:[{instance:null,listener:function(){if(a.defaultPrevented){if(0!==jd){var e=i?Pd(s,i):new FormData(s);Di(r,{pending:!0,data:e,method:s.method,action:n},null,e)}}else"function"===typeof n&&(o.preventDefault(),e=i?Pd(s,i):new FormData(s),Di(r,{pending:!0,data:e,method:s.method,action:n},n,e))},currentTarget:s}]})}}(i,e,a,r,s)}Fd(i,t)})}function Vd(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Gd(e,t){for(var r=t+"Capture",a=[];null!==e;){var s=e,n=s.stateNode;if(5!==(s=s.tag)&&26!==s&&27!==s||null===n||(null!=(s=Ft(e,r))&&a.unshift(Vd(e,s,n)),null!=(s=Ft(e,t))&&a.push(Vd(e,s,n))),3===e.tag)return a;e=e.return}return[]}function qd(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function $d(e,t,r,a,s){for(var n=t._reactName,i=[];null!==r&&r!==a;){var o=r,l=o.alternate,c=o.stateNode;if(o=o.tag,null!==l&&l===a)break;5!==o&&26!==o&&27!==o||null===c||(l=c,s?null!=(c=Ft(r,n))&&i.unshift(Vd(r,c,l)):s||null!=(c=Ft(r,n))&&i.push(Vd(r,c,l))),r=r.return}0!==i.length&&e.push({event:t,listeners:i})}var Kd=/\r\n?/g,Yd=/\u0000|\uFFFD/g;function Jd(e){return("string"===typeof e?e:""+e).replace(Kd,"\n").replace(Yd,"")}function Xd(e,t){return t=Jd(t),Jd(e)===t}function Qd(){}function Zd(e,t,r,a,s,n){switch(r){case"children":"string"===typeof a?"body"===t||"textarea"===t&&""===a||jt(e,a):("number"===typeof a||"bigint"===typeof a)&&"body"!==t&&jt(e,""+a);break;case"className":rt(e,"class",a);break;case"tabIndex":rt(e,"tabindex",a);break;case"dir":case"role":case"viewBox":case"width":case"height":rt(e,r,a);break;case"style":St(e,a,n);break;case"data":if("object"!==t){rt(e,"data",a);break}case"src":case"href":if(""===a&&("a"!==t||"href"!==r)){e.removeAttribute(r);break}if(null==a||"function"===typeof a||"symbol"===typeof a||"boolean"===typeof a){e.removeAttribute(r);break}a=Ct(""+a),e.setAttribute(r,a);break;case"action":case"formAction":if("function"===typeof a){e.setAttribute(r,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof n&&("formAction"===r?("input"!==t&&Zd(e,t,"name",s.name,s,null),Zd(e,t,"formEncType",s.formEncType,s,null),Zd(e,t,"formMethod",s.formMethod,s,null),Zd(e,t,"formTarget",s.formTarget,s,null)):(Zd(e,t,"encType",s.encType,s,null),Zd(e,t,"method",s.method,s,null),Zd(e,t,"target",s.target,s,null))),null==a||"symbol"===typeof a||"boolean"===typeof a){e.removeAttribute(r);break}a=Ct(""+a),e.setAttribute(r,a);break;case"onClick":null!=a&&(e.onclick=Qd);break;case"onScroll":null!=a&&Ld("scroll",e);break;case"onScrollEnd":null!=a&&Ld("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=a){if("object"!==typeof a||!("__html"in a))throw Error(i(61));if(null!=(r=a.__html)){if(null!=s.children)throw Error(i(60));e.innerHTML=r}}break;case"multiple":e.multiple=a&&"function"!==typeof a&&"symbol"!==typeof a;break;case"muted":e.muted=a&&"function"!==typeof a&&"symbol"!==typeof a;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==a||"function"===typeof a||"boolean"===typeof a||"symbol"===typeof a){e.removeAttribute("xlink:href");break}r=Ct(""+a),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=a&&"function"!==typeof a&&"symbol"!==typeof a?e.setAttribute(r,""+a):e.removeAttribute(r);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":a&&"function"!==typeof a&&"symbol"!==typeof a?e.setAttribute(r,""):e.removeAttribute(r);break;case"capture":case"download":!0===a?e.setAttribute(r,""):!1!==a&&null!=a&&"function"!==typeof a&&"symbol"!==typeof a?e.setAttribute(r,a):e.removeAttribute(r);break;case"cols":case"rows":case"size":case"span":null!=a&&"function"!==typeof a&&"symbol"!==typeof a&&!isNaN(a)&&1<=a?e.setAttribute(r,a):e.removeAttribute(r);break;case"rowSpan":case"start":null==a||"function"===typeof a||"symbol"===typeof a||isNaN(a)?e.removeAttribute(r):e.setAttribute(r,a);break;case"popover":Ld("beforetoggle",e),Ld("toggle",e),tt(e,"popover",a);break;case"xlinkActuate":at(e,"http://www.w3.org/1999/xlink","xlink:actuate",a);break;case"xlinkArcrole":at(e,"http://www.w3.org/1999/xlink","xlink:arcrole",a);break;case"xlinkRole":at(e,"http://www.w3.org/1999/xlink","xlink:role",a);break;case"xlinkShow":at(e,"http://www.w3.org/1999/xlink","xlink:show",a);break;case"xlinkTitle":at(e,"http://www.w3.org/1999/xlink","xlink:title",a);break;case"xlinkType":at(e,"http://www.w3.org/1999/xlink","xlink:type",a);break;case"xmlBase":at(e,"http://www.w3.org/XML/1998/namespace","xml:base",a);break;case"xmlLang":at(e,"http://www.w3.org/XML/1998/namespace","xml:lang",a);break;case"xmlSpace":at(e,"http://www.w3.org/XML/1998/namespace","xml:space",a);break;case"is":tt(e,"is",a);break;case"innerText":case"textContent":break;default:(!(2<r.length)||"o"!==r[0]&&"O"!==r[0]||"n"!==r[1]&&"N"!==r[1])&&tt(e,r=Tt.get(r)||r,a)}}function eu(e,t,r,a,s,n){switch(r){case"style":St(e,a,n);break;case"dangerouslySetInnerHTML":if(null!=a){if("object"!==typeof a||!("__html"in a))throw Error(i(61));if(null!=(r=a.__html)){if(null!=s.children)throw Error(i(60));e.innerHTML=r}}break;case"children":"string"===typeof a?jt(e,a):("number"===typeof a||"bigint"===typeof a)&&jt(e,""+a);break;case"onScroll":null!=a&&Ld("scroll",e);break;case"onScrollEnd":null!=a&&Ld("scrollend",e);break;case"onClick":null!=a&&(e.onclick=Qd);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:$e.hasOwnProperty(r)||("o"!==r[0]||"n"!==r[1]||(s=r.endsWith("Capture"),t=r.slice(2,s?r.length-7:void 0),"function"===typeof(n=null!=(n=e[Ie]||null)?n[r]:null)&&e.removeEventListener(t,n,s),"function"!==typeof a)?r in e?e[r]=a:!0===a?e.setAttribute(r,""):tt(e,r,a):("function"!==typeof n&&null!==n&&(r in e?e[r]=null:e.hasAttribute(r)&&e.removeAttribute(r)),e.addEventListener(t,a,s)))}}function tu(e,t,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ld("error",e),Ld("load",e);var a,s=!1,n=!1;for(a in r)if(r.hasOwnProperty(a)){var o=r[a];if(null!=o)switch(a){case"src":s=!0;break;case"srcSet":n=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,t));default:Zd(e,t,a,o,r,null)}}return n&&Zd(e,t,"srcSet",r.srcSet,r,null),void(s&&Zd(e,t,"src",r.src,r,null));case"input":Ld("invalid",e);var l=a=o=n=null,c=null,d=null;for(s in r)if(r.hasOwnProperty(s)){var u=r[s];if(null!=u)switch(s){case"name":n=u;break;case"type":o=u;break;case"checked":c=u;break;case"defaultChecked":d=u;break;case"value":a=u;break;case"defaultValue":l=u;break;case"children":case"dangerouslySetInnerHTML":if(null!=u)throw Error(i(137,t));break;default:Zd(e,t,s,u,r,null)}}return xt(e,a,l,c,d,o,n,!1),void ut(e);case"select":for(n in Ld("invalid",e),s=o=a=null,r)if(r.hasOwnProperty(n)&&null!=(l=r[n]))switch(n){case"value":a=l;break;case"defaultValue":o=l;break;case"multiple":s=l;default:Zd(e,t,n,l,r,null)}return t=a,r=o,e.multiple=!!s,void(null!=t?vt(e,!!s,t,!1):null!=r&&vt(e,!!s,r,!0));case"textarea":for(o in Ld("invalid",e),a=n=s=null,r)if(r.hasOwnProperty(o)&&null!=(l=r[o]))switch(o){case"value":s=l;break;case"defaultValue":n=l;break;case"children":a=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(i(91));break;default:Zd(e,t,o,l,r,null)}return wt(e,s,n,a),void ut(e);case"option":for(c in r)if(r.hasOwnProperty(c)&&null!=(s=r[c]))if("selected"===c)e.selected=s&&"function"!==typeof s&&"symbol"!==typeof s;else Zd(e,t,c,s,r,null);return;case"dialog":Ld("beforetoggle",e),Ld("toggle",e),Ld("cancel",e),Ld("close",e);break;case"iframe":case"object":Ld("load",e);break;case"video":case"audio":for(s=0;s<Rd.length;s++)Ld(Rd[s],e);break;case"image":Ld("error",e),Ld("load",e);break;case"details":Ld("toggle",e);break;case"embed":case"source":case"link":Ld("error",e),Ld("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(d in r)if(r.hasOwnProperty(d)&&null!=(s=r[d]))switch(d){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,t));default:Zd(e,t,d,s,r,null)}return;default:if(Et(t)){for(u in r)r.hasOwnProperty(u)&&(void 0!==(s=r[u])&&eu(e,t,u,s,r,void 0));return}}for(l in r)r.hasOwnProperty(l)&&(null!=(s=r[l])&&Zd(e,t,l,s,r,null))}var ru=null,au=null;function su(e){return 9===e.nodeType?e:e.ownerDocument}function nu(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function iu(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function ou(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"bigint"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var lu=null;var cu="function"===typeof setTimeout?setTimeout:void 0,du="function"===typeof clearTimeout?clearTimeout:void 0,uu="function"===typeof Promise?Promise:void 0,hu="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof uu?function(e){return uu.resolve(null).then(e).catch(fu)}:cu;function fu(e){setTimeout(function(){throw e})}function mu(e){return"head"===e}function pu(e,t){var r=t,a=0,s=0;do{var n=r.nextSibling;if(e.removeChild(r),n&&8===n.nodeType)if("/$"===(r=n.data)){if(0<a&&8>a){r=a;var i=e.ownerDocument;if(1&r&&ju(i.documentElement),2&r&&ju(i.body),4&r)for(ju(r=i.head),i=r.firstChild;i;){var o=i.nextSibling,l=i.nodeName;i[ze]||"SCRIPT"===l||"STYLE"===l||"LINK"===l&&"stylesheet"===i.rel.toLowerCase()||r.removeChild(i),i=o}}if(0===s)return e.removeChild(n),void _h(t);s--}else"$"===r||"$?"===r||"$!"===r?s++:a=r.charCodeAt(0)-48;else a=0;r=n}while(r);_h(t)}function gu(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var r=t;switch(t=t.nextSibling,r.nodeName){case"HTML":case"HEAD":case"BODY":gu(r),Be(r);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===r.rel.toLowerCase())continue}e.removeChild(r)}}function xu(e){return"$!"===e.data||"$?"===e.data&&"complete"===e.ownerDocument.readyState}function bu(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"F!"===t||"F"===t)break;if("/$"===t)return null}}return e}var vu=null;function yu(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var r=e.data;if("$"===r||"$!"===r||"$?"===r){if(0===t)return e;t--}else"/$"===r&&t++}e=e.previousSibling}return null}function wu(e,t,r){switch(t=su(r),e){case"html":if(!(e=t.documentElement))throw Error(i(452));return e;case"head":if(!(e=t.head))throw Error(i(453));return e;case"body":if(!(e=t.body))throw Error(i(454));return e;default:throw Error(i(451))}}function ju(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Be(e)}var Nu=new Map,ku=new Set;function Su(e){return"function"===typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var Eu=R.d;R.d={f:function(){var e=Eu.f(),t=Wc();return e||t},r:function(e){var t=We(e);null!==t&&5===t.tag&&"form"===t.type?Ii(t):Eu.r(e)},D:function(e){Eu.D(e),_u("dns-prefetch",e,null)},C:function(e,t){Eu.C(e,t),_u("preconnect",e,t)},L:function(e,t,r){Eu.L(e,t,r);var a=Tu;if(a&&e&&t){var s='link[rel="preload"][as="'+pt(t)+'"]';"image"===t&&r&&r.imageSrcSet?(s+='[imagesrcset="'+pt(r.imageSrcSet)+'"]',"string"===typeof r.imageSizes&&(s+='[imagesizes="'+pt(r.imageSizes)+'"]')):s+='[href="'+pt(e)+'"]';var n=s;switch(t){case"style":n=Au(e);break;case"script":n=Iu(e)}Nu.has(n)||(e=h({rel:"preload",href:"image"===t&&r&&r.imageSrcSet?void 0:e,as:t},r),Nu.set(n,e),null!==a.querySelector(s)||"style"===t&&a.querySelector(Du(n))||"script"===t&&a.querySelector(Ou(n))||(tu(t=a.createElement("link"),"link",e),Ge(t),a.head.appendChild(t)))}},m:function(e,t){Eu.m(e,t);var r=Tu;if(r&&e){var a=t&&"string"===typeof t.as?t.as:"script",s='link[rel="modulepreload"][as="'+pt(a)+'"][href="'+pt(e)+'"]',n=s;switch(a){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":n=Iu(e)}if(!Nu.has(n)&&(e=h({rel:"modulepreload",href:e},t),Nu.set(n,e),null===r.querySelector(s))){switch(a){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(r.querySelector(Ou(n)))return}tu(a=r.createElement("link"),"link",e),Ge(a),r.head.appendChild(a)}}},X:function(e,t){Eu.X(e,t);var r=Tu;if(r&&e){var a=Ve(r).hoistableScripts,s=Iu(e),n=a.get(s);n||((n=r.querySelector(Ou(s)))||(e=h({src:e,async:!0},t),(t=Nu.get(s))&&Lu(e,t),Ge(n=r.createElement("script")),tu(n,"link",e),r.head.appendChild(n)),n={type:"script",instance:n,count:1,state:null},a.set(s,n))}},S:function(e,t,r){Eu.S(e,t,r);var a=Tu;if(a&&e){var s=Ve(a).hoistableStyles,n=Au(e);t=t||"default";var i=s.get(n);if(!i){var o={loading:0,preload:null};if(i=a.querySelector(Du(n)))o.loading=5;else{e=h({rel:"stylesheet",href:e,"data-precedence":t},r),(r=Nu.get(n))&&Fu(e,r);var l=i=a.createElement("link");Ge(l),tu(l,"link",e),l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),l.addEventListener("load",function(){o.loading|=1}),l.addEventListener("error",function(){o.loading|=2}),o.loading|=4,Mu(i,t,a)}i={type:"stylesheet",instance:i,count:1,state:o},s.set(n,i)}}},M:function(e,t){Eu.M(e,t);var r=Tu;if(r&&e){var a=Ve(r).hoistableScripts,s=Iu(e),n=a.get(s);n||((n=r.querySelector(Ou(s)))||(e=h({src:e,async:!0,type:"module"},t),(t=Nu.get(s))&&Lu(e,t),Ge(n=r.createElement("script")),tu(n,"link",e),r.head.appendChild(n)),n={type:"script",instance:n,count:1,state:null},a.set(s,n))}}};var Tu="undefined"===typeof document?null:document;function _u(e,t,r){var a=Tu;if(a&&"string"===typeof t&&t){var s=pt(t);s='link[rel="'+e+'"][href="'+s+'"]',"string"===typeof r&&(s+='[crossorigin="'+r+'"]'),ku.has(s)||(ku.add(s),e={rel:e,crossOrigin:r,href:t},null===a.querySelector(s)&&(tu(t=a.createElement("link"),"link",e),Ge(t),a.head.appendChild(t)))}}function Cu(e,t,r,a){var s,n,o,l,c=(c=V.current)?Su(c):null;if(!c)throw Error(i(446));switch(e){case"meta":case"title":return null;case"style":return"string"===typeof r.precedence&&"string"===typeof r.href?(t=Au(r.href),(a=(r=Ve(c).hoistableStyles).get(t))||(a={type:"style",instance:null,count:0,state:null},r.set(t,a)),a):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===r.rel&&"string"===typeof r.href&&"string"===typeof r.precedence){e=Au(r.href);var d=Ve(c).hoistableStyles,u=d.get(e);if(u||(c=c.ownerDocument||c,u={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},d.set(e,u),(d=c.querySelector(Du(e)))&&!d._p&&(u.instance=d,u.state.loading=5),Nu.has(e)||(r={rel:"preload",as:"style",href:r.href,crossOrigin:r.crossOrigin,integrity:r.integrity,media:r.media,hrefLang:r.hrefLang,referrerPolicy:r.referrerPolicy},Nu.set(e,r),d||(s=c,n=e,o=r,l=u.state,s.querySelector('link[rel="preload"][as="style"]['+n+"]")?l.loading=1:(n=s.createElement("link"),l.preload=n,n.addEventListener("load",function(){return l.loading|=1}),n.addEventListener("error",function(){return l.loading|=2}),tu(n,"link",o),Ge(n),s.head.appendChild(n))))),t&&null===a)throw Error(i(528,""));return u}if(t&&null!==a)throw Error(i(529,""));return null;case"script":return t=r.async,"string"===typeof(r=r.src)&&t&&"function"!==typeof t&&"symbol"!==typeof t?(t=Iu(r),(a=(r=Ve(c).hoistableScripts).get(t))||(a={type:"script",instance:null,count:0,state:null},r.set(t,a)),a):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,e))}}function Au(e){return'href="'+pt(e)+'"'}function Du(e){return'link[rel="stylesheet"]['+e+"]"}function Pu(e){return h({},e,{"data-precedence":e.precedence,precedence:null})}function Iu(e){return'[src="'+pt(e)+'"]'}function Ou(e){return"script[async]"+e}function Ru(e,t,r){if(t.count++,null===t.instance)switch(t.type){case"style":var a=e.querySelector('style[data-href~="'+pt(r.href)+'"]');if(a)return t.instance=a,Ge(a),a;var s=h({},r,{"data-href":r.href,"data-precedence":r.precedence,href:null,precedence:null});return Ge(a=(e.ownerDocument||e).createElement("style")),tu(a,"style",s),Mu(a,r.precedence,e),t.instance=a;case"stylesheet":s=Au(r.href);var n=e.querySelector(Du(s));if(n)return t.state.loading|=4,t.instance=n,Ge(n),n;a=Pu(r),(s=Nu.get(s))&&Fu(a,s),Ge(n=(e.ownerDocument||e).createElement("link"));var o=n;return o._p=new Promise(function(e,t){o.onload=e,o.onerror=t}),tu(n,"link",a),t.state.loading|=4,Mu(n,r.precedence,e),t.instance=n;case"script":return n=Iu(r.src),(s=e.querySelector(Ou(n)))?(t.instance=s,Ge(s),s):(a=r,(s=Nu.get(n))&&Lu(a=h({},r),s),Ge(s=(e=e.ownerDocument||e).createElement("script")),tu(s,"link",a),e.head.appendChild(s),t.instance=s);case"void":return null;default:throw Error(i(443,t.type))}else"stylesheet"===t.type&&0===(4&t.state.loading)&&(a=t.instance,t.state.loading|=4,Mu(a,r.precedence,e));return t.instance}function Mu(e,t,r){for(var a=r.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),s=a.length?a[a.length-1]:null,n=s,i=0;i<a.length;i++){var o=a[i];if(o.dataset.precedence===t)n=o;else if(n!==s)break}n?n.parentNode.insertBefore(e,n.nextSibling):(t=9===r.nodeType?r.head:r).insertBefore(e,t.firstChild)}function Fu(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function Lu(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var zu=null;function Bu(e,t,r){if(null===zu){var a=new Map,s=zu=new Map;s.set(r,a)}else(a=(s=zu).get(r))||(a=new Map,s.set(r,a));if(a.has(e))return a;for(a.set(e,null),r=r.getElementsByTagName(e),s=0;s<r.length;s++){var n=r[s];if(!(n[ze]||n[Pe]||"link"===e&&"stylesheet"===n.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==n.namespaceURI){var i=n.getAttribute(t)||"";i=e+i;var o=a.get(i);o?o.push(n):a.set(i,[n])}}return a}function Uu(e,t,r){(e=e.ownerDocument||e).head.insertBefore(r,"title"===t?e.querySelector("head > title"):null)}function Wu(e){return"stylesheet"!==e.type||0!==(3&e.state.loading)}var Hu=null;function Vu(){}function Gu(){if(this.count--,0===this.count)if(this.stylesheets)$u(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var qu=null;function $u(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,qu=new Map,t.forEach(Ku,e),qu=null,Gu.call(e))}function Ku(e,t){if(!(4&t.state.loading)){var r=qu.get(e);if(r)var a=r.get(null);else{r=new Map,qu.set(e,r);for(var s=e.querySelectorAll("link[data-precedence],style[data-precedence]"),n=0;n<s.length;n++){var i=s[n];"LINK"!==i.nodeName&&"not all"===i.getAttribute("media")||(r.set(i.dataset.precedence,i),a=i)}a&&r.set(null,a)}i=(s=t.instance).getAttribute("data-precedence"),(n=r.get(i)||a)===a&&r.set(null,s),r.set(i,s),this.count++,a=Gu.bind(this),s.addEventListener("load",a),s.addEventListener("error",a),n?n.parentNode.insertBefore(s,n.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(s,e.firstChild),t.state.loading|=4}}var Yu={$$typeof:w,Provider:null,Consumer:null,_currentValue:M,_currentValue2:M,_threadCount:0};function Ju(e,t,r,a,s,n,i,o){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ke(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ke(0),this.hiddenUpdates=ke(null),this.identifierPrefix=a,this.onUncaughtError=s,this.onCaughtError=n,this.onRecoverableError=i,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=o,this.incompleteTransitions=new Map}function Xu(e,t,r,a,s,n,i,o,l,c,d,u){return e=new Ju(e,t,r,i,o,l,c,u),t=1,!0===n&&(t|=24),n=Ra(3,null,null,t),e.current=n,n.stateNode=e,(t=Ps()).refCount++,e.pooledCache=t,t.refCount++,n.memoizedState={element:a,isDehydrated:r,cache:t},tn(n),e}function Qu(e){return e?e=Ia:Ia}function Zu(e,t,r,a,s,n){s=Qu(s),null===a.context?a.context=s:a.pendingContext=s,(a=an(t)).payload={element:r},null!==(n=void 0===n?null:n)&&(a.callback=n),null!==(r=sn(e,a,t))&&(Fc(r,0,t),nn(r,e,t))}function eh(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var r=e.retryLane;e.retryLane=0!==r&&r<t?r:t}}function th(e,t){eh(e,t),(e=e.alternate)&&eh(e,t)}function rh(e){if(13===e.tag){var t=Aa(e,67108864);null!==t&&Fc(t,0,67108864),th(e,67108864)}}var ah=!0;function sh(e,t,r,a){var s=O.T;O.T=null;var n=R.p;try{R.p=2,ih(e,t,r,a)}finally{R.p=n,O.T=s}}function nh(e,t,r,a){var s=O.T;O.T=null;var n=R.p;try{R.p=8,ih(e,t,r,a)}finally{R.p=n,O.T=s}}function ih(e,t,r,a){if(ah){var s=oh(a);if(null===s)Hd(e,t,a,lh,r),vh(e,a);else if(function(e,t,r,a,s){switch(t){case"focusin":return hh=yh(hh,e,t,r,a,s),!0;case"dragenter":return fh=yh(fh,e,t,r,a,s),!0;case"mouseover":return mh=yh(mh,e,t,r,a,s),!0;case"pointerover":var n=s.pointerId;return ph.set(n,yh(ph.get(n)||null,e,t,r,a,s)),!0;case"gotpointercapture":return n=s.pointerId,gh.set(n,yh(gh.get(n)||null,e,t,r,a,s)),!0}return!1}(s,e,t,r,a))a.stopPropagation();else if(vh(e,a),4&t&&-1<bh.indexOf(e)){for(;null!==s;){var n=We(s);if(null!==n)switch(n.tag){case 3:if((n=n.stateNode).current.memoizedState.isDehydrated){var i=be(n.pendingLanes);if(0!==i){var o=n;for(o.pendingLanes|=2,o.entangledLanes|=2;i;){var l=1<<31-fe(i);o.entanglements[1]|=l,i&=~l}Nd(n),0===(6&ac)&&(Nc=te()+500,kd(0,!1))}}break;case 13:null!==(o=Aa(n,2))&&Fc(o,0,2),Wc(),th(n,2)}if(null===(n=oh(a))&&Hd(e,t,a,lh,r),n===s)break;s=n}null!==s&&a.stopPropagation()}else Hd(e,t,a,null,r)}}function oh(e){return ch(e=Dt(e))}var lh=null;function ch(e){if(lh=null,null!==(e=Ue(e))){var t=l(e);if(null===t)e=null;else{var r=t.tag;if(13===r){if(null!==(e=c(t)))return e;e=null}else if(3===r){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return lh=e,null}function dh(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(re()){case ae:return 2;case se:return 8;case ne:case ie:return 32;case oe:return 268435456;default:return 32}default:return 32}}var uh=!1,hh=null,fh=null,mh=null,ph=new Map,gh=new Map,xh=[],bh="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function vh(e,t){switch(e){case"focusin":case"focusout":hh=null;break;case"dragenter":case"dragleave":fh=null;break;case"mouseover":case"mouseout":mh=null;break;case"pointerover":case"pointerout":ph.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":gh.delete(t.pointerId)}}function yh(e,t,r,a,s,n){return null===e||e.nativeEvent!==n?(e={blockedOn:t,domEventName:r,eventSystemFlags:a,nativeEvent:n,targetContainers:[s]},null!==t&&(null!==(t=We(t))&&rh(t)),e):(e.eventSystemFlags|=a,t=e.targetContainers,null!==s&&-1===t.indexOf(s)&&t.push(s),e)}function wh(e){var t=Ue(e.target);if(null!==t){var r=l(t);if(null!==r)if(13===(t=r.tag)){if(null!==(t=c(r)))return e.blockedOn=t,void function(e,t){var r=R.p;try{return R.p=e,t()}finally{R.p=r}}(e.priority,function(){if(13===r.tag){var e=Rc();e=_e(e);var t=Aa(r,e);null!==t&&Fc(t,0,e),th(r,e)}})}else if(3===t&&r.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===r.tag?r.stateNode.containerInfo:null)}e.blockedOn=null}function jh(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var r=oh(e.nativeEvent);if(null!==r)return null!==(t=We(r))&&rh(t),e.blockedOn=r,!1;var a=new(r=e.nativeEvent).constructor(r.type,r);At=a,r.target.dispatchEvent(a),At=null,t.shift()}return!0}function Nh(e,t,r){jh(e)&&r.delete(t)}function kh(){uh=!1,null!==hh&&jh(hh)&&(hh=null),null!==fh&&jh(fh)&&(fh=null),null!==mh&&jh(mh)&&(mh=null),ph.forEach(Nh),gh.forEach(Nh)}function Sh(e,t){e.blockedOn===t&&(e.blockedOn=null,uh||(uh=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,kh)))}var Eh=null;function Th(e){Eh!==e&&(Eh=e,a.unstable_scheduleCallback(a.unstable_NormalPriority,function(){Eh===e&&(Eh=null);for(var t=0;t<e.length;t+=3){var r=e[t],a=e[t+1],s=e[t+2];if("function"!==typeof a){if(null===ch(a||r))continue;break}var n=We(r);null!==n&&(e.splice(t,3),t-=3,Di(n,{pending:!0,data:s,method:r.method,action:a},a,s))}}))}function _h(e){function t(t){return Sh(t,e)}null!==hh&&Sh(hh,e),null!==fh&&Sh(fh,e),null!==mh&&Sh(mh,e),ph.forEach(t),gh.forEach(t);for(var r=0;r<xh.length;r++){var a=xh[r];a.blockedOn===e&&(a.blockedOn=null)}for(;0<xh.length&&null===(r=xh[0]).blockedOn;)wh(r),null===r.blockedOn&&xh.shift();if(null!=(r=(e.ownerDocument||e).$$reactFormReplay))for(a=0;a<r.length;a+=3){var s=r[a],n=r[a+1],i=s[Ie]||null;if("function"===typeof n)i||Th(r);else if(i){var o=null;if(n&&n.hasAttribute("formAction")){if(s=n,i=n[Ie]||null)o=i.formAction;else if(null!==ch(s))continue}else o=i.action;"function"===typeof o?r[a+1]=o:(r.splice(a,3),a-=3),Th(r)}}}function Ch(e){this._internalRoot=e}function Ah(e){this._internalRoot=e}Ah.prototype.render=Ch.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));Zu(t.current,Rc(),e,t,null,null)},Ah.prototype.unmount=Ch.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;Zu(e.current,2,null,e,null,null),Wc(),t[Oe]=null}},Ah.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ae();e={blockedOn:null,target:e,priority:t};for(var r=0;r<xh.length&&0!==t&&t<xh[r].priority;r++);xh.splice(r,0,e),0===r&&wh(e)}};var Dh=s.version;if("19.1.1"!==Dh)throw Error(i(527,Dh,"19.1.1"));R.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=l(e)))throw Error(i(188));return t!==e?null:e}for(var r=e,a=t;;){var s=r.return;if(null===s)break;var n=s.alternate;if(null===n){if(null!==(a=s.return)){r=a;continue}break}if(s.child===n.child){for(n=s.child;n;){if(n===r)return d(s),e;if(n===a)return d(s),t;n=n.sibling}throw Error(i(188))}if(r.return!==a.return)r=s,a=n;else{for(var o=!1,c=s.child;c;){if(c===r){o=!0,r=s,a=n;break}if(c===a){o=!0,a=s,r=n;break}c=c.sibling}if(!o){for(c=n.child;c;){if(c===r){o=!0,r=n,a=s;break}if(c===a){o=!0,a=n,r=s;break}c=c.sibling}if(!o)throw Error(i(189))}}if(r.alternate!==a)throw Error(i(190))}if(3!==r.tag)throw Error(i(188));return r.stateNode.current===r?e:t}(t),e=null===(e=null!==e?u(e):null)?null:e.stateNode};var Ph={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:O,reconcilerVersion:"19.1.1"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Ih=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ih.isDisabled&&Ih.supportsFiber)try{de=Ih.inject(Ph),ue=Ih}catch(Rh){}}t.createRoot=function(e,t){if(!o(e))throw Error(i(299));var r=!1,a="",s=vo,n=yo,l=wo;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(r=!0),void 0!==t.identifierPrefix&&(a=t.identifierPrefix),void 0!==t.onUncaughtError&&(s=t.onUncaughtError),void 0!==t.onCaughtError&&(n=t.onCaughtError),void 0!==t.onRecoverableError&&(l=t.onRecoverableError),void 0!==t.unstable_transitionCallbacks&&t.unstable_transitionCallbacks),t=Xu(e,1,!1,null,0,r,a,s,n,l,0,null),e[Oe]=t.current,Ud(e),new Ch(t)},t.hydrateRoot=function(e,t,r){if(!o(e))throw Error(i(299));var a=!1,s="",n=vo,l=yo,c=wo,d=null;return null!==r&&void 0!==r&&(!0===r.unstable_strictMode&&(a=!0),void 0!==r.identifierPrefix&&(s=r.identifierPrefix),void 0!==r.onUncaughtError&&(n=r.onUncaughtError),void 0!==r.onCaughtError&&(l=r.onCaughtError),void 0!==r.onRecoverableError&&(c=r.onRecoverableError),void 0!==r.unstable_transitionCallbacks&&r.unstable_transitionCallbacks,void 0!==r.formState&&(d=r.formState)),(t=Xu(e,1,!0,t,0,a,s,n,l,c,0,d)).context=Qu(null),r=t.current,(s=an(a=_e(a=Rc()))).callback=null,sn(r,s,a),r=a,t.current.lanes=r,Se(t,r),Nd(t),e[Oe]=t.current,Ud(e),new Ah(t)},t.version="19.1.1"},119:(e,t,r)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=r(863)},340:(e,t,r)=>{e.exports=r(487)},352:(e,t,r)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=r(85)},379:(e,t,r)=>{r.d(t,{A:()=>n});var a=r(705);function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function n(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach(function(t){(0,a.A)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}},414:(e,t,r)=>{e.exports=r(916)},427:function(e,t,r){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=a(r(569));class n extends s.default{select(e){let t=!1;const r=(null!==e&&void 0!==e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e){let{ascending:t=!0,nullsFirst:r,foreignTable:a,referencedTable:s=a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=s?"".concat(s,".order"):"order",i=this.url.searchParams.get(n);return this.url.searchParams.set(n,"".concat(i?"".concat(i,","):"").concat(e,".").concat(t?"asc":"desc").concat(void 0===r?"":r?".nullsfirst":".nullslast")),this}limit(e){let{foreignTable:t,referencedTable:r=t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a="undefined"===typeof r?"limit":"".concat(r,".limit");return this.url.searchParams.set(a,"".concat(e)),this}range(e,t){let{foreignTable:r,referencedTable:a=r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s="undefined"===typeof a?"offset":"".concat(a,".offset"),n="undefined"===typeof a?"limit":"".concat(a,".limit");return this.url.searchParams.set(s,"".concat(e)),this.url.searchParams.set(n,"".concat(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return"GET"===this.method?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain(){let{analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:a=!1,wal:s=!1,format:n="text"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var i;const o=[e?"analyze":null,t?"verbose":null,r?"settings":null,a?"buffers":null,s?"wal":null].filter(Boolean).join("|"),l=null!==(i=this.headers.get("Accept"))&&void 0!==i?i:"application/json";return this.headers.set("Accept","application/vnd.pgrst.plan+".concat(n,'; for="').concat(l,'"; options=').concat(o,";")),this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer","max-affected=".concat(e)),this}}t.default=n},487:(e,t)=>{function r(e,t){var r=e.length;e.push(t);e:for(;0<r;){var a=r-1>>>1,s=e[a];if(!(0<n(s,t)))break e;e[a]=t,e[r]=s,r=a}}function a(e){return 0===e.length?null:e[0]}function s(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;e:for(var a=0,s=e.length,i=s>>>1;a<i;){var o=2*(a+1)-1,l=e[o],c=o+1,d=e[c];if(0>n(l,r))c<s&&0>n(d,l)?(e[a]=d,e[c]=r,a=c):(e[a]=l,e[o]=r,a=o);else{if(!(c<s&&0>n(d,r)))break e;e[a]=d,e[c]=r,a=c}}}return t}function n(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],d=[],u=1,h=null,f=3,m=!1,p=!1,g=!1,x=!1,b="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,y="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=a(d);null!==t;){if(null===t.callback)s(d);else{if(!(t.startTime<=e))break;s(d),t.sortIndex=t.expirationTime,r(c,t)}t=a(d)}}function j(e){if(g=!1,w(e),!p)if(null!==a(c))p=!0,k||(k=!0,N());else{var t=a(d);null!==t&&P(j,t.startTime-e)}}var N,k=!1,S=-1,E=5,T=-1;function _(){return!!x||!(t.unstable_now()-T<E)}function C(){if(x=!1,k){var e=t.unstable_now();T=e;var r=!0;try{e:{p=!1,g&&(g=!1,v(S),S=-1),m=!0;var n=f;try{t:{for(w(e),h=a(c);null!==h&&!(h.expirationTime>e&&_());){var i=h.callback;if("function"===typeof i){h.callback=null,f=h.priorityLevel;var o=i(h.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof o){h.callback=o,w(e),r=!0;break t}h===a(c)&&s(c),w(e)}else s(c);h=a(c)}if(null!==h)r=!0;else{var l=a(d);null!==l&&P(j,l.startTime-e),r=!1}}break e}finally{h=null,f=n,m=!1}r=void 0}}finally{r?N():k=!1}}}if("function"===typeof y)N=function(){y(C)};else if("undefined"!==typeof MessageChannel){var A=new MessageChannel,D=A.port2;A.port1.onmessage=C,N=function(){D.postMessage(null)}}else N=function(){b(C,0)};function P(e,r){S=b(function(){e(t.unstable_now())},r)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var r=f;f=t;try{return e()}finally{f=r}},t.unstable_requestPaint=function(){x=!0},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=f;f=e;try{return t()}finally{f=r}},t.unstable_scheduleCallback=function(e,s,n){var i=t.unstable_now();switch("object"===typeof n&&null!==n?n="number"===typeof(n=n.delay)&&0<n?i+n:i:n=i,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:u++,callback:s,priorityLevel:e,startTime:n,expirationTime:o=n+o,sortIndex:-1},n>i?(e.sortIndex=n,r(d,e),null===a(c)&&e===a(d)&&(g?(v(S),S=-1):g=!0,P(j,n-i))):(e.sortIndex=o,r(c,e),p||m||(p=!0,k||(k=!0,N()))),e},t.unstable_shouldYield=_,t.unstable_wrapCallback=function(e){var t=f;return function(){var r=f;f=t;try{return e.apply(this,arguments)}finally{f=r}}}},569:function(e,t,r){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=a(r(621)),n=a(r(732));t.default=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=null!==(t=e.shouldThrowOnError)&&void 0!==t&&t,this.signal=e.signal,this.isMaybeSingle=null!==(r=e.isMaybeSingle)&&void 0!==r&&r,e.fetch?this.fetch=e.fetch:"undefined"===typeof fetch?this.fetch=s.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),"GET"!==this.method&&"HEAD"!==this.method&&this.headers.set("Content-Type","application/json");let r=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async e=>{var t,r,a,s;let i=null,o=null,l=null,c=e.status,d=e.statusText;if(e.ok){if("HEAD"!==this.method){const r=await e.text();""===r||(o="text/csv"===this.headers.get("Accept")||this.headers.get("Accept")&&(null===(t=this.headers.get("Accept"))||void 0===t?void 0:t.includes("application/vnd.pgrst.plan+text"))?r:JSON.parse(r))}const s=null===(r=this.headers.get("Prefer"))||void 0===r?void 0:r.match(/count=(exact|planned|estimated)/),n=null===(a=e.headers.get("content-range"))||void 0===a?void 0:a.split("/");s&&n&&n.length>1&&(l=parseInt(n[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(o)&&(o.length>1?(i={code:"PGRST116",details:"Results contain ".concat(o.length," rows, application/vnd.pgrst.object+json requires 1 row"),hint:null,message:"JSON object requested, multiple (or no) rows returned"},o=null,l=null,c=406,d="Not Acceptable"):o=1===o.length?o[0]:null)}else{const t=await e.text();try{i=JSON.parse(t),Array.isArray(i)&&404===e.status&&(o=[],i=null,c=200,d="OK")}catch(u){404===e.status&&""===t?(c=204,d="No Content"):i={message:t}}if(i&&this.isMaybeSingle&&(null===(s=null===i||void 0===i?void 0:i.details)||void 0===s?void 0:s.includes("0 rows"))&&(i=null,c=200,d="OK"),i&&this.shouldThrowOnError)throw new n.default(i)}return{error:i,data:o,count:l,status:c,statusText:d}});return this.shouldThrowOnError||(r=r.catch(e=>{var t,r,a;return{error:{message:"".concat(null!==(t=null===e||void 0===e?void 0:e.name)&&void 0!==t?t:"FetchError",": ").concat(null===e||void 0===e?void 0:e.message),details:"".concat(null!==(r=null===e||void 0===e?void 0:e.stack)&&void 0!==r?r:""),hint:"",code:"".concat(null!==(a=null===e||void 0===e?void 0:e.code)&&void 0!==a?a:"")},data:null,count:null,status:0,statusText:""}})),r.then(e,t)}returns(){return this}overrideTypes(){return this}}},621:(e,t,r)=>{r.r(t),r.d(t,{Headers:()=>i,Request:()=>o,Response:()=>l,default:()=>n,fetch:()=>s});var a=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof r.g)return r.g;throw new Error("unable to locate global object")}();const s=a.fetch,n=a.fetch.bind(a),i=a.Headers,o=a.Request,l=a.Response},705:(e,t,r)=>{function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function s(e){var t=function(e,t){if("object"!=a(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=a(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==a(t)?t:t+""}function n(e,t,r){return(t=s(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.d(t,{A:()=>n})},732:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});class r extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}t.default=r},863:(e,t,r)=>{var a=r(950);function s(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var i={d:{f:n,r:function(){throw Error(s(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},o=Symbol.for("react.portal");var l=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(e,t){return"font"===e?"":"string"===typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,t.createPortal=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(s(299));return function(e,t,r){var a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:o,key:null==a?null:""+a,children:e,containerInfo:t,implementation:r}}(e,t,null,r)},t.flushSync=function(e){var t=l.T,r=i.p;try{if(l.T=null,i.p=2,e)return e()}finally{l.T=t,i.p=r,i.d.f()}},t.preconnect=function(e,t){"string"===typeof e&&(t?t="string"===typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,i.d.C(e,t))},t.prefetchDNS=function(e){"string"===typeof e&&i.d.D(e)},t.preinit=function(e,t){if("string"===typeof e&&t&&"string"===typeof t.as){var r=t.as,a=c(r,t.crossOrigin),s="string"===typeof t.integrity?t.integrity:void 0,n="string"===typeof t.fetchPriority?t.fetchPriority:void 0;"style"===r?i.d.S(e,"string"===typeof t.precedence?t.precedence:void 0,{crossOrigin:a,integrity:s,fetchPriority:n}):"script"===r&&i.d.X(e,{crossOrigin:a,integrity:s,fetchPriority:n,nonce:"string"===typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"===typeof e)if("object"===typeof t&&null!==t){if(null==t.as||"script"===t.as){var r=c(t.as,t.crossOrigin);i.d.M(e,{crossOrigin:r,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0})}}else null==t&&i.d.M(e)},t.preload=function(e,t){if("string"===typeof e&&"object"===typeof t&&null!==t&&"string"===typeof t.as){var r=t.as,a=c(r,t.crossOrigin);i.d.L(e,r,{crossOrigin:a,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0,type:"string"===typeof t.type?t.type:void 0,fetchPriority:"string"===typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"===typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"===typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"===typeof t.imageSizes?t.imageSizes:void 0,media:"string"===typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"===typeof e)if(t){var r=c(t.as,t.crossOrigin);i.d.m(e,{as:"string"===typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:r,integrity:"string"===typeof t.integrity?t.integrity:void 0})}else i.d.m(e)},t.requestFormReset=function(e){i.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,r){return l.H.useFormState(e,t,r)},t.useFormStatus=function(){return l.H.useHostTransitionStatus()},t.version="19.1.1"},874:(e,t,r)=>{r.d(t,{default:()=>er});var a=r(379);class s extends Error{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"FunctionsError",r=arguments.length>2?arguments[2]:void 0;super(e),this.name=t,this.context=r}}class n extends s{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class i extends s{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class o extends s{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var l;!function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"}(l||(l={}));var c=function(e,t,r,a){return new(r||(r=Promise))(function(s,n){function i(e){try{l(a.next(e))}catch(t){n(t)}}function o(e){try{l(a.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(i,o)}l((a=a.apply(e,t||[])).next())})};class d{constructor(e){let{headers:t={},customFetch:a,region:s=l.Any}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.headers=t,this.region=s,this.fetch=(e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return Promise.resolve().then(r.bind(r,621)).then(e=>{let{default:r}=e;return r(...t)})}:fetch),function(){return t(...arguments)}})(a)}setAuth(e){this.headers.Authorization="Bearer ".concat(e)}invoke(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var r;return c(this,void 0,void 0,function*(){try{const{headers:a,method:s,body:l}=t;let c={},{region:d}=t;d||(d=this.region);const u=new URL("".concat(this.url,"/").concat(e));let h;d&&"any"!==d&&(c["x-region"]=d,u.searchParams.set("forceFunctionRegion",d)),l&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&("undefined"!==typeof Blob&&l instanceof Blob||l instanceof ArrayBuffer?(c["Content-Type"]="application/octet-stream",h=l):"string"===typeof l?(c["Content-Type"]="text/plain",h=l):"undefined"!==typeof FormData&&l instanceof FormData?h=l:(c["Content-Type"]="application/json",h=JSON.stringify(l)));const f=yield this.fetch(u.toString(),{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},c),this.headers),a),body:h}).catch(e=>{throw new n(e)}),m=f.headers.get("x-relay-error");if(m&&"true"===m)throw new i(f);if(!f.ok)throw new o(f);let p,g=(null!==(r=f.headers.get("Content-Type"))&&void 0!==r?r:"text/plain").split(";")[0].trim();return p="application/json"===g?yield f.json():"application/octet-stream"===g?yield f.blob():"text/event-stream"===g?f:"multipart/form-data"===g?yield f.formData():yield f.text(),{data:p,error:null,response:f}}catch(a){return{data:null,error:a,response:a instanceof o||a instanceof i?a.context:void 0}}})}}var u=r(53);const{PostgrestClient:h,PostgrestQueryBuilder:f,PostgrestFilterBuilder:m,PostgrestTransformBuilder:p,PostgrestBuilder:g,PostgrestError:x}=u;const b=class{static detectEnvironment(){var e;if("undefined"!==typeof WebSocket)return{type:"native",constructor:WebSocket};if("undefined"!==typeof globalThis&&"undefined"!==typeof globalThis.WebSocket)return{type:"native",constructor:globalThis.WebSocket};if("undefined"!==typeof r.g&&"undefined"!==typeof r.g.WebSocket)return{type:"native",constructor:r.g.WebSocket};if("undefined"!==typeof globalThis&&"undefined"!==typeof globalThis.WebSocketPair&&"undefined"===typeof globalThis.WebSocket)return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if("undefined"!==typeof globalThis&&globalThis.EdgeRuntime||"undefined"!==typeof navigator&&(null===(e=navigator.userAgent)||void 0===e?void 0:e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if("undefined"!==typeof process){const e=process.versions;if(e&&e.node){const t=e.node,r=parseInt(t.replace(/^v/,"").split(".")[0]);return r>=22?"undefined"!==typeof globalThis.WebSocket?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:"Node.js ".concat(r," detected but native WebSocket not found."),workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:"Node.js ".concat(r," detected without native WebSocket support."),workaround:'For Node.js < 22, install "ws" package and provide it via the transport option:\nimport ws from "ws"\nnew RealtimeClient(url, { transport: ws })'}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+="\n\nSuggested solution: ".concat(e.workaround)),new Error(t)}static createWebSocket(e,t){return new(this.getWebSocketConstructor())(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return"native"===e.type||"ws"===e.type}catch(e){return!1}}},v="realtime-js/".concat("2.15.5"),y=1e4;var w,j,N,k,S,E;!function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"}(w||(w={})),function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"}(j||(j={})),function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"}(N||(N={})),function(e){e.websocket="websocket"}(k||(k={})),function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"}(S||(S={}));class T{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t("string"===typeof e?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const a=t.getUint8(1),s=t.getUint8(2);let n=this.HEADER_LENGTH+2;const i=r.decode(e.slice(n,n+a));n+=a;const o=r.decode(e.slice(n,n+s));n+=s;return{ref:null,topic:i,event:o,payload:JSON.parse(r.decode(e.slice(n,e.byteLength)))}}}class _{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}!function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"}(E||(E={}));const C=function(e,t){var r;const a=null!==(r=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).skipTypes)&&void 0!==r?r:[];return Object.keys(t).reduce((r,s)=>(r[s]=A(s,e,t,a),r),{})},A=(e,t,r,a)=>{const s=t.find(t=>t.name===e),n=null===s||void 0===s?void 0:s.type,i=r[e];return n&&!a.includes(n)?D(n,i):P(i)},D=(e,t)=>{if("_"===e.charAt(0)){const r=e.slice(1,e.length);return M(t,r)}switch(e){case E.bool:return I(t);case E.float4:case E.float8:case E.int2:case E.int4:case E.int8:case E.numeric:case E.oid:return O(t);case E.json:case E.jsonb:return R(t);case E.timestamp:return F(t);case E.abstime:case E.date:case E.daterange:case E.int4range:case E.int8range:case E.money:case E.reltime:case E.text:case E.time:case E.timestamptz:case E.timetz:case E.tsrange:case E.tstzrange:default:return P(t)}},P=e=>e,I=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},O=e=>{if("string"===typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},R=e=>{if("string"===typeof e)try{return JSON.parse(e)}catch(t){return console.log("JSON parse error: ".concat(t)),e}return e},M=(e,t)=>{if("string"!==typeof e)return e;const r=e.length-1,a=e[r];if("{"===e[0]&&"}"===a){let a;const n=e.slice(1,r);try{a=JSON.parse("["+n+"]")}catch(s){a=n?n.split(","):[]}return a.map(e=>D(t,e))}return e},F=e=>"string"===typeof e?e.replace(" ","T"):e,L=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class z{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:y;this.channel=e,this.event=t,this.payload=r,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t(null===(r=this.receivedResp)||void 0===r?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive(e){let{status:t,response:r}=e;this.recHooks.filter(e=>e.status===t).forEach(e=>e.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var B,U,W,H;!function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"}(B||(B={}));class V{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(null===t||void 0===t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},e=>{const{onJoin:t,onLeave:r,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=V.syncState(this.state,e,t,r),this.pendingDiffs.forEach(e=>{this.state=V.syncDiff(this.state,e,t,r)}),this.pendingDiffs=[],a()}),this.channel._on(r.diff,{},e=>{const{onJoin:t,onLeave:r,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=V.syncDiff(this.state,e,t,r),a())}),this.onJoin((e,t,r)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:r})}),this.onLeave((e,t,r)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:r})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,a){const s=this.cloneDeep(e),n=this.transformState(t),i={},o={};return this.map(s,(e,t)=>{n[e]||(o[e]=t)}),this.map(n,(e,t)=>{const r=s[e];if(r){const a=t.map(e=>e.presence_ref),s=r.map(e=>e.presence_ref),n=t.filter(e=>s.indexOf(e.presence_ref)<0),l=r.filter(e=>a.indexOf(e.presence_ref)<0);n.length>0&&(i[e]=n),l.length>0&&(o[e]=l)}else i[e]=t}),this.syncDiff(s,{joins:i,leaves:o},r,a)}static syncDiff(e,t,r,a){const{joins:s,leaves:n}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),a||(a=()=>{}),this.map(s,(t,a)=>{var s;const n=null!==(s=e[t])&&void 0!==s?s:[];if(e[t]=this.cloneDeep(a),n.length>0){const r=e[t].map(e=>e.presence_ref),a=n.filter(e=>r.indexOf(e.presence_ref)<0);e[t].unshift(...a)}r(t,n,a)}),this.map(n,(t,r)=>{let s=e[t];if(!s)return;const n=r.map(e=>e.presence_ref);s=s.filter(e=>n.indexOf(e.presence_ref)<0),e[t]=s,a(t,s,r),0===s.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const a=e[r];return t[r]="metas"in a?a.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):a,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}!function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"}(U||(U={})),function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"}(W||(W={})),function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"}(H||(H={}));class G{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}},r=arguments.length>2?arguments[2]:void 0;this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=j.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new z(this,N.join,this.params,this.timeout),this.rejoinTimer=new _(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=j.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel","close ".concat(this.topic," ").concat(this._joinRef())),this.state=j.closed,this.socket._remove(this)}),this._onError(e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel","error ".concat(this.topic),e),this.state=j.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel","timeout ".concat(this.topic),this.joinPush.timeout),this.state=j.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel","error ".concat(this.topic),e),this.state=j.errored,this.rejoinTimer.scheduleTimeout())}),this._on(N.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new V(this),this.broadcastEndpointURL=L(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.timeout;var r,a,s;if(this.socket.isConnected()||this.socket.connect(),this.state==j.closed){const{config:{broadcast:n,presence:i,private:o}}=this.params,l=null!==(a=null===(r=this.bindings.postgres_changes)||void 0===r?void 0:r.map(e=>e.filter))&&void 0!==a?a:[],c=!!this.bindings[W.PRESENCE]&&this.bindings[W.PRESENCE].length>0||!0===(null===(s=this.params.config.presence)||void 0===s?void 0:s.enabled),d={},u={broadcast:n,presence:Object.assign(Object.assign({},i),{enabled:c}),postgres_changes:l,private:o};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this._onError(t=>null===e||void 0===e?void 0:e(H.CHANNEL_ERROR,t)),this._onClose(()=>null===e||void 0===e?void 0:e(H.CLOSED)),this.updateJoinPayload(Object.assign({config:u},d)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async t=>{let{postgres_changes:r}=t;var a;if(this.socket.setAuth(),void 0!==r){const t=this.bindings.postgres_changes,s=null!==(a=null===t||void 0===t?void 0:t.length)&&void 0!==a?a:0,n=[];for(let a=0;a<s;a++){const s=t[a],{filter:{event:i,schema:o,table:l,filter:c}}=s,d=r&&r[a];if(!d||d.event!==i||d.schema!==o||d.table!==l||d.filter!==c)return this.unsubscribe(),this.state=j.errored,void(null===e||void 0===e||e(H.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));n.push(Object.assign(Object.assign({},s),{id:d.id}))}return this.bindings.postgres_changes=n,void(e&&e(H.SUBSCRIBED))}null===e||void 0===e||e(H.SUBSCRIBED)}).receive("error",t=>{this.state=j.errored,null===e||void 0===e||e(H.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(t).join(", ")||"error")))}).receive("timeout",()=>{null===e||void 0===e||e(H.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this.state===j.joined&&e===W.PRESENCE&&(this.socket.log("channel","resubscribe to ".concat(this.topic," due to change in presence callbacks on joined channel")),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,r)}async send(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var r,a;if(this._canPush()||"broadcast"!==e.type)return new Promise(r=>{var a,s,n;const i=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(n=null===(s=null===(a=this.params)||void 0===a?void 0:a.config)||void 0===s?void 0:s.broadcast)||void 0===n?void 0:n.ack)||r("ok"),i.receive("ok",()=>r("ok")),i.receive("error",()=>r("error")),i.receive("timeout",()=>r("timed out"))});{const{event:n,payload:i}=e,o={method:"POST",headers:{Authorization:this.socket.accessTokenValue?"Bearer ".concat(this.socket.accessTokenValue):"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:n,payload:i,private:this.private}]})};try{const e=await this._fetchWithTimeout(this.broadcastEndpointURL,o,null!==(r=t.timeout)&&void 0!==r?r:this.timeout);return await(null===(a=e.body)||void 0===a?void 0:a.cancel()),e.ok?"ok":"error"}catch(s){return"AbortError"===s.name?"timed out":"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this.state=j.leaving;const t=()=>{this.socket.log("channel","leave ".concat(this.topic)),this._trigger(N.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(a=>{r=new z(this,N.leave,{},e),r.receive("ok",()=>{t(),a("ok")}).receive("timeout",()=>{t(),a("timed out")}).receive("error",()=>{a("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{null===r||void 0===r||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=j.closed,this.bindings={}}async _fetchWithTimeout(e,t,r){const a=new AbortController,s=setTimeout(()=>a.abort(),r),n=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:a.signal}));return clearTimeout(s),n}_push(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.timeout;if(!this.joinedOnce)throw"tried to push '".concat(e,"' to '").concat(this.topic,"' before joining. Use channel.subscribe() before pushing events");let a=new z(this,e,t,r);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>100){const e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log("channel","discarded push due to buffer overflow: ".concat(e.event),e.payload))}}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var a,s;const n=e.toLocaleLowerCase(),{close:i,error:o,leave:l,join:c}=N;if(r&&[i,o,l,c].indexOf(n)>=0&&r!==this._joinRef())return;let d=this._onMessage(n,t,r);if(t&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(n)?null===(a=this.bindings.postgres_changes)||void 0===a||a.filter(e=>{var t,r,a;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(a=null===(r=e.filter)||void 0===r?void 0:r.event)||void 0===a?void 0:a.toLocaleLowerCase())===n}).map(e=>e.callback(d,r)):null===(s=this.bindings[n])||void 0===s||s.filter(e=>{var r,a,s,i,o,l;if(["broadcast","presence","postgres_changes"].includes(n)){if("id"in e){const n=e.id,i=null===(r=e.filter)||void 0===r?void 0:r.event;return n&&(null===(a=t.ids)||void 0===a?void 0:a.includes(n))&&("*"===i||(null===i||void 0===i?void 0:i.toLocaleLowerCase())===(null===(s=t.data)||void 0===s?void 0:s.type.toLocaleLowerCase()))}{const r=null===(o=null===(i=null===e||void 0===e?void 0:e.filter)||void 0===i?void 0:i.event)||void 0===o?void 0:o.toLocaleLowerCase();return"*"===r||r===(null===(l=null===t||void 0===t?void 0:t.event)||void 0===l?void 0:l.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===n}).map(e=>{if("object"===typeof d&&"ids"in d){const e=d.data,{schema:t,table:r,commit_timestamp:a,type:s,errors:n}=e,i={schema:t,table:r,commit_timestamp:a,eventType:s,new:{},old:{},errors:n};d=Object.assign(Object.assign({},i),this._getPayloadRecords(e))}e.callback(d,r)})}_isClosed(){return this.state===j.closed}_isJoined(){return this.state===j.joined}_isJoining(){return this.state===j.joining}_isLeaving(){return this.state===j.leaving}_replyEventName(e){return"chan_reply_".concat(e)}_on(e,t,r){const a=e.toLocaleLowerCase(),s={type:a,filter:t,callback:r};return this.bindings[a]?this.bindings[a].push(s):this.bindings[a]=[s],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(e=>{var a;return!((null===(a=e.type)||void 0===a?void 0:a.toLocaleLowerCase())===r&&G.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(N.close,{},e)}_onError(e){this._on(N.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=j.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=C(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=C(e.columns,e.old_record)),t}}const q=()=>{},$=25e3,K=10,Y=100,J=[1e3,2e3,5e3,1e4];class X{constructor(e,t){var a;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=y,this.transport=null,this.heartbeatIntervalMs=$,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=q,this.ref=0,this.reconnectTimer=null,this.logger=q,this.conn=null,this.sendBuffer=[],this.serializer=new T,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return Promise.resolve().then(r.bind(r,621)).then(e=>{let{default:r}=e;return r(...t)}).catch(e=>{throw new Error("Failed to load @supabase/node-fetch: ".concat(e.message,". ")+"This is required for HTTP requests in Node.js environments without native fetch.")})}:fetch),function(){return t(...arguments)}},!(null===(a=null===t||void 0===t?void 0:t.params)||void 0===a?void 0:a.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint="".concat(e,"/").concat(k.websocket),this.httpEndpoint=L(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(null===t||void 0===t?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||null!==this.conn&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=b.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;if(t.includes("Node.js"))throw new Error("".concat(t,"\n\n")+'To use Realtime in Node.js, you need to provide a WebSocket implementation:\n\nOption 1: Use Node.js 22+ which has native WebSocket support\nOption 2: Install and provide the "ws" package:\n\n  npm install ws\n\n  import ws from "ws"\n  const client = new RealtimeClient(url, {\n    ...options,\n    transport: ws\n  })');throw new Error("WebSocket not available: ".concat(t))}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},e?this.conn.close(e,null!==t&&void 0!==t?t:""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case w.connecting:return S.Connecting;case w.open:return S.Open;case w.closing:return S.Closing;default:return S.Closed}}isConnected(){return this.connectionState()===S.Open}isConnecting(){return"connecting"===this._connectionState}isDisconnecting(){return"disconnecting"===this._connectionState}channel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}};const r="realtime:".concat(e),a=this.getChannels().find(e=>e.topic===r);if(a)return a;{const r=new G("realtime:".concat(e),t,this);return this.channels.push(r),r}}push(e){const{topic:t,event:r,payload:a,ref:s}=e,n=()=>{this.encode(e,e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)})};this.log("push","".concat(t," ").concat(r," (").concat(s,")"),a),this.isConnected()?n():this.sendBuffer.push(n)}async setAuth(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}return this._wasManualDisconnect=!1,null===(e=this.conn)||void 0===e||e.close(1e3,"heartbeat timeout"),void setTimeout(()=>{var e;this.isConnected()||null===(e=this.reconnectTimer)||void 0===e||e.scheduleTimeout()},Y)}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}else try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log("transport",'leaving duplicate topic "'.concat(e,'"')),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,e=>{if("phoenix"===e.topic&&"phx_reply"===e.event)try{this.heartbeatCallback("ok"===e.payload.status?"ok":"error")}catch(o){this.log("error","error in heartbeat callback",o)}e.ref&&e.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:t,event:r,payload:a,ref:s}=e,n=s?"(".concat(s,")"):"",i=a.status||"";this.log("receive","".concat(i," ").concat(t," ").concat(r," ").concat(n).trim(),a),this.channels.filter(e=>e._isMember(t)).forEach(e=>e._trigger(r,a,s)),this._triggerStateCallbacks("message",e)})}_clearTimer(e){var t;"heartbeat"===e&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):"reconnect"===e&&(null===(t=this.reconnectTimer)||void 0===t||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport","connected to ".concat(this.endpointURL())),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker","starting worker for from ".concat(this.workerUrl)):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||null===(t=this.reconnectTimer)||void 0===t||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport","".concat(e)),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(N.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const r=e.match(/\?/)?"&":"?",a=new URLSearchParams(t);return"".concat(e).concat(r).concat(a)}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}_setConnectionState(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._connectionState=e,"connecting"===e?this._wasManualDisconnect=!1:"disconnecting"===e&&(this._wasManualDisconnect=t)}async _performAuth(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e=t||(this.accessToken?await this.accessToken():this.accessTokenValue),this.accessTokenValue!=e&&(this.accessTokenValue=e,this.channels.forEach(t=>{const r={access_token:e,version:v};e&&t.updateJoinPayload(r),t.joinedOnce&&t._isJoined()&&t._push(N.access_token,{access_token:e})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"general";this.setAuth().catch(t=>{this.log("error","error setting auth in ".concat(e),t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(t)}catch(a){this.log("error","error in ".concat(e," callback"),a)}})}catch(r){this.log("error","error triggering ".concat(e," callbacks"),r)}}_setupReconnectionTimer(){this.reconnectTimer=new _(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},K)},this.reconnectAfterMs)}_initializeOptions(e){var t,r,a,s,n,i,o,l,c;if(this.transport=null!==(t=null===e||void 0===e?void 0:e.transport)&&void 0!==t?t:null,this.timeout=null!==(r=null===e||void 0===e?void 0:e.timeout)&&void 0!==r?r:y,this.heartbeatIntervalMs=null!==(a=null===e||void 0===e?void 0:e.heartbeatIntervalMs)&&void 0!==a?a:$,this.worker=null!==(s=null===e||void 0===e?void 0:e.worker)&&void 0!==s&&s,this.accessToken=null!==(n=null===e||void 0===e?void 0:e.accessToken)&&void 0!==n?n:null,this.heartbeatCallback=null!==(i=null===e||void 0===e?void 0:e.heartbeatCallback)&&void 0!==i?i:q,(null===e||void 0===e?void 0:e.params)&&(this.params=e.params),(null===e||void 0===e?void 0:e.logger)&&(this.logger=e.logger),((null===e||void 0===e?void 0:e.logLevel)||(null===e||void 0===e?void 0:e.log_level))&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=null!==(o=null===e||void 0===e?void 0:e.reconnectAfterMs)&&void 0!==o?o:e=>J[e-1]||1e4,this.encode=null!==(l=null===e||void 0===e?void 0:e.encode)&&void 0!==l?l:(e,t)=>t(JSON.stringify(e)),this.decode=null!==(c=null===e||void 0===e?void 0:e.decode)&&void 0!==c?c:this.serializer.decode.bind(this.serializer),this.worker){if("undefined"!==typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=null===e||void 0===e?void 0:e.workerUrl}}}class Q extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Z(e){return"object"===typeof e&&null!==e&&"__isStorageError"in e}class ee extends Q{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class te extends Q{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var re=function(e,t,r,a){return new(r||(r=Promise))(function(s,n){function i(e){try{l(a.next(e))}catch(t){n(t)}}function o(e){try{l(a.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(i,o)}l((a=a.apply(e,t||[])).next())})};const ae=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return Promise.resolve().then(r.bind(r,621)).then(e=>{let{default:r}=e;return r(...t)})}:fetch),function(){return t(...arguments)}},se=e=>{if(Array.isArray(e))return e.map(e=>se(e));if("function"===typeof e||e!==Object(e))return e;const t={};return Object.entries(e).forEach(e=>{let[r,a]=e;const s=r.replace(/([-_][a-z])/gi,e=>e.toUpperCase().replace(/[-_]/g,""));t[s]=se(a)}),t};var ne=function(e,t,r,a){return new(r||(r=Promise))(function(s,n){function i(e){try{l(a.next(e))}catch(t){n(t)}}function o(e){try{l(a.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(i,o)}l((a=a.apply(e,t||[])).next())})};const ie=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),oe=(e,t,a)=>ne(void 0,void 0,void 0,function*(){const s=yield re(void 0,void 0,void 0,function*(){return"undefined"===typeof Response?(yield Promise.resolve().then(r.bind(r,621))).Response:Response});e instanceof s&&!(null===a||void 0===a?void 0:a.noResolveJson)?e.json().then(r=>{const a=e.status||500,s=(null===r||void 0===r?void 0:r.statusCode)||a+"";t(new ee(ie(r),a,s))}).catch(e=>{t(new te(ie(e),e))}):t(new te(ie(e),e))}),le=(e,t,r,a)=>{const s={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"!==e&&a?((e=>{if("object"!==typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)})(a)?(s.headers=Object.assign({"Content-Type":"application/json"},null===t||void 0===t?void 0:t.headers),s.body=JSON.stringify(a)):s.body=a,(null===t||void 0===t?void 0:t.duplex)&&(s.duplex=t.duplex),Object.assign(Object.assign({},s),r)):s};function ce(e,t,r,a,s,n){return ne(this,void 0,void 0,function*(){return new Promise((i,o)=>{e(r,le(t,a,s,n)).then(e=>{if(!e.ok)throw e;return(null===a||void 0===a?void 0:a.noResolveJson)?e:e.json()}).then(e=>i(e)).catch(e=>oe(e,o,a))})})}function de(e,t,r,a){return ne(this,void 0,void 0,function*(){return ce(e,"GET",t,r,a)})}function ue(e,t,r,a,s){return ne(this,void 0,void 0,function*(){return ce(e,"POST",t,a,s,r)})}function he(e,t,r,a,s){return ne(this,void 0,void 0,function*(){return ce(e,"PUT",t,a,s,r)})}function fe(e,t,r,a,s){return ne(this,void 0,void 0,function*(){return ce(e,"DELETE",t,a,s,r)})}var me=function(e,t,r,a){return new(r||(r=Promise))(function(s,n){function i(e){try{l(a.next(e))}catch(t){n(t)}}function o(e){try{l(a.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(i,o)}l((a=a.apply(e,t||[])).next())})};const pe={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ge={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class xe{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=ae(a)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,t,r,a){return me(this,void 0,void 0,function*(){try{let s;const n=Object.assign(Object.assign({},ge),a);let i=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(n.upsert)});const o=n.metadata;"undefined"!==typeof Blob&&r instanceof Blob?(s=new FormData,s.append("cacheControl",n.cacheControl),o&&s.append("metadata",this.encodeMetadata(o)),s.append("",r)):"undefined"!==typeof FormData&&r instanceof FormData?(s=r,s.append("cacheControl",n.cacheControl),o&&s.append("metadata",this.encodeMetadata(o))):(s=r,i["cache-control"]="max-age=".concat(n.cacheControl),i["content-type"]=n.contentType,o&&(i["x-metadata"]=this.toBase64(this.encodeMetadata(o)))),(null===a||void 0===a?void 0:a.headers)&&(i=Object.assign(Object.assign({},i),a.headers));const l=this._removeEmptyFolders(t),c=this._getFinalPath(l),d=yield("PUT"==e?he:ue)(this.fetch,"".concat(this.url,"/object/").concat(c),s,Object.assign({headers:i},(null===n||void 0===n?void 0:n.duplex)?{duplex:n.duplex}:{}));return{data:{path:l,id:d.Id,fullPath:d.Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Z(s))return{data:null,error:s};throw s}})}upload(e,t,r){return me(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,a){return me(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(e),n=this._getFinalPath(s),i=new URL(this.url+"/object/upload/sign/".concat(n));i.searchParams.set("token",t);try{let e;const t=Object.assign({upsert:ge.upsert},a),n=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!==typeof Blob&&r instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",r)):"undefined"!==typeof FormData&&r instanceof FormData?(e=r,e.append("cacheControl",t.cacheControl)):(e=r,n["cache-control"]="max-age=".concat(t.cacheControl),n["content-type"]=t.contentType);return{data:{path:s,fullPath:(yield he(this.fetch,i.toString(),e,{headers:n})).Key},error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Z(o))return{data:null,error:o};throw o}})}createSignedUploadUrl(e,t){return me(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const a=Object.assign({},this.headers);(null===t||void 0===t?void 0:t.upsert)&&(a["x-upsert"]="true");const s=yield ue(this.fetch,"".concat(this.url,"/object/upload/sign/").concat(r),{},{headers:a}),n=new URL(this.url+s.url),i=n.searchParams.get("token");if(!i)throw new Q("No token returned by API");return{data:{signedUrl:n.toString(),path:e,token:i},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Z(r))return{data:null,error:r};throw r}})}update(e,t,r){return me(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return me(this,void 0,void 0,function*(){try{return{data:yield ue(this.fetch,"".concat(this.url,"/object/move"),{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null===r||void 0===r?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Z(a))return{data:null,error:a};throw a}})}copy(e,t,r){return me(this,void 0,void 0,function*(){try{return{data:{path:(yield ue(this.fetch,"".concat(this.url,"/object/copy"),{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null===r||void 0===r?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Z(a))return{data:null,error:a};throw a}})}createSignedUrl(e,t,r){return me(this,void 0,void 0,function*(){try{let a=this._getFinalPath(e),s=yield ue(this.fetch,"".concat(this.url,"/object/sign/").concat(a),Object.assign({expiresIn:t},(null===r||void 0===r?void 0:r.transform)?{transform:r.transform}:{}),{headers:this.headers});const n=(null===r||void 0===r?void 0:r.download)?"&download=".concat(!0===r.download?"":r.download):"";return s={signedUrl:encodeURI("".concat(this.url).concat(s.signedURL).concat(n))},{data:s,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Z(a))return{data:null,error:a};throw a}})}createSignedUrls(e,t,r){return me(this,void 0,void 0,function*(){try{const a=yield ue(this.fetch,"".concat(this.url,"/object/sign/").concat(this.bucketId),{expiresIn:t,paths:e},{headers:this.headers}),s=(null===r||void 0===r?void 0:r.download)?"&download=".concat(!0===r.download?"":r.download):"";return{data:a.map(e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI("".concat(this.url).concat(e.signedURL).concat(s)):null})),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Z(a))return{data:null,error:a};throw a}})}download(e,t){return me(this,void 0,void 0,function*(){const r="undefined"!==typeof(null===t||void 0===t?void 0:t.transform)?"render/image/authenticated":"object",a=this.transformOptsToQueryString((null===t||void 0===t?void 0:t.transform)||{}),s=a?"?".concat(a):"";try{const t=this._getFinalPath(e),a=yield de(this.fetch,"".concat(this.url,"/").concat(r,"/").concat(t).concat(s),{headers:this.headers,noResolveJson:!0});return{data:yield a.blob(),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Z(n))return{data:null,error:n};throw n}})}info(e){return me(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const e=yield de(this.fetch,"".concat(this.url,"/object/info/").concat(t),{headers:this.headers});return{data:se(e),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Z(r))return{data:null,error:r};throw r}})}exists(e){return me(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield function(e,t,r,a){return ne(this,void 0,void 0,function*(){return ce(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),a)})}(this.fetch,"".concat(this.url,"/object/").concat(t),{headers:this.headers}),{data:!0,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Z(r)&&r instanceof te){const e=r.originalError;if([400,404].includes(null===e||void 0===e?void 0:e.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),a=[],s=(null===t||void 0===t?void 0:t.download)?"download=".concat(!0===t.download?"":t.download):"";""!==s&&a.push(s);const n="undefined"!==typeof(null===t||void 0===t?void 0:t.transform)?"render/image":"object",i=this.transformOptsToQueryString((null===t||void 0===t?void 0:t.transform)||{});""!==i&&a.push(i);let o=a.join("&");return""!==o&&(o="?".concat(o)),{data:{publicUrl:encodeURI("".concat(this.url,"/").concat(n,"/public/").concat(r).concat(o))}}}remove(e){return me(this,void 0,void 0,function*(){try{return{data:yield fe(this.fetch,"".concat(this.url,"/object/").concat(this.bucketId),{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Z(t))return{data:null,error:t};throw t}})}list(e,t,r){return me(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},pe),t),{prefix:e||""});return{data:yield ue(this.fetch,"".concat(this.url,"/object/list/").concat(this.bucketId),a,{headers:this.headers},r),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Z(a))return{data:null,error:a};throw a}})}listV2(e,t){return me(this,void 0,void 0,function*(){try{const r=Object.assign({},e);return{data:yield ue(this.fetch,"".concat(this.url,"/object/list-v2/").concat(this.bucketId),r,{headers:this.headers},t),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Z(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!==typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return"".concat(this.bucketId,"/").concat(e.replace(/^\/+/,""))}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push("width=".concat(e.width)),e.height&&t.push("height=".concat(e.height)),e.resize&&t.push("resize=".concat(e.resize)),e.format&&t.push("format=".concat(e.format)),e.quality&&t.push("quality=".concat(e.quality)),t.join("&")}}const be={"X-Client-Info":"storage-js/".concat("2.12.1")};var ve=function(e,t,r,a){return new(r||(r=Promise))(function(s,n){function i(e){try{l(a.next(e))}catch(t){n(t)}}function o(e){try{l(a.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(i,o)}l((a=a.apply(e,t||[])).next())})};class ye{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;this.shouldThrowOnError=!1;const s=new URL(e);if(null===a||void 0===a?void 0:a.useNewHostname){/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase."))}this.url=s.href,this.headers=Object.assign(Object.assign({},be),t),this.fetch=ae(r)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return ve(this,void 0,void 0,function*(){try{return{data:yield de(this.fetch,"".concat(this.url,"/bucket"),{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Z(e))return{data:null,error:e};throw e}})}getBucket(e){return ve(this,void 0,void 0,function*(){try{return{data:yield de(this.fetch,"".concat(this.url,"/bucket/").concat(e),{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Z(t))return{data:null,error:t};throw t}})}createBucket(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{public:!1};return ve(this,void 0,void 0,function*(){try{return{data:yield ue(this.fetch,"".concat(this.url,"/bucket"),{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Z(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return ve(this,void 0,void 0,function*(){try{return{data:yield he(this.fetch,"".concat(this.url,"/bucket/").concat(e),{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Z(r))return{data:null,error:r};throw r}})}emptyBucket(e){return ve(this,void 0,void 0,function*(){try{return{data:yield ue(this.fetch,"".concat(this.url,"/bucket/").concat(e,"/empty"),{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Z(t))return{data:null,error:t};throw t}})}deleteBucket(e){return ve(this,void 0,void 0,function*(){try{return{data:yield fe(this.fetch,"".concat(this.url,"/bucket/").concat(e),{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Z(t))return{data:null,error:t};throw t}})}}class we extends ye{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},arguments.length>2?arguments[2]:void 0,arguments.length>3?arguments[3]:void 0)}from(e){return new xe(this.url,this.headers,e,this.fetch)}}let je="";je="undefined"!==typeof Deno?"deno":"undefined"!==typeof document?"web":"undefined"!==typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const Ne={headers:{"X-Client-Info":"supabase-js-".concat(je,"/").concat("2.57.4")}},ke={schema:"public"},Se={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Ee={};var Te=r(621),_e=function(e,t,r,a){return new(r||(r=Promise))(function(s,n){function i(e){try{l(a.next(e))}catch(t){n(t)}}function o(e){try{l(a.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(i,o)}l((a=a.apply(e,t||[])).next())})};const Ce=e=>{let t;return t=e||("undefined"===typeof fetch?Te.default:fetch),function(){return t(...arguments)}},Ae=(e,t,r)=>{const a=Ce(r),s="undefined"===typeof Headers?Te.Headers:Headers;return(r,n)=>_e(void 0,void 0,void 0,function*(){var i;const o=null!==(i=yield t())&&void 0!==i?i:e;let l=new s(null===n||void 0===n?void 0:n.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization","Bearer ".concat(o)),a(r,Object.assign(Object.assign({},n),{headers:l}))})};var De=function(e,t,r,a){return new(r||(r=Promise))(function(s,n){function i(e){try{l(a.next(e))}catch(t){n(t)}}function o(e){try{l(a.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(i,o)}l((a=a.apply(e,t||[])).next())})};const Pe="2.71.1",Ie=3e4,Oe=9e4,Re={"X-Client-Info":"gotrue-js/".concat(Pe)},Me="X-Supabase-Api-Version",Fe={timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"},Le=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class ze extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function Be(e){return"object"===typeof e&&null!==e&&"__isAuthError"in e}class Ue extends ze{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}class We extends ze{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class He extends ze{constructor(e,t,r,a){super(e,r,a),this.name=t,this.status=r}}class Ve extends He{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class Ge extends He{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class qe extends He{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class $e extends He{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Ke extends He{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Ye extends He{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Je(e){return Be(e)&&"AuthRetryableFetchError"===e.name}class Xe extends He{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class Qe extends He{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ze="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),et=" \t\n\r=".split(""),tt=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<et.length;t+=1)e[et[t].charCodeAt(0)]=-2;for(let t=0;t<Ze.length;t+=1)e[Ze[t].charCodeAt(0)]=t;return e})();function rt(e,t,r){if(null!==e)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;r(Ze[e]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;r(Ze[e]),t.queuedBits-=6}}function at(e,t,r){const a=tt[e];if(!(a>-1)){if(-2===a)return;throw new Error('Invalid Base64-URL character "'.concat(String.fromCharCode(e),'"'))}for(t.queue=t.queue<<6|a,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8}function st(e){const t=[],r=e=>{t.push(String.fromCodePoint(e))},a={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},n=e=>{!function(e,t,r){if(0===t.utf8seq){if(e<=127)return void r(e);for(let r=1;r<6;r+=1)if(0===(e>>7-r&1)){t.utf8seq=r;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else{if(4!==t.utf8seq)throw new Error("Invalid UTF-8 sequence");t.codepoint=7&e}t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&r(t.codepoint)}}(e,a,r)};for(let i=0;i<e.length;i+=1)at(e.charCodeAt(i),s,n);return t.join("")}function nt(e,t){if(!(e<=127)){if(e<=2047)return t(192|e>>6),void t(128|63&e);if(e<=65535)return t(224|e>>12),t(128|e>>6&63),void t(128|63&e);if(e<=1114111)return t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),void t(128|63&e);throw new Error("Unrecognized Unicode codepoint: ".concat(e.toString(16)))}t(e)}function it(e,t){for(let r=0;r<e.length;r+=1){let a=e.charCodeAt(r);if(a>55295&&a<=56319){const t=1024*(a-55296)&65535;a=65536+(e.charCodeAt(r+1)-56320&65535|t),r+=1}nt(a,t)}}function ot(e){const t=[],r={queue:0,queuedBits:0},a=e=>{t.push(e)};for(let s=0;s<e.length;s+=1)at(e.charCodeAt(s),r,a);return new Uint8Array(t)}function lt(e){const t=[],r={queue:0,queuedBits:0},a=e=>{t.push(e)};return e.forEach(e=>rt(e,r,a)),rt(null,r,a),t.join("")}const ct=()=>"undefined"!==typeof window&&"undefined"!==typeof document,dt={tested:!1,writable:!1},ut=()=>{if(!ct())return!1;try{if("object"!==typeof globalThis.localStorage)return!1}catch(t){return!1}if(dt.tested)return dt.writable;const e="lswt-".concat(Math.random()).concat(Math.random());try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),dt.tested=!0,dt.writable=!0}catch(t){dt.tested=!0,dt.writable=!1}return dt.writable};const ht=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return Promise.resolve().then(r.bind(r,621)).then(e=>{let{default:r}=e;return r(...t)})}:fetch),function(){return t(...arguments)}},ft=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},mt=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch(a){return r}},pt=async(e,t)=>{await e.removeItem(t)};class gt{constructor(){this.promise=new gt.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function xt(e){const t=e.split(".");if(3!==t.length)throw new Qe("Invalid JWT structure");for(let r=0;r<t.length;r++)if(!Le.test(t[r]))throw new Qe("JWT not in base64url format");return{header:JSON.parse(st(t[0])),payload:JSON.parse(st(t[1])),signature:ot(t[2]),raw:{header:t[0],payload:t[1]}}}function bt(e){return("0"+e.toString(16)).substr(-2)}async function vt(e){if(!("undefined"!==typeof crypto&&"undefined"!==typeof crypto.subtle&&"undefined"!==typeof TextEncoder))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=await async function(e){const t=(new TextEncoder).encode(e),r=await crypto.subtle.digest("SHA-256",t),a=new Uint8Array(r);return Array.from(a).map(e=>String.fromCharCode(e)).join("")}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function yt(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const a=function(){const e=new Uint32Array(56);if("undefined"===typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let r="";for(let a=0;a<56;a++)r+=e.charAt(Math.floor(Math.random()*t));return r}return crypto.getRandomValues(e),Array.from(e,bt).join("")}();let s=a;r&&(s+="/PASSWORD_RECOVERY"),await ft(e,"".concat(t,"-code-verifier"),s);const n=await vt(a);return[n,a===n?"plain":"s256"]}gt.promiseConstructor=Promise;const wt=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;const jt=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Nt(e){if(!jt.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function kt(){return new Proxy({},{get:(e,t)=>{if("__isUserNotAvailableProxy"===t)return!0;if("symbol"===typeof t){const e=t.toString();if("Symbol(Symbol.toPrimitive)"===e||"Symbol(Symbol.toStringTag)"===e||"Symbol(util.inspect.custom)"===e)return}throw new Error('@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "'.concat(t,'" property of the session object is not supported. Please use getUser() instead.'))},set:(e,t)=>{throw new Error('@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "'.concat(t,'" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.'))},deleteProperty:(e,t)=>{throw new Error('@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "'.concat(t,'" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.'))}})}function St(e){return JSON.parse(JSON.stringify(e))}var Et=function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var s=0;for(a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(r[a[s]]=e[a[s]])}return r};const Tt=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),_t=[502,503,504];async function Ct(e){var t,r;if(!("object"===typeof(r=e)&&null!==r&&"status"in r&&"ok"in r&&"json"in r&&"function"===typeof r.json))throw new Ye(Tt(e),0);if(_t.includes(e.status))throw new Ye(Tt(e),e.status);let a,s;try{a=await e.json()}catch(i){throw new We(Tt(i),i)}const n=function(e){const t=e.headers.get(Me);if(!t)return null;if(!t.match(wt))return null;try{return new Date("".concat(t,"T00:00:00.0Z"))}catch(i){return null}}(e);if(n&&n.getTime()>=Fe.timestamp&&"object"===typeof a&&a&&"string"===typeof a.code?s=a.code:"object"===typeof a&&a&&"string"===typeof a.error_code&&(s=a.error_code),s){if("weak_password"===s)throw new Xe(Tt(a),e.status,(null===(t=a.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===s)throw new Ve}else if("object"===typeof a&&a&&"object"===typeof a.weak_password&&a.weak_password&&Array.isArray(a.weak_password.reasons)&&a.weak_password.reasons.length&&a.weak_password.reasons.reduce((e,t)=>e&&"string"===typeof t,!0))throw new Xe(Tt(a),e.status,a.weak_password.reasons);throw new Ue(Tt(a),e.status||500,s)}async function At(e,t,r,a){var s;const n=Object.assign({},null===a||void 0===a?void 0:a.headers);n[Me]||(n[Me]=Fe.name),(null===a||void 0===a?void 0:a.jwt)&&(n.Authorization="Bearer ".concat(a.jwt));const i=null!==(s=null===a||void 0===a?void 0:a.query)&&void 0!==s?s:{};(null===a||void 0===a?void 0:a.redirectTo)&&(i.redirect_to=a.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",l=await async function(e,t,r,a,s,n){const i=((e,t,r,a)=>{const s={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"===e?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null===t||void 0===t?void 0:t.headers),s.body=JSON.stringify(a),Object.assign(Object.assign({},s),r))})(t,a,s,n);let o;try{o=await e(r,Object.assign({},i))}catch(l){throw console.error(l),new Ye(Tt(l),0)}o.ok||await Ct(o);if(null===a||void 0===a?void 0:a.noResolveJson)return o;try{return await o.json()}catch(l){await Ct(l)}}(e,t,r+o,{headers:n,noResolveJson:null===a||void 0===a?void 0:a.noResolveJson},{},null===a||void 0===a?void 0:a.body);return(null===a||void 0===a?void 0:a.xform)?null===a||void 0===a?void 0:a.xform(l):{data:Object.assign({},l),error:null}}function Dt(e){var t;let r=null;var a;(function(e){return e.access_token&&e.refresh_token&&e.expires_in})(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=(a=e.expires_in,Math.round(Date.now()/1e3)+a)));return{data:{session:r,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function Pt(e){const t=Dt(e);return!t.error&&e.weak_password&&"object"===typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"===typeof e.weak_password.message&&e.weak_password.reasons.reduce((e,t)=>e&&"string"===typeof t,!0)&&(t.data.weak_password=e.weak_password),t}function It(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function Ot(e){return{data:e,error:null}}function Rt(e){const{action_link:t,email_otp:r,hashed_token:a,redirect_to:s,verification_type:n}=e,i=Et(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:r,hashed_token:a,redirect_to:s,verification_type:n},user:Object.assign({},i)},error:null}}function Mt(e){return e}const Ft=["global","local","others"];var Lt=function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var s=0;for(a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(r[a[s]]=e[a[s]])}return r};class zt{constructor(e){let{url:t="",headers:r={},fetch:a}=e;this.url=t,this.headers=r,this.fetch=ht(a),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ft[0];if(Ft.indexOf(t)<0)throw new Error("@supabase/auth-js: Parameter scope must be one of ".concat(Ft.join(", ")));try{return await At(this.fetch,"POST","".concat(this.url,"/logout?scope=").concat(t),{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Be(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await At(this.fetch,"POST","".concat(this.url,"/invite"),{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:It})}catch(r){if(Be(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=Lt(e,["options"]),a=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(a.new_email=null===r||void 0===r?void 0:r.newEmail,delete a.newEmail),await At(this.fetch,"POST","".concat(this.url,"/admin/generate_link"),{body:a,headers:this.headers,xform:Rt,redirectTo:null===t||void 0===t?void 0:t.redirectTo})}catch(t){if(Be(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await At(this.fetch,"POST","".concat(this.url,"/admin/users"),{body:e,headers:this.headers,xform:It})}catch(t){if(Be(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,a,s,n,i,o;try{const l={nextPage:null,lastPage:0,total:0},c=await At(this.fetch,"GET","".concat(this.url,"/admin/users"),{headers:this.headers,noResolveJson:!0,query:{page:null!==(r=null===(t=null===e||void 0===e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==r?r:"",per_page:null!==(s=null===(a=null===e||void 0===e?void 0:e.perPage)||void 0===a?void 0:a.toString())&&void 0!==s?s:""},xform:Mt});if(c.error)throw c.error;const d=await c.json(),u=null!==(n=c.headers.get("x-total-count"))&&void 0!==n?n:0,h=null!==(o=null===(i=c.headers.get("link"))||void 0===i?void 0:i.split(","))&&void 0!==o?o:[];return h.length>0&&(h.forEach(e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),r=JSON.parse(e.split(";")[1].split("=")[1]);l["".concat(r,"Page")]=t}),l.total=parseInt(u)),{data:Object.assign(Object.assign({},d),l),error:null}}catch(l){if(Be(l))return{data:{users:[]},error:l};throw l}}async getUserById(e){Nt(e);try{return await At(this.fetch,"GET","".concat(this.url,"/admin/users/").concat(e),{headers:this.headers,xform:It})}catch(t){if(Be(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Nt(e);try{return await At(this.fetch,"PUT","".concat(this.url,"/admin/users/").concat(e),{body:t,headers:this.headers,xform:It})}catch(r){if(Be(r))return{data:{user:null},error:r};throw r}}async deleteUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Nt(e);try{return await At(this.fetch,"DELETE","".concat(this.url,"/admin/users/").concat(e),{headers:this.headers,body:{should_soft_delete:t},xform:It})}catch(r){if(Be(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){Nt(e.userId);try{const{data:t,error:r}=await At(this.fetch,"GET","".concat(this.url,"/admin/users/").concat(e.userId,"/factors"),{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:r}}catch(t){if(Be(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Nt(e.userId),Nt(e.id);try{return{data:await At(this.fetch,"DELETE","".concat(this.url,"/admin/users/").concat(e.userId,"/factors/").concat(e.id),{headers:this.headers}),error:null}}catch(t){if(Be(t))return{data:null,error:t};throw t}}}function Bt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const Ut=!!(globalThis&&ut()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"));class Wt extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Ht extends Wt{}async function Vt(e,t,r){Ut&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const a=new globalThis.AbortController;return t>0&&setTimeout(()=>{a.abort(),Ut&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:a.signal},async a=>{if(!a){if(0===t)throw Ut&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Ht('Acquiring an exclusive Navigator LockManager lock "'.concat(e,'" immediately failed'));if(Ut)try{const e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}Ut&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{Ut&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}))}!function(){if("object"!==typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!==typeof self&&(self.globalThis=self)}}();const Gt={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Re,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function qt(e,t,r){return await r()}const $t={};class Kt{constructor(e){var t,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Kt.nextInstanceID,Kt.nextInstanceID+=1,this.instanceID>0&&ct()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},Gt),e);if(this.logDebugMessages=!!a.debug,"function"===typeof a.debug&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new zt({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=ht(a.fetch),this.lock=a.lock||qt,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:ct()&&(null===(t=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===t?void 0:t.locks)?this.lock=Vt:this.lock=qt,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:ut()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Bt(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=Bt(this.memoryStorage)),ct()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}null===(r=this.broadcastChannel)||void 0===r||r.addEventListener("message",async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)})}this.initialize()}get jwks(){var e,t;return null!==(t=null===(e=$t[this.storageKey])||void 0===e?void 0:e.jwks)&&void 0!==t?t:{keys:[]}}set jwks(e){$t[this.storageKey]=Object.assign(Object.assign({},$t[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return null!==(t=null===(e=$t[this.storageKey])||void 0===e?void 0:e.cachedAt)&&void 0!==t?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){$t[this.storageKey]=Object.assign(Object.assign({},$t[this.storageKey]),{cachedAt:e})}_debug(){if(this.logDebugMessages){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.logger("GoTrueClient@".concat(this.instanceID," (").concat(Pe,") ").concat((new Date).toISOString()),...t)}return this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){var e;try{const t=function(e){const t={},r=new URL(e);if(r.hash&&"#"===r.hash[0])try{new URLSearchParams(r.hash.substring(1)).forEach((e,r)=>{t[r]=e})}catch(a){}return r.searchParams.forEach((e,r)=>{t[r]=e}),t}(window.location.href);let r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),ct()&&this.detectSessionInUrl&&"none"!==r){const{data:a,error:s}=await this._getSessionFromURL(t,r);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),function(e){return Be(e)&&"AuthImplicitGrantRedirectError"===e.name}(s)){const t=null===(e=s.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:s}}return await this._removeSession(),{error:s}}const{session:n,redirectType:i}=a;return this._debug("#_initialize()","detected session in URL",n,"redirect type",i),await this._saveSession(n),setTimeout(async()=>{"recovery"===i?await this._notifyAllSubscribers("PASSWORD_RECOVERY",n):await this._notifyAllSubscribers("SIGNED_IN",n)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return Be(t)?{error:t}:{error:new We("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,a;try{const s=await At(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,body:{data:null!==(r=null===(t=null===e||void 0===e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==r?r:{},gotrue_meta_security:{captcha_token:null===(a=null===e||void 0===e?void 0:e.options)||void 0===a?void 0:a.captchaToken}},xform:Dt}),{data:n,error:i}=s;if(i||!n)return{data:{user:null,session:null},error:i};const o=n.session,l=n.user;return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(s){if(Be(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(e){var t,r,a;try{let s;if("email"in e){const{email:r,password:a,options:n}=e;let i=null,o=null;"pkce"===this.flowType&&([i,o]=await yt(this.storage,this.storageKey)),s=await At(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,redirectTo:null===n||void 0===n?void 0:n.emailRedirectTo,body:{email:r,password:a,data:null!==(t=null===n||void 0===n?void 0:n.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null===n||void 0===n?void 0:n.captchaToken},code_challenge:i,code_challenge_method:o},xform:Dt})}else{if(!("phone"in e))throw new qe("You must provide either an email or phone number and a password");{const{phone:t,password:n,options:i}=e;s=await At(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,body:{phone:t,password:n,data:null!==(r=null===i||void 0===i?void 0:i.data)&&void 0!==r?r:{},channel:null!==(a=null===i||void 0===i?void 0:i.channel)&&void 0!==a?a:"sms",gotrue_meta_security:{captcha_token:null===i||void 0===i?void 0:i.captchaToken}},xform:Dt})}}const{data:n,error:i}=s;if(i||!n)return{data:{user:null,session:null},error:i};const o=n.session,l=n.user;return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(s){if(Be(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(e){try{let t;if("email"in e){const{email:r,password:a,options:s}=e;t=await At(this.fetch,"POST","".concat(this.url,"/token?grant_type=password"),{headers:this.headers,body:{email:r,password:a,gotrue_meta_security:{captcha_token:null===s||void 0===s?void 0:s.captchaToken}},xform:Pt})}else{if(!("phone"in e))throw new qe("You must provide either an email or phone number and a password");{const{phone:r,password:a,options:s}=e;t=await At(this.fetch,"POST","".concat(this.url,"/token?grant_type=password"),{headers:this.headers,body:{phone:r,password:a,gotrue_meta_security:{captcha_token:null===s||void 0===s?void 0:s.captchaToken}},xform:Pt})}}const{data:r,error:a}=t;return a?{data:{user:null,session:null},error:a}:r&&r.session&&r.user?(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:a}):{data:{user:null,session:null},error:new Ge}}catch(t){if(Be(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,a,s;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(a=e.options)||void 0===a?void 0:a.queryParams,skipBrowserRedirect:null===(s=e.options)||void 0===s?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if("solana"===t)return await this.signInWithSolana(e);throw new Error('@supabase/auth-js: Unsupported chain "'.concat(t,'"'))}async signInWithSolana(e){var t,r,a,s,n,i,o,l,c,d,u,h;let f,m;if("message"in e)f=e.message,m=e.signature;else{const{chain:u,wallet:h,statement:p,options:g}=e;let x;if(ct())if("object"===typeof h)x=h;else{const e=window;if(!("solana"in e)||"object"!==typeof e.solana||!("signIn"in e.solana&&"function"===typeof e.solana.signIn||"signMessage"in e.solana&&"function"===typeof e.solana.signMessage))throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.");x=e.solana}else{if("object"!==typeof h||!(null===g||void 0===g?void 0:g.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");x=h}const b=new URL(null!==(t=null===g||void 0===g?void 0:g.url)&&void 0!==t?t:window.location.href);if("signIn"in x&&x.signIn){const e=await x.signIn(Object.assign(Object.assign(Object.assign({issuedAt:(new Date).toISOString()},null===g||void 0===g?void 0:g.signInWithSolana),{version:"1",domain:b.host,uri:b.href}),p?{statement:p}:null));let t;if(Array.isArray(e)&&e[0]&&"object"===typeof e[0])t=e[0];else{if(!(e&&"object"===typeof e&&"signedMessage"in e&&"signature"in e))throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");t=e}if(!("signedMessage"in t&&"signature"in t&&("string"===typeof t.signedMessage||t.signedMessage instanceof Uint8Array)&&t.signature instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields");f="string"===typeof t.signedMessage?t.signedMessage:(new TextDecoder).decode(t.signedMessage),m=t.signature}else{if(!("signMessage"in x)||"function"!==typeof x.signMessage||!("publicKey"in x)||"object"!==typeof x||!x.publicKey||!("toBase58"in x.publicKey)||"function"!==typeof x.publicKey.toBase58)throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");f=["".concat(b.host," wants you to sign in with your Solana account:"),x.publicKey.toBase58(),...p?["",p,""]:[""],"Version: 1","URI: ".concat(b.href),"Issued At: ".concat(null!==(a=null===(r=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===r?void 0:r.issuedAt)&&void 0!==a?a:(new Date).toISOString()),...(null===(s=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===s?void 0:s.notBefore)?["Not Before: ".concat(g.signInWithSolana.notBefore)]:[],...(null===(n=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===n?void 0:n.expirationTime)?["Expiration Time: ".concat(g.signInWithSolana.expirationTime)]:[],...(null===(i=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===i?void 0:i.chainId)?["Chain ID: ".concat(g.signInWithSolana.chainId)]:[],...(null===(o=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===o?void 0:o.nonce)?["Nonce: ".concat(g.signInWithSolana.nonce)]:[],...(null===(l=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===l?void 0:l.requestId)?["Request ID: ".concat(g.signInWithSolana.requestId)]:[],...(null===(d=null===(c=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===c?void 0:c.resources)||void 0===d?void 0:d.length)?["Resources",...g.signInWithSolana.resources.map(e=>"- ".concat(e))]:[]].join("\n");const e=await x.signMessage((new TextEncoder).encode(f),"utf8");if(!e||!(e instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=e}}try{const{data:t,error:r}=await At(this.fetch,"POST","".concat(this.url,"/token?grant_type=web3"),{headers:this.headers,body:Object.assign({chain:"solana",message:f,signature:lt(m)},(null===(u=e.options)||void 0===u?void 0:u.captchaToken)?{gotrue_meta_security:{captcha_token:null===(h=e.options)||void 0===h?void 0:h.captchaToken}}:null),xform:Dt});if(r)throw r;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign({},t),error:r}):{data:{user:null,session:null},error:new Ge}}catch(p){if(Be(p))return{data:{user:null,session:null},error:p};throw p}}async _exchangeCodeForSession(e){const t=await mt(this.storage,"".concat(this.storageKey,"-code-verifier")),[r,a]=(null!==t&&void 0!==t?t:"").split("/");try{const{data:t,error:s}=await At(this.fetch,"POST","".concat(this.url,"/token?grant_type=pkce"),{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:Dt});if(await pt(this.storage,"".concat(this.storageKey,"-code-verifier")),s)throw s;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign(Object.assign({},t),{redirectType:null!==a&&void 0!==a?a:null}),error:s}):{data:{user:null,session:null,redirectType:null},error:new Ge}}catch(s){if(Be(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(e){try{const{options:t,provider:r,token:a,access_token:s,nonce:n}=e,i=await At(this.fetch,"POST","".concat(this.url,"/token?grant_type=id_token"),{headers:this.headers,body:{provider:r,id_token:a,access_token:s,nonce:n,gotrue_meta_security:{captcha_token:null===t||void 0===t?void 0:t.captchaToken}},xform:Dt}),{data:o,error:l}=i;return l?{data:{user:null,session:null},error:l}:o&&o.session&&o.user?(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:o,error:l}):{data:{user:null,session:null},error:new Ge}}catch(t){if(Be(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,a,s,n;try{if("email"in e){const{email:a,options:s}=e;let n=null,i=null;"pkce"===this.flowType&&([n,i]=await yt(this.storage,this.storageKey));const{error:o}=await At(this.fetch,"POST","".concat(this.url,"/otp"),{headers:this.headers,body:{email:a,data:null!==(t=null===s||void 0===s?void 0:s.data)&&void 0!==t?t:{},create_user:null===(r=null===s||void 0===s?void 0:s.shouldCreateUser)||void 0===r||r,gotrue_meta_security:{captcha_token:null===s||void 0===s?void 0:s.captchaToken},code_challenge:n,code_challenge_method:i},redirectTo:null===s||void 0===s?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:o}}if("phone"in e){const{phone:t,options:r}=e,{data:i,error:o}=await At(this.fetch,"POST","".concat(this.url,"/otp"),{headers:this.headers,body:{phone:t,data:null!==(a=null===r||void 0===r?void 0:r.data)&&void 0!==a?a:{},create_user:null===(s=null===r||void 0===r?void 0:r.shouldCreateUser)||void 0===s||s,gotrue_meta_security:{captcha_token:null===r||void 0===r?void 0:r.captchaToken},channel:null!==(n=null===r||void 0===r?void 0:r.channel)&&void 0!==n?n:"sms"}});return{data:{user:null,session:null,messageId:null===i||void 0===i?void 0:i.message_id},error:o}}throw new qe("You must provide either an email or phone number.")}catch(i){if(Be(i))return{data:{user:null,session:null},error:i};throw i}}async verifyOtp(e){var t,r;try{let a,s;"options"in e&&(a=null===(t=e.options)||void 0===t?void 0:t.redirectTo,s=null===(r=e.options)||void 0===r?void 0:r.captchaToken);const{data:n,error:i}=await At(this.fetch,"POST","".concat(this.url,"/verify"),{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:a,xform:Dt});if(i)throw i;if(!n)throw new Error("An error occurred on token verification.");const o=n.session,l=n.user;return(null===o||void 0===o?void 0:o.access_token)&&(await this._saveSession(o),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(a){if(Be(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(e){var t,r,a;try{let s=null,n=null;return"pkce"===this.flowType&&([s,n]=await yt(this.storage,this.storageKey)),await At(this.fetch,"POST","".concat(this.url,"/sso"),{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(r=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==r?r:void 0}),(null===(a=null===e||void 0===e?void 0:e.options)||void 0===a?void 0:a.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:n}),headers:this.headers,xform:Ot})}catch(s){if(Be(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new Ve;const{error:a}=await At(this.fetch,"GET","".concat(this.url,"/reauthenticate"),{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:a}})}catch(e){if(Be(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t="".concat(this.url,"/resend");if("email"in e){const{email:r,type:a,options:s}=e,{error:n}=await At(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:a,gotrue_meta_security:{captcha_token:null===s||void 0===s?void 0:s.captchaToken}},redirectTo:null===s||void 0===s?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:n}}if("phone"in e){const{phone:r,type:a,options:s}=e,{data:n,error:i}=await At(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:a,gotrue_meta_security:{captcha_token:null===s||void 0===s?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:null===n||void 0===n?void 0:n.message_id},error:i}}throw new qe("You must provide either an email or phone number and a type")}catch(t){if(Be(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){await this.initializePromise;return await this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await r}catch(e){}})()),r}return await this.lock("lock:".concat(this.storageKey),e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(t){}})()),await e;this.pendingInLock.length;){const e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let e=null;const t=await mt(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=!!e.expires_at&&1e3*e.expires_at-Date.now()<Oe;if(this._debug("#__loadSession()","session has".concat(r?"":" not"," expired"),"expires_at",e.expires_at),!r){if(this.userStorage){const t=await mt(this.userStorage,this.storageKey+"-user");(null===t||void 0===t?void 0:t.user)?e.user=t.user:e.user=kt()}if(this.storage.isServer&&e.user){let t=this.suppressGetSessionWarning;e=new Proxy(e,{get:(e,r,a)=>(t||"user"!==r||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t=!0,this.suppressGetSessionWarning=!0),Reflect.get(e,r,a))})}return{data:{session:e},error:null}}const{session:a,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;return await this._acquireLock(-1,async()=>await this._getUser())}async _getUser(e){try{return e?await At(this.fetch,"GET","".concat(this.url,"/user"),{headers:this.headers,jwt:e,xform:It}):await this._useSession(async e=>{var t,r,a;const{data:s,error:n}=e;if(n)throw n;return(null===(t=s.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await At(this.fetch,"GET","".concat(this.url,"/user"),{headers:this.headers,jwt:null!==(a=null===(r=s.session)||void 0===r?void 0:r.access_token)&&void 0!==a?a:void 0,xform:It}):{data:{user:null},error:new Ve}})}catch(t){if(Be(t))return function(e){return Be(e)&&"AuthSessionMissingError"===e.name}(t)&&(await this._removeSession(),await pt(this.storage,"".concat(this.storageKey,"-code-verifier"))),{data:{user:null},error:t};throw t}}async updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await this._useSession(async r=>{const{data:a,error:s}=r;if(s)throw s;if(!a.session)throw new Ve;const n=a.session;let i=null,o=null;"pkce"===this.flowType&&null!=e.email&&([i,o]=await yt(this.storage,this.storageKey));const{data:l,error:c}=await At(this.fetch,"PUT","".concat(this.url,"/user"),{headers:this.headers,redirectTo:null===t||void 0===t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:i,code_challenge_method:o}),jwt:n.access_token,xform:It});if(c)throw c;return n.user=l.user,await this._saveSession(n),await this._notifyAllSubscribers("USER_UPDATED",n),{data:{user:n.user},error:null}})}catch(r){if(Be(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ve;const t=Date.now()/1e3;let r=t,a=!0,s=null;const{payload:n}=xt(e.access_token);if(n.exp&&(r=n.exp,a=r<=t),a){const{session:t,error:r}=await this._callRefreshToken(e.refresh_token);if(r)return{data:{user:null,session:null},error:r};if(!t)return{data:{user:null,session:null},error:null};s=t}else{const{data:a,error:n}=await this._getUser(e.access_token);if(n)throw n;s={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(t){if(Be(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:a,error:s}=t;if(s)throw s;e=null!==(r=a.session)&&void 0!==r?r:void 0}if(!(null===e||void 0===e?void 0:e.refresh_token))throw new Ve;const{session:a,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(Be(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!ct())throw new $e("No browser detected.");if(e.error||e.error_description||e.error_code)throw new $e(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new Ke("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new $e("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Ke("No code detected.");const{data:t,error:r}=await this._exchangeCodeForSession(e.code);if(r)throw r;const a=new URL(window.location.href);return a.searchParams.delete("code"),window.history.replaceState(window.history.state,"",a.toString()),{data:{session:t.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:a,access_token:s,refresh_token:n,expires_in:i,expires_at:o,token_type:l}=e;if(!s||!i||!n||!l)throw new $e("No session defined in URL");const c=Math.round(Date.now()/1e3),d=parseInt(i);let u=c+d;o&&(u=parseInt(o));const h=u-c;1e3*h<=Ie&&console.warn("@supabase/gotrue-js: Session as retrieved from URL expires in ".concat(h,"s, should have been closer to ").concat(d,"s"));const f=u-d;c-f>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",f,u,c):c-f<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",f,u,c);const{data:m,error:p}=await this._getUser(s);if(p)throw p;const g={provider_token:r,provider_refresh_token:a,access_token:s,expires_in:d,expires_at:u,refresh_token:n,token_type:l,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:g,redirectType:e.type},error:null}}catch(r){if(Be(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return Boolean(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await mt(this.storage,"".concat(this.storageKey,"-code-verifier"));return!(!e.code||!t)}async signOut(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut(){let{scope:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this._useSession(async t=>{var r;const{data:a,error:s}=t;if(s)return{error:s};const n=null===(r=a.session)||void 0===r?void 0:r.access_token;if(n){const{error:t}=await this.admin.signOut(n,e);if(t&&(!function(e){return Be(e)&&"AuthApiError"===e.name}(t)||404!==t.status&&401!==t.status&&403!==t.status))return{error:t}}return"others"!==e&&(await this._removeSession(),await pt(this.storage,"".concat(this.storageKey,"-code-verifier"))),{error:null}})}onAuthStateChange(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>{await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})})(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,a;try{const{data:{session:a},error:s}=t;if(s)throw s;await(null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(s){await(null===(a=this.stateChangeEmitters.get(e))||void 0===a?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=null,a=null;"pkce"===this.flowType&&([r,a]=await yt(this.storage,this.storageKey,!0));try{return await At(this.fetch,"POST","".concat(this.url,"/recover"),{body:{email:e,code_challenge:r,code_challenge_method:a,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(s){if(Be(s))return{data:null,error:s};throw s}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null}}catch(t){if(Be(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:r,error:a}=await this._useSession(async t=>{var r,a,s,n,i;const{data:o,error:l}=t;if(l)throw l;const c=await this._getUrlForProvider("".concat(this.url,"/user/identities/authorize"),e.provider,{redirectTo:null===(r=e.options)||void 0===r?void 0:r.redirectTo,scopes:null===(a=e.options)||void 0===a?void 0:a.scopes,queryParams:null===(s=e.options)||void 0===s?void 0:s.queryParams,skipBrowserRedirect:!0});return await At(this.fetch,"GET",c,{headers:this.headers,jwt:null!==(i=null===(n=o.session)||void 0===n?void 0:n.access_token)&&void 0!==i?i:void 0})});if(a)throw a;return ct()&&!(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(null===r||void 0===r?void 0:r.url),{data:{provider:e.provider,url:null===r||void 0===r?void 0:r.url},error:null}}catch(r){if(Be(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,a;const{data:s,error:n}=t;if(n)throw n;return await At(this.fetch,"DELETE","".concat(this.url,"/user/identities/").concat(e.identity_id),{headers:this.headers,jwt:null!==(a=null===(r=s.session)||void 0===r?void 0:r.access_token)&&void 0!==a?a:void 0})})}catch(t){if(Be(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t="#_refreshAccessToken(".concat(e.substring(0,5),"...)");this._debug(t,"begin");try{const s=Date.now();return await(r=async r=>(r>0&&await async function(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}(200*Math.pow(2,r-1)),this._debug(t,"refreshing attempt",r),await At(this.fetch,"POST","".concat(this.url,"/token?grant_type=refresh_token"),{body:{refresh_token:e},headers:this.headers,xform:Dt})),a=(e,t)=>{const r=200*Math.pow(2,e);return t&&Je(t)&&Date.now()+r-s<Ie},new Promise((e,t)=>{(async()=>{for(let n=0;n<1/0;n++)try{const t=await r(n);if(!a(n,null,t))return void e(t)}catch(s){if(!a(n,s))return void t(s)}})()}))}catch(s){if(this._debug(t,"error",s),Be(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(t,"end")}var r,a}_isValidSession(e){return"object"===typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider("".concat(this.url,"/authorize"),e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),ct()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const s=await mt(this.storage,this.storageKey);if(s&&this.userStorage){let t=await mt(this.userStorage,this.storageKey+"-user");this.storage.isServer||!Object.is(this.storage,this.userStorage)||t||(t={user:s.user},await ft(this.userStorage,this.storageKey+"-user",t)),s.user=null!==(e=null===t||void 0===t?void 0:t.user)&&void 0!==e?e:kt()}else if(s&&!s.user&&!s.user){const e=await mt(this.storage,this.storageKey+"-user");e&&(null===e||void 0===e?void 0:e.user)?(s.user=e.user,await pt(this.storage,this.storageKey+"-user"),await ft(this.storage,this.storageKey,s)):s.user=kt()}if(this._debug(r,"session from storage",s),!this._isValidSession(s))return this._debug(r,"session is not valid"),void(null!==s&&await this._removeSession());const n=1e3*(null!==(t=s.expires_at)&&void 0!==t?t:1/0)-Date.now()<Oe;if(this._debug(r,"session has".concat(n?"":" not"," expired with margin of ").concat(Oe,"s")),n){if(this.autoRefreshToken&&s.refresh_token){const{error:e}=await this._callRefreshToken(s.refresh_token);e&&(console.error(e),Je(e)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else if(s.user&&!0===s.user.__isUserNotAvailableProxy)try{const{data:e,error:t}=await this._getUser(s.access_token);!t&&(null===e||void 0===e?void 0:e.user)?(s.user=e.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(r,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){return this._debug(r,"error",s),void console.error(s)}finally{this._debug(r,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new Ve;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a="#_callRefreshToken(".concat(e.substring(0,5),"...)");this._debug(a,"begin");try{this.refreshingDeferred=new gt;const{data:t,error:r}=await this._refreshAccessToken(e);if(r)throw r;if(!t.session)throw new Ve;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const a={session:t.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(s){if(this._debug(a,"error",s),Be(s)){const e={session:null,error:s};return Je(s)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(e),e}throw null===(r=this.refreshingDeferred)||void 0===r||r.reject(s),s}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const a="#_notifyAllSubscribers(".concat(e,")");this._debug(a,"begin",t,"broadcast = ".concat(r));try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const a=[],s=Array.from(this.stateChangeEmitters.values()).map(async r=>{try{await r.callback(e,t)}catch(s){a.push(s)}});if(await Promise.all(s),a.length>0){for(let e=0;e<a.length;e+=1)console.error(a[e]);throw a[0]}}finally{this._debug(a,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),r=t.user&&!0===t.user.__isUserNotAvailableProxy;if(this.userStorage){!r&&t.user&&await ft(this.userStorage,this.storageKey+"-user",{user:t.user});const e=Object.assign({},t);delete e.user;const a=St(e);await ft(this.storage,this.storageKey,a)}else{const e=St(t);await ft(this.storage,this.storageKey,e)}}async _removeSession(){this._debug("#_removeSession()"),await pt(this.storage,this.storageKey),await pt(this.storage,this.storageKey+"-code-verifier"),await pt(this.storage,this.storageKey+"-user"),this.userStorage&&await pt(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&ct()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Ie);this.autoRefreshTicker=e,e&&"object"===typeof e&&"function"===typeof e.unref?e.unref():"undefined"!==typeof Deno&&"function"===typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async e=>{const{data:{session:r}}=e;if(!r||!r.refresh_token||!r.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const a=Math.floor((1e3*r.expires_at-t)/Ie);this._debug("#_autoRefreshTokenTick()","access token expires in ".concat(a," ticks, a tick lasts ").concat(Ie,"ms, refresh threshold is ").concat(3," ticks")),a<=3&&await this._callRefreshToken(r.refresh_token)})}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(!(e.isAcquireTimeout||e instanceof Wt))throw e;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ct()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t="#_onVisibilityChanged(".concat(e,")");this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const a=["provider=".concat(encodeURIComponent(t))];if((null===r||void 0===r?void 0:r.redirectTo)&&a.push("redirect_to=".concat(encodeURIComponent(r.redirectTo))),(null===r||void 0===r?void 0:r.scopes)&&a.push("scopes=".concat(encodeURIComponent(r.scopes))),"pkce"===this.flowType){const[e,t]=await yt(this.storage,this.storageKey),r=new URLSearchParams({code_challenge:"".concat(encodeURIComponent(e)),code_challenge_method:"".concat(encodeURIComponent(t))});a.push(r.toString())}if(null===r||void 0===r?void 0:r.queryParams){const e=new URLSearchParams(r.queryParams);a.push(e.toString())}return(null===r||void 0===r?void 0:r.skipBrowserRedirect)&&a.push("skip_http_redirect=".concat(r.skipBrowserRedirect)),"".concat(e,"?").concat(a.join("&"))}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:a,error:s}=t;return s?{data:null,error:s}:await At(this.fetch,"DELETE","".concat(this.url,"/factors/").concat(e.factorId),{headers:this.headers,jwt:null===(r=null===a||void 0===a?void 0:a.session)||void 0===r?void 0:r.access_token})})}catch(t){if(Be(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,a;const{data:s,error:n}=t;if(n)return{data:null,error:n};const i=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:{issuer:e.issuer}),{data:o,error:l}=await At(this.fetch,"POST","".concat(this.url,"/factors"),{body:i,headers:this.headers,jwt:null===(r=null===s||void 0===s?void 0:s.session)||void 0===r?void 0:r.access_token});return l?{data:null,error:l}:("totp"===e.factorType&&(null===(a=null===o||void 0===o?void 0:o.totp)||void 0===a?void 0:a.qr_code)&&(o.totp.qr_code="data:image/svg+xml;utf-8,".concat(o.totp.qr_code)),{data:o,error:null})})}catch(t){if(Be(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:a,error:s}=t;if(s)return{data:null,error:s};const{data:n,error:i}=await At(this.fetch,"POST","".concat(this.url,"/factors/").concat(e.factorId,"/verify"),{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null===(r=null===a||void 0===a?void 0:a.session)||void 0===r?void 0:r.access_token});return i?{data:null,error:i}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+n.expires_in},n)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",n),{data:n,error:i})})}catch(t){if(Be(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:a,error:s}=t;return s?{data:null,error:s}:await At(this.fetch,"POST","".concat(this.url,"/factors/").concat(e.factorId,"/challenge"),{body:{channel:e.channel},headers:this.headers,jwt:null===(r=null===a||void 0===a?void 0:a.session)||void 0===r?void 0:r.access_token})})}catch(t){if(Be(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=(null===e||void 0===e?void 0:e.factors)||[],a=r.filter(e=>"totp"===e.factor_type&&"verified"===e.status),s=r.filter(e=>"phone"===e.factor_type&&"verified"===e.status);return{data:{all:r,totp:a,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;const{data:{session:a},error:s}=e;if(s)return{data:null,error:s};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:n}=xt(a.access_token);let i=null;n.aal&&(i=n.aal);let o=i;(null!==(r=null===(t=a.user.factors)||void 0===t?void 0:t.filter(e=>"verified"===e.status))&&void 0!==r?r:[]).length>0&&(o="aal2");return{data:{currentLevel:i,nextLevel:o,currentAuthenticationMethods:n.amr||[]},error:null}}))}async fetchJwk(e){let t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{keys:[]}).keys.find(t=>t.kid===e);if(t)return t;const r=Date.now();if(t=this.jwks.keys.find(t=>t.kid===e),t&&this.jwks_cached_at+6e5>r)return t;const{data:a,error:s}=await At(this.fetch,"GET","".concat(this.url,"/.well-known/jwks.json"),{headers:this.headers});if(s)throw s;return a.keys&&0!==a.keys.length?(this.jwks=a,this.jwks_cached_at=r,t=a.keys.find(t=>t.kid===e),t||null):null}async getClaims(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let r=e;if(!r){const{data:e,error:t}=await this.getSession();if(t||!e.session)return{data:null,error:t};r=e.session.access_token}const{header:a,payload:s,signature:n,raw:{header:i,payload:o}}=xt(r);(null===t||void 0===t?void 0:t.allowExpired)||function(e){if(!e)throw new Error("Missing exp claim");if(e<=Math.floor(Date.now()/1e3))throw new Error("JWT has expired")}(s.exp);const l=a.alg&&!a.alg.startsWith("HS")&&a.kid&&"crypto"in globalThis&&"subtle"in globalThis.crypto?await this.fetchJwk(a.kid,(null===t||void 0===t?void 0:t.keys)?{keys:t.keys}:null===t||void 0===t?void 0:t.jwks):null;if(!l){const{error:e}=await this.getUser(r);if(e)throw e;return{data:{claims:s,header:a,signature:n},error:null}}const c=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}(a.alg),d=await crypto.subtle.importKey("jwk",l,c,!0,["verify"]);if(!await crypto.subtle.verify(c,d,n,function(e){const t=[];return it(e,e=>t.push(e)),new Uint8Array(t)}("".concat(i,".").concat(o))))throw new Qe("Invalid JWT signature");return{data:{claims:s,header:a,signature:n},error:null}}catch(r){if(Be(r))return{data:null,error:r};throw r}}}Kt.nextInstanceID=0;const Yt=Kt;class Jt extends Yt{constructor(e){super(e)}}var Xt=function(e,t,r,a){return new(r||(r=Promise))(function(s,n){function i(e){try{l(a.next(e))}catch(t){n(t)}}function o(e){try{l(a.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(i,o)}l((a=a.apply(e,t||[])).next())})};class Qt{constructor(e,t,r){var a,s,n;this.supabaseUrl=e,this.supabaseKey=t;const i=function(e){const t=null===e||void 0===e?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL((r=t).endsWith("/")?r:r+"/")}catch(a){throw Error("Invalid supabaseUrl: Provided URL is malformed.")}var r}(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",i),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",i),this.storageUrl=new URL("storage/v1",i),this.functionsUrl=new URL("functions/v1",i);const o="sb-".concat(i.hostname.split(".")[0],"-auth-token"),l=function(e,t){var r,a;const{db:s,auth:n,realtime:i,global:o}=e,{db:l,auth:c,realtime:d,global:u}=t,h={db:Object.assign(Object.assign({},l),s),auth:Object.assign(Object.assign({},c),n),realtime:Object.assign(Object.assign({},d),i),storage:{},global:Object.assign(Object.assign(Object.assign({},u),o),{headers:Object.assign(Object.assign({},null!==(r=null===u||void 0===u?void 0:u.headers)&&void 0!==r?r:{}),null!==(a=null===o||void 0===o?void 0:o.headers)&&void 0!==a?a:{})}),accessToken:()=>De(this,void 0,void 0,function*(){return""})};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}(null!==r&&void 0!==r?r:{},{db:ke,realtime:Ee,auth:Object.assign(Object.assign({},Se),{storageKey:o}),global:Ne});this.storageKey=null!==(a=l.auth.storageKey)&&void 0!==a?a:"",this.headers=null!==(s=l.global.headers)&&void 0!==s?s:{},l.accessToken?(this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error("@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.".concat(String(t)," is not possible"))}})):this.auth=this._initSupabaseAuthClient(null!==(n=l.auth)&&void 0!==n?n:{},this.headers,l.global.fetch),this.fetch=Ae(t,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.rest=new h(new URL("rest/v1",i).href,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),this.storage=new we(this.storageUrl.href,this.headers,this.fetch,null===r||void 0===r?void 0:r.storage),l.accessToken||this._listenForAuthEvents()}get functions(){return new d(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.rest.rpc(e,t,r)}channel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}};return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return Xt(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return null!==(t=null===(e=r.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:this.supabaseKey})}_initSupabaseAuthClient(e,t,r){let{autoRefreshToken:a,persistSession:s,detectSessionInUrl:n,storage:i,userStorage:o,storageKey:l,flowType:c,lock:d,debug:u}=e;const h={Authorization:"Bearer ".concat(this.supabaseKey),apikey:"".concat(this.supabaseKey)};return new Jt({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),t),storageKey:l,autoRefreshToken:a,persistSession:s,detectSessionInUrl:n,storage:i,userStorage:o,flowType:c,lock:d,debug:u,fetch:r,hasCustomAuthorizationHeader:Object.keys(this.headers).some(e=>"authorization"===e.toLowerCase())})}_initRealtimeClient(e){return new X(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null===e||void 0===e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null===t||void 0===t?void 0:t.access_token)})}_handleTokenChanged(e,t,r){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===r?"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):this.changedAccessToken=r}}(function(){if("undefined"!==typeof window)return!1;if("undefined"===typeof process)return!1;const e=process.version;if(void 0===e||null===e)return!1;const t=e.match(/^v(\d+)\./);return!!t&&parseInt(t[1],10)<=18})()&&console.warn("\u26a0\ufe0f  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Zt=new class{constructor(){var e;this.supabase=new Qt("https://ogqpsrsssrrytrqoyyph.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9ncXBzcnNzc3JyeXRycW95eXBoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc3Nzc5NjAsImV4cCI6MjA3MzM1Mzk2MH0.EqXjG1iefYMZ84Tw-4po98gBV7uRuPoz0idQgJ03pzg",e),this.currentUser=null,this.organizationId=null,this.isSaving=!1}async initialize(){try{console.log("\ud83d\ude80 Inicializando SupabaseService...");const{data:{user:t}}=await this.supabase.auth.getUser();if(this.currentUser=t,t){console.log("\u2705 Usuario autenticado:",t.email);try{console.log("\ud83d\ude80 Iniciando detecci\xf3n de organizaci\xf3n...");const e=await this.detectUserOrganization();e?(this.organizationId=e,console.log("\u2705 Detecci\xf3n de organizaci\xf3n completada. OrganizationId:",this.organizationId)):(console.log("\u26a0\ufe0f No se pudo detectar organizaci\xf3n autom\xe1ticamente"),this.organizationId=null)}catch(e){console.error("\u274c Error en detecci\xf3n de organizaci\xf3n:",e),this.organizationId=null}}else console.log("\u26a0\ufe0f No hay usuario autenticado"),this.organizationId=null;return!0}catch(e){return console.error("\u274c Error inicializando SupabaseService:",e),!1}}async detectUserOrganization(){if(!this.currentUser)return console.log("\u274c No hay usuario para detectar organizaci\xf3n"),null;try{var e;console.log("\ud83d\udd0d Detectando organizaci\xf3n para:",this.currentUser.email);const{data:t,error:r}=await this.supabase.from("organization_members").select("organization_id, role, status, organizations(id, name, owner_id)").eq("user_email",this.currentUser.email).eq("status","active").order("created_at",{ascending:!1});if(r)return console.error("\u274c Error buscando memberships:",r),null;if(!t||0===t.length)return console.log("\u274c No se encontraron memberships activos para:",this.currentUser.email),this.organizationId=null,null;console.log("\u2705 Memberships encontrados:",t.length);const a=t.find(e=>e.organizations&&e.organizations.owner_id===this.currentUser.id);if(a)return this.organizationId=a.organization_id,console.log("\u2705 Organizaci\xf3n detectada como OWNER:",{id:this.organizationId,name:a.organizations.name}),this.organizationId;const s=t[0];return this.organizationId=s.organization_id,console.log("\u2705 Organizaci\xf3n detectada como MIEMBRO:",{id:this.organizationId,name:(null===(e=s.organizations)||void 0===e?void 0:e.name)||"Sin nombre",role:s.role}),this.organizationId}catch(t){return console.error("\u274c Error en detectUserOrganization:",t),this.organizationId=null,null}}async forceReloadOrganization(){console.log("\ud83d\udd04 Forzando recarga de organizaci\xf3n...");try{this.organizationId=null;["mi-dashboard-portfolio","lastSelectedProjectId","portfolioData","organizationData","userSession"].forEach(e=>{localStorage.getItem(e)&&(console.log("\ud83d\uddd1\ufe0f Limpiando localStorage: ".concat(e)),localStorage.removeItem(e))});["currentUser","userSession","organizationData"].forEach(e=>{sessionStorage.getItem(e)&&(console.log("\ud83d\uddd1\ufe0f Limpiando sessionStorage: ".concat(e)),sessionStorage.removeItem(e))});const e=await this.detectUserOrganization();return console.log("\u2705 Recarga de organizaci\xf3n completada:",e),e}catch(e){return console.error("\u274c Error en forceReloadOrganization:",e),null}}async loadOrganization(){if(!this.currentUser)return null;try{const{data:e,error:t}=await this.supabase.from("organizations").select("id").eq("owner_id",this.currentUser.id).single();return t?(console.error("\u274c Error cargando organizaci\xf3n:",t),null):(this.organizationId=e.id,console.log("\u2705 Organizaci\xf3n detectada autom\xe1ticamente:",this.organizationId),e.id)}catch(e){return console.error("\u274c Error cargando organizaci\xf3n:",e),null}}async activatePendingInvitations(e,t){try{console.log("\ud83d\udd0d Buscando invitaciones pendientes para:",e);const{data:s,error:n}=await this.supabase.from("organization_members").select("*, organizations(id, name)").eq("user_email",e).eq("status","pending");if(n)return void console.error("\u274c Error buscando invitaciones:",n);if(s&&s.length>0){console.log("\u2705 Encontradas ".concat(s.length," invitaciones pendientes"));let e=null;for(const a of s){var r;console.log("\ud83d\udd04 Activando invitaci\xf3n para organizaci\xf3n:",null===(r=a.organizations)||void 0===r?void 0:r.name);const{error:s}=await this.supabase.from("organization_members").update({user_id:t,status:"active",accepted_at:(new Date).toISOString()}).eq("id",a.id);s?console.error("\u274c Error activando invitaci\xf3n:",s):(console.log("\u2705 Invitaci\xf3n activada exitosamente"),e||(e=a.organization_id))}if(e){var a;this.organizationId=e,console.log("\ud83c\udfe2 Organizaci\xf3n primaria configurada:",e);const t=(null===(a=s[0].organizations)||void 0===a?void 0:a.name)||"la organizaci\xf3n";console.log("\ud83c\udf89 \xa1Bienvenido a ".concat(t,"! Has sido agregado autom\xe1ticamente.")),await this.detectUserOrganization()}return{activated:s.length,primaryOrganization:e,organizations:s.map(e=>{var t;return{id:e.organization_id,name:null===(t=e.organizations)||void 0===t?void 0:t.name,role:e.role}})}}return console.log("\u2139\ufe0f No se encontraron invitaciones pendientes para este usuario"),{activated:0}}catch(s){return console.error("\u274c Error activando invitaciones pendientes:",s),{activated:0,error:s.message}}}async signUp(e,t,r){try{const{data:a,error:s}=await this.supabase.auth.signUp({email:e,password:t,options:{data:{name:r,role:"user"}}});if(s)throw s;if(a.user){const{error:e}=await this.supabase.from("users").insert({id:a.user.id,email:a.user.email,name:r,role:"user"});e&&console.warn("\u26a0\ufe0f Error creando usuario en tabla users:",e);const{data:t,error:s}=await this.supabase.from("organizations").insert({name:"".concat(r,"'s Organization"),owner_id:a.user.id}).select("id").single();s?console.warn("\u26a0\ufe0f Error creando organizaci\xf3n:",s):this.organizationId=t.id}this.currentUser=a.user;const n=await this.activatePendingInvitations(e,a.user.id);return{success:!0,user:a.user,invitationActivation:n}}catch(a){return console.error("\u274c Error en signUp:",a),{success:!1,error:a.message}}}async signIn(e,t){try{const{data:r,error:a}=await this.supabase.auth.signInWithPassword({email:e,password:t});if(a)throw a;this.currentUser=r.user;const s=await this.activatePendingInvitations(e,r.user.id);return await this.loadOrganization(),{success:!0,user:r.user,invitationActivation:s}}catch(r){return console.error("\u274c Error en signIn:",r),{success:!1,error:r.message}}}async signOut(){try{console.log("\ud83d\udeaa Iniciando logout completo...");const{error:e}=await this.supabase.auth.signOut();if(e)throw console.error("\u274c Error en Supabase signOut:",e),e;console.log("\u2705 Supabase auth signOut exitoso"),this.currentUser=null,this.organizationId=null,this.isInitialized=!1,console.log("\u2705 Propiedades del servicio limpiadas");["currentProjectId","useSupabase","portfolioData","supabase.auth.token","sb-localhost-auth-token","sb-auth-token"].forEach(e=>{localStorage.removeItem(e),console.log("\ud83d\uddd1\ufe0f Eliminado localStorage: ".concat(e))});["supabase.auth.token","sb-localhost-auth-token","sb-auth-token"].forEach(e=>{sessionStorage.removeItem(e),console.log("\ud83d\uddd1\ufe0f Eliminado sessionStorage: ".concat(e))});return(await this.supabase.auth.getUser()).data.user&&(console.warn("\u26a0\ufe0f A\xfan hay usuario despu\xe9s del logout, forzando limpieza..."),await this.supabase.auth.signOut({scope:"global"})),console.log("\u2705 Logout completo terminado exitosamente"),{success:!0}}catch(e){return console.error("\u274c Error en signOut completo:",e),{success:!1,error:e.message}}}async loadPortfolioData(){if(!this.currentUser)return console.warn("\u26a0\ufe0f No hay usuario autenticado"),null;try{var e;if(console.log("\ud83d\udcca Cargando datos del portafolio desde Supabase..."),!this.organizationId){console.log("\ud83c\udfe2 EJECUTANDO DETECCI\xd3N AUTOM\xc1TICA DE ORGANIZACI\xd3N...");const e=await this.detectUserOrganization();if(!e)return console.error("\u274c No se pudo detectar organizaci\xf3n para el usuario:",this.currentUser.email),console.error("\u274c El usuario podr\xeda no tener membres\xeda en ninguna organizaci\xf3n"),null;this.organizationId=e,console.log("\u2705 Organizaci\xf3n detectada autom\xe1ticamente:",this.organizationId)}const{data:r,error:s}=await this.supabase.from("projects").select("*").eq("organization_id",this.organizationId);if(s)return console.error("\u274c Error cargando proyectos:",s),null;console.log("\u2705 Proyectos encontrados: ".concat((null===r||void 0===r?void 0:r.length)||0));const n=(r||[]).map(e=>(0,a.A)((0,a.A)({},e),{},{startDate:e.start_date||e.startDate,endDate:e.end_date||e.endDate,businessCase:e.business_case||e.businessCase,kickoffDate:e.kickoff_date||e.kickoffDate,contingencyReserve:e.contingency_reserve||e.contingencyReserve,managementReserve:e.management_reserve||e.managementReserve,createdAt:e.created_at||e.createdAt,updatedAt:e.updated_at||e.updatedAt,start_date:e.start_date,end_date:e.end_date,business_case:e.business_case,kickoff_date:e.kickoff_date,contingency_reserve:e.contingency_reserve,management_reserve:e.management_reserve,created_at:e.created_at,updated_at:e.updated_at}));if(console.log("\u2705 Proyectos convertidos: ".concat((null===(e=n)||void 0===e?void 0:e.length)||0)),!n||0===n.length){console.log("\ud83d\udcdd Creando proyecto de demostraci\xf3n...");const e={id:(()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))(),name:"Proyecto de Demostraci\xf3n",description:"Proyecto de ejemplo para familiarizarse con el sistema",status:"active",priority:"medium",start_date:(new Date).toISOString().split("T")[0],end_date:new Date(Date.now()+2592e6).toISOString().split("T")[0],budget:1e5,manager:this.currentUser.email,sponsor:"Sistema",organization_id:this.organizationId,owner_id:this.currentUser.id,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()},{data:t,error:r}=await this.supabase.from("projects").insert(e).select("*").single();if(r)return console.error("\u274c Error creando proyecto de demostraci\xf3n:",r),null;n=[t],console.log("\u2705 Proyecto de demostraci\xf3n creado")}const i={};for(const e of n){const{data:t,error:r}=await this.supabase.from("tasks").select("*").eq("project_id",e.id);if(r)console.warn("\u26a0\ufe0f Error cargando tareas para proyecto ".concat(e.id,":"),r),i[e.id]=[];else{const r=(t||[]).map(e=>{const t={id:e.id,name:e.name,description:e.description,duration:e.duration,progress:e.progress,priority:e.priority,cost:e.cost,predecessors:e.predecessors,successors:e.successors,resources:e.resources,status:e.status,project_id:e.project_id,owner_id:e.owner_id,created_at:e.created_at,updated_at:e.updated_at,wbsCode:e.wbs_code,startDate:e.start_date,endDate:e.end_date,assignedTo:e.assigned_to,isMilestone:e.is_milestone,originalDuration:e.original_duration};return Object.keys(t).forEach(e=>{void 0!==t[e]&&null!==t[e]||delete t[e]}),t});i[e.id]=r,console.log("\u2705 Tareas cargadas para proyecto ".concat(e.id,": ").concat(r.length))}}const o={};for(const e of n){const{data:t,error:r}=await this.supabase.from("risks").select("*").eq("project_id",e.id);r?(console.warn("\u26a0\ufe0f Error cargando riesgos para proyecto ".concat(e.id,":"),r),o[e.id]=[]):o[e.id]=t||[]}const{data:l,error:c}=await this.supabase.from("resources").select("*").eq("organization_id",this.organizationId);c&&console.warn("\u26a0\ufe0f Error cargando recursos:",c);const{data:d,error:u}=await this.supabase.from("corporate_alerts").select("*").eq("organization_id",this.organizationId);u&&console.warn("\u26a0\ufe0f Error cargando alertas:",u);const h={};for(const e of n){const{data:t,error:r}=await this.supabase.from("purchase_orders").select("*").eq("project_id",e.id);r?(console.warn("\u26a0\ufe0f Error cargando \xf3rdenes de compra para proyecto ".concat(e.id,":"),r),h[e.id]=[]):h[e.id]=t||[]}const f={};for(const e of n){const{data:t,error:r}=await this.supabase.from("advances").select("*").eq("project_id",e.id);r?(console.warn("\u26a0\ufe0f Error cargando anticipos para proyecto ".concat(e.id,":"),r),f[e.id]=[]):f[e.id]=t||[]}const m={};for(const e of n){const{data:t,error:r}=await this.supabase.from("invoices").select("*").eq("project_id",e.id);r?(console.warn("\u26a0\ufe0f Error cargando facturas para proyecto ".concat(e.id,":"),r),m[e.id]=[]):m[e.id]=t||[]}const p={};for(const e of n){const{data:t,error:r}=await this.supabase.from("contracts").select("*").eq("project_id",e.id);r?(console.warn("\u26a0\ufe0f Error cargando contratos para proyecto ".concat(e.id,":"),r),p[e.id]=[]):p[e.id]=t||[]}const g={};for(const e of n){const{data:t,error:r}=await this.supabase.from("resource_assignments").select("*").eq("project_id",e.id);r?(console.warn("\u26a0\ufe0f Error cargando asignaciones para proyecto ".concat(e.id,":"),r),g[e.id]=[]):g[e.id]=t||[]}const x={},b={};for(const e of n){const{success:t,minutas:r}=await this.loadMinutasByProject(e.id);b[e.id]=t?(r||[]).map(e=>({id:e.id,tarea:e.task_description,responsable:e.responsible_person,fecha:e.due_date,hitoId:e.milestone_id,estatus:e.status,fechaCreacion:e.created_at})):[]}const v={};for(const e of n)try{const{data:t,error:r}=await this.supabase.from("project_configurations").select("*").eq("project_id",e.id).single();r?("PGRST116"===r.code||console.warn("\u26a0\ufe0f Error cargando configuraci\xf3n para proyecto ".concat(e.id,":"),r),v[e.id]=!1):v[e.id]=!!t&&t.include_weekends}catch(t){console.warn("\u26a0\ufe0f Error general cargando configuraci\xf3n para proyecto ".concat(e.id,":"),t),v[e.id]=!1}const y={projects:n||[],tasksByProject:i,risksByProject:o,globalResources:l||[],corporateAlerts:d||[],purchaseOrdersByProject:h,advancesByProject:f,invoicesByProject:m,contractsByProject:p,resourceAssignmentsByProject:g,auditLogsByProject:x,minutasByProject:b,includeWeekendsByProject:v,currentProjectId:n&&n.length>0?n[0].id:null,version:"1.0.0",lastUpdated:(new Date).toISOString()};return console.log("\u2705 Datos del portafolio cargados:",y),y}catch(t){return console.error("\u274c Error cargando datos del portafolio:",t),null}}async deleteProject(e){if(!this.currentUser||!this.organizationId)return console.warn("\u26a0\ufe0f No hay usuario autenticado o organizaci\xf3n"),!1;try{console.log("\ud83d\uddd1\ufe0f Eliminando proyecto ".concat(e," de Supabase..."));const{error:t}=await this.supabase.from("tasks").delete().eq("project_id",e);t&&console.warn("\u26a0\ufe0f Error eliminando tareas del proyecto:",t);const{error:r}=await this.supabase.from("project_configurations").delete().eq("project_id",e);r&&console.warn("\u26a0\ufe0f Error eliminando configuraci\xf3n del proyecto:",r),console.log("\ud83d\udccb Los logs de auditor\xeda se mantienen en localStorage");const{error:a}=await this.supabase.from("projects").delete().eq("id",e);return a?(console.error("\u274c Error eliminando proyecto:",a),!1):(console.log("\u2705 Proyecto ".concat(e," eliminado de Supabase")),!0)}catch(t){return console.error("\u274c Error eliminando proyecto:",t),!1}}async savePortfolioData(e){if(!this.currentUser||!this.organizationId)return console.warn("\u26a0\ufe0f No hay usuario autenticado o organizaci\xf3n"),!1;if(this.isSaving)return console.warn("\u26a0\ufe0f savePortfolioData - GUARDADO EN PROGRESO, OMITIENDO"),!1;this.isSaving=!0,console.log("\ud83d\udcbe Guardando datos del portafolio en Supabase...");try{if(e.projects&&e.projects.length>0){const t=e.projects.map(e=>{const t=e=>{if(!e)return null;try{const t=new Date(e);if(isNaN(t.getTime()))return console.warn("\u26a0\ufe0f Fecha inv\xe1lida detectada: ".concat(e)),null;const r=t.getFullYear();return r<1900||r>2100?(console.warn("\u26a0\ufe0f A\xf1o fuera de rango: ".concat(r," en fecha ").concat(e)),null):t.toISOString().split("T")[0]}catch(t){return console.warn("\u26a0\ufe0f Error procesando fecha ".concat(e,":"),t),null}};return{id:e.id,name:e.name,description:e.description,status:e.status,priority:e.priority,budget:e.budget,manager:e.manager,sponsor:e.sponsor||"",objective:e.objective||"",business_case:e.businessCase||e.business_case||"",irr:e.irr||0,roi:e.roi||0,contingency_reserve:e.contingencyReserve||e.contingency_reserve||0,management_reserve:e.managementReserve||e.management_reserve||0,kickoff_date:t(e.kickoffDate||e.kickoff_date),stakeholders:e.stakeholders||[],team:e.team||[],progress:e.progress||0,version:e.version||"1.0.0",organization_id:this.organizationId,owner_id:this.currentUser.id,updated_at:(new Date).toISOString(),start_date:t(e.startDate||e.start_date),end_date:t(e.endDate||e.end_date),created_at:t(e.createdAt||e.created_at)||(new Date).toISOString()}}),{error:r}=await this.supabase.from("projects").upsert(t,{onConflict:"id"});if(r)throw r;console.log("\u2705 Proyectos guardados")}for(const r in e.tasksByProject){const a=e.tasksByProject[r];if(a&&a.length>0){const e=new Set,s=[];let n=0;for(const t of a)e.has(t.id)?(console.warn("\u26a0\ufe0f Tarea duplicada detectada en Supabase: ".concat(t.id," - ").concat(t.name)),n++):(e.add(t.id),s.push(t));n>0&&console.warn("\u26a0\ufe0f Se encontraron ".concat(n," tareas duplicadas en Supabase, eliminando duplicados..."));const i=s.map(e=>{const t=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e.id)?e.id:"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)});t!==e.id&&console.log('\ud83d\udd04 Generando nuevo UUID para tarea "'.concat(e.name,'": ').concat(e.id," \u2192 ").concat(t));const a=e=>{if(!e)return null;try{const t=new Date(e);return isNaN(t.getTime())?(console.warn("\u26a0\ufe0f Fecha inv\xe1lida en tarea: ".concat(e)),null):t.toISOString().split("T")[0]}catch(t){return console.warn("\u26a0\ufe0f Error procesando fecha de tarea ".concat(e,":"),t),null}},s={id:t,name:e.name,description:e.description,duration:e.duration,progress:e.progress||0,priority:e.priority,cost:e.cost||0,predecessors:e.predecessors||[],successors:e.successors||[],resources:e.resources||[],status:e.status||"pending",project_id:r,owner_id:this.currentUser.id,wbs_code:e.wbsCode||e.wbs_code,start_date:a(e.startDate||e.start_date),end_date:a(e.endDate||e.end_date),assigned_to:e.assignedTo||e.assigned_to,is_milestone:e.isMilestone||e.is_milestone||!1,original_duration:e.originalDuration||e.original_duration};return Object.keys(s).forEach(e=>{void 0!==s[e]&&null!==s[e]||delete s[e]}),s});console.log("\ud83d\udccb Enviando ".concat(i.length," tareas a Supabase para proyecto ").concat(r)),console.log("\ud83d\udccb Primera tarea de ejemplo:",i[0]);const o=new Set,l=[];i.forEach(e=>{o.has(e.id)?l.push(e.id):o.add(e.id)}),l.length>0&&(console.error("\ud83d\udea8 DUPLICADOS DETECTADOS ANTES DE ENVIAR A SUPABASE:",l),console.error("\ud83d\udea8 Total duplicados: ".concat(l.length," de ").concat(i.length," tareas"))),console.log("\ud83d\uddd1\ufe0f Eliminando tareas existentes del proyecto ".concat(r,"..."));const{error:c}=await this.supabase.from("tasks").delete().eq("project_id",r).eq("owner_id",this.currentUser.id);if(c)throw console.error("\u274c Error eliminando tareas existentes para proyecto ".concat(r,":"),c),c;console.log("\ud83d\udcdd Insertando ".concat(i.length," tareas nuevas para proyecto ").concat(r,"..."));const{error:d}=await this.supabase.from("tasks").insert(i);if(d)console.error("\u274c Error guardando tareas para proyecto ".concat(r,":"),d),console.error("\u274c Detalles del error:",{code:d.code,message:d.message,details:d.details,hint:d.hint});else{console.log("\u2705 TAREAS REEMPLAZADAS COMPLETAMENTE para proyecto ".concat(r,": ").concat(i.length," tareas nuevas (cronograma anterior eliminado)"));try{await new Promise(e=>setTimeout(e,500));const{data:e,error:t}=await this.supabase.from("tasks").select("id, name, created_at").eq("project_id",r).order("created_at",{ascending:!1});if(!t&&e){const t=e.length,r=i.length;if(t!==r){console.error("\ud83d\udea8 DUPLICACI\xd3N DETECTADA EN SUPABASE!"),console.error("\ud83d\udea8 Esperadas: ".concat(r,", Guardadas: ").concat(t)),console.error("\ud83d\udea8 Diferencia: ".concat(t-r," tareas duplicadas"));const a=new Set,s=[];e.forEach(e=>{a.has(e.id)?s.push(e):a.add(e.id)}),s.length>0&&console.error("\ud83d\udea8 TAREAS DUPLICADAS POR ID:",s.slice(0,5));const n={};e.forEach(e=>{n[e.name]=(n[e.name]||0)+1});const i=Object.entries(n).filter(e=>{let[t,r]=e;return r>1}).slice(0,5);i.length>0&&console.error("\ud83d\udea8 TAREAS DUPLICADAS POR NOMBRE:",i)}else console.log("\u2705 Verificaci\xf3n exitosa: ".concat(t," tareas en Supabase"))}else console.warn("\u26a0\ufe0f Error verificando tareas guardadas:",t)}catch(t){console.warn("\u26a0\ufe0f Error verificando tareas guardadas:",t)}}}}for(const t in e.risksByProject){const r=e.risksByProject[t];if(r&&r.length>0){const e=r.map(e=>(0,a.A)((0,a.A)({},e),{},{project_id:t,owner_id:this.currentUser.id,updated_at:(new Date).toISOString()})),{error:s}=await this.supabase.from("risks").upsert(e,{onConflict:"id"});s&&console.warn("\u26a0\ufe0f Error guardando riesgos para proyecto ".concat(t,":"),s)}}if(e.globalResources&&e.globalResources.length>0){const t=e.globalResources.map(e=>(0,a.A)((0,a.A)({},e),{},{organization_id:this.organizationId,owner_id:this.currentUser.id,updated_at:(new Date).toISOString()})),{error:r}=await this.supabase.from("resources").upsert(t,{onConflict:"id"});r&&console.warn("\u26a0\ufe0f Error guardando recursos:",r)}if(e.corporateAlerts&&e.corporateAlerts.length>0){const t=e.corporateAlerts.map(e=>(0,a.A)((0,a.A)({},e),{},{organization_id:this.organizationId,owner_id:this.currentUser.id,updated_at:(new Date).toISOString()})),{error:r}=await this.supabase.from("corporate_alerts").upsert(t,{onConflict:"id"});r&&console.warn("\u26a0\ufe0f Error guardando alertas:",r)}for(const t in e.purchaseOrdersByProject){const r=e.purchaseOrdersByProject[t];if(r&&r.length>0){const e=r.map(e=>{const r=(0,a.A)({},e);return["requestDate","approvalDate","expectedDate"].forEach(e=>{""!==r[e]&&null!==r[e]&&void 0!==r[e]||(r[e]=null)}),(0,a.A)((0,a.A)({},r),{},{project_id:t,owner_id:this.currentUser.id,updated_at:(new Date).toISOString()})}),{error:s}=await this.supabase.from("purchase_orders").upsert(e,{onConflict:"id"});s&&console.warn("\u26a0\ufe0f Error guardando \xf3rdenes de compra para proyecto ".concat(t,":"),s)}}for(const t in e.advancesByProject){const r=e.advancesByProject[t];if(r&&r.length>0){const e=r.map(e=>(0,a.A)((0,a.A)({},e),{},{project_id:t,owner_id:this.currentUser.id,updated_at:(new Date).toISOString()})),{error:s}=await this.supabase.from("advances").upsert(e,{onConflict:"id"});s&&console.warn("\u26a0\ufe0f Error guardando anticipos para proyecto ".concat(t,":"),s)}}for(const t in e.invoicesByProject){const r=e.invoicesByProject[t];if(r&&r.length>0){const e=r.map(e=>(0,a.A)((0,a.A)({},e),{},{project_id:t,owner_id:this.currentUser.id,updated_at:(new Date).toISOString()})),{error:s}=await this.supabase.from("invoices").upsert(e,{onConflict:"id"});s&&console.warn("\u26a0\ufe0f Error guardando facturas para proyecto ".concat(t,":"),s)}}for(const t in e.contractsByProject){const r=e.contractsByProject[t];if(r&&r.length>0){const e=r.map(e=>(0,a.A)((0,a.A)({},e),{},{project_id:t,owner_id:this.currentUser.id,updated_at:(new Date).toISOString()})),{error:s}=await this.supabase.from("contracts").upsert(e,{onConflict:"id"});s&&console.warn("\u26a0\ufe0f Error guardando contratos para proyecto ".concat(t,":"),s)}}for(const t in e.resourceAssignmentsByProject){const r=e.resourceAssignmentsByProject[t];if(r&&r.length>0){const e=r.map(e=>(0,a.A)((0,a.A)({},e),{},{project_id:t,owner_id:this.currentUser.id,updated_at:(new Date).toISOString()})),{error:s}=await this.supabase.from("resource_assignments").upsert(e,{onConflict:"id"});s&&console.warn("\u26a0\ufe0f Error guardando asignaciones para proyecto ".concat(t,":"),s)}}if(e.auditLogsByProject&&console.log("\ud83d\udccb Audit logs detectados pero no se guardan en Supabase (se usan localStorage)"),e.minutasByProject)for(const t in e.minutasByProject){const r=e.minutasByProject[t];if(r&&r.length>0){console.log("\ud83d\udccb Guardando minutas para proyecto ".concat(t,": ").concat(r.length," minutas"));const{error:e}=await this.supabase.from("minute_tasks").delete().eq("project_id",t);e&&console.warn("\u26a0\ufe0f Error eliminando minutas existentes para proyecto ".concat(t,":"),e);const a=await this.saveMinutas(t,r);a.success||console.warn("\u26a0\ufe0f Error guardando minutas para proyecto ".concat(t,":"),a.error)}}for(const t in e.includeWeekendsByProject){const r=e.includeWeekendsByProject[t];if(!/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)){console.log("\u26a0\ufe0f Saltando configuraci\xf3n para proyecto con ID inv\xe1lido: ".concat(t));continue}const a={project_id:t,include_weekends:r,owner_id:this.currentUser.id},{error:s}=await this.supabase.from("project_configurations").insert(a);let n=null;if(s&&"23505"===s.code){const{error:e}=await this.supabase.from("project_configurations").update(a).eq("project_id",t);n=e}else n=s;n?(console.warn("\u26a0\ufe0f Error guardando configuraci\xf3n para proyecto ".concat(t,":"),n),console.warn("\u26a0\ufe0f Detalles del error de configuraci\xf3n:",{code:n.code,message:n.message,details:n.details,hint:n.hint})):console.log("\u2705 Configuraci\xf3n guardada para proyecto ".concat(t))}return console.log("\u2705 Datos del portafolio guardados en Supabase"),!0}catch(r){return console.error("\u274c Error guardando datos del portafolio:",r),!1}finally{this.isSaving=!1,console.log("\ud83d\udd13 Flag de guardado liberado")}}getCurrentUser(){return this.currentUser}isAuthenticated(){return!!this.currentUser}getCurrentOrganization(){return this.organizationId}async cleanDuplicatesInSupabase(){if(!this.currentUser||!this.organizationId)return console.warn("\u26a0\ufe0f No hay usuario autenticado o organizaci\xf3n"),!1;try{console.log("\ud83e\uddf9 Iniciando limpieza de duplicados en Supabase...");const{data:e,error:t}=await this.supabase.from("projects").select("id, name").eq("organization_id",this.organizationId);if(t)return console.error("\u274c Error obteniendo proyectos:",t),!1;let r=0,a=0;for(const s of e){console.log("\ud83e\uddf9 Limpiando duplicados para proyecto: ".concat(s.name," (").concat(s.id,")"));const{data:e,error:t}=await this.supabase.from("tasks").select("*").eq("project_id",s.id).order("created_at",{ascending:!0});if(t){console.warn("\u26a0\ufe0f Error obteniendo tareas para proyecto ".concat(s.id,":"),t),a++;continue}if(!e||0===e.length){console.log("\u2705 No hay tareas en proyecto ".concat(s.id));continue}const n=new Map,i=[];if(e.forEach(e=>{n.has(e.id)?i.push(e.id):n.set(e.id,e)}),0!==i.length){console.log("\ud83d\uddd1\ufe0f Eliminando ".concat(i.length," duplicados del proyecto ").concat(s.id));for(const e of i){const{error:t}=await this.supabase.from("tasks").delete().eq("id",e);t?(console.warn("\u26a0\ufe0f Error eliminando duplicado ".concat(e,":"),t),a++):r++}console.log("\u2705 Limpieza completada para proyecto ".concat(s.id,": ").concat(i.length," duplicados eliminados"))}else console.log("\u2705 No hay duplicados en proyecto ".concat(s.id))}return console.log("\ud83c\udf89 Limpieza de duplicados completada:"),console.log("\u2022 Duplicados eliminados: ".concat(r)),console.log("\u2022 Errores: ".concat(a)),!0}catch(e){return console.error("\u274c Error en limpieza de duplicados:",e),!1}}async deleteRisk(e){try{if(!this.supabase||!this.currentUser)return console.warn("\u26a0\ufe0f No se puede eliminar riesgo: Supabase no inicializado o usuario no autenticado"),{success:!1,error:"No autenticado"};const{error:t}=await this.supabase.from("risks").delete().eq("id",e).eq("owner_id",this.currentUser.id);return t?(console.error("\u274c Error eliminando riesgo de Supabase:",t),{success:!1,error:t}):(console.log("\u2705 Riesgo eliminado de Supabase:",e),{success:!0})}catch(t){return console.error("\u274c Error inesperado eliminando riesgo:",t),{success:!1,error:t}}}async deleteAdvance(e){try{if(!this.supabase||!this.currentUser)return console.warn("\u26a0\ufe0f No se puede eliminar anticipo: Supabase no inicializado o usuario no autenticado"),{success:!1,error:"No autenticado"};const{error:t}=await this.supabase.from("advances").delete().eq("id",e).eq("owner_id",this.currentUser.id);return t?(console.error("\u274c Error eliminando anticipo de Supabase:",t),{success:!1,error:t}):(console.log("\u2705 Anticipo eliminado de Supabase:",e),{success:!0})}catch(t){return console.error("\u274c Error inesperado eliminando anticipo:",t),{success:!1,error:t}}}async deleteInvoice(e){try{if(!this.supabase||!this.currentUser)return console.warn("\u26a0\ufe0f No se puede eliminar factura: Supabase no inicializado o usuario no autenticado"),{success:!1,error:"No autenticado"};const{error:t}=await this.supabase.from("invoices").delete().eq("id",e).eq("owner_id",this.currentUser.id);return t?(console.error("\u274c Error eliminando factura de Supabase:",t),{success:!1,error:t}):(console.log("\u2705 Factura eliminada de Supabase:",e),{success:!0})}catch(t){return console.error("\u274c Error inesperado eliminando factura:",t),{success:!1,error:t}}}async deletePurchaseOrder(e){try{if(!this.supabase||!this.currentUser)return console.warn("\u26a0\ufe0f No se puede eliminar orden de compra: Supabase no inicializado o usuario no autenticado"),{success:!1,error:"No autenticado"};const{error:t}=await this.supabase.from("purchase_orders").delete().eq("id",e).eq("owner_id",this.currentUser.id);return t?(console.error("\u274c Error eliminando orden de compra de Supabase:",t),{success:!1,error:t}):(console.log("\u2705 Orden de compra eliminada de Supabase:",e),{success:!0})}catch(t){return console.error("\u274c Error inesperado eliminando orden de compra:",t),{success:!1,error:t}}}async initializeStorage(){try{console.log("\ud83d\uddc2\ufe0f Verificando Supabase Storage...");const{data:e,error:t}=await this.supabase.storage.listBuckets();if(t)return console.error("\u274c Error listando buckets:",t),!1;const r=e.find(e=>"project-files"===e.name);return r?(console.log("\u2705 Bucket project-files encontrado y disponible"),console.log("   - P\xfablico: ".concat(r.public?"S\xed":"No")),console.log("   - L\xedmite de archivo: ".concat(r.file_size_limit?(r.file_size_limit/1024/1024).toFixed(0)+"MB":"Sin l\xedmite")),!0):(console.log("\u274c Bucket project-files no encontrado"),console.log("\ud83d\udd04 SOLUCI\xd3N: Crea el bucket manualmente en Supabase Dashboard \u2192 Storage \u2192 New bucket"),console.log("\ud83d\udd04 Nombre: project-files, P\xfablico: S\xed, L\xedmite: 50MB"),!1)}catch(e){return console.error("\u274c Error verificando Storage:",e),!1}}async uploadFileToStorage(e,t,r){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};try{if(!this.currentUser||!this.organizationId)return console.warn("\u26a0\ufe0f No se puede subir archivo: usuario no autenticado"),{success:!1,error:"No autenticado"};const n=Date.now(),i=Math.random().toString(36).substr(2,9),o=e.name.split(".").pop(),l="".concat(n,"-").concat(i,".").concat(o),c="".concat(this.organizationId,"/").concat(t,"/").concat(r,"/").concat(l);console.log("\ud83d\udce4 Subiendo archivo a Storage: ".concat(c));const{data:d,error:u}=await this.supabase.storage.from("project-files").upload(c,e,{cacheControl:"3600",upsert:!1,contentType:e.type,metadata:(0,a.A)({originalName:e.name,uploadedBy:this.currentUser.email,projectId:t,category:r,organizationId:this.organizationId},s)});if(u)return console.error("\u274c Error subiendo archivo:",u),{success:!1,error:u};const{data:h}=this.supabase.storage.from("project-files").getPublicUrl(c),f={id:"file-".concat(n,"-").concat(i),projectId:t,category:r,fileName:e.name,originalName:e.name,fileSize:e.size,mimeType:e.type,uploadDate:(new Date).toISOString(),uploadedBy:this.currentUser.id,uploadedByEmail:this.currentUser.email,organizationId:this.organizationId,storagePath:c,publicUrl:h.publicUrl,metadata:(0,a.A)((0,a.A)({},s),{},{storageProvider:"supabase",bucket:"project-files"})};return console.log("\u2705 Archivo subido exitosamente a Storage:",f.fileName),{success:!0,file:f}}catch(n){return console.error("\u274c Error inesperado subiendo archivo:",n),{success:!1,error:n}}}async downloadFileFromStorage(e){try{if(!this.currentUser)return console.warn("\u26a0\ufe0f No se puede descargar archivo: usuario no autenticado"),{success:!1,error:"No autenticado"};console.log("\ud83d\udce5 Descargando archivo de Storage: ".concat(e));const{data:t,error:r}=await this.supabase.storage.from("project-files").download(e);return r?(console.error("\u274c Error descargando archivo:",r),{success:!1,error:r}):(console.log("\u2705 Archivo descargado exitosamente"),{success:!0,data:t})}catch(t){return console.error("\u274c Error inesperado descargando archivo:",t),{success:!1,error:t}}}async deleteFileFromStorage(e){try{if(!this.currentUser)return console.warn("\u26a0\ufe0f No se puede eliminar archivo: usuario no autenticado"),{success:!1,error:"No autenticado"};console.log("\ud83d\uddd1\ufe0f Eliminando archivo de Storage: ".concat(e));const{error:t}=await this.supabase.storage.from("project-files").remove([e]);return t?(console.error("\u274c Error eliminando archivo:",t),{success:!1,error:t}):(console.log("\u2705 Archivo eliminado exitosamente de Storage"),{success:!0})}catch(t){return console.error("\u274c Error inesperado eliminando archivo:",t),{success:!1,error:t}}}async listProjectFiles(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{if(!this.currentUser||!this.organizationId)return console.warn("\u26a0\ufe0f No se pueden listar archivos: usuario no autenticado"),{success:!1,error:"No autenticado",files:[]};let r=[],s=null;console.log("\ud83d\udccb Buscando archivos siguiendo estructura del bucket"),console.log("\ud83d\udd0d DEBUG - Par\xe1metros de b\xfasqueda:",{organizationId:this.organizationId,projectId:e,category:t});const n=t?"".concat(this.organizationId,"/").concat(e,"/").concat(t):"".concat(this.organizationId,"/").concat(e);console.log("\ud83d\udcc1 Buscando archivos SOLO del proyecto actual en ruta: ".concat(n)),console.log("\ud83d\udd0d DEBUG - Proyecto actual: ".concat(e,", Categor\xeda: ").concat(t||"todas"));const{data:i,error:o}=await this.supabase.storage.from("project-files").list(n,{limit:100,offset:0});if(o)console.error("\u274c Error listando archivos en ruta ".concat(n,":"),o),s=o;else{console.log("\ud83d\udd0d DEBUG - Archivos encontrados en ruta ".concat(n,":"),i);const t=(i||[]).filter(e=>null!==e.id);console.log("\u2705 Archivos reales del proyecto ".concat(e," encontrados: ").concat(t.length)),t.forEach(e=>{e.folderPath=n}),r=t}if(0===r.length){console.log("\ud83d\udcc1 No se encontraron archivos en ruta espec\xedfica, buscando SOLO en el proyecto actual...");const t="".concat(this.organizationId,"/").concat(e);console.log("\ud83d\udcc1 Buscando en carpeta del proyecto: ".concat(t));const{data:a,error:s}=await this.supabase.storage.from("project-files").list(t,{limit:100,offset:0});if(s)console.error("\u274c Error listando contenido de proyecto ".concat(e,":"),s);else{console.log("\ud83d\udd0d DEBUG - Contenido de proyecto ".concat(e,":"),a);for(const e of a||[])if(null===e.id){console.log("\ud83d\udcc1 Buscando archivos en categor\xeda: ".concat(e.name));const{data:a,error:s}=await this.supabase.storage.from("project-files").list("".concat(t,"/").concat(e.name),{limit:100,offset:0});if(s)console.error("\u274c Error listando archivos en categor\xeda ".concat(e.name,":"),s);else{console.log("\ud83d\udd0d DEBUG - Archivos en categor\xeda ".concat(e.name,":"),a);const s=(a||[]).filter(e=>null!==e.id);console.log("\u2705 Archivos reales en categor\xeda ".concat(e.name,":"),s.length),s.forEach(r=>{r.folderPath="".concat(t,"/").concat(e.name)}),r=r.concat(s)}}else console.log("\ud83d\udcc4 Archivo encontrado directamente en proyecto: ".concat(e.name)),e.folderPath=t,r.push(e)}}console.log("\u2705 Total archivos reales encontrados: ".concat(r.length));const l=r;if(s)return console.error("\u274c Error listando archivos:",s),{success:!1,error:s,files:[]};console.log("\ud83d\udd0d DEBUG - Datos raw de Supabase:",l),console.log("\ud83d\udd0d DEBUG - Verificando bucket completo...");const{data:c,error:d}=await this.supabase.storage.from("project-files").list("",{limit:1e3,offset:0});d?console.error("\u274c Error listando bucket completo:",d):console.log("\ud83d\udd0d DEBUG - Todos los archivos en el bucket:",c);const u=(l||[]).map(t=>{var r,s,n,i,o,l,c,d;const u=t.folderPath?"".concat(t.folderPath,"/").concat(t.name):t.name,{data:h}=this.supabase.storage.from("project-files").getPublicUrl(u),f=(null===(r=t.metadata)||void 0===r?void 0:r.size)||(null===(s=t.metadata)||void 0===s?void 0:s.file_size)||t.size||0,m=t.created_at||t.updated_at||(null===(n=t.metadata)||void 0===n?void 0:n.created_at)||(new Date).toISOString();console.log("\ud83d\udd0d DEBUG - Procesando archivo ".concat(t.name,":"),{filePath:u,"file.metadata?.size":null===(i=t.metadata)||void 0===i?void 0:i.size,"file.metadata?.file_size":null===(o=t.metadata)||void 0===o?void 0:o.file_size,"file.size":t.size,"fileSize final":f,"file.created_at":t.created_at,"file.updated_at":t.updated_at,"file.metadata?.created_at":null===(l=t.metadata)||void 0===l?void 0:l.created_at,"uploadDate final":m});const p=(null===(c=t.metadata)||void 0===c?void 0:c.originalName)||(null===(d=t.metadata)||void 0===d?void 0:d.name)||t.name;return{id:"file-".concat(t.name.split(".")[0]),projectId:e,fileName:p,fileSize:f,uploadDate:m,storagePath:u,publicUrl:h.publicUrl,metadata:(0,a.A)({storageProvider:"supabase",bucket:"project-files",originalFile:t,technicalName:t.name},t.metadata)}});return console.log("\u2705 ".concat(u.length," archivos encontrados en Storage")),console.log("\ud83d\udd0d DEBUG - Archivos encontrados:",u.map(e=>{var t;return{fileName:e.fileName,fileSize:e.fileSize,uploadDate:e.uploadDate,storagePath:e.storagePath,publicUrl:e.publicUrl,originalFile:null===(t=e.metadata)||void 0===t?void 0:t.originalFile}})),{success:!0,files:u}}catch(r){return console.error("\u274c Error inesperado listando archivos:",r),{success:!1,error:r,files:[]}}}async getSignedUrl(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3600;try{if(!this.currentUser)return console.warn("\u26a0\ufe0f No se puede obtener URL firmada: usuario no autenticado"),{success:!1,error:"No autenticado"};const{data:r,error:a}=await this.supabase.storage.from("project-files").createSignedUrl(e,t);return a?(console.error("\u274c Error obteniendo URL firmada:",a),{success:!1,error:a}):(console.log("\u2705 URL firmada obtenida exitosamente"),{success:!0,signedUrl:r.signedUrl})}catch(r){return console.error("\u274c Error inesperado obteniendo URL firmada:",r),{success:!1,error:r}}}async createDatabaseBackup(){try{console.log("\ud83d\udd04 Iniciando backup de base de datos...");const t=new Date,r=t.toISOString().split("T")[0],a=(t.toISOString().replace(/[:.]/g,"-"),["organizations","users","projects","risks","tasks","purchase_orders","advances","invoices","contracts","resources","resource_assignments"]),s={metadata:{timestamp:t.toISOString(),version:"1.0",source:"supabase",tables:a,organizationId:this.organizationId},data:{}};for(const d of a)try{console.log("\ud83d\udcca Respaldo tabla: ".concat(d));let e=this.supabase.from(d).select("*");"organizations"!==d&&this.organizationId&&(e=e.eq("organization_id",this.organizationId));const{data:t,error:r}=await e;r?(console.warn("\u26a0\ufe0f Error consultando tabla ".concat(d,":"),r),s.data[d]=[]):(s.data[d]=t||[],console.log("\u2705 Tabla ".concat(d,": ").concat((null===t||void 0===t?void 0:t.length)||0," registros")))}catch(e){console.error("\u274c Error procesando tabla ".concat(d,":"),e),s.data[d]=[]}const n="DatabaseSt_".concat(r,".json"),i=JSON.stringify(s,null,2),o=new Blob([i],{type:"application/json"}),l=window.URL.createObjectURL(o),c=document.createElement("a");return c.href=l,c.download=n,document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(l),console.log("\u2705 Backup completado: ".concat(n)),{success:!0,fileName:n,recordCount:Object.values(s.data).reduce((e,t)=>e+t.length,0),tables:a.length}}catch(t){return console.error("\u274c Error creando backup:",t),{success:!1,error:t.message}}}async createSilentBackup(){try{console.log("\ud83d\udd04 Creando backup silencioso...");const t=await this._generateBackupData();if(!t.success)return t;const r="strategiapm_backup_".concat((new Date).toISOString().split("T")[0]),s=(0,a.A)((0,a.A)({},t.data),{},{_backupInfo:{timestamp:(new Date).toISOString(),recordCount:t.recordCount,tables:t.tables.length,version:"1.0"}});try{return localStorage.setItem(r,JSON.stringify(s)),console.log("\u2705 Backup silencioso guardado: ".concat(t.recordCount," registros")),{success:!0,recordCount:t.recordCount,tables:t.tables.length,stored:!0}}catch(e){return console.warn("\u26a0\ufe0f Error guardando en localStorage:",e),{success:!0,recordCount:t.recordCount,tables:t.tables.length,stored:!1,warning:"Backup creado pero no guardado localmente"}}}catch(t){return console.error("\u274c Error creando backup silencioso:",t),{success:!1,error:t.message}}}async _generateBackupData(){try{const t=["organizations","users","projects","risks","tasks","purchase_orders","advances","invoices","contracts","resources","resource_assignments"],r={metadata:{timestamp:(new Date).toISOString(),version:"1.0",source:"supabase",tables:t.length},data:{}};let a=0;for(const s of t)try{let e=this.supabase.from(s).select("*");"organizations"!==s&&this.organizationId&&(e=e.eq("organization_id",this.organizationId));const{data:t,error:n}=await e;n?(console.warn("\u26a0\ufe0f Error obteniendo datos de ".concat(s,":"),n),r.data[s]=[]):(r.data[s]=t||[],a+=(t||[]).length,console.log("\u2705 ".concat(s,": ").concat((t||[]).length," registros")))}catch(e){console.warn("\u26a0\ufe0f Error procesando tabla ".concat(s,":"),e),r.data[s]=[]}return{success:!0,data:r,recordCount:a,tables:t}}catch(t){return console.error("\u274c Error generando datos de backup:",t),{success:!1,error:t.message}}}async getBackupStats(){try{const t=["organizations","users","projects","risks","tasks","purchase_orders","advances","invoices","contracts","resources","resource_assignments"],r={};let a=0;for(const s of t)try{let e=this.supabase.from(s).select("*",{count:"exact",head:!0});"organizations"!==s&&this.organizationId&&(e=e.eq("organization_id",this.organizationId));const{count:t,error:n}=await e;n?(console.warn("\u26a0\ufe0f Error contando tabla ".concat(s,":"),n),r[s]=0):(r[s]=t||0,a+=t||0)}catch(e){console.error("\u274c Error contando tabla ".concat(s,":"),e),r[s]=0}return{success:!0,stats:r,totalRecords:a,tablesCount:t.length}}catch(t){return console.error("\u274c Error obteniendo estad\xedsticas:",t),{success:!1,error:t.message}}}async loadMinutasByProject(e){try{if(!this.currentUser||!this.organizationId)return console.warn("\u26a0\ufe0f No se pueden cargar minutas: usuario no autenticado"),{success:!1,error:"No autenticado",minutas:[]};console.log("\ud83d\udccb Cargando minutas para proyecto: ".concat(e));const{data:t,error:r}=await this.supabase.from("minute_tasks").select("*").eq("project_id",e).eq("organization_id",this.organizationId).order("created_at",{ascending:!1});if(r)return console.error("\u274c Error cargando minutas:",r),{success:!1,error:r,minutas:[]};const a=(t||[]).map(e=>({id:e.id,tarea:e.task_description,responsable:e.responsible_person,fecha:e.due_date,hitoId:e.milestone_id,estatus:e.status,fechaCreacion:e.created_at}));return console.log("\u2705 Minutas cargadas: ".concat(a.length)),{success:!0,minutas:a}}catch(t){return console.error("\u274c Error inesperado cargando minutas:",t),{success:!1,error:t,minutas:[]}}}async saveMinutas(e,t){try{if(!this.currentUser||!this.organizationId)return console.warn("\u26a0\ufe0f No se pueden guardar minutas: usuario no autenticado"),{success:!1,error:"No autenticado"};console.log("\ud83d\udcbe Guardando ".concat(t.length," minutas para proyecto: ").concat(e));const r=t.map(t=>({id:t.id,project_id:e,organization_id:this.organizationId,user_id:this.currentUser.id,task_description:t.tarea,responsible_person:t.responsable,due_date:t.fecha,milestone_id:t.hitoId,status:t.estatus||"Pendiente",created_at:t.fechaCreacion||(new Date).toISOString(),updated_at:(new Date).toISOString()})),{data:a,error:s}=await this.supabase.from("minute_tasks").insert(r).select("*");return s?(console.error("\u274c Error guardando minutas:",s),{success:!1,error:s}):(console.log("\u2705 Minutas guardadas: ".concat((null===a||void 0===a?void 0:a.length)||0)),{success:!0,data:a})}catch(r){return console.error("\u274c Error inesperado guardando minutas:",r),{success:!1,error:r}}}async updateMinutaStatus(e,t){try{if(!this.currentUser)return console.warn("\u26a0\ufe0f No se puede actualizar minuta: usuario no autenticado"),{success:!1,error:"No autenticado"};console.log("\ud83d\udd04 Actualizando estatus de minuta ".concat(e," a: ").concat(t));const{data:r,error:a}=await this.supabase.from("minute_tasks").update({status:t,updated_at:(new Date).toISOString()}).eq("id",e).eq("user_id",this.currentUser.id).select("*");return a?(console.error("\u274c Error actualizando minuta:",a),{success:!1,error:a}):(console.log("\u2705 Minuta actualizada"),{success:!0,data:r})}catch(r){return console.error("\u274c Error inesperado actualizando minuta:",r),{success:!1,error:r}}}async updateMinuta(e,t){try{if(!this.currentUser)return console.warn("\u26a0\ufe0f No se puede actualizar minuta: usuario no autenticado"),{success:!1,error:"No autenticado"};console.log("\ud83d\udd04 Actualizando minuta ".concat(e,":"),t);const{data:r,error:s}=await this.supabase.from("minute_tasks").update((0,a.A)((0,a.A)({},t),{},{updated_at:(new Date).toISOString()})).eq("id",e).eq("user_id",this.currentUser.id).select("*");return s?(console.error("\u274c Error actualizando minuta:",s),{success:!1,error:s}):(console.log("\u2705 Minuta actualizada completamente"),{success:!0,data:r})}catch(r){return console.error("\u274c Error inesperado actualizando minuta:",r),{success:!1,error:r}}}async deleteMinuta(e){try{if(!this.currentUser)return console.warn("\u26a0\ufe0f No se puede eliminar minuta: usuario no autenticado"),{success:!1,error:"No autenticado"};console.log("\ud83d\uddd1\ufe0f Eliminando minuta: ".concat(e));const{error:t}=await this.supabase.from("minute_tasks").delete().eq("id",e).eq("user_id",this.currentUser.id);return t?(console.error("\u274c Error eliminando minuta:",t),{success:!1,error:t}):(console.log("\u2705 Minuta eliminada"),{success:!0})}catch(t){return console.error("\u274c Error inesperado eliminando minuta:",t),{success:!1,error:t}}}async saveAuditEvents(e,t){try{if(!this.currentUser||!this.organizationId)return console.warn("\u26a0\ufe0f No se pueden guardar eventos de auditor\xeda: usuario no autenticado"),{success:!1,error:"No autenticado"};if(!t||0===t.length)return{success:!0,data:[]};console.log("\ud83d\udccb Guardando ".concat(t.length," eventos de auditor\xeda para proyecto: ").concat(e));const r=t.map(t=>({id:t.id||crypto.randomUUID(),project_id:e,organization_id:this.organizationId,user_id:this.currentUser.id,timestamp:t.timestamp||(new Date).toISOString(),event_category:t.category||"general",event_action:t.action||"unknown",event_description:t.description||"",event_details:JSON.stringify(t.details||{}),event_severity:t.severity||"medium",event_user:t.user||this.currentUser.email,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()})),{data:a,error:s}=await this.supabase.from("project_audit_events").upsert(r,{onConflict:"id"}).select("*");return s?(console.error("\u274c Error guardando eventos de auditor\xeda:",s),{success:!1,error:s}):(console.log("\u2705 Eventos de auditor\xeda guardados: ".concat((null===a||void 0===a?void 0:a.length)||0)),{success:!0,data:a})}catch(r){return console.error("\u274c Error inesperado guardando eventos de auditor\xeda:",r),{success:!1,error:r}}}async loadAuditEvents(e){try{if(!this.currentUser)return console.warn("\u26a0\ufe0f No se pueden cargar eventos de auditor\xeda: usuario no autenticado"),{success:!1,error:"No autenticado",events:[]};console.log("\ud83d\udccb Cargando eventos de auditor\xeda para proyecto: ".concat(e));const{data:t,error:r}=await this.supabase.from("project_audit_events").select("*").eq("project_id",e).eq("organization_id",this.organizationId).order("timestamp",{ascending:!1});if(r)return console.error("\u274c Error cargando eventos de auditor\xeda:",r),{success:!1,error:r,events:[]};const a=(t||[]).map(e=>({id:e.id,timestamp:e.timestamp,projectId:e.project_id,category:e.event_category,action:e.event_action,description:e.event_description,details:JSON.parse(e.event_details||"{}"),severity:e.event_severity,user:e.event_user}));return console.log("\u2705 Eventos de auditor\xeda cargados: ".concat(a.length)),{success:!0,events:a}}catch(t){return console.error("\u274c Error inesperado cargando eventos de auditor\xeda:",t),{success:!1,error:t,events:[]}}}validateBackupFile(e){try{if(!e||"object"!==typeof e)return{valid:!1,error:"Archivo no v\xe1lido: estructura incorrecta"};if(!e.metadata)return{valid:!1,error:"Archivo no v\xe1lido: falta metadata"};const{metadata:t}=e;if(!t.timestamp||!t.version||!t.source)return{valid:!1,error:"Archivo no v\xe1lido: metadata incompleta"};if("supabase"!==t.source)return{valid:!1,error:"Archivo no v\xe1lido: no es un backup de Supabase"};if(!e.data||"object"!==typeof e.data)return{valid:!1,error:"Archivo no v\xe1lido: no contiene datos"};const r=["organizations","users","projects","risks","tasks","purchase_orders","advances","invoices","contracts","resources","resource_assignments"],a=Object.keys(e.data),s=r.filter(e=>!a.includes(e));s.length>0&&console.warn("\u26a0\ufe0f Tablas faltantes en backup: ".concat(s.join(", ")));const n={};let i=0;return a.forEach(t=>{const r=Array.isArray(e.data[t])?e.data[t].length:0;n[t]=r,i+=r}),{valid:!0,stats:n,totalRecords:i,tablesCount:a.length,timestamp:t.timestamp,version:t.version}}catch(t){return{valid:!1,error:"Error validando archivo: ".concat(t.message)}}}async restoreFromBackup(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{console.log("\ud83d\udd04 Iniciando restauraci\xf3n de backup...");const a=this.validateBackupFile(e);if(!a.valid)return{success:!1,error:a.error};console.log("\u2705 Archivo v\xe1lido: ".concat(a.totalRecords," registros en ").concat(a.tablesCount," tablas"));const s={success:!0,processed:0,errors:[],details:{}},n=["organizations","users","projects","resources","risks","tasks","resource_assignments","purchase_orders","advances","invoices","contracts"];for(const i of n){if(!e.data[i]){console.log("\u23ed\ufe0f Saltando tabla ".concat(i,": no presente en backup"));continue}const a=e.data[i];if(Array.isArray(a)&&0!==a.length){console.log("\ud83d\udcca Restaurando tabla ".concat(i,": ").concat(a.length," registros"));try{if(t.clearExisting){console.log("\ud83d\uddd1\ufe0f Limpiando tabla ".concat(i,"..."));const{error:e}=await this.supabase.from(i).delete().neq("id","00000000-0000-0000-0000-000000000000");e&&console.warn("\u26a0\ufe0f Error limpiando tabla ".concat(i,":"),e)}const e=100;let r=0,n=0;for(let t=0;t<a.length;t+=e){const o=a.slice(t,t+e),{data:l,error:c}=await this.supabase.from(i).insert(o);c?(console.error("\u274c Error insertando lote en ".concat(i,":"),c),n+=o.length,s.errors.push({table:i,batch:Math.floor(t/e)+1,error:c.message,records:o.length})):(r+=o.length,s.processed+=o.length),t+e<a.length&&await new Promise(e=>setTimeout(e,100))}s.details[i]={processed:r,errors:n},console.log("\u2705 Tabla ".concat(i,": ").concat(r," procesados, ").concat(n," errores"))}catch(r){console.error("\u274c Error procesando tabla ".concat(i,":"),r),s.errors.push({table:i,error:r.message}),s.details[i]={processed:0,errors:a.length}}}else console.log("\u23ed\ufe0f Saltando tabla ".concat(i,": sin datos")),s.details[i]={processed:0,errors:0}}return console.log("\u2705 Restauraci\xf3n completada: ".concat(s.processed," registros procesados")),s}catch(a){return console.error("\u274c Error en restauraci\xf3n:",a),{success:!1,error:a.message}}}getBackupPreview(e){try{const t=this.validateBackupFile(e);if(!t.valid)return{success:!1,error:t.error};const r={};return Object.keys(e.data).forEach(t=>{const a=e.data[t];Array.isArray(a)&&a.length>0&&(r[t]={count:a.length,sample:a.slice(0,3),fields:Object.keys(a[0]||{})})}),{success:!0,preview:r,totalRecords:t.totalRecords,timestamp:t.timestamp,version:t.version}}catch(t){return{success:!1,error:t.message}}}},er=Zt},916:(e,t)=>{var r=Symbol.for("react.transitional.element"),a=Symbol.for("react.fragment");function s(e,t,a){var s=null;if(void 0!==a&&(s=""+a),void 0!==t.key&&(s=""+t.key),"key"in t)for(var n in a={},t)"key"!==n&&(a[n]=t[n]);else a=t;return t=a.ref,{$$typeof:r,type:e,key:s,ref:void 0!==t?t:null,props:a}}t.Fragment=a,t.jsx=s,t.jsxs=s},950:(e,t,r)=>{e.exports=r(983)},983:(e,t)=>{var r=Symbol.for("react.transitional.element"),a=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},p=Object.assign,g={};function x(e,t,r){this.props=e,this.context=t,this.refs=g,this.updater=r||m}function b(){}function v(e,t,r){this.props=e,this.context=t,this.refs=g,this.updater=r||m}x.prototype.isReactComponent={},x.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},x.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},b.prototype=x.prototype;var y=v.prototype=new b;y.constructor=v,p(y,x.prototype),y.isPureReactComponent=!0;var w=Array.isArray,j={H:null,A:null,T:null,S:null,V:null},N=Object.prototype.hasOwnProperty;function k(e,t,a,s,n,i){return a=i.ref,{$$typeof:r,type:e,key:t,ref:void 0!==a?a:null,props:i}}function S(e){return"object"===typeof e&&null!==e&&e.$$typeof===r}var E=/\/+/g;function T(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function _(){}function C(e,t,s,n,i){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l,c,d=!1;if(null===e)d=!0;else switch(o){case"bigint":case"string":case"number":d=!0;break;case"object":switch(e.$$typeof){case r:case a:d=!0;break;case h:return C((d=e._init)(e._payload),t,s,n,i)}}if(d)return i=i(e),d=""===n?"."+T(e,0):n,w(i)?(s="",null!=d&&(s=d.replace(E,"$&/")+"/"),C(i,t,s,"",function(e){return e})):null!=i&&(S(i)&&(l=i,c=s+(null==i.key||e&&e.key===i.key?"":(""+i.key).replace(E,"$&/")+"/")+d,i=k(l.type,c,void 0,0,0,l.props)),t.push(i)),1;d=0;var u,m=""===n?".":n+":";if(w(e))for(var p=0;p<e.length;p++)d+=C(n=e[p],t,s,o=m+T(n,p),i);else if("function"===typeof(p=null===(u=e)||"object"!==typeof u?null:"function"===typeof(u=f&&u[f]||u["@@iterator"])?u:null))for(e=p.call(e),p=0;!(n=e.next()).done;)d+=C(n=n.value,t,s,o=m+T(n,p++),i);else if("object"===o){if("function"===typeof e.then)return C(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(_,_):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,s,n,i);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return d}function A(e,t,r){if(null==e)return e;var a=[],s=0;return C(e,a,"","",function(e){return t.call(r,e,s++)}),a}function D(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var P="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function I(){}t.Children={map:A,forEach:function(e,t,r){A(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return A(e,function(){t++}),t},toArray:function(e){return A(e,function(e){return e})||[]},only:function(e){if(!S(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=x,t.Fragment=s,t.Profiler=i,t.PureComponent=v,t.StrictMode=n,t.Suspense=d,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=j,t.__COMPILER_RUNTIME={__proto__:null,c:function(e){return j.H.useMemoCache(e)}},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var a=p({},e.props),s=e.key;if(null!=t)for(n in void 0!==t.ref&&void 0,void 0!==t.key&&(s=""+t.key),t)!N.call(t,n)||"key"===n||"__self"===n||"__source"===n||"ref"===n&&void 0===t.ref||(a[n]=t[n]);var n=arguments.length-2;if(1===n)a.children=r;else if(1<n){for(var i=Array(n),o=0;o<n;o++)i[o]=arguments[o+2];a.children=i}return k(e.type,s,void 0,0,0,a)},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:o,_context:e},e},t.createElement=function(e,t,r){var a,s={},n=null;if(null!=t)for(a in void 0!==t.key&&(n=""+t.key),t)N.call(t,a)&&"key"!==a&&"__self"!==a&&"__source"!==a&&(s[a]=t[a]);var i=arguments.length-2;if(1===i)s.children=r;else if(1<i){for(var o=Array(i),l=0;l<i;l++)o[l]=arguments[l+2];s.children=o}if(e&&e.defaultProps)for(a in i=e.defaultProps)void 0===s[a]&&(s[a]=i[a]);return k(e,n,void 0,0,0,s)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=S,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:D}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=j.T,r={};j.T=r;try{var a=e(),s=j.S;null!==s&&s(r,a),"object"===typeof a&&null!==a&&"function"===typeof a.then&&a.then(I,P)}catch(n){P(n)}finally{j.T=t}},t.unstable_useCacheRefresh=function(){return j.H.useCacheRefresh()},t.use=function(e){return j.H.use(e)},t.useActionState=function(e,t,r){return j.H.useActionState(e,t,r)},t.useCallback=function(e,t){return j.H.useCallback(e,t)},t.useContext=function(e){return j.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return j.H.useDeferredValue(e,t)},t.useEffect=function(e,t,r){var a=j.H;if("function"===typeof r)throw Error("useEffect CRUD overload is not enabled in this build of React.");return a.useEffect(e,t)},t.useId=function(){return j.H.useId()},t.useImperativeHandle=function(e,t,r){return j.H.useImperativeHandle(e,t,r)},t.useInsertionEffect=function(e,t){return j.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return j.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return j.H.useMemo(e,t)},t.useOptimistic=function(e,t){return j.H.useOptimistic(e,t)},t.useReducer=function(e,t,r){return j.H.useReducer(e,t,r)},t.useRef=function(e){return j.H.useRef(e)},t.useState=function(e){return j.H.useState(e)},t.useSyncExternalStore=function(e,t,r){return j.H.useSyncExternalStore(e,t,r)},t.useTransition=function(){return j.H.useTransition()},t.version="19.1.1"}},t={};function r(a){var s=t[a];if(void 0!==s)return s.exports;var n=t[a]={exports:{}};return e[a].call(n.exports,n,n.exports,r),n.exports}r.m=e,r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.f={},r.e=e=>Promise.all(Object.keys(r.f).reduce((t,a)=>(r.f[a](e,t),t),[])),r.u=e=>"static/js/"+e+".b33f6dbc.chunk.js",r.miniCssF=e=>{},r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="mi-dashboard:";r.l=(a,s,n,i)=>{if(e[a])e[a].push(s);else{var o,l;if(void 0!==n)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==a||u.getAttribute("data-webpack")==t+n){o=u;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,r.nc&&o.setAttribute("nonce",r.nc),o.setAttribute("data-webpack",t+n),o.src=a),e[a]=[s];var h=(t,r)=>{o.onerror=o.onload=null,clearTimeout(f);var s=e[a];if(delete e[a],o.parentNode&&o.parentNode.removeChild(o),s&&s.forEach(e=>e(r)),t)return t(r)},f=setTimeout(h.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=h.bind(null,o.onerror),o.onload=h.bind(null,o.onload),l&&document.head.appendChild(o)}}})(),r.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.p="/",(()=>{var e={792:0};r.f.j=(t,a)=>{var s=r.o(e,t)?e[t]:void 0;if(0!==s)if(s)a.push(s[2]);else{var n=new Promise((r,a)=>s=e[t]=[r,a]);a.push(s[2]=n);var i=r.p+r.u(t),o=new Error;r.l(i,a=>{if(r.o(e,t)&&(0!==(s=e[t])&&(e[t]=void 0),s)){var n=a&&("load"===a.type?"missing":a.type),i=a&&a.target&&a.target.src;o.message="Loading chunk "+t+" failed.\n("+n+": "+i+")",o.name="ChunkLoadError",o.type=n,o.request=i,s[1](o)}},"chunk-"+t,t)}};var t=(t,a)=>{var s,n,i=a[0],o=a[1],l=a[2],c=0;if(i.some(t=>0!==e[t])){for(s in o)r.o(o,s)&&(r.m[s]=o[s]);if(l)l(r)}for(t&&t(a);c<i.length;c++)n=i[c],r.o(e,n)&&e[n]&&e[n][0](),e[n]=0},a=self.webpackChunkmi_dashboard=self.webpackChunkmi_dashboard||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var a=r(950),s=r(352),n=r(379);function i(e,t){if(null==e)return{};var r,a,s=function(e,t){if(null==e)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;r[a]=e[a]}return r}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(a=0;a<n.length;a++)r=n[a],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}const o=["sri"],l=["page"],c=["page","matches"],d=["onClick","discover","prefetch","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],u=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],h=["discover","fetcherKey","navigate","reloadDocument","replace","state","method","action","onSubmit","relative","preventScrollReset","viewTransition"];var f="popstate";function m(){return w(function(e,t){let{pathname:r,search:a,hash:s}=e.location;return b("",{pathname:r,search:a,hash:s},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"===typeof t?t:v(t)},null,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function p(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function g(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(r){}}}function x(e,t){return{usr:e.state,key:e.key,idx:t}}function b(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3?arguments[3]:void 0;return(0,n.A)((0,n.A)({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?y(t):t),{},{state:r,key:t&&t.key||a||Math.random().toString(36).substring(2,10)})}function v(e){let{pathname:t="/",search:r="",hash:a=""}=e;return r&&"?"!==r&&(t+="?"===r.charAt(0)?r:"?"+r),a&&"#"!==a&&(t+="#"===a.charAt(0)?a:"#"+a),t}function y(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let a=e.indexOf("?");a>=0&&(t.search=e.substring(a),e=e.substring(0,a)),e&&(t.pathname=e)}return t}function w(e,t,r){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{window:s=document.defaultView,v5Compat:i=!1}=a,o=s.history,l="POP",c=null,d=u();function u(){return(o.state||{idx:null}).idx}function h(){l="POP";let e=u(),t=null==e?null:e-d;d=e,c&&c({action:l,location:p.location,delta:t})}function m(e){return j(e)}null==d&&(d=0,o.replaceState((0,n.A)((0,n.A)({},o.state),{},{idx:d}),""));let p={get action(){return l},get location(){return e(s,o)},listen(e){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(f,h),c=e,()=>{s.removeEventListener(f,h),c=null}},createHref:e=>t(s,e),createURL:m,encodeLocation(e){let t=m(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){l="PUSH";let a=b(p.location,e,t);r&&r(a,e),d=u()+1;let n=x(a,d),h=p.createHref(a);try{o.pushState(n,"",h)}catch(f){if(f instanceof DOMException&&"DataCloneError"===f.name)throw f;s.location.assign(h)}i&&c&&c({action:l,location:p.location,delta:1})},replace:function(e,t){l="REPLACE";let a=b(p.location,e,t);r&&r(a,e),d=u();let s=x(a,d),n=p.createHref(a);o.replaceState(s,"",n),i&&c&&c({action:l,location:p.location,delta:0})},go:e=>o.go(e)};return p}function j(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r="http://localhost";"undefined"!==typeof window&&(r="null"!==window.location.origin?window.location.origin:window.location.href),p(r,"No window.location.(origin|href) available to create URL");let a="string"===typeof e?e:v(e);return a=a.replace(/ $/,"%20"),!t&&a.startsWith("//")&&(a=r+a),new URL(a,r)}new WeakMap;function N(e,t){return k(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",!1)}function k(e,t,r,a){let s=z(("string"===typeof t?y(t):t).pathname||"/",r);if(null==s)return null;let n=S(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let r=e.length===t.length&&e.slice(0,-1).every((e,r)=>e===t[r]);return r?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(n);let i=null;for(let o=0;null==i&&o<n.length;++o){let e=L(s);i=R(n[o],e,a)}return i}function S(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],n=function(e,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s,o=arguments.length>3?arguments[3]:void 0,l={relativePath:void 0===o?e.path||"":o,caseSensitive:!0===e.caseSensitive,childrenIndex:n,route:e};if(l.relativePath.startsWith("/")){if(!l.relativePath.startsWith(a)&&i)return;p(l.relativePath.startsWith(a),'Absolute route path "'.concat(l.relativePath,'" nested under path "').concat(a,'" is not valid. An absolute child route path must start with the combined path of all its parent routes.')),l.relativePath=l.relativePath.slice(a.length)}let c=V([a,l.relativePath]),d=r.concat(l);e.children&&e.children.length>0&&(p(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'.concat(c,'".')),S(e.children,t,d,c,i)),(null!=e.path||e.index)&&t.push({path:c,score:O(c,e.index),routesMeta:d})};return e.forEach((e,t)=>{var r;if(""!==e.path&&null!==(r=e.path)&&void 0!==r&&r.includes("?"))for(let a of E(e.path))n(e,t,!0,a);else n(e,t)}),t}function E(e){let t=e.split("/");if(0===t.length)return[];let[r,...a]=t,s=r.endsWith("?"),n=r.replace(/\?$/,"");if(0===a.length)return s?[n,""]:[n];let i=E(a.join("/")),o=[];return o.push(...i.map(e=>""===e?n:[n,e].join("/"))),s&&o.push(...i),o.map(t=>e.startsWith("/")&&""===t?"/":t)}var T=/^:[\w-]+$/,_=3,C=2,A=1,D=10,P=-2,I=e=>"*"===e;function O(e,t){let r=e.split("/"),a=r.length;return r.some(I)&&(a+=P),t&&(a+=C),r.filter(e=>!I(e)).reduce((e,t)=>e+(T.test(t)?_:""===t?A:D),a)}function R(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{routesMeta:a}=e,s={},n="/",i=[];for(let o=0;o<a.length;++o){let e=a[o],l=o===a.length-1,c="/"===n?t:t.slice(n.length)||"/",d=M({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),u=e.route;if(!d&&l&&r&&!a[a.length-1].route.index&&(d=M({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!d)return null;Object.assign(s,d.params),i.push({params:s,pathname:V([n,d.pathname]),pathnameBase:G(V([n,d.pathnameBase])),route:u}),"/"!==d.pathnameBase&&(n=V([n,d.pathnameBase]))}return i}function M(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[r,a]=F(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let n=s[0],i=n.replace(/(.)\/+$/,"$1"),o=s.slice(1),l=a.reduce((e,t,r)=>{let{paramName:a,isOptional:s}=t;if("*"===a){let e=o[r]||"";i=n.slice(0,n.length-e.length).replace(/(.)\/+$/,"$1")}const l=o[r];return e[a]=s&&!l?void 0:(l||"").replace(/%2F/g,"/"),e},{});return{params:l,pathname:n,pathnameBase:i,pattern:e}}function F(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];g("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'.concat(e,'" will be treated as if it were "').concat(e.replace(/\*$/,"/*"),'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "').concat(e.replace(/\*$/,"/*"),'".'));let a=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,r)=>(a.push({paramName:t,isOptional:null!=r}),r?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(a.push({paramName:"*"}),s+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":""!==e&&"/"!==e&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),a]}function L(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return g(!1,'The URL path "'.concat(e,'" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (').concat(t,").")),e}}function z(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,a=e.charAt(r);return a&&"/"!==a?null:e.slice(r)||"/"}function B(e,t,r,a){return"Cannot include a '".concat(e,"' character in a manually specified `to.").concat(t,"` field [").concat(JSON.stringify(a),"].  Please separate it out to the `to.").concat(r,'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.')}function U(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function W(e){let t=U(e);return t.map((e,r)=>r===t.length-1?e.pathname:e.pathnameBase)}function H(e,t,r){let a,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];"string"===typeof e?a=y(e):(a=(0,n.A)({},e),p(!a.pathname||!a.pathname.includes("?"),B("?","pathname","search",a)),p(!a.pathname||!a.pathname.includes("#"),B("#","pathname","hash",a)),p(!a.search||!a.search.includes("#"),B("#","search","hash",a)));let i,o=""===e||""===a.pathname,l=o?"/":a.pathname;if(null==l)i=r;else{let e=t.length-1;if(!s&&l.startsWith("..")){let t=l.split("/");for(;".."===t[0];)t.shift(),e-=1;a.pathname=t.join("/")}i=e>=0?t[e]:"/"}let c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",{pathname:r,search:a="",hash:s=""}="string"===typeof e?y(e):e,n=r?r.startsWith("/")?r:function(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?r.length>1&&r.pop():"."!==e&&r.push(e)}),r.length>1?r.join("/"):"/"}(r,t):t;return{pathname:n,search:q(a),hash:K(s)}}(a,i),d=l&&"/"!==l&&l.endsWith("/"),u=(o||"."===l)&&r.endsWith("/");return c.pathname.endsWith("/")||!d&&!u||(c.pathname+="/"),c}var V=e=>e.join("/").replace(/\/\/+/g,"/"),G=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),q=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",K=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";function Y(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}var J=["POST","PUT","PATCH","DELETE"],X=(new Set(J),["GET",...J]);new Set(X),Symbol("ResetLoaderData");var Q=a.createContext(null);Q.displayName="DataRouter";var Z=a.createContext(null);Z.displayName="DataRouterState";var ee=a.createContext(!1);var te=a.createContext({isTransitioning:!1});te.displayName="ViewTransition";var re=a.createContext(new Map);re.displayName="Fetchers";var ae=a.createContext(null);ae.displayName="Await";var se=a.createContext(null);se.displayName="Navigation";var ne=a.createContext(null);ne.displayName="Location";var ie=a.createContext({outlet:null,matches:[],isDataRoute:!1});ie.displayName="Route";var oe=a.createContext(null);oe.displayName="RouteError";function le(){return null!=a.useContext(ne)}function ce(){return p(le(),"useLocation() may be used only in the context of a <Router> component."),a.useContext(ne).location}var de="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function ue(e){a.useContext(se).static||a.useLayoutEffect(e)}function he(){let{isDataRoute:e}=a.useContext(ie);return e?function(){let{router:e}=we("useNavigate"),t=Ne("useNavigate"),r=a.useRef(!1);ue(()=>{r.current=!0});let s=a.useCallback(async function(a){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};g(r.current,de),r.current&&("number"===typeof a?e.navigate(a):await e.navigate(a,(0,n.A)({fromRouteId:t},s)))},[e,t]);return s}():function(){p(le(),"useNavigate() may be used only in the context of a <Router> component.");let e=a.useContext(Q),{basename:t,navigator:r}=a.useContext(se),{matches:s}=a.useContext(ie),{pathname:n}=ce(),i=JSON.stringify(W(s)),o=a.useRef(!1);ue(()=>{o.current=!0});let l=a.useCallback(function(a){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(g(o.current,de),!o.current)return;if("number"===typeof a)return void r.go(a);let l=H(a,JSON.parse(i),n,"path"===s.relative);null==e&&"/"!==t&&(l.pathname="/"===l.pathname?t:V([t,l.pathname])),(s.replace?r.replace:r.push)(l,s.state,s)},[t,r,i,n,e]);return l}()}a.createContext(null);function fe(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{matches:r}=a.useContext(ie),{pathname:s}=ce(),n=JSON.stringify(W(r));return a.useMemo(()=>H(e,JSON.parse(n),s,"path"===t),[e,n,s,t])}function me(e,t,r,s,i){p(le(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:o}=a.useContext(se),{matches:l}=a.useContext(ie),c=l[l.length-1],d=c?c.params:{},u=c?c.pathname:"/",h=c?c.pathnameBase:"/",f=c&&c.route;{let e=f&&f.path||"";Ee(u,!f||e.endsWith("*")||e.endsWith("*?"),'You rendered descendant <Routes> (or called `useRoutes()`) at "'.concat(u,'" (under <Route path="').concat(e,'">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won\'t match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="').concat(e,'"> to <Route path="').concat("/"===e?"*":"".concat(e,"/*"),'">.'))}let m,x=ce();if(t){var b;let e="string"===typeof t?y(t):t;p("/"===h||(null===(b=e.pathname)||void 0===b?void 0:b.startsWith(h)),'When overriding the location using `<Routes location>` or `useRoutes(routes, location)`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "'.concat(h,'" but pathname "').concat(e.pathname,'" was given in the `location` prop.')),m=e}else m=x;let v=m.pathname||"/",w=v;if("/"!==h){let e=h.replace(/^\//,"").split("/");w="/"+v.replace(/^\//,"").split("/").slice(e.length).join("/")}let j=N(e,{pathname:w});g(f||null!=j,'No routes matched location "'.concat(m.pathname).concat(m.search).concat(m.hash,'" ')),g(null==j||void 0!==j[j.length-1].route.element||void 0!==j[j.length-1].route.Component||void 0!==j[j.length-1].route.lazy,'Matched leaf route at location "'.concat(m.pathname).concat(m.search).concat(m.hash,'" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.'));let k=ve(j&&j.map(e=>Object.assign({},e,{params:Object.assign({},d,e.params),pathname:V([h,o.encodeLocation?o.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?h:V([h,o.encodeLocation?o.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),l,r,s,i);return t&&k?a.createElement(ne.Provider,{value:{location:(0,n.A)({pathname:"/",search:"",hash:"",state:null,key:"default"},m),navigationType:"POP"}},k):k}function pe(){let e=ke(),t=Y(e)?"".concat(e.status," ").concat(e.statusText):e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s="rgba(200,200,200, 0.5)",n={padding:"0.5rem",backgroundColor:s},i={padding:"2px 4px",backgroundColor:s},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=a.createElement(a.Fragment,null,a.createElement("p",null,"\ud83d\udcbf Hey developer \ud83d\udc4b"),a.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",a.createElement("code",{style:i},"ErrorBoundary")," or"," ",a.createElement("code",{style:i},"errorElement")," prop on your route.")),a.createElement(a.Fragment,null,a.createElement("h2",null,"Unexpected Application Error!"),a.createElement("h3",{style:{fontStyle:"italic"}},t),r?a.createElement("pre",{style:n},r):null,o)}var ge=a.createElement(pe,null),xe=class extends a.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.unstable_onError?this.props.unstable_onError(e,t):console.error("React Router caught the following error during render",e)}render(){return void 0!==this.state.error?a.createElement(ie.Provider,{value:this.props.routeContext},a.createElement(oe.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function be(e){let{routeContext:t,match:r,children:s}=e,n=a.useContext(Q);return n&&n.static&&n.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=r.route.id),a.createElement(ie.Provider,{value:t},s)}function ve(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(null==e){if(!r)return null;if(r.errors)e=r.matches;else{if(0!==t.length||r.initialized||!(r.matches.length>0))return null;e=r.matches}}let n=e,i=null===r||void 0===r?void 0:r.errors;if(null!=i){let e=n.findIndex(e=>e.route.id&&void 0!==(null===i||void 0===i?void 0:i[e.route.id]));p(e>=0,"Could not find a matching route for errors on route IDs: ".concat(Object.keys(i).join(","))),n=n.slice(0,Math.min(n.length,e+1))}let o=!1,l=-1;if(r)for(let a=0;a<n.length;a++){let e=n[a];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(l=a),e.route.id){let{loaderData:t,errors:a}=r,s=e.route.loader&&!t.hasOwnProperty(e.route.id)&&(!a||void 0===a[e.route.id]);if(e.route.lazy||s){o=!0,n=l>=0?n.slice(0,l+1):[n[0]];break}}}return n.reduceRight((e,c,d)=>{let u,h=!1,f=null,m=null;r&&(u=i&&c.route.id?i[c.route.id]:void 0,f=c.route.errorElement||ge,o&&(l<0&&0===d?(Ee("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),h=!0,m=null):l===d&&(h=!0,m=c.route.hydrateFallbackElement||null)));let p=t.concat(n.slice(0,d+1)),g=()=>{let t;return t=u?f:h?m:c.route.Component?a.createElement(c.route.Component,null):c.route.element?c.route.element:e,a.createElement(be,{match:c,routeContext:{outlet:e,matches:p,isDataRoute:null!=r},children:t})};return r&&(c.route.ErrorBoundary||c.route.errorElement||0===d)?a.createElement(xe,{location:r.location,revalidation:r.revalidation,component:f,error:u,children:g(),routeContext:{outlet:null,matches:p,isDataRoute:!0},unstable_onError:s}):g()},null)}function ye(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function we(e){let t=a.useContext(Q);return p(t,ye(e)),t}function je(e){let t=a.useContext(Z);return p(t,ye(e)),t}function Ne(e){let t=function(e){let t=a.useContext(ie);return p(t,ye(e)),t}(e),r=t.matches[t.matches.length-1];return p(r.route.id,"".concat(e,' can only be used on routes that contain a unique "id"')),r.route.id}function ke(){var e;let t=a.useContext(oe),r=je("useRouteError"),s=Ne("useRouteError");return void 0!==t?t:null===(e=r.errors)||void 0===e?void 0:e[s]}var Se={};function Ee(e,t,r){t||Se[e]||(Se[e]=!0,g(!1,r))}var Te={};function _e(e,t){e||Te[t]||(Te[t]=!0,console.warn(t))}a.memo(function(e){let{routes:t,future:r,state:a,unstable_onError:s}=e;return me(t,void 0,a,s,r)});function Ce(e){let{basename:t="/",children:r=null,location:s,navigationType:n="POP",navigator:i,static:o=!1}=e;p(!le(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=t.replace(/^\/*/,"/"),c=a.useMemo(()=>({basename:l,navigator:i,static:o,future:{}}),[l,i,o]);"string"===typeof s&&(s=y(s));let{pathname:d="/",search:u="",hash:h="",state:f=null,key:m="default"}=s,x=a.useMemo(()=>{let e=z(d,l);return null==e?null:{location:{pathname:e,search:u,hash:h,state:f,key:m},navigationType:n}},[l,d,u,h,f,m,n]);return g(null!=x,'<Router basename="'.concat(l,'"> is not able to match the URL "').concat(d).concat(u).concat(h,"\" because it does not start with the basename, so the <Router> won't render anything.")),null==x?null:a.createElement(se.Provider,{value:c},a.createElement(ne.Provider,{children:r,value:x}))}a.Component;var Ae="get",De="application/x-www-form-urlencoded";function Pe(e){return null!=e&&"string"===typeof e.tagName}var Ie=null;var Oe=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Re(e){return null==e||Oe.has(e)?e:(g(!1,'"'.concat(e,'" is not a valid `encType` for `<Form>`/`<fetcher.Form>` and will default to "').concat(De,'"')),null)}function Me(e,t){let r,a,s,n,i;if(Pe(o=e)&&"form"===o.tagName.toLowerCase()){let i=e.getAttribute("action");a=i?z(i,t):null,r=e.getAttribute("method")||Ae,s=Re(e.getAttribute("enctype"))||De,n=new FormData(e)}else if(function(e){return Pe(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return Pe(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let i=e.form;if(null==i)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let o=e.getAttribute("formaction")||i.getAttribute("action");if(a=o?z(o,t):null,r=e.getAttribute("formmethod")||i.getAttribute("method")||Ae,s=Re(e.getAttribute("formenctype"))||Re(i.getAttribute("enctype"))||De,n=new FormData(i,e),!function(){if(null===Ie)try{new FormData(document.createElement("form"),0),Ie=!1}catch(e){Ie=!0}return Ie}()){let{name:t,type:r,value:a}=e;if("image"===r){let e=t?"".concat(t,"."):"";n.append("".concat(e,"x"),"0"),n.append("".concat(e,"y"),"0")}else t&&n.append(t,a)}}else{if(Pe(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=Ae,a=null,s=De,i=e}var o;return n&&"text/plain"===s&&(i=n,n=void 0),{action:a,method:r.toLowerCase(),encType:s,formData:n,body:i}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");"undefined"!==typeof window?window:"undefined"!==typeof globalThis&&globalThis;function Fe(e){return{__html:e}}function Le(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}Symbol("SingleFetchRedirect");function ze(e,t,r){let a="string"===typeof e?new URL(e,"undefined"===typeof window?"server://singlefetch/":window.location.origin):e;return"/"===a.pathname?a.pathname="_root.".concat(r):t&&"/"===z(a.pathname,t)?a.pathname="".concat(t.replace(/\/$/,""),"/_root.").concat(r):a.pathname="".concat(a.pathname.replace(/\/$/,""),".").concat(r),a}async function Be(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error("Error loading route module `".concat(e.module,"`, reloading page...")),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Ue(e){return null!=e&&"string"===typeof e.page}function We(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"===typeof e.imageSrcSet&&"string"===typeof e.imageSizes:"string"===typeof e.rel&&"string"===typeof e.href)}function He(e,t,r,a,s,n){let i=(e,t)=>!r[t]||e.route.id!==r[t].route.id,o=(e,t)=>{var a;return r[t].pathname!==e.pathname||(null===(a=r[t].route.path)||void 0===a?void 0:a.endsWith("*"))&&r[t].params["*"]!==e.params["*"]};return"assets"===n?t.filter((e,t)=>i(e,t)||o(e,t)):"data"===n?t.filter((t,n)=>{let l=a.routes[t.route.id];if(!l||!l.hasLoader)return!1;if(i(t,n)||o(t,n))return!0;if(t.route.shouldRevalidate){var c;let a=t.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:(null===(c=r[0])||void 0===c?void 0:c.params)||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"===typeof a)return a}return!0}):[]}function Ve(e,t){let{includeHydrateFallback:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return a=e.map(e=>{let a=t.routes[e.route.id];if(!a)return[];let s=[a.module];return a.clientActionModule&&(s=s.concat(a.clientActionModule)),a.clientLoaderModule&&(s=s.concat(a.clientLoaderModule)),r&&a.hydrateFallbackModule&&(s=s.concat(a.hydrateFallbackModule)),a.imports&&(s=s.concat(a.imports)),s}).flat(1),[...new Set(a)];var a}function Ge(e,t){let r=new Set,a=new Set(t);return e.reduce((e,s)=>{if(t&&!Ue(s)&&"script"===s.as&&s.href&&a.has(s.href))return e;let n=JSON.stringify(function(e){let t={},r=Object.keys(e).sort();for(let a of r)t[a]=e[a];return t}(s));return r.has(n)||(r.add(n),e.push({key:n,link:s})),e},[])}function qe(e,t){return"lazy"===e.mode&&!0===t}function $e(){let e=a.useContext(Q);return Le(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function Ke(){let e=a.useContext(Z);return Le(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var Ye=a.createContext(void 0);function Je(){let e=a.useContext(Ye);return Le(e,"You must render this element inside a <HydratedRouter> element"),e}function Xe(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function Qe(e,t,r){if(r&&!rt)return[e[0]];if(t){let r=e.findIndex(e=>void 0!==t[e.route.id]);return e.slice(0,r+1)}return e}Ye.displayName="FrameworkContext";function Ze(e){let{page:t}=e,r=i(e,l),{router:s}=$e(),o=a.useMemo(()=>N(s.routes,t,s.basename),[s.routes,t,s.basename]);return o?a.createElement(tt,(0,n.A)({page:t,matches:o},r)):null}function et(e){let{manifest:t,routeModules:r}=Je(),[s,i]=a.useState([]);return a.useEffect(()=>{let a=!1;return async function(e,t,r){return Ge((await Promise.all(e.map(async e=>{let a=t.routes[e.route.id];if(a){let e=await Be(a,r);return e.links?e.links():[]}return[]}))).flat(1).filter(We).filter(e=>"stylesheet"===e.rel||"preload"===e.rel).map(e=>"stylesheet"===e.rel?(0,n.A)((0,n.A)({},e),{},{rel:"prefetch",as:"style"}):(0,n.A)((0,n.A)({},e),{},{rel:"prefetch"})))}(e,t,r).then(e=>{a||i(e)}),()=>{a=!0}},[e,t,r]),s}function tt(e){let{page:t,matches:r}=e,s=i(e,c),o=ce(),{manifest:l,routeModules:d}=Je(),{basename:u}=$e(),{loaderData:h,matches:f}=Ke(),m=a.useMemo(()=>He(t,r,f,l,o,"data"),[t,r,f,l,o]),p=a.useMemo(()=>He(t,r,f,l,o,"assets"),[t,r,f,l,o]),g=a.useMemo(()=>{if(t===o.pathname+o.search+o.hash)return[];let e=new Set,a=!1;if(r.forEach(t=>{var r;let s=l.routes[t.route.id];s&&s.hasLoader&&(!m.some(e=>e.route.id===t.route.id)&&t.route.id in h&&null!==(r=d[t.route.id])&&void 0!==r&&r.shouldRevalidate||s.hasClientLoader?a=!0:e.add(t.route.id))}),0===e.size)return[];let s=ze(t,u,"data");return a&&e.size>0&&s.searchParams.set("_routes",r.filter(t=>e.has(t.route.id)).map(e=>e.route.id).join(",")),[s.pathname+s.search]},[u,h,o,l,m,r,t,d]),x=a.useMemo(()=>Ve(p,l),[p,l]),b=et(p);return a.createElement(a.Fragment,null,g.map(e=>a.createElement("link",(0,n.A)({key:e,rel:"prefetch",as:"fetch",href:e},s))),x.map(e=>a.createElement("link",(0,n.A)({key:e,rel:"modulepreload",href:e},s))),b.map(e=>{let{key:t,link:r}=e;return a.createElement("link",(0,n.A)({key:t,nonce:s.nonce},r))}))}var rt=!1;function at(e){let{manifest:t,serverHandoffString:r,isSpaMode:s,renderMeta:l,routeDiscovery:c,ssr:d}=Je(),{router:u,static:h,staticContext:f}=$e(),{matches:m}=Ke(),p=a.useContext(ee),g=qe(c,d);l&&(l.didRenderScripts=!0);let x=Qe(m,null,s);a.useEffect(()=>{rt=!0},[]);let b=a.useMemo(()=>{var s;if(p)return null;let l=f?"window.__reactRouterContext = ".concat(r,";").concat("window.__reactRouterContext.stream = new ReadableStream({start(controller){window.__reactRouterContext.streamController = controller;}}).pipeThrough(new TextEncoderStream());"):" ",c=h?"".concat(null!==(s=t.hmr)&&void 0!==s&&s.runtime?"import ".concat(JSON.stringify(t.hmr.runtime),";"):"").concat(g?"":"import ".concat(JSON.stringify(t.url)),";\n").concat(x.map((e,r)=>{let a="route".concat(r),s=t.routes[e.route.id];Le(s,"Route ".concat(e.route.id," not found in manifest"));let{clientActionModule:n,clientLoaderModule:i,clientMiddlewareModule:o,hydrateFallbackModule:l,module:c}=s,d=[...n?[{module:n,varName:"".concat(a,"_clientAction")}]:[],...i?[{module:i,varName:"".concat(a,"_clientLoader")}]:[],...o?[{module:o,varName:"".concat(a,"_clientMiddleware")}]:[],...l?[{module:l,varName:"".concat(a,"_HydrateFallback")}]:[],{module:c,varName:"".concat(a,"_main")}];return 1===d.length?"import * as ".concat(a," from ").concat(JSON.stringify(c),";"):[d.map(e=>"import * as ".concat(e.varName,' from "').concat(e.module,'";')).join("\n"),"const ".concat(a," = {").concat(d.map(e=>"...".concat(e.varName)).join(","),"};")].join("\n")}).join("\n"),"\n  ").concat(g?"window.__reactRouterManifest = ".concat(JSON.stringify(function(e,t){let{sri:r}=e,a=i(e,o),s=new Set(t.state.matches.map(e=>e.route.id)),l=t.state.location.pathname.split("/").filter(Boolean),c=["/"];for(l.pop();l.length>0;)c.push("/".concat(l.join("/"))),l.pop();c.forEach(e=>{let r=N(t.routes,e,t.basename);r&&r.forEach(e=>s.add(e.route.id))});let d=[...s].reduce((e,t)=>Object.assign(e,{[t]:a.routes[t]}),{});return(0,n.A)((0,n.A)({},a),{},{routes:d,sri:!!r||void 0})}(t,u),null,2),";"):"","\n  window.__reactRouterRouteModules = {").concat(x.map((e,t)=>"".concat(JSON.stringify(e.route.id),":route").concat(t)).join(","),"};\n\nimport(").concat(JSON.stringify(t.entry.module),");"):" ";return a.createElement(a.Fragment,null,a.createElement("script",(0,n.A)((0,n.A)({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:Fe(l),type:void 0})),a.createElement("script",(0,n.A)((0,n.A)({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:Fe(c),type:"module",async:!0})))},[]),v=rt||p?[]:(y=t.entry.imports.concat(Ve(x,t,{includeHydrateFallback:!0})),[...new Set(y)]);var y;let w="object"===typeof t.sri?t.sri:{};return _e(!p,"The <Scripts /> element is a no-op when using RSC and can be safely removed."),rt||p?null:a.createElement(a.Fragment,null,"object"===typeof t.sri?a.createElement("script",{"rr-importmap":"",type:"importmap",suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:JSON.stringify({integrity:w})}}):null,g?null:a.createElement("link",{rel:"modulepreload",href:t.url,crossOrigin:e.crossOrigin,integrity:w[t.url],suppressHydrationWarning:!0}),a.createElement("link",{rel:"modulepreload",href:t.entry.module,crossOrigin:e.crossOrigin,integrity:w[t.entry.module],suppressHydrationWarning:!0}),v.map(t=>a.createElement("link",{key:t,rel:"modulepreload",href:t,crossOrigin:e.crossOrigin,integrity:w[t],suppressHydrationWarning:!0})),b)}function st(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return e=>{t.forEach(t=>{"function"===typeof t?t(e):null!=t&&(t.current=e)})}}a.Component;function nt(e){let{error:t,isOutsideRemixApp:r}=e;console.error(t);let s,n=a.createElement("script",{dangerouslySetInnerHTML:{__html:'\n        console.log(\n          "\ud83d\udcbf Hey developer \ud83d\udc4b. You can provide a way better UX than this when your app throws errors. Check out https://reactrouter.com/how-to/error-boundary for more information."\n        );\n      '}});if(Y(t))return a.createElement(it,{title:"Unhandled Thrown Response!"},a.createElement("h1",{style:{fontSize:"24px"}},t.status," ",t.statusText),n);if(t instanceof Error)s=t;else{let e=null==t?"Unknown Error":"object"===typeof t&&"toString"in t?t.toString():JSON.stringify(t);s=new Error(e)}return a.createElement(it,{title:"Application Error!",isOutsideRemixApp:r},a.createElement("h1",{style:{fontSize:"24px"}},"Application Error"),a.createElement("pre",{style:{padding:"2rem",background:"hsla(10, 50%, 50%, 0.1)",color:"red",overflow:"auto"}},s.stack),n)}function it(e){var t;let{title:r,renderScripts:s,isOutsideRemixApp:n,children:i}=e,{routeModules:o}=Je();return null!==(t=o.root)&&void 0!==t&&t.Layout&&!n?i:a.createElement("html",{lang:"en"},a.createElement("head",null,a.createElement("meta",{charSet:"utf-8"}),a.createElement("meta",{name:"viewport",content:"width=device-width,initial-scale=1,viewport-fit=cover"}),a.createElement("title",null,r)),a.createElement("body",null,a.createElement("main",{style:{fontFamily:"system-ui, sans-serif",padding:"2rem"}},i,s?a.createElement(at,null):null)))}var ot="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement;try{ot&&(window.__reactRouterVersion="7.8.2")}catch(bN){}function lt(e){let{basename:t,children:r,window:s}=e,n=a.useRef();null==n.current&&(n.current=m({window:s,v5Compat:!0}));let i=n.current,[o,l]=a.useState({action:i.action,location:i.location}),c=a.useCallback(e=>{a.startTransition(()=>l(e))},[l]);return a.useLayoutEffect(()=>i.listen(c),[i,c]),a.createElement(Ce,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:i})}var ct=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,dt=a.forwardRef(function(e,t){let r,{onClick:s,discover:o="render",prefetch:l="none",relative:c,reloadDocument:u,replace:h,state:f,target:m,to:x,preventScrollReset:b,viewTransition:y}=e,w=i(e,d),{basename:j}=a.useContext(se),N="string"===typeof x&&ct.test(x),k=!1;if("string"===typeof x&&N&&(r=x,ot))try{let e=new URL(window.location.href),t=x.startsWith("//")?new URL(e.protocol+x):new URL(x),r=z(t.pathname,j);t.origin===e.origin&&null!=r?x=r+t.search+t.hash:k=!0}catch(bN){g(!1,'<Link to="'.concat(x,'"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.'))}let S=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};p(le(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:s}=a.useContext(se),{hash:n,pathname:i,search:o}=fe(e,{relative:t}),l=i;return"/"!==r&&(l="/"===i?r:V([r,i])),s.createHref({pathname:l,search:o,hash:n})}(x,{relative:c}),[E,T,_]=function(e,t){let r=a.useContext(Ye),[s,n]=a.useState(!1),[i,o]=a.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:d,onMouseLeave:u,onTouchStart:h}=t,f=a.useRef(null);a.useEffect(()=>{if("render"===e&&o(!0),"viewport"===e){let e=new IntersectionObserver(e=>{e.forEach(e=>{o(e.isIntersecting)})},{threshold:.5});return f.current&&e.observe(f.current),()=>{e.disconnect()}}},[e]),a.useEffect(()=>{if(s){let e=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(e)}}},[s]);let m=()=>{n(!0)},p=()=>{n(!1),o(!1)};return r?"intent"!==e?[i,f,{}]:[i,f,{onFocus:Xe(l,m),onBlur:Xe(c,p),onMouseEnter:Xe(d,m),onMouseLeave:Xe(u,p),onTouchStart:Xe(h,m)}]:[!1,f,{}]}(l,w),C=function(e){let{target:t,replace:r,state:s,preventScrollReset:n,relative:i,viewTransition:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=he(),c=ce(),d=fe(e,{relative:i});return a.useCallback(a=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(a,t)){a.preventDefault();let t=void 0!==r?r:v(c)===v(d);l(e,{replace:t,state:s,preventScrollReset:n,relative:i,viewTransition:o})}},[c,l,d,r,s,t,e,n,i,o])}(x,{replace:h,state:f,target:m,preventScrollReset:b,relative:c,viewTransition:y});let A=a.createElement("a",(0,n.A)((0,n.A)((0,n.A)({},w),_),{},{href:r||S,onClick:k||u?s:function(e){s&&s(e),e.defaultPrevented||C(e)},ref:st(t,T),target:m,"data-discover":N||"render"!==o?void 0:"true"}));return E&&!N?a.createElement(a.Fragment,null,A,a.createElement(Ze,{page:S})):A});dt.displayName="Link";var ut=a.forwardRef(function(e,t){let{"aria-current":r="page",caseSensitive:s=!1,className:o="",end:l=!1,style:c,to:d,viewTransition:h,children:f}=e,m=i(e,u),g=fe(d,{relative:m.relative}),x=ce(),b=a.useContext(Z),{navigator:v,basename:y}=a.useContext(se),w=null!=b&&function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=a.useContext(te);p(null!=r,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=mt("useViewTransitionState"),n=fe(e,{relative:t});if(!r.isTransitioning)return!1;let i=z(r.currentLocation.pathname,s)||r.currentLocation.pathname,o=z(r.nextLocation.pathname,s)||r.nextLocation.pathname;return null!=M(n.pathname,o)||null!=M(n.pathname,i)}(g)&&!0===h,j=v.encodeLocation?v.encodeLocation(g).pathname:g.pathname,N=x.pathname,k=b&&b.navigation&&b.navigation.location?b.navigation.location.pathname:null;s||(N=N.toLowerCase(),k=k?k.toLowerCase():null,j=j.toLowerCase()),k&&y&&(k=z(k,y)||k);const S="/"!==j&&j.endsWith("/")?j.length-1:j.length;let E,T=N===j||!l&&N.startsWith(j)&&"/"===N.charAt(S),_=null!=k&&(k===j||!l&&k.startsWith(j)&&"/"===k.charAt(j.length)),C={isActive:T,isPending:_,isTransitioning:w},A=T?r:void 0;E="function"===typeof o?o(C):[o,T?"active":null,_?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let D="function"===typeof c?c(C):c;return a.createElement(dt,(0,n.A)((0,n.A)({},m),{},{"aria-current":A,className:E,ref:t,style:D,to:d,viewTransition:h}),"function"===typeof f?f(C):f)});ut.displayName="NavLink";var ht=a.forwardRef((e,t)=>{let{discover:r="render",fetcherKey:s,navigate:o,reloadDocument:l,replace:c,state:d,method:u=Ae,action:f,onSubmit:m,relative:g,preventScrollReset:x,viewTransition:b}=e,y=i(e,h),w=xt(),j=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{basename:r}=a.useContext(se),s=a.useContext(ie);p(s,"useFormAction must be used inside a RouteContext");let[i]=s.matches.slice(-1),o=(0,n.A)({},fe(e||".",{relative:t})),l=ce();if(null==e){o.search=l.search;let e=new URLSearchParams(o.search),t=e.getAll("index");if(t.some(e=>""===e)){e.delete("index"),t.filter(e=>e).forEach(t=>e.append("index",t));let r=e.toString();o.search=r?"?".concat(r):""}}e&&"."!==e||!i.route.index||(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index");"/"!==r&&(o.pathname="/"===o.pathname?r:V([r,o.pathname]));return v(o)}(f,{relative:g}),N="get"===u.toLowerCase()?"get":"post",k="string"===typeof f&&ct.test(f);return a.createElement("form",(0,n.A)((0,n.A)({ref:t,method:N,action:j,onSubmit:l?m:e=>{if(m&&m(e),e.defaultPrevented)return;e.preventDefault();let t=e.nativeEvent.submitter,r=(null===t||void 0===t?void 0:t.getAttribute("formmethod"))||u;w(t||e.currentTarget,{fetcherKey:s,method:r,navigate:o,replace:c,state:d,relative:g,preventScrollReset:x,viewTransition:b})}},y),{},{"data-discover":k||"render"!==r?void 0:"true"}))});function ft(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function mt(e){let t=a.useContext(Q);return p(t,ft(e)),t}ht.displayName="Form";var pt=0,gt=()=>"__".concat(String(++pt),"__");function xt(){let{router:e}=mt("useSubmit"),{basename:t}=a.useContext(se),r=Ne("useRouteId");return a.useCallback(async function(a){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{action:n,method:i,encType:o,formData:l,body:c}=Me(a,t);if(!1===s.navigate){let t=s.fetcherKey||gt();await e.fetch(t,r,s.action||n,{preventScrollReset:s.preventScrollReset,formData:l,body:c,formMethod:s.method||i,formEncType:s.encType||o,flushSync:s.flushSync})}else await e.navigate(s.action||n,{preventScrollReset:s.preventScrollReset,formData:l,body:c,formMethod:s.method||i,formEncType:s.encType||o,replace:s.replace,state:s.state,fromRouteId:r,flushSync:s.flushSync,viewTransition:s.viewTransition})},[e,t,r])}var bt=r(414);const vt={project_manager:{name:"Project Manager",description:"Acceso completo al sistema PMO",permissions:["*:*"],color:"from-purple-600 to-indigo-600"},executive_manager:{name:"Gestor Ejecutivo",description:"Solo dashboards y reportes ejecutivos",permissions:["portfolio:read","dashboard:read","reports:read","audit:read"],color:"from-blue-600 to-cyan-600"},pmo_assistant:{name:"Asistente de PMO",description:"Gesti\xf3n de proyectos y operaciones",permissions:["portfolio:write","projects:full","workpackages:full","schedule:full","risks:full","resources:read","files:full","reports:read"],color:"from-green-600 to-emerald-600"},financial_analyst:{name:"Analista Financiero",description:"M\xf3dulos financieros y EVM",permissions:["portfolio:read","financial:full","evm:full","cashflow:full","changes:full","reports:read","audit:read"],color:"from-orange-600 to-red-600"},project_coordinator:{name:"Coordinador de Proyectos",description:"Gesti\xf3n de tareas y cronogramas",permissions:["portfolio:read","projects:read","workpackages:write","schedule:full","resources:read","files:read","reports:read"],color:"from-teal-600 to-blue-600"},auditor:{name:"Auditor/Consultor",description:"Solo lectura en todos los m\xf3dulos",permissions:["portfolio:read","projects:read","financial:read","risks:read","schedule:read","resources:read","files:read","reports:read","audit:read"],color:"from-gray-600 to-slate-600"}},yt=(0,a.createContext)(),wt=()=>{const e=(0,a.useContext)(yt);if(!e)throw new Error("useAuth debe ser usado dentro de un AuthProvider");return e},jt=e=>{let{children:t}=e;const[r,s]=(0,a.useState)(null),[n,i]=(0,a.useState)(!1),[o,l]=(0,a.useState)([]),[c,d]=(0,a.useState)(!1),[u,h]=(0,a.useState)(!0);(0,a.useEffect)(()=>{(async()=>{try{const t=localStorage.getItem("strategiapm_user");if(t){var e;const r=JSON.parse(t);s(r),i(!0),l((null===(e=vt[r.role])||void 0===e?void 0:e.permissions)||[])}}catch(t){console.error("Error verificando autenticaci\xf3n:",t)}finally{h(!1)}})()},[]);const f={user:r,isAuthenticated:n,permissions:o,loading:c,showSplash:u,hasPermission:e=>{if(!o||0===o.length)return!1;if(o.includes("*:*"))return!0;if(o.includes(e))return!0;const[t,r]=e.split(":");return!!o.includes("".concat(t,":*"))},hasModuleAccess:e=>!(!o||0===o.length)&&(!!o.includes("*:*")||o.some(t=>t.startsWith("".concat(e,":"))||t==="".concat(e,":*"))),getUserPermissions:()=>{var e;return r&&(null===(e=vt[r.role])||void 0===e?void 0:e.permissions)||[]},getUserRoleInfo:()=>r&&vt[r.role]||null,login:async(e,t)=>{d(!0);try{return console.log("\ud83d\udd10 Login manejado por SupabaseService"),null}catch(r){throw console.error("\u274c Error en login:",r),r}finally{d(!1)}},logout:()=>{s(null),i(!1),l([]),localStorage.removeItem("strategiapm_user")},clearAuthState:()=>{s(null),i(!1),l([]),localStorage.removeItem("strategiapm_user"),console.log("\ud83d\udd12 Estado de autenticaci\xf3n limpiado completamente")},completeSplash:()=>{h(!1)}};return(0,bt.jsx)(yt.Provider,{value:f,children:t})};var Nt=r(874);const kt=()=>{const[e,t]=(0,a.useState)(null),[r,s]=(0,a.useState)(!0),[n,i]=(0,a.useState)({canEdit:!1,canDelete:!1,canInvite:!1,canManageUsers:!1,canArchive:!1,canExport:!1}),o=(0,a.useRef)(null),l=(0,a.useRef)(!1);(0,a.useEffect)(()=>{const e=async()=>{if(l.current)console.log("\u23f8\ufe0f usePermissions ya est\xe1 cargando, evitando duplicaci\xf3n...");else try{var r;l.current=!0,s(!0);const n=Nt.default.getCurrentUser();if(console.log("\ud83d\udd10 usePermissions - Usuario actual:",(null===n||void 0===n?void 0:n.email)||"No autenticado"),!n||!n.email)return console.log("\u274c No hay usuario autenticado, aplicando permisos restrictivos"),t(null),void i({canEdit:!1,canDelete:!1,canInvite:!1,canManageUsers:!1,canArchive:!1,canExport:!1});const o=Nt.default.getCurrentOrganization();if(!o){console.log("\u23f3 Esperando detecci\xf3n de organizaci\xf3n...");try{const{data:e,error:t}=await Nt.default.supabase.from("organization_members").select("id, organization_id, status").eq("user_email",n.email).eq("status","active");if(t)console.error("\u274c Error verificando membres\xeda:",t);else if(!e||0===e.length)return console.log("\ud83d\udea8 USUARIO ELIMINADO DETECTADO - No tiene membres\xedas activas"),console.log("\ud83d\udea8 Forzando cierre de sesi\xf3n para:",n.email),await Nt.default.supabase.auth.signOut(),localStorage.clear(),sessionStorage.clear(),void window.location.reload()}catch(a){console.error("\u274c Error verificando membres\xeda del usuario:",a)}return void setTimeout(()=>{l.current||e()},1e3)}console.log("\ud83d\udd0d Buscando rol para:",{email:n.email,organizationId:o});const d=await Nt.default.supabase.auth.getUser();console.log("\ud83d\udd0d Estado de autenticaci\xf3n antes de query:",{authUser:(null===(r=d.data.user)||void 0===r?void 0:r.email)||"No autenticado",currentUserEmail:n.email,organizationId:o});const{data:u,error:h}=await Nt.default.supabase.from("organization_members").select("role, status").eq("user_email",n.email).eq("organization_id",o).eq("status","active").maybeSingle();if(console.log("\ud83d\udd0d Resultado de query membership:",{membership:u,error:h}),h)console.error("\u274c Error cargando rol:",h.code,h.message),t(null),i({canEdit:!1,canDelete:!1,canInvite:!1,canManageUsers:!1,canArchive:!1,canExport:!1});else if(u){console.log("\u2705 Membership encontrado:",u);const e=u.role||"organization_member_read";t(e);const r=c(e);i(r),console.log("\ud83d\udd10 Permisos aplicados:",{role:e,permissions:r,isReadOnly:"organization_member_read"===e})}else console.log("\u274c No se encontr\xf3 membership para el usuario"),t(null),i({canEdit:!1,canDelete:!1,canInvite:!1,canManageUsers:!1,canArchive:!1,canExport:!1})}catch(n){console.error("\u274c Error inesperado en usePermissions:",n),t(null),i({canEdit:!1,canDelete:!1,canInvite:!1,canManageUsers:!1,canArchive:!1,canExport:!1})}finally{s(!1),l.current=!1}};e();const r=setInterval(()=>{const t=Nt.default.getCurrentUser(),r=null===t||void 0===t?void 0:t.email;r!==o.current&&(console.log("\ud83d\udd04 Usuario cambi\xf3, recargando permisos...",{anterior:o.current,actual:r}),o.current=r,e())},2e3);return()=>{clearInterval(r),l.current=!1}},[]);const c=e=>{switch(e){case"owner":case"admin":return{canEdit:!0,canDelete:!0,canInvite:!0,canManageUsers:!0,canArchive:!0,canExport:!0};case"organization_member_write":return{canEdit:!0,canDelete:!1,canInvite:!1,canManageUsers:!1,canArchive:!1,canExport:!0};case"organization_member_read":return{canEdit:!1,canDelete:!1,canInvite:!1,canManageUsers:!1,canArchive:!1,canExport:!0};default:return{canEdit:!1,canDelete:!1,canInvite:!1,canManageUsers:!1,canArchive:!1,canExport:!1}}};return{permissions:n,isReadOnly:()=>"organization_member_read"===e,isLoading:r,userRole:e}},St=e=>{var t;let{activeSection:r,onSectionChange:s,projects:n,currentProjectId:i,setCurrentProjectId:o,workPackages:l=[],risks:c=[],evmMetrics:d={},isCollapsed:u=!1,onToggleCollapse:h}=e;const{permissions:f,isReadOnly:m}=kt(),[p,g]=a.useState(!1),[x,b]=a.useState(null),[v,y]=a.useState(!1),[w,j]=a.useState(null),[N,k]=a.useState(null),[S,E]=a.useState(!1),T=async()=>{try{g(!0),console.log("\ud83d\udd04 Iniciando backup de base de datos...");const e=await Nt.default.createDatabaseBackup();e.success?(console.log("\u2705 Backup exitoso: ".concat(e.fileName)),console.log("\ud83d\udcca Registros respaldados: ".concat(e.recordCount," de ").concat(e.tables," tablas")),alert("\u2705 Backup completado exitosamente!\n\nArchivo: ".concat(e.fileName,"\nRegistros: ").concat(e.recordCount,"\nTablas: ").concat(e.tables))):(console.error("\u274c Error en backup:",e.error),alert("\u274c Error al crear backup:\n".concat(e.error)))}catch(e){console.error("\u274c Error inesperado en backup:",e),alert("\u274c Error inesperado:\n".concat(e.message))}finally{g(!1)}};a.useEffect(()=>{(async()=>{try{const e=await Nt.default.getBackupStats();e.success&&b(e)}catch(e){console.warn("\u26a0\ufe0f No se pudieron cargar estad\xedsticas de backup:",e)}})()},[]);const _=[{id:"portfolio",name:"Portafolio de Proyectos",icon:"\ud83c\udfe2",requiresEdit:!0},{id:"project-management",name:"Gesti\xf3n de Proyectos",icon:"\ud83d\udcca",requiresEdit:!1},{id:"executive",name:"Dashboard Ejecutivo",icon:"\ud83d\udcc8",requiresEdit:!1},{id:"user-management",name:"Gesti\xf3n de Usuarios",icon:"\ud83d\udc65",requiresEdit:!0}].filter(e=>!e.requiresEdit||!m()),C=e=>{switch(e){case"portfolio":return"Gesti\xf3n estrat\xe9gica de proyectos con Business Case, TIR y presupuestos";case"project-management":return"Control operativo con m\xf3dulos de riesgos, cronograma y finanzas";case"executive":return"KPIs consolidados y m\xe9tricas ejecutivas de todos los proyectos activos";case"user-management":return"Gestionar usuarios, roles y permisos de la organizaci\xf3n";default:return""}};null===n||void 0===n||n.find(e=>e.id===i);return(0,bt.jsxs)(bt.Fragment,{children:[u&&(0,bt.jsx)("button",{onClick:h,className:"fixed top-4 left-4 z-50 bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-full shadow-lg transition-all duration-200 hover:shadow-xl",title:"Expandir men\xfa",children:(0,bt.jsx)("span",{className:"text-lg font-bold",children:"\u2630"})}),(0,bt.jsxs)("div",{className:"\n        fixed top-0 left-0 h-full bg-white shadow-xl z-40 \n        ".concat(u?"w-16":"w-80 lg:w-72"," \n        border-r border-gray-200\n        transition-all duration-300\n      "),children:[(0,bt.jsxs)("div",{className:"border-b border-gray-200 ".concat(u?"p-2":"p-6"),children:[(0,bt.jsxs)("div",{className:"flex items-center ".concat(u?"justify-center":"justify-between"),children:[!u&&(0,bt.jsx)("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"StrategiaPM"}),(0,bt.jsx)("button",{onClick:h,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors duration-200 z-10 relative",title:u?"Expandir sidebar":"Colapsar sidebar",style:{minWidth:"40px",minHeight:"40px"},children:(0,bt.jsx)("span",{className:"text-xl font-bold",children:u?"\u2192":"\u2190"})})]}),!u&&(0,bt.jsxs)("div",{className:"text-sm text-gray-600 space-y-2",children:[(0,bt.jsx)("p",{className:"font-medium",children:"Gesti\xf3n de Proyectos"}),(0,bt.jsxs)("div",{className:"flex items-center space-x-2 px-2 py-1 bg-blue-50 rounded-lg border border-blue-200",children:[(0,bt.jsx)("span",{className:"text-blue-600",children:"\ud83d\udc64"}),(0,bt.jsxs)("div",{className:"flex flex-col",children:[(0,bt.jsx)("span",{className:"text-xs font-medium text-blue-800",children:(null===(t=Nt.default.getCurrentUser())||void 0===t?void 0:t.email)||"Usuario no autenticado"}),(0,bt.jsx)("span",{className:"text-xs text-blue-600",children:Nt.default.getCurrentUser()?"\ud83d\udfe2 Conectado":"\ud83d\udd34 Desconectado"})]})]}),m()&&(0,bt.jsxs)("div",{className:"flex items-center space-x-2 px-2 py-1 bg-orange-50 rounded-lg border border-orange-200",children:[(0,bt.jsx)("span",{className:"text-orange-600",children:"\ud83d\udc40"}),(0,bt.jsxs)("div",{className:"flex flex-col",children:[(0,bt.jsx)("span",{className:"text-xs font-medium text-orange-800",children:"Modo Solo Lectura"}),(0,bt.jsx)("span",{className:"text-xs text-orange-600",children:"Acceso limitado a visualizaci\xf3n"})]})]}),(0,bt.jsxs)("div",{className:"space-y-2",children:[Nt.default.getCurrentUser()&&(0,bt.jsxs)("button",{onClick:async()=>{if(window.confirm("\xbfEst\xe1s seguro de que quieres desconectarte?\n\nEsto cerrar\xe1 completamente tu sesi\xf3n por seguridad.")){console.log("\ud83d\udeaa Cerrando sesi\xf3n de Supabase...");try{const e=await Nt.default.signOut();if(e.success){console.log("\u2705 Logout completo exitoso");Nt.default.getCurrentUser()&&console.warn("\u26a0\ufe0f Usuario a\xfan detectado despu\xe9s del logout, forzando recarga..."),setTimeout(()=>{console.log("\ud83d\udd04 Recargando p\xe1gina para limpiar estado..."),window.location.reload()},500)}else console.error("\u274c Error cerrando sesi\xf3n:",e.error),alert("\u274c Error al cerrar sesi\xf3n. Int\xe9ntalo de nuevo.")}catch(e){console.error("\u274c Error inesperado:",e),alert("\u274c Error inesperado al cerrar sesi\xf3n.")}}},className:"w-full flex items-center justify-center space-x-2 px-2 py-2 bg-red-50 hover:bg-red-100 border border-red-200 rounded-lg transition-colors duration-200",children:[(0,bt.jsx)("span",{className:"text-red-600",children:"\ud83d\udeaa"}),(0,bt.jsx)("span",{className:"text-xs font-medium text-red-800",children:"Desconectar Usuario"})]}),!Nt.default.getCurrentUser()&&(0,bt.jsxs)("button",{onClick:()=>{console.log("\ud83d\udd11 Abriendo modal de autenticaci\xf3n..."),window.dispatchEvent(new CustomEvent("requestSupabaseAuth",{detail:{action:"login"}}))},className:"w-full flex items-center justify-center space-x-2 px-2 py-2 bg-green-50 hover:bg-green-100 border border-green-200 rounded-lg transition-colors duration-200",children:[(0,bt.jsx)("span",{className:"text-green-600",children:"\ud83d\udd11"}),(0,bt.jsx)("span",{className:"text-xs font-medium text-green-800",children:"Conectar Usuario"})]})]})]})]}),!u&&(0,bt.jsx)("nav",{className:"p-3",children:(0,bt.jsx)("ul",{className:"space-y-1",children:_.map(e=>(0,bt.jsx)("li",{children:(0,bt.jsxs)("button",{onClick:()=>s(e.id),className:"\n                      w-full flex items-center px-3 py-2 text-left rounded-lg transition-colors\n                      ".concat(r===e.id?"bg-blue-100 text-blue-700 border-l-4 border-blue-500":"text-gray-700 hover:bg-gray-100","\n                    "),children:[(0,bt.jsx)("span",{className:"text-lg mr-2",children:e.icon}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("div",{className:"font-medium text-sm",children:e.name}),(0,bt.jsx)("div",{className:"text-xs text-gray-500",children:C(e.id)})]})]})},e.id))})}),!m()&&(0,bt.jsx)("div",{className:"border-t border-gray-200 mt-auto ".concat(u?"p-2":"p-4"),children:u?(0,bt.jsxs)("div",{className:"space-y-2",children:[(0,bt.jsx)("button",{onClick:T,disabled:p,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white p-3 rounded-lg transition-colors duration-200 flex items-center justify-center",title:"Descargar backup",children:(0,bt.jsx)("span",{className:"text-lg",children:"\ud83d\uddc4\ufe0f"})}),(0,bt.jsx)("button",{onClick:()=>y(!0),disabled:S,className:"w-full bg-green-600 hover:bg-green-700 disabled:bg-gray-400 text-white p-3 rounded-lg transition-colors duration-200 flex items-center justify-center",title:"Restaurar backup",children:(0,bt.jsx)("span",{className:"text-lg",children:"\ud83d\udd04"})})]}):(0,bt.jsxs)("div",{className:"space-y-2",children:[(0,bt.jsxs)("button",{onClick:T,disabled:p,className:"w-full px-4 py-3 rounded-lg transition-colors duration-200 flex items-center justify-center space-x-2 shadow-md hover:shadow-lg ".concat(p?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"),title:"Descargar backup completo de la base de datos (archivo JSON)",children:[(0,bt.jsx)("span",{className:"text-lg",children:p?"\u23f3":"\ud83d\uddc4\ufe0f"}),(0,bt.jsx)("span",{className:"font-medium",children:p?"Descargando...":"Descargar Backup"})]}),(0,bt.jsxs)("button",{onClick:()=>y(!0),disabled:S,className:"w-full px-4 py-3 rounded-lg transition-colors duration-200 flex items-center justify-center space-x-2 shadow-md hover:shadow-lg ".concat(S?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700 text-white"),title:"Restaurar datos desde un archivo de backup",children:[(0,bt.jsx)("span",{className:"text-lg",children:S?"\u23f3":"\ud83d\udd04"}),(0,bt.jsx)("span",{className:"font-medium",children:S?"Restaurando...":"Restaurar Backup"})]}),x&&(0,bt.jsxs)("div",{className:"mt-2 text-xs text-gray-500 text-center",children:[(0,bt.jsxs)("div",{children:["\ud83d\udcca ",x.totalRecords," registros en ",x.tablesCount," tablas"]}),x.stats&&(0,bt.jsxs)("div",{className:"mt-1",children:["Proyectos: ",x.stats.projects||0," | Riesgos: ",x.stats.risks||0," | Tareas: ",x.stats.tasks||0]})]})]})}),v&&(0,bt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:(0,bt.jsx)("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:(0,bt.jsxs)("div",{className:"p-6",children:[(0,bt.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,bt.jsx)("h2",{className:"text-xl font-bold text-gray-800",children:"\ud83d\udd04 Restaurar Backup"}),(0,bt.jsx)("button",{onClick:()=>{y(!1),j(null),k(null)},className:"text-gray-500 hover:text-gray-700 text-xl",children:"\u2715"})]}),(0,bt.jsxs)("div",{className:"mb-6",children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Seleccionar archivo de backup (.json)"}),(0,bt.jsx)("input",{type:"file",accept:".json",onChange:e=>{const t=e.target.files[0];if(!t)return;if(!t.name.endsWith(".json"))return void alert("\u274c Error: El archivo debe ser un archivo JSON (.json)");j(t);const r=new FileReader;r.onload=e=>{try{const t=JSON.parse(e.target.result),r=Nt.default.getBackupPreview(t);r.success?(k(r),console.log("\u2705 Archivo de backup v\xe1lido:",r)):(alert("\u274c Error validando archivo: ".concat(r.error)),j(null),k(null))}catch(t){alert("\u274c Error leyendo archivo: ".concat(t.message)),j(null),k(null)}},r.readAsText(t)},className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),w&&(0,bt.jsxs)("p",{className:"mt-2 text-sm text-green-600",children:["\u2705 Archivo seleccionado: ",w.name]})]}),N&&(0,bt.jsxs)("div",{className:"mb-6",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"\ud83d\udccb Vista Previa del Backup"}),(0,bt.jsx)("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:(0,bt.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("span",{className:"font-medium",children:"\ud83d\udcc5 Fecha:"}),(0,bt.jsx)("span",{className:"ml-2",children:new Date(N.timestamp).toLocaleString()})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("span",{className:"font-medium",children:"\ud83d\udcca Total registros:"}),(0,bt.jsx)("span",{className:"ml-2 font-bold text-blue-600",children:N.totalRecords})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("span",{className:"font-medium",children:"\ud83d\udccb Tablas:"}),(0,bt.jsx)("span",{className:"ml-2",children:Object.keys(N.preview).length})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("span",{className:"font-medium",children:"\ud83d\udd22 Versi\xf3n:"}),(0,bt.jsx)("span",{className:"ml-2",children:N.version})]})]})}),(0,bt.jsxs)("div",{className:"space-y-2",children:[(0,bt.jsx)("h4",{className:"font-medium text-gray-700",children:"Detalles por tabla:"}),Object.entries(N.preview).map(e=>{let[t,r]=e;return(0,bt.jsxs)("div",{className:"flex justify-between items-center bg-white border rounded-lg px-3 py-2",children:[(0,bt.jsx)("span",{className:"font-medium capitalize",children:t.replace("_"," ")}),(0,bt.jsxs)("span",{className:"text-blue-600 font-bold",children:[r.count," registros"]})]},t)})]})]}),(0,bt.jsx)("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-lg p-4",children:(0,bt.jsxs)("div",{className:"flex items-start",children:[(0,bt.jsx)("span",{className:"text-red-500 text-xl mr-3",children:"\u26a0\ufe0f"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h4",{className:"font-semibold text-red-800 mb-2",children:"Advertencia Importante"}),(0,bt.jsxs)("ul",{className:"text-sm text-red-700 space-y-1",children:[(0,bt.jsxs)("li",{children:["\u2022 Esta acci\xf3n es ",(0,bt.jsx)("strong",{children:"IRREVERSIBLE"})]}),(0,bt.jsxs)("li",{children:["\u2022 Se ",(0,bt.jsx)("strong",{children:"eliminar\xe1n TODOS los datos actuales"})]}),(0,bt.jsx)("li",{children:"\u2022 Se restaurar\xe1n los datos del archivo seleccionado"}),(0,bt.jsx)("li",{children:"\u2022 Aseg\xfarate de tener un backup actual antes de continuar"})]})]})]})}),(0,bt.jsxs)("div",{className:"flex space-x-3",children:[(0,bt.jsx)("button",{onClick:()=>{y(!1),j(null),k(null)},className:"flex-1 bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg transition-colors",children:"Cancelar"}),(0,bt.jsx)("button",{onClick:async()=>{if(!w||!N)return void alert("\u274c Error: No hay archivo seleccionado o archivo inv\xe1lido");const e="\u26a0\ufe0f ADVERTENCIA: Esta acci\xf3n restaurar\xe1 ".concat(N.totalRecords," registros de ").concat(Object.keys(N.preview).length," tablas.\n\n\xbfEst\xe1s seguro de que quieres continuar?\n\nEsto puede sobrescribir datos existentes.");if(!window.confirm(e))return;if(window.confirm("\ud83d\udea8 \xdaLTIMA CONFIRMACI\xd3N\n\nEsta acci\xf3n es IRREVERSIBLE y puede sobrescribir TODOS los datos actuales.\n\n\xbfContinuar con la restauraci\xf3n?"))try{E(!0),console.log("\ud83d\udd04 Iniciando restauraci\xf3n de backup...");const e=new FileReader;e.onload=async e=>{try{const t=JSON.parse(e.target.result),r={clearExisting:!0},a=await Nt.default.restoreFromBackup(t,r);if(a.success){const e="\u2705 Restauraci\xf3n completada exitosamente!\n\n\ud83d\udcca Registros procesados: ".concat(a.processed,"\n\ud83d\udccb Errores: ").concat(a.errors.length,"\n\nLos datos han sido restaurados desde el backup.");alert(e);const t=await Nt.default.getBackupStats();t.success&&b(t),y(!1),j(null),k(null)}else alert("\u274c Error en restauraci\xf3n: ".concat(a.error))}catch(t){console.error("\u274c Error procesando restauraci\xf3n:",t),alert("\u274c Error inesperado: ".concat(t.message))}finally{E(!1)}},e.readAsText(w)}catch(t){console.error("\u274c Error iniciando restauraci\xf3n:",t),alert("\u274c Error inesperado: ".concat(t.message)),E(!1)}},disabled:!w||!N||S,className:"flex-1 px-4 py-2 rounded-lg transition-colors ".concat(w&&N&&!S?"bg-red-600 hover:bg-red-700 text-white":"bg-gray-300 cursor-not-allowed"),children:S?"\u23f3 Restaurando...":"\ud83d\udea8 Restaurar Backup"})]})]})})})]})]})},Et=e=>{let{projects:t,portfolioMetrics:r={},workPackages:a=[],risks:s=[]}=e;const n=[{name:"Activos",count:(null===r||void 0===r?void 0:r.activeProjects)||t.filter(e=>"active"===e.status).length,color:"#3B82F6"},{name:"Completados",count:(null===r||void 0===r?void 0:r.completedProjects)||t.filter(e=>"completed"===e.status).length,color:"#10B981"},{name:"En Pausa",count:t.filter(e=>"on-hold"===e.status).length,color:"#F59E0B"},{name:"Cancelados",count:t.filter(e=>"cancelled"===e.status).length,color:"#EF4444"}].filter(e=>e.count>0),i=[{name:"Alta",count:t.filter(e=>"high"===e.priority).length,color:"#EF4444"},{name:"Media",count:t.filter(e=>"medium"===e.priority).length,color:"#F59E0B"},{name:"Baja",count:t.filter(e=>"low"===e.priority).length,color:"#10B981"}].filter(e=>e.count>0),o=t.filter(e=>"active"===e.status).map((e,t)=>{const r=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#06B6D4"];return{name:e.name.length>20?e.name.substring(0,20)+"...":e.name,budget:e.budget/1e3,status:e.status,color:r[t%r.length]}}),l=[{name:"Completados",count:a.filter(e=>"completed"===e.status).length,color:"#10B981"},{name:"En Progreso",count:a.filter(e=>"in-progress"===e.status).length,color:"#3B82F6"},{name:"Pendientes",count:a.filter(e=>"pending"===e.status).length,color:"#F59E0B"},{name:"Retrasados",count:a.filter(e=>"delayed"===e.status).length,color:"#EF4444"}].filter(e=>e.count>0),c=[{name:"Alta",count:s.filter(e=>"high"===e.priority).length,color:"#EF4444"},{name:"Media",count:s.filter(e=>"medium"===e.priority).length,color:"#F59E0B"},{name:"Baja",count:s.filter(e=>"low"===e.priority).length,color:"#10B981"}].filter(e=>e.count>0),d=[{name:"Activos",count:s.filter(e=>"active"===e.status).length,color:"#EF4444"},{name:"Mitigados",count:s.filter(e=>"mitigated"===e.status).length,color:"#10B981"},{name:"Cerrados",count:s.filter(e=>"closed"===e.status).length,color:"#6B7280"}].filter(e=>e.count>0),u=e=>{let{data:t,title:r,valueKey:a,colorKey:s="color",height:n=200}=e;const i=Math.max(...t.map(e=>e[a]));return(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold mb-4",children:r}),(0,bt.jsx)("div",{className:"space-y-3",children:t.map((e,t)=>{const r=((e,t)=>{if(e[s])return e[s];const r=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#06B6D4"];return r[t%r.length]})(e,t),n=i>0?"".concat(e[a]/i*100,"%"):"0%",o="number"===typeof e[a]?e[a].toFixed(0):e[a];return(0,bt.jsxs)("div",{className:"flex items-center",children:[(0,bt.jsx)("div",{className:"w-24 text-sm text-gray-600 truncate",children:e.name}),(0,bt.jsx)("div",{className:"flex-1 mx-3",children:(0,bt.jsx)("div",{className:"bg-gray-200 rounded-full h-6 relative",children:(0,bt.jsx)("div",{className:"h-6 rounded-full flex items-center justify-end pr-2 text-white text-xs font-medium transition-all duration-300",style:{backgroundColor:r,width:n,minWidth:"40px"},children:o})})}),(0,bt.jsx)("div",{className:"w-16 text-sm text-gray-600 text-right font-medium",children:o})]},t)})})]})},h=e=>{let{data:t,title:r}=e;const a=t.reduce((e,t)=>e+t.count,0);let s=0;return(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold mb-4",children:r}),(0,bt.jsxs)("div",{className:"flex items-center justify-center",children:[(0,bt.jsxs)("div",{className:"relative",children:[(0,bt.jsx)("svg",{width:"150",height:"150",className:"transform -rotate-90",children:t.map((e,t)=>{const r=e.count/a*100/100*360,n=2*Math.PI*60,i=r/360*n,o="".concat(i," ").concat(n-i),l=-s;return s+=i,(0,bt.jsx)("circle",{cx:"75",cy:"75",r:"60",fill:"transparent",stroke:e.color,strokeWidth:"20",strokeDasharray:o,strokeDashoffset:l,className:"transition-all duration-500"},t)})}),(0,bt.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,bt.jsxs)("div",{className:"text-center",children:[(0,bt.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:a}),(0,bt.jsx)("div",{className:"text-xs text-gray-600",children:"Total"})]})})]}),(0,bt.jsx)("div",{className:"ml-6 space-y-2",children:t.map((e,t)=>(0,bt.jsxs)("div",{className:"flex items-center",children:[(0,bt.jsx)("div",{className:"w-3 h-3 rounded-full mr-2",style:{backgroundColor:e.color}}),(0,bt.jsxs)("div",{className:"text-sm text-gray-700",children:[e.name,": ",e.count," (",(e.count/a*100).toFixed(1),"%)"]})]},t))})]})]})},f=()=>{const e=t.slice().sort((e,t)=>new Date(e.startDate)-new Date(t.startDate)),r=new Date(Math.min(...t.map(e=>new Date(e.startDate)))),a=new Date(Math.max(...t.map(e=>new Date(e.endDate)))),s=(a-r)/864e5;return(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"\ud83d\udcc5 Timeline de Proyectos"}),(0,bt.jsxs)("div",{className:"space-y-4",children:[e.map((e,t)=>{const a=(new Date(e.startDate)-r)/864e5,n=(new Date(e.endDate)-new Date(e.startDate))/864e5,i=a/s*100,o=n/s*100;return(0,bt.jsx)("div",{className:"relative",children:(0,bt.jsxs)("div",{className:"flex items-center mb-1",children:[(0,bt.jsx)("div",{className:"w-32 text-sm font-medium text-gray-700 truncate",children:e.name}),(0,bt.jsx)("div",{className:"flex-1 mx-4 relative h-6 bg-gray-100 rounded",children:(0,bt.jsx)("div",{className:"absolute h-6 rounded flex items-center px-2 text-white text-xs font-medium",style:{backgroundColor:(e=>{switch(e){case"active":return"#3B82F6";case"completed":return"#10B981";case"on-hold":return"#F59E0B";case"cancelled":return"#EF4444";default:return"#6B7280"}})(e.status),left:"".concat(i,"%"),width:"".concat(Math.max(o,5),"%")},children:n>30&&e.name.substring(0,10)})}),(0,bt.jsxs)("div",{className:"w-24 text-xs text-gray-500",children:[Math.round(n)," d\xedas"]})]})},e.id)}),(0,bt.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-4 px-32",children:[(0,bt.jsx)("span",{children:r.toLocaleDateString()}),(0,bt.jsx)("span",{children:"Hoy"}),(0,bt.jsx)("span",{children:a.toLocaleDateString()})]})]})]})},m=()=>{const e=t.reduce((e,t)=>e+t.budget,0),r=t.reduce((e,t)=>e+t.contingencyReserve,0)+t.reduce((e,t)=>e+t.managementReserve,0);return(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"\ud83d\udcb0 M\xe9tricas Financieras Consolidadas"}),(0,bt.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,bt.jsxs)("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[(0,bt.jsxs)("div",{className:"text-2xl font-bold text-blue-600",children:["$",(e/1e3).toFixed(0),"K"]}),(0,bt.jsx)("div",{className:"text-sm text-blue-600",children:"Presupuesto Total"})]}),(0,bt.jsxs)("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[(0,bt.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:["$",(r/1e3).toFixed(0),"K"]}),(0,bt.jsx)("div",{className:"text-sm text-green-600",children:"Reservas Totales"})]})]}),(0,bt.jsxs)("div",{className:"space-y-3",children:[(0,bt.jsx)("div",{className:"flex items-center justify-between",children:(0,bt.jsx)("span",{className:"text-sm font-medium",children:"Distribuci\xf3n del Presupuesto:"})}),t.map((t,r)=>{const a=t.budget/e*100;return(0,bt.jsxs)("div",{className:"flex items-center",children:[(0,bt.jsx)("div",{className:"w-24 text-sm text-gray-600 truncate",children:t.name}),(0,bt.jsx)("div",{className:"flex-1 mx-3",children:(0,bt.jsx)("div",{className:"bg-gray-200 rounded-full h-4 relative",children:(0,bt.jsxs)("div",{className:"h-4 bg-blue-500 rounded-full flex items-center justify-end pr-2 text-white text-xs",style:{width:"".concat(a,"%"),minWidth:"40px"},children:[a.toFixed(1),"%"]})})}),(0,bt.jsxs)("div",{className:"w-16 text-sm text-gray-600 text-right",children:["$",(t.budget/1e3).toFixed(0),"K"]})]},t.id)})]})]})};return(0,bt.jsxs)("div",{className:"space-y-6",children:[(0,bt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.length>0&&(0,bt.jsx)(h,{data:n,title:"\ud83d\udcca Distribuci\xf3n por Estado"}),i.length>0&&(0,bt.jsx)(h,{data:i,title:"\u26a1 Distribuci\xf3n por Prioridad"})]}),o.length>0&&(0,bt.jsx)(u,{data:o,title:"\ud83d\udcb0 Presupuesto por Proyecto (K$)",valueKey:"budget",colorKey:"color"}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[l.length>0&&(0,bt.jsx)(h,{data:l,title:"\ud83d\udccb Estado de Work Packages"}),d.length>0&&(0,bt.jsx)(h,{data:d,title:"\u26a0\ufe0f Estado de Riesgos"})]}),c.length>0&&(0,bt.jsx)(u,{data:c,title:"\ud83c\udfaf Prioridad de Riesgos",valueKey:"count"}),(0,bt.jsx)(f,{}),(0,bt.jsx)(m,{})]})},Tt=e=>{let{projects:t,portfolioMetrics:r={}}=e;const a=t.filter(e=>{const t=new Date(e.endDate)<new Date&&"completed"!==e.status,r="high"===e.priority;return t||r&&"active"===e.status}),s=t.filter(e=>!(null===r||void 0===r||!r.totalBudget||r.totalBudget<=0)&&e.budget>.3*r.totalBudget),n=t.filter(e=>{const t=(new Date(e.endDate)-new Date)/864e5;return t>0&&t<=30&&"active"===e.status}),i=[];a.length>0&&i.push({type:"critical",title:"Proyectos Cr\xedticos",message:"".concat(a.length," proyecto(s) requieren atenci\xf3n inmediata"),details:a.map(e=>e.name),icon:"\ud83d\udea8",color:"red"}),s.length>0&&i.push({type:"budget",title:"Concentraci\xf3n de Presupuesto",message:"".concat(s.length," proyecto(s) concentran >30% del presupuesto total"),details:s.map(e=>"".concat(e.name,": $").concat((e.budget/1e3).toFixed(0),"K")),icon:"\ud83d\udcb0",color:"yellow"}),n.length>0&&i.push({type:"deadline",title:"Deadlines Pr\xf3ximos",message:"".concat(n.length," proyecto(s) terminan en los pr\xf3ximos 30 d\xedas"),details:n.map(e=>{const t=Math.ceil((new Date(e.endDate)-new Date)/864e5);return"".concat(e.name,": ").concat(t," d\xedas")}),icon:"\u23f0",color:"blue"}),(null===r||void 0===r?void 0:r.activeProjects)>5&&i.push({type:"capacity",title:"Alta Carga de Proyectos",message:"".concat(r.activeProjects," proyectos activos pueden sobrecargar recursos"),details:["Considerar priorizaci\xf3n de proyectos","Evaluar capacidad de recursos"],icon:"\u26a1",color:"purple"}),(null===r||void 0===r?void 0:r.completedProjects)>0&&0===a.length&&i.push({type:"success",title:"Portfolio Saludable",message:"".concat(r.completedProjects," proyecto(s) completado(s) sin alertas cr\xedticas"),details:["Excelente gesti\xf3n del portfolio","Continuar con las mejores pr\xe1cticas"],icon:"\u2705",color:"green"});const o=e=>{switch(e){case"red":return"bg-red-50 border-red-500 text-red-700";case"yellow":return"bg-yellow-50 border-yellow-500 text-yellow-700";case"blue":return"bg-blue-50 border-blue-500 text-blue-700";case"purple":return"bg-purple-50 border-purple-500 text-purple-700";case"green":return"bg-green-50 border-green-500 text-green-700";default:return"bg-gray-50 border-gray-500 text-gray-700"}},l=e=>{switch(e){case"red":return"text-red-500";case"yellow":return"text-yellow-500";case"blue":return"text-blue-500";case"purple":return"text-purple-500";case"green":return"text-green-500";default:return"text-gray-500"}};return 0===i.length?(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"\ud83d\udd14 Alertas Corporativas"}),(0,bt.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,bt.jsx)("div",{className:"text-4xl mb-2",children:"\u2705"}),(0,bt.jsx)("div",{children:"No hay alertas activas"}),(0,bt.jsx)("div",{className:"text-sm mt-1",children:"El portfolio est\xe1 funcionando correctamente"})]})]}):(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,bt.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:["\ud83d\udd14 Alertas Corporativas",(0,bt.jsx)("span",{className:"ml-2 bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:i.filter(e=>"critical"===e.type).length})]}),(0,bt.jsx)("div",{className:"space-y-4",children:i.map((e,t)=>(0,bt.jsx)("div",{className:"border-l-4 p-4 rounded-lg ".concat(o(e.color)),children:(0,bt.jsxs)("div",{className:"flex items-start",children:[(0,bt.jsx)("span",{className:"text-xl mr-3 ".concat(l(e.color)),children:e.icon}),(0,bt.jsxs)("div",{className:"flex-1",children:[(0,bt.jsx)("div",{className:"font-semibold mb-1",children:e.title}),(0,bt.jsx)("div",{className:"text-sm mb-2",children:e.message}),e.details&&e.details.length>0&&(0,bt.jsx)("div",{className:"text-xs space-y-1",children:e.details.map((e,t)=>(0,bt.jsxs)("div",{className:"flex items-center",children:[(0,bt.jsx)("span",{className:"w-2 h-2 bg-current rounded-full mr-2 opacity-50"}),e]},t))})]})]})},t))}),(0,bt.jsx)("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,bt.jsx)("span",{className:"font-medium text-gray-700",children:"Resumen de Alertas:"}),(0,bt.jsxs)("div",{className:"flex space-x-4",children:[(0,bt.jsxs)("span",{className:"text-red-600",children:["\ud83d\udea8 ",i.filter(e=>"critical"===e.type).length," Cr\xedticas"]}),(0,bt.jsxs)("span",{className:"text-yellow-600",children:["\u26a0\ufe0f ",i.filter(e=>"yellow"===e.color).length," Advertencias"]}),(0,bt.jsxs)("span",{className:"text-blue-600",children:["\u2139\ufe0f ",i.filter(e=>"blue"===e.color).length," Informativas"]})]})]})})]})};var _t=r(705);function Ct(e){return e+.5|0}const At=(e,t,r)=>Math.max(Math.min(e,r),t);function Dt(e){return At(Ct(2.55*e),0,255)}function Pt(e){return At(Ct(255*e),0,255)}function It(e){return At(Ct(e/2.55)/100,0,1)}function Ot(e){return At(Ct(100*e),0,100)}const Rt={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Mt=[..."0123456789ABCDEF"],Ft=e=>Mt[15&e],Lt=e=>Mt[(240&e)>>4]+Mt[15&e],zt=e=>(240&e)>>4===(15&e);function Bt(e){var t=(e=>zt(e.r)&&zt(e.g)&&zt(e.b)&&zt(e.a))(e)?Ft:Lt;return e?"#"+t(e.r)+t(e.g)+t(e.b)+((e,t)=>e<255?t(e):"")(e.a,t):void 0}const Ut=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Wt(e,t,r){const a=t*Math.min(r,1-r),s=function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(t+e/30)%12;return r-a*Math.max(Math.min(s-3,9-s,1),-1)};return[s(0),s(8),s(4)]}function Ht(e,t,r){const a=function(a){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(a+e/60)%6;return r-r*t*Math.max(Math.min(s,4-s,1),0)};return[a(5),a(3),a(1)]}function Vt(e,t,r){const a=Wt(e,1,.5);let s;for(t+r>1&&(s=1/(t+r),t*=s,r*=s),s=0;s<3;s++)a[s]*=1-t-r,a[s]+=t;return a}function Gt(e){const t=e.r/255,r=e.g/255,a=e.b/255,s=Math.max(t,r,a),n=Math.min(t,r,a),i=(s+n)/2;let o,l,c;return s!==n&&(c=s-n,l=i>.5?c/(2-s-n):c/(s+n),o=function(e,t,r,a,s){return e===s?(t-r)/a+(t<r?6:0):t===s?(r-e)/a+2:(e-t)/a+4}(t,r,a,c,s),o=60*o+.5),[0|o,l||0,i]}function qt(e,t,r,a){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,r,a)).map(Pt)}function $t(e,t,r){return qt(Wt,e,t,r)}function Kt(e){return(e%360+360)%360}function Yt(e){const t=Ut.exec(e);let r,a=255;if(!t)return;t[5]!==r&&(a=t[6]?Dt(+t[5]):Pt(+t[5]));const s=Kt(+t[2]),n=+t[3]/100,i=+t[4]/100;return r="hwb"===t[1]?function(e,t,r){return qt(Vt,e,t,r)}(s,n,i):"hsv"===t[1]?function(e,t,r){return qt(Ht,e,t,r)}(s,n,i):$t(s,n,i),{r:r[0],g:r[1],b:r[2],a:a}}const Jt={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},Xt={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};let Qt;function Zt(e){Qt||(Qt=function(){const e={},t=Object.keys(Xt),r=Object.keys(Jt);let a,s,n,i,o;for(a=0;a<t.length;a++){for(i=o=t[a],s=0;s<r.length;s++)n=r[s],o=o.replace(n,Jt[n]);n=parseInt(Xt[i],16),e[o]=[n>>16&255,n>>8&255,255&n]}return e}(),Qt.transparent=[0,0,0,0]);const t=Qt[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:4===t.length?t[3]:255}}const er=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;const tr=e=>e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055,rr=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function ar(e,t,r){if(e){let a=Gt(e);a[t]=Math.max(0,Math.min(a[t]+a[t]*r,0===t?360:1)),a=$t(a),e.r=a[0],e.g=a[1],e.b=a[2]}}function sr(e,t){return e?Object.assign(t||{},e):e}function nr(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=Pt(e[3]))):(t=sr(e,{r:0,g:0,b:0,a:1})).a=Pt(t.a),t}function ir(e){return"r"===e.charAt(0)?function(e){const t=er.exec(e);let r,a,s,n=255;if(t){if(t[7]!==r){const e=+t[7];n=t[8]?Dt(e):At(255*e,0,255)}return r=+t[1],a=+t[3],s=+t[5],r=255&(t[2]?Dt(r):At(r,0,255)),a=255&(t[4]?Dt(a):At(a,0,255)),s=255&(t[6]?Dt(s):At(s,0,255)),{r:r,g:a,b:s,a:n}}}(e):Yt(e)}class or{constructor(e){if(e instanceof or)return e;const t=typeof e;let r;"object"===t?r=nr(e):"string"===t&&(r=function(e){var t,r=e.length;return"#"===e[0]&&(4===r||5===r?t={r:255&17*Rt[e[1]],g:255&17*Rt[e[2]],b:255&17*Rt[e[3]],a:5===r?17*Rt[e[4]]:255}:7!==r&&9!==r||(t={r:Rt[e[1]]<<4|Rt[e[2]],g:Rt[e[3]]<<4|Rt[e[4]],b:Rt[e[5]]<<4|Rt[e[6]],a:9===r?Rt[e[7]]<<4|Rt[e[8]]:255})),t}(e)||Zt(e)||ir(e)),this._rgb=r,this._valid=!!r}get valid(){return this._valid}get rgb(){var e=sr(this._rgb);return e&&(e.a=It(e.a)),e}set rgb(e){this._rgb=nr(e)}rgbString(){return this._valid?(e=this._rgb)&&(e.a<255?"rgba(".concat(e.r,", ").concat(e.g,", ").concat(e.b,", ").concat(It(e.a),")"):"rgb(".concat(e.r,", ").concat(e.g,", ").concat(e.b,")")):void 0;var e}hexString(){return this._valid?Bt(this._rgb):void 0}hslString(){return this._valid?function(e){if(!e)return;const t=Gt(e),r=t[0],a=Ot(t[1]),s=Ot(t[2]);return e.a<255?"hsla(".concat(r,", ").concat(a,"%, ").concat(s,"%, ").concat(It(e.a),")"):"hsl(".concat(r,", ").concat(a,"%, ").concat(s,"%)")}(this._rgb):void 0}mix(e,t){if(e){const r=this.rgb,a=e.rgb;let s;const n=t===s?.5:t,i=2*n-1,o=r.a-a.a,l=((i*o===-1?i:(i+o)/(1+i*o))+1)/2;s=1-l,r.r=255&l*r.r+s*a.r+.5,r.g=255&l*r.g+s*a.g+.5,r.b=255&l*r.b+s*a.b+.5,r.a=n*r.a+(1-n)*a.a,this.rgb=r}return this}interpolate(e,t){return e&&(this._rgb=function(e,t,r){const a=rr(It(e.r)),s=rr(It(e.g)),n=rr(It(e.b));return{r:Pt(tr(a+r*(rr(It(t.r))-a))),g:Pt(tr(s+r*(rr(It(t.g))-s))),b:Pt(tr(n+r*(rr(It(t.b))-n))),a:e.a+r*(t.a-e.a)}}(this._rgb,e._rgb,t)),this}clone(){return new or(this.rgb)}alpha(e){return this._rgb.a=Pt(e),this}clearer(e){return this._rgb.a*=1-e,this}greyscale(){const e=this._rgb,t=Ct(.3*e.r+.59*e.g+.11*e.b);return e.r=e.g=e.b=t,this}opaquer(e){return this._rgb.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return ar(this._rgb,2,e),this}darken(e){return ar(this._rgb,2,-e),this}saturate(e){return ar(this._rgb,1,e),this}desaturate(e){return ar(this._rgb,1,-e),this}rotate(e){return function(e,t){var r=Gt(e);r[0]=Kt(r[0]+t),r=$t(r),e.r=r[0],e.g=r[1],e.b=r[2]}(this._rgb,e),this}}function lr(){}const cr=(()=>{let e=0;return()=>e++})();function dr(e){return null===e||void 0===e}function ur(e){if(Array.isArray&&Array.isArray(e))return!0;const t=Object.prototype.toString.call(e);return"[object"===t.slice(0,7)&&"Array]"===t.slice(-6)}function hr(e){return null!==e&&"[object Object]"===Object.prototype.toString.call(e)}function fr(e){return("number"===typeof e||e instanceof Number)&&isFinite(+e)}function mr(e,t){return fr(e)?e:t}function pr(e,t){return"undefined"===typeof e?t:e}const gr=(e,t)=>"string"===typeof e&&e.endsWith("%")?parseFloat(e)/100*t:+e;function xr(e,t,r){if(e&&"function"===typeof e.call)return e.apply(r,t)}function br(e,t,r,a){let s,n,i;if(ur(e))if(n=e.length,a)for(s=n-1;s>=0;s--)t.call(r,e[s],s);else for(s=0;s<n;s++)t.call(r,e[s],s);else if(hr(e))for(i=Object.keys(e),n=i.length,s=0;s<n;s++)t.call(r,e[i[s]],i[s])}function vr(e,t){let r,a,s,n;if(!e||!t||e.length!==t.length)return!1;for(r=0,a=e.length;r<a;++r)if(s=e[r],n=t[r],s.datasetIndex!==n.datasetIndex||s.index!==n.index)return!1;return!0}function yr(e){if(ur(e))return e.map(yr);if(hr(e)){const t=Object.create(null),r=Object.keys(e),a=r.length;let s=0;for(;s<a;++s)t[r[s]]=yr(e[r[s]]);return t}return e}function wr(e){return-1===["__proto__","prototype","constructor"].indexOf(e)}function jr(e,t,r,a){if(!wr(e))return;const s=t[e],n=r[e];hr(s)&&hr(n)?Nr(s,n,a):t[e]=yr(n)}function Nr(e,t,r){const a=ur(t)?t:[t],s=a.length;if(!hr(e))return e;const n=(r=r||{}).merger||jr;let i;for(let o=0;o<s;++o){if(i=a[o],!hr(i))continue;const t=Object.keys(i);for(let a=0,s=t.length;a<s;++a)n(t[a],e,i,r)}return e}function kr(e,t){return Nr(e,t,{merger:Sr})}function Sr(e,t,r){if(!wr(e))return;const a=t[e],s=r[e];hr(a)&&hr(s)?kr(a,s):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=yr(s))}const Er={"":e=>e,x:e=>e.x,y:e=>e.y};function Tr(e,t){const r=Er[t]||(Er[t]=function(e){const t=function(e){const t=e.split("."),r=[];let a="";for(const s of t)a+=s,a.endsWith("\\")?a=a.slice(0,-1)+".":(r.push(a),a="");return r}(e);return e=>{for(const r of t){if(""===r)break;e=e&&e[r]}return e}}(t));return r(e)}function _r(e){return e.charAt(0).toUpperCase()+e.slice(1)}const Cr=e=>"undefined"!==typeof e,Ar=e=>"function"===typeof e,Dr=(e,t)=>{if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0};const Pr=Math.PI,Ir=2*Pr,Or=Ir+Pr,Rr=Number.POSITIVE_INFINITY,Mr=Pr/180,Fr=Pr/2,Lr=Pr/4,zr=2*Pr/3,Br=Math.log10,Ur=Math.sign;function Wr(e,t,r){return Math.abs(e-t)<r}function Hr(e){const t=Math.round(e);e=Wr(e,t,e/1e3)?t:e;const r=Math.pow(10,Math.floor(Br(e))),a=e/r;return(a<=1?1:a<=2?2:a<=5?5:10)*r}function Vr(e){return!function(e){return"symbol"===typeof e||"object"===typeof e&&null!==e&&!(Symbol.toPrimitive in e||"toString"in e||"valueOf"in e)}(e)&&!isNaN(parseFloat(e))&&isFinite(e)}function Gr(e,t,r){let a,s,n;for(a=0,s=e.length;a<s;a++)n=e[a][r],isNaN(n)||(t.min=Math.min(t.min,n),t.max=Math.max(t.max,n))}function qr(e){return e*(Pr/180)}function $r(e){return e*(180/Pr)}function Kr(e){if(!fr(e))return;let t=1,r=0;for(;Math.round(e*t)/t!==e;)t*=10,r++;return r}function Yr(e,t){const r=t.x-e.x,a=t.y-e.y,s=Math.sqrt(r*r+a*a);let n=Math.atan2(a,r);return n<-.5*Pr&&(n+=Ir),{angle:n,distance:s}}function Jr(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function Xr(e,t){return(e-t+Or)%Ir-Pr}function Qr(e){return(e%Ir+Ir)%Ir}function Zr(e,t,r,a){const s=Qr(e),n=Qr(t),i=Qr(r),o=Qr(n-s),l=Qr(i-s),c=Qr(s-n),d=Qr(s-i);return s===n||s===i||a&&n===i||o>l&&c<d}function ea(e,t,r){return Math.max(t,Math.min(r,e))}function ta(e,t,r){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-6;return e>=Math.min(t,r)-a&&e<=Math.max(t,r)+a}function ra(e,t,r){r=r||(r=>e[r]<t);let a,s=e.length-1,n=0;for(;s-n>1;)a=n+s>>1,r(a)?n=a:s=a;return{lo:n,hi:s}}const aa=(e,t,r,a)=>ra(e,r,a?a=>{const s=e[a][t];return s<r||s===r&&e[a+1][t]===r}:a=>e[a][t]<r),sa=(e,t,r)=>ra(e,r,a=>e[a][t]>=r);const na=["push","pop","shift","splice","unshift"];function ia(e,t){const r=e._chartjs;if(!r)return;const a=r.listeners,s=a.indexOf(t);-1!==s&&a.splice(s,1),a.length>0||(na.forEach(t=>{delete e[t]}),delete e._chartjs)}function oa(e){const t=new Set(e);return t.size===e.length?e:Array.from(t)}const la="undefined"===typeof window?function(e){return e()}:window.requestAnimationFrame;function ca(e,t){let r=[],a=!1;return function(){for(var s=arguments.length,n=new Array(s),i=0;i<s;i++)n[i]=arguments[i];r=n,a||(a=!0,la.call(window,()=>{a=!1,e.apply(t,r)}))}}const da=e=>"start"===e?"left":"end"===e?"right":"center",ua=(e,t,r)=>"start"===e?t:"end"===e?r:(t+r)/2;function ha(e,t,r){const a=t.length;let s=0,n=a;if(e._sorted){const{iScale:i,vScale:o,_parsed:l}=e,c=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null,d=i.axis,{min:u,max:h,minDefined:f,maxDefined:m}=i.getUserBounds();if(f){if(s=Math.min(aa(l,d,u).lo,r?a:aa(t,d,i.getPixelForValue(u)).lo),c){const e=l.slice(0,s+1).reverse().findIndex(e=>!dr(e[o.axis]));s-=Math.max(0,e)}s=ea(s,0,a-1)}if(m){let e=Math.max(aa(l,i.axis,h,!0).hi+1,r?0:aa(t,d,i.getPixelForValue(h),!0).hi+1);if(c){const t=l.slice(e-1).findIndex(e=>!dr(e[o.axis]));e+=Math.max(0,t)}n=ea(e,s,a)-s}else n=a-s}return{start:s,count:n}}function fa(e){const{xScale:t,yScale:r,_scaleRanges:a}=e,s={xmin:t.min,xmax:t.max,ymin:r.min,ymax:r.max};if(!a)return e._scaleRanges=s,!0;const n=a.xmin!==t.min||a.xmax!==t.max||a.ymin!==r.min||a.ymax!==r.max;return Object.assign(a,s),n}const ma=e=>0===e||1===e,pa=(e,t,r)=>-Math.pow(2,10*(e-=1))*Math.sin((e-t)*Ir/r),ga=(e,t,r)=>Math.pow(2,-10*e)*Math.sin((e-t)*Ir/r)+1,xa={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>1-Math.cos(e*Fr),easeOutSine:e=>Math.sin(e*Fr),easeInOutSine:e=>-.5*(Math.cos(Pr*e)-1),easeInExpo:e=>0===e?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>1===e?1:1-Math.pow(2,-10*e),easeInOutExpo:e=>ma(e)?e:e<.5?.5*Math.pow(2,10*(2*e-1)):.5*(2-Math.pow(2,-10*(2*e-1))),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>ma(e)?e:pa(e,.075,.3),easeOutElastic:e=>ma(e)?e:ga(e,.075,.3),easeInOutElastic(e){const t=.1125;return ma(e)?e:e<.5?.5*pa(2*e,t,.45):.5+.5*ga(2*e-1,t,.45)},easeInBack(e){const t=1.70158;return e*e*((t+1)*e-t)},easeOutBack(e){const t=1.70158;return(e-=1)*e*((t+1)*e+t)+1},easeInOutBack(e){let t=1.70158;return(e/=.5)<1?e*e*((1+(t*=1.525))*e-t)*.5:.5*((e-=2)*e*((1+(t*=1.525))*e+t)+2)},easeInBounce:e=>1-xa.easeOutBounce(1-e),easeOutBounce(e){const t=7.5625,r=2.75;return e<1/r?t*e*e:e<2/r?t*(e-=1.5/r)*e+.75:e<2.5/r?t*(e-=2.25/r)*e+.9375:t*(e-=2.625/r)*e+.984375},easeInOutBounce:e=>e<.5?.5*xa.easeInBounce(2*e):.5*xa.easeOutBounce(2*e-1)+.5};function ba(e){if(e&&"object"===typeof e){const t=e.toString();return"[object CanvasPattern]"===t||"[object CanvasGradient]"===t}return!1}function va(e){return ba(e)?e:new or(e)}function ya(e){return ba(e)?e:new or(e).saturate(.5).darken(.1).hexString()}const wa=["x","y","borderWidth","radius","tension"],ja=["color","borderColor","backgroundColor"];const Na=new Map;function ka(e,t,r){return function(e,t){t=t||{};const r=e+JSON.stringify(t);let a=Na.get(r);return a||(a=new Intl.NumberFormat(e,t),Na.set(r,a)),a}(t,r).format(e)}const Sa={values:e=>ur(e)?e:""+e,numeric(e,t,r){if(0===e)return"0";const a=this.chart.options.locale;let s,n=e;if(r.length>1){const t=Math.max(Math.abs(r[0].value),Math.abs(r[r.length-1].value));(t<1e-4||t>1e15)&&(s="scientific"),n=function(e,t){let r=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;Math.abs(r)>=1&&e!==Math.floor(e)&&(r=e-Math.floor(e));return r}(e,r)}const i=Br(Math.abs(n)),o=isNaN(i)?1:Math.max(Math.min(-1*Math.floor(i),20),0),l={notation:s,minimumFractionDigits:o,maximumFractionDigits:o};return Object.assign(l,this.options.ticks.format),ka(e,a,l)},logarithmic(e,t,r){if(0===e)return"0";const a=r[t].significand||e/Math.pow(10,Math.floor(Br(e)));return[1,2,3,5,10,15].includes(a)||t>.8*r.length?Sa.numeric.call(this,e,t,r):""}};var Ea={formatters:Sa};const Ta=Object.create(null),_a=Object.create(null);function Ca(e,t){if(!t)return e;const r=t.split(".");for(let a=0,s=r.length;a<s;++a){const t=r[a];e=e[t]||(e[t]=Object.create(null))}return e}function Aa(e,t,r){return"string"===typeof t?Nr(Ca(e,t),r):Nr(Ca(e,""),t)}class Da{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=e=>e.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(e,t)=>ya(t.backgroundColor),this.hoverBorderColor=(e,t)=>ya(t.borderColor),this.hoverColor=(e,t)=>ya(t.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return Aa(this,e,t)}get(e){return Ca(this,e)}describe(e,t){return Aa(_a,e,t)}override(e,t){return Aa(Ta,e,t)}route(e,t,r,a){const s=Ca(this,e),n=Ca(this,r),i="_"+t;Object.defineProperties(s,{[i]:{value:s[t],writable:!0},[t]:{enumerable:!0,get(){const e=this[i],t=n[a];return hr(e)?Object.assign({},t,e):pr(e,t)},set(e){this[i]=e}}})}apply(e){e.forEach(e=>e(this))}}var Pa=new Da({_scriptable:e=>!e.startsWith("on"),_indexable:e=>"events"!==e,hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[function(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>"onProgress"!==e&&"onComplete"!==e&&"fn"!==e}),e.set("animations",{colors:{type:"color",properties:ja},numbers:{type:"number",properties:wa}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>0|e}}}})},function(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})},function(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Ea.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&"callback"!==e&&"parser"!==e,_indexable:e=>"borderDash"!==e&&"tickBorderDash"!==e&&"dash"!==e}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:e=>"backdropPadding"!==e&&"callback"!==e,_indexable:e=>"backdropPadding"!==e})}]);function Ia(e,t,r,a,s){let n=t[s];return n||(n=t[s]=e.measureText(s).width,r.push(s)),n>a&&(a=n),a}function Oa(e,t,r,a){let s=(a=a||{}).data=a.data||{},n=a.garbageCollect=a.garbageCollect||[];a.font!==t&&(s=a.data={},n=a.garbageCollect=[],a.font=t),e.save(),e.font=t;let i=0;const o=r.length;let l,c,d,u,h;for(l=0;l<o;l++)if(u=r[l],void 0===u||null===u||ur(u)){if(ur(u))for(c=0,d=u.length;c<d;c++)h=u[c],void 0===h||null===h||ur(h)||(i=Ia(e,s,n,i,h))}else i=Ia(e,s,n,i,u);e.restore();const f=n.length/2;if(f>r.length){for(l=0;l<f;l++)delete s[n[l]];n.splice(0,f)}return i}function Ra(e,t,r){const a=e.currentDevicePixelRatio,s=0!==r?Math.max(r/2,.5):0;return Math.round((t-s)*a)/a+s}function Ma(e,t){(t||e)&&((t=t||e.getContext("2d")).save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore())}function Fa(e,t,r,a){La(e,t,r,a,null)}function La(e,t,r,a,s){let n,i,o,l,c,d,u,h;const f=t.pointStyle,m=t.rotation,p=t.radius;let g=(m||0)*Mr;if(f&&"object"===typeof f&&(n=f.toString(),"[object HTMLImageElement]"===n||"[object HTMLCanvasElement]"===n))return e.save(),e.translate(r,a),e.rotate(g),e.drawImage(f,-f.width/2,-f.height/2,f.width,f.height),void e.restore();if(!(isNaN(p)||p<=0)){switch(e.beginPath(),f){default:s?e.ellipse(r,a,s/2,p,0,0,Ir):e.arc(r,a,p,0,Ir),e.closePath();break;case"triangle":d=s?s/2:p,e.moveTo(r+Math.sin(g)*d,a-Math.cos(g)*p),g+=zr,e.lineTo(r+Math.sin(g)*d,a-Math.cos(g)*p),g+=zr,e.lineTo(r+Math.sin(g)*d,a-Math.cos(g)*p),e.closePath();break;case"rectRounded":c=.516*p,l=p-c,i=Math.cos(g+Lr)*l,u=Math.cos(g+Lr)*(s?s/2-c:l),o=Math.sin(g+Lr)*l,h=Math.sin(g+Lr)*(s?s/2-c:l),e.arc(r-u,a-o,c,g-Pr,g-Fr),e.arc(r+h,a-i,c,g-Fr,g),e.arc(r+u,a+o,c,g,g+Fr),e.arc(r-h,a+i,c,g+Fr,g+Pr),e.closePath();break;case"rect":if(!m){l=Math.SQRT1_2*p,d=s?s/2:l,e.rect(r-d,a-l,2*d,2*l);break}g+=Lr;case"rectRot":u=Math.cos(g)*(s?s/2:p),i=Math.cos(g)*p,o=Math.sin(g)*p,h=Math.sin(g)*(s?s/2:p),e.moveTo(r-u,a-o),e.lineTo(r+h,a-i),e.lineTo(r+u,a+o),e.lineTo(r-h,a+i),e.closePath();break;case"crossRot":g+=Lr;case"cross":u=Math.cos(g)*(s?s/2:p),i=Math.cos(g)*p,o=Math.sin(g)*p,h=Math.sin(g)*(s?s/2:p),e.moveTo(r-u,a-o),e.lineTo(r+u,a+o),e.moveTo(r+h,a-i),e.lineTo(r-h,a+i);break;case"star":u=Math.cos(g)*(s?s/2:p),i=Math.cos(g)*p,o=Math.sin(g)*p,h=Math.sin(g)*(s?s/2:p),e.moveTo(r-u,a-o),e.lineTo(r+u,a+o),e.moveTo(r+h,a-i),e.lineTo(r-h,a+i),g+=Lr,u=Math.cos(g)*(s?s/2:p),i=Math.cos(g)*p,o=Math.sin(g)*p,h=Math.sin(g)*(s?s/2:p),e.moveTo(r-u,a-o),e.lineTo(r+u,a+o),e.moveTo(r+h,a-i),e.lineTo(r-h,a+i);break;case"line":i=s?s/2:Math.cos(g)*p,o=Math.sin(g)*p,e.moveTo(r-i,a-o),e.lineTo(r+i,a+o);break;case"dash":e.moveTo(r,a),e.lineTo(r+Math.cos(g)*(s?s/2:p),a+Math.sin(g)*p);break;case!1:e.closePath()}e.fill(),t.borderWidth>0&&e.stroke()}}function za(e,t,r){return r=r||.5,!t||e&&e.x>t.left-r&&e.x<t.right+r&&e.y>t.top-r&&e.y<t.bottom+r}function Ba(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function Ua(e){e.restore()}function Wa(e,t,r,a,s){if(!t)return e.lineTo(r.x,r.y);if("middle"===s){const a=(t.x+r.x)/2;e.lineTo(a,t.y),e.lineTo(a,r.y)}else"after"===s!==!!a?e.lineTo(t.x,r.y):e.lineTo(r.x,t.y);e.lineTo(r.x,r.y)}function Ha(e,t,r,a){if(!t)return e.lineTo(r.x,r.y);e.bezierCurveTo(a?t.cp1x:t.cp2x,a?t.cp1y:t.cp2y,a?r.cp2x:r.cp1x,a?r.cp2y:r.cp1y,r.x,r.y)}function Va(e,t,r,a,s){if(s.strikethrough||s.underline){const n=e.measureText(a),i=t-n.actualBoundingBoxLeft,o=t+n.actualBoundingBoxRight,l=r-n.actualBoundingBoxAscent,c=r+n.actualBoundingBoxDescent,d=s.strikethrough?(l+c)/2:c;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=s.decorationWidth||2,e.moveTo(i,d),e.lineTo(o,d),e.stroke()}}function Ga(e,t){const r=e.fillStyle;e.fillStyle=t.color,e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle=r}function qa(e,t,r,a,s){let n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const i=ur(t)?t:[t],o=n.strokeWidth>0&&""!==n.strokeColor;let l,c;for(e.save(),e.font=s.string,function(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]),dr(t.rotation)||e.rotate(t.rotation),t.color&&(e.fillStyle=t.color),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline)}(e,n),l=0;l<i.length;++l)c=i[l],n.backdrop&&Ga(e,n.backdrop),o&&(n.strokeColor&&(e.strokeStyle=n.strokeColor),dr(n.strokeWidth)||(e.lineWidth=n.strokeWidth),e.strokeText(c,r,a,n.maxWidth)),e.fillText(c,r,a,n.maxWidth),Va(e,r,a,c,n),a+=Number(s.lineHeight);e.restore()}function $a(e,t){const{x:r,y:a,w:s,h:n,radius:i}=t;e.arc(r+i.topLeft,a+i.topLeft,i.topLeft,1.5*Pr,Pr,!0),e.lineTo(r,a+n-i.bottomLeft),e.arc(r+i.bottomLeft,a+n-i.bottomLeft,i.bottomLeft,Pr,Fr,!0),e.lineTo(r+s-i.bottomRight,a+n),e.arc(r+s-i.bottomRight,a+n-i.bottomRight,i.bottomRight,Fr,0,!0),e.lineTo(r+s,a+i.topRight),e.arc(r+s-i.topRight,a+i.topRight,i.topRight,0,-Fr,!0),e.lineTo(r+i.topLeft,a)}const Ka=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,Ya=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function Ja(e,t){const r=(""+e).match(Ka);if(!r||"normal"===r[1])return 1.2*t;switch(e=+r[2],r[3]){case"px":return e;case"%":e/=100}return t*e}const Xa=e=>+e||0;function Qa(e,t){const r={},a=hr(t),s=a?Object.keys(t):t,n=hr(e)?a?r=>pr(e[r],e[t[r]]):t=>e[t]:()=>e;for(const i of s)r[i]=Xa(n(i));return r}function Za(e){return Qa(e,{top:"y",right:"x",bottom:"y",left:"x"})}function es(e){return Qa(e,["topLeft","topRight","bottomLeft","bottomRight"])}function ts(e){const t=Za(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function rs(e,t){e=e||{},t=t||Pa.font;let r=pr(e.size,t.size);"string"===typeof r&&(r=parseInt(r,10));let a=pr(e.style,t.style);a&&!(""+a).match(Ya)&&(console.warn('Invalid font style specified: "'+a+'"'),a=void 0);const s={family:pr(e.family,t.family),lineHeight:Ja(pr(e.lineHeight,t.lineHeight),r),size:r,style:a,weight:pr(e.weight,t.weight),string:""};return s.string=function(e){return!e||dr(e.size)||dr(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}(s),s}function as(e,t,r,a){let s,n,i,o=!0;for(s=0,n=e.length;s<n;++s)if(i=e[s],void 0!==i&&(void 0!==t&&"function"===typeof i&&(i=i(t),o=!1),void 0!==r&&ur(i)&&(i=i[r%i.length],o=!1),void 0!==i))return a&&!o&&(a.cacheable=!1),i}function ss(e,t){return Object.assign(Object.create(e),t)}function ns(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[""],r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:()=>e[0];const s=(arguments.length>2?arguments[2]:void 0)||e;"undefined"===typeof r&&(r=gs("_fallback",e));const n={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:e,_rootScopes:s,_fallback:r,_getTarget:a,override:a=>ns([a,...e],t,s,r)};return new Proxy(n,{deleteProperty:(t,r)=>(delete t[r],delete t._keys,delete e[0][r],!0),get:(r,a)=>ds(r,a,()=>function(e,t,r,a){let s;for(const n of t)if(s=gs(ls(n,e),r),"undefined"!==typeof s)return cs(e,s)?ms(r,a,e,s):s}(a,t,e,r)),getOwnPropertyDescriptor:(e,t)=>Reflect.getOwnPropertyDescriptor(e._scopes[0],t),getPrototypeOf:()=>Reflect.getPrototypeOf(e[0]),has:(e,t)=>xs(e).includes(t),ownKeys:e=>xs(e),set(e,t,r){const s=e._storage||(e._storage=a());return e[t]=s[t]=r,delete e._keys,!0}})}function is(e,t,r,a){const s={_cacheable:!1,_proxy:e,_context:t,_subProxy:r,_stack:new Set,_descriptors:os(e,a),setContext:t=>is(e,t,r,a),override:s=>is(e.override(s),t,r,a)};return new Proxy(s,{deleteProperty:(t,r)=>(delete t[r],delete e[r],!0),get:(e,t,r)=>ds(e,t,()=>function(e,t,r){const{_proxy:a,_context:s,_subProxy:n,_descriptors:i}=e;let o=a[t];Ar(o)&&i.isScriptable(t)&&(o=function(e,t,r,a){const{_proxy:s,_context:n,_subProxy:i,_stack:o}=r;if(o.has(e))throw new Error("Recursion detected: "+Array.from(o).join("->")+"->"+e);o.add(e);let l=t(n,i||a);o.delete(e),cs(e,l)&&(l=ms(s._scopes,s,e,l));return l}(t,o,e,r));ur(o)&&o.length&&(o=function(e,t,r,a){const{_proxy:s,_context:n,_subProxy:i,_descriptors:o}=r;if("undefined"!==typeof n.index&&a(e))return t[n.index%t.length];if(hr(t[0])){const r=t,a=s._scopes.filter(e=>e!==r);t=[];for(const l of r){const r=ms(a,s,e,l);t.push(is(r,n,i&&i[e],o))}}return t}(t,o,e,i.isIndexable));cs(t,o)&&(o=is(o,s,n&&n[t],i));return o}(e,t,r)),getOwnPropertyDescriptor:(t,r)=>t._descriptors.allKeys?Reflect.has(e,r)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,r),getPrototypeOf:()=>Reflect.getPrototypeOf(e),has:(t,r)=>Reflect.has(e,r),ownKeys:()=>Reflect.ownKeys(e),set:(t,r,a)=>(e[r]=a,delete t[r],!0)})}function os(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{scriptable:!0,indexable:!0};const{_scriptable:r=t.scriptable,_indexable:a=t.indexable,_allKeys:s=t.allKeys}=e;return{allKeys:s,scriptable:r,indexable:a,isScriptable:Ar(r)?r:()=>r,isIndexable:Ar(a)?a:()=>a}}const ls=(e,t)=>e?e+_r(t):t,cs=(e,t)=>hr(t)&&"adapters"!==e&&(null===Object.getPrototypeOf(t)||t.constructor===Object);function ds(e,t,r){if(Object.prototype.hasOwnProperty.call(e,t)||"constructor"===t)return e[t];const a=r();return e[t]=a,a}function us(e,t,r){return Ar(e)?e(t,r):e}const hs=(e,t)=>!0===e?t:"string"===typeof e?Tr(t,e):void 0;function fs(e,t,r,a,s){for(const n of t){const t=hs(r,n);if(t){e.add(t);const n=us(t._fallback,r,s);if("undefined"!==typeof n&&n!==r&&n!==a)return n}else if(!1===t&&"undefined"!==typeof a&&r!==a)return null}return!1}function ms(e,t,r,a){const s=t._rootScopes,n=us(t._fallback,r,a),i=[...e,...s],o=new Set;o.add(a);let l=ps(o,i,r,n||r,a);return null!==l&&(("undefined"===typeof n||n===r||(l=ps(o,i,n,l,a),null!==l))&&ns(Array.from(o),[""],s,n,()=>function(e,t,r){const a=e._getTarget();t in a||(a[t]={});const s=a[t];if(ur(s)&&hr(r))return r;return s||{}}(t,r,a)))}function ps(e,t,r,a,s){for(;r;)r=fs(e,t,r,a,s);return r}function gs(e,t){for(const r of t){if(!r)continue;const t=r[e];if("undefined"!==typeof t)return t}}function xs(e){let t=e._keys;return t||(t=e._keys=function(e){const t=new Set;for(const r of e)for(const e of Object.keys(r).filter(e=>!e.startsWith("_")))t.add(e);return Array.from(t)}(e._scopes)),t}function bs(e,t,r,a){const{iScale:s}=e,{key:n="r"}=this._parsing,i=new Array(a);let o,l,c,d;for(o=0,l=a;o<l;++o)c=o+r,d=t[c],i[o]={r:s.parse(Tr(d,n),c)};return i}const vs=Number.EPSILON||1e-14,ys=(e,t)=>t<e.length&&!e[t].skip&&e[t],ws=e=>"x"===e?"y":"x";function js(e,t,r,a){const s=e.skip?t:e,n=t,i=r.skip?t:r,o=Jr(n,s),l=Jr(i,n);let c=o/(o+l),d=l/(o+l);c=isNaN(c)?0:c,d=isNaN(d)?0:d;const u=a*c,h=a*d;return{previous:{x:n.x-u*(i.x-s.x),y:n.y-u*(i.y-s.y)},next:{x:n.x+h*(i.x-s.x),y:n.y+h*(i.y-s.y)}}}function Ns(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"x";const r=ws(t),a=e.length,s=Array(a).fill(0),n=Array(a);let i,o,l,c=ys(e,0);for(i=0;i<a;++i)if(o=l,l=c,c=ys(e,i+1),l){if(c){const e=c[t]-l[t];s[i]=0!==e?(c[r]-l[r])/e:0}n[i]=o?c?Ur(s[i-1])!==Ur(s[i])?0:(s[i-1]+s[i])/2:s[i-1]:s[i]}!function(e,t,r){const a=e.length;let s,n,i,o,l,c=ys(e,0);for(let d=0;d<a-1;++d)l=c,c=ys(e,d+1),l&&c&&(Wr(t[d],0,vs)?r[d]=r[d+1]=0:(s=r[d]/t[d],n=r[d+1]/t[d],o=Math.pow(s,2)+Math.pow(n,2),o<=9||(i=3/Math.sqrt(o),r[d]=s*i*t[d],r[d+1]=n*i*t[d])))}(e,s,n),function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"x";const a=ws(r),s=e.length;let n,i,o,l=ys(e,0);for(let c=0;c<s;++c){if(i=o,o=l,l=ys(e,c+1),!o)continue;const s=o[r],d=o[a];i&&(n=(s-i[r])/3,o["cp1".concat(r)]=s-n,o["cp1".concat(a)]=d-n*t[c]),l&&(n=(l[r]-s)/3,o["cp2".concat(r)]=s+n,o["cp2".concat(a)]=d+n*t[c])}}(e,n,t)}function ks(e,t,r){return Math.max(Math.min(e,r),t)}function Ss(e,t,r,a,s){let n,i,o,l;if(t.spanGaps&&(e=e.filter(e=>!e.skip)),"monotone"===t.cubicInterpolationMode)Ns(e,s);else{let r=a?e[e.length-1]:e[0];for(n=0,i=e.length;n<i;++n)o=e[n],l=js(r,o,e[Math.min(n+1,i-(a?0:1))%i],t.tension),o.cp1x=l.previous.x,o.cp1y=l.previous.y,o.cp2x=l.next.x,o.cp2y=l.next.y,r=o}t.capBezierPoints&&function(e,t){let r,a,s,n,i,o=za(e[0],t);for(r=0,a=e.length;r<a;++r)i=n,n=o,o=r<a-1&&za(e[r+1],t),n&&(s=e[r],i&&(s.cp1x=ks(s.cp1x,t.left,t.right),s.cp1y=ks(s.cp1y,t.top,t.bottom)),o&&(s.cp2x=ks(s.cp2x,t.left,t.right),s.cp2y=ks(s.cp2y,t.top,t.bottom)))}(e,r)}function Es(){return"undefined"!==typeof window&&"undefined"!==typeof document}function Ts(e){let t=e.parentNode;return t&&"[object ShadowRoot]"===t.toString()&&(t=t.host),t}function _s(e,t,r){let a;return"string"===typeof e?(a=parseInt(e,10),-1!==e.indexOf("%")&&(a=a/100*t.parentNode[r])):a=e,a}const Cs=e=>e.ownerDocument.defaultView.getComputedStyle(e,null);const As=["top","right","bottom","left"];function Ds(e,t,r){const a={};r=r?"-"+r:"";for(let s=0;s<4;s++){const n=As[s];a[n]=parseFloat(e[t+"-"+n+r])||0}return a.width=a.left+a.right,a.height=a.top+a.bottom,a}function Ps(e,t){if("native"in e)return e;const{canvas:r,currentDevicePixelRatio:a}=t,s=Cs(r),n="border-box"===s.boxSizing,i=Ds(s,"padding"),o=Ds(s,"border","width"),{x:l,y:c,box:d}=function(e,t){const r=e.touches,a=r&&r.length?r[0]:e,{offsetX:s,offsetY:n}=a;let i,o,l=!1;if(((e,t,r)=>(e>0||t>0)&&(!r||!r.shadowRoot))(s,n,e.target))i=s,o=n;else{const e=t.getBoundingClientRect();i=a.clientX-e.left,o=a.clientY-e.top,l=!0}return{x:i,y:o,box:l}}(e,r),u=i.left+(d&&o.left),h=i.top+(d&&o.top);let{width:f,height:m}=t;return n&&(f-=i.width+o.width,m-=i.height+o.height),{x:Math.round((l-u)/f*r.width/a),y:Math.round((c-h)/m*r.height/a)}}const Is=e=>Math.round(10*e)/10;function Os(e,t,r,a){const s=Cs(e),n=Ds(s,"margin"),i=_s(s.maxWidth,e,"clientWidth")||Rr,o=_s(s.maxHeight,e,"clientHeight")||Rr,l=function(e,t,r){let a,s;if(void 0===t||void 0===r){const n=e&&Ts(e);if(n){const e=n.getBoundingClientRect(),i=Cs(n),o=Ds(i,"border","width"),l=Ds(i,"padding");t=e.width-l.width-o.width,r=e.height-l.height-o.height,a=_s(i.maxWidth,n,"clientWidth"),s=_s(i.maxHeight,n,"clientHeight")}else t=e.clientWidth,r=e.clientHeight}return{width:t,height:r,maxWidth:a||Rr,maxHeight:s||Rr}}(e,t,r);let{width:c,height:d}=l;if("content-box"===s.boxSizing){const e=Ds(s,"border","width"),t=Ds(s,"padding");c-=t.width+e.width,d-=t.height+e.height}c=Math.max(0,c-n.width),d=Math.max(0,a?c/a:d-n.height),c=Is(Math.min(c,i,l.maxWidth)),d=Is(Math.min(d,o,l.maxHeight)),c&&!d&&(d=Is(c/2));return(void 0!==t||void 0!==r)&&a&&l.height&&d>l.height&&(d=l.height,c=Is(Math.floor(d*a))),{width:c,height:d}}function Rs(e,t,r){const a=t||1,s=Math.floor(e.height*a),n=Math.floor(e.width*a);e.height=Math.floor(e.height),e.width=Math.floor(e.width);const i=e.canvas;return i.style&&(r||!i.style.height&&!i.style.width)&&(i.style.height="".concat(e.height,"px"),i.style.width="".concat(e.width,"px")),(e.currentDevicePixelRatio!==a||i.height!==s||i.width!==n)&&(e.currentDevicePixelRatio=a,i.height=s,i.width=n,e.ctx.setTransform(a,0,0,a,0,0),!0)}const Ms=function(){let e=!1;try{const t={get passive(){return e=!0,!1}};Es()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch(bN){}return e}();function Fs(e,t){const r=function(e,t){return Cs(e).getPropertyValue(t)}(e,t),a=r&&r.match(/^(\d+)(\.\d+)?px$/);return a?+a[1]:void 0}function Ls(e,t,r,a){return{x:e.x+r*(t.x-e.x),y:e.y+r*(t.y-e.y)}}function zs(e,t,r,a){return{x:e.x+r*(t.x-e.x),y:"middle"===a?r<.5?e.y:t.y:"after"===a?r<1?e.y:t.y:r>0?t.y:e.y}}function Bs(e,t,r,a){const s={x:e.cp2x,y:e.cp2y},n={x:t.cp1x,y:t.cp1y},i=Ls(e,s,r),o=Ls(s,n,r),l=Ls(n,t,r),c=Ls(i,o,r),d=Ls(o,l,r);return Ls(c,d,r)}function Us(e,t,r){return e?function(e,t){return{x:r=>e+e+t-r,setWidth(e){t=e},textAlign:e=>"center"===e?e:"right"===e?"left":"right",xPlus:(e,t)=>e-t,leftForLtr:(e,t)=>e-t}}(t,r):{x:e=>e,setWidth(e){},textAlign:e=>e,xPlus:(e,t)=>e+t,leftForLtr:(e,t)=>e}}function Ws(e,t){let r,a;"ltr"!==t&&"rtl"!==t||(r=e.canvas.style,a=[r.getPropertyValue("direction"),r.getPropertyPriority("direction")],r.setProperty("direction",t,"important"),e.prevTextDirection=a)}function Hs(e,t){void 0!==t&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function Vs(e){return"angle"===e?{between:Zr,compare:Xr,normalize:Qr}:{between:ta,compare:(e,t)=>e-t,normalize:e=>e}}function Gs(e){let{start:t,end:r,count:a,loop:s,style:n}=e;return{start:t%a,end:r%a,loop:s&&(r-t+1)%a===0,style:n}}function qs(e,t,r){if(!r)return[e];const{property:a,start:s,end:n}=r,i=t.length,{compare:o,between:l,normalize:c}=Vs(a),{start:d,end:u,loop:h,style:f}=function(e,t,r){const{property:a,start:s,end:n}=r,{between:i,normalize:o}=Vs(a),l=t.length;let c,d,{start:u,end:h,loop:f}=e;if(f){for(u+=l,h+=l,c=0,d=l;c<d&&i(o(t[u%l][a]),s,n);++c)u--,h--;u%=l,h%=l}return h<u&&(h+=l),{start:u,end:h,loop:f,style:e.style}}(e,t,r),m=[];let p,g,x,b=!1,v=null;const y=()=>b||l(s,x,p)&&0!==o(s,x),w=()=>!b||0===o(n,p)||l(n,x,p);for(let j=d,N=d;j<=u;++j)g=t[j%i],g.skip||(p=c(g[a]),p!==x&&(b=l(p,s,n),null===v&&y()&&(v=0===o(p,s)?j:N),null!==v&&w()&&(m.push(Gs({start:v,end:j,loop:h,count:i,style:f})),v=null),N=j,x=p));return null!==v&&m.push(Gs({start:v,end:u,loop:h,count:i,style:f})),m}function $s(e,t){const r=[],a=e.segments;for(let s=0;s<a.length;s++){const n=qs(a[s],e.points,t);n.length&&r.push(...n)}return r}function Ks(e,t,r,a){return a&&a.setContext&&r?function(e,t,r,a){const s=e._chart.getContext(),n=Ys(e.options),{_datasetIndex:i,options:{spanGaps:o}}=e,l=r.length,c=[];let d=n,u=t[0].start,h=u;function f(e,t,a,s){const n=o?-1:1;if(e!==t){for(e+=l;r[e%l].skip;)e-=n;for(;r[t%l].skip;)t+=n;e%l!==t%l&&(c.push({start:e%l,end:t%l,loop:a,style:s}),d=s,u=t%l)}}for(const m of t){u=o?u:m.start;let e,t=r[u%l];for(h=u+1;h<=m.end;h++){const n=r[h%l];e=Ys(a.setContext(ss(s,{type:"segment",p0:t,p1:n,p0DataIndex:(h-1)%l,p1DataIndex:h%l,datasetIndex:i}))),Js(e,d)&&f(u,h-1,m.loop,d),t=n,d=e}u<h-1&&f(u,h-1,m.loop,d)}return c}(e,t,r,a):t}function Ys(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function Js(e,t){if(!t)return!1;const r=[],a=function(e,t){return ba(t)?(r.includes(t)||r.push(t),r.indexOf(t)):t};return JSON.stringify(e,a)!==JSON.stringify(t,a)}function Xs(e,t,r){return e.options.clip?e[r]:t[r]}function Qs(e,t){const r=t._clip;if(r.disabled)return!1;const a=function(e,t){const{xScale:r,yScale:a}=e;return r&&a?{left:Xs(r,t,"left"),right:Xs(r,t,"right"),top:Xs(a,t,"top"),bottom:Xs(a,t,"bottom")}:t}(t,e.chartArea);return{left:!1===r.left?0:a.left-(!0===r.left?0:r.left),right:!1===r.right?e.width:a.right+(!0===r.right?0:r.right),top:!1===r.top?0:a.top-(!0===r.top?0:r.top),bottom:!1===r.bottom?e.height:a.bottom+(!0===r.bottom?0:r.bottom)}}class Zs{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,r,a){const s=t.listeners[a],n=t.duration;s.forEach(a=>a({chart:e,initial:t.initial,numSteps:n,currentStep:Math.min(r-t.start,n)}))}_refresh(){this._request||(this._running=!0,this._request=la.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),t=0;this._charts.forEach((r,a)=>{if(!r.running||!r.items.length)return;const s=r.items;let n,i=s.length-1,o=!1;for(;i>=0;--i)n=s[i],n._active?(n._total>r.duration&&(r.duration=n._total),n.tick(e),o=!0):(s[i]=s[s.length-1],s.pop());o&&(a.draw(),this._notify(a,r,e,"progress")),s.length||(r.running=!1,this._notify(a,r,e,"complete"),r.initial=!1),t+=s.length}),this._lastDate=e,0===t&&(this._running=!1)}_getAnims(e){const t=this._charts;let r=t.get(e);return r||(r={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,r)),r}listen(e,t,r){this._getAnims(e).listeners[t].push(r)}add(e,t){t&&t.length&&this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((e,t)=>Math.max(e,t._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!!(t&&t.running&&t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const r=t.items;let a=r.length-1;for(;a>=0;--a)r[a].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var en=new Zs;const tn="transparent",rn={boolean:(e,t,r)=>r>.5?t:e,color(e,t,r){const a=va(e||tn),s=a.valid&&va(t||tn);return s&&s.valid?s.mix(a,r).hexString():t},number:(e,t,r)=>e+(t-e)*r};class an{constructor(e,t,r,a){const s=t[r];a=as([e.to,a,s,e.from]);const n=as([e.from,s,a]);this._active=!0,this._fn=e.fn||rn[e.type||typeof n],this._easing=xa[e.easing]||xa.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=r,this._from=n,this._to=a,this._promises=void 0}active(){return this._active}update(e,t,r){if(this._active){this._notify(!1);const a=this._target[this._prop],s=r-this._start,n=this._duration-s;this._start=r,this._duration=Math.floor(Math.max(n,e.duration)),this._total+=s,this._loop=!!e.loop,this._to=as([e.to,t,a,e.from]),this._from=as([e.from,a,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,r=this._duration,a=this._prop,s=this._from,n=this._loop,i=this._to;let o;if(this._active=s!==i&&(n||t<r),!this._active)return this._target[a]=i,void this._notify(!0);t<0?this._target[a]=s:(o=t/r%2,o=n&&o>1?2-o:o,o=this._easing(Math.min(1,Math.max(0,o))),this._target[a]=this._fn(s,i,o))}wait(){const e=this._promises||(this._promises=[]);return new Promise((t,r)=>{e.push({res:t,rej:r})})}_notify(e){const t=e?"res":"rej",r=this._promises||[];for(let a=0;a<r.length;a++)r[a][t]()}}class sn{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!hr(e))return;const t=Object.keys(Pa.animation),r=this._properties;Object.getOwnPropertyNames(e).forEach(a=>{const s=e[a];if(!hr(s))return;const n={};for(const e of t)n[e]=s[e];(ur(s.properties)&&s.properties||[a]).forEach(e=>{e!==a&&r.has(e)||r.set(e,n)})})}_animateOptions(e,t){const r=t.options,a=function(e,t){if(!t)return;let r=e.options;if(!r)return void(e.options=t);r.$shared&&(e.options=r=Object.assign({},r,{$shared:!1,$animations:{}}));return r}(e,r);if(!a)return[];const s=this._createAnimations(a,r);return r.$shared&&function(e,t){const r=[],a=Object.keys(t);for(let s=0;s<a.length;s++){const t=e[a[s]];t&&t.active()&&r.push(t.wait())}return Promise.all(r)}(e.options.$animations,r).then(()=>{e.options=r},()=>{}),s}_createAnimations(e,t){const r=this._properties,a=[],s=e.$animations||(e.$animations={}),n=Object.keys(t),i=Date.now();let o;for(o=n.length-1;o>=0;--o){const l=n[o];if("$"===l.charAt(0))continue;if("options"===l){a.push(...this._animateOptions(e,t));continue}const c=t[l];let d=s[l];const u=r.get(l);if(d){if(u&&d.active()){d.update(u,c,i);continue}d.cancel()}u&&u.duration?(s[l]=d=new an(u,e,l,c),a.push(d)):e[l]=c}return a}update(e,t){if(0===this._properties.size)return void Object.assign(e,t);const r=this._createAnimations(e,t);return r.length?(en.add(this._chart,r),!0):void 0}}function nn(e,t){const r=e&&e.options||{},a=r.reverse,s=void 0===r.min?t:0,n=void 0===r.max?t:0;return{start:a?n:s,end:a?s:n}}function on(e,t){const r=[],a=e._getSortedDatasetMetas(t);let s,n;for(s=0,n=a.length;s<n;++s)r.push(a[s].index);return r}function ln(e,t,r){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const s=e.keys,n="single"===a.mode;let i,o,l,c;if(null===t)return;let d=!1;for(i=0,o=s.length;i<o;++i){if(l=+s[i],l===r){if(d=!0,a.all)continue;break}c=e.values[l],fr(c)&&(n||0===t||Ur(t)===Ur(c))&&(t+=c)}return d||a.all?t:0}function cn(e,t){const r=e&&e.options.stacked;return r||void 0===r&&void 0!==t.stack}function dn(e,t,r){const a=e[t]||(e[t]={});return a[r]||(a[r]={})}function un(e,t,r,a){for(const s of t.getMatchingVisibleMetas(a).reverse()){const t=e[s.index];if(r&&t>0||!r&&t<0)return s.index}return null}function hn(e,t){const{chart:r,_cachedMeta:a}=e,s=r._stacks||(r._stacks={}),{iScale:n,vScale:i,index:o}=a,l=n.axis,c=i.axis,d=function(e,t,r){return"".concat(e.id,".").concat(t.id,".").concat(r.stack||r.type)}(n,i,a),u=t.length;let h;for(let f=0;f<u;++f){const e=t[f],{[l]:r,[c]:n}=e;h=(e._stacks||(e._stacks={}))[c]=dn(s,d,r),h[o]=n,h._top=un(h,i,!0,a.type),h._bottom=un(h,i,!1,a.type);(h._visualValues||(h._visualValues={}))[o]=n}}function fn(e,t){const r=e.scales;return Object.keys(r).filter(e=>r[e].axis===t).shift()}function mn(e,t){const r=e.controller.index,a=e.vScale&&e.vScale.axis;if(a){t=t||e._parsed;for(const e of t){const t=e._stacks;if(!t||void 0===t[a]||void 0===t[a][r])return;delete t[a][r],void 0!==t[a]._visualValues&&void 0!==t[a]._visualValues[r]&&delete t[a]._visualValues[r]}}}const pn=e=>"reset"===e||"none"===e,gn=(e,t)=>t?e:Object.assign({},e);class xn{constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=cn(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&mn(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,r=this.getDataset(),a=(e,t,r,a)=>"x"===e?t:"r"===e?a:r,s=t.xAxisID=pr(r.xAxisID,fn(e,"x")),n=t.yAxisID=pr(r.yAxisID,fn(e,"y")),i=t.rAxisID=pr(r.rAxisID,fn(e,"r")),o=t.indexAxis,l=t.iAxisID=a(o,s,n,i),c=t.vAxisID=a(o,n,s,i);t.xScale=this.getScaleForId(s),t.yScale=this.getScaleForId(n),t.rScale=this.getScaleForId(i),t.iScale=this.getScaleForId(l),t.vScale=this.getScaleForId(c)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&ia(this._data,this),e._stacked&&mn(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),r=this._data;if(hr(t)){const e=this._cachedMeta;this._data=function(e,t){const{iScale:r,vScale:a}=t,s="x"===r.axis?"x":"y",n="x"===a.axis?"x":"y",i=Object.keys(e),o=new Array(i.length);let l,c,d;for(l=0,c=i.length;l<c;++l)d=i[l],o[l]={[s]:d,[n]:e[d]};return o}(t,e)}else if(r!==t){if(r){ia(r,this);const e=this._cachedMeta;mn(e),e._parsed=[]}t&&Object.isExtensible(t)&&(s=this,(a=t)._chartjs?a._chartjs.listeners.push(s):(Object.defineProperty(a,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[s]}}),na.forEach(e=>{const t="_onData"+_r(e),r=a[e];Object.defineProperty(a,e,{configurable:!0,enumerable:!1,value(){for(var e=arguments.length,s=new Array(e),n=0;n<e;n++)s[n]=arguments[n];const i=r.apply(this,s);return a._chartjs.listeners.forEach(e=>{"function"===typeof e[t]&&e[t](...s)}),i}})}))),this._syncList=[],this._data=t}var a,s}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,r=this.getDataset();let a=!1;this._dataCheck();const s=t._stacked;t._stacked=cn(t.vScale,t),t.stack!==r.stack&&(a=!0,mn(t),t.stack=r.stack),this._resyncElements(e),(a||s!==t._stacked)&&(hn(this,t._parsed),t._stacked=cn(t.vScale,t))}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),r=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(r,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:r,_data:a}=this,{iScale:s,_stacked:n}=r,i=s.axis;let o,l,c,d=0===e&&t===a.length||r._sorted,u=e>0&&r._parsed[e-1];if(!1===this._parsing)r._parsed=a,r._sorted=!0,c=a;else{c=ur(a[e])?this.parseArrayData(r,a,e,t):hr(a[e])?this.parseObjectData(r,a,e,t):this.parsePrimitiveData(r,a,e,t);const s=()=>null===l[i]||u&&l[i]<u[i];for(o=0;o<t;++o)r._parsed[o+e]=l=c[o],d&&(s()&&(d=!1),u=l);r._sorted=d}n&&hn(this,c)}parsePrimitiveData(e,t,r,a){const{iScale:s,vScale:n}=e,i=s.axis,o=n.axis,l=s.getLabels(),c=s===n,d=new Array(a);let u,h,f;for(u=0,h=a;u<h;++u)f=u+r,d[u]={[i]:c||s.parse(l[f],f),[o]:n.parse(t[f],f)};return d}parseArrayData(e,t,r,a){const{xScale:s,yScale:n}=e,i=new Array(a);let o,l,c,d;for(o=0,l=a;o<l;++o)c=o+r,d=t[c],i[o]={x:s.parse(d[0],c),y:n.parse(d[1],c)};return i}parseObjectData(e,t,r,a){const{xScale:s,yScale:n}=e,{xAxisKey:i="x",yAxisKey:o="y"}=this._parsing,l=new Array(a);let c,d,u,h;for(c=0,d=a;c<d;++c)u=c+r,h=t[u],l[c]={x:s.parse(Tr(h,i),u),y:n.parse(Tr(h,o),u)};return l}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,r){const a=this.chart,s=this._cachedMeta,n=t[e.axis];return ln({keys:on(a,!0),values:t._stacks[e.axis]._visualValues},n,s.index,{mode:r})}updateRangeFromParsed(e,t,r,a){const s=r[t.axis];let n=null===s?NaN:s;const i=a&&r._stacks[t.axis];a&&i&&(a.values=i,n=ln(a,s,this._cachedMeta.index)),e.min=Math.min(e.min,n),e.max=Math.max(e.max,n)}getMinMax(e,t){const r=this._cachedMeta,a=r._parsed,s=r._sorted&&e===r.iScale,n=a.length,i=this._getOtherScale(e),o=((e,t,r)=>e&&!t.hidden&&t._stacked&&{keys:on(r,!0),values:null})(t,r,this.chart),l={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:c,max:d}=function(e){const{min:t,max:r,minDefined:a,maxDefined:s}=e.getUserBounds();return{min:a?t:Number.NEGATIVE_INFINITY,max:s?r:Number.POSITIVE_INFINITY}}(i);let u,h;function f(){h=a[u];const t=h[i.axis];return!fr(h[e.axis])||c>t||d<t}for(u=0;u<n&&(f()||(this.updateRangeFromParsed(l,e,h,o),!s));++u);if(s)for(u=n-1;u>=0;--u)if(!f()){this.updateRangeFromParsed(l,e,h,o);break}return l}getAllParsedValues(e){const t=this._cachedMeta._parsed,r=[];let a,s,n;for(a=0,s=t.length;a<s;++a)n=t[a][e.axis],fr(n)&&r.push(n);return r}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,r=t.iScale,a=t.vScale,s=this.getParsed(e);return{label:r?""+r.getLabelForValue(s[r.axis]):"",value:a?""+a.getLabelForValue(s[a.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=function(e){let t,r,a,s;return hr(e)?(t=e.top,r=e.right,a=e.bottom,s=e.left):t=r=a=s=e,{top:t,right:r,bottom:a,left:s,disabled:!1===e}}(pr(this.options.clip,function(e,t,r){if(!1===r)return!1;const a=nn(e,r),s=nn(t,r);return{top:s.end,right:a.end,bottom:s.start,left:a.start}}(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,r=this._cachedMeta,a=r.data||[],s=t.chartArea,n=[],i=this._drawStart||0,o=this._drawCount||a.length-i,l=this.options.drawActiveElementsOnTop;let c;for(r.dataset&&r.dataset.draw(e,s,i,o),c=i;c<i+o;++c){const t=a[c];t.hidden||(t.active&&l?n.push(t):t.draw(e,s))}for(c=0;c<n.length;++c)n[c].draw(e,s)}getStyle(e,t){const r=t?"active":"default";return void 0===e&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(r):this.resolveDataElementOptions(e||0,r)}getContext(e,t,r){const a=this.getDataset();let s;if(e>=0&&e<this._cachedMeta.data.length){const t=this._cachedMeta.data[e];s=t.$context||(t.$context=function(e,t,r){return ss(e,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:r,index:t,mode:"default",type:"data"})}(this.getContext(),e,t)),s.parsed=this.getParsed(e),s.raw=a.data[e],s.index=s.dataIndex=e}else s=this.$context||(this.$context=function(e,t){return ss(e,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}(this.chart.getContext(),this.index)),s.dataset=a,s.index=s.datasetIndex=this.index;return s.active=!!t,s.mode=r,s}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",r=arguments.length>2?arguments[2]:void 0;const a="active"===t,s=this._cachedDataOpts,n=e+"-"+t,i=s[n],o=this.enableOptionSharing&&Cr(r);if(i)return gn(i,o);const l=this.chart.config,c=l.datasetElementScopeKeys(this._type,e),d=a?["".concat(e,"Hover"),"hover",e,""]:[e,""],u=l.getOptionScopes(this.getDataset(),c),h=Object.keys(Pa.elements[e]),f=l.resolveNamedOptions(u,h,()=>this.getContext(r,a,t),d);return f.$shared&&(f.$shared=o,s[n]=Object.freeze(gn(f,o))),f}_resolveAnimations(e,t,r){const a=this.chart,s=this._cachedDataOpts,n="animation-".concat(t),i=s[n];if(i)return i;let o;if(!1!==a.options.animation){const a=this.chart.config,s=a.datasetAnimationScopeKeys(this._type,t),n=a.getOptionScopes(this.getDataset(),s);o=a.createResolver(n,this.getContext(e,r,t))}const l=new sn(a,o&&o.animations);return o&&o._cacheable&&(s[n]=Object.freeze(l)),l}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||pn(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const r=this.resolveDataElementOptions(e,t),a=this._sharedOptions,s=this.getSharedOptions(r),n=this.includeOptions(t,s)||s!==a;return this.updateSharedOptions(s,t,r),{sharedOptions:s,includeOptions:n}}updateElement(e,t,r,a){pn(a)?Object.assign(e,r):this._resolveAnimations(t,a).update(e,r)}updateSharedOptions(e,t,r){e&&!pn(t)&&this._resolveAnimations(void 0,t).update(e,r)}_setStyle(e,t,r,a){e.active=a;const s=this.getStyle(t,a);this._resolveAnimations(t,r,a).update(e,{options:!a&&this.getSharedOptions(s)||s})}removeHoverStyle(e,t,r){this._setStyle(e,r,"active",!1)}setHoverStyle(e,t,r){this._setStyle(e,r,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,r=this._cachedMeta.data;for(const[i,o,l]of this._syncList)this[i](o,l);this._syncList=[];const a=r.length,s=t.length,n=Math.min(s,a);n&&this.parse(0,n),s>a?this._insertElements(a,s-a,e):s<a&&this._removeElements(s,a-s)}_insertElements(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const a=this._cachedMeta,s=a.data,n=e+t;let i;const o=e=>{for(e.length+=t,i=e.length-1;i>=n;i--)e[i]=e[i-t]};for(o(s),i=e;i<n;++i)s[i]=new this.dataElementType;this._parsing&&o(a._parsed),this.parse(e,t),r&&this.updateElements(s,e,t,"reset")}updateElements(e,t,r,a){}_removeElements(e,t){const r=this._cachedMeta;if(this._parsing){const a=r._parsed.splice(e,t);r._stacked&&mn(r,a)}r.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,r,a]=e;this[t](r,a)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const r=arguments.length-2;r&&this._sync(["_insertElements",e,r])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function bn(e){const t=e.iScale,r=function(e,t){if(!e._cache.$bar){const r=e.getMatchingVisibleMetas(t);let a=[];for(let t=0,s=r.length;t<s;t++)a=a.concat(r[t].controller.getAllParsedValues(e));e._cache.$bar=oa(a.sort((e,t)=>e-t))}return e._cache.$bar}(t,e.type);let a,s,n,i,o=t._length;const l=()=>{32767!==n&&-32768!==n&&(Cr(i)&&(o=Math.min(o,Math.abs(n-i)||o)),i=n)};for(a=0,s=r.length;a<s;++a)n=t.getPixelForValue(r[a]),l();for(i=void 0,a=0,s=t.ticks.length;a<s;++a)n=t.getPixelForTick(a),l();return o}function vn(e,t,r,a){return ur(e)?function(e,t,r,a){const s=r.parse(e[0],a),n=r.parse(e[1],a),i=Math.min(s,n),o=Math.max(s,n);let l=i,c=o;Math.abs(i)>Math.abs(o)&&(l=o,c=i),t[r.axis]=c,t._custom={barStart:l,barEnd:c,start:s,end:n,min:i,max:o}}(e,t,r,a):t[r.axis]=r.parse(e,a),t}function yn(e,t,r,a){const s=e.iScale,n=e.vScale,i=s.getLabels(),o=s===n,l=[];let c,d,u,h;for(c=r,d=r+a;c<d;++c)h=t[c],u={},u[s.axis]=o||s.parse(i[c],c),l.push(vn(h,u,n,c));return l}function wn(e){return e&&void 0!==e.barStart&&void 0!==e.barEnd}function jn(e,t,r,a){let s=t.borderSkipped;const n={};if(!s)return void(e.borderSkipped=n);if(!0===s)return void(e.borderSkipped={top:!0,right:!0,bottom:!0,left:!0});const{start:i,end:o,reverse:l,top:c,bottom:d}=function(e){let t,r,a,s,n;return e.horizontal?(t=e.base>e.x,r="left",a="right"):(t=e.base<e.y,r="bottom",a="top"),t?(s="end",n="start"):(s="start",n="end"),{start:r,end:a,reverse:t,top:s,bottom:n}}(e);"middle"===s&&r&&(e.enableBorderRadius=!0,(r._top||0)===a?s=c:(r._bottom||0)===a?s=d:(n[Nn(d,i,o,l)]=!0,s=c)),n[Nn(s,i,o,l)]=!0,e.borderSkipped=n}function Nn(e,t,r,a){var s,n,i;return a?(i=r,e=kn(e=(s=e)===(n=t)?i:s===i?n:s,r,t)):e=kn(e,t,r),e}function kn(e,t,r){return"start"===e?t:"end"===e?r:e}function Sn(e,t,r){let{inflateAmount:a}=t;e.inflateAmount="auto"===a?1===r?.33:0:a}(0,_t.A)(xn,"defaults",{}),(0,_t.A)(xn,"datasetElementType",null),(0,_t.A)(xn,"dataElementType",null);class En extends xn{parsePrimitiveData(e,t,r,a){return yn(e,t,r,a)}parseArrayData(e,t,r,a){return yn(e,t,r,a)}parseObjectData(e,t,r,a){const{iScale:s,vScale:n}=e,{xAxisKey:i="x",yAxisKey:o="y"}=this._parsing,l="x"===s.axis?i:o,c="x"===n.axis?i:o,d=[];let u,h,f,m;for(u=r,h=r+a;u<h;++u)m=t[u],f={},f[s.axis]=s.parse(Tr(m,l),u),d.push(vn(Tr(m,c),f,n,u));return d}updateRangeFromParsed(e,t,r,a){super.updateRangeFromParsed(e,t,r,a);const s=r._custom;s&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,s.min),e.max=Math.max(e.max,s.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:r,vScale:a}=t,s=this.getParsed(e),n=s._custom,i=wn(n)?"["+n.start+", "+n.end+"]":""+a.getLabelForValue(s[a.axis]);return{label:""+r.getLabelForValue(s[r.axis]),value:i}}initialize(){this.enableOptionSharing=!0,super.initialize();this._cachedMeta.stack=this.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,r,a){const s="reset"===a,{index:n,_cachedMeta:{vScale:i}}=this,o=i.getBasePixel(),l=i.isHorizontal(),c=this._getRuler(),{sharedOptions:d,includeOptions:u}=this._getSharedOptions(t,a);for(let h=t;h<t+r;h++){const t=this.getParsed(h),r=s||dr(t[i.axis])?{base:o,head:o}:this._calculateBarValuePixels(h),f=this._calculateBarIndexPixels(h,c),m=(t._stacks||{})[i.axis],p={horizontal:l,base:r.base,enableBorderRadius:!m||wn(t._custom)||n===m._top||n===m._bottom,x:l?r.head:f.center,y:l?f.center:r.head,height:l?f.size:Math.abs(r.size),width:l?Math.abs(r.size):f.size};u&&(p.options=d||this.resolveDataElementOptions(h,e[h].active?"active":a));const g=p.options||e[h].options;jn(p,g,m,n),Sn(p,g,c.ratio),this.updateElement(e[h],h,p,a)}}_getStacks(e,t){const{iScale:r}=this._cachedMeta,a=r.getMatchingVisibleMetas(this._type).filter(e=>e.controller.options.grouped),s=r.options.stacked,n=[],i=this._cachedMeta.controller.getParsed(t),o=i&&i[r.axis],l=e=>{const t=e._parsed.find(e=>e[r.axis]===o),a=t&&t[e.vScale.axis];if(dr(a)||isNaN(a))return!0};for(const c of a)if((void 0===t||!l(c))&&((!1===s||-1===n.indexOf(c.stack)||void 0===s&&void 0===c.stack)&&n.push(c.stack),c.index===e))break;return n.length||n.push(void 0),n}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,t=this.chart.options.indexAxis;return Object.keys(e).filter(r=>e[r].axis===t).shift()}_getAxis(){const e={},t=this.getFirstScaleIdForIndexAxis();for(const r of this.chart.data.datasets)e[pr("x"===this.chart.options.indexAxis?r.xAxisID:r.yAxisID,t)]=!0;return Object.keys(e)}_getStackIndex(e,t,r){const a=this._getStacks(e,r),s=void 0!==t?a.indexOf(t):-1;return-1===s?a.length-1:s}_getRuler(){const e=this.options,t=this._cachedMeta,r=t.iScale,a=[];let s,n;for(s=0,n=t.data.length;s<n;++s)a.push(r.getPixelForValue(this.getParsed(s)[r.axis],s));const i=e.barThickness;return{min:i||bn(t),pixels:a,start:r._startPixel,end:r._endPixel,stackCount:this._getStackCount(),scale:r,grouped:e.grouped,ratio:i?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:r,index:a},options:{base:s,minBarLength:n}}=this,i=s||0,o=this.getParsed(e),l=o._custom,c=wn(l);let d,u,h=o[t.axis],f=0,m=r?this.applyStack(t,o,r):h;m!==h&&(f=m-h,m=h),c&&(h=l.barStart,m=l.barEnd-l.barStart,0!==h&&Ur(h)!==Ur(l.barEnd)&&(f=0),f+=h);const p=dr(s)||c?f:s;let g=t.getPixelForValue(p);if(d=this.chart.getDataVisibility(e)?t.getPixelForValue(f+m):g,u=d-g,Math.abs(u)<n){u=function(e,t,r){return 0!==e?Ur(e):(t.isHorizontal()?1:-1)*(t.min>=r?1:-1)}(u,t,i)*n,h===i&&(g-=u/2);const e=t.getPixelForDecimal(0),s=t.getPixelForDecimal(1),l=Math.min(e,s),f=Math.max(e,s);g=Math.max(Math.min(g,f),l),d=g+u,r&&!c&&(o._stacks[t.axis]._visualValues[a]=t.getValueForPixel(d)-t.getValueForPixel(g))}if(g===t.getPixelForValue(i)){const e=Ur(u)*t.getLineWidthForValue(i)/2;g+=e,u-=e}return{size:u,base:g,head:d,center:d+u/2}}_calculateBarIndexPixels(e,t){const r=t.scale,a=this.options,s=a.skipNull,n=pr(a.maxBarThickness,1/0);let i,o;const l=this._getAxisCount();if(t.grouped){const r=s?this._getStackCount(e):t.stackCount,c="flex"===a.barThickness?function(e,t,r,a){const s=t.pixels,n=s[e];let i=e>0?s[e-1]:null,o=e<s.length-1?s[e+1]:null;const l=r.categoryPercentage;null===i&&(i=n-(null===o?t.end-t.start:o-n)),null===o&&(o=n+n-i);const c=n-(n-Math.min(i,o))/2*l;return{chunk:Math.abs(o-i)/2*l/a,ratio:r.barPercentage,start:c}}(e,t,a,r*l):function(e,t,r,a){const s=r.barThickness;let n,i;return dr(s)?(n=t.min*r.categoryPercentage,i=r.barPercentage):(n=s*a,i=1),{chunk:n/a,ratio:i,start:t.pixels[e]-n/2}}(e,t,a,r*l),d="x"===this.chart.options.indexAxis?this.getDataset().xAxisID:this.getDataset().yAxisID,u=this._getAxis().indexOf(pr(d,this.getFirstScaleIdForIndexAxis())),h=this._getStackIndex(this.index,this._cachedMeta.stack,s?e:void 0)+u;i=c.start+c.chunk*h+c.chunk/2,o=Math.min(n,c.chunk*c.ratio)}else i=r.getPixelForValue(this.getParsed(e)[r.axis],e),o=Math.min(n,t.min*t.ratio);return{base:i-o/2,head:i+o/2,center:i,size:o}}draw(){const e=this._cachedMeta,t=e.vScale,r=e.data,a=r.length;let s=0;for(;s<a;++s)null===this.getParsed(s)[t.axis]||r[s].hidden||r[s].draw(this._ctx)}}(0,_t.A)(En,"id","bar"),(0,_t.A)(En,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),(0,_t.A)(En,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});class Tn extends xn{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(e,t,r,a){const s=super.parsePrimitiveData(e,t,r,a);for(let n=0;n<s.length;n++)s[n]._custom=this.resolveDataElementOptions(n+r).radius;return s}parseArrayData(e,t,r,a){const s=super.parseArrayData(e,t,r,a);for(let n=0;n<s.length;n++){const e=t[r+n];s[n]._custom=pr(e[2],this.resolveDataElementOptions(n+r).radius)}return s}parseObjectData(e,t,r,a){const s=super.parseObjectData(e,t,r,a);for(let n=0;n<s.length;n++){const e=t[r+n];s[n]._custom=pr(e&&e.r&&+e.r,this.resolveDataElementOptions(n+r).radius)}return s}getMaxOverflow(){const e=this._cachedMeta.data;let t=0;for(let r=e.length-1;r>=0;--r)t=Math.max(t,e[r].size(this.resolveDataElementOptions(r))/2);return t>0&&t}getLabelAndValue(e){const t=this._cachedMeta,r=this.chart.data.labels||[],{xScale:a,yScale:s}=t,n=this.getParsed(e),i=a.getLabelForValue(n.x),o=s.getLabelForValue(n.y),l=n._custom;return{label:r[e]||"",value:"("+i+", "+o+(l?", "+l:"")+")"}}update(e){const t=this._cachedMeta.data;this.updateElements(t,0,t.length,e)}updateElements(e,t,r,a){const s="reset"===a,{iScale:n,vScale:i}=this._cachedMeta,{sharedOptions:o,includeOptions:l}=this._getSharedOptions(t,a),c=n.axis,d=i.axis;for(let u=t;u<t+r;u++){const t=e[u],r=!s&&this.getParsed(u),h={},f=h[c]=s?n.getPixelForDecimal(.5):n.getPixelForValue(r[c]),m=h[d]=s?i.getBasePixel():i.getPixelForValue(r[d]);h.skip=isNaN(f)||isNaN(m),l&&(h.options=o||this.resolveDataElementOptions(u,t.active?"active":a),s&&(h.options.radius=0)),this.updateElement(t,u,h,a)}}resolveDataElementOptions(e,t){const r=this.getParsed(e);let a=super.resolveDataElementOptions(e,t);a.$shared&&(a=Object.assign({},a,{$shared:!1}));const s=a.radius;return"active"!==t&&(a.radius=0),a.radius+=pr(r&&r._custom,s),a}}(0,_t.A)(Tn,"id","bubble"),(0,_t.A)(Tn,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),(0,_t.A)(Tn,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});class _n extends xn{constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,t){const r=this.getDataset().data,a=this._cachedMeta;if(!1===this._parsing)a._parsed=r;else{let s,n,i=e=>+r[e];if(hr(r[e])){const{key:e="value"}=this._parsing;i=t=>+Tr(r[t],e)}for(s=e,n=e+t;s<n;++s)a._parsed[s]=i(s)}}_getRotation(){return qr(this.options.rotation-90)}_getCircumference(){return qr(this.options.circumference)}_getRotationExtents(){let e=Ir,t=-Ir;for(let r=0;r<this.chart.data.datasets.length;++r)if(this.chart.isDatasetVisible(r)&&this.chart.getDatasetMeta(r).type===this._type){const a=this.chart.getDatasetMeta(r).controller,s=a._getRotation(),n=a._getCircumference();e=Math.min(e,s),t=Math.max(t,s+n)}return{rotation:e,circumference:t-e}}update(e){const t=this.chart,{chartArea:r}=t,a=this._cachedMeta,s=a.data,n=this.getMaxBorderWidth()+this.getMaxOffset(s)+this.options.spacing,i=Math.max((Math.min(r.width,r.height)-n)/2,0),o=Math.min((l=this.options.cutout,c=i,"string"===typeof l&&l.endsWith("%")?parseFloat(l)/100:+l/c),1);var l,c;const d=this._getRingWeight(this.index),{circumference:u,rotation:h}=this._getRotationExtents(),{ratioX:f,ratioY:m,offsetX:p,offsetY:g}=function(e,t,r){let a=1,s=1,n=0,i=0;if(t<Ir){const o=e,l=o+t,c=Math.cos(o),d=Math.sin(o),u=Math.cos(l),h=Math.sin(l),f=(e,t,a)=>Zr(e,o,l,!0)?1:Math.max(t,t*r,a,a*r),m=(e,t,a)=>Zr(e,o,l,!0)?-1:Math.min(t,t*r,a,a*r),p=f(0,c,u),g=f(Fr,d,h),x=m(Pr,c,u),b=m(Pr+Fr,d,h);a=(p-x)/2,s=(g-b)/2,n=-(p+x)/2,i=-(g+b)/2}return{ratioX:a,ratioY:s,offsetX:n,offsetY:i}}(h,u,o),x=(r.width-n)/f,b=(r.height-n)/m,v=Math.max(Math.min(x,b)/2,0),y=gr(this.options.radius,v),w=(y-Math.max(y*o,0))/this._getVisibleDatasetWeightTotal();this.offsetX=p*y,this.offsetY=g*y,a.total=this.calculateTotal(),this.outerRadius=y-w*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-w*d,0),this.updateElements(s,0,s.length,e)}_circumference(e,t){const r=this.options,a=this._cachedMeta,s=this._getCircumference();return t&&r.animation.animateRotate||!this.chart.getDataVisibility(e)||null===a._parsed[e]||a.data[e].hidden?0:this.calculateCircumference(a._parsed[e]*s/Ir)}updateElements(e,t,r,a){const s="reset"===a,n=this.chart,i=n.chartArea,o=n.options.animation,l=(i.left+i.right)/2,c=(i.top+i.bottom)/2,d=s&&o.animateScale,u=d?0:this.innerRadius,h=d?0:this.outerRadius,{sharedOptions:f,includeOptions:m}=this._getSharedOptions(t,a);let p,g=this._getRotation();for(p=0;p<t;++p)g+=this._circumference(p,s);for(p=t;p<t+r;++p){const t=this._circumference(p,s),r=e[p],n={x:l+this.offsetX,y:c+this.offsetY,startAngle:g,endAngle:g+t,circumference:t,outerRadius:h,innerRadius:u};m&&(n.options=f||this.resolveDataElementOptions(p,r.active?"active":a)),g+=t,this.updateElement(r,p,n,a)}}calculateTotal(){const e=this._cachedMeta,t=e.data;let r,a=0;for(r=0;r<t.length;r++){const s=e._parsed[r];null===s||isNaN(s)||!this.chart.getDataVisibility(r)||t[r].hidden||(a+=Math.abs(s))}return a}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?Ir*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,r=this.chart,a=r.data.labels||[],s=ka(t._parsed[e],r.options.locale);return{label:a[e]||"",value:s}}getMaxBorderWidth(e){let t=0;const r=this.chart;let a,s,n,i,o;if(!e)for(a=0,s=r.data.datasets.length;a<s;++a)if(r.isDatasetVisible(a)){n=r.getDatasetMeta(a),e=n.data,i=n.controller;break}if(!e)return 0;for(a=0,s=e.length;a<s;++a)o=i.resolveDataElementOptions(a),"inner"!==o.borderAlign&&(t=Math.max(t,o.borderWidth||0,o.hoverBorderWidth||0));return t}getMaxOffset(e){let t=0;for(let r=0,a=e.length;r<a;++r){const e=this.resolveDataElementOptions(r);t=Math.max(t,e.offset||0,e.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let r=0;r<e;++r)this.chart.isDatasetVisible(r)&&(t+=this._getRingWeight(r));return t}_getRingWeight(e){return Math.max(pr(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}(0,_t.A)(_n,"id","doughnut"),(0,_t.A)(_n,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),(0,_t.A)(_n,"descriptors",{_scriptable:e=>"spacing"!==e,_indexable:e=>"spacing"!==e&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}),(0,_t.A)(_n,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:r,color:a}}=e.legend.options;return t.labels.map((t,s)=>{const n=e.getDatasetMeta(0).controller.getStyle(s);return{text:t,fillStyle:n.backgroundColor,strokeStyle:n.borderColor,fontColor:a,lineWidth:n.borderWidth,pointStyle:r,hidden:!e.getDataVisibility(s),index:s}})}return[]}},onClick(e,t,r){r.chart.toggleDataVisibility(t.index),r.chart.update()}}}});class Cn extends xn{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const t=this._cachedMeta,{dataset:r,data:a=[],_dataset:s}=t,n=this.chart._animationsDisabled;let{start:i,count:o}=ha(t,a,n);this._drawStart=i,this._drawCount=o,fa(t)&&(i=0,o=a.length),r._chart=this.chart,r._datasetIndex=this.index,r._decimated=!!s._decimated,r.points=a;const l=this.resolveDatasetElementOptions(e);this.options.showLine||(l.borderWidth=0),l.segment=this.options.segment,this.updateElement(r,void 0,{animated:!n,options:l},e),this.updateElements(a,i,o,e)}updateElements(e,t,r,a){const s="reset"===a,{iScale:n,vScale:i,_stacked:o,_dataset:l}=this._cachedMeta,{sharedOptions:c,includeOptions:d}=this._getSharedOptions(t,a),u=n.axis,h=i.axis,{spanGaps:f,segment:m}=this.options,p=Vr(f)?f:Number.POSITIVE_INFINITY,g=this.chart._animationsDisabled||s||"none"===a,x=t+r,b=e.length;let v=t>0&&this.getParsed(t-1);for(let y=0;y<b;++y){const r=e[y],f=g?r:{};if(y<t||y>=x){f.skip=!0;continue}const b=this.getParsed(y),w=dr(b[h]),j=f[u]=n.getPixelForValue(b[u],y),N=f[h]=s||w?i.getBasePixel():i.getPixelForValue(o?this.applyStack(i,b,o):b[h],y);f.skip=isNaN(j)||isNaN(N)||w,f.stop=y>0&&Math.abs(b[u]-v[u])>p,m&&(f.parsed=b,f.raw=l.data[y]),d&&(f.options=c||this.resolveDataElementOptions(y,r.active?"active":a)),g||this.updateElement(r,y,f,a),v=b}}getMaxOverflow(){const e=this._cachedMeta,t=e.dataset,r=t.options&&t.options.borderWidth||0,a=e.data||[];if(!a.length)return r;const s=a[0].size(this.resolveDataElementOptions(0)),n=a[a.length-1].size(this.resolveDataElementOptions(a.length-1));return Math.max(r,s,n)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}(0,_t.A)(Cn,"id","line"),(0,_t.A)(Cn,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),(0,_t.A)(Cn,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class An extends xn{constructor(e,t){super(e,t),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){const t=this._cachedMeta,r=this.chart,a=r.data.labels||[],s=ka(t._parsed[e].r,r.options.locale);return{label:a[e]||"",value:s}}parseObjectData(e,t,r,a){return bs.bind(this)(e,t,r,a)}update(e){const t=this._cachedMeta.data;this._updateRadius(),this.updateElements(t,0,t.length,e)}getMinMax(){const e=this._cachedMeta,t={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return e.data.forEach((e,r)=>{const a=this.getParsed(r).r;!isNaN(a)&&this.chart.getDataVisibility(r)&&(a<t.min&&(t.min=a),a>t.max&&(t.max=a))}),t}_updateRadius(){const e=this.chart,t=e.chartArea,r=e.options,a=Math.min(t.right-t.left,t.bottom-t.top),s=Math.max(a/2,0),n=(s-Math.max(r.cutoutPercentage?s/100*r.cutoutPercentage:1,0))/e.getVisibleDatasetCount();this.outerRadius=s-n*this.index,this.innerRadius=this.outerRadius-n}updateElements(e,t,r,a){const s="reset"===a,n=this.chart,i=n.options.animation,o=this._cachedMeta.rScale,l=o.xCenter,c=o.yCenter,d=o.getIndexAngle(0)-.5*Pr;let u,h=d;const f=360/this.countVisibleElements();for(u=0;u<t;++u)h+=this._computeAngle(u,a,f);for(u=t;u<t+r;u++){const t=e[u];let r=h,m=h+this._computeAngle(u,a,f),p=n.getDataVisibility(u)?o.getDistanceFromCenterForValue(this.getParsed(u).r):0;h=m,s&&(i.animateScale&&(p=0),i.animateRotate&&(r=m=d));const g={x:l,y:c,innerRadius:0,outerRadius:p,startAngle:r,endAngle:m,options:this.resolveDataElementOptions(u,t.active?"active":a)};this.updateElement(t,u,g,a)}}countVisibleElements(){const e=this._cachedMeta;let t=0;return e.data.forEach((e,r)=>{!isNaN(this.getParsed(r).r)&&this.chart.getDataVisibility(r)&&t++}),t}_computeAngle(e,t,r){return this.chart.getDataVisibility(e)?qr(this.resolveDataElementOptions(e,t).angle||r):0}}(0,_t.A)(An,"id","polarArea"),(0,_t.A)(An,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),(0,_t.A)(An,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:r,color:a}}=e.legend.options;return t.labels.map((t,s)=>{const n=e.getDatasetMeta(0).controller.getStyle(s);return{text:t,fillStyle:n.backgroundColor,strokeStyle:n.borderColor,fontColor:a,lineWidth:n.borderWidth,pointStyle:r,hidden:!e.getDataVisibility(s),index:s}})}return[]}},onClick(e,t,r){r.chart.toggleDataVisibility(t.index),r.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});class Dn extends _n{}(0,_t.A)(Dn,"id","pie"),(0,_t.A)(Dn,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});class Pn extends xn{getLabelAndValue(e){const t=this._cachedMeta.vScale,r=this.getParsed(e);return{label:t.getLabels()[e],value:""+t.getLabelForValue(r[t.axis])}}parseObjectData(e,t,r,a){return bs.bind(this)(e,t,r,a)}update(e){const t=this._cachedMeta,r=t.dataset,a=t.data||[],s=t.iScale.getLabels();if(r.points=a,"resize"!==e){const t=this.resolveDatasetElementOptions(e);this.options.showLine||(t.borderWidth=0);const n={_loop:!0,_fullLoop:s.length===a.length,options:t};this.updateElement(r,void 0,n,e)}this.updateElements(a,0,a.length,e)}updateElements(e,t,r,a){const s=this._cachedMeta.rScale,n="reset"===a;for(let i=t;i<t+r;i++){const t=e[i],r=this.resolveDataElementOptions(i,t.active?"active":a),o=s.getPointPositionForValue(i,this.getParsed(i).r),l=n?s.xCenter:o.x,c=n?s.yCenter:o.y,d={x:l,y:c,angle:o.angle,skip:isNaN(l)||isNaN(c),options:r};this.updateElement(t,i,d,a)}}}(0,_t.A)(Pn,"id","radar"),(0,_t.A)(Pn,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),(0,_t.A)(Pn,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});class In extends xn{getLabelAndValue(e){const t=this._cachedMeta,r=this.chart.data.labels||[],{xScale:a,yScale:s}=t,n=this.getParsed(e),i=a.getLabelForValue(n.x),o=s.getLabelForValue(n.y);return{label:r[e]||"",value:"("+i+", "+o+")"}}update(e){const t=this._cachedMeta,{data:r=[]}=t,a=this.chart._animationsDisabled;let{start:s,count:n}=ha(t,r,a);if(this._drawStart=s,this._drawCount=n,fa(t)&&(s=0,n=r.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:s,_dataset:n}=t;s._chart=this.chart,s._datasetIndex=this.index,s._decimated=!!n._decimated,s.points=r;const i=this.resolveDatasetElementOptions(e);i.segment=this.options.segment,this.updateElement(s,void 0,{animated:!a,options:i},e)}else this.datasetElementType&&(delete t.dataset,this.datasetElementType=!1);this.updateElements(r,s,n,e)}addElements(){const{showLine:e}=this.options;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(e,t,r,a){const s="reset"===a,{iScale:n,vScale:i,_stacked:o,_dataset:l}=this._cachedMeta,c=this.resolveDataElementOptions(t,a),d=this.getSharedOptions(c),u=this.includeOptions(a,d),h=n.axis,f=i.axis,{spanGaps:m,segment:p}=this.options,g=Vr(m)?m:Number.POSITIVE_INFINITY,x=this.chart._animationsDisabled||s||"none"===a;let b=t>0&&this.getParsed(t-1);for(let v=t;v<t+r;++v){const t=e[v],r=this.getParsed(v),c=x?t:{},m=dr(r[f]),y=c[h]=n.getPixelForValue(r[h],v),w=c[f]=s||m?i.getBasePixel():i.getPixelForValue(o?this.applyStack(i,r,o):r[f],v);c.skip=isNaN(y)||isNaN(w)||m,c.stop=v>0&&Math.abs(r[h]-b[h])>g,p&&(c.parsed=r,c.raw=l.data[v]),u&&(c.options=d||this.resolveDataElementOptions(v,t.active?"active":a)),x||this.updateElement(t,v,c,a),b=r}this.updateSharedOptions(d,a,c)}getMaxOverflow(){const e=this._cachedMeta,t=e.data||[];if(!this.options.showLine){let e=0;for(let r=t.length-1;r>=0;--r)e=Math.max(e,t[r].size(this.resolveDataElementOptions(r))/2);return e>0&&e}const r=e.dataset,a=r.options&&r.options.borderWidth||0;if(!t.length)return a;const s=t[0].size(this.resolveDataElementOptions(0)),n=t[t.length-1].size(this.resolveDataElementOptions(t.length-1));return Math.max(a,s,n)/2}}(0,_t.A)(In,"id","scatter"),(0,_t.A)(In,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),(0,_t.A)(In,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});function On(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Rn{static override(e){Object.assign(Rn.prototype,e)}constructor(e){(0,_t.A)(this,"options",void 0),this.options=e||{}}init(){}formats(){return On()}parse(){return On()}format(){return On()}add(){return On()}diff(){return On()}startOf(){return On()}endOf(){return On()}}var Mn=Rn;function Fn(e,t,r,a){const{controller:s,data:n,_sorted:i}=e,o=s._cachedMeta.iScale,l=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null;if(o&&t===o.axis&&"r"!==t&&i&&n.length){const i=o._reversePixels?sa:aa;if(!a){const a=i(n,t,r);if(l){const{vScale:t}=s._cachedMeta,{_parsed:r}=e,n=r.slice(0,a.lo+1).reverse().findIndex(e=>!dr(e[t.axis]));a.lo-=Math.max(0,n);const i=r.slice(a.hi).findIndex(e=>!dr(e[t.axis]));a.hi+=Math.max(0,i)}return a}if(s._sharedOptions){const e=n[0],a="function"===typeof e.getRange&&e.getRange(t);if(a){const e=i(n,t,r-a),s=i(n,t,r+a);return{lo:e.lo,hi:s.hi}}}}return{lo:0,hi:n.length-1}}function Ln(e,t,r,a,s){const n=e.getSortedVisibleDatasetMetas(),i=r[t];for(let o=0,l=n.length;o<l;++o){const{index:e,data:r}=n[o],{lo:l,hi:c}=Fn(n[o],t,i,s);for(let t=l;t<=c;++t){const s=r[t];s.skip||a(s,e,t)}}}function zn(e,t,r,a,s){const n=[];if(!s&&!e.isPointInArea(t))return n;return Ln(e,r,t,function(r,i,o){(s||za(r,e.chartArea,0))&&r.inRange(t.x,t.y,a)&&n.push({element:r,datasetIndex:i,index:o})},!0),n}function Bn(e,t,r,a,s,n){let i=[];const o=function(e){const t=-1!==e.indexOf("x"),r=-1!==e.indexOf("y");return function(e,a){const s=t?Math.abs(e.x-a.x):0,n=r?Math.abs(e.y-a.y):0;return Math.sqrt(Math.pow(s,2)+Math.pow(n,2))}}(r);let l=Number.POSITIVE_INFINITY;return Ln(e,r,t,function(r,c,d){const u=r.inRange(t.x,t.y,s);if(a&&!u)return;const h=r.getCenterPoint(s);if(!(!!n||e.isPointInArea(h))&&!u)return;const f=o(t,h);f<l?(i=[{element:r,datasetIndex:c,index:d}],l=f):f===l&&i.push({element:r,datasetIndex:c,index:d})}),i}function Un(e,t,r,a,s,n){return n||e.isPointInArea(t)?"r"!==r||a?Bn(e,t,r,a,s,n):function(e,t,r,a){let s=[];return Ln(e,r,t,function(e,r,n){const{startAngle:i,endAngle:o}=e.getProps(["startAngle","endAngle"],a),{angle:l}=Yr(e,{x:t.x,y:t.y});Zr(l,i,o)&&s.push({element:e,datasetIndex:r,index:n})}),s}(e,t,r,s):[]}function Wn(e,t,r,a,s){const n=[],i="x"===r?"inXRange":"inYRange";let o=!1;return Ln(e,r,t,(e,a,l)=>{e[i]&&e[i](t[r],s)&&(n.push({element:e,datasetIndex:a,index:l}),o=o||e.inRange(t.x,t.y,s))}),a&&!o?[]:n}var Hn={evaluateInteractionItems:Ln,modes:{index(e,t,r,a){const s=Ps(t,e),n=r.axis||"x",i=r.includeInvisible||!1,o=r.intersect?zn(e,s,n,a,i):Un(e,s,n,!1,a,i),l=[];return o.length?(e.getSortedVisibleDatasetMetas().forEach(e=>{const t=o[0].index,r=e.data[t];r&&!r.skip&&l.push({element:r,datasetIndex:e.index,index:t})}),l):[]},dataset(e,t,r,a){const s=Ps(t,e),n=r.axis||"xy",i=r.includeInvisible||!1;let o=r.intersect?zn(e,s,n,a,i):Un(e,s,n,!1,a,i);if(o.length>0){const t=o[0].datasetIndex,r=e.getDatasetMeta(t).data;o=[];for(let e=0;e<r.length;++e)o.push({element:r[e],datasetIndex:t,index:e})}return o},point:(e,t,r,a)=>zn(e,Ps(t,e),r.axis||"xy",a,r.includeInvisible||!1),nearest(e,t,r,a){const s=Ps(t,e),n=r.axis||"xy",i=r.includeInvisible||!1;return Un(e,s,n,r.intersect,a,i)},x:(e,t,r,a)=>Wn(e,Ps(t,e),"x",r.intersect,a),y:(e,t,r,a)=>Wn(e,Ps(t,e),"y",r.intersect,a)}};const Vn=["left","top","right","bottom"];function Gn(e,t){return e.filter(e=>e.pos===t)}function qn(e,t){return e.filter(e=>-1===Vn.indexOf(e.pos)&&e.box.axis===t)}function $n(e,t){return e.sort((e,r)=>{const a=t?r:e,s=t?e:r;return a.weight===s.weight?a.index-s.index:a.weight-s.weight})}function Kn(e,t){const r=function(e){const t={};for(const r of e){const{stack:e,pos:a,stackWeight:s}=r;if(!e||!Vn.includes(a))continue;const n=t[e]||(t[e]={count:0,placed:0,weight:0,size:0});n.count++,n.weight+=s}return t}(e),{vBoxMaxWidth:a,hBoxMaxHeight:s}=t;let n,i,o;for(n=0,i=e.length;n<i;++n){o=e[n];const{fullSize:i}=o.box,l=r[o.stack],c=l&&o.stackWeight/l.weight;o.horizontal?(o.width=c?c*a:i&&t.availableWidth,o.height=s):(o.width=a,o.height=c?c*s:i&&t.availableHeight)}return r}function Yn(e,t,r,a){return Math.max(e[r],t[r])+Math.max(e[a],t[a])}function Jn(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function Xn(e,t,r,a){const{pos:s,box:n}=r,i=e.maxPadding;if(!hr(s)){r.size&&(e[s]-=r.size);const t=a[r.stack]||{size:0,count:1};t.size=Math.max(t.size,r.horizontal?n.height:n.width),r.size=t.size/t.count,e[s]+=r.size}n.getPadding&&Jn(i,n.getPadding());const o=Math.max(0,t.outerWidth-Yn(i,e,"left","right")),l=Math.max(0,t.outerHeight-Yn(i,e,"top","bottom")),c=o!==e.w,d=l!==e.h;return e.w=o,e.h=l,r.horizontal?{same:c,other:d}:{same:d,other:c}}function Qn(e,t){const r=t.maxPadding;function a(e){const a={left:0,top:0,right:0,bottom:0};return e.forEach(e=>{a[e]=Math.max(t[e],r[e])}),a}return a(e?["left","right"]:["top","bottom"])}function Zn(e,t,r,a){const s=[];let n,i,o,l,c,d;for(n=0,i=e.length,c=0;n<i;++n){o=e[n],l=o.box,l.update(o.width||t.w,o.height||t.h,Qn(o.horizontal,t));const{same:i,other:u}=Xn(t,r,o,a);c|=i&&s.length,d=d||u,l.fullSize||s.push(o)}return c&&Zn(s,t,r,a)||d}function ei(e,t,r,a,s){e.top=r,e.left=t,e.right=t+a,e.bottom=r+s,e.width=a,e.height=s}function ti(e,t,r,a){const s=r.padding;let{x:n,y:i}=t;for(const o of e){const e=o.box,l=a[o.stack]||{count:1,placed:0,weight:1},c=o.stackWeight/l.weight||1;if(o.horizontal){const a=t.w*c,n=l.size||e.height;Cr(l.start)&&(i=l.start),e.fullSize?ei(e,s.left,i,r.outerWidth-s.right-s.left,n):ei(e,t.left+l.placed,i,a,n),l.start=i,l.placed+=a,i=e.bottom}else{const a=t.h*c,i=l.size||e.width;Cr(l.start)&&(n=l.start),e.fullSize?ei(e,n,s.top,i,r.outerHeight-s.bottom-s.top):ei(e,n,t.top+l.placed,i,a),l.start=n,l.placed+=a,n=e.right}}t.x=n,t.y=i}var ri={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(e){t.draw(e)}}]},e.boxes.push(t)},removeBox(e,t){const r=e.boxes?e.boxes.indexOf(t):-1;-1!==r&&e.boxes.splice(r,1)},configure(e,t,r){t.fullSize=r.fullSize,t.position=r.position,t.weight=r.weight},update(e,t,r,a){if(!e)return;const s=ts(e.options.layout.padding),n=Math.max(t-s.width,0),i=Math.max(r-s.height,0),o=function(e){const t=function(e){const t=[];let r,a,s,n,i,o;for(r=0,a=(e||[]).length;r<a;++r)s=e[r],({position:n,options:{stack:i,stackWeight:o=1}}=s),t.push({index:r,box:s,pos:n,horizontal:s.isHorizontal(),weight:s.weight,stack:i&&n+i,stackWeight:o});return t}(e),r=$n(t.filter(e=>e.box.fullSize),!0),a=$n(Gn(t,"left"),!0),s=$n(Gn(t,"right")),n=$n(Gn(t,"top"),!0),i=$n(Gn(t,"bottom")),o=qn(t,"x"),l=qn(t,"y");return{fullSize:r,leftAndTop:a.concat(n),rightAndBottom:s.concat(l).concat(i).concat(o),chartArea:Gn(t,"chartArea"),vertical:a.concat(s).concat(l),horizontal:n.concat(i).concat(o)}}(e.boxes),l=o.vertical,c=o.horizontal;br(e.boxes,e=>{"function"===typeof e.beforeLayout&&e.beforeLayout()});const d=l.reduce((e,t)=>t.box.options&&!1===t.box.options.display?e:e+1,0)||1,u=Object.freeze({outerWidth:t,outerHeight:r,padding:s,availableWidth:n,availableHeight:i,vBoxMaxWidth:n/2/d,hBoxMaxHeight:i/2}),h=Object.assign({},s);Jn(h,ts(a));const f=Object.assign({maxPadding:h,w:n,h:i,x:s.left,y:s.top},s),m=Kn(l.concat(c),u);Zn(o.fullSize,f,u,m),Zn(l,f,u,m),Zn(c,f,u,m)&&Zn(l,f,u,m),function(e){const t=e.maxPadding;function r(r){const a=Math.max(t[r]-e[r],0);return e[r]+=a,a}e.y+=r("top"),e.x+=r("left"),r("right"),r("bottom")}(f),ti(o.leftAndTop,f,u,m),f.x+=f.w,f.y+=f.h,ti(o.rightAndBottom,f,u,m),e.chartArea={left:f.left,top:f.top,right:f.left+f.w,bottom:f.top+f.h,height:f.h,width:f.w},br(o.chartArea,t=>{const r=t.box;Object.assign(r,e.chartArea),r.update(f.w,f.h,{left:0,top:0,right:0,bottom:0})})}};class ai{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,r){}removeEventListener(e,t,r){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,r,a){return t=Math.max(0,t||e.width),r=r||e.height,{width:t,height:Math.max(0,a?Math.floor(t/a):r)}}isAttached(e){return!0}updateConfig(e){}}class si extends ai{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const ni="$chartjs",ii={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},oi=e=>null===e||""===e;const li=!!Ms&&{passive:!0};function ci(e,t,r){e&&e.canvas&&e.canvas.removeEventListener(t,r,li)}function di(e,t){for(const r of e)if(r===t||r.contains(t))return!0}function ui(e,t,r){const a=e.canvas,s=new MutationObserver(e=>{let t=!1;for(const r of e)t=t||di(r.addedNodes,a),t=t&&!di(r.removedNodes,a);t&&r()});return s.observe(document,{childList:!0,subtree:!0}),s}function hi(e,t,r){const a=e.canvas,s=new MutationObserver(e=>{let t=!1;for(const r of e)t=t||di(r.removedNodes,a),t=t&&!di(r.addedNodes,a);t&&r()});return s.observe(document,{childList:!0,subtree:!0}),s}const fi=new Map;let mi=0;function pi(){const e=window.devicePixelRatio;e!==mi&&(mi=e,fi.forEach((t,r)=>{r.currentDevicePixelRatio!==e&&t()}))}function gi(e,t,r){const a=e.canvas,s=a&&Ts(a);if(!s)return;const n=ca((e,t)=>{const a=s.clientWidth;r(e,t),a<s.clientWidth&&r()},window),i=new ResizeObserver(e=>{const t=e[0],r=t.contentRect.width,a=t.contentRect.height;0===r&&0===a||n(r,a)});return i.observe(s),function(e,t){fi.size||window.addEventListener("resize",pi),fi.set(e,t)}(e,n),i}function xi(e,t,r){r&&r.disconnect(),"resize"===t&&function(e){fi.delete(e),fi.size||window.removeEventListener("resize",pi)}(e)}function bi(e,t,r){const a=e.canvas,s=ca(t=>{null!==e.ctx&&r(function(e,t){const r=ii[e.type]||e.type,{x:a,y:s}=Ps(e,t);return{type:r,chart:t,native:e,x:void 0!==a?a:null,y:void 0!==s?s:null}}(t,e))},e);return function(e,t,r){e&&e.addEventListener(t,r,li)}(a,t,s),s}class vi extends ai{acquireContext(e,t){const r=e&&e.getContext&&e.getContext("2d");return r&&r.canvas===e?(function(e,t){const r=e.style,a=e.getAttribute("height"),s=e.getAttribute("width");if(e[ni]={initial:{height:a,width:s,style:{display:r.display,height:r.height,width:r.width}}},r.display=r.display||"block",r.boxSizing=r.boxSizing||"border-box",oi(s)){const t=Fs(e,"width");void 0!==t&&(e.width=t)}if(oi(a))if(""===e.style.height)e.height=e.width/(t||2);else{const t=Fs(e,"height");void 0!==t&&(e.height=t)}}(e,t),r):null}releaseContext(e){const t=e.canvas;if(!t[ni])return!1;const r=t[ni].initial;["height","width"].forEach(e=>{const a=r[e];dr(a)?t.removeAttribute(e):t.setAttribute(e,a)});const a=r.style||{};return Object.keys(a).forEach(e=>{t.style[e]=a[e]}),t.width=t.width,delete t[ni],!0}addEventListener(e,t,r){this.removeEventListener(e,t);const a=e.$proxies||(e.$proxies={}),s={attach:ui,detach:hi,resize:gi}[t]||bi;a[t]=s(e,t,r)}removeEventListener(e,t){const r=e.$proxies||(e.$proxies={}),a=r[t];if(!a)return;({attach:xi,detach:xi,resize:xi}[t]||ci)(e,t,a),r[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,r,a){return Os(e,t,r,a)}isAttached(e){const t=e&&Ts(e);return!(!t||!t.isConnected)}}class yi{constructor(){(0,_t.A)(this,"x",void 0),(0,_t.A)(this,"y",void 0),(0,_t.A)(this,"active",!1),(0,_t.A)(this,"options",void 0),(0,_t.A)(this,"$animations",void 0)}tooltipPosition(e){const{x:t,y:r}=this.getProps(["x","y"],e);return{x:t,y:r}}hasValue(){return Vr(this.x)&&Vr(this.y)}getProps(e,t){const r=this.$animations;if(!t||!r)return this;const a={};return e.forEach(e=>{a[e]=r[e]&&r[e].active()?r[e]._to:this[e]}),a}}function wi(e,t){const r=e.options.ticks,a=function(e){const t=e.options.offset,r=e._tickSize(),a=e._length/r+(t?0:1),s=e._maxLength/r;return Math.floor(Math.min(a,s))}(e),s=Math.min(r.maxTicksLimit||a,a),n=r.major.enabled?function(e){const t=[];let r,a;for(r=0,a=e.length;r<a;r++)e[r].major&&t.push(r);return t}(t):[],i=n.length,o=n[0],l=n[i-1],c=[];if(i>s)return function(e,t,r,a){let s,n=0,i=r[0];for(a=Math.ceil(a),s=0;s<e.length;s++)s===i&&(t.push(e[s]),n++,i=r[n*a])}(t,c,n,i/s),c;const d=function(e,t,r){const a=function(e){const t=e.length;let r,a;if(t<2)return!1;for(a=e[0],r=1;r<t;++r)if(e[r]-e[r-1]!==a)return!1;return a}(e),s=t.length/r;if(!a)return Math.max(s,1);const n=function(e){const t=[],r=Math.sqrt(e);let a;for(a=1;a<r;a++)e%a===0&&(t.push(a),t.push(e/a));return r===(0|r)&&t.push(r),t.sort((e,t)=>e-t).pop(),t}(a);for(let i=0,o=n.length-1;i<o;i++){const e=n[i];if(e>s)return e}return Math.max(s,1)}(n,t,s);if(i>0){let e,r;const a=i>1?Math.round((l-o)/(i-1)):null;for(ji(t,c,d,dr(a)?0:o-a,o),e=0,r=i-1;e<r;e++)ji(t,c,d,n[e],n[e+1]);return ji(t,c,d,l,dr(a)?t.length:l+a),c}return ji(t,c,d),c}function ji(e,t,r,a,s){const n=pr(a,0),i=Math.min(pr(s,e.length),e.length);let o,l,c,d=0;for(r=Math.ceil(r),s&&(o=s-a,r=o/Math.floor(o/r)),c=n;c<0;)d++,c=Math.round(n+d*r);for(l=Math.max(n,0);l<i;l++)l===c&&(t.push(e[l]),d++,c=Math.round(n+d*r))}(0,_t.A)(yi,"defaults",{}),(0,_t.A)(yi,"defaultRoutes",void 0);const Ni=(e,t,r)=>"top"===t||"left"===t?e[t]+r:e[t]-r,ki=(e,t)=>Math.min(t||e,e);function Si(e,t){const r=[],a=e.length/t,s=e.length;let n=0;for(;n<s;n+=a)r.push(e[Math.floor(n)]);return r}function Ei(e,t,r){const a=e.ticks.length,s=Math.min(t,a-1),n=e._startPixel,i=e._endPixel,o=1e-6;let l,c=e.getPixelForTick(s);if(!(r&&(l=1===a?Math.max(c-n,i-c):0===t?(e.getPixelForTick(1)-c)/2:(c-e.getPixelForTick(s-1))/2,c+=s<t?l:-l,c<n-o||c>i+o)))return c}function Ti(e){return e.drawTicks?e.tickLength:0}function _i(e,t){if(!e.display)return 0;const r=rs(e.font,t),a=ts(e.padding);return(ur(e.text)?e.text.length:1)*r.lineHeight+a.height}function Ci(e,t,r){let a=da(e);return(r&&"right"!==t||!r&&"right"===t)&&(a=(e=>"left"===e?"right":"right"===e?"left":e)(a)),a}class Ai extends yi{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:r,_suggestedMax:a}=this;return e=mr(e,Number.POSITIVE_INFINITY),t=mr(t,Number.NEGATIVE_INFINITY),r=mr(r,Number.POSITIVE_INFINITY),a=mr(a,Number.NEGATIVE_INFINITY),{min:mr(e,r),max:mr(t,a),minDefined:fr(e),maxDefined:fr(t)}}getMinMax(e){let t,{min:r,max:a,minDefined:s,maxDefined:n}=this.getUserBounds();if(s&&n)return{min:r,max:a};const i=this.getMatchingVisibleMetas();for(let o=0,l=i.length;o<l;++o)t=i[o].controller.getMinMax(this,e),s||(r=Math.min(r,t.min)),n||(a=Math.max(a,t.max));return r=n&&r>a?a:r,a=s&&r>a?r:a,{min:mr(r,mr(a,r)),max:mr(a,mr(r,a))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.chart.chartArea;return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){xr(this.options.beforeUpdate,[this])}update(e,t,r){const{beginAtZero:a,grace:s,ticks:n}=this.options,i=n.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=r=Object.assign({left:0,right:0,top:0,bottom:0},r),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+r.left+r.right:this.height+r.top+r.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=function(e,t,r){const{min:a,max:s}=e,n=gr(t,(s-a)/2),i=(e,t)=>r&&0===e?0:e+t;return{min:i(a,-Math.abs(n)),max:i(s,n)}}(this,s,a),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const o=i<this.ticks.length;this._convertTicksToLabels(o?Si(this.ticks,i):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),n.display&&(n.autoSkip||"auto"===n.source)&&(this.ticks=wi(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),o&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e,t,r=this.options.reverse;this.isHorizontal()?(e=this.left,t=this.right):(e=this.top,t=this.bottom,r=!r),this._startPixel=e,this._endPixel=t,this._reversePixels=r,this._length=t-e,this._alignToPixels=this.options.alignToPixels}afterUpdate(){xr(this.options.afterUpdate,[this])}beforeSetDimensions(){xr(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){xr(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),xr(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){xr(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let r,a,s;for(r=0,a=e.length;r<a;r++)s=e[r],s.label=xr(t.callback,[s.value,r,e],this)}afterTickToLabelConversion(){xr(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){xr(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,r=ki(this.ticks.length,e.ticks.maxTicksLimit),a=t.minRotation||0,s=t.maxRotation;let n,i,o,l=a;if(!this._isVisible()||!t.display||a>=s||r<=1||!this.isHorizontal())return void(this.labelRotation=a);const c=this._getLabelSizes(),d=c.widest.width,u=c.highest.height,h=ea(this.chart.width-d,0,this.maxWidth);n=e.offset?this.maxWidth/r:h/(r-1),d+6>n&&(n=h/(r-(e.offset?.5:1)),i=this.maxHeight-Ti(e.grid)-t.padding-_i(e.title,this.chart.options.font),o=Math.sqrt(d*d+u*u),l=$r(Math.min(Math.asin(ea((c.highest.height+6)/n,-1,1)),Math.asin(ea(i/o,-1,1))-Math.asin(ea(u/o,-1,1)))),l=Math.max(a,Math.min(s,l))),this.labelRotation=l}afterCalculateLabelRotation(){xr(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){xr(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:r,title:a,grid:s}}=this,n=this._isVisible(),i=this.isHorizontal();if(n){const n=_i(a,t.options.font);if(i?(e.width=this.maxWidth,e.height=Ti(s)+n):(e.height=this.maxHeight,e.width=Ti(s)+n),r.display&&this.ticks.length){const{first:t,last:a,widest:s,highest:n}=this._getLabelSizes(),o=2*r.padding,l=qr(this.labelRotation),c=Math.cos(l),d=Math.sin(l);if(i){const t=r.mirror?0:d*s.width+c*n.height;e.height=Math.min(this.maxHeight,e.height+t+o)}else{const t=r.mirror?0:c*s.width+d*n.height;e.width=Math.min(this.maxWidth,e.width+t+o)}this._calculatePadding(t,a,d,c)}}this._handleMargins(),i?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,r,a){const{ticks:{align:s,padding:n},position:i}=this.options,o=0!==this.labelRotation,l="top"!==i&&"x"===this.axis;if(this.isHorizontal()){const i=this.getPixelForTick(0)-this.left,c=this.right-this.getPixelForTick(this.ticks.length-1);let d=0,u=0;o?l?(d=a*e.width,u=r*t.height):(d=r*e.height,u=a*t.width):"start"===s?u=t.width:"end"===s?d=e.width:"inner"!==s&&(d=e.width/2,u=t.width/2),this.paddingLeft=Math.max((d-i+n)*this.width/(this.width-i),0),this.paddingRight=Math.max((u-c+n)*this.width/(this.width-c),0)}else{let r=t.height/2,a=e.height/2;"start"===s?(r=0,a=e.height):"end"===s&&(r=t.height,a=0),this.paddingTop=r+n,this.paddingBottom=a+n}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){xr(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return"top"===t||"bottom"===t||"x"===e}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){let t,r;for(this.beforeTickToLabelConversion(),this.generateTickLabels(e),t=0,r=e.length;t<r;t++)dr(e[t].label)&&(e.splice(t,1),r--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let r=this.ticks;t<r.length&&(r=Si(r,t)),this._labelSizes=e=this._computeLabelSizes(r,r.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,r){const{ctx:a,_longestTextCache:s}=this,n=[],i=[],o=Math.floor(t/ki(t,r));let l,c,d,u,h,f,m,p,g,x,b,v=0,y=0;for(l=0;l<t;l+=o){if(u=e[l].label,h=this._resolveTickFontOptions(l),a.font=f=h.string,m=s[f]=s[f]||{data:{},gc:[]},p=h.lineHeight,g=x=0,dr(u)||ur(u)){if(ur(u))for(c=0,d=u.length;c<d;++c)b=u[c],dr(b)||ur(b)||(g=Ia(a,m.data,m.gc,g,b),x+=p)}else g=Ia(a,m.data,m.gc,g,u),x=p;n.push(g),i.push(x),v=Math.max(g,v),y=Math.max(x,y)}!function(e,t){br(e,e=>{const r=e.gc,a=r.length/2;let s;if(a>t){for(s=0;s<a;++s)delete e.data[r[s]];r.splice(0,a)}})}(s,t);const w=n.indexOf(v),j=i.indexOf(y),N=e=>({width:n[e]||0,height:i[e]||0});return{first:N(0),last:N(t-1),widest:N(w),highest:N(j),widths:n,heights:i}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return ea(this._alignToPixels?Ra(this.chart,t,0):t,-32768,32767)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const r=t[e];return r.$context||(r.$context=function(e,t,r){return ss(e,{tick:r,index:t,type:"tick"})}(this.getContext(),e,r))}return this.$context||(this.$context=ss(this.chart.getContext(),{scale:this,type:"scale"}))}_tickSize(){const e=this.options.ticks,t=qr(this.labelRotation),r=Math.abs(Math.cos(t)),a=Math.abs(Math.sin(t)),s=this._getLabelSizes(),n=e.autoSkipPadding||0,i=s?s.widest.width+n:0,o=s?s.highest.height+n:0;return this.isHorizontal()?o*r>i*a?i/r:o/a:o*a<i*r?o/r:i/a}_isVisible(){const e=this.options.display;return"auto"!==e?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,r=this.chart,a=this.options,{grid:s,position:n,border:i}=a,o=s.offset,l=this.isHorizontal(),c=this.ticks.length+(o?1:0),d=Ti(s),u=[],h=i.setContext(this.getContext()),f=h.display?h.width:0,m=f/2,p=function(e){return Ra(r,e,f)};let g,x,b,v,y,w,j,N,k,S,E,T;if("top"===n)g=p(this.bottom),w=this.bottom-d,N=g-m,S=p(e.top)+m,T=e.bottom;else if("bottom"===n)g=p(this.top),S=e.top,T=p(e.bottom)-m,w=g+m,N=this.top+d;else if("left"===n)g=p(this.right),y=this.right-d,j=g-m,k=p(e.left)+m,E=e.right;else if("right"===n)g=p(this.left),k=e.left,E=p(e.right)-m,y=g+m,j=this.left+d;else if("x"===t){if("center"===n)g=p((e.top+e.bottom)/2+.5);else if(hr(n)){const e=Object.keys(n)[0],t=n[e];g=p(this.chart.scales[e].getPixelForValue(t))}S=e.top,T=e.bottom,w=g+m,N=w+d}else if("y"===t){if("center"===n)g=p((e.left+e.right)/2);else if(hr(n)){const e=Object.keys(n)[0],t=n[e];g=p(this.chart.scales[e].getPixelForValue(t))}y=g-m,j=y-d,k=e.left,E=e.right}const _=pr(a.ticks.maxTicksLimit,c),C=Math.max(1,Math.ceil(c/_));for(x=0;x<c;x+=C){const e=this.getContext(x),t=s.setContext(e),a=i.setContext(e),n=t.lineWidth,c=t.color,d=a.dash||[],h=a.dashOffset,f=t.tickWidth,m=t.tickColor,p=t.tickBorderDash||[],g=t.tickBorderDashOffset;b=Ei(this,x,o),void 0!==b&&(v=Ra(r,b,n),l?y=j=k=E=v:w=N=S=T=v,u.push({tx1:y,ty1:w,tx2:j,ty2:N,x1:k,y1:S,x2:E,y2:T,width:n,color:c,borderDash:d,borderDashOffset:h,tickWidth:f,tickColor:m,tickBorderDash:p,tickBorderDashOffset:g}))}return this._ticksLength=c,this._borderValue=g,u}_computeLabelItems(e){const t=this.axis,r=this.options,{position:a,ticks:s}=r,n=this.isHorizontal(),i=this.ticks,{align:o,crossAlign:l,padding:c,mirror:d}=s,u=Ti(r.grid),h=u+c,f=d?-c:h,m=-qr(this.labelRotation),p=[];let g,x,b,v,y,w,j,N,k,S,E,T,_="middle";if("top"===a)w=this.bottom-f,j=this._getXAxisLabelAlignment();else if("bottom"===a)w=this.top+f,j=this._getXAxisLabelAlignment();else if("left"===a){const e=this._getYAxisLabelAlignment(u);j=e.textAlign,y=e.x}else if("right"===a){const e=this._getYAxisLabelAlignment(u);j=e.textAlign,y=e.x}else if("x"===t){if("center"===a)w=(e.top+e.bottom)/2+h;else if(hr(a)){const e=Object.keys(a)[0],t=a[e];w=this.chart.scales[e].getPixelForValue(t)+h}j=this._getXAxisLabelAlignment()}else if("y"===t){if("center"===a)y=(e.left+e.right)/2-h;else if(hr(a)){const e=Object.keys(a)[0],t=a[e];y=this.chart.scales[e].getPixelForValue(t)}j=this._getYAxisLabelAlignment(u).textAlign}"y"===t&&("start"===o?_="top":"end"===o&&(_="bottom"));const C=this._getLabelSizes();for(g=0,x=i.length;g<x;++g){b=i[g],v=b.label;const e=s.setContext(this.getContext(g));N=this.getPixelForTick(g)+s.labelOffset,k=this._resolveTickFontOptions(g),S=k.lineHeight,E=ur(v)?v.length:1;const t=E/2,r=e.color,o=e.textStrokeColor,c=e.textStrokeWidth;let u,h=j;if(n?(y=N,"inner"===j&&(h=g===x-1?this.options.reverse?"left":"right":0===g?this.options.reverse?"right":"left":"center"),T="top"===a?"near"===l||0!==m?-E*S+S/2:"center"===l?-C.highest.height/2-t*S+S:-C.highest.height+S/2:"near"===l||0!==m?S/2:"center"===l?C.highest.height/2-t*S:C.highest.height-E*S,d&&(T*=-1),0===m||e.showLabelBackdrop||(y+=S/2*Math.sin(m))):(w=N,T=(1-E)*S/2),e.showLabelBackdrop){const t=ts(e.backdropPadding),r=C.heights[g],a=C.widths[g];let s=T-t.top,n=0-t.left;switch(_){case"middle":s-=r/2;break;case"bottom":s-=r}switch(j){case"center":n-=a/2;break;case"right":n-=a;break;case"inner":g===x-1?n-=a:g>0&&(n-=a/2)}u={left:n,top:s,width:a+t.width,height:r+t.height,color:e.backdropColor}}p.push({label:v,font:k,textOffset:T,options:{rotation:m,color:r,strokeColor:o,strokeWidth:c,textAlign:h,textBaseline:_,translation:[y,w],backdrop:u}})}return p}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-qr(this.labelRotation))return"top"===e?"left":"right";let r="center";return"start"===t.align?r="left":"end"===t.align?r="right":"inner"===t.align&&(r="inner"),r}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:r,mirror:a,padding:s}}=this.options,n=e+s,i=this._getLabelSizes().widest.width;let o,l;return"left"===t?a?(l=this.right+s,"near"===r?o="left":"center"===r?(o="center",l+=i/2):(o="right",l+=i)):(l=this.right-n,"near"===r?o="right":"center"===r?(o="center",l-=i/2):(o="left",l=this.left)):"right"===t?a?(l=this.left+s,"near"===r?o="right":"center"===r?(o="center",l-=i/2):(o="left",l-=i)):(l=this.left+n,"near"===r?o="left":"center"===r?(o="center",l+=i/2):(o="right",l=this.right)):o="right",{textAlign:o,x:l}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;return"left"===t||"right"===t?{top:0,left:this.left,bottom:e.height,right:this.right}:"top"===t||"bottom"===t?{top:this.top,left:0,bottom:this.bottom,right:e.width}:void 0}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:r,top:a,width:s,height:n}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(r,a,s,n),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const r=this.ticks.findIndex(t=>t.value===e);if(r>=0){return t.setContext(this.getContext(r)).lineWidth}return 0}drawGrid(e){const t=this.options.grid,r=this.ctx,a=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let s,n;const i=(e,t,a)=>{a.width&&a.color&&(r.save(),r.lineWidth=a.width,r.strokeStyle=a.color,r.setLineDash(a.borderDash||[]),r.lineDashOffset=a.borderDashOffset,r.beginPath(),r.moveTo(e.x,e.y),r.lineTo(t.x,t.y),r.stroke(),r.restore())};if(t.display)for(s=0,n=a.length;s<n;++s){const e=a[s];t.drawOnChartArea&&i({x:e.x1,y:e.y1},{x:e.x2,y:e.y2},e),t.drawTicks&&i({x:e.tx1,y:e.ty1},{x:e.tx2,y:e.ty2},{color:e.tickColor,width:e.tickWidth,borderDash:e.tickBorderDash,borderDashOffset:e.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:r,grid:a}}=this,s=r.setContext(this.getContext()),n=r.display?s.width:0;if(!n)return;const i=a.setContext(this.getContext(0)).lineWidth,o=this._borderValue;let l,c,d,u;this.isHorizontal()?(l=Ra(e,this.left,n)-n/2,c=Ra(e,this.right,i)+i/2,d=u=o):(d=Ra(e,this.top,n)-n/2,u=Ra(e,this.bottom,i)+i/2,l=c=o),t.save(),t.lineWidth=s.width,t.strokeStyle=s.color,t.beginPath(),t.moveTo(l,d),t.lineTo(c,u),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const t=this.ctx,r=this._computeLabelArea();r&&Ba(t,r);const a=this.getLabelItems(e);for(const s of a){const e=s.options,r=s.font;qa(t,s.label,0,s.textOffset,r,e)}r&&Ua(t)}drawTitle(){const{ctx:e,options:{position:t,title:r,reverse:a}}=this;if(!r.display)return;const s=rs(r.font),n=ts(r.padding),i=r.align;let o=s.lineHeight/2;"bottom"===t||"center"===t||hr(t)?(o+=n.bottom,ur(r.text)&&(o+=s.lineHeight*(r.text.length-1))):o+=n.top;const{titleX:l,titleY:c,maxWidth:d,rotation:u}=function(e,t,r,a){const{top:s,left:n,bottom:i,right:o,chart:l}=e,{chartArea:c,scales:d}=l;let u,h,f,m=0;const p=i-s,g=o-n;if(e.isHorizontal()){if(h=ua(a,n,o),hr(r)){const e=Object.keys(r)[0],a=r[e];f=d[e].getPixelForValue(a)+p-t}else f="center"===r?(c.bottom+c.top)/2+p-t:Ni(e,r,t);u=o-n}else{if(hr(r)){const e=Object.keys(r)[0],a=r[e];h=d[e].getPixelForValue(a)-g+t}else h="center"===r?(c.left+c.right)/2-g+t:Ni(e,r,t);f=ua(a,i,s),m="left"===r?-Fr:Fr}return{titleX:h,titleY:f,maxWidth:u,rotation:m}}(this,o,t,i);qa(e,r.text,0,0,s,{color:r.color,maxWidth:d,rotation:u,textAlign:Ci(i,t,a),textBaseline:"middle",translation:[l,c]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,r=pr(e.grid&&e.grid.z,-1),a=pr(e.border&&e.border.z,0);return this._isVisible()&&this.draw===Ai.prototype.draw?[{z:r,draw:e=>{this.drawBackground(),this.drawGrid(e),this.drawTitle()}},{z:a,draw:()=>{this.drawBorder()}},{z:t,draw:e=>{this.drawLabels(e)}}]:[{z:t,draw:e=>{this.draw(e)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),r=this.axis+"AxisID",a=[];let s,n;for(s=0,n=t.length;s<n;++s){const n=t[s];n[r]!==this.id||e&&n.type!==e||a.push(n)}return a}_resolveTickFontOptions(e){return rs(this.options.ticks.setContext(this.getContext(e)).font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class Di{constructor(e,t,r){this.type=e,this.scope=t,this.override=r,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let r;(function(e){return"id"in e&&"defaults"in e})(t)&&(r=this.register(t));const a=this.items,s=e.id,n=this.scope+"."+s;if(!s)throw new Error("class does not have id: "+e);return s in a||(a[s]=e,function(e,t,r){const a=Nr(Object.create(null),[r?Pa.get(r):{},Pa.get(t),e.defaults]);Pa.set(t,a),e.defaultRoutes&&function(e,t){Object.keys(t).forEach(r=>{const a=r.split("."),s=a.pop(),n=[e].concat(a).join("."),i=t[r].split("."),o=i.pop(),l=i.join(".");Pa.route(n,s,l,o)})}(t,e.defaultRoutes);e.descriptors&&Pa.describe(t,e.descriptors)}(e,n,r),this.override&&Pa.override(e.id,e.overrides)),n}get(e){return this.items[e]}unregister(e){const t=this.items,r=e.id,a=this.scope;r in t&&delete t[r],a&&r in Pa[a]&&(delete Pa[a][r],this.override&&delete Ta[r])}}class Pi{constructor(){this.controllers=new Di(xn,"datasets",!0),this.elements=new Di(yi,"elements"),this.plugins=new Di(Object,"plugins"),this.scales=new Di(Ai,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._each("register",t)}remove(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._each("unregister",t)}addControllers(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._each("register",t,this.controllers)}addElements(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._each("register",t,this.elements)}addPlugins(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._each("register",t,this.plugins)}addScales(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._each("register",t,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._each("unregister",t,this.controllers)}removeElements(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._each("unregister",t,this.elements)}removePlugins(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._each("unregister",t,this.plugins)}removeScales(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._each("unregister",t,this.scales)}_each(e,t,r){[...t].forEach(t=>{const a=r||this._getRegistryForType(t);r||a.isForType(t)||a===this.plugins&&t.id?this._exec(e,a,t):br(t,t=>{const a=r||this._getRegistryForType(t);this._exec(e,a,t)})})}_exec(e,t,r){const a=_r(e);xr(r["before"+a],[],r),t[e](r),xr(r["after"+a],[],r)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const r=this._typedRegistries[t];if(r.isForType(e))return r}return this.plugins}_get(e,t,r){const a=t.get(e);if(void 0===a)throw new Error('"'+e+'" is not a registered '+r+".");return a}}var Ii=new Pi;class Oi{constructor(){this._init=[]}notify(e,t,r,a){"beforeInit"===t&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const s=a?this._descriptors(e).filter(a):this._descriptors(e),n=this._notify(s,e,t,r);return"afterDestroy"===t&&(this._notify(s,e,"stop"),this._notify(this._init,e,"uninstall")),n}_notify(e,t,r,a){a=a||{};for(const s of e){const e=s.plugin;if(!1===xr(e[r],[t,a,s.options],e)&&a.cancelable)return!1}return!0}invalidate(){dr(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const r=e&&e.config,a=pr(r.options&&r.options.plugins,{}),s=function(e){const t={},r=[],a=Object.keys(Ii.plugins.items);for(let n=0;n<a.length;n++)r.push(Ii.getPlugin(a[n]));const s=e.plugins||[];for(let n=0;n<s.length;n++){const e=s[n];-1===r.indexOf(e)&&(r.push(e),t[e.id]=!0)}return{plugins:r,localIds:t}}(r);return!1!==a||t?function(e,t,r,a){let{plugins:s,localIds:n}=t;const i=[],o=e.getContext();for(const l of s){const t=l.id,s=Ri(r[t],a);null!==s&&i.push({plugin:l,options:Mi(e.config,{plugin:l,local:n[t]},s,o)})}return i}(e,s,a,t):[]}_notifyStateChanges(e){const t=this._oldCache||[],r=this._cache,a=(e,t)=>e.filter(e=>!t.some(t=>e.plugin.id===t.plugin.id));this._notify(a(t,r),e,"stop"),this._notify(a(r,t),e,"start")}}function Ri(e,t){return t||!1!==e?!0===e?{}:e:null}function Mi(e,t,r,a){let{plugin:s,local:n}=t;const i=e.pluginScopeKeys(s),o=e.getOptionScopes(r,i);return n&&s.defaults&&o.push(s.defaults),e.createResolver(o,a,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Fi(e,t){const r=Pa.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||r.indexAxis||"x"}function Li(e){if("x"===e||"y"===e||"r"===e)return e}function zi(e){return"top"===e||"bottom"===e?"x":"left"===e||"right"===e?"y":void 0}function Bi(e){if(Li(e))return e;for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];for(const s of r){const t=s.axis||zi(s.position)||e.length>1&&Li(e[0].toLowerCase());if(t)return t}throw new Error("Cannot determine type of '".concat(e,"' axis. Please provide 'axis' or 'position' option."))}function Ui(e,t,r){if(r[t+"AxisID"]===e)return{axis:t}}function Wi(e,t){const r=Ta[e.type]||{scales:{}},a=t.scales||{},s=Fi(e.type,t),n=Object.create(null);return Object.keys(a).forEach(t=>{const i=a[t];if(!hr(i))return console.error("Invalid scale configuration for scale: ".concat(t));if(i._proxy)return console.warn("Ignoring resolver passed as options for scale: ".concat(t));const o=Bi(t,i,function(e,t){if(t.data&&t.data.datasets){const r=t.data.datasets.filter(t=>t.xAxisID===e||t.yAxisID===e);if(r.length)return Ui(e,"x",r[0])||Ui(e,"y",r[0])}return{}}(t,e),Pa.scales[i.type]),l=function(e,t){return e===t?"_index_":"_value_"}(o,s),c=r.scales||{};n[t]=kr(Object.create(null),[{axis:o},i,c[o],c[l]])}),e.data.datasets.forEach(r=>{const s=r.type||e.type,i=r.indexAxis||Fi(s,t),o=(Ta[s]||{}).scales||{};Object.keys(o).forEach(e=>{const t=function(e,t){let r=e;return"_index_"===e?r=t:"_value_"===e&&(r="x"===t?"y":"x"),r}(e,i),s=r[t+"AxisID"]||t;n[s]=n[s]||Object.create(null),kr(n[s],[{axis:t},a[s],o[e]])})}),Object.keys(n).forEach(e=>{const t=n[e];kr(t,[Pa.scales[t.type],Pa.scale])}),n}function Hi(e){const t=e.options||(e.options={});t.plugins=pr(t.plugins,{}),t.scales=Wi(e,t)}function Vi(e){return(e=e||{}).datasets=e.datasets||[],e.labels=e.labels||[],e}const Gi=new Map,qi=new Set;function $i(e,t){let r=Gi.get(e);return r||(r=t(),Gi.set(e,r),qi.add(r)),r}const Ki=(e,t,r)=>{const a=Tr(t,r);void 0!==a&&e.add(a)};class Yi{constructor(e){this._config=function(e){return(e=e||{}).data=Vi(e.data),Hi(e),e}(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=Vi(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),Hi(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return $i(e,()=>[["datasets.".concat(e),""]])}datasetAnimationScopeKeys(e,t){return $i("".concat(e,".transition.").concat(t),()=>[["datasets.".concat(e,".transitions.").concat(t),"transitions.".concat(t)],["datasets.".concat(e),""]])}datasetElementScopeKeys(e,t){return $i("".concat(e,"-").concat(t),()=>[["datasets.".concat(e,".elements.").concat(t),"datasets.".concat(e),"elements.".concat(t),""]])}pluginScopeKeys(e){const t=e.id,r=this.type;return $i("".concat(r,"-plugin-").concat(t),()=>[["plugins.".concat(t),...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){const r=this._scopeCache;let a=r.get(e);return a&&!t||(a=new Map,r.set(e,a)),a}getOptionScopes(e,t,r){const{options:a,type:s}=this,n=this._cachedScopes(e,r),i=n.get(t);if(i)return i;const o=new Set;t.forEach(t=>{e&&(o.add(e),t.forEach(t=>Ki(o,e,t))),t.forEach(e=>Ki(o,a,e)),t.forEach(e=>Ki(o,Ta[s]||{},e)),t.forEach(e=>Ki(o,Pa,e)),t.forEach(e=>Ki(o,_a,e))});const l=Array.from(o);return 0===l.length&&l.push(Object.create(null)),qi.has(t)&&n.set(t,l),l}chartOptionScopes(){const{options:e,type:t}=this;return[e,Ta[t]||{},Pa.datasets[t]||{},{type:t},Pa,_a]}resolveNamedOptions(e,t,r){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[""];const s={$shared:!0},{resolver:n,subPrefixes:i}=Ji(this._resolverCache,e,a);let o=n;if(function(e,t){const{isScriptable:r,isIndexable:a}=os(e);for(const s of t){const t=r(s),n=a(s),i=(n||t)&&e[s];if(t&&(Ar(i)||Xi(i))||n&&ur(i))return!0}return!1}(n,t)){s.$shared=!1;o=is(n,r=Ar(r)?r():r,this.createResolver(e,r,i))}for(const l of t)s[l]=o[l];return s}createResolver(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[""],a=arguments.length>3?arguments[3]:void 0;const{resolver:s}=Ji(this._resolverCache,e,r);return hr(t)?is(s,t,void 0,a):s}}function Ji(e,t,r){let a=e.get(t);a||(a=new Map,e.set(t,a));const s=r.join();let n=a.get(s);if(!n){n={resolver:ns(t,r),subPrefixes:r.filter(e=>!e.toLowerCase().includes("hover"))},a.set(s,n)}return n}const Xi=e=>hr(e)&&Object.getOwnPropertyNames(e).some(t=>Ar(e[t]));const Qi=["top","bottom","left","right","chartArea"];function Zi(e,t){return"top"===e||"bottom"===e||-1===Qi.indexOf(e)&&"x"===t}function eo(e,t){return function(r,a){return r[e]===a[e]?r[t]-a[t]:r[e]-a[e]}}function to(e){const t=e.chart,r=t.options.animation;t.notifyPlugins("afterRender"),xr(r&&r.onComplete,[e],t)}function ro(e){const t=e.chart,r=t.options.animation;xr(r&&r.onProgress,[e],t)}function ao(e){return Es()&&"string"===typeof e?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}const so={},no=e=>{const t=ao(e);return Object.values(so).filter(e=>e.canvas===t).pop()};function io(e,t,r){const a=Object.keys(e);for(const s of a){const a=+s;if(a>=t){const n=e[s];delete e[s],(r>0||a>t)&&(e[a+r]=n)}}}class oo{static register(){Ii.add(...arguments),lo()}static unregister(){Ii.remove(...arguments),lo()}constructor(e,t){const r=this.config=new Yi(t),a=ao(e),s=no(a);if(s)throw new Error("Canvas is already in use. Chart with ID '"+s.id+"' must be destroyed before the canvas with ID '"+s.canvas.id+"' can be reused.");const n=r.createResolver(r.chartOptionScopes(),this.getContext());this.platform=new(r.platform||function(e){return!Es()||"undefined"!==typeof OffscreenCanvas&&e instanceof OffscreenCanvas?si:vi}(a)),this.platform.updateConfig(r);const i=this.platform.acquireContext(a,n.aspectRatio),o=i&&i.canvas,l=o&&o.height,c=o&&o.width;this.id=cr(),this.ctx=i,this.canvas=o,this.width=c,this.height=l,this._options=n,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new Oi,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=function(e,t){let r;return function(){for(var a=arguments.length,s=new Array(a),n=0;n<a;n++)s[n]=arguments[n];return t?(clearTimeout(r),r=setTimeout(e,t,s)):e.apply(this,s),t}}(e=>this.update(e),n.resizeDelay||0),this._dataChanges=[],so[this.id]=this,i&&o?(en.listen(this,"complete",to),en.listen(this,"progress",ro),this._initialize(),this.attached&&this.update()):console.error("Failed to create chart: can't acquire context from the given item")}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:r,height:a,_aspectRatio:s}=this;return dr(e)?t&&s?s:a?r/a:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return Ii}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Rs(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Ma(this.canvas,this.ctx),this}stop(){return en.stop(this),this}resize(e,t){en.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const r=this.options,a=this.canvas,s=r.maintainAspectRatio&&this.aspectRatio,n=this.platform.getMaximumSize(a,e,t,s),i=r.devicePixelRatio||this.platform.getDevicePixelRatio(),o=this.width?"resize":"attach";this.width=n.width,this.height=n.height,this._aspectRatio=this.aspectRatio,Rs(this,i,!0)&&(this.notifyPlugins("resize",{size:n}),xr(r.onResize,[this,n],this),this.attached&&this._doResize(o)&&this.render())}ensureScalesHaveIDs(){br(this.options.scales||{},(e,t)=>{e.id=t})}buildOrUpdateScales(){const e=this.options,t=e.scales,r=this.scales,a=Object.keys(r).reduce((e,t)=>(e[t]=!1,e),{});let s=[];t&&(s=s.concat(Object.keys(t).map(e=>{const r=t[e],a=Bi(e,r),s="r"===a,n="x"===a;return{options:r,dposition:s?"chartArea":n?"bottom":"left",dtype:s?"radialLinear":n?"category":"linear"}}))),br(s,t=>{const s=t.options,n=s.id,i=Bi(n,s),o=pr(s.type,t.dtype);void 0!==s.position&&Zi(s.position,i)===Zi(t.dposition)||(s.position=t.dposition),a[n]=!0;let l=null;if(n in r&&r[n].type===o)l=r[n];else{l=new(Ii.getScale(o))({id:n,type:o,ctx:this.ctx,chart:this}),r[l.id]=l}l.init(s,e)}),br(a,(e,t)=>{e||delete r[t]}),br(r,e=>{ri.configure(this,e,e.options),ri.addBox(this,e)})}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,r=e.length;if(e.sort((e,t)=>e.index-t.index),r>t){for(let e=t;e<r;++e)this._destroyDatasetMeta(e);e.splice(t,r-t)}this._sortedMetasets=e.slice(0).sort(eo("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach((e,r)=>{0===t.filter(t=>t===e._dataset).length&&this._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let r,a;for(this._removeUnreferencedMetasets(),r=0,a=t.length;r<a;r++){const a=t[r];let s=this.getDatasetMeta(r);const n=a.type||this.config.type;if(s.type&&s.type!==n&&(this._destroyDatasetMeta(r),s=this.getDatasetMeta(r)),s.type=n,s.indexAxis=a.indexAxis||Fi(n,this.options),s.order=a.order||0,s.index=r,s.label=""+a.label,s.visible=this.isDatasetVisible(r),s.controller)s.controller.updateIndex(r),s.controller.linkScales();else{const t=Ii.getController(n),{datasetElementType:a,dataElementType:i}=Pa.datasets[n];Object.assign(t,{dataElementType:Ii.getElement(i),datasetElementType:a&&Ii.getElement(a)}),s.controller=new t(this,r),e.push(s.controller)}}return this._updateMetasets(),e}_resetElements(){br(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const r=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),a=this._animationsDisabled=!r.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),!1===this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0}))return;const s=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let n=0;for(let l=0,c=this.data.datasets.length;l<c;l++){const{controller:e}=this.getDatasetMeta(l),t=!a&&-1===s.indexOf(e);e.buildOrUpdateElements(t),n=Math.max(+e.getMaxOverflow(),n)}n=this._minPadding=r.layout.autoPadding?n:0,this._updateLayout(n),a||br(s,e=>{e.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(eo("z","_idx"));const{_active:i,_lastEvent:o}=this;o?this._eventHandler(o,!0):i.length&&this._updateHoverStyles(i,i,!0),this.render()}_updateScales(){br(this.scales,e=>{ri.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),r=new Set(e.events);Dr(t,r)&&!!this._responsiveListeners===e.responsive||(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:r,start:a,count:s}of t){io(e,a,"_removeElements"===r?-s:s)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,r=t=>new Set(e.filter(e=>e[0]===t).map((e,t)=>t+","+e.splice(1).join(","))),a=r(0);for(let s=1;s<t;s++)if(!Dr(a,r(s)))return;return Array.from(a).map(e=>e.split(",")).map(e=>({method:e[1],start:+e[2],count:+e[3]}))}_updateLayout(e){if(!1===this.notifyPlugins("beforeLayout",{cancelable:!0}))return;ri.update(this,this.width,this.height,e);const t=this.chartArea,r=t.width<=0||t.height<=0;this._layers=[],br(this.boxes,e=>{r&&"chartArea"===e.position||(e.configure&&e.configure(),this._layers.push(...e._layers()))},this),this._layers.forEach((e,t)=>{e._idx=t}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(!1!==this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})){for(let e=0,t=this.data.datasets.length;e<t;++e)this.getDatasetMeta(e).controller.configure();for(let t=0,r=this.data.datasets.length;t<r;++t)this._updateDataset(t,Ar(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const r=this.getDatasetMeta(e),a={meta:r,index:e,mode:t,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetUpdate",a)&&(r.controller._update(t),a.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",a))}render(){!1!==this.notifyPlugins("beforeRender",{cancelable:!0})&&(en.has(this)?this.attached&&!en.running(this)&&en.start(this):(this.draw(),to({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:e,height:t}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(e,t)}if(this.clear(),this.width<=0||this.height<=0)return;if(!1===this.notifyPlugins("beforeDraw",{cancelable:!0}))return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,r=[];let a,s;for(a=0,s=t.length;a<s;++a){const s=t[a];e&&!s.visible||r.push(s)}return r}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(!1===this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0}))return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,r={meta:e,index:e.index,cancelable:!0},a=Qs(this,e);!1!==this.notifyPlugins("beforeDatasetDraw",r)&&(a&&Ba(t,a),e.controller.draw(),a&&Ua(t),r.cancelable=!1,this.notifyPlugins("afterDatasetDraw",r))}isPointInArea(e){return za(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,r,a){const s=Hn.modes[t];return"function"===typeof s?s(this,e,r,a):[]}getDatasetMeta(e){const t=this.data.datasets[e],r=this._metasets;let a=r.filter(e=>e&&e._dataset===t).pop();return a||(a={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},r.push(a)),a}getContext(){return this.$context||(this.$context=ss(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const r=this.getDatasetMeta(e);return"boolean"===typeof r.hidden?!r.hidden:!t.hidden}setDatasetVisibility(e,t){this.getDatasetMeta(e).hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,r){const a=r?"show":"hide",s=this.getDatasetMeta(e),n=s.controller._resolveAnimations(void 0,a);Cr(t)?(s.data[t].hidden=!r,this.update()):(this.setDatasetVisibility(e,r),n.update(s,{visible:r}),this.update(t=>t.datasetIndex===e?a:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),en.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),Ma(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete so[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(){return this.canvas.toDataURL(...arguments)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,r=(r,a)=>{t.addEventListener(this,r,a),e[r]=a},a=(e,t,r)=>{e.offsetX=t,e.offsetY=r,this._eventHandler(e)};br(this.options.events,e=>r(e,a))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,r=(r,a)=>{t.addEventListener(this,r,a),e[r]=a},a=(r,a)=>{e[r]&&(t.removeEventListener(this,r,a),delete e[r])},s=(e,t)=>{this.canvas&&this.resize(e,t)};let n;const i=()=>{a("attach",i),this.attached=!0,this.resize(),r("resize",s),r("detach",n)};n=()=>{this.attached=!1,a("resize",s),this._stop(),this._resize(0,0),r("attach",i)},t.isAttached(this.canvas)?i():n()}unbindEvents(){br(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},br(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,r){const a=r?"set":"remove";let s,n,i,o;for("dataset"===t&&(s=this.getDatasetMeta(e[0].datasetIndex),s.controller["_"+a+"DatasetHoverStyle"]()),i=0,o=e.length;i<o;++i){n=e[i];const t=n&&this.getDatasetMeta(n.datasetIndex).controller;t&&t[a+"HoverStyle"](n.element,n.datasetIndex,n.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],r=e.map(e=>{let{datasetIndex:t,index:r}=e;const a=this.getDatasetMeta(t);if(!a)throw new Error("No dataset found at index "+t);return{datasetIndex:t,element:a.data[r],index:r}});!vr(r,t)&&(this._active=r,this._lastEvent=null,this._updateHoverStyles(r,t))}notifyPlugins(e,t,r){return this._plugins.notify(this,e,t,r)}isPluginEnabled(e){return 1===this._plugins._cache.filter(t=>t.plugin.id===e).length}_updateHoverStyles(e,t,r){const a=this.options.hover,s=(e,t)=>e.filter(e=>!t.some(t=>e.datasetIndex===t.datasetIndex&&e.index===t.index)),n=s(t,e),i=r?e:s(e,t);n.length&&this.updateHoverStyle(n,a.mode,!1),i.length&&a.mode&&this.updateHoverStyle(i,a.mode,!0)}_eventHandler(e,t){const r={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},a=t=>(t.options.events||this.options.events).includes(e.native.type);if(!1===this.notifyPlugins("beforeEvent",r,a))return;const s=this._handleEvent(e,t,r.inChartArea);return r.cancelable=!1,this.notifyPlugins("afterEvent",r,a),(s||r.changed)&&this.render(),this}_handleEvent(e,t,r){const{_active:a=[],options:s}=this,n=t,i=this._getActiveElements(e,a,r,n),o=function(e){return"mouseup"===e.type||"click"===e.type||"contextmenu"===e.type}(e),l=function(e,t,r,a){return r&&"mouseout"!==e.type?a?t:e:null}(e,this._lastEvent,r,o);r&&(this._lastEvent=null,xr(s.onHover,[e,i,this],this),o&&xr(s.onClick,[e,i,this],this));const c=!vr(i,a);return(c||t)&&(this._active=i,this._updateHoverStyles(i,a,t)),this._lastEvent=l,c}_getActiveElements(e,t,r,a){if("mouseout"===e.type)return[];if(!r)return t;const s=this.options.hover;return this.getElementsAtEventForMode(e,s.mode,s,a)}}function lo(){return br(oo.instances,e=>e._plugins.invalidate())}function co(e,t,r,a){const s=Qa(e.options.borderRadius,["outerStart","outerEnd","innerStart","innerEnd"]);const n=(r-t)/2,i=Math.min(n,a*t/2),o=e=>{const t=(r-Math.min(n,e))*a/2;return ea(e,0,Math.min(n,t))};return{outerStart:o(s.outerStart),outerEnd:o(s.outerEnd),innerStart:ea(s.innerStart,0,i),innerEnd:ea(s.innerEnd,0,i)}}function uo(e,t,r,a){return{x:r+e*Math.cos(t),y:a+e*Math.sin(t)}}function ho(e,t,r,a,s,n){const{x:i,y:o,startAngle:l,pixelMargin:c,innerRadius:d}=t,u=Math.max(t.outerRadius+a+r-c,0),h=d>0?d+a+r+c:0;let f=0;const m=s-l;if(a){const e=((d>0?d-a:0)+(u>0?u-a:0))/2;f=(m-(0!==e?m*e/(e+a):m))/2}const p=(m-Math.max(.001,m*u-r/Pr)/u)/2,g=l+p+f,x=s-p-f,{outerStart:b,outerEnd:v,innerStart:y,innerEnd:w}=co(t,h,u,x-g),j=u-b,N=u-v,k=g+b/j,S=x-v/N,E=h+y,T=h+w,_=g+y/E,C=x-w/T;if(e.beginPath(),n){const t=(k+S)/2;if(e.arc(i,o,u,k,t),e.arc(i,o,u,t,S),v>0){const t=uo(N,S,i,o);e.arc(t.x,t.y,v,S,x+Fr)}const r=uo(T,x,i,o);if(e.lineTo(r.x,r.y),w>0){const t=uo(T,C,i,o);e.arc(t.x,t.y,w,x+Fr,C+Math.PI)}const a=(x-w/h+(g+y/h))/2;if(e.arc(i,o,h,x-w/h,a,!0),e.arc(i,o,h,a,g+y/h,!0),y>0){const t=uo(E,_,i,o);e.arc(t.x,t.y,y,_+Math.PI,g-Fr)}const s=uo(j,g,i,o);if(e.lineTo(s.x,s.y),b>0){const t=uo(j,k,i,o);e.arc(t.x,t.y,b,g-Fr,k)}}else{e.moveTo(i,o);const t=Math.cos(k)*u+i,r=Math.sin(k)*u+o;e.lineTo(t,r);const a=Math.cos(S)*u+i,s=Math.sin(S)*u+o;e.lineTo(a,s)}e.closePath()}function fo(e,t,r,a,s){const{fullCircles:n,startAngle:i,circumference:o,options:l}=t,{borderWidth:c,borderJoinStyle:d,borderDash:u,borderDashOffset:h,borderRadius:f}=l,m="inner"===l.borderAlign;if(!c)return;e.setLineDash(u||[]),e.lineDashOffset=h,m?(e.lineWidth=2*c,e.lineJoin=d||"round"):(e.lineWidth=c,e.lineJoin=d||"bevel");let p=t.endAngle;if(n){ho(e,t,r,a,p,s);for(let t=0;t<n;++t)e.stroke();isNaN(o)||(p=i+(o%Ir||Ir))}m&&function(e,t,r){const{startAngle:a,pixelMargin:s,x:n,y:i,outerRadius:o,innerRadius:l}=t;let c=s/o;e.beginPath(),e.arc(n,i,o,a-c,r+c),l>s?(c=s/l,e.arc(n,i,l,r+c,a-c,!0)):e.arc(n,i,s,r+Fr,a-Fr),e.closePath(),e.clip()}(e,t,p),l.selfJoin&&p-i>=Pr&&0===f&&"miter"!==d&&function(e,t,r){const{startAngle:a,x:s,y:n,outerRadius:i,innerRadius:o,options:l}=t,{borderWidth:c,borderJoinStyle:d}=l,u=Math.min(c/i,Qr(a-r));if(e.beginPath(),e.arc(s,n,i-c/2,a+u/2,r-u/2),o>0){const t=Math.min(c/o,Qr(a-r));e.arc(s,n,o+c/2,r-t/2,a+t/2,!0)}else{const t=Math.min(c/2,i*Qr(a-r));if("round"===d)e.arc(s,n,t,r-Pr/2,a+Pr/2,!0);else if("bevel"===d){const i=2*t*t,o=-i*Math.cos(r+Pr/2)+s,l=-i*Math.sin(r+Pr/2)+n,c=i*Math.cos(a+Pr/2)+s,d=i*Math.sin(a+Pr/2)+n;e.lineTo(o,l),e.lineTo(c,d)}}e.closePath(),e.moveTo(0,0),e.rect(0,0,e.canvas.width,e.canvas.height),e.clip("evenodd")}(e,t,p),n||(ho(e,t,r,a,p,s),e.stroke())}(0,_t.A)(oo,"defaults",Pa),(0,_t.A)(oo,"instances",so),(0,_t.A)(oo,"overrides",Ta),(0,_t.A)(oo,"registry",Ii),(0,_t.A)(oo,"version","4.5.0"),(0,_t.A)(oo,"getChart",no);class mo extends yi{constructor(e){super(),(0,_t.A)(this,"circumference",void 0),(0,_t.A)(this,"endAngle",void 0),(0,_t.A)(this,"fullCircles",void 0),(0,_t.A)(this,"innerRadius",void 0),(0,_t.A)(this,"outerRadius",void 0),(0,_t.A)(this,"pixelMargin",void 0),(0,_t.A)(this,"startAngle",void 0),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,t,r){const a=this.getProps(["x","y"],r),{angle:s,distance:n}=Yr(a,{x:e,y:t}),{startAngle:i,endAngle:o,innerRadius:l,outerRadius:c,circumference:d}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],r),u=(this.options.spacing+this.options.borderWidth)/2,h=pr(d,o-i),f=Zr(s,i,o)&&i!==o,m=h>=Ir||f,p=ta(n,l+u,c+u);return m&&p}getCenterPoint(e){const{x:t,y:r,startAngle:a,endAngle:s,innerRadius:n,outerRadius:i}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:o,spacing:l}=this.options,c=(a+s)/2,d=(n+i+l+o)/2;return{x:t+Math.cos(c)*d,y:r+Math.sin(c)*d}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:t,circumference:r}=this,a=(t.offset||0)/4,s=(t.spacing||0)/2,n=t.circular;if(this.pixelMargin="inner"===t.borderAlign?.33:0,this.fullCircles=r>Ir?Math.floor(r/Ir):0,0===r||this.innerRadius<0||this.outerRadius<0)return;e.save();const i=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(i)*a,Math.sin(i)*a);const o=a*(1-Math.sin(Math.min(Pr,r||0)));e.fillStyle=t.backgroundColor,e.strokeStyle=t.borderColor,function(e,t,r,a,s){const{fullCircles:n,startAngle:i,circumference:o}=t;let l=t.endAngle;if(n){ho(e,t,r,a,l,s);for(let t=0;t<n;++t)e.fill();isNaN(o)||(l=i+(o%Ir||Ir))}ho(e,t,r,a,l,s),e.fill()}(e,this,o,s,n),fo(e,this,o,s,n),e.restore()}}function po(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;e.lineCap=pr(r.borderCapStyle,t.borderCapStyle),e.setLineDash(pr(r.borderDash,t.borderDash)),e.lineDashOffset=pr(r.borderDashOffset,t.borderDashOffset),e.lineJoin=pr(r.borderJoinStyle,t.borderJoinStyle),e.lineWidth=pr(r.borderWidth,t.borderWidth),e.strokeStyle=pr(r.borderColor,t.borderColor)}function go(e,t,r){e.lineTo(r.x,r.y)}function xo(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=e.length,{start:s=0,end:n=a-1}=r,{start:i,end:o}=t,l=Math.max(s,i),c=Math.min(n,o),d=s<i&&n<i||s>o&&n>o;return{count:a,start:l,loop:t.loop,ilen:c<l&&!d?a+c-l:c-l}}function bo(e,t,r,a){const{points:s,options:n}=t,{count:i,start:o,loop:l,ilen:c}=xo(s,r,a),d=function(e){return e.stepped?Wa:e.tension||"monotone"===e.cubicInterpolationMode?Ha:go}(n);let u,h,f,{move:m=!0,reverse:p}=a||{};for(u=0;u<=c;++u)h=s[(o+(p?c-u:u))%i],h.skip||(m?(e.moveTo(h.x,h.y),m=!1):d(e,f,h,p,n.stepped),f=h);return l&&(h=s[(o+(p?c:0))%i],d(e,f,h,p,n.stepped)),!!l}function vo(e,t,r,a){const s=t.points,{count:n,start:i,ilen:o}=xo(s,r,a),{move:l=!0,reverse:c}=a||{};let d,u,h,f,m,p,g=0,x=0;const b=e=>(i+(c?o-e:e))%n,v=()=>{f!==m&&(e.lineTo(g,m),e.lineTo(g,f),e.lineTo(g,p))};for(l&&(u=s[b(0)],e.moveTo(u.x,u.y)),d=0;d<=o;++d){if(u=s[b(d)],u.skip)continue;const t=u.x,r=u.y,a=0|t;a===h?(r<f?f=r:r>m&&(m=r),g=(x*g+t)/++x):(v(),e.lineTo(t,r),h=a,x=0,f=m=r),p=r}v()}function yo(e){const t=e.options,r=t.borderDash&&t.borderDash.length;return!e._decimated&&!e._loop&&!t.tension&&"monotone"!==t.cubicInterpolationMode&&!t.stepped&&!r?vo:bo}(0,_t.A)(mo,"id","arc"),(0,_t.A)(mo,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1}),(0,_t.A)(mo,"defaultRoutes",{backgroundColor:"backgroundColor"}),(0,_t.A)(mo,"descriptors",{_scriptable:!0,_indexable:e=>"borderDash"!==e});const wo="function"===typeof Path2D;function jo(e,t,r,a){wo&&!t.options.segment?function(e,t,r,a){let s=t._path;s||(s=t._path=new Path2D,t.path(s,r,a)&&s.closePath()),po(e,t.options),e.stroke(s)}(e,t,r,a):function(e,t,r,a){const{segments:s,options:n}=t,i=yo(t);for(const o of s)po(e,n,o.style),e.beginPath(),i(e,t,o,{start:r,end:r+a-1})&&e.closePath(),e.stroke()}(e,t,r,a)}class No extends yi{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){const r=this.options;if((r.tension||"monotone"===r.cubicInterpolationMode)&&!r.stepped&&!this._pointsUpdated){const a=r.spanGaps?this._loop:this._fullLoop;Ss(this._points,r,e,a,t),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=function(e,t){const r=e.points,a=e.options.spanGaps,s=r.length;if(!s)return[];const n=!!e._loop,{start:i,end:o}=function(e,t,r,a){let s=0,n=t-1;if(r&&!a)for(;s<t&&!e[s].skip;)s++;for(;s<t&&e[s].skip;)s++;for(s%=t,r&&(n+=s);n>s&&e[n%t].skip;)n--;return n%=t,{start:s,end:n}}(r,s,n,a);return Ks(e,!0===a?[{start:i,end:o,loop:n}]:function(e,t,r,a){const s=e.length,n=[];let i,o=t,l=e[t];for(i=t+1;i<=r;++i){const r=e[i%s];r.skip||r.stop?l.skip||(a=!1,n.push({start:t%s,end:(i-1)%s,loop:a}),t=o=r.stop?i:null):(o=i,l.skip&&(t=i)),l=r}return null!==o&&n.push({start:t%s,end:o%s,loop:a}),n}(r,i,o<i?o+s:o,!!e._fullLoop&&0===i&&o===s-1),r,t)}(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,r=e.length;return r&&t[e[r-1].end]}interpolate(e,t){const r=this.options,a=e[t],s=this.points,n=$s(this,{property:t,start:a,end:a});if(!n.length)return;const i=[],o=function(e){return e.stepped?zs:e.tension||"monotone"===e.cubicInterpolationMode?Bs:Ls}(r);let l,c;for(l=0,c=n.length;l<c;++l){const{start:c,end:d}=n[l],u=s[c],h=s[d];if(u===h){i.push(u);continue}const f=o(u,h,Math.abs((a-u[t])/(h[t]-u[t])),r.stepped);f[t]=e[t],i.push(f)}return 1===i.length?i[0]:i}pathSegment(e,t,r){return yo(this)(e,this,t,r)}path(e,t,r){const a=this.segments,s=yo(this);let n=this._loop;t=t||0,r=r||this.points.length-t;for(const i of a)n&=s(e,this,i,{start:t,end:t+r-1});return!!n}draw(e,t,r,a){const s=this.options||{};(this.points||[]).length&&s.borderWidth&&(e.save(),jo(e,this,r,a),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function ko(e,t,r,a){const s=e.options,{[r]:n}=e.getProps([r],a);return Math.abs(t-n)<s.radius+s.hitRadius}(0,_t.A)(No,"id","line"),(0,_t.A)(No,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),(0,_t.A)(No,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),(0,_t.A)(No,"descriptors",{_scriptable:!0,_indexable:e=>"borderDash"!==e&&"fill"!==e});class So extends yi{constructor(e){super(),(0,_t.A)(this,"parsed",void 0),(0,_t.A)(this,"skip",void 0),(0,_t.A)(this,"stop",void 0),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,t,r){const a=this.options,{x:s,y:n}=this.getProps(["x","y"],r);return Math.pow(e-s,2)+Math.pow(t-n,2)<Math.pow(a.hitRadius+a.radius,2)}inXRange(e,t){return ko(this,e,"x",t)}inYRange(e,t){return ko(this,e,"y",t)}getCenterPoint(e){const{x:t,y:r}=this.getProps(["x","y"],e);return{x:t,y:r}}size(e){let t=(e=e||this.options||{}).radius||0;t=Math.max(t,t&&e.hoverRadius||0);return 2*(t+(t&&e.borderWidth||0))}draw(e,t){const r=this.options;this.skip||r.radius<.1||!za(this,t,this.size(r)/2)||(e.strokeStyle=r.borderColor,e.lineWidth=r.borderWidth,e.fillStyle=r.backgroundColor,Fa(e,r,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}function Eo(e,t){const{x:r,y:a,base:s,width:n,height:i}=e.getProps(["x","y","base","width","height"],t);let o,l,c,d,u;return e.horizontal?(u=i/2,o=Math.min(r,s),l=Math.max(r,s),c=a-u,d=a+u):(u=n/2,o=r-u,l=r+u,c=Math.min(a,s),d=Math.max(a,s)),{left:o,top:c,right:l,bottom:d}}function To(e,t,r,a){return e?0:ea(t,r,a)}function _o(e){const t=Eo(e),r=t.right-t.left,a=t.bottom-t.top,s=function(e,t,r){const a=e.options.borderWidth,s=e.borderSkipped,n=Za(a);return{t:To(s.top,n.top,0,r),r:To(s.right,n.right,0,t),b:To(s.bottom,n.bottom,0,r),l:To(s.left,n.left,0,t)}}(e,r/2,a/2),n=function(e,t,r){const{enableBorderRadius:a}=e.getProps(["enableBorderRadius"]),s=e.options.borderRadius,n=es(s),i=Math.min(t,r),o=e.borderSkipped,l=a||hr(s);return{topLeft:To(!l||o.top||o.left,n.topLeft,0,i),topRight:To(!l||o.top||o.right,n.topRight,0,i),bottomLeft:To(!l||o.bottom||o.left,n.bottomLeft,0,i),bottomRight:To(!l||o.bottom||o.right,n.bottomRight,0,i)}}(e,r/2,a/2);return{outer:{x:t.left,y:t.top,w:r,h:a,radius:n},inner:{x:t.left+s.l,y:t.top+s.t,w:r-s.l-s.r,h:a-s.t-s.b,radius:{topLeft:Math.max(0,n.topLeft-Math.max(s.t,s.l)),topRight:Math.max(0,n.topRight-Math.max(s.t,s.r)),bottomLeft:Math.max(0,n.bottomLeft-Math.max(s.b,s.l)),bottomRight:Math.max(0,n.bottomRight-Math.max(s.b,s.r))}}}}function Co(e,t,r,a){const s=null===t,n=null===r,i=e&&!(s&&n)&&Eo(e,a);return i&&(s||ta(t,i.left,i.right))&&(n||ta(r,i.top,i.bottom))}function Ao(e,t){e.rect(t.x,t.y,t.w,t.h)}function Do(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=e.x!==r.x?-t:0,s=e.y!==r.y?-t:0,n=(e.x+e.w!==r.x+r.w?t:0)-a,i=(e.y+e.h!==r.y+r.h?t:0)-s;return{x:e.x+a,y:e.y+s,w:e.w+n,h:e.h+i,radius:e.radius}}(0,_t.A)(So,"id","point"),(0,_t.A)(So,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),(0,_t.A)(So,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});class Po extends yi{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:t,options:{borderColor:r,backgroundColor:a}}=this,{inner:s,outer:n}=_o(this),i=(o=n.radius).topLeft||o.topRight||o.bottomLeft||o.bottomRight?$a:Ao;var o;e.save(),n.w===s.w&&n.h===s.h||(e.beginPath(),i(e,Do(n,t,s)),e.clip(),i(e,Do(s,-t,n)),e.fillStyle=r,e.fill("evenodd")),e.beginPath(),i(e,Do(s,t)),e.fillStyle=a,e.fill(),e.restore()}inRange(e,t,r){return Co(this,e,t,r)}inXRange(e,t){return Co(this,e,null,t)}inYRange(e,t){return Co(this,null,e,t)}getCenterPoint(e){const{x:t,y:r,base:a,horizontal:s}=this.getProps(["x","y","base","horizontal"],e);return{x:s?(t+a)/2:t,y:s?r:(r+a)/2}}getRange(e){return"x"===e?this.width/2:this.height/2}}(0,_t.A)(Po,"id","bar"),(0,_t.A)(Po,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),(0,_t.A)(Po,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});const Io=(e,t)=>{let{boxHeight:r=t,boxWidth:a=t}=e;return e.usePointStyle&&(r=Math.min(r,t),a=e.pointStyleWidth||Math.min(a,t)),{boxWidth:a,boxHeight:r,itemHeight:Math.max(t,r)}};class Oo extends yi{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,r){this.maxWidth=e,this.maxHeight=t,this._margins=r,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=xr(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter(t=>e.filter(t,this.chart.data))),e.sort&&(t=t.sort((t,r)=>e.sort(t,r,this.chart.data))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display)return void(this.width=this.height=0);const r=e.labels,a=rs(r.font),s=a.size,n=this._computeTitleHeight(),{boxWidth:i,itemHeight:o}=Io(r,s);let l,c;t.font=a.string,this.isHorizontal()?(l=this.maxWidth,c=this._fitRows(n,s,i,o)+10):(c=this.maxHeight,l=this._fitCols(n,a,i,o)+10),this.width=Math.min(l,e.maxWidth||this.maxWidth),this.height=Math.min(c,e.maxHeight||this.maxHeight)}_fitRows(e,t,r,a){const{ctx:s,maxWidth:n,options:{labels:{padding:i}}}=this,o=this.legendHitBoxes=[],l=this.lineWidths=[0],c=a+i;let d=e;s.textAlign="left",s.textBaseline="middle";let u=-1,h=-c;return this.legendItems.forEach((e,f)=>{const m=r+t/2+s.measureText(e.text).width;(0===f||l[l.length-1]+m+2*i>n)&&(d+=c,l[l.length-(f>0?0:1)]=0,h+=c,u++),o[f]={left:0,top:h,row:u,width:m,height:a},l[l.length-1]+=m+i}),d}_fitCols(e,t,r,a){const{ctx:s,maxHeight:n,options:{labels:{padding:i}}}=this,o=this.legendHitBoxes=[],l=this.columnSizes=[],c=n-e;let d=i,u=0,h=0,f=0,m=0;return this.legendItems.forEach((e,n)=>{const{itemWidth:p,itemHeight:g}=function(e,t,r,a,s){const n=function(e,t,r,a){let s=e.text;s&&"string"!==typeof s&&(s=s.reduce((e,t)=>e.length>t.length?e:t));return t+r.size/2+a.measureText(s).width}(a,e,t,r),i=function(e,t,r){let a=e;"string"!==typeof t.text&&(a=Ro(t,r));return a}(s,a,t.lineHeight);return{itemWidth:n,itemHeight:i}}(r,t,s,e,a);n>0&&h+g+2*i>c&&(d+=u+i,l.push({width:u,height:h}),f+=u+i,m++,u=h=0),o[n]={left:f,top:h,col:m,width:p,height:g},u=Math.max(u,p),h+=g+i}),d+=u,l.push({width:u,height:h}),d}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:r,labels:{padding:a},rtl:s}}=this,n=Us(s,this.left,this.width);if(this.isHorizontal()){let s=0,i=ua(r,this.left+a,this.right-this.lineWidths[s]);for(const o of t)s!==o.row&&(s=o.row,i=ua(r,this.left+a,this.right-this.lineWidths[s])),o.top+=this.top+e+a,o.left=n.leftForLtr(n.x(i),o.width),i+=o.width+a}else{let s=0,i=ua(r,this.top+e+a,this.bottom-this.columnSizes[s].height);for(const o of t)o.col!==s&&(s=o.col,i=ua(r,this.top+e+a,this.bottom-this.columnSizes[s].height)),o.top=i,o.left+=this.left+a,o.left=n.leftForLtr(n.x(o.left),o.width),i+=o.height+a}}isHorizontal(){return"top"===this.options.position||"bottom"===this.options.position}draw(){if(this.options.display){const e=this.ctx;Ba(e,this),this._draw(),Ua(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:r,ctx:a}=this,{align:s,labels:n}=e,i=Pa.color,o=Us(e.rtl,this.left,this.width),l=rs(n.font),{padding:c}=n,d=l.size,u=d/2;let h;this.drawTitle(),a.textAlign=o.textAlign("left"),a.textBaseline="middle",a.lineWidth=.5,a.font=l.string;const{boxWidth:f,boxHeight:m,itemHeight:p}=Io(n,d),g=this.isHorizontal(),x=this._computeTitleHeight();h=g?{x:ua(s,this.left+c,this.right-r[0]),y:this.top+c+x,line:0}:{x:this.left+c,y:ua(s,this.top+x+c,this.bottom-t[0].height),line:0},Ws(this.ctx,e.textDirection);const b=p+c;this.legendItems.forEach((v,y)=>{a.strokeStyle=v.fontColor,a.fillStyle=v.fontColor;const w=a.measureText(v.text).width,j=o.textAlign(v.textAlign||(v.textAlign=n.textAlign)),N=f+u+w;let k=h.x,S=h.y;o.setWidth(this.width),g?y>0&&k+N+c>this.right&&(S=h.y+=b,h.line++,k=h.x=ua(s,this.left+c,this.right-r[h.line])):y>0&&S+b>this.bottom&&(k=h.x=k+t[h.line].width+c,h.line++,S=h.y=ua(s,this.top+x+c,this.bottom-t[h.line].height));if(function(e,t,r){if(isNaN(f)||f<=0||isNaN(m)||m<0)return;a.save();const s=pr(r.lineWidth,1);if(a.fillStyle=pr(r.fillStyle,i),a.lineCap=pr(r.lineCap,"butt"),a.lineDashOffset=pr(r.lineDashOffset,0),a.lineJoin=pr(r.lineJoin,"miter"),a.lineWidth=s,a.strokeStyle=pr(r.strokeStyle,i),a.setLineDash(pr(r.lineDash,[])),n.usePointStyle){const i={radius:m*Math.SQRT2/2,pointStyle:r.pointStyle,rotation:r.rotation,borderWidth:s},l=o.xPlus(e,f/2);La(a,i,l,t+u,n.pointStyleWidth&&f)}else{const n=t+Math.max((d-m)/2,0),i=o.leftForLtr(e,f),l=es(r.borderRadius);a.beginPath(),Object.values(l).some(e=>0!==e)?$a(a,{x:i,y:n,w:f,h:m,radius:l}):a.rect(i,n,f,m),a.fill(),0!==s&&a.stroke()}a.restore()}(o.x(k),S,v),k=((e,t,r,a)=>e===(a?"left":"right")?r:"center"===e?(t+r)/2:t)(j,k+f+u,g?k+N:this.right,e.rtl),function(e,t,r){qa(a,r.text,e,t+p/2,l,{strikethrough:r.hidden,textAlign:o.textAlign(r.textAlign)})}(o.x(k),S,v),g)h.x+=N+c;else if("string"!==typeof v.text){const e=l.lineHeight;h.y+=Ro(v,e)+c}else h.y+=b}),Hs(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,r=rs(t.font),a=ts(t.padding);if(!t.display)return;const s=Us(e.rtl,this.left,this.width),n=this.ctx,i=t.position,o=r.size/2,l=a.top+o;let c,d=this.left,u=this.width;if(this.isHorizontal())u=Math.max(...this.lineWidths),c=this.top+l,d=ua(e.align,d,this.right-u);else{const t=this.columnSizes.reduce((e,t)=>Math.max(e,t.height),0);c=l+ua(e.align,this.top,this.bottom-t-e.labels.padding-this._computeTitleHeight())}const h=ua(i,d,d+u);n.textAlign=s.textAlign(da(i)),n.textBaseline="middle",n.strokeStyle=t.color,n.fillStyle=t.color,n.font=r.string,qa(n,t.text,h,c,r)}_computeTitleHeight(){const e=this.options.title,t=rs(e.font),r=ts(e.padding);return e.display?t.lineHeight+r.height:0}_getLegendItemAt(e,t){let r,a,s;if(ta(e,this.left,this.right)&&ta(t,this.top,this.bottom))for(s=this.legendHitBoxes,r=0;r<s.length;++r)if(a=s[r],ta(e,a.left,a.left+a.width)&&ta(t,a.top,a.top+a.height))return this.legendItems[r];return null}handleEvent(e){const t=this.options;if(!function(e,t){if(("mousemove"===e||"mouseout"===e)&&(t.onHover||t.onLeave))return!0;if(t.onClick&&("click"===e||"mouseup"===e))return!0;return!1}(e.type,t))return;const r=this._getLegendItemAt(e.x,e.y);if("mousemove"===e.type||"mouseout"===e.type){const n=this._hoveredItem,i=(s=r,null!==(a=n)&&null!==s&&a.datasetIndex===s.datasetIndex&&a.index===s.index);n&&!i&&xr(t.onLeave,[e,n,this],this),this._hoveredItem=r,r&&!i&&xr(t.onHover,[e,r,this],this)}else r&&xr(t.onClick,[e,r,this],this);var a,s}}function Ro(e,t){return t*(e.text?e.text.length:0)}var Mo={id:"legend",_element:Oo,start(e,t,r){const a=e.legend=new Oo({ctx:e.ctx,options:r,chart:e});ri.configure(e,a,r),ri.addBox(e,a)},stop(e){ri.removeBox(e,e.legend),delete e.legend},beforeUpdate(e,t,r){const a=e.legend;ri.configure(e,a,r),a.options=r},afterUpdate(e){const t=e.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(e,t,r){const a=t.datasetIndex,s=r.chart;s.isDatasetVisible(a)?(s.hide(a),t.hidden=!0):(s.show(a),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:e=>e.chart.options.color,boxWidth:40,padding:10,generateLabels(e){const t=e.data.datasets,{labels:{usePointStyle:r,pointStyle:a,textAlign:s,color:n,useBorderRadius:i,borderRadius:o}}=e.legend.options;return e._getSortedDatasetMetas().map(e=>{const l=e.controller.getStyle(r?0:void 0),c=ts(l.borderWidth);return{text:t[e.index].label,fillStyle:l.backgroundColor,fontColor:n,hidden:!e.visible,lineCap:l.borderCapStyle,lineDash:l.borderDash,lineDashOffset:l.borderDashOffset,lineJoin:l.borderJoinStyle,lineWidth:(c.width+c.height)/4,strokeStyle:l.borderColor,pointStyle:a||l.pointStyle,rotation:l.rotation,textAlign:s||l.textAlign,borderRadius:i&&(o||l.borderRadius),datasetIndex:e.index}},this)}},title:{color:e=>e.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:e=>!e.startsWith("on"),labels:{_scriptable:e=>!["generateLabels","filter","sort"].includes(e)}}};class Fo extends yi{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t){const r=this.options;if(this.left=0,this.top=0,!r.display)return void(this.width=this.height=this.right=this.bottom=0);this.width=this.right=e,this.height=this.bottom=t;const a=ur(r.text)?r.text.length:1;this._padding=ts(r.padding);const s=a*rs(r.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=s:this.width=s}isHorizontal(){const e=this.options.position;return"top"===e||"bottom"===e}_drawArgs(e){const{top:t,left:r,bottom:a,right:s,options:n}=this,i=n.align;let o,l,c,d=0;return this.isHorizontal()?(l=ua(i,r,s),c=t+e,o=s-r):("left"===n.position?(l=r+e,c=ua(i,a,t),d=-.5*Pr):(l=s-e,c=ua(i,t,a),d=.5*Pr),o=a-t),{titleX:l,titleY:c,maxWidth:o,rotation:d}}draw(){const e=this.ctx,t=this.options;if(!t.display)return;const r=rs(t.font),a=r.lineHeight/2+this._padding.top,{titleX:s,titleY:n,maxWidth:i,rotation:o}=this._drawArgs(a);qa(e,t.text,0,0,r,{color:t.color,maxWidth:i,rotation:o,textAlign:da(t.align),textBaseline:"middle",translation:[s,n]})}}var Lo={id:"title",_element:Fo,start(e,t,r){!function(e,t){const r=new Fo({ctx:e.ctx,options:t,chart:e});ri.configure(e,r,t),ri.addBox(e,r),e.titleBlock=r}(e,r)},stop(e){const t=e.titleBlock;ri.removeBox(e,t),delete e.titleBlock},beforeUpdate(e,t,r){const a=e.titleBlock;ri.configure(e,a,r),a.options=r},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};new WeakMap;const zo={average(e){if(!e.length)return!1;let t,r,a=new Set,s=0,n=0;for(t=0,r=e.length;t<r;++t){const r=e[t].element;if(r&&r.hasValue()){const e=r.tooltipPosition();a.add(e.x),s+=e.y,++n}}if(0===n||0===a.size)return!1;return{x:[...a].reduce((e,t)=>e+t)/a.size,y:s/n}},nearest(e,t){if(!e.length)return!1;let r,a,s,n=t.x,i=t.y,o=Number.POSITIVE_INFINITY;for(r=0,a=e.length;r<a;++r){const a=e[r].element;if(a&&a.hasValue()){const e=Jr(t,a.getCenterPoint());e<o&&(o=e,s=a)}}if(s){const e=s.tooltipPosition();n=e.x,i=e.y}return{x:n,y:i}}};function Bo(e,t){return t&&(ur(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function Uo(e){return("string"===typeof e||e instanceof String)&&e.indexOf("\n")>-1?e.split("\n"):e}function Wo(e,t){const{element:r,datasetIndex:a,index:s}=t,n=e.getDatasetMeta(a).controller,{label:i,value:o}=n.getLabelAndValue(s);return{chart:e,label:i,parsed:n.getParsed(s),raw:e.data.datasets[a].data[s],formattedValue:o,dataset:n.getDataset(),dataIndex:s,datasetIndex:a,element:r}}function Ho(e,t){const r=e.chart.ctx,{body:a,footer:s,title:n}=e,{boxWidth:i,boxHeight:o}=t,l=rs(t.bodyFont),c=rs(t.titleFont),d=rs(t.footerFont),u=n.length,h=s.length,f=a.length,m=ts(t.padding);let p=m.height,g=0,x=a.reduce((e,t)=>e+t.before.length+t.lines.length+t.after.length,0);if(x+=e.beforeBody.length+e.afterBody.length,u&&(p+=u*c.lineHeight+(u-1)*t.titleSpacing+t.titleMarginBottom),x){p+=f*(t.displayColors?Math.max(o,l.lineHeight):l.lineHeight)+(x-f)*l.lineHeight+(x-1)*t.bodySpacing}h&&(p+=t.footerMarginTop+h*d.lineHeight+(h-1)*t.footerSpacing);let b=0;const v=function(e){g=Math.max(g,r.measureText(e).width+b)};return r.save(),r.font=c.string,br(e.title,v),r.font=l.string,br(e.beforeBody.concat(e.afterBody),v),b=t.displayColors?i+2+t.boxPadding:0,br(a,e=>{br(e.before,v),br(e.lines,v),br(e.after,v)}),b=0,r.font=d.string,br(e.footer,v),r.restore(),g+=m.width,{width:g,height:p}}function Vo(e,t,r,a){const{x:s,width:n}=r,{width:i,chartArea:{left:o,right:l}}=e;let c="center";return"center"===a?c=s<=(o+l)/2?"left":"right":s<=n/2?c="left":s>=i-n/2&&(c="right"),function(e,t,r,a){const{x:s,width:n}=a,i=r.caretSize+r.caretPadding;return"left"===e&&s+n+i>t.width||"right"===e&&s-n-i<0||void 0}(c,e,t,r)&&(c="center"),c}function Go(e,t,r){const a=r.yAlign||t.yAlign||function(e,t){const{y:r,height:a}=t;return r<a/2?"top":r>e.height-a/2?"bottom":"center"}(e,r);return{xAlign:r.xAlign||t.xAlign||Vo(e,t,r,a),yAlign:a}}function qo(e,t,r,a){const{caretSize:s,caretPadding:n,cornerRadius:i}=e,{xAlign:o,yAlign:l}=r,c=s+n,{topLeft:d,topRight:u,bottomLeft:h,bottomRight:f}=es(i);let m=function(e,t){let{x:r,width:a}=e;return"right"===t?r-=a:"center"===t&&(r-=a/2),r}(t,o);const p=function(e,t,r){let{y:a,height:s}=e;return"top"===t?a+=r:a-="bottom"===t?s+r:s/2,a}(t,l,c);return"center"===l?"left"===o?m+=c:"right"===o&&(m-=c):"left"===o?m-=Math.max(d,h)+s:"right"===o&&(m+=Math.max(u,f)+s),{x:ea(m,0,a.width-t.width),y:ea(p,0,a.height-t.height)}}function $o(e,t,r){const a=ts(r.padding);return"center"===t?e.x+e.width/2:"right"===t?e.x+e.width-a.right:e.x+a.left}function Ko(e){return Bo([],Uo(e))}function Yo(e,t){const r=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return r?e.override(r):e}const Jo={beforeTitle:lr,title(e){if(e.length>0){const t=e[0],r=t.chart.data.labels,a=r?r.length:0;if(this&&this.options&&"dataset"===this.options.mode)return t.dataset.label||"";if(t.label)return t.label;if(a>0&&t.dataIndex<a)return r[t.dataIndex]}return""},afterTitle:lr,beforeBody:lr,beforeLabel:lr,label(e){if(this&&this.options&&"dataset"===this.options.mode)return e.label+": "+e.formattedValue||e.formattedValue;let t=e.dataset.label||"";t&&(t+=": ");const r=e.formattedValue;return dr(r)||(t+=r),t},labelColor(e){const t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){const t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:lr,afterBody:lr,beforeFooter:lr,footer:lr,afterFooter:lr};function Xo(e,t,r,a){const s=e[t].call(r,a);return"undefined"===typeof s?Jo[t].call(r,a):s}class Qo extends yi{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,r=this.options.setContext(this.getContext()),a=r.enabled&&t.options.animation&&r.animations,s=new sn(this.chart,a);return a._cacheable&&(this._cachedAnimations=Object.freeze(s)),s}getContext(){return this.$context||(this.$context=(e=this.chart.getContext(),t=this,r=this._tooltipItems,ss(e,{tooltip:t,tooltipItems:r,type:"tooltip"})));var e,t,r}getTitle(e,t){const{callbacks:r}=t,a=Xo(r,"beforeTitle",this,e),s=Xo(r,"title",this,e),n=Xo(r,"afterTitle",this,e);let i=[];return i=Bo(i,Uo(a)),i=Bo(i,Uo(s)),i=Bo(i,Uo(n)),i}getBeforeBody(e,t){return Ko(Xo(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:r}=t,a=[];return br(e,e=>{const t={before:[],lines:[],after:[]},s=Yo(r,e);Bo(t.before,Uo(Xo(s,"beforeLabel",this,e))),Bo(t.lines,Xo(s,"label",this,e)),Bo(t.after,Uo(Xo(s,"afterLabel",this,e))),a.push(t)}),a}getAfterBody(e,t){return Ko(Xo(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:r}=t,a=Xo(r,"beforeFooter",this,e),s=Xo(r,"footer",this,e),n=Xo(r,"afterFooter",this,e);let i=[];return i=Bo(i,Uo(a)),i=Bo(i,Uo(s)),i=Bo(i,Uo(n)),i}_createItems(e){const t=this._active,r=this.chart.data,a=[],s=[],n=[];let i,o,l=[];for(i=0,o=t.length;i<o;++i)l.push(Wo(this.chart,t[i]));return e.filter&&(l=l.filter((t,a,s)=>e.filter(t,a,s,r))),e.itemSort&&(l=l.sort((t,a)=>e.itemSort(t,a,r))),br(l,t=>{const r=Yo(e.callbacks,t);a.push(Xo(r,"labelColor",this,t)),s.push(Xo(r,"labelPointStyle",this,t)),n.push(Xo(r,"labelTextColor",this,t))}),this.labelColors=a,this.labelPointStyles=s,this.labelTextColors=n,this.dataPoints=l,l}update(e,t){const r=this.options.setContext(this.getContext()),a=this._active;let s,n=[];if(a.length){const e=zo[r.position].call(this,a,this._eventPosition);n=this._createItems(r),this.title=this.getTitle(n,r),this.beforeBody=this.getBeforeBody(n,r),this.body=this.getBody(n,r),this.afterBody=this.getAfterBody(n,r),this.footer=this.getFooter(n,r);const t=this._size=Ho(this,r),i=Object.assign({},e,t),o=Go(this.chart,r,i),l=qo(r,i,o,this.chart);this.xAlign=o.xAlign,this.yAlign=o.yAlign,s={opacity:1,x:l.x,y:l.y,width:t.width,height:t.height,caretX:e.x,caretY:e.y}}else 0!==this.opacity&&(s={opacity:0});this._tooltipItems=n,this.$context=void 0,s&&this._resolveAnimations().update(this,s),e&&r.external&&r.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,r,a){const s=this.getCaretPosition(e,r,a);t.lineTo(s.x1,s.y1),t.lineTo(s.x2,s.y2),t.lineTo(s.x3,s.y3)}getCaretPosition(e,t,r){const{xAlign:a,yAlign:s}=this,{caretSize:n,cornerRadius:i}=r,{topLeft:o,topRight:l,bottomLeft:c,bottomRight:d}=es(i),{x:u,y:h}=e,{width:f,height:m}=t;let p,g,x,b,v,y;return"center"===s?(v=h+m/2,"left"===a?(p=u,g=p-n,b=v+n,y=v-n):(p=u+f,g=p+n,b=v-n,y=v+n),x=p):(g="left"===a?u+Math.max(o,c)+n:"right"===a?u+f-Math.max(l,d)-n:this.caretX,"top"===s?(b=h,v=b-n,p=g-n,x=g+n):(b=h+m,v=b+n,p=g+n,x=g-n),y=b),{x1:p,x2:g,x3:x,y1:b,y2:v,y3:y}}drawTitle(e,t,r){const a=this.title,s=a.length;let n,i,o;if(s){const l=Us(r.rtl,this.x,this.width);for(e.x=$o(this,r.titleAlign,r),t.textAlign=l.textAlign(r.titleAlign),t.textBaseline="middle",n=rs(r.titleFont),i=r.titleSpacing,t.fillStyle=r.titleColor,t.font=n.string,o=0;o<s;++o)t.fillText(a[o],l.x(e.x),e.y+n.lineHeight/2),e.y+=n.lineHeight+i,o+1===s&&(e.y+=r.titleMarginBottom-i)}}_drawColorBox(e,t,r,a,s){const n=this.labelColors[r],i=this.labelPointStyles[r],{boxHeight:o,boxWidth:l}=s,c=rs(s.bodyFont),d=$o(this,"left",s),u=a.x(d),h=o<c.lineHeight?(c.lineHeight-o)/2:0,f=t.y+h;if(s.usePointStyle){const t={radius:Math.min(l,o)/2,pointStyle:i.pointStyle,rotation:i.rotation,borderWidth:1},r=a.leftForLtr(u,l)+l/2,c=f+o/2;e.strokeStyle=s.multiKeyBackground,e.fillStyle=s.multiKeyBackground,Fa(e,t,r,c),e.strokeStyle=n.borderColor,e.fillStyle=n.backgroundColor,Fa(e,t,r,c)}else{e.lineWidth=hr(n.borderWidth)?Math.max(...Object.values(n.borderWidth)):n.borderWidth||1,e.strokeStyle=n.borderColor,e.setLineDash(n.borderDash||[]),e.lineDashOffset=n.borderDashOffset||0;const t=a.leftForLtr(u,l),r=a.leftForLtr(a.xPlus(u,1),l-2),i=es(n.borderRadius);Object.values(i).some(e=>0!==e)?(e.beginPath(),e.fillStyle=s.multiKeyBackground,$a(e,{x:t,y:f,w:l,h:o,radius:i}),e.fill(),e.stroke(),e.fillStyle=n.backgroundColor,e.beginPath(),$a(e,{x:r,y:f+1,w:l-2,h:o-2,radius:i}),e.fill()):(e.fillStyle=s.multiKeyBackground,e.fillRect(t,f,l,o),e.strokeRect(t,f,l,o),e.fillStyle=n.backgroundColor,e.fillRect(r,f+1,l-2,o-2))}e.fillStyle=this.labelTextColors[r]}drawBody(e,t,r){const{body:a}=this,{bodySpacing:s,bodyAlign:n,displayColors:i,boxHeight:o,boxWidth:l,boxPadding:c}=r,d=rs(r.bodyFont);let u=d.lineHeight,h=0;const f=Us(r.rtl,this.x,this.width),m=function(r){t.fillText(r,f.x(e.x+h),e.y+u/2),e.y+=u+s},p=f.textAlign(n);let g,x,b,v,y,w,j;for(t.textAlign=n,t.textBaseline="middle",t.font=d.string,e.x=$o(this,p,r),t.fillStyle=r.bodyColor,br(this.beforeBody,m),h=i&&"right"!==p?"center"===n?l/2+c:l+2+c:0,v=0,w=a.length;v<w;++v){for(g=a[v],x=this.labelTextColors[v],t.fillStyle=x,br(g.before,m),b=g.lines,i&&b.length&&(this._drawColorBox(t,e,v,f,r),u=Math.max(d.lineHeight,o)),y=0,j=b.length;y<j;++y)m(b[y]),u=d.lineHeight;br(g.after,m)}h=0,u=d.lineHeight,br(this.afterBody,m),e.y-=s}drawFooter(e,t,r){const a=this.footer,s=a.length;let n,i;if(s){const o=Us(r.rtl,this.x,this.width);for(e.x=$o(this,r.footerAlign,r),e.y+=r.footerMarginTop,t.textAlign=o.textAlign(r.footerAlign),t.textBaseline="middle",n=rs(r.footerFont),t.fillStyle=r.footerColor,t.font=n.string,i=0;i<s;++i)t.fillText(a[i],o.x(e.x),e.y+n.lineHeight/2),e.y+=n.lineHeight+r.footerSpacing}}drawBackground(e,t,r,a){const{xAlign:s,yAlign:n}=this,{x:i,y:o}=e,{width:l,height:c}=r,{topLeft:d,topRight:u,bottomLeft:h,bottomRight:f}=es(a.cornerRadius);t.fillStyle=a.backgroundColor,t.strokeStyle=a.borderColor,t.lineWidth=a.borderWidth,t.beginPath(),t.moveTo(i+d,o),"top"===n&&this.drawCaret(e,t,r,a),t.lineTo(i+l-u,o),t.quadraticCurveTo(i+l,o,i+l,o+u),"center"===n&&"right"===s&&this.drawCaret(e,t,r,a),t.lineTo(i+l,o+c-f),t.quadraticCurveTo(i+l,o+c,i+l-f,o+c),"bottom"===n&&this.drawCaret(e,t,r,a),t.lineTo(i+h,o+c),t.quadraticCurveTo(i,o+c,i,o+c-h),"center"===n&&"left"===s&&this.drawCaret(e,t,r,a),t.lineTo(i,o+d),t.quadraticCurveTo(i,o,i+d,o),t.closePath(),t.fill(),a.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,r=this.$animations,a=r&&r.x,s=r&&r.y;if(a||s){const r=zo[e.position].call(this,this._active,this._eventPosition);if(!r)return;const n=this._size=Ho(this,e),i=Object.assign({},r,this._size),o=Go(t,e,i),l=qo(e,i,o,t);a._to===l.x&&s._to===l.y||(this.xAlign=o.xAlign,this.yAlign=o.yAlign,this.width=n.width,this.height=n.height,this.caretX=r.x,this.caretY=r.y,this._resolveAnimations().update(this,l))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let r=this.opacity;if(!r)return;this._updateAnimationTarget(t);const a={width:this.width,height:this.height},s={x:this.x,y:this.y};r=Math.abs(r)<.001?0:r;const n=ts(t.padding),i=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&i&&(e.save(),e.globalAlpha=r,this.drawBackground(s,e,a,t),Ws(e,t.textDirection),s.y+=n.top,this.drawTitle(s,e,t),this.drawBody(s,e,t),this.drawFooter(s,e,t),Hs(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const r=this._active,a=e.map(e=>{let{datasetIndex:t,index:r}=e;const a=this.chart.getDatasetMeta(t);if(!a)throw new Error("Cannot find a dataset at index "+t);return{datasetIndex:t,element:a.data[r],index:r}}),s=!vr(r,a),n=this._positionChanged(a,t);(s||n)&&(this._active=a,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const a=this.options,s=this._active||[],n=this._getActiveElements(e,s,t,r),i=this._positionChanged(n,e),o=t||!vr(n,s)||i;return o&&(this._active=n,(a.enabled||a.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),o}_getActiveElements(e,t,r,a){const s=this.options;if("mouseout"===e.type)return[];if(!a)return t.filter(e=>this.chart.data.datasets[e.datasetIndex]&&void 0!==this.chart.getDatasetMeta(e.datasetIndex).controller.getParsed(e.index));const n=this.chart.getElementsAtEventForMode(e,s.mode,s,r);return s.reverse&&n.reverse(),n}_positionChanged(e,t){const{caretX:r,caretY:a,options:s}=this,n=zo[s.position].call(this,e,t);return!1!==n&&(r!==n.x||a!==n.y)}}(0,_t.A)(Qo,"positioners",zo);var Zo={id:"tooltip",_element:Qo,positioners:zo,afterInit(e,t,r){r&&(e.tooltip=new Qo({chart:e,options:r}))},beforeUpdate(e,t,r){e.tooltip&&e.tooltip.initialize(r)},reset(e,t,r){e.tooltip&&e.tooltip.initialize(r)},afterDraw(e){const t=e.tooltip;if(t&&t._willRender()){const r={tooltip:t};if(!1===e.notifyPlugins("beforeTooltipDraw",(0,n.A)((0,n.A)({},r),{},{cancelable:!0})))return;t.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",r)}},afterEvent(e,t){if(e.tooltip){const r=t.replay;e.tooltip.handleEvent(t.event,r,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,t)=>t.bodyFont.size,boxWidth:(e,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:Jo},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>"filter"!==e&&"itemSort"!==e&&"external"!==e,_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};function el(e,t,r,a){const s=e.indexOf(t);if(-1===s)return((e,t,r,a)=>("string"===typeof t?(r=e.push(t)-1,a.unshift({index:r,label:t})):isNaN(t)&&(r=null),r))(e,t,r,a);return s!==e.lastIndexOf(t)?r:s}function tl(e){const t=this.getLabels();return e>=0&&e<t.length?t[e]:e}class rl extends Ai{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const t=this._addedLabels;if(t.length){const e=this.getLabels();for(const{index:r,label:a}of t)e[r]===a&&e.splice(r,1);this._addedLabels=[]}super.init(e)}parse(e,t){if(dr(e))return null;const r=this.getLabels();return((e,t)=>null===e?null:ea(Math.round(e),0,t))(t=isFinite(t)&&r[t]===e?t:el(r,e,pr(t,e),this._addedLabels),r.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:r,max:a}=this.getMinMax(!0);"ticks"===this.options.bounds&&(e||(r=0),t||(a=this.getLabels().length-1)),this.min=r,this.max=a}buildTicks(){const e=this.min,t=this.max,r=this.options.offset,a=[];let s=this.getLabels();s=0===e&&t===s.length-1?s:s.slice(e,t+1),this._valueRange=Math.max(s.length-(r?0:1),1),this._startValue=this.min-(r?.5:0);for(let n=e;n<=t;n++)a.push({value:n});return a}getLabelForValue(e){return tl.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return"number"!==typeof e&&(e=this.parse(e)),null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}function al(e,t){const r=[],{bounds:a,step:s,min:n,max:i,precision:o,count:l,maxTicks:c,maxDigits:d,includeBounds:u}=e,h=s||1,f=c-1,{min:m,max:p}=t,g=!dr(n),x=!dr(i),b=!dr(l),v=(p-m)/(d+1);let y,w,j,N,k=Hr((p-m)/f/h)*h;if(k<1e-14&&!g&&!x)return[{value:m},{value:p}];N=Math.ceil(p/k)-Math.floor(m/k),N>f&&(k=Hr(N*k/f/h)*h),dr(o)||(y=Math.pow(10,o),k=Math.ceil(k*y)/y),"ticks"===a?(w=Math.floor(m/k)*k,j=Math.ceil(p/k)*k):(w=m,j=p),g&&x&&s&&function(e,t){const r=Math.round(e);return r-t<=e&&r+t>=e}((i-n)/s,k/1e3)?(N=Math.round(Math.min((i-n)/k,c)),k=(i-n)/N,w=n,j=i):b?(w=g?n:w,j=x?i:j,N=l-1,k=(j-w)/N):(N=(j-w)/k,N=Wr(N,Math.round(N),k/1e3)?Math.round(N):Math.ceil(N));const S=Math.max(Kr(k),Kr(w));y=Math.pow(10,dr(o)?S:o),w=Math.round(w*y)/y,j=Math.round(j*y)/y;let E=0;for(g&&(u&&w!==n?(r.push({value:n}),w<n&&E++,Wr(Math.round((w+E*k)*y)/y,n,sl(n,v,e))&&E++):w<n&&E++);E<N;++E){const e=Math.round((w+E*k)*y)/y;if(x&&e>i)break;r.push({value:e})}return x&&u&&j!==i?r.length&&Wr(r[r.length-1].value,i,sl(i,v,e))?r[r.length-1].value=i:r.push({value:i}):x&&j!==i||r.push({value:j}),r}function sl(e,t,r){let{horizontal:a,minRotation:s}=r;const n=qr(s),i=(a?Math.sin(n):Math.cos(n))||.001,o=.75*t*(""+e).length;return Math.min(t/i,o)}(0,_t.A)(rl,"id","category"),(0,_t.A)(rl,"defaults",{ticks:{callback:tl}});class nl extends Ai{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return dr(e)||("number"===typeof e||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:r}=this.getUserBounds();let{min:a,max:s}=this;const n=e=>a=t?a:e,i=e=>s=r?s:e;if(e){const e=Ur(a),t=Ur(s);e<0&&t<0?i(0):e>0&&t>0&&n(0)}if(a===s){let t=0===s?1:Math.abs(.05*s);i(s+t),e||n(a-t)}this.min=a,this.max=s}getTickLimit(){const e=this.options.ticks;let t,{maxTicksLimit:r,stepSize:a}=e;return a?(t=Math.ceil(this.max/a)-Math.floor(this.min/a)+1,t>1e3&&(console.warn("scales.".concat(this.id,".ticks.stepSize: ").concat(a," would result generating up to ").concat(t," ticks. Limiting to 1000.")),t=1e3)):(t=this.computeTickLimit(),r=r||11),r&&(t=Math.min(r,t)),t}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let r=this.getTickLimit();r=Math.max(2,r);const a=al({maxTicks:r,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:!1!==t.includeBounds},this._range||this);return"ticks"===e.bounds&&Gr(a,this,"value"),e.reverse?(a.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),a}configure(){const e=this.ticks;let t=this.min,r=this.max;if(super.configure(),this.options.offset&&e.length){const a=(r-t)/Math.max(e.length-1,1)/2;t-=a,r+=a}this._startValue=t,this._endValue=r,this._valueRange=r-t}getLabelForValue(e){return ka(e,this.chart.options.locale,this.options.ticks.format)}}class il extends nl{determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=fr(e)?e:0,this.max=fr(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,r=qr(this.options.ticks.minRotation),a=(e?Math.sin(r):Math.cos(r))||.001,s=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,s.lineHeight/a))}getPixelForValue(e){return null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}(0,_t.A)(il,"id","linear"),(0,_t.A)(il,"defaults",{ticks:{callback:Ea.formatters.numeric}});const ol=e=>Math.floor(Br(e)),ll=(e,t)=>Math.pow(10,ol(e)+t);function cl(e){return 1===e/Math.pow(10,ol(e))}function dl(e,t,r){const a=Math.pow(10,r),s=Math.floor(e/a);return Math.ceil(t/a)-s}function ul(e,t){let{min:r,max:a}=t;r=mr(e.min,r);const s=[],n=ol(r);let i=function(e,t){let r=ol(t-e);for(;dl(e,t,r)>10;)r++;for(;dl(e,t,r)<10;)r--;return Math.min(r,ol(e))}(r,a),o=i<0?Math.pow(10,Math.abs(i)):1;const l=Math.pow(10,i),c=n>i?Math.pow(10,n):0,d=Math.round((r-c)*o)/o,u=Math.floor((r-c)/l/10)*l*10;let h=Math.floor((d-u)/Math.pow(10,i)),f=mr(e.min,Math.round((c+u+h*Math.pow(10,i))*o)/o);for(;f<a;)s.push({value:f,major:cl(f),significand:h}),h>=10?h=h<15?15:20:h++,h>=20&&(i++,h=2,o=i>=0?1:o),f=Math.round((c+u+h*Math.pow(10,i))*o)/o;const m=mr(e.max,f);return s.push({value:m,major:cl(m),significand:h}),s}class hl extends Ai{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,t){const r=nl.prototype.parse.apply(this,[e,t]);if(0!==r)return fr(r)&&r>0?r:null;this._zero=!0}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=fr(e)?Math.max(0,e):null,this.max=fr(t)?Math.max(0,t):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!fr(this._userMin)&&(this.min=e===ll(this.min,0)?ll(this.min,-1):ll(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let r=this.min,a=this.max;const s=t=>r=e?r:t,n=e=>a=t?a:e;r===a&&(r<=0?(s(1),n(10)):(s(ll(r,-1)),n(ll(a,1)))),r<=0&&s(ll(a,-1)),a<=0&&n(ll(r,1)),this.min=r,this.max=a}buildTicks(){const e=this.options,t=ul({min:this._userMin,max:this._userMax},this);return"ticks"===e.bounds&&Gr(t,this,"value"),e.reverse?(t.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),t}getLabelForValue(e){return void 0===e?"0":ka(e,this.chart.options.locale,this.options.ticks.format)}configure(){const e=this.min;super.configure(),this._startValue=Br(e),this._valueRange=Br(this.max)-Br(e)}getPixelForValue(e){return void 0!==e&&0!==e||(e=this.min),null===e||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(Br(e)-this._startValue)/this._valueRange)}getValueForPixel(e){const t=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+t*this._valueRange)}}function fl(e){const t=e.ticks;if(t.display&&e.display){const e=ts(t.backdropPadding);return pr(t.font&&t.font.size,Pa.font.size)+e.height}return 0}function ml(e,t,r){return r=ur(r)?r:[r],{w:Oa(e,t.string,r),h:r.length*t.lineHeight}}function pl(e,t,r,a,s){return e===a||e===s?{start:t-r/2,end:t+r/2}:e<a||e>s?{start:t-r,end:t}:{start:t,end:t+r}}function gl(e){const t={l:e.left+e._padding.left,r:e.right-e._padding.right,t:e.top+e._padding.top,b:e.bottom-e._padding.bottom},r=Object.assign({},t),a=[],s=[],n=e._pointLabels.length,i=e.options.pointLabels,o=i.centerPointLabels?Pr/n:0;for(let l=0;l<n;l++){const n=i.setContext(e.getPointLabelContext(l));s[l]=n.padding;const c=e.getPointPosition(l,e.drawingArea+s[l],o),d=rs(n.font),u=ml(e.ctx,d,e._pointLabels[l]);a[l]=u;const h=Qr(e.getIndexAngle(l)+o),f=Math.round($r(h));xl(r,t,h,pl(f,c.x,u.w,0,180),pl(f,c.y,u.h,90,270))}e.setCenterPoint(t.l-r.l,r.r-t.r,t.t-r.t,r.b-t.b),e._pointLabelItems=function(e,t,r){const a=[],s=e._pointLabels.length,n=e.options,{centerPointLabels:i,display:o}=n.pointLabels,l={extra:fl(n)/2,additionalAngle:i?Pr/s:0};let c;for(let d=0;d<s;d++){l.padding=r[d],l.size=t[d];const s=bl(e,d,l);a.push(s),"auto"===o&&(s.visible=vl(s,c),s.visible&&(c=s))}return a}(e,a,s)}function xl(e,t,r,a,s){const n=Math.abs(Math.sin(r)),i=Math.abs(Math.cos(r));let o=0,l=0;a.start<t.l?(o=(t.l-a.start)/n,e.l=Math.min(e.l,t.l-o)):a.end>t.r&&(o=(a.end-t.r)/n,e.r=Math.max(e.r,t.r+o)),s.start<t.t?(l=(t.t-s.start)/i,e.t=Math.min(e.t,t.t-l)):s.end>t.b&&(l=(s.end-t.b)/i,e.b=Math.max(e.b,t.b+l))}function bl(e,t,r){const a=e.drawingArea,{extra:s,additionalAngle:n,padding:i,size:o}=r,l=e.getPointPosition(t,a+s+i,n),c=Math.round($r(Qr(l.angle+Fr))),d=function(e,t,r){90===r||270===r?e-=t/2:(r>270||r<90)&&(e-=t);return e}(l.y,o.h,c),u=function(e){if(0===e||180===e)return"center";if(e<180)return"left";return"right"}(c),h=function(e,t,r){"right"===r?e-=t:"center"===r&&(e-=t/2);return e}(l.x,o.w,u);return{visible:!0,x:l.x,y:d,textAlign:u,left:h,top:d,right:h+o.w,bottom:d+o.h}}function vl(e,t){if(!t)return!0;const{left:r,top:a,right:s,bottom:n}=e;return!(za({x:r,y:a},t)||za({x:r,y:n},t)||za({x:s,y:a},t)||za({x:s,y:n},t))}function yl(e,t,r){const{left:a,top:s,right:n,bottom:i}=r,{backdropColor:o}=t;if(!dr(o)){const r=es(t.borderRadius),l=ts(t.backdropPadding);e.fillStyle=o;const c=a-l.left,d=s-l.top,u=n-a+l.width,h=i-s+l.height;Object.values(r).some(e=>0!==e)?(e.beginPath(),$a(e,{x:c,y:d,w:u,h:h,radius:r}),e.fill()):e.fillRect(c,d,u,h)}}function wl(e,t,r,a){const{ctx:s}=e;if(r)s.arc(e.xCenter,e.yCenter,t,0,Ir);else{let r=e.getPointPosition(0,t);s.moveTo(r.x,r.y);for(let n=1;n<a;n++)r=e.getPointPosition(n,t),s.lineTo(r.x,r.y)}}(0,_t.A)(hl,"id","logarithmic"),(0,_t.A)(hl,"defaults",{ticks:{callback:Ea.formatters.logarithmic,major:{enabled:!0}}});class jl extends nl{constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=ts(fl(this.options)/2),t=this.width=this.maxWidth-e.width,r=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+t/2+e.left),this.yCenter=Math.floor(this.top+r/2+e.top),this.drawingArea=Math.floor(Math.min(t,r)/2)}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!1);this.min=fr(e)&&!isNaN(e)?e:0,this.max=fr(t)&&!isNaN(t)?t:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/fl(this.options))}generateTickLabels(e){nl.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((e,t)=>{const r=xr(this.options.pointLabels.callback,[e,t],this);return r||0===r?r:""}).filter((e,t)=>this.chart.getDataVisibility(t))}fit(){const e=this.options;e.display&&e.pointLabels.display?gl(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,t,r,a){this.xCenter+=Math.floor((e-t)/2),this.yCenter+=Math.floor((r-a)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,t,r,a))}getIndexAngle(e){return Qr(e*(Ir/(this._pointLabels.length||1))+qr(this.options.startAngle||0))}getDistanceFromCenterForValue(e){if(dr(e))return NaN;const t=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*t:(e-this.min)*t}getValueForDistanceFromCenter(e){if(dr(e))return NaN;const t=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-t:this.min+t}getPointLabelContext(e){const t=this._pointLabels||[];if(e>=0&&e<t.length){const r=t[e];return function(e,t,r){return ss(e,{label:r,index:t,type:"pointLabel"})}(this.getContext(),e,r)}}getPointPosition(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const a=this.getIndexAngle(e)-Fr+r;return{x:Math.cos(a)*t+this.xCenter,y:Math.sin(a)*t+this.yCenter,angle:a}}getPointPositionForValue(e,t){return this.getPointPosition(e,this.getDistanceFromCenterForValue(t))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:t,top:r,right:a,bottom:s}=this._pointLabelItems[e];return{left:t,top:r,right:a,bottom:s}}drawBackground(){const{backgroundColor:e,grid:{circular:t}}=this.options;if(e){const r=this.ctx;r.save(),r.beginPath(),wl(this,this.getDistanceFromCenterForValue(this._endValue),t,this._pointLabels.length),r.closePath(),r.fillStyle=e,r.fill(),r.restore()}}drawGrid(){const e=this.ctx,t=this.options,{angleLines:r,grid:a,border:s}=t,n=this._pointLabels.length;let i,o,l;if(t.pointLabels.display&&function(e,t){const{ctx:r,options:{pointLabels:a}}=e;for(let s=t-1;s>=0;s--){const t=e._pointLabelItems[s];if(!t.visible)continue;const n=a.setContext(e.getPointLabelContext(s));yl(r,n,t);const i=rs(n.font),{x:o,y:l,textAlign:c}=t;qa(r,e._pointLabels[s],o,l+i.lineHeight/2,i,{color:n.color,textAlign:c,textBaseline:"middle"})}}(this,n),a.display&&this.ticks.forEach((e,t)=>{if(0!==t||0===t&&this.min<0){o=this.getDistanceFromCenterForValue(e.value);const r=this.getContext(t),i=a.setContext(r),l=s.setContext(r);!function(e,t,r,a,s){const n=e.ctx,i=t.circular,{color:o,lineWidth:l}=t;!i&&!a||!o||!l||r<0||(n.save(),n.strokeStyle=o,n.lineWidth=l,n.setLineDash(s.dash||[]),n.lineDashOffset=s.dashOffset,n.beginPath(),wl(e,r,i,a),n.closePath(),n.stroke(),n.restore())}(this,i,o,n,l)}}),r.display){for(e.save(),i=n-1;i>=0;i--){const a=r.setContext(this.getPointLabelContext(i)),{color:s,lineWidth:n}=a;n&&s&&(e.lineWidth=n,e.strokeStyle=s,e.setLineDash(a.borderDash),e.lineDashOffset=a.borderDashOffset,o=this.getDistanceFromCenterForValue(t.reverse?this.min:this.max),l=this.getPointPosition(i,o),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(l.x,l.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const e=this.ctx,t=this.options,r=t.ticks;if(!r.display)return;const a=this.getIndexAngle(0);let s,n;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(a),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach((a,i)=>{if(0===i&&this.min>=0&&!t.reverse)return;const o=r.setContext(this.getContext(i)),l=rs(o.font);if(s=this.getDistanceFromCenterForValue(this.ticks[i].value),o.showLabelBackdrop){e.font=l.string,n=e.measureText(a.label).width,e.fillStyle=o.backdropColor;const t=ts(o.backdropPadding);e.fillRect(-n/2-t.left,-s-l.size/2-t.top,n+t.width,l.size+t.height)}qa(e,a.label,0,-s,l,{color:o.color,strokeColor:o.textStrokeColor,strokeWidth:o.textStrokeWidth})}),e.restore()}drawTitle(){}}(0,_t.A)(jl,"id","radialLinear"),(0,_t.A)(jl,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:Ea.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback:e=>e,padding:5,centerPointLabels:!1}}),(0,_t.A)(jl,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),(0,_t.A)(jl,"descriptors",{angleLines:{_fallback:"grid"}});const Nl={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},kl=Object.keys(Nl);function Sl(e,t){return e-t}function El(e,t){if(dr(t))return null;const r=e._adapter,{parser:a,round:s,isoWeekday:n}=e._parseOpts;let i=t;return"function"===typeof a&&(i=a(i)),fr(i)||(i="string"===typeof a?r.parse(i,a):r.parse(i)),null===i?null:(s&&(i="week"!==s||!Vr(n)&&!0!==n?r.startOf(i,s):r.startOf(i,"isoWeek",n)),+i)}function Tl(e,t,r,a){const s=kl.length;for(let n=kl.indexOf(e);n<s-1;++n){const e=Nl[kl[n]],s=e.steps?e.steps:Number.MAX_SAFE_INTEGER;if(e.common&&Math.ceil((r-t)/(s*e.size))<=a)return kl[n]}return kl[s-1]}function _l(e,t,r){if(r){if(r.length){const{lo:a,hi:s}=ra(r,t);e[r[a]>=t?r[a]:r[s]]=!0}}else e[t]=!0}function Cl(e,t,r){const a=[],s={},n=t.length;let i,o;for(i=0;i<n;++i)o=t[i],s[o]=i,a.push({value:o,major:!1});return 0!==n&&r?function(e,t,r,a){const s=e._adapter,n=+s.startOf(t[0].value,a),i=t[t.length-1].value;let o,l;for(o=n;o<=i;o=+s.add(o,1,a))l=r[o],l>=0&&(t[l].major=!0);return t}(e,a,s,r):a}class Al extends Ai{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=e.time||(e.time={}),a=this._adapter=new Mn(e.adapters.date);a.init(t),kr(r.displayFormats,a.formats()),this._parseOpts={parser:r.parser,round:r.round,isoWeekday:r.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return void 0===e?null:El(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,r=e.time.unit||"day";let{min:a,max:s,minDefined:n,maxDefined:i}=this.getUserBounds();function o(e){n||isNaN(e.min)||(a=Math.min(a,e.min)),i||isNaN(e.max)||(s=Math.max(s,e.max))}n&&i||(o(this._getLabelBounds()),"ticks"===e.bounds&&"labels"===e.ticks.source||o(this.getMinMax(!1))),a=fr(a)&&!isNaN(a)?a:+t.startOf(Date.now(),r),s=fr(s)&&!isNaN(s)?s:+t.endOf(Date.now(),r)+1,this.min=Math.min(a,s-1),this.max=Math.max(a+1,s)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],r=e[e.length-1]),{min:t,max:r}}buildTicks(){const e=this.options,t=e.time,r=e.ticks,a="labels"===r.source?this.getLabelTimestamps():this._generate();"ticks"===e.bounds&&a.length&&(this.min=this._userMin||a[0],this.max=this._userMax||a[a.length-1]);const s=this.min,n=function(e,t,r){let a=0,s=e.length;for(;a<s&&e[a]<t;)a++;for(;s>a&&e[s-1]>r;)s--;return a>0||s<e.length?e.slice(a,s):e}(a,s,this.max);return this._unit=t.unit||(r.autoSkip?Tl(t.minUnit,this.min,this.max,this._getLabelCapacity(s)):function(e,t,r,a,s){for(let n=kl.length-1;n>=kl.indexOf(r);n--){const r=kl[n];if(Nl[r].common&&e._adapter.diff(s,a,r)>=t-1)return r}return kl[r?kl.indexOf(r):0]}(this,n.length,t.minUnit,this.min,this.max)),this._majorUnit=r.major.enabled&&"year"!==this._unit?function(e){for(let t=kl.indexOf(e)+1,r=kl.length;t<r;++t)if(Nl[kl[t]].common)return kl[t]}(this._unit):void 0,this.initOffsets(a),e.reverse&&n.reverse(),Cl(this,n,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(){let e,t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=0,s=0;this.options.offset&&r.length&&(e=this.getDecimalForValue(r[0]),a=1===r.length?1-e:(this.getDecimalForValue(r[1])-e)/2,t=this.getDecimalForValue(r[r.length-1]),s=1===r.length?t:(t-this.getDecimalForValue(r[r.length-2]))/2);const n=r.length<3?.5:.25;a=ea(a,0,n),s=ea(s,0,n),this._offsets={start:a,end:s,factor:1/(a+1+s)}}_generate(){const e=this._adapter,t=this.min,r=this.max,a=this.options,s=a.time,n=s.unit||Tl(s.minUnit,t,r,this._getLabelCapacity(t)),i=pr(a.ticks.stepSize,1),o="week"===n&&s.isoWeekday,l=Vr(o)||!0===o,c={};let d,u,h=t;if(l&&(h=+e.startOf(h,"isoWeek",o)),h=+e.startOf(h,l?"day":n),e.diff(r,t,n)>1e5*i)throw new Error(t+" and "+r+" are too far apart with stepSize of "+i+" "+n);const f="data"===a.ticks.source&&this.getDataTimestamps();for(d=h,u=0;d<r;d=+e.add(d,i,n),u++)_l(c,d,f);return d!==r&&"ticks"!==a.bounds&&1!==u||_l(c,d,f),Object.keys(c).sort(Sl).map(e=>+e)}getLabelForValue(e){const t=this._adapter,r=this.options.time;return r.tooltipFormat?t.format(e,r.tooltipFormat):t.format(e,r.displayFormats.datetime)}format(e,t){const r=this.options.time.displayFormats,a=this._unit,s=t||r[a];return this._adapter.format(e,s)}_tickFormatFunction(e,t,r,a){const s=this.options,n=s.ticks.callback;if(n)return xr(n,[e,t,r],this);const i=s.time.displayFormats,o=this._unit,l=this._majorUnit,c=o&&i[o],d=l&&i[l],u=r[t],h=l&&d&&u&&u.major;return this._adapter.format(e,a||(h?d:c))}generateTickLabels(e){let t,r,a;for(t=0,r=e.length;t<r;++t)a=e[t],a.label=this._tickFormatFunction(a.value,t,e)}getDecimalForValue(e){return null===e?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,r=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+r)*t.factor)}getValueForPixel(e){const t=this._offsets,r=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+r*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,r=this.ctx.measureText(e).width,a=qr(this.isHorizontal()?t.maxRotation:t.minRotation),s=Math.cos(a),n=Math.sin(a),i=this._resolveTickFontOptions(0).size;return{w:r*s+i*n,h:r*n+i*s}}_getLabelCapacity(e){const t=this.options.time,r=t.displayFormats,a=r[t.unit]||r.millisecond,s=this._tickFormatFunction(e,0,Cl(this,[e],this._majorUnit),a),n=this._getLabelSize(s),i=Math.floor(this.isHorizontal()?this.width/n.w:this.height/n.h)-1;return i>0?i:1}getDataTimestamps(){let e,t,r=this._cache.data||[];if(r.length)return r;const a=this.getMatchingVisibleMetas();if(this._normalized&&a.length)return this._cache.data=a[0].controller.getAllParsedValues(this);for(e=0,t=a.length;e<t;++e)r=r.concat(a[e].controller.getAllParsedValues(this));return this._cache.data=this.normalize(r)}getLabelTimestamps(){const e=this._cache.labels||[];let t,r;if(e.length)return e;const a=this.getLabels();for(t=0,r=a.length;t<r;++t)e.push(El(this,a[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return oa(e.sort(Sl))}}function Dl(e,t,r){let a,s,n,i,o=0,l=e.length-1;r?(t>=e[o].pos&&t<=e[l].pos&&({lo:o,hi:l}=aa(e,"pos",t)),({pos:a,time:n}=e[o]),({pos:s,time:i}=e[l])):(t>=e[o].time&&t<=e[l].time&&({lo:o,hi:l}=aa(e,"time",t)),({time:a,pos:n}=e[o]),({time:s,pos:i}=e[l]));const c=s-a;return c?n+(i-n)*(t-a)/c:n}(0,_t.A)(Al,"id","time"),(0,_t.A)(Al,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});class Pl extends Al{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=Dl(t,this.min),this._tableRange=Dl(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:r}=this,a=[],s=[];let n,i,o,l,c;for(n=0,i=e.length;n<i;++n)l=e[n],l>=t&&l<=r&&a.push(l);if(a.length<2)return[{time:t,pos:0},{time:r,pos:1}];for(n=0,i=a.length;n<i;++n)c=a[n+1],o=a[n-1],l=a[n],Math.round((c+o)/2)!==l&&s.push({time:l,pos:n/(i-1)});return s}_generate(){const e=this.min,t=this.max;let r=super.getDataTimestamps();return r.includes(e)&&r.length||r.splice(0,0,e),r.includes(t)&&1!==r.length||r.push(t),r.sort((e,t)=>e-t)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),r=this.getLabelTimestamps();return e=t.length&&r.length?this.normalize(t.concat(r)):t.length?t:r,e=this._cache.all=e,e}getDecimalForValue(e){return(Dl(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,r=this.getDecimalForPixel(e)/t.factor-t.end;return Dl(this._table,r*this._tableRange+this._minPos,!0)}}(0,_t.A)(Pl,"id","timeseries"),(0,_t.A)(Pl,"defaults",Al.defaults);const Il=["height","width","redraw","datasetIdKey","type","data","options","plugins","fallbackContent","updateMode"],Ol="label";function Rl(e,t){"function"===typeof e?e(t):e&&(e.current=t)}function Ml(e,t){e.labels=t}function Fl(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ol;const a=[];e.datasets=t.map(t=>{const s=e.datasets.find(e=>e[r]===t[r]);return s&&t.data&&!a.includes(s)?(a.push(s),Object.assign(s,t),s):(0,n.A)({},t)})}function Ll(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ol;const r={labels:[],datasets:[]};return Ml(r,e.labels),Fl(r,e.datasets,t),r}function zl(e,t){const{height:r=150,width:s=300,redraw:o=!1,datasetIdKey:l,type:c,data:d,options:u,plugins:h=[],fallbackContent:f,updateMode:m}=e,p=i(e,Il),g=(0,a.useRef)(null),x=(0,a.useRef)(null),b=()=>{g.current&&(x.current=new oo(g.current,{type:c,data:Ll(d,l),options:u&&(0,n.A)({},u),plugins:h}),Rl(t,x.current))},v=()=>{Rl(t,null),x.current&&(x.current.destroy(),x.current=null)};return(0,a.useEffect)(()=>{!o&&x.current&&u&&function(e,t){const r=e.options;r&&t&&Object.assign(r,t)}(x.current,u)},[o,u]),(0,a.useEffect)(()=>{!o&&x.current&&Ml(x.current.config.data,d.labels)},[o,d.labels]),(0,a.useEffect)(()=>{!o&&x.current&&d.datasets&&Fl(x.current.config.data,d.datasets,l)},[o,d.datasets]),(0,a.useEffect)(()=>{x.current&&(o?(v(),setTimeout(b)):x.current.update(m))},[o,u,d.labels,d.datasets,m]),(0,a.useEffect)(()=>{x.current&&(v(),setTimeout(b))},[c]),(0,a.useEffect)(()=>(b(),()=>v()),[]),a.createElement("canvas",(0,n.A)({ref:g,role:"img",height:r,width:s},p),f)}const Bl=(0,a.forwardRef)(zl);function Ul(e,t){return oo.register(t),(0,a.forwardRef)((t,r)=>a.createElement(Bl,(0,n.A)((0,n.A)({},t),{},{ref:r,type:e})))}const Wl=Ul("bar",En);var Hl={version:"0.18.5"},Vl=1200,Gl=1252,ql=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],$l={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Kl=function(e){-1!=ql.indexOf(e)&&(Gl=$l[0]=e)};var Yl=function(e){Vl=e,Kl(e)};function Jl(){Yl(1200),Kl(1252)}function Xl(e){for(var t=[],r=0,a=e.length;r<a;++r)t[r]=e.charCodeAt(r);return t}function Ql(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Zl,ec=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return 255==t&&254==r?function(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}(e.slice(2)):254==t&&255==r?Ql(e.slice(2)):65279==t?e.slice(1):e},tc=function(e){return String.fromCharCode(e)},rc=function(e){return String.fromCharCode(e)};var ac="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function sc(e){for(var t="",r=0,a=0,s=0,n=0,i=0,o=0,l=0,c=0;c<e.length;)n=(r=e.charCodeAt(c++))>>2,i=(3&r)<<4|(a=e.charCodeAt(c++))>>4,o=(15&a)<<2|(s=e.charCodeAt(c++))>>6,l=63&s,isNaN(a)?o=l=64:isNaN(s)&&(l=64),t+=ac.charAt(n)+ac.charAt(i)+ac.charAt(o)+ac.charAt(l);return t}function nc(e){var t="",r=0,a=0,s=0,n=0,i=0,o=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)r=ac.indexOf(e.charAt(l++))<<2|(n=ac.indexOf(e.charAt(l++)))>>4,t+=String.fromCharCode(r),a=(15&n)<<4|(i=ac.indexOf(e.charAt(l++)))>>2,64!==i&&(t+=String.fromCharCode(a)),s=(3&i)<<6|(o=ac.indexOf(e.charAt(l++))),64!==o&&(t+=String.fromCharCode(s));return t}var ic=function(){return"undefined"!==typeof Buffer&&"undefined"!==typeof process&&"undefined"!==typeof process.versions&&!!process.versions.node}(),oc=function(){if("undefined"!==typeof Buffer){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(bN){e=!0}return e?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function lc(e){return ic?Buffer.alloc?Buffer.alloc(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}function cc(e){return ic?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}var dc=function(e){return ic?oc(e,"binary"):e.split("").map(function(e){return 255&e.charCodeAt(0)})};function uc(e){if("undefined"===typeof ArrayBuffer)return dc(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=255&e.charCodeAt(a);return t}function hc(e){if(Array.isArray(e))return e.map(function(e){return String.fromCharCode(e)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function fc(e){if("undefined"==typeof ArrayBuffer)throw new Error("Unsupported");if(e instanceof ArrayBuffer)return fc(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var mc=ic?function(e){return Buffer.concat(e.map(function(e){return Buffer.isBuffer(e)?e:oc(e)}))}:function(e){if("undefined"!==typeof Uint8Array){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if("string"==typeof e[t])throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(e){return Array.isArray(e)?e:[].slice.call(e)}))};var pc=/\u0000/g,gc=/[\u0001-\u0006]/g;function xc(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function bc(e,t){var r=""+e;return r.length>=t?r:Id("0",t-r.length)+r}function vc(e,t){var r=""+e;return r.length>=t?r:Id(" ",t-r.length)+r}function yc(e,t){var r=""+e;return r.length>=t?r:r+Id(" ",t-r.length)}var wc=Math.pow(2,32);function jc(e,t){return e>wc||e<-wc?function(e,t){var r=""+Math.round(e);return r.length>=t?r:Id("0",t-r.length)+r}(e,t):function(e,t){var r=""+e;return r.length>=t?r:Id("0",t-r.length)+r}(Math.round(e),t)}function Nc(e,t){return t=t||0,e.length>=7+t&&103===(32|e.charCodeAt(t))&&101===(32|e.charCodeAt(t+1))&&110===(32|e.charCodeAt(t+2))&&101===(32|e.charCodeAt(t+3))&&114===(32|e.charCodeAt(t+4))&&97===(32|e.charCodeAt(t+5))&&108===(32|e.charCodeAt(t+6))}var kc=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Sc=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];var Ec={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "'},Tc={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},_c={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Cc(e,t,r){for(var a=e<0?-1:1,s=e*a,n=0,i=1,o=0,l=1,c=0,d=0,u=Math.floor(s);c<t&&(o=(u=Math.floor(s))*i+n,d=u*c+l,!(s-u<5e-8));)s=1/(s-u),n=i,i=o,l=c,c=d;if(d>t&&(c>t?(d=l,o=n):(d=c,o=i)),!r)return[0,a*o,d];var h=Math.floor(a*o/d);return[h,a*o-h*d,d]}function Ac(e,t,r){if(e>2958465||e<0)return null;var a=0|e,s=Math.floor(86400*(e-a)),n=0,i=[],o={D:a,T:s,u:86400*(e-a)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(a+=1462),o.u>.9999&&(o.u=0,86400==++s&&(o.T=s=0,++a,++o.D)),60===a)i=r?[1317,10,29]:[1900,2,29],n=3;else if(0===a)i=r?[1317,8,29]:[1900,1,0],n=6;else{a>60&&--a;var l=new Date(1900,0,1);l.setDate(l.getDate()+a-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],n=l.getDay(),a<60&&(n=(n+6)%7),r&&(n=function(e,t){t[0]-=581;var r=e.getDay();e<60&&(r=(r+6)%7);return r}(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=n,o}var Dc=new Date(1899,11,31,0,0,0),Pc=Dc.getTime(),Ic=new Date(1900,2,1,0,0,0);function Oc(e,t){var r=e.getTime();return t?r-=1262304e5:e>=Ic&&(r+=864e5),(r-(Pc+6e4*(e.getTimezoneOffset()-Dc.getTimezoneOffset())))/864e5}function Rc(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Mc(e){var t,r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return t=r>=-4&&r<=-1?e.toPrecision(10+r):Math.abs(r)<=9?function(e){var t=e<0?12:11,r=Rc(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10)).length<=t?r:e.toExponential(5)}(e):10===r?e.toFixed(10).substr(0,12):function(e){var t=Rc(e.toFixed(11));return t.length>(e<0?12:11)||"0"===t||"-0"===t?e.toPrecision(6):t}(e),Rc(function(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(t.toUpperCase()))}function Fc(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):Mc(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return sd(14,Oc(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Lc(e,t,r,a){var s,n="",i=0,o=0,l=r.y,c=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:s=l%100,c=2;break;default:s=l%1e4,c=4}break;case 109:switch(t.length){case 1:case 2:s=r.m,c=t.length;break;case 3:return Sc[r.m-1][1];case 5:return Sc[r.m-1][0];default:return Sc[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:s=r.d,c=t.length;break;case 3:return kc[r.q][0];default:return kc[r.q][1]}break;case 104:switch(t.length){case 1:case 2:s=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:s=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:s=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==r.u||"s"!=t&&"ss"!=t?(o=a>=2?3===a?1e3:100:1===a?10:1,(i=Math.round(o*(r.S+r.u)))>=60*o&&(i=0),"s"===t?0===i?"0":""+i/o:(n=bc(i,2+a),"ss"===t?n.substr(0,2):"."+n.substr(2,t.length-1))):bc(r.S,t.length);case 90:switch(t){case"[h]":case"[hh]":s=24*r.D+r.H;break;case"[m]":case"[mm]":s=60*(24*r.D+r.H)+r.M;break;case"[s]":case"[ss]":s=60*(60*(24*r.D+r.H)+r.M)+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=3===t.length?1:2;break;case 101:s=l,c=1}return c>0?bc(s,c):""}function zc(e){if(e.length<=3)return e;for(var t=e.length%3,r=e.substr(0,t);t!=e.length;t+=3)r+=(r.length>0?",":"")+e.substr(t,3);return r}var Bc=/%/g;function Uc(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+Uc(e,-t);var s=e.indexOf(".");-1===s&&(s=e.indexOf("E"));var n=Math.floor(Math.log(t)*Math.LOG10E)%s;if(n<0&&(n+=s),-1===(r=(t/Math.pow(10,n)).toPrecision(a+1+(s+n)%s)).indexOf("e")){var i=Math.floor(Math.log(t)*Math.LOG10E);for(-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+n):r+="E+"+(i-n);"0."===r.substr(0,2);)r=(r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,r,a){return t+r+a.substr(0,(s+n)%s)+"."+a.substr(n)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Wc=/# (\?+)( ?)\/( ?)(\d+)/;var Hc=/^#*0*\.([0#]+)/,Vc=/\).*[0#]/,Gc=/\(###\) ###\\?-####/;function qc(e){for(var t,r="",a=0;a!=e.length;++a)switch(t=e.charCodeAt(a)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function $c(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Kc(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function Yc(e,t,r){if(40===e.charCodeAt(0)&&!t.match(Vc)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Yc("n",a,r):"("+Yc("n",a,-r)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,r){for(var a=t.length-1;44===t.charCodeAt(a-1);)--a;return Qc(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}(e,t,r);if(-1!==t.indexOf("%"))return function(e,t,r){var a=t.replace(Bc,""),s=t.length-a.length;return Qc(e,a,r*Math.pow(10,2*s))+Id("%",s)}(e,t,r);if(-1!==t.indexOf("E"))return Uc(t,r);if(36===t.charCodeAt(0))return"$"+Yc(e,t.substr(" "==t.charAt(1)?2:1),r);var s,n,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+jc(l,t.length);if(t.match(/^[#?]+$/))return"0"===(s=jc(r,0))&&(s=""),s.length>t.length?s:qc(t.substr(0,t.length-s.length))+s;if(n=t.match(Wc))return function(e,t,r){var a=parseInt(e[4],10),s=Math.round(t*a),n=Math.floor(s/a),i=s-n*a,o=a;return r+(0===n?"":""+n)+" "+(0===i?Id(" ",e[1].length+1+e[4].length):vc(i,e[1].length)+e[2]+"/"+e[3]+bc(o,e[4].length))}(n,l,c);if(t.match(/^#+0+$/))return c+jc(l,t.length-t.indexOf("0"));if(n=t.match(Hc))return s=$c(r,n[1].length).replace(/^([^\.]+)$/,"$1."+qc(n[1])).replace(/\.$/,"."+qc(n[1])).replace(/\.(\d*)$/,function(e,t){return"."+t+Id("0",qc(n[1]).length-t.length)}),-1!==t.indexOf("0.")?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),n=t.match(/^(0*)\.(#*)$/))return c+$c(l,n[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,n[1].length?"0.":".");if(n=t.match(/^#{1,3},##0(\.?)$/))return c+zc(jc(l,0));if(n=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Yc(e,t,-r):zc(""+(Math.floor(r)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(r,n[1].length)))+"."+bc(Kc(r,n[1].length),n[1].length);if(n=t.match(/^#,#*,#0/))return Yc(e,t.replace(/^#,#*,/,""),r);if(n=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=xc(Yc(e,t.replace(/[\\-]/g,""),r)),i=0,xc(xc(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return i<s.length?s.charAt(i++):"0"===e?"0":""}));if(t.match(Gc))return"("+(s=Yc(e,"##########",r)).substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(n=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(n[4].length,7),o=Cc(l,Math.pow(10,i)-1,!1),s=""+c," "==(d=Qc("n",n[1],o[1])).charAt(d.length-1)&&(d=d.substr(0,d.length-1)+"0"),s+=d+n[2]+"/"+n[3],(d=yc(o[2],i)).length<n[4].length&&(d=qc(n[4].substr(n[4].length-d.length))+d),s+=d;if(n=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(n[1].length,n[4].length),7),c+((o=Cc(l,Math.pow(10,i)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?vc(o[1],i)+n[2]+"/"+n[3]+yc(o[2],i):Id(" ",2*i+1+n[2].length+n[3].length));if(n=t.match(/^[#0?]+$/))return s=jc(r,0),t.length<=s.length?s:qc(t.substr(0,t.length-s.length))+s;if(n=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(n[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var u=t.indexOf(".")-i,h=t.length-s.length-u;return qc(t.substr(0,u)+s+t.substr(t.length-h))}if(n=t.match(/^00,000\.([#0]*0)$/))return i=Kc(r,n[1].length),r<0?"-"+Yc(e,t,-r):zc(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?bc(0,3-e.length):"")+e})+"."+bc(i,n[1].length);switch(t){case"###,##0.00":return Yc(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var f=zc(jc(l,0));return"0"!==f?c+f:"";case"###,###.00":return Yc(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Yc(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Jc(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+Jc(e,-t);var s=e.indexOf(".");-1===s&&(s=e.indexOf("E"));var n=Math.floor(Math.log(t)*Math.LOG10E)%s;if(n<0&&(n+=s),!(r=(t/Math.pow(10,n)).toPrecision(a+1+(s+n)%s)).match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+n):r+="E+"+(i-n),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,r,a){return t+r+a.substr(0,(s+n)%s)+"."+a.substr(n)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Xc(e,t,r){if(40===e.charCodeAt(0)&&!t.match(Vc)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Xc("n",a,r):"("+Xc("n",a,-r)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,r){for(var a=t.length-1;44===t.charCodeAt(a-1);)--a;return Qc(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}(e,t,r);if(-1!==t.indexOf("%"))return function(e,t,r){var a=t.replace(Bc,""),s=t.length-a.length;return Qc(e,a,r*Math.pow(10,2*s))+Id("%",s)}(e,t,r);if(-1!==t.indexOf("E"))return Jc(t,r);if(36===t.charCodeAt(0))return"$"+Xc(e,t.substr(" "==t.charAt(1)?2:1),r);var s,n,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+bc(l,t.length);if(t.match(/^[#?]+$/))return s=""+r,0===r&&(s=""),s.length>t.length?s:qc(t.substr(0,t.length-s.length))+s;if(n=t.match(Wc))return function(e,t,r){return r+(0===t?"":""+t)+Id(" ",e[1].length+2+e[4].length)}(n,l,c);if(t.match(/^#+0+$/))return c+bc(l,t.length-t.indexOf("0"));if(n=t.match(Hc))return s=(s=(""+r).replace(/^([^\.]+)$/,"$1."+qc(n[1])).replace(/\.$/,"."+qc(n[1]))).replace(/\.(\d*)$/,function(e,t){return"."+t+Id("0",qc(n[1]).length-t.length)}),-1!==t.indexOf("0.")?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),n=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,n[1].length?"0.":".");if(n=t.match(/^#{1,3},##0(\.?)$/))return c+zc(""+l);if(n=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Xc(e,t,-r):zc(""+r)+"."+Id("0",n[1].length);if(n=t.match(/^#,#*,#0/))return Xc(e,t.replace(/^#,#*,/,""),r);if(n=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=xc(Xc(e,t.replace(/[\\-]/g,""),r)),i=0,xc(xc(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return i<s.length?s.charAt(i++):"0"===e?"0":""}));if(t.match(Gc))return"("+(s=Xc(e,"##########",r)).substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(n=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(n[4].length,7),o=Cc(l,Math.pow(10,i)-1,!1),s=""+c," "==(d=Qc("n",n[1],o[1])).charAt(d.length-1)&&(d=d.substr(0,d.length-1)+"0"),s+=d+n[2]+"/"+n[3],(d=yc(o[2],i)).length<n[4].length&&(d=qc(n[4].substr(n[4].length-d.length))+d),s+=d;if(n=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(n[1].length,n[4].length),7),c+((o=Cc(l,Math.pow(10,i)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?vc(o[1],i)+n[2]+"/"+n[3]+yc(o[2],i):Id(" ",2*i+1+n[2].length+n[3].length));if(n=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:qc(t.substr(0,t.length-s.length))+s;if(n=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(n[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var u=t.indexOf(".")-i,h=t.length-s.length-u;return qc(t.substr(0,u)+s+t.substr(t.length-h))}if(n=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Xc(e,t,-r):zc(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?bc(0,3-e.length):"")+e})+"."+bc(0,n[1].length);switch(t){case"###,###":case"##,###":case"#,###":var f=zc(""+l);return"0"!==f?c+f:"";default:if(t.match(/\.[0#?]*$/))return Xc(e,t.slice(0,t.lastIndexOf(".")),r)+qc(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Qc(e,t,r){return(0|r)===r?Xc(e,t,r):Yc(e,t,r)}var Zc=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ed(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":Nc(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4e0a":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("\u4e0a\u5348/\u4e0b\u5348"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(a=r;"]"!==e.charAt(t++)&&t<e.length;)a+=e.charAt(t);if(a.match(Zc))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||"\\"==r&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;default:++t}return!1}var td=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function rd(e,t){if(null==t)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0}return!1}function ad(e,t){var r=function(e){for(var t=[],r=!1,a=0,s=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(s,a-s),s=a+1}if(t[t.length]=e.substr(s),!0===r)throw new Error("Format |"+e+"| unterminated string ");return t}(e),a=r.length,s=r[a-1].indexOf("@");if(a<4&&s>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if("number"!==typeof t)return[4,4===r.length||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"]}var n=t>0?r[0]:t<0?r[1]:r[2];if(-1===r[0].indexOf("[")&&-1===r[1].indexOf("["))return[a,n];if(null!=r[0].match(/\[[=<>]/)||null!=r[1].match(/\[[=<>]/)){var i=r[0].match(td),o=r[1].match(td);return rd(t,i)?[a,r[0]]:rd(t,o)?[a,r[1]]:[a,r[null!=i&&null!=o?2:1]]}return[a,n]}function sd(e,t,r){null==r&&(r={});var a="";switch(typeof e){case"string":a="m/d/yy"==e&&r.dateNF?r.dateNF:e;break;case"number":null==(a=14==e&&r.dateNF?r.dateNF:(null!=r.table?r.table:Ec)[e])&&(a=r.table&&r.table[Tc[e]]||Ec[Tc[e]]),null==a&&(a=_c[e]||"General")}if(Nc(a,0))return Fc(t,r);t instanceof Date&&(t=Oc(t,r.date1904));var s=ad(a,t);if(Nc(s[1]))return Fc(t,r);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return function(e,t,r,a){for(var s,n,i,o=[],l="",c=0,d="",u="t",h="H";c<e.length;)switch(d=e.charAt(c)){case"G":if(!Nc(e,c))throw new Error("unrecognized character "+d+" in "+e);o[o.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";34!==(i=e.charCodeAt(++c))&&c<e.length;)l+=String.fromCharCode(i);o[o.length]={t:"t",v:l},++c;break;case"\\":var f=e.charAt(++c),m="("===f||")"===f?f:"t";o[o.length]={t:m,v:f},++c;break;case"_":o[o.length]={t:"t",v:" "},c+=2;break;case"@":o[o.length]={t:"T",v:t},++c;break;case"B":case"b":if("1"===e.charAt(c+1)||"2"===e.charAt(c+1)){if(null==s&&null==(s=Ac(t,r,"2"===e.charAt(c+1))))return"";o[o.length]={t:"X",v:e.substr(c,2)},u=d,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":d=d.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==s&&null==(s=Ac(t,r)))return"";for(l=d;++c<e.length&&e.charAt(c).toLowerCase()===d;)l+=d;"m"===d&&"h"===u.toLowerCase()&&(d="M"),"h"===d&&(d=h),o[o.length]={t:d,v:l},u=d;break;case"A":case"a":case"\u4e0a":var p={t:d,v:d};if(null==s&&(s=Ac(t,r)),"A/P"===e.substr(c,3).toUpperCase()?(null!=s&&(p.v=s.H>=12?"P":"A"),p.t="T",h="h",c+=3):"AM/PM"===e.substr(c,5).toUpperCase()?(null!=s&&(p.v=s.H>=12?"PM":"AM"),p.t="T",c+=5,h="h"):"\u4e0a\u5348/\u4e0b\u5348"===e.substr(c,5).toUpperCase()?(null!=s&&(p.v=s.H>=12?"\u4e0b\u5348":"\u4e0a\u5348"),p.t="T",c+=5,h="h"):(p.t="t",++c),null==s&&"T"===p.t)return"";o[o.length]=p,u=d;break;case"[":for(l=d;"]"!==e.charAt(c++)&&c<e.length;)l+=e.charAt(c);if("]"!==l.slice(-1))throw'unterminated "[" block: |'+l+"|";if(l.match(Zc)){if(null==s&&null==(s=Ac(t,r)))return"";o[o.length]={t:"Z",v:l.toLowerCase()},u=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",ed(e)||(o[o.length]={t:"t",v:l}));break;case".":if(null!=s){for(l=d;++c<e.length&&"0"===(d=e.charAt(c));)l+=d;o[o.length]={t:"s",v:l};break}case"0":case"#":for(l=d;++c<e.length&&"0#?.,E+-%".indexOf(d=e.charAt(c))>-1;)l+=d;o[o.length]={t:"n",v:l};break;case"?":for(l=d;e.charAt(++c)===d;)l+=d;o[o.length]={t:d,v:l},u=d;break;case"*":++c," "!=e.charAt(c)&&"*"!=e.charAt(c)||++c;break;case"(":case")":o[o.length]={t:1===a?"t":d,v:d},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=d;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);o[o.length]={t:"D",v:l};break;case" ":o[o.length]={t:d,v:d},++c;break;case"$":o[o.length]={t:"t",v:"$"},++c;break;default:if(-1===",$-+/():!^&'~{}<>=\u20acacfijklopqrtuvwxzP".indexOf(d))throw new Error("unrecognized character "+d+" in "+e);o[o.length]={t:"t",v:d},++c}var g,x=0,b=0;for(c=o.length-1,u="t";c>=0;--c)switch(o[c].t){case"h":case"H":o[c].t=h,u="h",x<1&&(x=1);break;case"s":(g=o[c].v.match(/\.0+$/))&&(b=Math.max(b,g[0].length-1)),x<3&&(x=3);case"d":case"y":case"M":case"e":u=o[c].t;break;case"m":"s"===u&&(o[c].t="M",x<2&&(x=2));break;case"X":break;case"Z":x<1&&o[c].v.match(/[Hh]/)&&(x=1),x<2&&o[c].v.match(/[Mm]/)&&(x=2),x<3&&o[c].v.match(/[Ss]/)&&(x=3)}switch(x){case 0:break;case 1:s.u>=.5&&(s.u=0,++s.S),s.S>=60&&(s.S=0,++s.M),s.M>=60&&(s.M=0,++s.H);break;case 2:s.u>=.5&&(s.u=0,++s.S),s.S>=60&&(s.S=0,++s.M)}var v,y="";for(c=0;c<o.length;++c)switch(o[c].t){case"t":case"T":case" ":case"D":break;case"X":o[c].v="",o[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[c].v=Lc(o[c].t.charCodeAt(0),o[c].v,s,b),o[c].t="t";break;case"n":case"?":for(v=c+1;null!=o[v]&&("?"===(d=o[v].t)||"D"===d||(" "===d||"t"===d)&&null!=o[v+1]&&("?"===o[v+1].t||"t"===o[v+1].t&&"/"===o[v+1].v)||"("===o[c].t&&(" "===d||"n"===d||")"===d)||"t"===d&&("/"===o[v].v||" "===o[v].v&&null!=o[v+1]&&"?"==o[v+1].t));)o[c].v+=o[v].v,o[v]={v:"",t:";"},++v;y+=o[c].v,c=v-1;break;case"G":o[c].t="t",o[c].v=Fc(t,r)}var w,j,N="";if(y.length>0){40==y.charCodeAt(0)?(w=t<0&&45===y.charCodeAt(0)?-t:t,j=Qc("n",y,w)):(j=Qc("n",y,w=t<0&&a>1?-t:t),w<0&&o[0]&&"t"==o[0].t&&(j=j.substr(1),o[0].v="-"+o[0].v)),v=j.length-1;var k=o.length;for(c=0;c<o.length;++c)if(null!=o[c]&&"t"!=o[c].t&&o[c].v.indexOf(".")>-1){k=c;break}var S=o.length;if(k===o.length&&-1===j.indexOf("E")){for(c=o.length-1;c>=0;--c)null!=o[c]&&-1!=="n?".indexOf(o[c].t)&&(v>=o[c].v.length-1?(v-=o[c].v.length,o[c].v=j.substr(v+1,o[c].v.length)):v<0?o[c].v="":(o[c].v=j.substr(0,v+1),v=-1),o[c].t="t",S=c);v>=0&&S<o.length&&(o[S].v=j.substr(0,v+1)+o[S].v)}else if(k!==o.length&&-1===j.indexOf("E")){for(v=j.indexOf(".")-1,c=k;c>=0;--c)if(null!=o[c]&&-1!=="n?".indexOf(o[c].t)){for(n=o[c].v.indexOf(".")>-1&&c===k?o[c].v.indexOf(".")-1:o[c].v.length-1,N=o[c].v.substr(n+1);n>=0;--n)v>=0&&("0"===o[c].v.charAt(n)||"#"===o[c].v.charAt(n))&&(N=j.charAt(v--)+N);o[c].v=N,o[c].t="t",S=c}for(v>=0&&S<o.length&&(o[S].v=j.substr(0,v+1)+o[S].v),v=j.indexOf(".")+1,c=k;c<o.length;++c)if(null!=o[c]&&(-1!=="n?(".indexOf(o[c].t)||c===k)){for(n=o[c].v.indexOf(".")>-1&&c===k?o[c].v.indexOf(".")+1:0,N=o[c].v.substr(0,n);n<o[c].v.length;++n)v<j.length&&(N+=j.charAt(v++));o[c].v=N,o[c].t="t",S=c}}}for(c=0;c<o.length;++c)null!=o[c]&&"n?".indexOf(o[c].t)>-1&&(w=a>1&&t<0&&c>0&&"-"===o[c-1].v?-t:t,o[c].v=Qc(o[c].t,o[c].v,w),o[c].t="t");var E="";for(c=0;c!==o.length;++c)null!=o[c]&&(E+=o[c].v);return E}(s[1],t,r,s[0])}function nd(e,t){if("number"!=typeof t){t=+t||-1;for(var r=0;r<392;++r)if(void 0!=Ec[r]){if(Ec[r]==e){t=r;break}}else t<0&&(t=r);t<0&&(t=391)}return Ec[t]=e,t}function id(e){for(var t=0;392!=t;++t)void 0!==e[t]&&nd(e[t],t)}function od(){var e;e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "',Ec=e}var ld={format:sd,load:nd,_table:Ec,load_table:id,parse_date_code:Ac,is_date:ed,get_table:function(){return ld._table=Ec}},cd={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},dd=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;var ud=function(){var e={};e.version="1.2.0";var t=function(){for(var e=0,t=new Array(256),r=0;256!=r;++r)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=r)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[r]=e;return"undefined"!==typeof Int32Array?new Int32Array(t):t}();var r=function(e){var t=0,r=0,a=0,s="undefined"!==typeof Int32Array?new Int32Array(4096):new Array(4096);for(a=0;256!=a;++a)s[a]=e[a];for(a=0;256!=a;++a)for(r=e[a],t=256+a;t<4096;t+=256)r=s[t]=r>>>8^e[255&r];var n=[];for(a=1;16!=a;++a)n[a-1]="undefined"!==typeof Int32Array?s.subarray(256*a,256*a+256):s.slice(256*a,256*a+256);return n}(t),a=r[0],s=r[1],n=r[2],i=r[3],o=r[4],l=r[5],c=r[6],d=r[7],u=r[8],h=r[9],f=r[10],m=r[11],p=r[12],g=r[13],x=r[14];return e.table=t,e.bstr=function(e,r){for(var a=-1^r,s=0,n=e.length;s<n;)a=a>>>8^t[255&(a^e.charCodeAt(s++))];return~a},e.buf=function(e,r){for(var b=-1^r,v=e.length-15,y=0;y<v;)b=x[e[y++]^255&b]^g[e[y++]^b>>8&255]^p[e[y++]^b>>16&255]^m[e[y++]^b>>>24]^f[e[y++]]^h[e[y++]]^u[e[y++]]^d[e[y++]]^c[e[y++]]^l[e[y++]]^o[e[y++]]^i[e[y++]]^n[e[y++]]^s[e[y++]]^a[e[y++]]^t[e[y++]];for(v+=15;y<v;)b=b>>>8^t[255&(b^e[y++])];return~b},e.str=function(e,r){for(var a=-1^r,s=0,n=e.length,i=0,o=0;s<n;)(i=e.charCodeAt(s++))<128?a=a>>>8^t[255&(a^i)]:i<2048?a=(a=a>>>8^t[255&(a^(192|i>>6&31))])>>>8^t[255&(a^(128|63&i))]:i>=55296&&i<57344?(i=64+(1023&i),o=1023&e.charCodeAt(s++),a=(a=(a=(a=a>>>8^t[255&(a^(240|i>>8&7))])>>>8^t[255&(a^(128|i>>2&63))])>>>8^t[255&(a^(128|o>>6&15|(3&i)<<4))])>>>8^t[255&(a^(128|63&o))]):a=(a=(a=a>>>8^t[255&(a^(224|i>>12&15))])>>>8^t[255&(a^(128|i>>6&63))])>>>8^t[255&(a^(128|63&i))];return~a},e}(),hd=function(){var e,t={};function r(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:r(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(0,t+1)}function a(e){if("/"==e.charAt(e.length-1))return a(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)}function s(e,t){"string"===typeof t&&(t=new Date(t));var r=t.getHours();r=(r=r<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e.write_shift(2,r);var a=t.getFullYear()-1980;a=(a=a<<4|t.getMonth()+1)<<5|t.getDate(),e.write_shift(2,a)}function n(e){Rh(e,0);for(var t={},r=0;e.l<=e.length-4;){var a=e.read_shift(2),s=e.read_shift(2),n=e.l+s,i={};if(21589===a)1&(r=e.read_shift(1))&&(i.mtime=e.read_shift(4)),s>5&&(2&r&&(i.atime=e.read_shift(4)),4&r&&(i.ctime=e.read_shift(4))),i.mtime&&(i.mt=new Date(1e3*i.mtime));e.l=n,t[a]=i}return t}function i(){return e||(e={})}function o(e,t){if(80==e[0]&&75==e[1])return ae(e,t);if(109==(32|e[0])&&105==(32|e[1]))return function(e,t){if("mime-version:"!=j(e.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var r=t&&t.root||"",a=(ic&&Buffer.isBuffer(e)?e.toString("binary"):j(e)).split("\r\n"),s=0,n="";for(s=0;s<a.length;++s)if(n=a[s],/^Content-Location:/i.test(n)&&(n=n.slice(n.indexOf("file")),r||(r=n.slice(0,n.lastIndexOf("/")+1)),n.slice(0,r.length)!=r))for(;r.length>0&&(r=(r=r.slice(0,r.length-1)).slice(0,r.lastIndexOf("/")+1),n.slice(0,r.length)!=r););var i=(a[1]||"").match(/boundary="(.*?)"/);if(!i)throw new Error("MAD cannot find boundary");var o="--"+(i[1]||""),l=[],c=[],d={FileIndex:l,FullPaths:c};h(d);var u,f=0;for(s=0;s<a.length;++s){var m=a[s];m!==o&&m!==o+"--"||(f++&&ce(d,a.slice(u,s),r),u=s)}return d}(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var r,a,s,n,i,o,f=512,m=[],p=e.slice(0,512);Rh(p,0);var g=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(b,"Header Signature: "),e.l+=16;var t=e.read_shift(2,"u");return[e.read_shift(2,"u"),t]}(p);switch(r=g[0]){case 3:f=512;break;case 4:f=4096;break;case 0:if(0==g[1])return ae(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+r)}512!==f&&Rh(p=e.slice(0,f),28);var v=e.slice(0,f);!function(e,t){var r=9;switch(e.l+=2,r=e.read_shift(2)){case 9:if(3!=t)throw new Error("Sector Shift: Expected 9 saw "+r);break;case 12:if(4!=t)throw new Error("Sector Shift: Expected 12 saw "+r);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+r)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(p,r);var y=p.read_shift(4,"i");if(3===r&&0!==y)throw new Error("# Directory Sectors: Expected 0 saw "+y);p.l+=4,n=p.read_shift(4,"i"),p.l+=4,p.chk("00100000","Mini Stream Cutoff Size: "),i=p.read_shift(4,"i"),a=p.read_shift(4,"i"),o=p.read_shift(4,"i"),s=p.read_shift(4,"i");for(var w=-1,N=0;N<109&&!((w=p.read_shift(4,"i"))<0);++N)m[N]=w;var k=function(e,t){for(var r=Math.ceil(e.length/t)-1,a=[],s=1;s<r;++s)a[s-1]=e.slice(s*t,(s+1)*t);return a[r-1]=e.slice(r*t),a}(e,f);c(o,s,k,f,m);var S=function(e,t,r,a){var s=e.length,n=[],i=[],o=[],l=[],c=a-1,d=0,u=0,h=0,f=0;for(d=0;d<s;++d)if(o=[],(h=d+t)>=s&&(h-=s),!i[h]){l=[];var m=[];for(u=h;u>=0;){m[u]=!0,i[u]=!0,o[o.length]=u,l.push(e[u]);var p=r[Math.floor(4*u/a)];if(a<4+(f=4*u&c))throw new Error("FAT boundary crossed: "+u+" 4 "+a);if(!e[p])break;if(m[u=Th(e[p],f)])break}n[h]={nodes:o,data:rh([l])}}return n}(k,n,m,f);S[n].name="!Directory",a>0&&i!==x&&(S[i].name="!MiniFAT"),S[m[0]].name="!FAT",S.fat_addrs=m,S.ssz=f;var E=[],T=[],_=[];!function(e,t,r,a,s,n,i,o){for(var c,h=0,f=a.length?2:0,m=t[e].data,p=0,g=0;p<m.length;p+=128){var b=m.slice(p,p+128);Rh(b,64),g=b.read_shift(2),c=sh(b,0,g-f),a.push(c);var v={name:c,type:b.read_shift(1),color:b.read_shift(1),L:b.read_shift(4,"i"),R:b.read_shift(4,"i"),C:b.read_shift(4,"i"),clsid:b.read_shift(16),state:b.read_shift(4,"i"),start:0,size:0};0!==b.read_shift(2)+b.read_shift(2)+b.read_shift(2)+b.read_shift(2)&&(v.ct=u(b,b.l-8)),0!==b.read_shift(2)+b.read_shift(2)+b.read_shift(2)+b.read_shift(2)&&(v.mt=u(b,b.l-8)),v.start=b.read_shift(4,"i"),v.size=b.read_shift(4,"i"),v.size<0&&v.start<0&&(v.size=v.type=0,v.start=x,v.name=""),5===v.type?(h=v.start,s>0&&h!==x&&(t[h].name="!StreamData")):v.size>=4096?(v.storage="fat",void 0===t[v.start]&&(t[v.start]=d(r,v.start,t.fat_addrs,t.ssz)),t[v.start].name=v.name,v.content=t[v.start].data.slice(0,v.size)):(v.storage="minifat",v.size<0?v.size=0:h!==x&&v.start!==x&&t[h]&&(v.content=l(v,t[h].data,(t[o]||{}).data))),v.content&&Rh(v.content,0),n[c]=v,i.push(v)}}(n,S,k,E,a,{},T,i),function(e,t,r){for(var a=0,s=0,n=0,i=0,o=0,l=r.length,c=[],d=[];a<l;++a)c[a]=d[a]=a,t[a]=r[a];for(;o<d.length;++o)s=e[a=d[o]].L,n=e[a].R,i=e[a].C,c[a]===a&&(-1!==s&&c[s]!==s&&(c[a]=c[s]),-1!==n&&c[n]!==n&&(c[a]=c[n])),-1!==i&&(c[i]=a),-1!==s&&a!=c[a]&&(c[s]=c[a],d.lastIndexOf(s)<o&&d.push(s)),-1!==n&&a!=c[a]&&(c[n]=c[a],d.lastIndexOf(n)<o&&d.push(n));for(a=1;a<l;++a)c[a]===a&&(-1!==n&&c[n]!==n?c[a]=c[n]:-1!==s&&c[s]!==s&&(c[a]=c[s]));for(a=1;a<l;++a)if(0!==e[a].type){if((o=a)!=c[o])do{o=c[o],t[a]=t[o]+"/"+t[a]}while(0!==o&&-1!==c[o]&&o!=c[o]);c[a]=-1}for(t[0]+="/",a=1;a<l;++a)2!==e[a].type&&(t[a]+="/")}(T,_,E),E.shift();var C={FileIndex:T,FullPaths:_};return t&&t.raw&&(C.raw={header:v,sectors:k}),C}function l(e,t,r){for(var a=e.start,s=e.size,n=[],i=a;r&&s>0&&i>=0;)n.push(t.slice(i*g,i*g+g)),s-=g,i=Th(r,4*i);return 0===n.length?Fh(0):mc(n).slice(0,e.size)}function c(e,t,r,a,s){var n=x;if(e===x){if(0!==t)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var i=r[e],o=(a>>>2)-1;if(!i)return;for(var l=0;l<o&&(n=Th(i,4*l))!==x;++l)s.push(n);c(Th(i,a-4),t-1,r,a,s)}}function d(e,t,r,a,s){var n=[],i=[];s||(s=[]);var o=a-1,l=0,c=0;for(l=t;l>=0;){s[l]=!0,n[n.length]=l,i.push(e[l]);var d=r[Math.floor(4*l/a)];if(a<4+(c=4*l&o))throw new Error("FAT boundary crossed: "+l+" 4 "+a);if(!e[d])break;l=Th(e[d],c)}return{nodes:n,data:rh([i])}}function u(e,t){return new Date(1e3*(Eh(e,t+4)/1e7*Math.pow(2,32)+Eh(e,t)/1e7-11644473600))}function h(e,t){var r=t||{},a=r.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=a+"/",e.FileIndex[0]={name:a,type:5}),r.CLSID&&(e.FileIndex[0].clsid=r.CLSID),function(e){var t="\x01Sh33tJ5";if(hd.find(e,"/"+t))return;var r=Fh(4);r[0]=55,r[1]=r[3]=50,r[2]=54,e.FileIndex.push({name:t,type:2,content:r,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),f(e)}(e)}function f(e,t){h(e);for(var s=!1,n=!1,i=e.FullPaths.length-1;i>=0;--i){var o=e.FileIndex[i];switch(o.type){case 0:n?s=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:n=!0,isNaN(o.R*o.L*o.C)&&(s=!0),o.R>-1&&o.L>-1&&o.R==o.L&&(s=!0);break;default:s=!0}}if(s||t){var l=new Date(1987,1,19),c=0,d=Object.create?Object.create(null):{},u=[];for(i=0;i<e.FullPaths.length;++i)d[e.FullPaths[i]]=!0,0!==e.FileIndex[i].type&&u.push([e.FullPaths[i],e.FileIndex[i]]);for(i=0;i<u.length;++i){var f=r(u[i][0]);(n=d[f])||(u.push([f,{name:a(f).replace("/",""),type:1,clsid:y,ct:l,mt:l,content:null}]),d[f]=!0)}for(u.sort(function(e,t){return function(e,t){for(var r=e.split("/"),a=t.split("/"),s=0,n=0,i=Math.min(r.length,a.length);s<i;++s){if(n=r[s].length-a[s].length)return n;if(r[s]!=a[s])return r[s]<a[s]?-1:1}return r.length-a.length}(e[0],t[0])}),e.FullPaths=[],e.FileIndex=[],i=0;i<u.length;++i)e.FullPaths[i]=u[i][0],e.FileIndex[i]=u[i][1];for(i=0;i<u.length;++i){var m=e.FileIndex[i],p=e.FullPaths[i];if(m.name=a(p).replace("/",""),m.L=m.R=m.C=-(m.color=1),m.size=m.content?m.content.length:0,m.start=0,m.clsid=m.clsid||y,0===i)m.C=u.length>1?1:-1,m.size=0,m.type=5;else if("/"==p.slice(-1)){for(c=i+1;c<u.length&&r(e.FullPaths[c])!=p;++c);for(m.C=c>=u.length?-1:c,c=i+1;c<u.length&&r(e.FullPaths[c])!=r(p);++c);m.R=c>=u.length?-1:c,m.type=1}else r(e.FullPaths[i+1]||"")==r(p)&&(m.R=i+1),m.type=2}}}function m(e,t){var r=t||{};if("mad"==r.fileType)return function(e,t){for(var r=t||{},a=r.boundary||"SheetJS",s=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(a="------="+a).slice(2)+'"',"","",""],n=e.FullPaths[0],i=n,o=e.FileIndex[0],l=1;l<e.FullPaths.length;++l)if(i=e.FullPaths[l].slice(n.length),(o=e.FileIndex[l]).size&&o.content&&"\x01Sh33tJ5"!=i){i=i.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"});for(var c=o.content,d=ic&&Buffer.isBuffer(c)?c.toString("binary"):j(c),u=0,h=Math.min(1024,d.length),f=0,m=0;m<=h;++m)(f=d.charCodeAt(m))>=32&&f<128&&++u;var p=u>=4*h/5;s.push(a),s.push("Content-Location: "+(r.root||"file:///C:/SheetJS/")+i),s.push("Content-Transfer-Encoding: "+(p?"quoted-printable":"base64")),s.push("Content-Type: "+ie(o,i)),s.push(""),s.push(p?le(d):oe(d))}return s.push(a+"--\r\n"),s.join("\r\n")}(e,r);if(f(e),"zip"===r.fileType)return function(e,t){var r=t||{},a=[],n=[],i=Fh(1),o=r.compression?8:0,l=0;0;var c=0,d=0,u=0,h=0,f=e.FullPaths[0],m=f,p=e.FileIndex[0],g=[],x=0;for(c=1;c<e.FullPaths.length;++c)if(m=e.FullPaths[c].slice(f.length),(p=e.FileIndex[c]).size&&p.content&&"\x01Sh33tJ5"!=m){var b=u,v=Fh(m.length);for(d=0;d<m.length;++d)v.write_shift(1,127&m.charCodeAt(d));v=v.slice(0,v.l),g[h]=ud.buf(p.content,0);var y=p.content;8==o&&(y=N(y)),(i=Fh(30)).write_shift(4,67324752),i.write_shift(2,20),i.write_shift(2,l),i.write_shift(2,o),p.mt?s(i,p.mt):i.write_shift(4,0),i.write_shift(-4,8&l?0:g[h]),i.write_shift(4,8&l?0:y.length),i.write_shift(4,8&l?0:p.content.length),i.write_shift(2,v.length),i.write_shift(2,0),u+=i.length,a.push(i),u+=v.length,a.push(v),u+=y.length,a.push(y),8&l&&((i=Fh(12)).write_shift(-4,g[h]),i.write_shift(4,y.length),i.write_shift(4,p.content.length),u+=i.l,a.push(i)),(i=Fh(46)).write_shift(4,33639248),i.write_shift(2,0),i.write_shift(2,20),i.write_shift(2,l),i.write_shift(2,o),i.write_shift(4,0),i.write_shift(-4,g[h]),i.write_shift(4,y.length),i.write_shift(4,p.content.length),i.write_shift(2,v.length),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(4,0),i.write_shift(4,b),x+=i.l,n.push(i),x+=v.length,n.push(v),++h}return i=Fh(22),i.write_shift(4,101010256),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,h),i.write_shift(2,h),i.write_shift(4,x),i.write_shift(4,u),i.write_shift(2,0),mc([mc(a),mc(n),i])}(e,r);var a=function(e){for(var t=0,r=0,a=0;a<e.FileIndex.length;++a){var s=e.FileIndex[a];if(s.content){var n=s.content.length;n>0&&(n<4096?t+=n+63>>6:r+=n+511>>9)}}for(var i=e.FullPaths.length+3>>2,o=t+127>>7,l=(t+7>>3)+r+i+o,c=l+127>>7,d=c<=109?0:Math.ceil((c-109)/127);l+c+d+127>>7>c;)d=++c<=109?0:Math.ceil((c-109)/127);var u=[1,d,c,o,i,r,t,0];return e.FileIndex[0].size=t<<6,u[7]=(e.FileIndex[0].start=u[0]+u[1]+u[2]+u[3]+u[4]+u[5])+(u[6]+7>>3),u}(e),n=Fh(a[7]<<9),i=0,o=0;for(i=0;i<8;++i)n.write_shift(1,v[i]);for(i=0;i<8;++i)n.write_shift(2,0);for(n.write_shift(2,62),n.write_shift(2,3),n.write_shift(2,65534),n.write_shift(2,9),n.write_shift(2,6),i=0;i<3;++i)n.write_shift(2,0);for(n.write_shift(4,0),n.write_shift(4,a[2]),n.write_shift(4,a[0]+a[1]+a[2]+a[3]-1),n.write_shift(4,0),n.write_shift(4,4096),n.write_shift(4,a[3]?a[0]+a[1]+a[2]-1:x),n.write_shift(4,a[3]),n.write_shift(-4,a[1]?a[0]-1:x),n.write_shift(4,a[1]),i=0;i<109;++i)n.write_shift(-4,i<a[2]?a[1]+i:-1);if(a[1])for(o=0;o<a[1];++o){for(;i<236+127*o;++i)n.write_shift(-4,i<a[2]?a[1]+i:-1);n.write_shift(-4,o===a[1]-1?x:o+1)}var l=function(e){for(o+=e;i<o-1;++i)n.write_shift(-4,i+1);e&&(++i,n.write_shift(-4,x))};for(o=i=0,o+=a[1];i<o;++i)n.write_shift(-4,w.DIFSECT);for(o+=a[2];i<o;++i)n.write_shift(-4,w.FATSECT);l(a[3]),l(a[4]);for(var c=0,d=0,u=e.FileIndex[0];c<e.FileIndex.length;++c)(u=e.FileIndex[c]).content&&((d=u.content.length)<4096||(u.start=o,l(d+511>>9)));for(l(a[6]+7>>3);511&n.l;)n.write_shift(-4,w.ENDOFCHAIN);for(o=i=0,c=0;c<e.FileIndex.length;++c)(u=e.FileIndex[c]).content&&(!(d=u.content.length)||d>=4096||(u.start=o,l(d+63>>6)));for(;511&n.l;)n.write_shift(-4,w.ENDOFCHAIN);for(i=0;i<a[4]<<2;++i){var h=e.FullPaths[i];if(h&&0!==h.length){u=e.FileIndex[i],0===i&&(u.start=u.size?u.start-1:x);var m=0===i&&r.root||u.name;if(d=2*(m.length+1),n.write_shift(64,m,"utf16le"),n.write_shift(2,d),n.write_shift(1,u.type),n.write_shift(1,u.color),n.write_shift(-4,u.L),n.write_shift(-4,u.R),n.write_shift(-4,u.C),u.clsid)n.write_shift(16,u.clsid,"hex");else for(c=0;c<4;++c)n.write_shift(4,0);n.write_shift(4,u.state||0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,u.start),n.write_shift(4,u.size),n.write_shift(4,0)}else{for(c=0;c<17;++c)n.write_shift(4,0);for(c=0;c<3;++c)n.write_shift(4,-1);for(c=0;c<12;++c)n.write_shift(4,0)}}for(i=1;i<e.FileIndex.length;++i)if((u=e.FileIndex[i]).size>=4096)if(n.l=u.start+1<<9,ic&&Buffer.isBuffer(u.content))u.content.copy(n,n.l,0,u.size),n.l+=u.size+511&-512;else{for(c=0;c<u.size;++c)n.write_shift(1,u.content[c]);for(;511&c;++c)n.write_shift(1,0)}for(i=1;i<e.FileIndex.length;++i)if((u=e.FileIndex[i]).size>0&&u.size<4096)if(ic&&Buffer.isBuffer(u.content))u.content.copy(n,n.l,0,u.size),n.l+=u.size+63&-64;else{for(c=0;c<u.size;++c)n.write_shift(1,u.content[c]);for(;63&c;++c)n.write_shift(1,0)}if(ic)n.l=n.length;else for(;n.l<n.length;)n.write_shift(1,0);return n}t.version="1.2.1";var p,g=64,x=-2,b="d0cf11e0a1b11ae1",v=[208,207,17,224,161,177,26,225],y="00000000000000000000000000000000",w={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:x,FREESECT:-1,HEADER_SIGNATURE:b,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:y,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function j(e){for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function N(e){return p?p.deflateRawSync(e):K(e)}var k=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],E=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function T(e){var t=139536&(e<<1|e<<11)|558144&(e<<5|e<<15);return 255&(t>>16|t>>8|t)}for(var _="undefined"!==typeof Uint8Array,C=_?new Uint8Array(256):[],A=0;A<256;++A)C[A]=T(A);function D(e,t){var r=C[255&e];return t<=8?r>>>8-t:(r=r<<8|C[e>>8&255],t<=16?r>>>16-t:(r=r<<8|C[e>>16&255])>>>24-t)}function P(e,t){var r=7&t,a=t>>>3;return(e[a]|(r<=6?0:e[a+1]<<8))>>>r&3}function I(e,t){var r=7&t,a=t>>>3;return(e[a]|(r<=5?0:e[a+1]<<8))>>>r&7}function O(e,t){var r=7&t,a=t>>>3;return(e[a]|(r<=3?0:e[a+1]<<8))>>>r&31}function R(e,t){var r=7&t,a=t>>>3;return(e[a]|(r<=1?0:e[a+1]<<8))>>>r&127}function M(e,t,r){var a=7&t,s=t>>>3,n=(1<<r)-1,i=e[s]>>>a;return r<8-a?i&n:(i|=e[s+1]<<8-a,r<16-a?i&n:(i|=e[s+2]<<16-a,r<24-a?i&n:(i|=e[s+3]<<24-a)&n))}function F(e,t,r){var a=7&t,s=t>>>3;return a<=5?e[s]|=(7&r)<<a:(e[s]|=r<<a&255,e[s+1]=(7&r)>>8-a),t+3}function L(e,t,r){return r=(1&r)<<(7&t),e[t>>>3]|=r,t+1}function z(e,t,r){var a=t>>>3;return r<<=7&t,e[a]|=255&r,r>>>=8,e[a+1]=r,t+8}function B(e,t,r){var a=t>>>3;return r<<=7&t,e[a]|=255&r,r>>>=8,e[a+1]=255&r,e[a+2]=r>>>8,t+16}function U(e,t){var r=e.length,a=2*r>t?2*r:t+5,s=0;if(r>=t)return e;if(ic){var n=cc(a);if(e.copy)e.copy(n);else for(;s<e.length;++s)n[s]=e[s];return n}if(_){var i=new Uint8Array(a);if(i.set)i.set(e);else for(;s<r;++s)i[s]=e[s];return i}return e.length=a,e}function W(e){for(var t=new Array(e),r=0;r<e;++r)t[r]=0;return t}function H(e,t,r){var a=1,s=0,n=0,i=0,o=0,l=e.length,c=_?new Uint16Array(32):W(32);for(n=0;n<32;++n)c[n]=0;for(n=l;n<r;++n)e[n]=0;l=e.length;var d=_?new Uint16Array(l):W(l);for(n=0;n<l;++n)c[s=e[n]]++,a<s&&(a=s),d[n]=0;for(c[0]=0,n=1;n<=a;++n)c[n+16]=o=o+c[n-1]<<1;for(n=0;n<l;++n)0!=(o=e[n])&&(d[n]=c[o+16]++);var u=0;for(n=0;n<l;++n)if(0!=(u=e[n]))for(o=D(d[n],a)>>a-u,i=(1<<a+4-u)-1;i>=0;--i)t[o|i<<u]=15&u|n<<4;return a}var V=_?new Uint16Array(512):W(512),G=_?new Uint16Array(32):W(32);if(!_){for(var q=0;q<512;++q)V[q]=0;for(q=0;q<32;++q)G[q]=0}!function(){for(var e=[],t=0;t<32;t++)e.push(5);H(e,G,32);var r=[];for(t=0;t<=143;t++)r.push(8);for(;t<=255;t++)r.push(9);for(;t<=279;t++)r.push(7);for(;t<=287;t++)r.push(8);H(r,V,288)}();var $=function(){for(var e=_?new Uint8Array(32768):[],t=0,r=0;t<E.length-1;++t)for(;r<E[t+1];++r)e[r]=t;for(;r<32768;++r)e[r]=29;var a=_?new Uint8Array(259):[];for(t=0,r=0;t<S.length-1;++t)for(;r<S[t+1];++r)a[r]=t;return function(t,r){return t.length<8?function(e,t){for(var r=0;r<e.length;){var a=Math.min(65535,e.length-r),s=r+a==e.length;for(t.write_shift(1,+s),t.write_shift(2,a),t.write_shift(2,65535&~a);a-- >0;)t[t.l++]=e[r++]}return t.l}(t,r):function(t,r){for(var s=0,n=0,i=_?new Uint16Array(32768):[];n<t.length;){var o=Math.min(65535,t.length-n);if(o<10){for(7&(s=F(r,s,+!(n+o!=t.length)))&&(s+=8-(7&s)),r.l=s/8|0,r.write_shift(2,o),r.write_shift(2,65535&~o);o-- >0;)r[r.l++]=t[n++];s=8*r.l}else{s=F(r,s,+!(n+o!=t.length)+2);for(var l=0;o-- >0;){var c=t[n],d=-1,u=0;if((d=i[l=32767&(l<<5^c)])&&((d|=-32768&n)>n&&(d-=32768),d<n))for(;t[d+u]==t[n+u]&&u<250;)++u;if(u>2){(c=a[u])<=22?s=z(r,s,C[c+1]>>1)-1:(z(r,s,3),z(r,s+=5,C[c-23]>>5),s+=3);var h=c<8?0:c-4>>2;h>0&&(B(r,s,u-S[c]),s+=h),c=e[n-d],s=z(r,s,C[c]>>3),s-=3;var f=c<4?0:c-2>>1;f>0&&(B(r,s,n-d-E[c]),s+=f);for(var m=0;m<u;++m)i[l]=32767&n,l=32767&(l<<5^t[n]),++n;o-=u-1}else c<=143?c+=48:s=L(r,s,1),s=z(r,s,C[c]),i[l]=32767&n,++n}s=z(r,s,0)-1}}return r.l=(s+7)/8|0,r.l}(t,r)}}();function K(e){var t=Fh(50+Math.floor(1.1*e.length)),r=$(e,t);return t.slice(0,r)}var Y=_?new Uint16Array(32768):W(32768),J=_?new Uint16Array(32768):W(32768),X=_?new Uint16Array(128):W(128),Q=1,Z=1;function ee(e,t){var r=O(e,t)+257,a=O(e,t+=5)+1,s=function(e,t){var r=7&t,a=t>>>3;return(e[a]|(r<=4?0:e[a+1]<<8))>>>r&15}(e,t+=5)+4;t+=4;for(var n=0,i=_?new Uint8Array(19):W(19),o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=1,c=_?new Uint8Array(8):W(8),d=_?new Uint8Array(8):W(8),u=i.length,h=0;h<s;++h)i[k[h]]=n=I(e,t),l<n&&(l=n),c[n]++,t+=3;var f=0;for(c[0]=0,h=1;h<=l;++h)d[h]=f=f+c[h-1]<<1;for(h=0;h<u;++h)0!=(f=i[h])&&(o[h]=d[f]++);var m=0;for(h=0;h<u;++h)if(0!=(m=i[h])){f=C[o[h]]>>8-m;for(var p=(1<<7-m)-1;p>=0;--p)X[f|p<<m]=7&m|h<<3}var g=[];for(l=1;g.length<r+a;)switch(t+=7&(f=X[R(e,t)]),f>>>=3){case 16:for(n=3+P(e,t),t+=2,f=g[g.length-1];n-- >0;)g.push(f);break;case 17:for(n=3+I(e,t),t+=3;n-- >0;)g.push(0);break;case 18:for(n=11+R(e,t),t+=7;n-- >0;)g.push(0);break;default:g.push(f),l<f&&(l=f)}var x=g.slice(0,r),b=g.slice(r);for(h=r;h<286;++h)x[h]=0;for(h=a;h<30;++h)b[h]=0;return Q=H(x,Y,286),Z=H(b,J,30),t}function te(e,t){var r=function(e,t){if(3==e[0]&&!(3&e[1]))return[lc(t),2];for(var r=0,a=0,s=cc(t||1<<18),n=0,i=s.length>>>0,o=0,l=0;0==(1&a);)if(a=I(e,r),r+=3,a>>>1!=0)for(a>>1==1?(o=9,l=5):(r=ee(e,r),o=Q,l=Z);;){!t&&i<n+32767&&(i=(s=U(s,n+32767)).length);var c=M(e,r,o),d=a>>>1==1?V[c]:Y[c];if(r+=15&d,0===((d>>>=4)>>>8&255))s[n++]=d;else{if(256==d)break;var u=(d-=257)<8?0:d-4>>2;u>5&&(u=0);var h=n+S[d];u>0&&(h+=M(e,r,u),r+=u),c=M(e,r,l),r+=15&(d=a>>>1==1?G[c]:J[c]);var f=(d>>>=4)<4?0:d-2>>1,m=E[d];for(f>0&&(m+=M(e,r,f),r+=f),!t&&i<h&&(i=(s=U(s,h+100)).length);n<h;)s[n]=s[n-m],++n}}else{7&r&&(r+=8-(7&r));var p=e[r>>>3]|e[(r>>>3)+1]<<8;if(r+=32,p>0)for(!t&&i<n+p&&(i=(s=U(s,n+p)).length);p-- >0;)s[n++]=e[r>>>3],r+=8}return t?[s,r+7>>>3]:[s.slice(0,n),r+7>>>3]}(e.slice(e.l||0),t);return e.l+=r[1],r[0]}function re(e,t){if(!e)throw new Error(t);"undefined"!==typeof console&&console.error(t)}function ae(e,t){var r=e;Rh(r,0);var a={FileIndex:[],FullPaths:[]};h(a,{root:t.root});for(var s=r.length-4;(80!=r[s]||75!=r[s+1]||5!=r[s+2]||6!=r[s+3])&&s>=0;)--s;r.l=s+4,r.l+=4;var i=r.read_shift(2);r.l+=6;var o=r.read_shift(4);for(r.l=o,s=0;s<i;++s){r.l+=20;var l=r.read_shift(4),c=r.read_shift(4),d=r.read_shift(2),u=r.read_shift(2),f=r.read_shift(2);r.l+=8;var m=r.read_shift(4),p=n(r.slice(r.l+d,r.l+d+u));r.l+=d+u+f;var g=r.l;r.l=m+4,se(r,l,c,a,p),r.l=g}return a}function se(e,t,r,a,s){e.l+=2;var i=e.read_shift(2),o=e.read_shift(2),l=function(e){var t=65535&e.read_shift(2),r=65535&e.read_shift(2),a=new Date,s=31&r,n=15&(r>>>=5);r>>>=4,a.setMilliseconds(0),a.setFullYear(r+1980),a.setMonth(n-1),a.setDate(s);var i=31&t,o=63&(t>>>=5);return t>>>=6,a.setHours(t),a.setMinutes(o),a.setSeconds(i<<1),a}(e);if(8257&i)throw new Error("Unsupported ZIP encryption");e.read_shift(4);for(var c=e.read_shift(4),d=e.read_shift(4),u=e.read_shift(2),h=e.read_shift(2),f="",m=0;m<u;++m)f+=String.fromCharCode(e[e.l++]);if(h){var g=n(e.slice(e.l,e.l+h));(g[21589]||{}).mt&&(l=g[21589].mt),((s||{})[21589]||{}).mt&&(l=s[21589].mt)}e.l+=h;var x=e.slice(e.l,e.l+c);switch(o){case 8:x=function(e,t){if(!p)return te(e,t);var r=new(0,p.InflateRaw),a=r._processChunk(e.slice(e.l),r._finishFlushFlag);return e.l+=r.bytesRead,a}(e,d);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+o)}var b=!1;8&i&&(134695760==e.read_shift(4)&&(e.read_shift(4),b=!0),c=e.read_shift(4),d=e.read_shift(4)),c!=t&&re(b,"Bad compressed size: "+t+" != "+c),d!=r&&re(b,"Bad uncompressed size: "+r+" != "+d),de(a,f,x,{unsafe:!0,mt:l})}var ne={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ie(e,t){if(e.ctype)return e.ctype;var r=e.name||"",a=r.match(/\.([^\.]+)$/);return a&&ne[a[1]]||t&&(a=(r=t).match(/[\.\\]([^\.\\])+$/))&&ne[a[1]]?ne[a[1]]:"application/octet-stream"}function oe(e){for(var t=sc(e),r=[],a=0;a<t.length;a+=76)r.push(t.slice(a,a+76));return r.join("\r\n")+"\r\n"}function le(e){var t=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==t.length?"0"+t:t)});"\n"==(t=t.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(t="=0D"+t.slice(1));for(var r=[],a=(t=t.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),s=0;s<a.length;++s){var n=a[s];if(0!=n.length)for(var i=0;i<n.length;){var o=76,l=n.slice(i,i+o);"="==l.charAt(o-1)?o--:"="==l.charAt(o-2)?o-=2:"="==l.charAt(o-3)&&(o-=3),l=n.slice(i,i+o),(i+=o)<n.length&&(l+="="),r.push(l)}else r.push("")}return r.join("\r\n")}function ce(e,t,r){for(var a,s="",n="",i="",o=0;o<10;++o){var l=t[o];if(!l||l.match(/^\s*$/))break;var c=l.match(/^(.*?):\s*([^\s].*)$/);if(c)switch(c[1].toLowerCase()){case"content-location":s=c[2].trim();break;case"content-type":i=c[2].trim();break;case"content-transfer-encoding":n=c[2].trim()}}switch(++o,n.toLowerCase()){case"base64":a=dc(nc(t.slice(o).join("")));break;case"quoted-printable":a=function(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r];r<=e.length&&"="==a.charAt(a.length-1);)a=a.slice(0,a.length-1)+e[++r];t.push(a)}for(var s=0;s<t.length;++s)t[s]=t[s].replace(/[=][0-9A-Fa-f]{2}/g,function(e){return String.fromCharCode(parseInt(e.slice(1),16))});return dc(t.join("\r\n"))}(t.slice(o));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+n)}var d=de(e,s.slice(r.length),a,{unsafe:!0});i&&(d.ctype=i)}function de(e,t,r,s){var n=s&&s.unsafe;n||h(e);var i=!n&&hd.find(e,t);if(!i){var o=e.FullPaths[0];t.slice(0,o.length)==o?o=t:("/"!=o.slice(-1)&&(o+="/"),o=(o+t).replace("//","/")),i={name:a(t),type:2},e.FileIndex.push(i),e.FullPaths.push(o),n||hd.utils.cfb_gc(e)}return i.content=r,i.size=r?r.length:0,s&&(s.CLSID&&(i.clsid=s.CLSID),s.mt&&(i.mt=s.mt),s.ct&&(i.ct=s.ct)),i}return t.find=function(e,t){var r=e.FullPaths.map(function(e){return e.toUpperCase()}),a=r.map(function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]}),s=!1;47===t.charCodeAt(0)?(s=!0,t=r[0].slice(0,-1)+t):s=-1!==t.indexOf("/");var n=t.toUpperCase(),i=!0===s?r.indexOf(n):a.indexOf(n);if(-1!==i)return e.FileIndex[i];var o=!n.match(gc);for(n=n.replace(pc,""),o&&(n=n.replace(gc,"!")),i=0;i<r.length;++i){if((o?r[i].replace(gc,"!"):r[i]).replace(pc,"")==n)return e.FileIndex[i];if((o?a[i].replace(gc,"!"):a[i]).replace(pc,"")==n)return e.FileIndex[i]}return null},t.read=function(t,r){var a=r&&r.type;switch(a||ic&&Buffer.isBuffer(t)&&(a="buffer"),a||"base64"){case"file":return function(t,r){return i(),o(e.readFileSync(t),r)}(t,r);case"base64":return o(dc(nc(t)),r);case"binary":return o(dc(t),r)}return o(t,r)},t.parse=o,t.write=function(t,r){var a=m(t,r);switch(r&&r.type||"buffer"){case"file":return i(),e.writeFileSync(r.filename,a),a;case"binary":return"string"==typeof a?a:j(a);case"base64":return sc("string"==typeof a?a:j(a));case"buffer":if(ic)return Buffer.isBuffer(a)?a:oc(a);case"array":return"string"==typeof a?dc(a):a}return a},t.writeFile=function(t,r,a){i();var s=m(t,a);e.writeFileSync(r,s)},t.utils={cfb_new:function(e){var t={};return h(t,e),t},cfb_add:de,cfb_del:function(e,t){h(e);var r=hd.find(e,t);if(r)for(var a=0;a<e.FileIndex.length;++a)if(e.FileIndex[a]==r)return e.FileIndex.splice(a,1),e.FullPaths.splice(a,1),!0;return!1},cfb_mov:function(e,t,r){h(e);var s=hd.find(e,t);if(s)for(var n=0;n<e.FileIndex.length;++n)if(e.FileIndex[n]==s)return e.FileIndex[n].name=a(r),e.FullPaths[n]=r,!0;return!1},cfb_gc:function(e){f(e,!0)},ReadShift:Ch,CheckField:Oh,prep_blob:Rh,bconcat:mc,use_zlib:function(e){try{var t=new(0,e.InflateRaw);if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");p=e}catch(bN){console.error("cannot use native zlib: "+(bN.message||bN))}},_deflateRaw:K,_inflateRaw:te,consts:w},t}();let fd;function md(e){return"string"===typeof e?uc(e):Array.isArray(e)?function(e){if("undefined"===typeof Uint8Array)throw new Error("Unsupported");return new Uint8Array(e)}(e):e}function pd(e,t,r){if("undefined"!==typeof fd&&fd.writeFileSync)return r?fd.writeFileSync(e,t,r):fd.writeFileSync(e,t);if("undefined"!==typeof Deno){if(r&&"string"==typeof t)switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=uc(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var a="utf8"==r?yu(t):t;if("undefined"!==typeof IE_SaveFile)return IE_SaveFile(a,e);if("undefined"!==typeof Blob){var s=new Blob([md(a)],{type:"application/octet-stream"});if("undefined"!==typeof navigator&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if("undefined"!==typeof saveAs)return saveAs(s,e);if("undefined"!==typeof URL&&"undefined"!==typeof document&&document.createElement&&URL.createObjectURL){var n=URL.createObjectURL(s);if("object"===typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(n)},6e4),chrome.downloads.download({url:n,filename:e,saveAs:!0});var i=document.createElement("a");if(null!=i.download)return i.download=e,i.href=n,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(n)},6e4),n}}if("undefined"!==typeof $&&"undefined"!==typeof File&&"undefined"!==typeof Folder)try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=hc(t)),o.write(t),o.close(),t}catch(bN){if(!bN.message||!bN.message.match(/onstruct/))throw bN}throw new Error("cannot save file "+e)}function gd(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function xd(e,t){for(var r=[],a=gd(e),s=0;s!==a.length;++s)null==r[e[a[s]][t]]&&(r[e[a[s]][t]]=a[s]);return r}function bd(e){for(var t=[],r=gd(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}function vd(e){for(var t=[],r=gd(e),a=0;a!==r.length;++a)t[e[r[a]]]=parseInt(r[a],10);return t}var yd=new Date(1899,11,30,0,0,0);function wd(e,t){var r=e.getTime();return t&&(r-=1263168e5),(r-(yd.getTime()+6e4*(e.getTimezoneOffset()-yd.getTimezoneOffset())))/864e5}var jd=new Date,Nd=yd.getTime()+6e4*(jd.getTimezoneOffset()-yd.getTimezoneOffset()),kd=jd.getTimezoneOffset();function Sd(e){var t=new Date;return t.setTime(24*e*60*60*1e3+Nd),t.getTimezoneOffset()!==kd&&t.setTime(t.getTime()+6e4*(t.getTimezoneOffset()-kd)),t}function Ed(e){var t=0,r=0,a=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var n=1;n!=s.length;++n)if(s[n]){switch(r=1,n>3&&(a=!0),s[n].slice(s[n].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[n].slice(s[n].length-1));case"D":r*=24;case"H":r*=60;case"M":if(!a)throw new Error("Unsupported ISO Duration Field: M");r*=60}t+=r*parseInt(s[n],10)}return t}var Td=new Date("2017-02-19T19:06:09.000Z"),_d=isNaN(Td.getFullYear())?new Date("2/19/17"):Td,Cd=2017==_d.getFullYear();function Ad(e,t){var r=new Date(e);if(Cd)return t>0?r.setTime(r.getTime()+60*r.getTimezoneOffset()*1e3):t<0&&r.setTime(r.getTime()-60*r.getTimezoneOffset()*1e3),r;if(e instanceof Date)return e;if(1917==_d.getFullYear()&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],n=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(n=new Date(n.getTime()-60*n.getTimezoneOffset()*1e3)),n}function Dd(e,t){if(ic&&Buffer.isBuffer(e)){if(t){if(255==e[0]&&254==e[1])return yu(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return yu(Ql(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!==typeof TextDecoder)try{if(t){if(255==e[0]&&254==e[1])return yu(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return yu(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"\u20ac":"\x80","\u201a":"\x82","\u0192":"\x83","\u201e":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02c6":"\x88","\u2030":"\x89","\u0160":"\x8a","\u2039":"\x8b","\u0152":"\x8c","\u017d":"\x8e","\u2018":"\x91","\u2019":"\x92","\u201c":"\x93","\u201d":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02dc":"\x98","\u2122":"\x99","\u0161":"\x9a","\u203a":"\x9b","\u0153":"\x9c","\u017e":"\x9e","\u0178":"\x9f"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[\u20ac\u201a\u0192\u201e\u2026\u2020\u2021\u02c6\u2030\u0160\u2039\u0152\u017d\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u02dc\u2122\u0161\u203a\u0153\u017e\u0178]/g,function(e){return r[e]||e})}catch(bN){}for(var a=[],s=0;s!=e.length;++s)a.push(String.fromCharCode(e[s]));return a.join("")}function Pd(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Pd(e[r]));return t}function Id(e,t){for(var r="";r.length<t;)r+=e;return r}function Od(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return isNaN(t=Number(a))?(a=a.replace(/[(](.*)[)]/,function(e,t){return r=-r,t}),isNaN(t=Number(a))?t:t/r):t/r}var Rd=["january","february","march","april","may","june","july","august","september","october","november","december"];function Md(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),s=t.getMonth(),n=t.getDate();if(isNaN(n))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==Rd.indexOf(i))return r}else if(i.match(/[a-z]/))return r;return a<0||a>8099?r:(s>0||n>1)&&101!=a?t:e.match(/[^-0-9:,\/\\]/)?r:t}var Fd=function(){var e=5=="abacaba".split(/(:?b)/i).length;return function(t,r,a){if(e||"string"==typeof r)return t.split(r);for(var s=t.split(r),n=[s[0]],i=1;i<s.length;++i)n.push(a),n.push(s[i]);return n}}();function Ld(e){return e?e.content&&e.type?Dd(e.content,!0):e.data?ec(e.data):e.asNodeBuffer&&ic?ec(e.asNodeBuffer().toString("binary")):e.asBinary?ec(e.asBinary()):e._data&&e._data.getContent?ec(Dd(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function zd(e){if(!e)return null;if(e.data)return Xl(e.data);if(e.asNodeBuffer&&ic)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return"string"==typeof t?Xl(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Bd(e,t){for(var r=e.FullPaths||gd(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),s=a.replace(/\\/g,"/"),n=0;n<r.length;++n){var i=r[n].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==i||s==i)return e.files?e.files[r[n]]:e.FileIndex[n]}return null}function Ud(e,t){var r=Bd(e,t);if(null==r)throw new Error("Cannot find file "+t+" in zip");return r}function Wd(e,t,r){if(!r)return function(e){return e&&".bin"===e.name.slice(-4)?zd(e):Ld(e)}(Ud(e,t));if(!t)return null;try{return Wd(e,t)}catch(bN){return null}}function Hd(e,t,r){if(!r)return Ld(Ud(e,t));if(!t)return null;try{return Hd(e,t)}catch(bN){return null}}function Vd(e,t,r){if(!r)return zd(Ud(e,t));if(!t)return null;try{return Vd(e,t)}catch(bN){return null}}function Gd(e){for(var t=e.FullPaths||gd(e.files),r=[],a=0;a<t.length;++a)"/"!=t[a].slice(-1)&&r.push(t[a].replace(/^Root Entry[\/]/,""));return r.sort()}function qd(e,t,r){if(e.FullPaths){var a;if("string"==typeof r)return a=ic?oc(r):function(e){for(var t=[],r=0,a=e.length+250,s=lc(e.length+255),n=0;n<e.length;++n){var i=e.charCodeAt(n);if(i<128)s[r++]=i;else if(i<2048)s[r++]=192|i>>6&31,s[r++]=128|63&i;else if(i>=55296&&i<57344){i=64+(1023&i);var o=1023&e.charCodeAt(++n);s[r++]=240|i>>8&7,s[r++]=128|i>>2&63,s[r++]=128|o>>6&15|(3&i)<<4,s[r++]=128|63&o}else s[r++]=224|i>>12&15,s[r++]=128|i>>6&63,s[r++]=128|63&i;r>a&&(t.push(s.slice(0,r)),r=0,s=lc(65535),a=65530)}return t.push(s.slice(0,r)),mc(t)}(r),hd.utils.cfb_add(e,t,a);hd.utils.cfb_add(e,t,r)}else e.file(t,r)}function $d(){return hd.utils.cfb_new()}function Kd(e,t){switch(t.type){case"base64":return hd.read(e,{type:"base64"});case"binary":return hd.read(e,{type:"binary"});case"buffer":case"array":return hd.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Yd(e,t){if("/"==e.charAt(0))return e.slice(1);var r=t.split("/");"/"!=t.slice(-1)&&r.pop();for(var a=e.split("/");0!==a.length;){var s=a.shift();".."===s?r.pop():"."!==s&&r.push(s)}return r.join("/")}var Jd='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',Xd=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Qd=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,Zd=Jd.match(Qd)?Qd:/<[^>]*>/g,eu=/<\w*:/,tu=/<(\/?)\w+:/;function ru(e,t,r){for(var a={},s=0,n=0;s!==e.length&&(32!==(n=e.charCodeAt(s))&&10!==n&&13!==n);++s);if(t||(a[0]=e.slice(0,s)),s===e.length)return a;var i=e.match(Xd),o=0,l="",c=0,d="",u="",h=1;if(i)for(c=0;c!=i.length;++c){for(u=i[c],n=0;n!=u.length&&61!==u.charCodeAt(n);++n);for(d=u.slice(0,n).trim();32==u.charCodeAt(n+1);)++n;for(h=34==(s=u.charCodeAt(n+1))||39==s?1:0,l=u.slice(n+1+h,u.length-h),o=0;o!=d.length&&58!==d.charCodeAt(o);++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),a[d]=l,r||(a[d.toLowerCase()]=l);else{var f=(5===o&&"xmlns"===d.slice(0,5)?"xmlns":"")+d.slice(o+1);if(a[f]&&"ext"==d.slice(o-3,o))continue;a[f]=l,r||(a[f.toLowerCase()]=l)}}return a}function au(e){return e.replace(tu,"<$1")}var su={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},nu=bd(su),iu=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,t=/_x([\da-fA-F]{4})_/gi;return function r(a){var s=a+"",n=s.indexOf("<![CDATA[");if(-1==n)return s.replace(e,function(e,t){return su[e]||String.fromCharCode(parseInt(t,e.indexOf("x")>-1?16:10))||e}).replace(t,function(e,t){return String.fromCharCode(parseInt(t,16))});var i=s.indexOf("]]>");return r(s.slice(0,n))+s.slice(n+9,i)+r(s.slice(i+3))}}(),ou=/[&<>'"]/g,lu=/[\u0000-\u0008\u000b-\u001f]/g;function cu(e){return(e+"").replace(ou,function(e){return nu[e]}).replace(lu,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function du(e){return cu(e).replace(/ /g,"_x0020_")}var uu=/[\u0000-\u001f]/g;function hu(e){return(e+"").replace(ou,function(e){return nu[e]}).replace(/\n/g,"<br/>").replace(uu,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}var fu=function(){var e=/&#(\d+);/g;function t(e,t){return String.fromCharCode(parseInt(t,10))}return function(r){return r.replace(e,t)}}();function mu(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function pu(e){for(var t="",r=0,a=0,s=0,n=0,i=0,o=0;r<e.length;)(a=e.charCodeAt(r++))<128?t+=String.fromCharCode(a):(s=e.charCodeAt(r++),a>191&&a<224?(i=(31&a)<<6,i|=63&s,t+=String.fromCharCode(i)):(n=e.charCodeAt(r++),a<240?t+=String.fromCharCode((15&a)<<12|(63&s)<<6|63&n):(o=((7&a)<<18|(63&s)<<12|(63&n)<<6|63&(i=e.charCodeAt(r++)))-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(1023&o)))));return t}function gu(e){var t,r,a,s=lc(2*e.length),n=1,i=0,o=0;for(r=0;r<e.length;r+=n)n=1,(a=e.charCodeAt(r))<128?t=a:a<224?(t=64*(31&a)+(63&e.charCodeAt(r+1)),n=2):a<240?(t=4096*(15&a)+64*(63&e.charCodeAt(r+1))+(63&e.charCodeAt(r+2)),n=3):(n=4,t=262144*(7&a)+4096*(63&e.charCodeAt(r+1))+64*(63&e.charCodeAt(r+2))+(63&e.charCodeAt(r+3)),o=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==o&&(s[i++]=255&o,s[i++]=o>>>8,o=0),s[i++]=t%256,s[i++]=t>>>8;return s.slice(0,i).toString("ucs2")}function xu(e){return oc(e,"binary").toString("utf8")}var bu="foo bar baz\xe2\x98\x83\xf0\x9f\x8d\xa3",vu=ic&&(xu(bu)==pu(bu)&&xu||gu(bu)==pu(bu)&&gu)||pu,yu=ic?function(e){return oc(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,s=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(63&a)));break;case a>=55296&&a<57344:a-=55296,s=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(63&s)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(63&a)))}return t.join("")},wu=function(){var e={};return function(t,r){var a=t+"|"+(r||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",r||"")}}(),ju=function(){var e=[["nbsp"," "],["middot","\xb7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),a=0;a<e.length;++a)r=r.replace(e[a][0],e[a][1]);return r}}(),Nu=function(){var e={};return function(t){return void 0!==e[t]?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),ku=/<\/?(?:vt:)?variant>/g,Su=/<(?:vt:)([^>]*)>([\s\S]*)</;function Eu(e,t){var r=ru(e),a=e.match(Nu(r.baseType))||[],s=[];if(a.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return s}return a.forEach(function(e){var t=e.replace(ku,"").match(Su);t&&s.push({v:vu(t[2]),t:t[1]})}),s}var Tu=/(^\s|\s$|\n)/;function _u(e,t){return"<"+e+(t.match(Tu)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Cu(e){return gd(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Au(e,t,r){return"<"+e+(null!=r?Cu(r):"")+(null!=t?(t.match(Tu)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Du(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(bN){if(t)throw bN}return""}function Pu(e){if(ic&&Buffer.isBuffer(e))return e.toString("utf8");if("string"===typeof e)return e;if("undefined"!==typeof Uint8Array&&e instanceof Uint8Array)return vu(hc(fc(e)));throw new Error("Bad input format: expected Buffer or string")}var Iu=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,Ou="http://schemas.openxmlformats.org/package/2006/metadata/core-properties",Ru="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",Mu="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",Fu="http://schemas.openxmlformats.org/package/2006/content-types",Lu="http://schemas.openxmlformats.org/package/2006/relationships",zu="http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",Bu="http://purl.org/dc/elements/1.1/",Uu="http://purl.org/dc/terms/",Wu="http://purl.org/dc/dcmitype/",Hu="http://schemas.openxmlformats.org/officeDocument/2006/relationships",Vu="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",Gu="http://www.w3.org/2001/XMLSchema-instance",qu="http://www.w3.org/2001/XMLSchema",$u=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ku="urn:schemas-microsoft-com:office:office",Yu="urn:schemas-microsoft-com:office:excel",Ju="urn:schemas-microsoft-com:office:spreadsheet",Xu="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",Qu="http://macVmlSchemaUri",Zu="urn:schemas-microsoft-com:vml",eh="http://www.w3.org/TR/REC-html40";var th=function(e){for(var t=[],r=0;r<e[0].length;++r)if(e[0][r])for(var a=0,s=e[0][r].length;a<s;a+=10240)t.push.apply(t,e[0][r].slice(a,a+10240));return t},rh=ic?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(e){return Buffer.isBuffer(e)?e:oc(e)})):th(e)}:th,ah=function(e,t,r){for(var a=[],s=t;s<r;s+=2)a.push(String.fromCharCode(kh(e,s)));return a.join("").replace(pc,"")},sh=ic?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(pc,""):ah(e,t,r)}:ah,nh=function(e,t,r){for(var a=[],s=t;s<t+r;++s)a.push(("0"+e[s].toString(16)).slice(-2));return a.join("")},ih=ic?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):nh(e,t,r)}:nh,oh=function(e,t,r){for(var a=[],s=t;s<r;s++)a.push(String.fromCharCode(Nh(e,s)));return a.join("")},lh=ic?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf8",t,r):oh(e,t,r)}:oh,ch=function(e,t){var r=Eh(e,t);return r>0?lh(e,t+4,t+4+r-1):""},dh=ch,uh=function(e,t){var r=Eh(e,t);return r>0?lh(e,t+4,t+4+r-1):""},hh=uh,fh=function(e,t){var r=2*Eh(e,t);return r>0?lh(e,t+4,t+4+r-1):""},mh=fh,ph=function(e,t){var r=Eh(e,t);return r>0?sh(e,t+4,t+4+r):""},gh=ph,xh=function(e,t){var r=Eh(e,t);return r>0?lh(e,t+4,t+4+r):""},bh=xh,vh=function(e,t){return function(e,t){for(var r=1-2*(e[t+7]>>>7),a=((127&e[t+7])<<4)+(e[t+6]>>>4&15),s=15&e[t+6],n=5;n>=0;--n)s=256*s+e[t+n];return 2047==a?0==s?r*(1/0):NaN:(0==a?a=-1022:(a-=1023,s+=Math.pow(2,52)),r*Math.pow(2,a-52)*s)}(e,t)},yh=vh,wh=function(e){return Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array};function jh(){sh=function(e,t,r){return Zl.utils.decode(1200,e.slice(t,r)).replace(pc,"")},lh=function(e,t,r){return Zl.utils.decode(65001,e.slice(t,r))},dh=function(e,t){var r=Eh(e,t);return r>0?Zl.utils.decode(Gl,e.slice(t+4,t+4+r-1)):""},hh=function(e,t){var r=Eh(e,t);return r>0?Zl.utils.decode(Vl,e.slice(t+4,t+4+r-1)):""},mh=function(e,t){var r=2*Eh(e,t);return r>0?Zl.utils.decode(1200,e.slice(t+4,t+4+r-1)):""},gh=function(e,t){var r=Eh(e,t);return r>0?Zl.utils.decode(1200,e.slice(t+4,t+4+r)):""},bh=function(e,t){var r=Eh(e,t);return r>0?Zl.utils.decode(65001,e.slice(t+4,t+4+r)):""}}ic&&(dh=function(e,t){if(!Buffer.isBuffer(e))return ch(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},hh=function(e,t){if(!Buffer.isBuffer(e))return uh(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},mh=function(e,t){if(!Buffer.isBuffer(e))return fh(e,t);var r=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r-1)},gh=function(e,t){if(!Buffer.isBuffer(e))return ph(e,t);var r=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r)},bh=function(e,t){if(!Buffer.isBuffer(e))return xh(e,t);var r=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+r)},yh=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):vh(e,t)},wh=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array}),"undefined"!==typeof Zl&&jh();var Nh=function(e,t){return e[t]},kh=function(e,t){return 256*e[t+1]+e[t]},Sh=function(e,t){var r=256*e[t+1]+e[t];return r<32768?r:-1*(65535-r+1)},Eh=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Th=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},_h=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Ch(e,t){var r,a,s,n,i,o,l="",c=[];switch(t){case"dbcs":if(o=this.l,ic&&Buffer.isBuffer(this))l=this.slice(this.l,this.l+2*e).toString("utf16le");else for(i=0;i<e;++i)l+=String.fromCharCode(kh(this,o)),o+=2;e*=2;break;case"utf8":l=lh(this,this.l,this.l+e);break;case"utf16le":e*=2,l=sh(this,this.l,this.l+e);break;case"wstr":if("undefined"===typeof Zl)return Ch.call(this,e,"dbcs");l=Zl.utils.decode(Vl,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":l=dh(this,this.l),e=4+Eh(this,this.l);break;case"lpstr-cp":l=hh(this,this.l),e=4+Eh(this,this.l);break;case"lpwstr":l=mh(this,this.l),e=4+2*Eh(this,this.l);break;case"lpp4":e=4+Eh(this,this.l),l=gh(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+Eh(this,this.l),l=bh(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,l="";0!==(s=Nh(this,this.l+e++));)c.push(tc(s));l=c.join("");break;case"_wstr":for(e=0,l="";0!==(s=kh(this,this.l+e));)c.push(tc(s)),e+=2;e+=2,l=c.join("");break;case"dbcs-cont":for(l="",o=this.l,i=0;i<e;++i){if(this.lens&&-1!==this.lens.indexOf(o))return s=Nh(this,o),this.l=o+1,n=Ch.call(this,e-i,s?"dbcs-cont":"sbcs-cont"),c.join("")+n;c.push(tc(kh(this,o))),o+=2}l=c.join(""),e*=2;break;case"cpstr":if("undefined"!==typeof Zl){l=Zl.utils.decode(Vl,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(l="",o=this.l,i=0;i!=e;++i){if(this.lens&&-1!==this.lens.indexOf(o))return s=Nh(this,o),this.l=o+1,n=Ch.call(this,e-i,s?"dbcs-cont":"sbcs-cont"),c.join("")+n;c.push(tc(Nh(this,o))),o+=1}l=c.join("");break;default:switch(e){case 1:return r=Nh(this,this.l),this.l++,r;case 2:return r=("i"===t?Sh:kh)(this,this.l),this.l+=2,r;case 4:case-4:return"i"===t||0===(128&this[this.l+3])?(r=(e>0?Th:_h)(this,this.l),this.l+=4,r):(a=Eh(this,this.l),this.l+=4,a);case 8:case-8:if("f"===t)return a=8==e?yh(this,this.l):yh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:l=ih(this,this.l,e)}}return this.l+=e,l}var Ah=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},Dh=function(e,t,r){e[r]=255&t,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},Ph=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255};function Ih(e,t,r){var a=0,s=0;if("dbcs"===r){for(s=0;s!=t.length;++s)Ph(this,t.charCodeAt(s),this.l+2*s);a=2*t.length}else if("sbcs"===r){if("undefined"!==typeof Zl&&874==Gl)for(s=0;s!=t.length;++s){var n=Zl.utils.encode(Gl,t.charAt(s));this[this.l+s]=n[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=255&t.charCodeAt(s);a=t.length}else{if("hex"===r){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}if("utf16le"===r){var i=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var o=t.charCodeAt(s);this[this.l++]=255&o,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}switch(e){case 1:a=1,this[this.l]=255&t;break;case 2:a=2,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t;break;case 3:a=3,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t,t>>>=8,this[this.l+2]=255&t;break;case 4:a=4,Ah(this,t,this.l);break;case 8:if(a=8,"f"===r){!function(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,s=0,n=0,i=a?-t:t;isFinite(i)?0==i?s=n=0:(s=Math.floor(Math.log(i)/Math.LN2),n=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(n)||n<Math.pow(2,52))?s=-1022:(n-=Math.pow(2,52),s+=1023)):(s=2047,n=isNaN(t)?26985:0);for(var o=0;o<=5;++o,n/=256)e[r+o]=255&n;e[r+6]=(15&s)<<4|15&n,e[r+7]=s>>4|a}(this,t,this.l);break}case 16:break;case-4:a=4,Dh(this,t,this.l)}}return this.l+=a,this}function Oh(e,t){var r=ih(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Rh(e,t){e.l=t,e.read_shift=Ch,e.chk=Oh,e.write_shift=Ih}function Mh(e,t){e.l+=t}function Fh(e){var t=lc(e);return Rh(t,0),t}function Lh(e,t,r){if(e){var a,s,n;Rh(e,e.l||0);for(var i=e.length,o=0,l=0;e.l<i;){128&(o=e.read_shift(1))&&(o=(127&o)+((127&e.read_shift(1))<<7));var c=$v[o]||$v[65535];for(n=127&(a=e.read_shift(1)),s=1;s<4&&128&a;++s)n+=(127&(a=e.read_shift(1)))<<7*s;l=e.l+n;var d=c.f&&c.f(e,n,r);if(e.l=l,t(d,c,o))return}}}function zh(){var e=[],t=ic?256:2048,r=function(e){var t=Fh(e);return Rh(t,0),t},a=r(t),s=function(){a&&(a.length>a.l&&((a=a.slice(0,a.l)).l=a.length),a.length>0&&e.push(a),a=null)},n=function(e){return a&&e<a.length-a.l?a:(s(),a=r(Math.max(e+1,t)))};return{next:n,push:function(e){s(),null==(a=e).l&&(a.l=a.length),n(t)},end:function(){return s(),mc(e)},_bufs:e}}function Bh(e,t,r,a){var s,n=+t;if(!isNaN(n)){a||(a=$v[n].p||(r||[]).length||0),s=1+(n>=128?1:0)+1,a>=128&&++s,a>=16384&&++s,a>=2097152&&++s;var i=e.next(s);n<=127?i.write_shift(1,n):(i.write_shift(1,128+(127&n)),i.write_shift(1,n>>7));for(var o=0;4!=o;++o){if(!(a>=128)){i.write_shift(1,a);break}i.write_shift(1,128+(127&a)),a>>=7}a>0&&wh(r)&&e.push(r)}}function Uh(e,t,r){var a=Pd(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function Wh(e,t,r){var a=Pd(e);return a.s=Uh(a.s,t.s,r),a.e=Uh(a.e,t.s,r),a}function Hh(e,t){if(e.cRel&&e.c<0)for(e=Pd(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Pd(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Jh(e);return e.cRel||null==e.cRel||(r=r.replace(/^([A-Z])/,"$$$1")),e.rRel||null==e.rRel||(r=function(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(r)),r}function Vh(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(t.biff>=12?1048575:t.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(t.biff>=12?16383:255)||e.e.cRel?Hh(e.s,t.biff)+":"+Hh(e.e,t.biff):(e.s.rRel?"":"$")+qh(e.s.r)+":"+(e.e.rRel?"":"$")+qh(e.e.r):(e.s.cRel?"":"$")+Kh(e.s.c)+":"+(e.e.cRel?"":"$")+Kh(e.e.c)}function Gh(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function qh(e){return""+(e+1)}function $h(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function Kh(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Yh(e){for(var t=0,r=0,a=0;a<e.length;++a){var s=e.charCodeAt(a);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function Jh(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Xh(e){var t=e.indexOf(":");return-1==t?{s:Yh(e),e:Yh(e)}:{s:Yh(e.slice(0,t)),e:Yh(e.slice(t+1))}}function Qh(e,t){return"undefined"===typeof t||"number"===typeof t?Qh(e.s,e.e):("string"!==typeof e&&(e=Jh(e)),"string"!==typeof t&&(t=Jh(t)),e==t?e:e+":"+t)}function Zh(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,s=0,n=e.length;for(r=0;a<n&&!((s=e.charCodeAt(a)-64)<1||s>26);++a)r=26*r+s;for(t.s.c=--r,r=0;a<n&&!((s=e.charCodeAt(a)-48)<0||s>9);++a)r=10*r+s;if(t.s.r=--r,a===n||10!=s)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=n&&!((s=e.charCodeAt(a)-64)<1||s>26);++a)r=26*r+s;for(t.e.c=--r,r=0;a!=n&&!((s=e.charCodeAt(a)-48)<0||s>9);++a)r=10*r+s;return t.e.r=--r,t}function ef(e,t){var r="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=sd(e.z,r?wd(t):t)}catch(bN){}try{return e.w=sd((e.XF||{}).numFmtId||(r?14:0),r?wd(t):t)}catch(bN){return""+t}}function tf(e,t,r){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),"e"==e.t?Uf[e.v]||e.v:ef(e,void 0==t?e.v:t))}function rf(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function af(e,t,r){var a=r||{},s=e?Array.isArray(e):a.dense;var n=e||(s?[]:{}),i=0,o=0;if(n&&null!=a.origin){if("number"==typeof a.origin)i=a.origin;else{var l="string"==typeof a.origin?Yh(a.origin):a.origin;i=l.r,o=l.c}n["!ref"]||(n["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(n["!ref"]){var d=Zh(n["!ref"]);c.s.c=d.s.c,c.s.r=d.s.r,c.e.c=Math.max(c.e.c,d.e.c),c.e.r=Math.max(c.e.r,d.e.r),-1==i&&(c.e.r=i=d.e.r+1)}for(var u=0;u!=t.length;++u)if(t[u]){if(!Array.isArray(t[u]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[u].length;++h)if("undefined"!==typeof t[u][h]){var f={v:t[u][h]},m=i+u,p=o+h;if(c.s.r>m&&(c.s.r=m),c.s.c>p&&(c.s.c=p),c.e.r<m&&(c.e.r=m),c.e.c<p&&(c.e.c=p),!t[u][h]||"object"!==typeof t[u][h]||Array.isArray(t[u][h])||t[u][h]instanceof Date)if(Array.isArray(f.v)&&(f.f=t[u][h][1],f.v=f.v[0]),null===f.v)if(f.f)f.t="n";else if(a.nullError)f.t="e",f.v=0;else{if(!a.sheetStubs)continue;f.t="z"}else"number"===typeof f.v?f.t="n":"boolean"===typeof f.v?f.t="b":f.v instanceof Date?(f.z=a.dateNF||Ec[14],a.cellDates?(f.t="d",f.w=sd(f.z,wd(f.v))):(f.t="n",f.v=wd(f.v),f.w=sd(f.z,f.v))):f.t="s";else f=t[u][h];if(s)n[m]||(n[m]=[]),n[m][p]&&n[m][p].z&&(f.z=n[m][p].z),n[m][p]=f;else{var g=Jh({c:p,r:m});n[g]&&n[g].z&&(f.z=n[g].z),n[g]=f}}}return c.s.c<1e7&&(n["!ref"]=Qh(c)),n}function sf(e,t){return af(null,e,t)}function nf(e,t){return t||(t=Fh(4)),t.write_shift(4,e),t}function of(e){var t=e.read_shift(4);return 0===t?"":e.read_shift(t,"dbcs")}function lf(e,t){var r=!1;return null==t&&(r=!0,t=Fh(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function cf(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function df(e,t){var r=e.l,a=e.read_shift(1),s=of(e),n=[],i={t:s,h:s};if(0!==(1&a)){for(var o=e.read_shift(4),l=0;l!=o;++l)n.push(cf(e));i.r=n}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}var uf=df;function hf(e,t){var r=!1;return null==t&&(r=!0,t=Fh(23+4*e.t.length)),t.write_shift(1,1),lf(e.t,t),t.write_shift(4,1),function(e,t){t||(t=Fh(4)),t.write_shift(2,e.ich||0),t.write_shift(2,e.ifnt||0)}({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function ff(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function mf(e,t){return null==t&&(t=Fh(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function pf(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function gf(e,t){return null==t&&(t=Fh(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var xf=of,bf=lf;function vf(e){var t=e.read_shift(4);return 0===t||4294967295===t?"":e.read_shift(t,"dbcs")}function yf(e,t){var r=!1;return null==t&&(r=!0,t=Fh(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var wf=of,jf=vf,Nf=yf;function kf(e){var t=e.slice(e.l,e.l+4),r=1&t[0],a=2&t[0];e.l+=4;var s=0===a?yh([0,0,0,0,252&t[0],t[1],t[2],t[3]],0):Th(t,0)>>2;return r?s/100:s}function Sf(e,t){null==t&&(t=Fh(4));var r=0,a=0,s=100*e;if(e==(0|e)&&e>=-(1<<29)&&e<1<<29?a=1:s==(0|s)&&s>=-(1<<29)&&s<1<<29&&(a=1,r=1),!a)throw new Error("unsupported RkNumber "+e);t.write_shift(-4,((r?s:e)<<2)+(r+2))}function Ef(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Tf=Ef,_f=function(e,t){return t||(t=Fh(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t};function Cf(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Af(e,t){return(t||Fh(8)).write_shift(8,e,"f")}function Df(e,t){if(t||(t=Fh(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;null!=e.index?(t.write_shift(1,2),t.write_shift(1,e.index)):null!=e.theme?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),e.rgb&&null==e.theme){var a=e.rgb||"FFFFFF";"number"==typeof a&&(a=("000000"+a.toString(16)).slice(-6)),t.write_shift(1,parseInt(a.slice(0,2),16)),t.write_shift(1,parseInt(a.slice(2,4),16)),t.write_shift(1,parseInt(a.slice(4,6),16)),t.write_shift(1,255)}else t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);return t}function Pf(e,t){var r=e.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[e.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return e.l-=4,e.read_shift(0,1==t?"lpstr":"lpwstr")}var If=80,Of=[If,81],Rf={1:{n:"CodePage",t:2},2:{n:"Category",t:If},3:{n:"PresentationFormat",t:If},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:If},15:{n:"Company",t:If},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:If},27:{n:"ContentStatus",t:If},28:{n:"Language",t:If},29:{n:"Version",t:If},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},Mf={1:{n:"CodePage",t:2},2:{n:"Title",t:If},3:{n:"Subject",t:If},4:{n:"Author",t:If},5:{n:"Keywords",t:If},6:{n:"Comments",t:If},7:{n:"Template",t:If},8:{n:"LastAuthor",t:If},9:{n:"RevNumber",t:If},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:If},19:{n:"DocSecurity",t:3},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},Ff={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Lf=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function zf(e){return e.map(function(e){return[e>>16&255,e>>8&255,255&e]})}var Bf=Pd(zf([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),Uf={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Wf={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Hf={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Vf={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Gf(e,t){var r,a=function(e){for(var t=[],r=gd(e),a=0;a!==r.length;++a)null==t[e[r[a]]]&&(t[e[r[a]]]=[]),t[e[r[a]]].push(r[a]);return t}(Hf),s=[];s[s.length]=Jd,s[s.length]=Au("Types",null,{xmlns:Fu,"xmlns:xsd":qu,"xmlns:xsi":Gu}),s=s.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(e){return Au("Default",null,{Extension:e[0],ContentType:e[1]})}));var n=function(a){e[a]&&e[a].length>0&&(r=e[a][0],s[s.length]=Au("Override",null,{PartName:("/"==r[0]?"":"/")+r,ContentType:Vf[a][t.bookType]||Vf[a].xlsx}))},i=function(r){(e[r]||[]).forEach(function(e){s[s.length]=Au("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:Vf[r][t.bookType]||Vf[r].xlsx})})},o=function(t){(e[t]||[]).forEach(function(e){s[s.length]=Au("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:a[t][0]})})};return n("workbooks"),i("sheets"),i("charts"),o("themes"),["strs","styles"].forEach(n),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),i("metadata"),o("people"),s.length>2&&(s[s.length]="</Types>",s[1]=s[1].replace("/>",">")),s.join("")}var qf={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function $f(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Kf(e,t){var r={"!id":{}};if(!e)return r;"/"!==t.charAt(0)&&(t="/"+t);var a={};return(e.match(Zd)||[]).forEach(function(e){var s=ru(e);if("<Relationship"===s[0]){var n={};n.Type=s.Type,n.Target=s.Target,n.Id=s.Id,s.TargetMode&&(n.TargetMode=s.TargetMode);var i="External"===s.TargetMode?s.Target:Yd(s.Target,t);r[i]=n,a[s.Id]=n}}),r["!id"]=a,r}function Yf(e){var t=[Jd,Au("Relationships",null,{xmlns:Lu})];return gd(e["!id"]).forEach(function(r){t[t.length]=Au("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Jf(e,t,r,a,s,n){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=a,s.Target=r,n?s.TargetMode=n:[qf.HLINK,qf.XPATH,qf.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}function Xf(e,t,r){return['  <rdf:Description rdf:about="'+e+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+'"/>\n',"  </rdf:Description>\n"].join("")}function Qf(e,t){return['  <rdf:Description rdf:about="'+e+'">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+'"/>\n',"  </rdf:Description>\n"].join("")}function Zf(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Hl.version+"</meta:generator></office:meta></office:document-meta>"}var em=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],tm=function(){for(var e=new Array(em.length),t=0;t<em.length;++t){var r=em[t],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e}();function rm(e){var t={};e=vu(e);for(var r=0;r<em.length;++r){var a=em[r],s=e.match(tm[r]);null!=s&&s.length>0&&(t[a[1]]=iu(s[1])),"date"===a[2]&&t[a[1]]&&(t[a[1]]=Ad(t[a[1]]))}return t}function am(e,t,r,a,s){null==s[e]&&null!=t&&""!==t&&(s[e]=t,t=cu(t),a[a.length]=r?Au(e,t,r):_u(e,t))}function sm(e,t){var r=t||{},a=[Jd,Au("cp:coreProperties",null,{"xmlns:cp":Ou,"xmlns:dc":Bu,"xmlns:dcterms":Uu,"xmlns:dcmitype":Wu,"xmlns:xsi":Gu})],s={};if(!e&&!r.Props)return a.join("");e&&(null!=e.CreatedDate&&am("dcterms:created","string"===typeof e.CreatedDate?e.CreatedDate:Du(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,s),null!=e.ModifiedDate&&am("dcterms:modified","string"===typeof e.ModifiedDate?e.ModifiedDate:Du(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,s));for(var n=0;n!=em.length;++n){var i=em[n],o=r.Props&&null!=r.Props[i[1]]?r.Props[i[1]]:e?e[i[1]]:null;!0===o?o="1":!1===o?o="0":"number"==typeof o&&(o=String(o)),null!=o&&am(i[0],o,null,a,s)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var nm=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],im=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function om(e,t,r,a){var s=[];if("string"==typeof e)s=Eu(e,a);else for(var n=0;n<e.length;++n)s=s.concat(e[n].map(function(e){return{v:e}}));var i="string"==typeof t?Eu(t,a).map(function(e){return e.v}):t,o=0,l=0;if(i.length>0)for(var c=0;c!==s.length;c+=2){switch(l=+s[c+1].v,s[c].v){case"Worksheets":case"\u5de5\u4f5c\u8868":case"\u041b\u0438\u0441\u0442\u044b":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30ef\u30fc\u30af\u30b7\u30fc\u30c8":case"\u05d2\u05dc\u05d9\u05d5\u05e0\u05d5\u05ea \u05e2\u05d1\u05d5\u05d3\u05d4":case"Arbeitsbl\xe4tter":case"\xc7al\u0131\u015fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xe1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xe1lculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"\u540d\u524d\u4ed8\u304d\u4e00\u89a7":case"Benannte Bereiche":case"Navngivne omr\xe5der":r.NamedRanges=l,r.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=i.slice(o,o+l)}o+=l}}function lm(e){var t=[],r=Au;return e||(e={}),e.Application="SheetJS",t[t.length]=Jd,t[t.length]=Au("Properties",null,{xmlns:Mu,"xmlns:vt":Vu}),nm.forEach(function(a){if(void 0!==e[a[1]]){var s;switch(a[2]){case"string":s=cu(String(e[a[1]]));break;case"bool":s=e[a[1]]?"true":"false"}void 0!==s&&(t[t.length]=r(a[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(e){return"<vt:lpstr>"+cu(e)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var cm=/<[^>]+>[^<]*/g;function dm(e){var t=[Jd,Au("Properties",null,{xmlns:Ru,"xmlns:vt":Vu})];if(!e)return t.join("");var r=1;return gd(e).forEach(function(a){++r,t[t.length]=Au("property",function(e,t){switch(typeof e){case"string":var r=Au("vt:lpwstr",cu(e));return t&&(r=r.replace(/&quot;/g,"_x0022_")),r;case"number":return Au((0|e)==e?"vt:i4":"vt:r8",cu(String(e)));case"boolean":return Au("vt:bool",e?"true":"false")}if(e instanceof Date)return Au("vt:filetime",Du(e));throw new Error("Unable to serialize "+e)}(e[a],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:cu(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var um,hm={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function fm(e,t,r){um||(um=bd(hm)),e[t=um[t]||t]=r}function mm(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date(1e3*(r/1e7*Math.pow(2,32)+t/1e7-11644473600)).toISOString().replace(/\.000/,"")}function pm(e,t,r){var a=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-a&3;)++e.l;return s}function gm(e,t,r){var a=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(a.length+1&3)&3),a}function xm(e,t,r){return 31===t?gm(e):pm(e,0,r)}function bm(e,t,r){return xm(e,t,!1===r?0:4)}function vm(e){var t=e.l,r=jm(e,81);return 0==e[e.l]&&0==e[e.l+1]&&e.l-t&2&&(e.l+=2),[r,jm(e,3)]}function ym(e,t){for(var r=e.read_shift(4),a={},s=0;s!=r;++s){var n=e.read_shift(4),i=e.read_shift(4);a[n]=e.read_shift(i,1200===t?"utf16le":"utf8").replace(pc,"").replace(gc,"!"),1200===t&&i%2&&(e.l+=2)}return 3&e.l&&(e.l=e.l>>3<<2),a}function wm(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(3&t)>0&&(e.l+=4-(3&t)&3),r}function jm(e,t,r){var a,s=e.read_shift(2),n=r||{};if(e.l+=2,12!==t&&s!==t&&-1===Of.indexOf(t)&&(4126!=(65534&t)||4126!=(65534&s)))throw new Error("Expected type "+t+" saw "+s);switch(12===t?s:t){case 2:return a=e.read_shift(2,"i"),n.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i");case 11:return 0!==e.read_shift(4);case 19:return a=e.read_shift(4);case 30:return pm(e,0,4).replace(pc,"");case 31:return gm(e);case 64:return mm(e);case 65:return wm(e);case 71:return function(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}(e);case 80:return bm(e,s,!n.raw).replace(pc,"");case 81:return function(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return xm(e,t,0)}(e,s).replace(pc,"");case 4108:return function(e){for(var t=e.read_shift(4),r=[],a=0;a<t/2;++a)r.push(vm(e));return r}(e);case 4126:case 4127:return 4127==s?function(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a){var s=e.l;r[a]=e.read_shift(0,"lpwstr").replace(pc,""),e.l-s&2&&(e.l+=2)}return r}(e):function(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a)r[a]=e.read_shift(0,"lpstr-cp").replace(pc,"");return r}(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+s)}}function Nm(e,t){var r=Fh(4),a=Fh(4);switch(r.write_shift(4,80==e?31:e),e){case 3:a.write_shift(-4,t);break;case 5:(a=Fh(8)).write_shift(8,t,"f");break;case 11:a.write_shift(4,t?1:0);break;case 64:a=function(e){var t=("string"==typeof e?new Date(Date.parse(e)):e).getTime()/1e3+11644473600,r=t%Math.pow(2,32),a=(t-r)/Math.pow(2,32);a*=1e7;var s=(r*=1e7)/Math.pow(2,32)|0;s>0&&(r%=Math.pow(2,32),a+=s);var n=Fh(8);return n.write_shift(4,r),n.write_shift(4,a),n}(t);break;case 31:case 80:for((a=Fh(4+2*(t.length+1)+(t.length%2?0:2))).write_shift(4,t.length+1),a.write_shift(0,t,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return mc([r,a])}function km(e,t){var r=e.l,a=e.read_shift(4),s=e.read_shift(4),n=[],i=0,o=0,l=-1,c={};for(i=0;i!=s;++i){var d=e.read_shift(4),u=e.read_shift(4);n[i]=[d,u+r]}n.sort(function(e,t){return e[1]-t[1]});var h={};for(i=0;i!=s;++i){if(e.l!==n[i][1]){var f=!0;if(i>0&&t)switch(t[n[i-1][0]].t){case 2:e.l+2===n[i][1]&&(e.l+=2,f=!1);break;case 80:case 4108:e.l<=n[i][1]&&(e.l=n[i][1],f=!1)}if((!t||0==i)&&e.l<=n[i][1]&&(f=!1,e.l=n[i][1]),f)throw new Error("Read Error: Expected address "+n[i][1]+" at "+e.l+" :"+i)}if(t){var m=t[n[i][0]];if(h[m.n]=jm(e,m.t,{raw:!0}),"version"===m.p&&(h[m.n]=String(h[m.n]>>16)+"."+("0000"+String(65535&h[m.n])).slice(-4)),"CodePage"==m.n)switch(h[m.n]){case 0:h[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Yl(o=h[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[m.n])}}else if(1===n[i][0]){if(o=h.CodePage=jm(e,2),Yl(o),-1!==l){var p=e.l;e.l=n[l][1],c=ym(e,o),e.l=p}}else if(0===n[i][0]){if(0===o){l=i,e.l=n[i+1][1];continue}c=ym(e,o)}else{var g,x=c[n[i][0]];switch(e[e.l]){case 65:e.l+=4,g=wm(e);break;case 30:case 31:e.l+=4,g=bm(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,g=e.read_shift(4,"i");break;case 19:e.l+=4,g=e.read_shift(4);break;case 5:e.l+=4,g=e.read_shift(8,"f");break;case 11:e.l+=4,g=Dm(e,4);break;case 64:e.l+=4,g=Ad(mm(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[x]=g}}return e.l=r+a,h}var Sm=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Em(e){switch(typeof e){case"boolean":return 11;case"number":return(0|e)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64}return-1}function Tm(e,t,r){var a=Fh(8),s=[],n=[],i=8,o=0,l=Fh(8),c=Fh(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),n.push(l),s.push(c),i+=8+l.length,!t){(c=Fh(8)).write_shift(4,0),s.unshift(c);var d=[Fh(4)];for(d[0].write_shift(4,e.length),o=0;o<e.length;++o){var u=e[o][0];for((l=Fh(8+2*(u.length+1)+(u.length%2?0:2))).write_shift(4,o+2),l.write_shift(4,u.length+1),l.write_shift(0,u,"dbcs");l.l!=l.length;)l.write_shift(1,0);d.push(l)}l=mc(d),n.unshift(l),i+=8+l.length}for(o=0;o<e.length;++o)if((!t||t[e[o][0]])&&!(Sm.indexOf(e[o][0])>-1||im.indexOf(e[o][0])>-1)&&null!=e[o][1]){var h=e[o][1],f=0;if(t){var m=r[f=+t[e[o][0]]];if("version"==m.p&&"string"==typeof h){var p=h.split(".");h=(+p[0]<<16)+(+p[1]||0)}l=Nm(m.t,h)}else{var g=Em(h);-1==g&&(g=31,h=String(h)),l=Nm(g,h)}n.push(l),(c=Fh(8)).write_shift(4,t?f:2+o),s.push(c),i+=8+l.length}var x=8*(n.length+1);for(o=0;o<n.length;++o)s[o].write_shift(4,x),x+=n[o].length;return a.write_shift(4,i),a.write_shift(4,n.length),mc([a].concat(s).concat(n))}function _m(e,t,r){var a=e.content;if(!a)return{};Rh(a,0);var s,n,i,o,l=0;a.chk("feff","Byte Order: "),a.read_shift(2);var c=a.read_shift(4),d=a.read_shift(16);if(d!==hd.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(1!==(s=a.read_shift(4))&&2!==s)throw new Error("Unrecognized #Sets: "+s);if(n=a.read_shift(16),o=a.read_shift(4),1===s&&o!==a.l)throw new Error("Length mismatch: "+o+" !== "+a.l);2===s&&(i=a.read_shift(16),l=a.read_shift(4));var u,h=km(a,t),f={SystemIdentifier:c};for(var m in h)f[m]=h[m];if(f.FMTID=n,1===s)return f;if(l-a.l==2&&(a.l+=2),a.l!==l)throw new Error("Length mismatch 2: "+a.l+" !== "+l);try{u=km(a,null)}catch(bN){}for(m in u)f[m]=u[m];return f.FMTID=[n,i],f}function Cm(e,t,r,a,s,n){var i=Fh(s?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,hd.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,s?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,s?68:48);var l=Tm(e,r,a);if(o.push(l),s){var c=Tm(s,null,null);i.write_shift(16,n,"hex"),i.write_shift(4,68+l.length),o.push(c)}return mc(o)}function Am(e,t){return e.read_shift(t),null}function Dm(e,t){return 1===e.read_shift(t)}function Pm(e,t){return t||(t=Fh(2)),t.write_shift(2,+!!e),t}function Im(e){return e.read_shift(2,"u")}function Om(e,t){return t||(t=Fh(2)),t.write_shift(2,e),t}function Rm(e,t){return function(e,t,r){for(var a=[],s=e.l+t;e.l<s;)a.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return a}(e,t,Im)}function Mm(e,t,r){return r||(r=Fh(2)),r.write_shift(1,"e"==t?+e:+!!e),r.write_shift(1,"e"==t?1:0),r}function Fm(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont",n=Vl;(r&&r.biff>=8&&(Vl=1200),r&&8!=r.biff)?12==r.biff&&(s="wstr"):e.read_shift(1)&&(s="dbcs-cont");r.biff>=2&&r.biff<=5&&(s="cpstr");var i=a?e.read_shift(a,s):"";return Vl=n,i}function Lm(e){var t=Vl;Vl=1200;var r,a=e.read_shift(2),s=e.read_shift(1),n=4&s,i=8&s,o=1+(1&s),l=0,c={};i&&(l=e.read_shift(2)),n&&(r=e.read_shift(4));var d=2==o?"dbcs-cont":"sbcs-cont",u=0===a?"":e.read_shift(a,d);return i&&(e.l+=4*l),n&&(e.l+=r),c.t=u,i||(c.raw="<t>"+c.t+"</t>",c.r=c.t),Vl=t,c}function zm(e){var t=e.t||"",r=Fh(3);r.write_shift(2,t.length),r.write_shift(1,1);var a=Fh(2*t.length);return a.write_shift(2*t.length,t,"utf16le"),mc([r,a])}function Bm(e,t,r){if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}return 0===e.read_shift(1)?e.read_shift(t,"sbcs-cont"):e.read_shift(t,"dbcs-cont")}function Um(e,t,r){var a=e.read_shift(r&&2==r.biff?1:2);return 0===a?(e.l++,""):Bm(e,a,r)}function Wm(e,t,r){if(r.biff>5)return Um(e,0,r);var a=e.read_shift(1);return 0===a?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Hm(e,t,r){return r||(r=Fh(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function Vm(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return function(e){var t=e.read_shift(4),r=e.l,a=!1;t>24&&(e.l+=t-24,"795881f43b1d7f48af2c825dc4852763"===e.read_shift(16)&&(a=!0),e.l=r);var s=e.read_shift((a?t-24:t)>>1,"utf16le").replace(pc,"");return a&&(e.l+=24),s}(e);case"0303000000000000c000000000000046":return function(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,57005!=e.read_shift(2))throw new Error("Bad FileMoniker");if(0===e.read_shift(4))return r+a.replace(/\\/g,"/");var s=e.read_shift(4);if(3!=e.read_shift(2))throw new Error("Bad FileMoniker");return r+e.read_shift(s>>1,"utf16le").replace(pc,"")}(e);default:throw new Error("Unsupported Moniker "+r)}}function Gm(e){var t=e.read_shift(4);return t>0?e.read_shift(t,"utf16le").replace(pc,""):""}function qm(e,t){t||(t=Fh(6+2*e.length)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function $m(e){var t=Fh(512),r=0,a=e.Target;"file://"==a.slice(0,7)&&(a=a.slice(7));var s=a.indexOf("#"),n=s>-1?31:23;switch(a.charAt(0)){case"#":n=28;break;case".":n&=-3}t.write_shift(4,2),t.write_shift(4,n);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(28==n)qm(a=a.slice(1),t);else if(2&n){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var o=s>-1?a.slice(0,s):a;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),8&n&&qm(s>-1?a.slice(s+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var l=0;"../"==a.slice(3*l,3*l+3)||"..\\"==a.slice(3*l,3*l+3);)++l;for(t.write_shift(2,l),t.write_shift(4,a.length-3*l+1),r=0;r<a.length-3*l;++r)t.write_shift(1,255&a.charCodeAt(r+3*l));for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Km(e){return[e.read_shift(1),e.read_shift(1),e.read_shift(1),e.read_shift(1)]}function Ym(e,t){var r=Km(e);return r[3]=0,r}function Jm(e){return{r:e.read_shift(2),c:e.read_shift(2),ixfe:e.read_shift(2)}}function Xm(e,t,r,a){return a||(a=Fh(6)),a.write_shift(2,e),a.write_shift(2,t),a.write_shift(2,r||0),a}function Qm(e,t,r){var a=r.biff>8?4:2;return[e.read_shift(a),e.read_shift(a,"i"),e.read_shift(a,"i")]}function Zm(e){return[e.read_shift(2),kf(e)]}function ep(e){var t=e.read_shift(2),r=e.read_shift(2);return{s:{c:e.read_shift(2),r:t},e:{c:e.read_shift(2),r:r}}}function tp(e,t){return t||(t=Fh(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function rp(e){var t=e.read_shift(2),r=e.read_shift(2);return{s:{c:e.read_shift(1),r:t},e:{c:e.read_shift(1),r:r}}}var ap=rp;function sp(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[r,t,a]}function np(e){e.l+=2,e.l+=e.read_shift(2)}var ip={0:np,4:np,5:np,6:np,7:function(e){return e.l+=4,e.cf=e.read_shift(2),{}},8:np,9:np,10:np,11:np,12:np,13:function(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t},14:np,15:np,16:np,17:np,18:np,19:np,20:np,21:sp};function op(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),(t-=2)>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function lp(e,t,r){var a=1536,s=16;switch(r.bookType){case"biff8":case"xla":break;case"biff5":a=1280,s=8;break;case"biff4":a=4,s=6;break;case"biff3":a=3,s=6;break;case"biff2":a=2,s=4;break;default:throw new Error("unsupported BIFF version")}var n=Fh(s);return n.write_shift(2,a),n.write_shift(2,t),s>4&&n.write_shift(2,29282),s>6&&n.write_shift(2,1997),s>8&&(n.write_shift(2,49161),n.write_shift(2,1),n.write_shift(2,1798),n.write_shift(2,0)),n}function cp(e,t){var r=!t||t.biff>=8?2:1,a=Fh(8+r*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),t.biff>=8&&a.write_shift(1,1),a.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=a.slice(0,a.l);return s.l=a.l,s}function dp(e,t,r){var a=0;r&&2==r.biff||(a=e.read_shift(2));var s=e.read_shift(2);return r&&2==r.biff&&(a=1-(s>>15),s&=32767),[{Unsynced:1&a,DyZero:(2&a)>>1,ExAsc:(4&a)>>2,ExDsc:(8&a)>>3},s]}function up(e,t,r,a){var s=r&&5==r.biff;a||(a=Fh(s?3+t.length:5+2*t.length)),a.write_shift(2,e),a.write_shift(s?1:2,t.length),s||a.write_shift(1,1),a.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var n=a.length>a.l?a.slice(0,a.l):a;return null==n.l&&(n.l=n.length),n}var hp=Wm;function fp(e,t,r){var a=e.l+t,s=8!=r.biff&&r.biff?2:4,n=e.read_shift(s),i=e.read_shift(s),o=e.read_shift(2),l=e.read_shift(2);return e.l=a,{s:{r:n,c:o},e:{r:i,c:l}}}function mp(e,t,r,a){var s=r&&5==r.biff;a||(a=Fh(s?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,t<<4));var n=0;return e.numFmtId>0&&s&&(n|=1024),a.write_shift(4,n),a.write_shift(4,0),s||a.write_shift(4,0),a.write_shift(2,0),a}function pp(e,t,r){var a=Jm(e);2!=r.biff&&9!=t||++e.l;var s=function(e){var t=e.read_shift(1);return 1===e.read_shift(1)?t:1===t}(e);return a.val=s,a.t=!0===s||!1===s?"b":"e",a}var gp=function(e,t,r){return 0===t?"":Wm(e,0,r)};function xp(e,t,r){var a,s=e.read_shift(2),n={fBuiltIn:1&s,fWantAdvise:s>>>1&1,fWantPict:s>>>2&1,fOle:s>>>3&1,fOleLink:s>>>4&1,cf:s>>>5&1023,fIcon:s>>>15&1};return 14849===r.sbcch&&(a=function(e,t,r){e.l+=4,t-=4;var a=e.l+t,s=Fm(e,0,r),n=e.read_shift(2);if(n!==(a-=e.l))throw new Error("Malformed AddinUdf: padding = "+a+" != "+n);return e.l+=n,s}(e,t-2,r)),n.body=a||e.read_shift(t-2),"string"===typeof a&&(n.Name=a),n}var bp=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function vp(e,t,r){var a=e.l+t,s=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&2==r.biff?1:2),l=0;(!r||r.biff>=5)&&(5!=r.biff&&(e.l+=2),l=e.read_shift(2),5==r.biff&&(e.l+=2),e.l+=4);var c=Bm(e,i,r);32&s&&(c=bp[c.charCodeAt(0)]);var d=a-e.l;r&&2==r.biff&&--d;var u=a!=e.l&&0!==o&&d>0?function(e,t,r,a){var s,n=e.l+t,i=Ox(e,a,r);n!==e.l&&(s=Ix(e,n-e.l,i,r));return[i,s]}(e,d,r,o):[];return{chKey:n,Name:c,itab:l,rgce:u}}function yp(e,t,r){if(r.biff<8)return function(e,t,r){3==e[e.l+1]&&e[e.l]++;var a=Fm(e,0,r);return 3==a.charCodeAt(0)?a.slice(1):a}(e,0,r);for(var a=[],s=e.l+t,n=e.read_shift(r.biff>8?4:2);0!==n--;)a.push(Qm(e,r.biff,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return a}function wp(e,t,r){var a=ap(e,6);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[a,Bx(e,t,r)]}var jp={8:function(e,t){var r=e.l+t;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:a}}};function Np(e){var t=Fh(24),r=Yh(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(a[s],16));return mc([t,$m(e[1])])}function kp(e){var t=e[1].Tooltip,r=Fh(10+2*(t.length+1));r.write_shift(2,2048);var a=Yh(e[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function Sp(e,t,r){if(!r.cellStyles)return Mh(e,t);var a=r&&r.biff>=12?4:2,s=e.read_shift(a),n=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(a),l=e.read_shift(2);2==a&&(e.l+=2);var c={s:s,e:n,w:i,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}var Ep=Jm,Tp=Rm,_p=Um;var Cp=[2,3,48,49,131,139,140,245],Ap=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=bd({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(t,r){var a=r||{};a.dateNF||(a.dateNF="yyyymmdd");var s=sf(function(t,r){var a=[],s=lc(1);switch(r.type){case"base64":s=dc(nc(t));break;case"binary":s=dc(t);break;case"buffer":case"array":s=t}Rh(s,0);var n=s.read_shift(1),i=!!(136&n),o=!1,l=!1;switch(n){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:o=!0,i=!0;break;case 140:l=!0;break;default:throw new Error("DBF Unsupported Version: "+n.toString(16))}var c=0,d=521;2==n&&(c=s.read_shift(2)),s.l+=3,2!=n&&(c=s.read_shift(4)),c>1048576&&(c=1e6),2!=n&&(d=s.read_shift(2));var u=s.read_shift(2),h=r.codepage||1252;2!=n&&(s.l+=16,s.read_shift(1),0!==s[s.l]&&(h=e[s[s.l]]),s.l+=1,s.l+=2),l&&(s.l+=36);for(var f=[],m={},p=Math.min(s.length,2==n?521:d-10-(o?264:0)),g=l?32:11;s.l<p&&13!=s[s.l];)switch((m={}).name=Zl.utils.decode(h,s.slice(s.l,s.l+g)).replace(/[\u0000\r\n].*$/g,""),s.l+=g,m.type=String.fromCharCode(s.read_shift(1)),2==n||l||(m.offset=s.read_shift(4)),m.len=s.read_shift(1),2==n&&(m.offset=s.read_shift(2)),m.dec=s.read_shift(1),m.name.length&&f.push(m),2!=n&&(s.l+=l?13:14),m.type){case"B":o&&8==m.len||!r.WTF||console.log("Skipping "+m.name+":"+m.type);break;case"G":case"P":r.WTF&&console.log("Skipping "+m.name+":"+m.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+m.type)}if(13!==s[s.l]&&(s.l=d-1),13!==s.read_shift(1))throw new Error("DBF Terminator not found "+s.l+" "+s[s.l]);s.l=d;var x=0,b=0;for(a[0]=[],b=0;b!=f.length;++b)a[0][b]=f[b].name;for(;c-- >0;)if(42!==s[s.l])for(++s.l,a[++x]=[],b=0,b=0;b!=f.length;++b){var v=s.slice(s.l,s.l+f[b].len);s.l+=f[b].len,Rh(v,0);var y=Zl.utils.decode(h,v);switch(f[b].type){case"C":y.trim().length&&(a[x][b]=y.replace(/\s+$/,""));break;case"D":8===y.length?a[x][b]=new Date(+y.slice(0,4),+y.slice(4,6)-1,+y.slice(6,8)):a[x][b]=y;break;case"F":a[x][b]=parseFloat(y.trim());break;case"+":case"I":a[x][b]=l?2147483648^v.read_shift(-4,"i"):v.read_shift(4,"i");break;case"L":switch(y.trim().toUpperCase()){case"Y":case"T":a[x][b]=!0;break;case"N":case"F":a[x][b]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+y+"|")}break;case"M":if(!i)throw new Error("DBF Unexpected MEMO for type "+n.toString(16));a[x][b]="##MEMO##"+(l?parseInt(y.trim(),10):v.read_shift(4));break;case"N":(y=y.replace(/\u0000/g,"").trim())&&"."!=y&&(a[x][b]=+y||0);break;case"@":a[x][b]=new Date(v.read_shift(-8,"f")-621356832e5);break;case"T":a[x][b]=new Date(864e5*(v.read_shift(4)-2440588)+v.read_shift(4));break;case"Y":a[x][b]=v.read_shift(4,"i")/1e4+v.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":a[x][b]=-v.read_shift(-8,"f");break;case"B":if(o&&8==f[b].len){a[x][b]=v.read_shift(8,"f");break}case"G":case"P":v.l+=f[b].len;break;case"0":if("_NullFlags"===f[b].name)break;default:throw new Error("DBF Unsupported data type "+f[b].type)}}else s.l+=u;if(2!=n&&s.l<s.length&&26!=s[s.l++])throw new Error("DBF EOF Marker missing "+(s.l-1)+" of "+s.length+" "+s[s.l-1].toString(16));return r&&r.sheetRows&&(a=a.slice(0,r.sheetRows)),r.DBF=f,a}(t,a),a);return s["!cols"]=a.DBF.map(function(e){return{wch:e.len,DBF:e}}),delete a.DBF,s}var a={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(e,t){try{return rf(r(e,t),t)}catch(bN){if(t&&t.WTF)throw bN}return{SheetNames:[],Sheets:{}}},to_sheet:r,from_sheet:function(e,r){var s=r||{};if(+s.codepage>=0&&Yl(+s.codepage),"string"==s.type)throw new Error("Cannot write DBF to JS string");var n=zh(),i=gw(e,{header:1,raw:!0,cellDates:!0}),o=i[0],l=i.slice(1),c=e["!cols"]||[],d=0,u=0,h=0,f=1;for(d=0;d<o.length;++d)if(((c[d]||{}).DBF||{}).name)o[d]=c[d].DBF.name,++h;else if(null!=o[d]){if(++h,"number"===typeof o[d]&&(o[d]=o[d].toString(10)),"string"!==typeof o[d])throw new Error("DBF Invalid column name "+o[d]+" |"+typeof o[d]+"|");if(o.indexOf(o[d])!==d)for(u=0;u<1024;++u)if(-1==o.indexOf(o[d]+"_"+u)){o[d]+="_"+u;break}}var m=Zh(e["!ref"]),p=[],g=[],x=[];for(d=0;d<=m.e.c-m.s.c;++d){var b="",v="",y=0,w=[];for(u=0;u<l.length;++u)null!=l[u][d]&&w.push(l[u][d]);if(0!=w.length&&null!=o[d]){for(u=0;u<w.length;++u){switch(typeof w[u]){case"number":v="B";break;case"string":default:v="C";break;case"boolean":v="L";break;case"object":v=w[u]instanceof Date?"D":"C"}y=Math.max(y,String(w[u]).length),b=b&&b!=v?"C":v}y>250&&(y=250),"C"==(v=((c[d]||{}).DBF||{}).type)&&c[d].DBF.len>y&&(y=c[d].DBF.len),"B"==b&&"N"==v&&(b="N",x[d]=c[d].DBF.dec,y=c[d].DBF.len),g[d]="C"==b||"N"==v?y:a[b]||0,f+=g[d],p[d]=b}else p[d]="?"}var j=n.next(32);for(j.write_shift(4,318902576),j.write_shift(4,l.length),j.write_shift(2,296+32*h),j.write_shift(2,f),d=0;d<4;++d)j.write_shift(4,0);for(j.write_shift(4,(+t[Gl]||3)<<8),d=0,u=0;d<o.length;++d)if(null!=o[d]){var N=n.next(32),k=(o[d].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);N.write_shift(1,k,"sbcs"),N.write_shift(1,"?"==p[d]?"C":p[d],"sbcs"),N.write_shift(4,u),N.write_shift(1,g[d]||a[p[d]]||0),N.write_shift(1,x[d]||0),N.write_shift(1,2),N.write_shift(4,0),N.write_shift(1,0),N.write_shift(4,0),N.write_shift(4,0),u+=g[d]||a[p[d]]||0}var S=n.next(264);for(S.write_shift(4,13),d=0;d<65;++d)S.write_shift(4,0);for(d=0;d<l.length;++d){var E=n.next(f);for(E.write_shift(1,0),u=0;u<o.length;++u)if(null!=o[u])switch(p[u]){case"L":E.write_shift(1,null==l[d][u]?63:l[d][u]?84:70);break;case"B":E.write_shift(8,l[d][u]||0,"f");break;case"N":var T="0";for("number"==typeof l[d][u]&&(T=l[d][u].toFixed(x[u]||0)),h=0;h<g[u]-T.length;++h)E.write_shift(1,32);E.write_shift(1,T,"sbcs");break;case"D":l[d][u]?(E.write_shift(4,("0000"+l[d][u].getFullYear()).slice(-4),"sbcs"),E.write_shift(2,("00"+(l[d][u].getMonth()+1)).slice(-2),"sbcs"),E.write_shift(2,("00"+l[d][u].getDate()).slice(-2),"sbcs")):E.write_shift(8,"00000000","sbcs");break;case"C":var _=String(null!=l[d][u]?l[d][u]:"").slice(0,g[u]);for(E.write_shift(1,_,"sbcs"),h=0;h<g[u]-_.length;++h)E.write_shift(1,32)}}return n.next(1).write_shift(1,26),n.end()}}}(),Dp=function(){var e={AA:"\xc0",BA:"\xc1",CA:"\xc2",DA:195,HA:"\xc4",JA:197,AE:"\xc8",BE:"\xc9",CE:"\xca",HE:"\xcb",AI:"\xcc",BI:"\xcd",CI:"\xce",HI:"\xcf",AO:"\xd2",BO:"\xd3",CO:"\xd4",DO:213,HO:"\xd6",AU:"\xd9",BU:"\xda",CU:"\xdb",HU:"\xdc",Aa:"\xe0",Ba:"\xe1",Ca:"\xe2",Da:227,Ha:"\xe4",Ja:229,Ae:"\xe8",Be:"\xe9",Ce:"\xea",He:"\xeb",Ai:"\xec",Bi:"\xed",Ci:"\xee",Hi:"\xef",Ao:"\xf2",Bo:"\xf3",Co:"\xf4",Do:245,Ho:"\xf6",Au:"\xf9",Bu:"\xfa",Cu:"\xfb",Hu:"\xfc",KC:"\xc7",Kc:"\xe7",q:"\xe6",z:"\u0153",a:"\xc6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1bN("+gd(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(t,r){var a=e[r];return"number"==typeof a?rc(a):a},a=function(e,t,r){var a=t.charCodeAt(0)-32<<4|r.charCodeAt(0)-48;return 59==a?e:rc(a)};function s(e,s){var n,i=e.split(/[\n\r]+/),o=-1,l=-1,c=0,d=0,u=[],h=[],f=null,m={},p=[],g=[],x=[],b=0;for(+s.codepage>=0&&Yl(+s.codepage);c!==i.length;++c){b=0;var v,y=i[c].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),w=y.replace(/;;/g,"\0").split(";").map(function(e){return e.replace(/\u0000/g,";")}),j=w[0];if(y.length>0)switch(j){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==w[1].charAt(0)&&h.push(y.slice(3).replace(/;;/g,";"));break;case"C":var N=!1,k=!1,S=!1,E=!1,T=-1,_=-1;for(d=1;d<w.length;++d)switch(w[d].charAt(0)){case"A":case"G":break;case"X":l=parseInt(w[d].slice(1))-1,k=!0;break;case"Y":for(o=parseInt(w[d].slice(1))-1,k||(l=0),n=u.length;n<=o;++n)u[n]=[];break;case"K":'"'===(v=w[d].slice(1)).charAt(0)?v=v.slice(1,v.length-1):"TRUE"===v?v=!0:"FALSE"===v?v=!1:isNaN(Od(v))?isNaN(Md(v).getDate())||(v=Ad(v)):(v=Od(v),null!==f&&ed(f)&&(v=Sd(v))),"undefined"!==typeof Zl&&"string"==typeof v&&"string"!=(s||{}).type&&(s||{}).codepage&&(v=Zl.utils.decode(s.codepage,v)),N=!0;break;case"E":E=!0;var C=lx(w[d].slice(1),{r:o,c:l});u[o][l]=[u[o][l],C];break;case"S":S=!0,u[o][l]=[u[o][l],"S5S"];break;case"R":T=parseInt(w[d].slice(1))-1;break;case"C":_=parseInt(w[d].slice(1))-1;break;default:if(s&&s.WTF)throw new Error("SYLK bad record "+y)}if(N&&(u[o][l]&&2==u[o][l].length?u[o][l][0]=v:u[o][l]=v,f=null),S){if(E)throw new Error("SYLK shared formula cannot have own formula");var A=T>-1&&u[T][_];if(!A||!A[1])throw new Error("SYLK shared formula cannot find base");u[o][l][1]=ux(A[1],{r:o-T,c:l-_})}break;case"F":var D=0;for(d=1;d<w.length;++d)switch(w[d].charAt(0)){case"X":l=parseInt(w[d].slice(1))-1,++D;break;case"Y":for(o=parseInt(w[d].slice(1))-1,n=u.length;n<=o;++n)u[n]=[];break;case"M":b=parseInt(w[d].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":f=h[parseInt(w[d].slice(1))];break;case"W":for(x=w[d].slice(1).split(" "),n=parseInt(x[0],10);n<=parseInt(x[1],10);++n)b=parseInt(x[2],10),g[n-1]=0===b?{hidden:!0}:{wch:b},xg(g[n-1]);break;case"C":g[l=parseInt(w[d].slice(1))-1]||(g[l]={});break;case"R":p[o=parseInt(w[d].slice(1))-1]||(p[o]={}),b>0?(p[o].hpt=b,p[o].hpx=yg(b)):0===b&&(p[o].hidden=!0);break;default:if(s&&s.WTF)throw new Error("SYLK bad record "+y)}D<1&&(f=null);break;default:if(s&&s.WTF)throw new Error("SYLK bad record "+y)}}return p.length>0&&(m["!rows"]=p),g.length>0&&(m["!cols"]=g),s&&s.sheetRows&&(u=u.slice(0,s.sheetRows)),[u,m]}function n(e,t){var r=function(e,t){switch(t.type){case"base64":return s(nc(e),t);case"binary":return s(e,t);case"buffer":return s(ic&&Buffer.isBuffer(e)?e.toString("binary"):hc(e),t);case"array":return s(Dd(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),a=r[0],n=r[1],i=sf(a,t);return gd(n).forEach(function(e){i[e]=n[e]}),i}function i(e,t,r,a){var s="C;Y"+(r+1)+";X"+(a+1)+";K";switch(e.t){case"n":s+=e.v||0,e.f&&!e.F&&(s+=";E"+dx(e.f,{r:r,c:a}));break;case"b":s+=e.v?"TRUE":"FALSE";break;case"e":s+=e.w||e.v;break;case"d":s+='"'+(e.w||e.v)+'"';break;case"s":s+='"'+e.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return s}return e["|"]=254,{to_workbook:function(e,t){return rf(n(e,t),t)},to_sheet:n,from_sheet:function(e,t){var r,a,s=["ID;PWXL;N;E"],n=[],o=Zh(e["!ref"]),l=Array.isArray(e),c="\r\n";s.push("P;PGeneral"),s.push("F;P0;DG0G8;M255"),e["!cols"]&&(a=s,e["!cols"].forEach(function(e,t){var r="F;W"+(t+1)+" "+(t+1)+" ";e.hidden?r+="0":("number"!=typeof e.width||e.wpx||(e.wpx=hg(e.width)),"number"!=typeof e.wpx||e.wch||(e.wch=fg(e.wpx)),"number"==typeof e.wch&&(r+=Math.round(e.wch)))," "!=r.charAt(r.length-1)&&a.push(r)})),e["!rows"]&&function(e,t){t.forEach(function(t,r){var a="F;";t.hidden?a+="M0;":t.hpt?a+="M"+20*t.hpt+";":t.hpx&&(a+="M"+20*vg(t.hpx)+";"),a.length>2&&e.push(a+"R"+(r+1))})}(s,e["!rows"]),s.push("B;Y"+(o.e.r-o.s.r+1)+";X"+(o.e.c-o.s.c+1)+";D"+[o.s.c,o.s.r,o.e.c,o.e.r].join(" "));for(var d=o.s.r;d<=o.e.r;++d)for(var u=o.s.c;u<=o.e.c;++u){var h=Jh({r:d,c:u});(r=l?(e[d]||[])[u]:e[h])&&(null!=r.v||r.f&&!r.F)&&n.push(i(r,0,d,u))}return s.join(c)+c+n.join(c)+c+"E"+c}}}(),Pp=function(){function e(e,t){for(var r=e.split("\n"),a=-1,s=-1,n=0,i=[];n!==r.length;++n)if("BOT"!==r[n].trim()){if(!(a<0)){for(var o=r[n].trim().split(","),l=o[0],c=o[1],d=r[++n]||"";1&(d.match(/["]/g)||[]).length&&n<r.length-1;)d+="\n"+r[++n];switch(d=d.trim(),+l){case-1:if("BOT"===d){i[++a]=[],s=0;continue}if("EOD"!==d)throw new Error("Unrecognized DIF special command "+d);break;case 0:"TRUE"===d?i[a][s]=!0:"FALSE"===d?i[a][s]=!1:isNaN(Od(c))?isNaN(Md(c).getDate())?i[a][s]=c:i[a][s]=Ad(c):i[a][s]=Od(c),++s;break;case 1:(d=(d=d.slice(1,d.length-1)).replace(/""/g,'"'))&&d.match(/^=".*"$/)&&(d=d.slice(2,-1)),i[a][s++]=""!==d?d:null}if("EOD"===d)break}}else i[++a]=[],s=0;return t&&t.sheetRows&&(i=i.slice(0,t.sheetRows)),i}function t(t,r){return sf(function(t,r){switch(r.type){case"base64":return e(nc(t),r);case"binary":return e(t,r);case"buffer":return e(ic&&Buffer.isBuffer(t)?t.toString("binary"):hc(t),r);case"array":return e(Dd(t),r)}throw new Error("Unrecognized type "+r.type)}(t,r),r)}return{to_workbook:function(e,r){return rf(t(e,r),r)},to_sheet:t,from_sheet:function(){var e=function(e,t,r,a,s){e.push(t),e.push(r+","+a),e.push('"'+s.replace(/"/g,'""')+'"')},t=function(e,t,r,a){e.push(t+","+r),e.push(1==t?'"'+a.replace(/"/g,'""')+'"':a)};return function(r){var a,s=[],n=Zh(r["!ref"]),i=Array.isArray(r);e(s,"TABLE",0,1,"sheetjs"),e(s,"VECTORS",0,n.e.r-n.s.r+1,""),e(s,"TUPLES",0,n.e.c-n.s.c+1,""),e(s,"DATA",0,0,"");for(var o=n.s.r;o<=n.e.r;++o){t(s,-1,0,"BOT");for(var l=n.s.c;l<=n.e.c;++l){var c=Jh({r:o,c:l});if(a=i?(r[o]||[])[l]:r[c])switch(a.t){case"n":var d=a.w;d||null==a.v||(d=a.v),null==d?a.f&&!a.F?t(s,1,0,"="+a.f):t(s,1,0,""):t(s,0,d,"V");break;case"b":t(s,0,a.v?1:0,a.v?"TRUE":"FALSE");break;case"s":t(s,1,0,isNaN(a.v)?a.v:'="'+a.v+'"');break;case"d":a.w||(a.w=sd(a.z||Ec[14],wd(Ad(a.v)))),t(s,0,a.w,"V");break;default:t(s,1,0,"")}else t(s,1,0,"")}}t(s,-1,0,"EOD");return s.join("\r\n")}}()}}(),Ip=function(){function e(e){return e.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n")}function t(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(t,r){return sf(function(t,r){for(var a=t.split("\n"),s=-1,n=-1,i=0,o=[];i!==a.length;++i){var l=a[i].trim().split(":");if("cell"===l[0]){var c=Yh(l[1]);if(o.length<=c.r)for(s=o.length;s<=c.r;++s)o[s]||(o[s]=[]);switch(s=c.r,n=c.c,l[2]){case"t":o[s][n]=e(l[3]);break;case"v":o[s][n]=+l[3];break;case"vtf":var d=l[l.length-1];case"vtc":"nl"===l[3]?o[s][n]=!!+l[4]:o[s][n]=+l[4],"vtf"==l[2]&&(o[s][n]=[o[s][n],d])}}}return r&&r.sheetRows&&(o=o.slice(0,r.sheetRows)),o}(t,r),r)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",n=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),i="--SocialCalcSpreadsheetControlSave--";function o(e){if(!e||!e["!ref"])return"";for(var r,a=[],s=[],n="",i=Xh(e["!ref"]),o=Array.isArray(e),l=i.s.r;l<=i.e.r;++l)for(var c=i.s.c;c<=i.e.c;++c)if(n=Jh({r:l,c:c}),(r=o?(e[l]||[])[c]:e[n])&&null!=r.v&&"z"!==r.t){switch(s=["cell",n,"t"],r.t){case"s":case"str":s.push(t(r.v));break;case"n":r.f?(s[2]="vtf",s[3]="n",s[4]=r.v,s[5]=t(r.f)):(s[2]="v",s[3]=r.v);break;case"b":s[2]="vt"+(r.f?"f":"c"),s[3]="nl",s[4]=r.v?"1":"0",s[5]=t(r.f||(r.v?"TRUE":"FALSE"));break;case"d":var d=wd(Ad(r.v));s[2]="vtc",s[3]="nd",s[4]=""+d,s[5]=r.w||sd(r.z||Ec[14],d);break;case"e":continue}a.push(s.join(":"))}return a.push("sheet:c:"+(i.e.c-i.s.c+1)+":r:"+(i.e.r-i.s.r+1)+":tvf:1"),a.push("valueformat:1:text-wiki"),a.join("\n")}return{to_workbook:function(e,t){return rf(r(e,t),t)},to_sheet:r,from_sheet:function(e){return[a,s,n,s,o(e),i].join("\n")}}}(),Op=function(){function e(e,t,r,a,s){s.raw?t[r][a]=e:""===e||("TRUE"===e?t[r][a]=!0:"FALSE"===e?t[r][a]=!1:isNaN(Od(e))?isNaN(Md(e).getDate())?t[r][a]=e:t[r][a]=Ad(e):t[r][a]=Od(e))}var t={44:",",9:"\t",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function a(e){for(var a={},s=!1,n=0,i=0;n<e.length;++n)34==(i=e.charCodeAt(n))?s=!s:!s&&i in t&&(a[i]=(a[i]||0)+1);for(n in i=[],a)Object.prototype.hasOwnProperty.call(a,n)&&i.push([a[n],n]);if(!i.length)for(n in a=r)Object.prototype.hasOwnProperty.call(a,n)&&i.push([a[n],n]);return i.sort(function(e,t){return e[0]-t[0]||r[e[1]]-r[t[1]]}),t[i.pop()[1]]||44}function s(e,t){var r=t||{},s="";var n=r.dense?[]:{},i={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(s=e.charAt(4),e=e.slice(7)):13==e.charCodeAt(5)||10==e.charCodeAt(5)?(s=e.charAt(4),e=e.slice(6)):s=a(e.slice(0,1024)):s=r&&r.FS?r.FS:a(e.slice(0,1024));var o=0,l=0,c=0,d=0,u=0,h=s.charCodeAt(0),f=!1,m=0,p=e.charCodeAt(0);e=e.replace(/\r\n/gm,"\n");var g=null!=r.dateNF?function(e){var t="number"==typeof e?Ec[e]:e;return t=t.replace(dd,"(\\d+)"),new RegExp("^"+t+"$")}(r.dateNF):null;function x(){var t=e.slice(d,u),a={};if('"'==t.charAt(0)&&'"'==t.charAt(t.length-1)&&(t=t.slice(1,-1).replace(/""/g,'"')),0===t.length)a.t="z";else if(r.raw)a.t="s",a.v=t;else if(0===t.trim().length)a.t="s",a.v=t;else if(61==t.charCodeAt(0))34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(a.t="s",a.v=t.slice(2,-1).replace(/""/g,'"')):1!=t.length?(a.t="n",a.f=t.slice(1)):(a.t="s",a.v=t);else if("TRUE"==t)a.t="b",a.v=!0;else if("FALSE"==t)a.t="b",a.v=!1;else if(isNaN(c=Od(t)))if(!isNaN(Md(t).getDate())||g&&t.match(g)){a.z=r.dateNF||Ec[14];var s=0;g&&t.match(g)&&(t=function(e,t,r){var a=-1,s=-1,n=-1,i=-1,o=-1,l=-1;(t.match(dd)||[]).forEach(function(e,t){var c=parseInt(r[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":a=c;break;case"d":n=c;break;case"h":i=c;break;case"s":l=c;break;case"m":i>=0?o=c:s=c}}),l>=0&&-1==o&&s>=0&&(o=s,s=-1);var c=(""+(a>=0?a:(new Date).getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(n>=1?n:1)).slice(-2);7==c.length&&(c="0"+c),8==c.length&&(c="20"+c);var d=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return-1==i&&-1==o&&-1==l?c:-1==a&&-1==s&&-1==n?d:c+"T"+d}(0,r.dateNF,t.match(g)||[]),s=1),r.cellDates?(a.t="d",a.v=Ad(t,s)):(a.t="n",a.v=wd(Ad(t,s))),!1!==r.cellText&&(a.w=sd(a.z,a.v instanceof Date?wd(a.v):a.v)),r.cellNF||delete a.z}else a.t="s",a.v=t;else a.t="n",!1!==r.cellText&&(a.w=t),a.v=c;if("z"==a.t||(r.dense?(n[o]||(n[o]=[]),n[o][l]=a):n[Jh({c:l,r:o})]=a),d=u+1,p=e.charCodeAt(d),i.e.c<l&&(i.e.c=l),i.e.r<o&&(i.e.r=o),m==h)++l;else if(l=0,++o,r.sheetRows&&r.sheetRows<=o)return!0}e:for(;u<e.length;++u)switch(m=e.charCodeAt(u)){case 34:34===p&&(f=!f);break;case h:case 10:case 13:if(!f&&x())break e}return u-d>0&&x(),n["!ref"]=Qh(i),n}function n(t,r){return r&&r.PRN?r.FS||"sep="==t.slice(0,4)||t.indexOf("\t")>=0||t.indexOf(",")>=0||t.indexOf(";")>=0?s(t,r):sf(function(t,r){var a=r||{},s=[];if(!t||0===t.length)return s;for(var n=t.split(/[\r\n]/),i=n.length-1;i>=0&&0===n[i].length;)--i;for(var o=10,l=0,c=0;c<=i;++c)-1==(l=n[c].indexOf(" "))?l=n[c].length:l++,o=Math.max(o,l);for(c=0;c<=i;++c){s[c]=[];var d=0;for(e(n[c].slice(0,o).trim(),s,c,d,a),d=1;d<=(n[c].length-o)/10+1;++d)e(n[c].slice(o+10*(d-1),o+10*d).trim(),s,c,d,a)}return a.sheetRows&&(s=s.slice(0,a.sheetRows)),s}(t,r),r):s(t,r)}function i(e,t){var r="",a="string"==t.type?[0,0,0,0]:sw(e,t);switch(t.type){case"base64":r=nc(e);break;case"binary":case"string":r=e;break;case"buffer":r=65001==t.codepage?e.toString("utf8"):t.codepage&&"undefined"!==typeof Zl?Zl.utils.decode(t.codepage,e):ic&&Buffer.isBuffer(e)?e.toString("binary"):hc(e);break;case"array":r=Dd(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==a[0]&&187==a[1]&&191==a[2]?r=vu(r.slice(3)):"string"!=t.type&&"buffer"!=t.type&&65001==t.codepage?r=vu(r):"binary"==t.type&&"undefined"!==typeof Zl&&t.codepage&&(r=Zl.utils.decode(t.codepage,Zl.utils.encode(28591,r))),"socialcalc:version:"==r.slice(0,19)?Ip.to_sheet("string"==t.type?r:vu(r),t):n(r,t)}return{to_workbook:function(e,t){return rf(i(e,t),t)},to_sheet:i,from_sheet:function(e){for(var t,r=[],a=Zh(e["!ref"]),s=Array.isArray(e),n=a.s.r;n<=a.e.r;++n){for(var i=[],o=a.s.c;o<=a.e.c;++o){var l=Jh({r:n,c:o});if((t=s?(e[n]||[])[o]:e[l])&&null!=t.v){for(var c=(t.w||(tf(t),t.w)||"").slice(0,10);c.length<10;)c+=" ";i.push(c+(0===o?" ":""))}else i.push("          ")}r.push(i.join(""))}return r.join("\n")}}}();var Rp=function(){function e(e,t,r){if(e){Rh(e,e.l||0);for(var a=r.Enum||x;e.l<e.length;){var s=e.read_shift(2),n=a[s]||a[65535],i=e.read_shift(2),o=e.l+i,l=n.f&&n.f(e,i,r);if(e.l=o,t(l,n,s))return}}}function t(t,r){if(!t)return t;var a=r||{};var s=a.dense?[]:{},n="Sheet1",i="",o=0,l={},c=[],d=[],u={s:{r:0,c:0},e:{r:0,c:0}},h=a.sheetRows||0;if(0==t[2]&&(8==t[3]||9==t[3])&&t.length>=16&&5==t[14]&&108===t[15])throw new Error("Unsupported Works 3 for Mac file");if(2==t[2])a.Enum=x,e(t,function(e,t,r){switch(r){case 0:a.vers=e,e>=4096&&(a.qpro=!0);break;case 6:u=e;break;case 204:e&&(i=e);break;case 222:i=e;break;case 15:case 51:a.qpro||(e[1].v=e[1].v.slice(1));case 13:case 14:case 16:14==r&&112==(112&e[2])&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=a.dateNF||Ec[14],a.cellDates&&(e[1].t="d",e[1].v=Sd(e[1].v))),a.qpro&&e[3]>o&&(s["!ref"]=Qh(u),l[n]=s,c.push(n),s=a.dense?[]:{},u={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],n=i||"Sheet"+(o+1),i="");var d=a.dense?(s[e[0].r]||[])[e[0].c]:s[Jh(e[0])];if(d){d.t=e[1].t,d.v=e[1].v,null!=e[1].z&&(d.z=e[1].z),null!=e[1].f&&(d.f=e[1].f);break}a.dense?(s[e[0].r]||(s[e[0].r]=[]),s[e[0].r][e[0].c]=e[1]):s[Jh(e[0])]=e[1]}},a);else{if(26!=t[2]&&14!=t[2])throw new Error("Unrecognized LOTUS BOF "+t[2]);a.Enum=b,14==t[2]&&(a.qpro=!0,t.l=0),e(t,function(e,t,r){switch(r){case 204:n=e;break;case 22:e[1].v=e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>o&&(s["!ref"]=Qh(u),l[n]=s,c.push(n),s=a.dense?[]:{},u={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],n="Sheet"+(o+1)),h>0&&e[0].r>=h)break;a.dense?(s[e[0].r]||(s[e[0].r]=[]),s[e[0].r][e[0].c]=e[1]):s[Jh(e[0])]=e[1],u.e.c<e[0].c&&(u.e.c=e[0].c),u.e.r<e[0].r&&(u.e.r=e[0].r);break;case 27:e[14e3]&&(d[e[14e3][0]]=e[14e3][1]);break;case 1537:d[e[0]]=e[1],e[0]==o&&(n=e[1])}},a)}if(s["!ref"]=Qh(u),l[i||n]=s,c.push(i||n),!d.length)return{SheetNames:c,Sheets:l};for(var f={},m=[],p=0;p<d.length;++p)l[c[p]]?(m.push(d[p]||c[p]),f[d[p]]=l[d[p]]||l[c[p]]):(m.push(d[p]),f[d[p]]={"!ref":"A1"});return{SheetNames:m,Sheets:f}}function r(e,t,r){var a=[{c:0,r:0},{t:"n",v:0},0,0];return r.qpro&&20768!=r.vers?(a[0].c=e.read_shift(1),a[3]=e.read_shift(1),a[0].r=e.read_shift(2),e.l+=2):(a[2]=e.read_shift(1),a[0].c=e.read_shift(2),a[0].r=e.read_shift(2)),a}function a(e,t,a){var s=e.l+t,n=r(e,0,a);if(n[1].t="s",20768==a.vers){e.l++;var i=e.read_shift(1);return n[1].v=e.read_shift(i,"utf8"),n}return a.qpro&&e.l++,n[1].v=e.read_shift(s-e.l,"cstr"),n}function s(e,t,r){var a=Fh(7+r.length);a.write_shift(1,255),a.write_shift(2,t),a.write_shift(2,e),a.write_shift(1,39);for(var s=0;s<a.length;++s){var n=r.charCodeAt(s);a.write_shift(1,n>=128?95:n)}return a.write_shift(1,0),a}function n(e,t,r){var a=Fh(7);return a.write_shift(1,255),a.write_shift(2,t),a.write_shift(2,e),a.write_shift(2,r,"i"),a}function i(e,t,r){var a=Fh(13);return a.write_shift(1,255),a.write_shift(2,t),a.write_shift(2,e),a.write_shift(8,r,"f"),a}function o(e,t,r){var a=32768&t;return t=(a?e:0)+((t&=-32769)>=8192?t-16384:t),(a?"":"$")+(r?Kh(t):qh(t))}var l={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},c=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function d(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e.read_shift(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function u(e,t,r,a){var s=Fh(6+a.length);s.write_shift(2,e),s.write_shift(1,r),s.write_shift(1,t),s.write_shift(1,39);for(var n=0;n<a.length;++n){var i=a.charCodeAt(n);s.write_shift(1,i>=128?95:i)}return s.write_shift(1,0),s}function h(e,t){var r=d(e),a=e.read_shift(4),s=e.read_shift(4),n=e.read_shift(2);if(65535==n)return 0===a&&3221225472===s?(r[1].t="e",r[1].v=15):0===a&&3489660928===s?(r[1].t="e",r[1].v=42):r[1].v=0,r;var i=32768&n;return n=(32767&n)-16446,r[1].v=(1-2*i)*(s*Math.pow(2,n+32)+a*Math.pow(2,n)),r}function f(e,t,r,a){var s=Fh(14);if(s.write_shift(2,e),s.write_shift(1,r),s.write_shift(1,t),0==a)return s.write_shift(4,0),s.write_shift(4,0),s.write_shift(2,65535),s;var n,i=0,o=0,l=0;return a<0&&(i=1,a=-a),o=0|Math.log2(a),0==(2147483648&(l=(a/=Math.pow(2,o-31))>>>0))&&(++o,l=(a/=2)>>>0),a-=l,l|=2147483648,l>>>=0,n=(a*=Math.pow(2,32))>>>0,s.write_shift(4,n),s.write_shift(4,l),o+=16383+(i?32768:0),s.write_shift(2,o),s}function m(e,t){var r=d(e),a=e.read_shift(8,"f");return r[1].v=a,r}function p(e,t){return 0==e[e.l+t-1]?e.read_shift(t,"cstr"):""}function g(e,t){var r=Fh(5+e.length);r.write_shift(2,14e3),r.write_shift(2,t);for(var a=0;a<e.length;++a){var s=e.charCodeAt(a);r[r.l++]=s>127?95:s}return r[r.l++]=0,r}var x={0:{n:"BOF",f:Im},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e,t,r){var a={s:{c:0,r:0},e:{c:0,r:0}};return 8==t&&r.qpro?(a.s.c=e.read_shift(1),e.l++,a.s.r=e.read_shift(2),a.e.c=e.read_shift(1),e.l++,a.e.r=e.read_shift(2),a):(a.s.c=e.read_shift(2),a.s.r=e.read_shift(2),12==t&&r.qpro&&(e.l+=2),a.e.c=e.read_shift(2),a.e.r=e.read_shift(2),12==t&&r.qpro&&(e.l+=2),65535==a.s.c&&(a.s.c=a.e.c=a.s.r=a.e.r=0),a)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,t,a){var s=r(e,0,a);return s[1].v=e.read_shift(2,"i"),s}},14:{n:"NUMBER",f:function(e,t,a){var s=r(e,0,a);return s[1].v=e.read_shift(8,"f"),s}},15:{n:"LABEL",f:a},16:{n:"FORMULA",f:function(e,t,a){var s=e.l+t,n=r(e,0,a);if(n[1].v=e.read_shift(8,"f"),a.qpro)e.l=s;else{var i=e.read_shift(2);!function(e,t){Rh(e,0);var r=[],a=0,s="",n="",i="",d="";for(;e.l<e.length;){var u=e[e.l++];switch(u){case 0:r.push(e.read_shift(8,"f"));break;case 1:n=o(t[0].c,e.read_shift(2),!0),s=o(t[0].r,e.read_shift(2),!1),r.push(n+s);break;case 2:var h=o(t[0].c,e.read_shift(2),!0),f=o(t[0].r,e.read_shift(2),!1);n=o(t[0].c,e.read_shift(2),!0),s=o(t[0].r,e.read_shift(2),!1),r.push(h+f+":"+n+s);break;case 3:if(e.l<e.length)return void console.error("WK1 premature formula end");break;case 4:r.push("("+r.pop()+")");break;case 5:r.push(e.read_shift(2));break;case 6:for(var m="";u=e[e.l++];)m+=String.fromCharCode(u);r.push('"'+m.replace(/"/g,'""')+'"');break;case 8:r.push("-"+r.pop());break;case 23:r.push("+"+r.pop());break;case 22:r.push("NOT("+r.pop()+")");break;case 20:case 21:d=r.pop(),i=r.pop(),r.push(["AND","OR"][u-20]+"("+i+","+d+")");break;default:if(u<32&&c[u])d=r.pop(),i=r.pop(),r.push(i+c[u]+d);else{if(!l[u])return u<=7?console.error("WK1 invalid opcode "+u.toString(16)):u<=24?console.error("WK1 unsupported op "+u.toString(16)):u<=30?console.error("WK1 invalid opcode "+u.toString(16)):u<=115?console.error("WK1 unsupported function opcode "+u.toString(16)):console.error("WK1 unrecognized opcode "+u.toString(16));if(69==(a=l[u][1])&&(a=e[e.l++]),a>r.length)return void console.error("WK1 bad formula parse 0x"+u.toString(16)+":|"+r.join("|")+"|");var p=r.slice(-a);r.length-=a,r.push(l[u][0]+"("+p.join(",")+")")}}}1==r.length?t[1].f=""+r[0]:console.error("WK1 bad formula parse |"+r.join("|")+"|")}(e.slice(e.l,e.l+i),n),e.l+=i}return n}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:a},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:p},222:{n:"SHEETNAMELP",f:function(e,t){var r=e[e.l++];r>t-1&&(r=t-1);for(var a="";a.length<r;)a+=String.fromCharCode(e[e.l++]);return a}},65535:{n:""}},b={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(e,t){var r=d(e);return r[1].t="s",r[1].v=e.read_shift(t-4,"cstr"),r}},23:{n:"NUMBER17",f:h},24:{n:"NUMBER18",f:function(e,t){var r=d(e);r[1].v=e.read_shift(2);var a=r[1].v>>1;if(1&r[1].v)switch(7&a){case 0:a=5e3*(a>>3);break;case 1:a=500*(a>>3);break;case 2:a=(a>>3)/20;break;case 3:a=(a>>3)/200;break;case 4:a=(a>>3)/2e3;break;case 5:a=(a>>3)/2e4;break;case 6:a=(a>>3)/16;break;case 7:a=(a>>3)/64}return r[1].v=a,r}},25:{n:"FORMULA19",f:function(e,t){var r=h(e);return e.l+=t-14,r}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(e,t){for(var r={},a=e.l+t;e.l<a;){var s=e.read_shift(2);if(14e3==s){for(r[s]=[0,""],r[s][0]=e.read_shift(2);e[e.l];)r[s][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return r}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var r=d(e),a=e.read_shift(4);return r[1].v=a>>6,r}},38:{n:"??"},39:{n:"NUMBER27",f:m},40:{n:"FORMULA28",f:function(e,t){var r=m(e);return e.l+=t-10,r}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:p},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(e,t,r){if(r.qpro&&!(t<21)){var a=e.read_shift(1);return e.l+=17,e.l+=1,e.l+=2,[a,e.read_shift(t-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function(e,t){var r=t||{};if(+r.codepage>=0&&Yl(+r.codepage),"string"==r.type)throw new Error("Cannot write WK1 to JS string");var a=zh(),o=Zh(e["!ref"]),l=Array.isArray(e),c=[];Yv(a,0,function(e){var t=Fh(2);return t.write_shift(2,e),t}(1030)),Yv(a,6,function(e){var t=Fh(8);return t.write_shift(2,e.s.c),t.write_shift(2,e.s.r),t.write_shift(2,e.e.c),t.write_shift(2,e.e.r),t}(o));for(var d=Math.min(o.e.r,8191),u=o.s.r;u<=d;++u)for(var h=qh(u),f=o.s.c;f<=o.e.c;++f){u===o.s.r&&(c[f]=Kh(f));var m=c[f]+h,p=l?(e[u]||[])[f]:e[m];if(p&&"z"!=p.t)if("n"==p.t)(0|p.v)==p.v&&p.v>=-32768&&p.v<=32767?Yv(a,13,n(u,f,p.v)):Yv(a,14,i(u,f,p.v));else Yv(a,15,s(u,f,tf(p).slice(0,239)))}return Yv(a,1),a.end()},book_to_wk3:function(e,t){var r=t||{};if(+r.codepage>=0&&Yl(+r.codepage),"string"==r.type)throw new Error("Cannot write WK3 to JS string");var a=zh();Yv(a,0,function(e){var t=Fh(26);t.write_shift(2,4096),t.write_shift(2,4),t.write_shift(4,0);for(var r=0,a=0,s=0,n=0;n<e.SheetNames.length;++n){var i=e.SheetNames[n],o=e.Sheets[i];if(o&&o["!ref"]){++s;var l=Xh(o["!ref"]);r<l.e.r&&(r=l.e.r),a<l.e.c&&(a=l.e.c)}}r>8191&&(r=8191);return t.write_shift(2,r),t.write_shift(1,s),t.write_shift(1,a),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,1),t.write_shift(1,2),t.write_shift(4,0),t.write_shift(4,0),t}(e));for(var s=0,n=0;s<e.SheetNames.length;++s)(e.Sheets[e.SheetNames[s]]||{})["!ref"]&&Yv(a,27,g(e.SheetNames[s],n++));var i=0;for(s=0;s<e.SheetNames.length;++s){var o=e.Sheets[e.SheetNames[s]];if(o&&o["!ref"]){for(var l=Zh(o["!ref"]),c=Array.isArray(o),d=[],h=Math.min(l.e.r,8191),m=l.s.r;m<=h;++m)for(var p=qh(m),x=l.s.c;x<=l.e.c;++x){m===l.s.r&&(d[x]=Kh(x));var b=d[x]+p,v=c?(o[m]||[])[x]:o[b];if(v&&"z"!=v.t)if("n"==v.t)Yv(a,23,f(m,x,i,v.v));else Yv(a,22,u(m,x,i,tf(v).slice(0,239)))}++i}}return Yv(a,1),a.end()},to_workbook:function(e,r){switch(r.type){case"base64":return t(dc(nc(e)),r);case"binary":return t(dc(e),r);case"buffer":case"array":return t(e,r)}throw"Unsupported type "+r.type}}}();var Mp=function(){var e=wu("t"),t=wu("rPr");function r(r){var a=r.match(e);if(!a)return{t:"s",v:""};var s={t:"s",v:iu(a[1])},n=r.match(t);return n&&(s.s=function(e){var t={},r=e.match(Zd),a=0,s=!1;if(r)for(;a!=r.length;++a){var n=ru(r[a]);switch(n[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!n.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==n.val)break;t.cp=$l[parseInt(n.val,10)];break;case"<outline":if(!n.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=n.val;break;case"<sz":t.sz=n.val;break;case"<strike":if(!n.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!n.val)break;switch(n.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting"}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if("0"==n.val)break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if("0"==n.val)break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":n.rgb&&(t.color=n.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=n.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=n.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":case"<scheme>":case"<scheme/>":case"</scheme>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(47!==n[0].charCodeAt(1)&&!s)throw new Error("Unrecognized rich format "+n[0])}}return t}(n[1])),s}var a=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(e){return e.replace(a,"").split(s).map(r).filter(function(e){return e.v})}}(),Fp=function(){var e=/(\r\n|\n)/g;function t(t){var r=[[],t.v,[]];return t.v?(t.s&&function(e,t,r){var a=[];e.u&&a.push("text-decoration: underline;"),e.uval&&a.push("text-underline-style:"+e.uval+";"),e.sz&&a.push("font-size:"+e.sz+"pt;"),e.outline&&a.push("text-effect: outline;"),e.shadow&&a.push("text-shadow: auto;"),t.push('<span style="'+a.join("")+'">'),e.b&&(t.push("<b>"),r.push("</b>")),e.i&&(t.push("<i>"),r.push("</i>")),e.strike&&(t.push("<s>"),r.push("</s>"));var s=e.valign||"";"superscript"==s||"super"==s?s="sup":"subscript"==s&&(s="sub"),""!=s&&(t.push("<"+s+">"),r.push("</"+s+">")),r.push("</span>")}(t.s,r[0],r[2]),r[0].join("")+r[1].replace(e,"<br/>")+r[2].join("")):""}return function(e){return e.map(t).join("")}}(),Lp=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,zp=/<(?:\w+:)?r>/,Bp=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Up(e,t){var r=!t||t.cellHTML,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=iu(vu(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=vu(e),r&&(a.h=hu(a.t))):e.match(zp)&&(a.r=vu(e),a.t=iu(vu((e.replace(Bp,"").match(Lp)||[]).join("").replace(Zd,""))),r&&(a.h=Fp(Mp(a.r)))),a):{t:""}}var Wp=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Hp=/<(?:\w+:)?(?:si|sstItem)>/g,Vp=/<\/(?:\w+:)?(?:si|sstItem)>/;var Gp=/^\s|\s$|[\t\n\r]/;function qp(e,t){if(!t.bookSST)return"";var r=[Jd];r[r.length]=Au("sst",null,{xmlns:$u[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(null!=e[a]){var s=e[a],n="<si>";s.r?n+=s.r:(n+="<t",s.t||(s.t=""),s.t.match(Gp)&&(n+=' xml:space="preserve"'),n+=">"+cu(s.t)+"</t>"),n+="</si>",r[r.length]=n}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}var $p=function(e,t){var r=!1;return null==t&&(r=!0,t=Fh(15+4*e.t.length)),t.write_shift(1,0),lf(e.t,t),r?t.slice(0,t.l):t};function Kp(e){var t=zh();Bh(t,159,function(e,t){return t||(t=Fh(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}(e));for(var r=0;r<e.length;++r)Bh(t,19,$p(e[r]));return Bh(t,160),t.end()}function Yp(e){if("undefined"!==typeof Zl)return Zl.utils.encode(Gl,e);for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function Jp(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function Xp(e){for(var t=e.read_shift(4),r=e.l+t-4,a={},s=e.read_shift(4),n=[];s-- >0;)n.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=n,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return a}function Qp(e){var t=function(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Jp(e,4),t.U=Jp(e,4),t.W=Jp(e,4),t}(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),4!=e.read_shift(4))throw new Error("Bad !Primary record");return t}function Zp(e,t){var r=e.l+t,a={};a.Flags=63&e.read_shift(4),e.l+=4,a.AlgID=e.read_shift(4);var s=!1;switch(a.AlgID){case 26126:case 26127:case 26128:s=36==a.Flags;break;case 26625:s=4==a.Flags;break;case 0:s=16==a.Flags||4==a.Flags||36==a.Flags;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,a}function eg(e,t){var r={},a=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,a),e.l=a,r}function tg(e){if(36!=(63&e.read_shift(4)))throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4);return{t:"Std",h:Zp(e,t),v:eg(e,e.length-e.l)}}function rg(){throw new Error("File is password-protected: ECMA-376 Extensible")}function ag(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),a={};return r.replace(Zd,function(e){var r=ru(e);switch(au(r[0])){case"<?xml":case"<encryption":case"</encryption>":case"</keyEncryptors>":case"</keyEncryptor>":break;case"<keyData":t.forEach(function(e){a[e]=r[e]});break;case"<dataIntegrity":a.encryptedHmacKey=r.encryptedHmacKey,a.encryptedHmacValue=r.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"<keyEncryptor":a.uri=r.uri;break;case"<encryptedKey":a.encs.push(r);break;default:throw r[0]}}),a}function sg(e){var t,r,a=0,s=Yp(e),n=s.length+1;for((t=lc(n))[0]=s.length,r=1;r!=n;++r)t[r]=s[r-1];for(r=n-1;r>=0;--r)a=((0===(16384&a)?0:1)|a<<1&32767)^t[r];return 52811^a}var ng=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(e,t){return 255&((r=e^t)/2|128*r);var r};return function(s){for(var n,i,o,l=Yp(s),c=function(e){for(var a=t[e.length-1],s=104,n=e.length-1;n>=0;--n)for(var i=e[n],o=0;7!=o;++o)64&i&&(a^=r[s]),i*=2,--s;return a}(l),d=l.length,u=lc(16),h=0;16!=h;++h)u[h]=0;for(1===(1&d)&&(n=c>>8,u[d]=a(e[0],n),--d,n=255&c,i=l[l.length-1],u[d]=a(i,n));d>0;)n=c>>8,u[--d]=a(l[d],n),n=255&c,u[--d]=a(l[d],n);for(d=15,o=15-l.length;o>0;)n=c>>8,u[d]=a(e[o],n),--o,n=255&c,u[--d]=a(l[d],n),--d,--o;return u}}(),ig=function(e){var t=0,r=ng(e);return function(e){var a=function(e,t,r,a,s){var n,i;for(s||(s=t),a||(a=ng(e)),n=0;n!=t.length;++n)i=t[n],i=255&((i^=a[r])>>5|i<<3),s[n]=i,++r;return[s,r,a]}("",e,t,r);return t=a[1],a[0]}};function og(e,t,r){var a=r||{};return a.Info=e.read_shift(2),e.l-=2,1===a.Info?a.Data=function(e){var t={},r=t.EncryptionVersionInfo=Jp(e,4);if(1!=r.Major||1!=r.Minor)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}(e):a.Data=function(e,t){var r={},a=r.EncryptionVersionInfo=Jp(e,4);if(t-=4,2!=a.Minor)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=Zp(e,s),t-=s,r.EncryptionVerifier=eg(e,t),r}(e,t),a}var lg=function(){function e(e,r){switch(r.type){case"base64":return t(nc(e),r);case"binary":return t(e,r);case"buffer":return t(ic&&Buffer.isBuffer(e)?e.toString("binary"):hc(e),r);case"array":return t(Dd(e),r)}throw new Error("Unrecognized type "+r.type)}function t(e,t){var r=(t||{}).dense?[]:{},a=e.match(/\\trowd.*?\\row\b/g);if(!a.length)throw new Error("RTF missing table");var s={s:{c:0,r:0},e:{c:0,r:a.length-1}};return a.forEach(function(e,t){Array.isArray(r)&&(r[t]=[]);for(var a,n=/\\\w+\b/g,i=0,o=-1;a=n.exec(e);){if("\\cell"===a[0]){var l=e.slice(i,n.lastIndex-a[0].length);if(" "==l[0]&&(l=l.slice(1)),++o,l.length){var c={v:l,t:"s"};Array.isArray(r)?r[t][o]=c:r[Jh({r:t,c:o})]=c}}i=n.lastIndex}o>s.e.c&&(s.e.c=o)}),r["!ref"]=Qh(s),r}return{to_workbook:function(t,r){return rf(e(t,r),r)},to_sheet:e,from_sheet:function(e){for(var t,r=["{\\rtf1\\ansi"],a=Zh(e["!ref"]),s=Array.isArray(e),n=a.s.r;n<=a.e.r;++n){r.push("\\trowd\\trautofit1");for(var i=a.s.c;i<=a.e.c;++i)r.push("\\cellx"+(i+1));for(r.push("\\pard\\intbl"),i=a.s.c;i<=a.e.c;++i){var o=Jh({r:n,c:i});(t=s?(e[n]||[])[i]:e[o])&&(null!=t.v||t.f&&!t.F)&&(r.push(" "+(t.w||(tf(t),t.w))),r.push("\\cell"))}r.push("\\pard\\intbl\\row")}return r.join("")+"}"}}}();function cg(e){for(var t=0,r=1;3!=t;++t)r=256*r+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function dg(e,t){if(0===t)return e;var r=function(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,s=Math.max(t,r,a),n=Math.min(t,r,a),i=s-n;if(0===i)return[0,0,t];var o,l=0,c=s+n;switch(o=i/(c>1?2-c:c),s){case t:l=((r-a)/i+6)%6;break;case r:l=(a-t)/i+2;break;case a:l=(t-r)/i+4}return[l/6,o,c/2]}(function(e){var t=e.slice("#"===e[0]?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}(e));return r[2]=t<0?r[2]*(1+t):1-(1-r[2])*(1-t),cg(function(e){var t,r=e[0],a=e[1],s=e[2],n=2*a*(s<.5?s:1-s),i=s-n/2,o=[i,i,i],l=6*r;if(0!==a)switch(0|l){case 0:case 6:t=n*l,o[0]+=n,o[1]+=t;break;case 1:t=n*(2-l),o[0]+=t,o[1]+=n;break;case 2:t=n*(l-2),o[1]+=n,o[2]+=t;break;case 3:t=n*(4-l),o[1]+=t,o[2]+=n;break;case 4:t=n*(l-4),o[2]+=n,o[0]+=t;break;case 5:t=n*(6-l),o[2]+=t,o[0]+=n}for(var c=0;3!=c;++c)o[c]=Math.round(255*o[c]);return o}(r))}var ug=6;function hg(e){return Math.floor((e+Math.round(128/ug)/256)*ug)}function fg(e){return Math.floor((e-5)/ug*100+.5)/100}function mg(e){return Math.round((e*ug+5)/ug*256)/256}function pg(e){return mg(fg(hg(e)))}function gg(e){var t=Math.abs(e-pg(e)),r=ug;if(t>.005)for(ug=1;ug<15;++ug)Math.abs(e-pg(e))<=t&&(t=Math.abs(e-pg(e)),r=ug);ug=r}function xg(e){e.width?(e.wpx=hg(e.width),e.wch=fg(e.wpx),e.MDW=ug):e.wpx?(e.wch=fg(e.wpx),e.width=mg(e.wch),e.MDW=ug):"number"==typeof e.wch&&(e.width=mg(e.wch),e.wpx=hg(e.width),e.MDW=ug),e.customWidth&&delete e.customWidth}var bg=96;function vg(e){return 96*e/bg}function yg(e){return e*bg/96}var wg={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};var jg=["numFmtId","fillId","fontId","borderId","xfId"],Ng=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];var kg=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(n,i,o){var l,c={};return n?((l=(n=n.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(e))&&function(e,t,r){t.NumberFmt=[];for(var a=gd(Ec),s=0;s<a.length;++s)t.NumberFmt[a[s]]=Ec[a[s]];var n=e[0].match(Zd);if(n)for(s=0;s<n.length;++s){var i=ru(n[s]);switch(au(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":case"</numFmt>":break;case"<numFmt":var o=iu(vu(i.formatCode)),l=parseInt(i.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&null!=t.NumberFmt[l];--l);t.NumberFmt[l]=o}nd(o,l)}break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}(l,c,o),(l=n.match(a))&&function(e,t,r,a){t.Fonts=[];var s={},n=!1;(e[0].match(Zd)||[]).forEach(function(e){var i=ru(e);switch(au(i[0])){case"<fonts":case"<fonts>":case"</fonts>":case"<font":case"<font>":case"<name/>":case"</name>":case"<sz/>":case"</sz>":case"<vertAlign/>":case"</vertAlign>":case"<family/>":case"</family>":case"<scheme/>":case"</scheme>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":i.val&&(s.name=vu(i.val));break;case"<b":s.bold=i.val?mu(i.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=i.val?mu(i.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(i.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=i.val?mu(i.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=i.val?mu(i.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=i.val?mu(i.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=i.val?mu(i.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=i.val?mu(i.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":i.val&&(s.sz=+i.val);break;case"<vertAlign":i.val&&(s.vertAlign=i.val);break;case"<family":i.val&&(s.family=parseInt(i.val,10));break;case"<scheme":i.val&&(s.scheme=i.val);break;case"<charset":if("1"==i.val)break;i.codepage=$l[parseInt(i.val,10)];break;case"<color":if(s.color||(s.color={}),i.auto&&(s.color.auto=mu(i.auto)),i.rgb)s.color.rgb=i.rgb.slice(-6);else if(i.indexed){s.color.index=parseInt(i.indexed,10);var o=Bf[s.color.index];81==s.color.index&&(o=Bf[1]),o||(o=Bf[1]),s.color.rgb=o[0].toString(16)+o[1].toString(16)+o[2].toString(16)}else i.theme&&(s.color.theme=parseInt(i.theme,10),i.tint&&(s.color.tint=parseFloat(i.tint)),i.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=dg(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<AlternateContent":case"<ext":n=!0;break;case"</AlternateContent>":case"</ext>":n=!1;break;default:if(a&&a.WTF&&!n)throw new Error("unrecognized "+i[0]+" in fonts")}})}(l,c,i,o),(l=n.match(r))&&function(e,t,r,a){t.Fills=[];var s={},n=!1;(e[0].match(Zd)||[]).forEach(function(e){var r=ru(e);switch(au(r[0])){case"<fills":case"<fills>":case"</fills>":case"</fill>":case"<gradientFill>":case"<patternFill/>":case"</patternFill>":case"<bgColor/>":case"</bgColor>":case"<fgColor/>":case"</fgColor>":case"<stop":case"<stop/>":case"</stop>":case"<color":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":r.patternType&&(s.patternType=r.patternType);break;case"<bgColor":s.bgColor||(s.bgColor={}),r.indexed&&(s.bgColor.indexed=parseInt(r.indexed,10)),r.theme&&(s.bgColor.theme=parseInt(r.theme,10)),r.tint&&(s.bgColor.tint=parseFloat(r.tint)),r.rgb&&(s.bgColor.rgb=r.rgb.slice(-6));break;case"<fgColor":s.fgColor||(s.fgColor={}),r.theme&&(s.fgColor.theme=parseInt(r.theme,10)),r.tint&&(s.fgColor.tint=parseFloat(r.tint)),null!=r.rgb&&(s.fgColor.rgb=r.rgb.slice(-6));break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(a&&a.WTF&&!n)throw new Error("unrecognized "+r[0]+" in fills")}})}(l,c,0,o),(l=n.match(s))&&function(e,t,r,a){t.Borders=[];var s={},n=!1;(e[0].match(Zd)||[]).forEach(function(e){var r=ru(e);switch(au(r[0])){case"<borders":case"<borders>":case"</borders>":case"</border>":case"<left/>":case"<left":case"<left>":case"</left>":case"<right/>":case"<right":case"<right>":case"</right>":case"<top/>":case"<top":case"<top>":case"</top>":case"<bottom/>":case"<bottom":case"<bottom>":case"</bottom>":case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":case"<start":case"<start>":case"<start/>":case"</start>":case"<end":case"<end>":case"<end/>":case"</end>":case"<color":case"<color>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<border":case"<border>":case"<border/>":s={},r.diagonalUp&&(s.diagonalUp=mu(r.diagonalUp)),r.diagonalDown&&(s.diagonalDown=mu(r.diagonalDown)),t.Borders.push(s);break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(a&&a.WTF&&!n)throw new Error("unrecognized "+r[0]+" in borders")}})}(l,c,0,o),(l=n.match(t))&&function(e,t,r){var a;t.CellXf=[];var s=!1;(e[0].match(Zd)||[]).forEach(function(e){var n=ru(e),i=0;switch(au(n[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":case"</xf>":case"</alignment>":case"<protection":case"</protection>":case"<protection/>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<xf":case"<xf/>":for(delete(a=n)[0],i=0;i<jg.length;++i)a[jg[i]]&&(a[jg[i]]=parseInt(a[jg[i]],10));for(i=0;i<Ng.length;++i)a[Ng[i]]&&(a[Ng[i]]=mu(a[Ng[i]]));if(t.NumberFmt&&a.numFmtId>392)for(i=392;i>60;--i)if(t.NumberFmt[a.numFmtId]==t.NumberFmt[i]){a.numFmtId=i;break}t.CellXf.push(a);break;case"<alignment":case"<alignment/>":var o={};n.vertical&&(o.vertical=n.vertical),n.horizontal&&(o.horizontal=n.horizontal),null!=n.textRotation&&(o.textRotation=n.textRotation),n.indent&&(o.indent=n.indent),n.wrapText&&(o.wrapText=mu(n.wrapText)),a.alignment=o;break;case"<AlternateContent":case"<ext":s=!0;break;case"</AlternateContent>":case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+n[0]+" in cellXfs")}})}(l,c,o),c):c}}();function Sg(e,t){var r,a=[Jd,Au("styleSheet",null,{xmlns:$u[0],"xmlns:vt":Vu})];return e.SSF&&null!=(r=function(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)null!=e[a]&&(t[t.length]=Au("numFmt",null,{numFmtId:a,formatCode:cu(e[a])}))}),1===t.length?"":(t[t.length]="</numFmts>",t[0]=Au("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(e.SSF))&&(a[a.length]=r),a[a.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',a[a.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',a[a.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',a[a.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=function(e){var t=[];return t[t.length]=Au("cellXfs",null),e.forEach(function(e){t[t.length]=Au("xf",null,e)}),t[t.length]="</cellXfs>",2===t.length?"":(t[0]=Au("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(t.cellXfs))&&(a[a.length]=r),a[a.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',a[a.length]='<dxfs count="0"/>',a[a.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',a.length>2&&(a[a.length]="</styleSheet>",a[1]=a[1].replace("/>",">")),a.join("")}function Eg(e,t,r){r||(r=Fh(6+4*t.length)),r.write_shift(2,e),lf(t,r);var a=r.length>r.l?r.slice(0,r.l):r;return null==r.l&&(r.l=r.length),a}function Tg(e,t){t||(t=Fh(153)),t.write_shift(2,20*e.sz),function(e,t){t||(t=Fh(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);t.write_shift(1,r),t.write_shift(1,0)}(e,t),t.write_shift(2,e.bold?700:400);var r=0;"superscript"==e.vertAlign?r=1:"subscript"==e.vertAlign&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Df(e.color,t);var a=0;return"major"==e.scheme&&(a=1),"minor"==e.scheme&&(a=2),t.write_shift(1,a),lf(e.name,t),t.length>t.l?t.slice(0,t.l):t}var _g,Cg=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Ag=Mh;function Dg(e,t){t||(t=Fh(84)),_g||(_g=bd(Cg));var r=_g[e.patternType];null==r&&(r=40),t.write_shift(4,r);var a=0;if(40!=r)for(Df({auto:1},t),Df({auto:1},t);a<12;++a)t.write_shift(4,0);else{for(;a<4;++a)t.write_shift(4,0);for(;a<12;++a)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function Pg(e,t,r){r||(r=Fh(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);return r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Ig(e,t){return t||(t=Fh(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var Og=Mh;function Rg(e){var t;Bh(e,613,nf(1)),Bh(e,46,(t||(t=Fh(51)),t.write_shift(1,0),Ig(0,t),Ig(0,t),Ig(0,t),Ig(0,t),Ig(0,t),t.length>t.l?t.slice(0,t.l):t)),Bh(e,614)}function Mg(e){var t,r;Bh(e,619,nf(1)),Bh(e,48,(t={xfId:0,builtinId:0,name:"Normal"},r||(r=Fh(52)),r.write_shift(4,t.xfId),r.write_shift(2,1),r.write_shift(1,+t.builtinId),r.write_shift(1,0),yf(t.name||"",r),r.length>r.l?r.slice(0,r.l):r)),Bh(e,620)}function Fg(e){Bh(e,508,function(e,t,r){var a=Fh(2052);return a.write_shift(4,e),yf(t,a),yf(r,a),a.length>a.l?a.slice(0,a.l):a}(0,"TableStyleMedium9","PivotStyleMedium4")),Bh(e,509)}function Lg(e,t){var r=zh();return Bh(r,278),function(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var a=e[0];a<=e[1];++a)null!=t[a]&&++r}),0!=r&&(Bh(e,615,nf(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)null!=t[a]&&Bh(e,44,Eg(a,t[a]))}),Bh(e,616))}}(r,e.SSF),function(e){Bh(e,611,nf(1)),Bh(e,43,Tg({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),Bh(e,612)}(r),function(e){Bh(e,603,nf(2)),Bh(e,45,Dg({patternType:"none"})),Bh(e,45,Dg({patternType:"gray125"})),Bh(e,604)}(r),Rg(r),function(e){Bh(e,626,nf(1)),Bh(e,47,Pg({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),Bh(e,627)}(r),function(e,t){Bh(e,617,nf(t.length)),t.forEach(function(t){Bh(e,47,Pg(t,0))}),Bh(e,618)}(r,t.cellXfs),Mg(r),function(e){Bh(e,505,nf(0)),Bh(e,506)}(r),Fg(r),Bh(r,279),r.end()}var zg=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Bg(e,t,r){t.themeElements.clrScheme=[];var a={};(e[0].match(Zd)||[]).forEach(function(e){var s=ru(e);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=s.val;break;case"<a:sysClr":a.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===s[0].charAt(1)?(t.themeElements.clrScheme[zg.indexOf(s[0])]=a,a={}):a.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function Ug(){}function Wg(){}var Hg=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Vg=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Gg=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;var qg=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function $g(e,t){var r;e&&0!==e.length||(e=Kg());var a={};if(!(r=e.match(qg)))throw new Error("themeElements not found in theme");return function(e,t,r){var a;t.themeElements={},[["clrScheme",Hg,Bg],["fontScheme",Vg,Ug],["fmtScheme",Gg,Wg]].forEach(function(s){if(!(a=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](a,t,r)})}(r[0],a,t),a.raw=e,a}function Kg(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var r=[Jd];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',r[r.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',r[r.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',r[r.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',r[r.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',r[r.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',r[r.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Yg(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:case 4:e.l+=4;break;case 1:t.xclrValue=function(e,t){return Mh(e,t)}(e,4);break;case 2:t.xclrValue=Km(e);break;case 3:t.xclrValue=function(e){return e.read_shift(4)}(e)}return e.l+=8,t}function Jg(e){var t=e.read_shift(2),r=e.read_shift(2)-4,a=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=Yg(e);break;case 6:a[1]=function(e,t){return Mh(e,t)}(e,r);break;case 14:case 15:a[1]=e.read_shift(1===r?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return a}function Xg(e,t){t.forEach(function(e){e[0]})}function Qg(){var e=zh();return Bh(e,332),Bh(e,334,nf(1)),Bh(e,335,function(e){var t=Fh(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),lf(e.name,t),t.slice(0,t.l)}({name:"XLDAPR",version:12e4,flags:3496657072})),Bh(e,336),Bh(e,339,function(e,t){var r=Fh(8+2*t.length);return r.write_shift(4,e),lf(t,r),r.slice(0,r.l)}(1,"XLDAPR")),Bh(e,52),Bh(e,35,nf(514)),Bh(e,4096,nf(0)),Bh(e,4097,Om(1)),Bh(e,36),Bh(e,53),Bh(e,340),Bh(e,337,function(e,t){var r=Fh(8);return r.write_shift(4,e),r.write_shift(4,t?1:0),r}(1,!0)),Bh(e,51,function(e){var t=Fh(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}([[1,0]])),Bh(e,338),Bh(e,333),e.end()}function Zg(){var e=[Jd];return e.push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),e.join("")}var ex=1024;function tx(e,t){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[Au("xml",null,{"xmlns:v":Zu,"xmlns:o":Ku,"xmlns:x":Yu,"xmlns:mv":Qu}).replace(/\/>/,">"),Au("o:shapelayout",Au("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Au("v:shapetype",[Au("v:stroke",null,{joinstyle:"miter"}),Au("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];ex<1e3*e;)ex+=1e3;return t.forEach(function(e){var t=Yh(e[0]),r={color2:"#BEFF82",type:"gradient"};"gradient"==r.type&&(r.angle="-180");var a="gradient"==r.type?Au("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,n=Au("v:fill",a,r);++ex,s=s.concat(["<v:shape"+Cu({id:"_x0000_s"+ex,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",n,Au("v:shadow",null,{on:"t",obscured:"t"}),Au("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",_u("x:Anchor",[t.c+1,0,t.r+1,0,t.c+3,20,t.r+5,20].join(",")),_u("x:AutoFill","False"),_u("x:Row",String(t.r)),_u("x:Column",String(t.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function rx(e,t,r,a){var s,n=Array.isArray(e);t.forEach(function(t){var i=Yh(t.ref);if(n?(e[i.r]||(e[i.r]=[]),s=e[i.r][i.c]):s=e[t.ref],!s){s={t:"z"},n?e[i.r][i.c]=s:e[t.ref]=s;var o=Zh(e["!ref"]||"BDWGO1000001:A1");o.s.r>i.r&&(o.s.r=i.r),o.e.r<i.r&&(o.e.r=i.r),o.s.c>i.c&&(o.s.c=i.c),o.e.c<i.c&&(o.e.c=i.c);var l=Qh(o);l!==e["!ref"]&&(e["!ref"]=l)}s.c||(s.c=[]);var c={a:t.author,t:t.t,r:t.r,T:r};t.h&&(c.h=t.h);for(var d=s.c.length-1;d>=0;--d){if(!r&&s.c[d].T)return;r&&!s.c[d].T&&s.c.splice(d,1)}if(r&&a)for(d=0;d<a.length;++d)if(c.a==a[d].id){c.a=a[d].name||c.a;break}s.c.push(c)})}function ax(e){var t=[Jd,Au("comments",null,{xmlns:$u[0]})],r=[];return t.push("<authors>"),e.forEach(function(e){e[1].forEach(function(e){var a=cu(e.a);-1==r.indexOf(a)&&(r.push(a),t.push("<author>"+a+"</author>")),e.T&&e.ID&&-1==r.indexOf("tc="+e.ID)&&(r.push("tc="+e.ID),t.push("<author>tc="+e.ID+"</author>"))})}),0==r.length&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(e){var a=0,s=[];if(e[1][0]&&e[1][0].T&&e[1][0].ID?a=r.indexOf("tc="+e[1][0].ID):e[1].forEach(function(e){e.a&&(a=r.indexOf(cu(e.a))),s.push(e.t||"")}),t.push('<comment ref="'+e[0]+'" authorId="'+a+'"><text>'),s.length<=1)t.push(_u("t",cu(s[0]||"")));else{for(var n="Comment:\n    "+s[0]+"\n",i=1;i<s.length;++i)n+="Reply:\n    "+s[i]+"\n";t.push(_u("t",cu(n)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function sx(e,t,r){var a=[Jd,Au("ThreadedComments",null,{xmlns:zu}).replace(/[\/]>/,">")];return e.forEach(function(e){var s="";(e[1]||[]).forEach(function(n,i){if(n.T){n.a&&-1==t.indexOf(n.a)&&t.push(n.a);var o={ref:e[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};0==i?s=o.id:o.parentId=s,n.ID=o.id,n.a&&(o.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(n.a)).slice(-12)+"}"),a.push(Au("threadedComment",_u("text",n.t||""),o))}else delete n.ID})}),a.push("</ThreadedComments>"),a.join("")}var nx=of;function ix(e){var t=zh(),r=[];return Bh(t,628),Bh(t,630),e.forEach(function(e){e[1].forEach(function(e){r.indexOf(e.a)>-1||(r.push(e.a.slice(0,54)),Bh(t,632,function(e){return lf(e.slice(0,54))}(e.a)))})}),Bh(t,631),Bh(t,633),e.forEach(function(e){e[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var s={s:Yh(e[0]),e:Yh(e[0])};Bh(t,635,function(e,t){return null==t&&(t=Fh(36)),t.write_shift(4,e[1].iauthor),_f(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}([s,a])),a.t&&a.t.length>0&&Bh(t,637,hf(a)),Bh(t,636),delete a.iauthor})}),Bh(t,634),Bh(t,629),t.end()}var ox=["xlsb","xlsm","xlam","biff8","xla"];var lx=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(e,r,a,s){var n=!1,i=!1;0==a.length?i=!0:"["==a.charAt(0)&&(i=!0,a=a.slice(1,-1)),0==s.length?n=!0:"["==s.charAt(0)&&(n=!0,s=s.slice(1,-1));var o=a.length>0?0|parseInt(a,10):0,l=s.length>0?0|parseInt(s,10):0;return n?l+=t.c:--l,i?o+=t.r:--o,r+(n?"":"$")+Kh(l)+(i?"":"$")+qh(o)}return function(a,s){return t=s,a.replace(e,r)}}(),cx=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,dx=function(){return function(e,t){return e.replace(cx,function(e,r,a,s,n,i){var o=$h(s)-(a?0:t.c),l=Gh(i)-(n?0:t.r);return r+"R"+(0==l?"":n?l+1:"["+l+"]")+"C"+(0==o?"":a?o+1:"["+o+"]")})}}();function ux(e,t){return e.replace(cx,function(e,r,a,s,n,i){return r+("$"==a?a+s:Kh($h(s)+t.c))+("$"==n?n+i:qh(Gh(i)+t.r))})}function hx(e,t,r){var a=Xh(t).s,s=Yh(r);return ux(e,{r:s.r-a.r,c:s.c-a.c})}function fx(e){return e.replace(/_xlfn\./g,"")}function mx(e){e.l+=1}function px(e,t){var r=e.read_shift(1==t?1:2);return[16383&r,r>>14&1,r>>15&1]}function gx(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return xx(e);12==r.biff&&(a=4)}var s=e.read_shift(a),n=e.read_shift(a),i=px(e,2),o=px(e,2);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:n,c:o[0],cRel:o[1],rRel:o[2]}}}function xx(e){var t=px(e,2),r=px(e,2),a=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function bx(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return function(e){var t=px(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}(e);var a=e.read_shift(r&&12==r.biff?4:2),s=px(e,2);return{r:a,c:s[0],cRel:s[1],rRel:s[2]}}function vx(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:255&r,fQuoted:!!(16384&r),cRel:r>>15,rRel:r>>15}}function yx(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}function wx(e){return[e.read_shift(1),e.read_shift(1)]}function jx(e,t){var r=[e.read_shift(1)];if(12==t)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2}switch(r[0]){case 4:r[1]=Dm(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:r[1]=Uf[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Cf(e);break;case 2:r[1]=Wm(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Nx(e,t,r){for(var a=e.read_shift(12==r.biff?4:2),s=[],n=0;n!=a;++n)s.push((12==r.biff?Tf:ep)(e,8));return s}function kx(e,t,r){var a=0,s=0;12==r.biff?(a=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,0==--s&&(s=256));for(var n=0,i=[];n!=a&&(i[n]=[]);++n)for(var o=0;o!=s;++o)i[n][o]=jx(e,r.biff);return i}function Sx(e,t,r){return e.l+=2,[vx(e)]}function Ex(e){return e.l+=6,[]}function Tx(e){return e.l+=2,[Im(e),1&e.read_shift(2)]}var _x=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];var Cx={1:{n:"PtgExp",f:function(e,t,r){return e.l++,r&&12==r.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(r&&2==r.biff?1:2)]}},2:{n:"PtgTbl",f:Mh},3:{n:"PtgAdd",f:mx},4:{n:"PtgSub",f:mx},5:{n:"PtgMul",f:mx},6:{n:"PtgDiv",f:mx},7:{n:"PtgPower",f:mx},8:{n:"PtgConcat",f:mx},9:{n:"PtgLt",f:mx},10:{n:"PtgLe",f:mx},11:{n:"PtgEq",f:mx},12:{n:"PtgGe",f:mx},13:{n:"PtgGt",f:mx},14:{n:"PtgNe",f:mx},15:{n:"PtgIsect",f:mx},16:{n:"PtgUnion",f:mx},17:{n:"PtgRange",f:mx},18:{n:"PtgUplus",f:mx},19:{n:"PtgUminus",f:mx},20:{n:"PtgPercent",f:mx},21:{n:"PtgParen",f:mx},22:{n:"PtgMissArg",f:mx},23:{n:"PtgStr",f:function(e,t,r){return e.l++,Fm(e,0,r)}},26:{n:"PtgSheet",f:function(e,t,r){return e.l+=5,e.l+=2,e.l+=2==r.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,t,r){return e.l+=2==r.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,Uf[e.read_shift(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function(e){return e.l++,Cf(e)}},32:{n:"PtgArray",f:function(e,t,r){var a=(96&e[e.l++])>>5;return e.l+=2==r.biff?6:12==r.biff?14:7,[a]}},33:{n:"PtgFunc",f:function(e,t,r){var a=(96&e[e.l])>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[Xx[s],Jx[s],a]}},34:{n:"PtgFuncVar",f:function(e,t,r){var a=e[e.l++],s=e.read_shift(1),n=r&&r.biff<=3?[88==a?-1:0,e.read_shift(1)]:function(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[s,(0===n[0]?Jx:Yx)[n[1]]]}},35:{n:"PtgName",f:function(e,t,r){var a=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,n=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[a,0,n]}},36:{n:"PtgRef",f:function(e,t,r){var a=(96&e[e.l])>>5;return e.l+=1,[a,bx(e,0,r)]}},37:{n:"PtgArea",f:function(e,t,r){return[(96&e[e.l++])>>5,gx(e,r.biff>=2&&r.biff,r)]}},38:{n:"PtgMemArea",f:function(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=r&&2==r.biff?3:4,[a,e.read_shift(r&&2==r.biff?1:2)]}},39:{n:"PtgMemErr",f:Mh},40:{n:"PtgMemNoMem",f:Mh},41:{n:"PtgMemFunc",f:function(e,t,r){return[e.read_shift(1)>>>5&3,e.read_shift(r&&2==r.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,12==r.biff&&(e.l+=2),[a]}},43:{n:"PtgAreaErr",f:function(e,t,r){var a=(96&e[e.l++])>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}},44:{n:"PtgRefN",f:function(e,t,r){var a=(96&e[e.l])>>5;e.l+=1;var s=function(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return function(e){var t=e.read_shift(2),r=e.read_shift(1),a=(32768&t)>>15,s=(16384&t)>>14;return t&=16383,1==a&&t>=8192&&(t-=16384),1==s&&r>=128&&(r-=256),{r:t,c:r,cRel:s,rRel:a}}(e);var s=e.read_shift(a>=12?4:2),n=e.read_shift(2),i=(16384&n)>>14,o=(32768&n)>>15;if(n&=16383,1==o)for(;s>524287;)s-=1048576;if(1==i)for(;n>8191;)n-=16384;return{r:s,c:n,cRel:i,rRel:o}}(e,0,r);return[a,s]}},45:{n:"PtgAreaN",f:function(e,t,r){var a=(96&e[e.l++])>>5,s=function(e,t,r){if(r.biff<8)return xx(e);var a=e.read_shift(12==r.biff?4:2),s=e.read_shift(12==r.biff?4:2),n=px(e,2),i=px(e,2);return{s:{r:a,c:n[0],cRel:n[1],rRel:n[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}(e,0,r);return[a,s]}},46:{n:"PtgMemAreaN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function(e,t,r){return 5==r.biff?function(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function(e,t,r){var a=(96&e[e.l])>>5;e.l+=1;var s=e.read_shift(2);return r&&5==r.biff&&(e.l+=12),[a,s,bx(e,0,r)]}},59:{n:"PtgArea3d",f:function(e,t,r){var a=(96&e[e.l++])>>5,s=e.read_shift(2,"i");if(r)switch(r.biff){case 5:e.l+=12;break;case 12:0}return[a,s,gx(e,0,r)]}},60:{n:"PtgRefErr3d",f:function(e,t,r){var a=(96&e[e.l++])>>5,s=e.read_shift(2),n=4;if(r)switch(r.biff){case 5:n=15;break;case 12:n=6}return e.l+=n,[a,s]}},61:{n:"PtgAreaErr3d",f:function(e,t,r){var a=(96&e[e.l++])>>5,s=e.read_shift(2),n=8;if(r)switch(r.biff){case 5:e.l+=12,n=6;break;case 12:n=12}return e.l+=n,[a,s]}},255:{}},Ax={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Dx={1:{n:"PtgElfLel",f:Tx},2:{n:"PtgElfRw",f:Sx},3:{n:"PtgElfCol",f:Sx},6:{n:"PtgElfRwV",f:Sx},7:{n:"PtgElfColV",f:Sx},10:{n:"PtgElfRadical",f:Sx},11:{n:"PtgElfRadicalS",f:Ex},13:{n:"PtgElfColS",f:Ex},15:{n:"PtgElfColSV",f:Ex},16:{n:"PtgElfRadicalLel",f:Tx},25:{n:"PtgList",f:function(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),s=e.read_shift(2),n=e.read_shift(2);return{ixti:t,coltype:3&r,rt:_x[r>>2&31],idx:a,c:s,C:n}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e.read_shift(4)]}},255:{}},Px={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,t,r){var a=255&e[e.l+1]?1:0;return e.l+=r&&2==r.biff?3:4,[a]}},2:{n:"PtgAttrIf",f:function(e,t,r){var a=255&e[e.l+1]?1:0;return e.l+=2,[a,e.read_shift(r&&2==r.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,t,r){e.l+=2;for(var a=e.read_shift(r&&2==r.biff?1:2),s=[],n=0;n<=a;++n)s.push(e.read_shift(r&&2==r.biff?1:2));return s}},8:{n:"PtgAttrGoto",f:function(e,t,r){var a=255&e[e.l+1]?1:0;return e.l+=2,[a,e.read_shift(r&&2==r.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,t,r){e.l+=r&&2==r.biff?3:4}},32:{n:"PtgAttrBaxcel",f:yx},33:{n:"PtgAttrBaxcel",f:yx},64:{n:"PtgAttrSpace",f:function(e){return e.read_shift(2),wx(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e.read_shift(2),wx(e)}},128:{n:"PtgAttrIfError",f:function(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e.read_shift(2)]}},255:{}};function Ix(e,t,r,a){if(a.biff<8)return Mh(e,t);for(var s=e.l+t,n=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=kx(e,0,a),n.push(r[i][1]);break;case"PtgMemArea":r[i][2]=Nx(e,r[i][1],a),n.push(r[i][2]);break;case"PtgExp":a&&12==a.biff&&(r[i][1][1]=e.read_shift(4),n.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return 0!==(t=s-e.l)&&n.push(Mh(e,t)),n}function Ox(e,t,r){for(var a,s,n=e.l+t,i=[];n!=e.l;)t=n-e.l,s=e[e.l],a=Cx[s]||Cx[Ax[s]],24!==s&&25!==s||(a=(24===s?Dx:Px)[e[e.l+1]]),a&&a.f?i.push([a.n,a.f(e,t,r)]):Mh(e,t);return i}function Rx(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],s=[],n=0;n<a.length;++n){var i=a[n];if(i)if(2===i[0])s.push('"'+i[1].replace(/"/g,'""')+'"');else s.push(i[1]);else s.push("")}t.push(s.join(","))}return t.join(";")}var Mx={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Fx(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),0==t?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[a[0]][0]){case 357:return s=-1==a[1]?"#REF":e.SheetNames[a[1]],a[1]==a[2]?s:s+":"+e.SheetNames[a[2]];case 358:return null!=r.SID?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return s=-1==a[1]?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?s:s+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(e){return e.Name}).join(";;");default:return e[a[0]][0][3]?(s=-1==a[1]?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?s:s+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function Lx(e,t,r){var a=Fx(e,t,r);return"#REF"==a?a:function(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}(a,r)}function zx(e,t,r,a,s){var n,i,o,l,c=s&&s.biff||8,d={s:{c:0,r:0},e:{c:0,r:0}},u=[],h=0,f=0,m="";if(!e[0]||!e[0][0])return"";for(var p=-1,g="",x=0,b=e[0].length;x<b;++x){var v=e[0][x];switch(v[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(n=u.pop(),i=u.pop(),p>=0){switch(e[0][p][1][0]){case 0:g=Id(" ",e[0][p][1][1]);break;case 1:g=Id("\r",e[0][p][1][1]);break;default:if(g="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}i+=g,p=-1}u.push(i+Mx[v[0]]+n);break;case"PtgIsect":n=u.pop(),i=u.pop(),u.push(i+" "+n);break;case"PtgUnion":n=u.pop(),i=u.pop(),u.push(i+","+n);break;case"PtgRange":n=u.pop(),i=u.pop(),u.push(i+":"+n);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":o=Uh(v[1][1],d,s),u.push(Hh(o,c));break;case"PtgRefN":o=r?Uh(v[1][1],r,s):v[1][1],u.push(Hh(o,c));break;case"PtgRef3d":h=v[1][1],o=Uh(v[1][2],d,s);m=Lx(a,h,s);u.push(m+"!"+Hh(o,c));break;case"PtgFunc":case"PtgFuncVar":var y=v[1][0],w=v[1][1];y||(y=0);var j=0==(y&=127)?[]:u.slice(-y);u.length-=y,"User"===w&&(w=j.shift()),u.push(w+"("+j.join(",")+")");break;case"PtgBool":u.push(v[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":u.push(v[1]);break;case"PtgNum":u.push(String(v[1]));break;case"PtgStr":u.push('"'+v[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":l=Wh(v[1][1],r?{s:r}:d,s),u.push(Vh(l,s));break;case"PtgArea":l=Wh(v[1][1],d,s),u.push(Vh(l,s));break;case"PtgArea3d":h=v[1][1],l=v[1][2],m=Lx(a,h,s),u.push(m+"!"+Vh(l,s));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgName":f=v[1][2];var N=(a.names||[])[f-1]||(a[0]||[])[f],k=N?N.Name:"SH33TJSNAME"+String(f);k&&"_xlfn."==k.slice(0,6)&&!s.xlfn&&(k=k.slice(6)),u.push(k);break;case"PtgNameX":var S,E=v[1][1];if(f=v[1][2],!(s.biff<=5)){var T="";if(14849==((a[E]||[])[0]||[])[0]||(1025==((a[E]||[])[0]||[])[0]?a[E][f]&&a[E][f].itab>0&&(T=a.SheetNames[a[E][f].itab-1]+"!"):T=a.SheetNames[f-1]+"!"),a[E]&&a[E][f])T+=a[E][f].Name;else if(a[0]&&a[0][f])T+=a[0][f].Name;else{var _=(Fx(a,E,s)||"").split(";;");_[f-1]?T=_[f-1]:T+="SH33TJSERRX"}u.push(T);break}E<0&&(E=-E),a[E]&&(S=a[E][f]),S||(S={Name:"SH33TJSERRY"}),u.push(S.Name);break;case"PtgParen":var C="(",A=")";if(p>=0){switch(g="",e[0][p][1][0]){case 2:C=Id(" ",e[0][p][1][1])+C;break;case 3:C=Id("\r",e[0][p][1][1])+C;break;case 4:A=Id(" ",e[0][p][1][1])+A;break;case 5:A=Id("\r",e[0][p][1][1])+A;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}u.push(C+u.pop()+A);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":u.push("#REF!");break;case"PtgExp":o={c:v[1][1],r:v[1][0]};var D={c:r.c,r:r.r};if(a.sharedf[Jh(o)]){var P=a.sharedf[Jh(o)];u.push(zx(P,d,D,a,s))}else{var I=!1;for(n=0;n!=a.arrayf.length;++n)if(i=a.arrayf[n],!(o.c<i[0].s.c||o.c>i[0].e.c)&&!(o.r<i[0].s.r||o.r>i[0].e.r)){u.push(zx(i[1],d,D,a,s)),I=!0;break}I||u.push(v[1])}break;case"PtgArray":u.push("{"+Rx(v[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=x;break;case"PtgMissArg":u.push("");break;case"PtgList":u.push("Table"+v[1].idx+"[#"+v[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(v))}if(3!=s.biff&&p>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][x][0])){var O=!0;switch((v=e[0][p])[1][0]){case 4:O=!1;case 0:g=Id(" ",v[1][1]);break;case 5:O=!1;case 1:g=Id("\r",v[1][1]);break;default:if(g="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+v[1][0])}u.push((O?g:"")+u.pop()+(O?"":g)),p=-1}}if(u.length>1&&s.WTF)throw new Error("bad formula stack");return u[0]}function Bx(e,t,r){var a,s=e.l+t,n=2==r.biff?1:2,i=e.read_shift(n);if(65535==i)return[[],Mh(e,t-2)];var o=Ox(e,i,r);return t!==i+n&&(a=Ix(e,t-i-n,o,r)),e.l=s,[o,a]}function Ux(e,t,r){var a,s=e.l+t,n=e.read_shift(2),i=Ox(e,n,r);return 65535==n?[[],Mh(e,t-2)]:(t!==n+2&&(a=Ix(e,s-n-2,i,r)),[i,a])}function Wx(e,t,r){var a=e.l+t,s=Jm(e);2==r.biff&&++e.l;var n=function(e){var t;if(65535!==kh(e,e.l+6))return[Cf(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=1===e[e.l+2],e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}(e),i=e.read_shift(1);2!=r.biff&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=function(e,t,r){var a,s=e.l+t,n=2==r.biff?1:2,i=e.read_shift(n);if(65535==i)return[[],Mh(e,t-2)];var o=Ox(e,i,r);return t!==i+n&&(a=Ix(e,t-i-n,o,r)),e.l=s,[o,a]}(e,a-e.l,r);return{cell:s,val:n[0],formula:o,shared:i>>3&1,tt:n[1]}}function Hx(e,t,r,a,s){var n=Xm(t,r,s),i=function(e){if(null==e){var t=Fh(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}return Af("number"==typeof e?e:0)}(e.v),o=Fh(6);o.write_shift(2,33),o.write_shift(4,0);for(var l=Fh(e.bf.length),c=0;c<e.bf.length;++c)l[c]=e.bf[c];return mc([n,i,o,l])}function Vx(e,t,r){var a=e.read_shift(4),s=Ox(e,a,r),n=e.read_shift(4);return[s,n>0?Ix(e,n,s,r):null]}var Gx=Vx,qx=Vx,$x=Vx,Kx=Vx,Yx={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Jx={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Xx={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Qx(e){return"of:"==e.slice(0,3)&&(e=e.slice(3)),61==e.charCodeAt(0)&&61==(e=e.slice(1)).charCodeAt(0)&&(e=e.slice(1)),(e=(e=(e=e.replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,t){return t.replace(/\./g,"")})).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function Zx(e){return("of:="+e.replace(cx,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")}function eb(e){var t=e.split(":");return[t[0].split(".")[0],t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function tb(e){return e.replace(/\./,"!")}var rb={},ab={},sb="undefined"!==typeof Map;function nb(e,t,r){var a=0,s=e.length;if(r){if(sb?r.has(t):Object.prototype.hasOwnProperty.call(r,t))for(var n=sb?r.get(t):r[t];a<n.length;++a)if(e[n[a]].t===t)return e.Count++,n[a]}else for(;a<s;++a)if(e[a].t===t)return e.Count++,a;return e[s]={t:t},e.Count++,e.Unique++,r&&(sb?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function ib(e,t){var r={min:e+1,max:e+1},a=-1;return t.MDW&&(ug=t.MDW),null!=t.width?r.customWidth=1:null!=t.wpx?a=fg(t.wpx):null!=t.wch&&(a=t.wch),a>-1?(r.width=mg(a),r.customWidth=1):null!=t.width&&(r.width=t.width),t.hidden&&(r.hidden=!0),null!=t.level&&(r.outlineLevel=r.level=t.level),r}function ob(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];"xlml"==t&&(r=[1,1,1,1,.5,.5]),null==e.left&&(e.left=r[0]),null==e.right&&(e.right=r[1]),null==e.top&&(e.top=r[2]),null==e.bottom&&(e.bottom=r[3]),null==e.header&&(e.header=r[4]),null==e.footer&&(e.footer=r[5])}}function lb(e,t,r){var a=r.revssf[null!=t.z?t.z:"General"],s=60,n=e.length;if(null==a&&r.ssf)for(;s<392;++s)if(null==r.ssf[s]){nd(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=a=s;break}for(s=0;s!=n;++s)if(e[s].numFmtId===a)return s;return e[n]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},n}function cb(e,t,r,a,s,n){try{a.cellNF&&(e.z=Ec[t])}catch(bN){if(a.WTF)throw bN}if("z"!==e.t||a.cellStyles){if("d"===e.t&&"string"===typeof e.v&&(e.v=Ad(e.v)),(!a||!1!==a.cellText)&&"z"!==e.t)try{if(null==Ec[t]&&nd(cd[t]||"General",t),"e"===e.t)e.w=e.w||Uf[e.v];else if(0===t)if("n"===e.t)(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Mc(e.v);else if("d"===e.t){var i=wd(e.v);e.w=(0|i)===i?i.toString(10):Mc(i)}else{if(void 0===e.v)return"";e.w=Fc(e.v,ab)}else"d"===e.t?e.w=sd(t,wd(e.v),ab):e.w=sd(t,e.v,ab)}catch(bN){if(a.WTF)throw bN}if(a.cellStyles&&null!=r)try{e.s=n.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=dg(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=dg(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(bN){if(a.WTF&&n.Fills)throw bN}}}function db(e,t,r){if(e&&e["!ref"]){var a=Zh(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}var ub=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,hb=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,fb=/<(?:\w:)?hyperlink [^>]*>/gm,mb=/"(\w*:\w*)"/,pb=/<(?:\w:)?col\b[^>]*[\/]?>/g,gb=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,xb=/<(?:\w:)?pageMargins[^>]*\/>/g,bb=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,vb=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,yb=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function wb(e,t,r,a,s,n,i){if(!e)return e;a||(a={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",d="",u=e.match(hb);u?(c=e.slice(0,u.index),d=e.slice(u.index+u[0].length)):c=d=e;var h=c.match(bb);h?jb(h[0],o,s,r):(h=c.match(vb))&&function(e,t,r,a,s){jb(e.slice(0,e.indexOf(">")),r,a,s)}(h[0],h[1],o,s,r);var f=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(f>0){var m=c.slice(f,f+50).match(mb);m&&function(e,t){var r=Zh(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Qh(r))}(o,m[1])}var p=c.match(yb);p&&p[1]&&function(e,t){t.Views||(t.Views=[{}]);(e.match(Sb)||[]).forEach(function(e,r){var a=ru(e);t.Views[r]||(t.Views[r]={}),+a.zoomScale&&(t.Views[r].zoom=+a.zoomScale),mu(a.rightToLeft)&&(t.Views[r].RTL=!0)})}(p[1],s);var g=[];if(t.cellStyles){var x=c.match(pb);x&&function(e,t){for(var r=!1,a=0;a!=t.length;++a){var s=ru(t[a],!0);s.hidden&&(s.hidden=mu(s.hidden));var n=parseInt(s.min,10)-1,i=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,gg(s.width)),xg(s);n<=i;)e[n++]=Pd(s)}}(g,x)}u&&Tb(u[1],o,t,l,n,i);var b=d.match(gb);b&&(o["!autofilter"]=function(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}(b[0]));var v=[],y=d.match(ub);if(y)for(f=0;f!=y.length;++f)v[f]=Zh(y[f].slice(y[f].indexOf('"')+1));var w=d.match(fb);w&&function(e,t,r){for(var a=Array.isArray(e),s=0;s!=t.length;++s){var n=ru(vu(t[s]),!0);if(!n.ref)return;var i=((r||{})["!id"]||[])[n.id];i?(n.Target=i.Target,n.location&&(n.Target+="#"+iu(n.location))):(n.Target="#"+iu(n.location),i={Target:n.Target,TargetMode:"Internal"}),n.Rel=i,n.tooltip&&(n.Tooltip=n.tooltip,delete n.tooltip);for(var o=Zh(n.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var d=Jh({c:c,r:l});a?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=n):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=n)}}}(o,w,a);var j=d.match(xb);if(j&&(o["!margins"]=function(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}(ru(j[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=Qh(l)),t.sheetRows>0&&o["!ref"]){var N=Zh(o["!ref"]);t.sheetRows<=+N.e.r&&(N.e.r=t.sheetRows-1,N.e.r>l.e.r&&(N.e.r=l.e.r),N.e.r<N.s.r&&(N.s.r=N.e.r),N.e.c>l.e.c&&(N.e.c=l.e.c),N.e.c<N.s.c&&(N.s.c=N.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Qh(N))}return g.length>0&&(o["!cols"]=g),v.length>0&&(o["!merges"]=v),o}function jb(e,t,r,a){var s=ru(e);r.Sheets[a]||(r.Sheets[a]={}),s.codeName&&(r.Sheets[a].CodeName=iu(vu(s.codeName)))}var Nb=["objects","scenarios","selectLockedCells","selectUnlockedCells"],kb=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];var Sb=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Eb(e,t,r,a){if(e.c&&r["!comments"].push([t,e.c]),void 0===e.v&&"string"!==typeof e.f||"z"===e.t&&!e.f)return"";var s="",n=e.t,i=e.v;if("z"!==e.t)switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=Uf[e.v];break;case"d":a&&a.cellDates?s=Ad(e.v,-1).toISOString():((e=Pd(e)).t="n",s=""+(e.v=wd(Ad(e.v)))),"undefined"===typeof e.z&&(e.z=Ec[14]);break;default:s=e.v}var o=_u("v",cu(s)),l={r:t},c=lb(a.cellXfs,e,a);switch(0!==c&&(l.s=c),e.t){case"n":case"z":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;default:if(null==e.v){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){o=_u("v",""+nb(a.Strings,e.v,a.revStrings)),l.t="s";break}l.t="str"}if(e.t!=n&&(e.t=n,e.v=i),"string"==typeof e.f&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Au("f",cu(e.f),d)+(null!=e.v?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),Au("c",o,l)}var Tb=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,n=wu("v"),i=wu("f");return function(o,l,c,d,u,h){for(var f,m,p,g,x,b=0,v="",y=[],w=[],j=0,N=0,k=0,S="",E=0,T=0,_=0,C=0,A=Array.isArray(h.CellXf),D=[],P=[],I=Array.isArray(l),O=[],R={},M=!1,F=!!c.sheetStubs,L=o.split(t),z=0,B=L.length;z!=B;++z){var U=(v=L[z].trim()).length;if(0!==U){var W=0;e:for(b=0;b<U;++b)switch(v[b]){case">":if("/"!=v[b-1]){++b;break e}if(c&&c.cellStyles){if(E=null!=(m=ru(v.slice(W,b),!0)).r?parseInt(m.r,10):E+1,T=-1,c.sheetRows&&c.sheetRows<E)continue;R={},M=!1,m.ht&&(M=!0,R.hpt=parseFloat(m.ht),R.hpx=yg(R.hpt)),"1"==m.hidden&&(M=!0,R.hidden=!0),null!=m.outlineLevel&&(M=!0,R.level=+m.outlineLevel),M&&(O[E-1]=R)}break;case"<":W=b}if(W>=b)break;if(E=null!=(m=ru(v.slice(W,b),!0)).r?parseInt(m.r,10):E+1,T=-1,!(c.sheetRows&&c.sheetRows<E)){d.s.r>E-1&&(d.s.r=E-1),d.e.r<E-1&&(d.e.r=E-1),c&&c.cellStyles&&(R={},M=!1,m.ht&&(M=!0,R.hpt=parseFloat(m.ht),R.hpx=yg(R.hpt)),"1"==m.hidden&&(M=!0,R.hidden=!0),null!=m.outlineLevel&&(M=!0,R.level=+m.outlineLevel),M&&(O[E-1]=R)),y=v.slice(b).split(e);for(var H=0;H!=y.length&&"<"==y[H].trim().charAt(0);++H);for(y=y.slice(H),b=0;b!=y.length;++b)if(0!==(v=y[b].trim()).length){if(w=v.match(r),j=b,N=0,k=0,v="<c "+("<"==v.slice(0,1)?">":"")+v,null!=w&&2===w.length){for(j=0,S=w[1],N=0;N!=S.length&&!((k=S.charCodeAt(N)-64)<1||k>26);++N)j=26*j+k;T=--j}else++T;for(N=0;N!=v.length&&62!==v.charCodeAt(N);++N);if(++N,(m=ru(v.slice(0,N),!0)).r||(m.r=Jh({r:E-1,c:T})),f={t:""},null!=(w=(S=v.slice(N)).match(n))&&""!==w[1]&&(f.v=iu(w[1])),c.cellFormula){if(null!=(w=S.match(i))&&""!==w[1]){if(f.f=iu(vu(w[1])).replace(/\r\n/g,"\n"),c.xlfn||(f.f=fx(f.f)),w[0].indexOf('t="array"')>-1)f.F=(S.match(s)||[])[1],f.F.indexOf(":")>-1&&D.push([Zh(f.F),f.F]);else if(w[0].indexOf('t="shared"')>-1){g=ru(w[0]);var V=iu(vu(w[1]));c.xlfn||(V=fx(V)),P[parseInt(g.si,10)]=[g,V,m.r]}}else(w=S.match(/<f[^>]*\/>/))&&P[(g=ru(w[0])).si]&&(f.f=hx(P[g.si][1],P[g.si][2],m.r));var G=Yh(m.r);for(N=0;N<D.length;++N)G.r>=D[N][0].s.r&&G.r<=D[N][0].e.r&&G.c>=D[N][0].s.c&&G.c<=D[N][0].e.c&&(f.F=D[N][1])}if(null==m.t&&void 0===f.v)if(f.f||f.F)f.v=0,f.t="n";else{if(!F)continue;f.t="z"}else f.t=m.t||"n";switch(d.s.c>T&&(d.s.c=T),d.e.c<T&&(d.e.c=T),f.t){case"n":if(""==f.v||null==f.v){if(!F)continue;f.t="z"}else f.v=parseFloat(f.v);break;case"s":if("undefined"==typeof f.v){if(!F)continue;f.t="z"}else p=rb[parseInt(f.v,10)],f.v=p.t,f.r=p.r,c.cellHTML&&(f.h=p.h);break;case"str":f.t="s",f.v=null!=f.v?vu(f.v):"",c.cellHTML&&(f.h=hu(f.v));break;case"inlineStr":w=S.match(a),f.t="s",null!=w&&(p=Up(w[1]))?(f.v=p.t,c.cellHTML&&(f.h=p.h)):f.v="";break;case"b":f.v=mu(f.v);break;case"d":c.cellDates?f.v=Ad(f.v,1):(f.v=wd(Ad(f.v,1)),f.t="n");break;case"e":c&&!1===c.cellText||(f.w=f.v),f.v=Wf[f.v]}if(_=C=0,x=null,A&&void 0!==m.s&&null!=(x=h.CellXf[m.s])&&(null!=x.numFmtId&&(_=x.numFmtId),c.cellStyles&&null!=x.fillId&&(C=x.fillId)),cb(f,_,C,c,u,h),c.cellDates&&A&&"n"==f.t&&ed(Ec[_])&&(f.t="d",f.v=Sd(f.v)),m.cm&&c.xlmeta){var q=(c.xlmeta.Cell||[])[+m.cm-1];q&&"XLDAPR"==q.type&&(f.D=!0)}if(I){var $=Yh(m.r);l[$.r]||(l[$.r]=[]),l[$.r][$.c]=f}else l[m.r]=f}}}}O.length>0&&(l["!rows"]=O)}}();function _b(e,t,r,a){var s,n=[Jd,Au("worksheet",null,{xmlns:$u[0],"xmlns:r":Hu})],i=r.SheetNames[e],o="",l=r.Sheets[i];null==l&&(l={});var c=l["!ref"]||"A1",d=Zh(c);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),c=Qh(d)}a||(a={}),l["!comments"]=[];var u=[];!function(e,t,r,a,s){var n=!1,i={},o=null;if("xlsx"!==a.bookType&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch(bN){}n=!0,i.codeName=yu(cu(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+Au("outlinePr",null,c)}(n||o)&&(s[s.length]=Au("sheetPr",o,i))}(l,r,e,t,n),n[n.length]=Au("dimension",null,{ref:c}),n[n.length]=function(e,t,r,a){var s={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),Au("sheetViews",Au("sheetView",null,s),{})}(0,0,0,r),t.sheetFormat&&(n[n.length]=Au("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),null!=l["!cols"]&&l["!cols"].length>0&&(n[n.length]=function(e,t){for(var r,a=["<cols>"],s=0;s!=t.length;++s)(r=t[s])&&(a[a.length]=Au("col",null,ib(s,r)));return a[a.length]="</cols>",a.join("")}(0,l["!cols"])),n[s=n.length]="<sheetData/>",l["!links"]=[],null!=l["!ref"]&&(o=function(e,t){var r,a,s=[],n=[],i=Zh(e["!ref"]),o="",l="",c=[],d=0,u=0,h=e["!rows"],f=Array.isArray(e),m={r:l},p=-1;for(u=i.s.c;u<=i.e.c;++u)c[u]=Kh(u);for(d=i.s.r;d<=i.e.r;++d){for(n=[],l=qh(d),u=i.s.c;u<=i.e.c;++u){r=c[u]+l;var g=f?(e[d]||[])[u]:e[r];void 0!==g&&null!=(o=Eb(g,r,e,t))&&n.push(o)}(n.length>0||h&&h[d])&&(m={r:l},h&&h[d]&&((a=h[d]).hidden&&(m.hidden=1),p=-1,a.hpx?p=vg(a.hpx):a.hpt&&(p=a.hpt),p>-1&&(m.ht=p,m.customHeight=1),a.level&&(m.outlineLevel=a.level)),s[s.length]=Au("row",n.join(""),m))}if(h)for(;d<h.length;++d)h&&h[d]&&(m={r:d+1},(a=h[d]).hidden&&(m.hidden=1),p=-1,a.hpx?p=vg(a.hpx):a.hpt&&(p=a.hpt),p>-1&&(m.ht=p,m.customHeight=1),a.level&&(m.outlineLevel=a.level),s[s.length]=Au("row","",m));return s.join("")}(l,t,0,0),o.length>0&&(n[n.length]=o)),n.length>s+1&&(n[n.length]="</sheetData>",n[s]=n[s].replace("/>",">")),l["!protect"]&&(n[n.length]=function(e){var t={sheet:1};return Nb.forEach(function(r){null!=e[r]&&e[r]&&(t[r]="1")}),kb.forEach(function(r){null==e[r]||e[r]||(t[r]="0")}),e.password&&(t.password=sg(e.password).toString(16).toUpperCase()),Au("sheetProtection",null,t)}(l["!protect"])),null!=l["!autofilter"]&&(n[n.length]=function(e,t,r,a){var s="string"==typeof e.ref?e.ref:Qh(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var n=r.Workbook.Names,i=Xh(s);i.s.r==i.e.r&&(i.e.r=Xh(t["!ref"]).e.r,s=Qh(i));for(var o=0;o<n.length;++o){var l=n[o];if("_xlnm._FilterDatabase"==l.Name&&l.Sheet==a){l.Ref="'"+r.SheetNames[a]+"'!"+s;break}}return o==n.length&&n.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+s}),Au("autoFilter",null,{ref:s})}(l["!autofilter"],l,r,e)),null!=l["!merges"]&&l["!merges"].length>0&&(n[n.length]=function(e){if(0===e.length)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Qh(e[r])+'"/>';return t+"</mergeCells>"}(l["!merges"]));var h,f,m=-1,p=-1;return l["!links"].length>0&&(n[n.length]="<hyperlinks>",l["!links"].forEach(function(e){e[1].Target&&(h={ref:e[0]},"#"!=e[1].Target.charAt(0)&&(p=Jf(a,-1,cu(e[1].Target).replace(/#.*$/,""),qf.HLINK),h["r:id"]="rId"+p),(m=e[1].Target.indexOf("#"))>-1&&(h.location=cu(e[1].Target.slice(m+1))),e[1].Tooltip&&(h.tooltip=cu(e[1].Tooltip)),n[n.length]=Au("hyperlink",null,h))}),n[n.length]="</hyperlinks>"),delete l["!links"],null!=l["!margins"]&&(n[n.length]=(ob(f=l["!margins"]),Au("pageMargins",null,f))),t&&!t.ignoreEC&&void 0!=t.ignoreEC||(n[n.length]=_u("ignoredErrors",Au("ignoredError",null,{numberStoredAsText:1,sqref:c}))),u.length>0&&(p=Jf(a,-1,"../drawings/drawing"+(e+1)+".xml",qf.DRAW),n[n.length]=Au("drawing",null,{"r:id":"rId"+p}),l["!drawing"]=u),l["!comments"].length>0&&(p=Jf(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",qf.VML),n[n.length]=Au("legacyDrawing",null,{"r:id":"rId"+p}),l["!legacy"]=p),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function Cb(e,t,r,a){var s=function(e,t,r){var a=Fh(145),s=(r["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var n=320;s.hpx?n=20*vg(s.hpx):s.hpt&&(n=20*s.hpt),a.write_shift(2,n),a.write_shift(1,0);var i=0;s.level&&(i|=s.level),s.hidden&&(i|=16),(s.hpx||s.hpt)&&(i|=32),a.write_shift(1,i),a.write_shift(1,0);var o=0,l=a.l;a.l+=4;for(var c={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var u=-1,h=-1,f=d<<10;f<d+1<<10;++f)c.c=f,(Array.isArray(r)?(r[c.r]||[])[c.c]:r[Jh(c)])&&(u<0&&(u=f),h=f);u<0||(++o,a.write_shift(4,u),a.write_shift(4,h))}var m=a.l;return a.l=l,a.write_shift(4,o),a.l=m,a.length>a.l?a.slice(0,a.l):a}(a,r,t);(s.length>17||(t["!rows"]||[])[a])&&Bh(e,0,s)}var Ab=Tf,Db=_f;function Pb(e){return[pf(e),Cf(e),"n"]}var Ib=Tf,Ob=_f;var Rb=["left","right","top","bottom","header","footer"];function Mb(e,t,r,a,s,n,i){if(void 0===t.v)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":(t=Pd(t)).z=t.z||Ec[14],t.v=wd(Ad(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v}var l={r:r,c:a};switch(l.s=lb(s.cellXfs,t,s),t.l&&n["!links"].push([Jh(l),t.l]),t.c&&n["!comments"].push([Jh(l),t.c]),t.t){case"s":case"str":return s.bookSST?(o=nb(s.Strings,t.v,s.revStrings),l.t="s",l.v=o,i?Bh(e,18,function(e,t,r){return null==r&&(r=Fh(8)),gf(t,r),r.write_shift(4,t.v),r}(0,l)):Bh(e,7,function(e,t,r){return null==r&&(r=Fh(12)),mf(t,r),r.write_shift(4,t.v),r}(0,l))):(l.t="str",i?Bh(e,17,function(e,t,r){return null==r&&(r=Fh(8+4*e.v.length)),gf(t,r),lf(e.v,r),r.length>r.l?r.slice(0,r.l):r}(t,l)):Bh(e,6,function(e,t,r){return null==r&&(r=Fh(12+4*e.v.length)),mf(t,r),lf(e.v,r),r.length>r.l?r.slice(0,r.l):r}(t,l))),!0;case"n":return t.v==(0|t.v)&&t.v>-1e3&&t.v<1e3?i?Bh(e,13,function(e,t,r){return null==r&&(r=Fh(8)),gf(t,r),Sf(e.v,r),r}(t,l)):Bh(e,2,function(e,t,r){return null==r&&(r=Fh(12)),mf(t,r),Sf(e.v,r),r}(t,l)):i?Bh(e,16,function(e,t,r){return null==r&&(r=Fh(12)),gf(t,r),Af(e.v,r),r}(t,l)):Bh(e,5,function(e,t,r){return null==r&&(r=Fh(16)),mf(t,r),Af(e.v,r),r}(t,l)),!0;case"b":return l.t="b",i?Bh(e,15,function(e,t,r){return null==r&&(r=Fh(5)),gf(t,r),r.write_shift(1,e.v?1:0),r}(t,l)):Bh(e,4,function(e,t,r){return null==r&&(r=Fh(9)),mf(t,r),r.write_shift(1,e.v?1:0),r}(t,l)),!0;case"e":return l.t="e",i?Bh(e,14,function(e,t,r){return null==r&&(r=Fh(8)),gf(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}(t,l)):Bh(e,3,function(e,t,r){return null==r&&(r=Fh(9)),mf(t,r),r.write_shift(1,e.v),r}(t,l)),!0}return i?Bh(e,12,function(e,t,r){return null==r&&(r=Fh(4)),gf(t,r)}(0,l)):Bh(e,1,function(e,t,r){return null==r&&(r=Fh(8)),mf(t,r)}(0,l)),!0}function Fb(e,t){var r,a;t&&t["!merges"]&&(Bh(e,177,(r=t["!merges"].length,null==a&&(a=Fh(4)),a.write_shift(4,r),a)),t["!merges"].forEach(function(t){Bh(e,176,Ob(t))}),Bh(e,178))}function Lb(e,t){t&&t["!cols"]&&(Bh(e,390),t["!cols"].forEach(function(t,r){t&&Bh(e,60,function(e,t,r){null==r&&(r=Fh(18));var a=ib(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,256*(a.width||10)),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),"number"==typeof a.width&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}(r,t))}),Bh(e,391))}function zb(e,t){t&&t["!ref"]&&(Bh(e,648),Bh(e,649,function(e){var t=Fh(24);return t.write_shift(4,4),t.write_shift(4,1),_f(e,t),t}(Zh(t["!ref"]))),Bh(e,650))}function Bb(e,t,r){t["!links"].forEach(function(t){if(t[1].Target){var a=Jf(r,-1,t[1].Target.replace(/#.*$/,""),qf.HLINK);Bh(e,494,function(e,t){var r=Fh(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));_f({s:Yh(e[0]),e:Yh(e[0])},r),Nf("rId"+t,r);var a=e[1].Target.indexOf("#");return lf((-1==a?"":e[1].Target.slice(a+1))||"",r),lf(e[1].Tooltip||"",r),lf("",r),r.slice(0,r.l)}(t,a))}}),delete t["!links"]}function Ub(e,t,r){Bh(e,133),Bh(e,137,function(e,t,r){null==r&&(r=Fh(30));var a=924;return(((t||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}(0,r)),Bh(e,138),Bh(e,134)}function Wb(e,t){var r,a;t["!protect"]&&Bh(e,535,(r=t["!protect"],null==a&&(a=Fh(66)),a.write_shift(2,r.password?sg(r.password):0),a.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){e[1]?a.write_shift(4,null==r[e[0]]||r[e[0]]?0:1):a.write_shift(4,null!=r[e[0]]&&r[e[0]]?0:1)}),a))}function Hb(e,t,r,a){var s=zh(),n=r.SheetNames[e],i=r.Sheets[n]||{},o=n;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch(bN){}var l,c,d=Zh(i["!ref"]||"A1");if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],Bh(s,129),(r.vbaraw||i["!outline"])&&Bh(s,147,function(e,t,r){null==r&&(r=Fh(84+4*e.length));var a=192;t&&(t.above&&(a&=-65),t.left&&(a&=-129)),r.write_shift(1,a);for(var s=1;s<3;++s)r.write_shift(1,0);return Df({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),bf(e,r),r.slice(0,r.l)}(o,i["!outline"])),Bh(s,148,Db(d)),Ub(s,0,r.Workbook),Lb(s,i),function(e,t,r,a){var s,n=Zh(t["!ref"]||"A1"),i="",o=[];Bh(e,145);var l=Array.isArray(t),c=n.e.r;t["!rows"]&&(c=Math.max(n.e.r,t["!rows"].length-1));for(var d=n.s.r;d<=c;++d){i=qh(d),Cb(e,t,n,d);var u=!1;if(d<=n.e.r)for(var h=n.s.c;h<=n.e.c;++h){d===n.s.r&&(o[h]=Kh(h)),s=o[h]+i;var f=l?(t[d]||[])[h]:t[s];u=!!f&&Mb(e,f,d,h,a,t,u)}}Bh(e,146)}(s,i,0,t),Wb(s,i),function(e,t,r,a){if(t["!autofilter"]){var s=t["!autofilter"],n="string"===typeof s.ref?s.ref:Qh(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=Xh(n);o.s.r==o.e.r&&(o.e.r=Xh(t["!ref"]).e.r,n=Qh(o));for(var l=0;l<i.length;++l){var c=i[l];if("_xlnm._FilterDatabase"==c.Name&&c.Sheet==a){c.Ref="'"+r.SheetNames[a]+"'!"+n;break}}l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+n}),Bh(e,161,_f(Zh(n))),Bh(e,162)}}(s,i,r,e),Fb(s,i),Bb(s,i,a),i["!margins"]&&Bh(s,476,(l=i["!margins"],null==c&&(c=Fh(48)),ob(l),Rb.forEach(function(e){Af(l[e],c)}),c)),t&&!t.ignoreEC&&void 0!=t.ignoreEC||zb(s,i),function(e,t,r,a){if(t["!comments"].length>0){var s=Jf(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",qf.VML);Bh(e,551,Nf("rId"+s)),t["!legacy"]=s}}(s,i,e,a),Bh(s,130),s.end()}function Vb(e,t,r,a,s,n){var i=n||{"!type":"chart"};if(!e)return n;var o=0,l=0,c="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(e){var t=function(e){var t,r=[],a=e.match(/^<c:numCache>/);(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach(function(e){var t=e.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);t&&(r[+t[1]]=a?+t[2]:t[2])});var s=iu((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach(function(e){t=e.replace(/<.*?>/g,"")}),[r,s,t]}(e);d.s.r=d.s.c=0,d.e.c=o,c=Kh(o),t[0].forEach(function(e,r){i[c+qh(r)]={t:"n",v:e,z:t[1]},l=r}),d.e.r<l&&(d.e.r=l),++o}),o>0&&(i["!ref"]=Qh(d)),i}var Gb=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],qb=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],$b=[],Kb=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Yb(e,t){for(var r=0;r!=e.length;++r)for(var a=e[r],s=0;s!=t.length;++s){var n=t[s];if(null==a[n[0]])a[n[0]]=n[1];else switch(n[2]){case"bool":"string"==typeof a[n[0]]&&(a[n[0]]=mu(a[n[0]]));break;case"int":"string"==typeof a[n[0]]&&(a[n[0]]=parseInt(a[n[0]],10))}}}function Jb(e,t){for(var r=0;r!=t.length;++r){var a=t[r];if(null==e[a[0]])e[a[0]]=a[1];else switch(a[2]){case"bool":"string"==typeof e[a[0]]&&(e[a[0]]=mu(e[a[0]]));break;case"int":"string"==typeof e[a[0]]&&(e[a[0]]=parseInt(e[a[0]],10))}}}function Xb(e){Jb(e.WBProps,Gb),Jb(e.CalcPr,Kb),Yb(e.WBView,qb),Yb(e.Sheets,$b),ab.date1904=mu(e.WBProps.date1904)}var Qb="][*?/\\".split("");function Zb(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return Qb.forEach(function(a){if(-1!=e.indexOf(a)){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}function ev(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t,r,a,s=e.Workbook&&e.Workbook.Sheets||[];t=e.SheetNames,r=s,a=!!e.vbaraw,t.forEach(function(e,s){Zb(e);for(var n=0;n<s;++n)if(e==t[n])throw new Error("Duplicate Sheet Name: "+e);if(a){var i=r&&r[s]&&r[s].CodeName||e;if(95==i.charCodeAt(0)&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}});for(var n=0;n<e.SheetNames.length;++n)db(e.Sheets[e.SheetNames[n]],e.SheetNames[n],n)}var tv=/<\w+:workbook/;function rv(e){var t=[Jd];t[t.length]=Au("workbook",null,{xmlns:$u[0],"xmlns:r":Hu});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Gb.forEach(function(t){null!=e.Workbook.WBProps[t[0]]&&e.Workbook.WBProps[t[0]]!=t[1]&&(a[t[0]]=e.Workbook.WBProps[t[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),t[t.length]=Au("workbookPr",null,a);var s=e.Workbook&&e.Workbook.Sheets||[],n=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",n=0;n!=e.SheetNames.length&&s[n]&&s[n].Hidden;++n);n==e.SheetNames.length&&(n=0),t[t.length]='<workbookView firstSheet="'+n+'" activeTab="'+n+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",n=0;n!=e.SheetNames.length;++n){var i={name:cu(e.SheetNames[n].slice(0,31))};if(i.sheetId=""+(n+1),i["r:id"]="rId"+(n+1),s[n])switch(s[n].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden"}t[t.length]=Au("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(e){var r={name:e.Name};e.Comment&&(r.comment=e.Comment),null!=e.Sheet&&(r.localSheetId=""+e.Sheet),e.Hidden&&(r.hidden="1"),e.Ref&&(t[t.length]=Au("definedName",cu(e.Ref),r))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function av(e,t){return t||(t=Fh(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Nf(e.strRelID,t),lf(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function sv(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function nv(e,t){if(t.Workbook&&t.Workbook.Sheets){for(var r,a,s=t.Workbook.Sheets,n=0,i=-1,o=-1;n<s.length;++n)!s[n]||!s[n].Hidden&&-1==i?i=n:1==s[n].Hidden&&-1==o&&(o=n);if(!(o>i))Bh(e,135),Bh(e,158,(r=i,a||(a=Fh(29)),a.write_shift(-4,0),a.write_shift(-4,460),a.write_shift(4,28800),a.write_shift(4,17600),a.write_shift(4,500),a.write_shift(4,r),a.write_shift(4,r),a.write_shift(1,120),a.length>a.l?a.slice(0,a.l):a)),Bh(e,136)}}function iv(e,t){var r=zh();return Bh(r,131),Bh(r,128,function(e,t){t||(t=Fh(127));for(var r=0;4!=r;++r)t.write_shift(4,0);return lf("SheetJS",t),lf(Hl.version,t),lf(Hl.version,t),lf("7262",t),t.length>t.l?t.slice(0,t.l):t}()),Bh(r,153,function(e,t){t||(t=Fh(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),bf(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}(e.Workbook&&e.Workbook.WBProps||null)),nv(r,e),function(e,t){Bh(e,143);for(var r=0;r!=t.SheetNames.length;++r)Bh(e,156,av({Hidden:t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]}));Bh(e,144)}(r,e),Bh(r,132),r.end()}function ov(e,t,r){return".bin"===t.slice(-4)?function(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],s=!1;t||(t={}),t.biff=12;var n=[],i=[[]];return i.SheetNames=[],i.XTI=[],$v[16]={n:"BrtFRTArchID$",f:sv},Lh(e,function(e,o,l){switch(l){case 156:i.SheetNames.push(e.name),r.Sheets.push(e);break;case 153:r.WBProps=e;break;case 39:null!=e.Sheet&&(t.SID=e.Sheet),e.Ref=zx(e.Ptg,0,null,i,t),delete t.SID,delete e.Ptg,n.push(e);break;case 1036:case 361:case 2071:case 158:case 143:case 664:case 353:case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:case 16:break;case 357:case 358:case 355:case 667:i[0].length?i.push([l,e]):i[0]=[l,e],i[i.length-1].XTI=[];break;case 362:0===i.length&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(e),i.XTI=i.XTI.concat(e);break;case 35:case 37:a.push(l),s=!0;break;case 36:case 38:a.pop(),s=!1;break;default:if(o.T);else if(!s||t.WTF&&37!=a[a.length-1]&&35!=a[a.length-1])throw new Error("Unexpected record 0x"+l.toString(16))}},t),Xb(r),r.Names=n,r.supbooks=i,r}(e,r):function(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,s="xmlns",n={},i=0;if(e.replace(Zd,function(o,l){var c=ru(o);switch(au(c[0])){case"<?xml":case"</workbook>":case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":case"<bookViews":case"<bookViews>":case"</bookViews>":case"</workbookView>":case"<sheets":case"<sheets>":case"</sheets>":case"</sheet>":case"<functionGroups":case"<functionGroups/>":case"<functionGroup":case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":case"<definedName/>":case"</calcPr>":case"<oleSize":case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":case"<customWorkbookView":case"</customWorkbookView>":case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":case"<smartTagPr":case"<smartTagPr/>":case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":case"<webPublishing":case"<webPublishing/>":case"<fileRecoveryPr":case"<fileRecoveryPr/>":case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":case"<ArchID":case"<revisionPtr":break;case"<workbook":o.match(tv)&&(s="xmlns"+o.match(/<(\w+):/)[1]),r.xmlns=c[s];break;case"<fileVersion":delete c[0],r.AppVersion=c;break;case"<workbookPr":case"<workbookPr/>":Gb.forEach(function(e){if(null!=c[e[0]])switch(e[2]){case"bool":r.WBProps[e[0]]=mu(c[e[0]]);break;case"int":r.WBProps[e[0]]=parseInt(c[e[0]],10);break;default:r.WBProps[e[0]]=c[e[0]]}}),c.codeName&&(r.WBProps.CodeName=vu(c.codeName));break;case"<workbookView":case"<workbookView/>":delete c[0],r.WBView.push(c);break;case"<sheet":switch(c.state){case"hidden":c.Hidden=1;break;case"veryHidden":c.Hidden=2;break;default:c.Hidden=0}delete c.state,c.name=iu(vu(c.name)),delete c[0],r.Sheets.push(c);break;case"<definedNames>":case"<definedNames":case"<ext":case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</definedNames>":case"</ext>":case"</AlternateContent>":a=!1;break;case"<definedName":(n={}).Name=vu(c.name),c.comment&&(n.Comment=c.comment),c.localSheetId&&(n.Sheet=+c.localSheetId),mu(c.hidden||"0")&&(n.Hidden=!0),i=l+o.length;break;case"</definedName>":n.Ref=iu(vu(e.slice(i,l))),r.Names.push(n);break;case"<calcPr":case"<calcPr/>":delete c[0],r.CalcPr=c;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+c[0]+" in workbook")}return o}),-1===$u.indexOf(r.xmlns))throw new Error("Unknown Namespace: "+r.xmlns);return Xb(r),r}(e,r)}function lv(e,t,r,a,s,n,i,o){return".bin"===t.slice(-4)?function(e,t,r,a,s,n,i){if(!e)return e;var o=t||{};a||(a={"!id":{}});var l,c,d,u,h,f,m,p,g,x,b=o.dense?[]:{},v={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=[],w=!1,j=!1,N=[];o.biff=12,o["!row"]=0;var k=0,S=!1,E=[],T={},_=o.supbooks||s.supbooks||[[]];if(_.sharedf=T,_.arrayf=E,_.SheetNames=s.SheetNames||s.Sheets.map(function(e){return e.name}),!o.supbooks&&(o.supbooks=_,s.Names))for(var C=0;C<s.Names.length;++C)_[0][C+1]=s.Names[C];var A,D,P=[],I=[],O=!1;if($v[16]={n:"BrtShortReal",f:Pb},Lh(e,function(e,t,C){if(!j)switch(C){case 148:l=e;break;case 0:c=e,o.sheetRows&&o.sheetRows<=c.r&&(j=!0),g=qh(h=c.r),o["!row"]=c.r,(e.hidden||e.hpt||null!=e.level)&&(e.hpt&&(e.hpx=yg(e.hpt)),I[e.r]=e);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(d={t:e[2]},e[2]){case"n":d.v=e[1];break;case"s":p=rb[e[1]],d.v=p.t,d.r=p.r;break;case"b":d.v=!!e[1];break;case"e":d.v=e[1],!1!==o.cellText&&(d.w=Uf[d.v]);break;case"str":d.t="s",d.v=e[1];break;case"is":d.t="s",d.v=e[1].t}if((u=i.CellXf[e[0].iStyleRef])&&cb(d,u.numFmtId,null,o,n,i),f=-1==e[0].c?f+1:e[0].c,o.dense?(b[h]||(b[h]=[]),b[h][f]=d):b[Kh(f)+g]=d,o.cellFormula){for(S=!1,k=0;k<E.length;++k){var R=E[k];c.r>=R[0].s.r&&c.r<=R[0].e.r&&f>=R[0].s.c&&f<=R[0].e.c&&(d.F=Qh(R[0]),S=!0)}!S&&e.length>3&&(d.f=e[3])}if(v.s.r>c.r&&(v.s.r=c.r),v.s.c>f&&(v.s.c=f),v.e.r<c.r&&(v.e.r=c.r),v.e.c<f&&(v.e.c=f),o.cellDates&&u&&"n"==d.t&&ed(Ec[u.numFmtId])){var M=Ac(d.v);M&&(d.t="d",d.v=new Date(M.y,M.m-1,M.d,M.H,M.M,M.S,M.u))}A&&("XLDAPR"==A.type&&(d.D=!0),A=void 0),D&&(D=void 0);break;case 1:case 12:if(!o.sheetStubs||w)break;d={t:"z",v:void 0},f=-1==e[0].c?f+1:e[0].c,o.dense?(b[h]||(b[h]=[]),b[h][f]=d):b[Kh(f)+g]=d,v.s.r>c.r&&(v.s.r=c.r),v.s.c>f&&(v.s.c=f),v.e.r<c.r&&(v.e.r=c.r),v.e.c<f&&(v.e.c=f),A&&("XLDAPR"==A.type&&(d.D=!0),A=void 0),D&&(D=void 0);break;case 176:N.push(e);break;case 49:A=((o.xlmeta||{}).Cell||[])[e-1];break;case 494:var F=a["!id"][e.relId];for(F?(e.Target=F.Target,e.loc&&(e.Target+="#"+e.loc),e.Rel=F):""==e.relId&&(e.Target="#"+e.loc),h=e.rfx.s.r;h<=e.rfx.e.r;++h)for(f=e.rfx.s.c;f<=e.rfx.e.c;++f)o.dense?(b[h]||(b[h]=[]),b[h][f]||(b[h][f]={t:"z",v:void 0}),b[h][f].l=e):(m=Jh({c:f,r:h}),b[m]||(b[m]={t:"z",v:void 0}),b[m].l=e);break;case 426:if(!o.cellFormula)break;E.push(e),(x=o.dense?b[h][f]:b[Kh(f)+g]).f=zx(e[1],0,{r:c.r,c:f},_,o),x.F=Qh(e[0]);break;case 427:if(!o.cellFormula)break;T[Jh(e[0].s)]=e[1],(x=o.dense?b[h][f]:b[Kh(f)+g]).f=zx(e[1],0,{r:c.r,c:f},_,o);break;case 60:if(!o.cellStyles)break;for(;e.e>=e.s;)P[e.e--]={width:e.w/256,hidden:!!(1&e.flags),level:e.level},O||(O=!0,gg(e.w/256)),xg(P[e.e+1]);break;case 161:b["!autofilter"]={ref:Qh(e)};break;case 476:b["!margins"]=e;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),e.name&&(s.Sheets[r].CodeName=e.name),(e.above||e.left)&&(b["!outline"]={above:e.above,left:e.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),e.RTL&&(s.Views[0].RTL=!0);break;case 485:case 64:case 1053:case 151:case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:w=!0;break;case 36:w=!1;break;case 37:y.push(C),w=!0;break;case 38:y.pop(),w=!1;break;default:if(t.T);else if(!w||o.WTF)throw new Error("Unexpected record 0x"+C.toString(16))}},o),delete o.supbooks,delete o["!row"],!b["!ref"]&&(v.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(b["!ref"]=Qh(l||v)),o.sheetRows&&b["!ref"]){var R=Zh(b["!ref"]);o.sheetRows<=+R.e.r&&(R.e.r=o.sheetRows-1,R.e.r>v.e.r&&(R.e.r=v.e.r),R.e.r<R.s.r&&(R.s.r=R.e.r),R.e.c>v.e.c&&(R.e.c=v.e.c),R.e.c<R.s.c&&(R.s.c=R.e.c),b["!fullref"]=b["!ref"],b["!ref"]=Qh(R))}return N.length>0&&(b["!merges"]=N),P.length>0&&(b["!cols"]=P),I.length>0&&(b["!rows"]=I),b}(e,a,r,s,n,i,o):wb(e,a,r,s,n,i,o)}function cv(e,t,r,a,s,n,i,o){return".bin"===t.slice(-4)?function(e,t,r,a,s){if(!e)return e;a||(a={"!id":{}});var n={"!type":"chart","!drawel":null,"!rel":""},i=[],o=!1;return Lh(e,function(e,a,l){switch(l){case 550:n["!rel"]=e;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),e.name&&(s.Sheets[r].CodeName=e.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(l);break;case 38:i.pop();break;default:if(a.T>0)i.push(l);else if(a.T<0)i.pop();else if(!o||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}},t),a["!id"][n["!rel"]]&&(n["!drawel"]=a["!id"][n["!rel"]]),n}(e,a,r,s,n):function(e,t,r,a,s){if(!e)return e;a||(a={"!id":{}});var n,i={"!type":"chart","!drawel":null,"!rel":""},o=e.match(bb);return o&&jb(o[0],0,s,r),(n=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=n[1]),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}(e,0,r,s,n)}function dv(e,t,r,a){return".bin"===t.slice(-4)?function(e,t,r){var a={NumberFmt:[]};for(var s in Ec)a.NumberFmt[s]=Ec[s];a.CellXf=[],a.Fonts=[];var n=[],i=!1;return Lh(e,function(e,s,o){switch(o){case 44:a.NumberFmt[e[0]]=e[1],nd(e[1],e[0]);break;case 43:a.Fonts.push(e),null!=e.color.theme&&t&&t.themeElements&&t.themeElements.clrScheme&&(e.color.rgb=dg(t.themeElements.clrScheme[e.color.theme].rgb,e.color.tint||0));break;case 1025:case 45:case 46:case 48:case 507:case 572:case 475:case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 47:617==n[n.length-1]&&a.CellXf.push(e);break;case 35:i=!0;break;case 36:i=!1;break;case 37:n.push(o),i=!0;break;case 38:n.pop(),i=!1;break;default:if(s.T>0)n.push(o);else if(s.T<0)n.pop();else if(!i||r.WTF&&37!=n[n.length-1])throw new Error("Unexpected record 0x"+o.toString(16))}}),a}(e,r,a):kg(e,r,a)}function uv(e,t,r){return".bin"===t.slice(-4)?function(e,t){var r=[],a=!1;return Lh(e,function(e,s,n){switch(n){case 159:r.Count=e[0],r.Unique=e[1];break;case 19:r.push(e);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(s.T,!a||t.WTF)throw new Error("Unexpected record 0x"+n.toString(16))}}),r}(e,r):function(e,t){var r=[],a="";if(!e)return r;var s=e.match(Wp);if(s){a=s[2].replace(Hp,"").split(Vp);for(var n=0;n!=a.length;++n){var i=Up(a[n].trim(),t);null!=i&&(r[r.length]=i)}s=ru(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}(e,r)}function hv(e,t,r){return".bin"===t.slice(-4)?function(e,t){var r=[],a=[],s={},n=!1;return Lh(e,function(e,i,o){switch(o){case 632:a.push(e);break;case 635:s=e;break;case 637:s.t=e.t,s.h=e.h,s.r=e.r;break;case 636:if(s.author=a[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:case 37:case 38:break;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T);else if(!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}(e,r):function(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(e){if(""!==e&&""!==e.trim()){var t=e.match(/<(?:\w+:)?author[^>]*>(.*)/);t&&r.push(t[1])}});var n=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return n&&n[1]&&n[1].split(/<\/\w*:?comment>/).forEach(function(e){if(""!==e&&""!==e.trim()){var s=e.match(/<(?:\w+:)?comment[^>]*>/);if(s){var n=ru(s[0]),i={author:n.authorId&&r[n.authorId]||"sheetjsghost",ref:n.ref,guid:n.guid},o=Yh(n.ref);if(!(t.sheetRows&&t.sheetRows<=o.r)){var l=e.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),c=!!l&&!!l[1]&&Up(l[1])||{r:"",t:"",h:""};i.r=c.r,"<t></t>"==c.r&&(c.t=c.h=""),i.t=(c.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),t.cellHTML&&(i.h=c.h),a.push(i)}}}}),a}(e,r)}function fv(e,t,r){return".bin"===t.slice(-4)?function(e){var t=[];return Lh(e,function(e,r,a){if(63===a)t.push(e);else if(!r.T)throw new Error("Unexpected record 0x"+a.toString(16))}),t}(e):function(e){var t=[];if(!e)return t;var r=1;return(e.match(Zd)||[]).forEach(function(e){var a=ru(e);switch(a[0]){case"<?xml":case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a)}}),t}(e)}function mv(e,t,r,a){if(".bin"===r.slice(-4))return function(e,t,r,a){if(!e)return e;var s=a||{},n=!1;Lh(e,function(e,t,r){switch(r){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:n=!0;break;case 36:n=!1;break;default:if(t.T);else if(!n||s.WTF)throw new Error("Unexpected record 0x"+r.toString(16))}},s)}(e,0,0,a)}function pv(e,t,r){return".bin"===t.slice(-4)?function(e,t,r){var a={Types:[],Cell:[],Value:[]},s=r||{},n=[],i=!1,o=2;return Lh(e,function(e,t,r){switch(r){case 335:a.Types.push({name:e.name});break;case 51:e.forEach(function(e){1==o?a.Cell.push({type:a.Types[e[0]-1].name,index:e[1]}):0==o&&a.Value.push({type:a.Types[e[0]-1].name,index:e[1]})});break;case 337:o=e?1:0;break;case 338:o=2;break;case 35:n.push(r),i=!0;break;case 36:n.pop(),i=!1;break;default:if(t.T);else if(!i||s.WTF&&35!=n[n.length-1])throw new Error("Unexpected record 0x"+r.toString(16))}}),a}(e,0,r):function(e,t,r){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var s,n=!1,i=2;return e.replace(Zd,function(e){var t=ru(e);switch(au(t[0])){case"<?xml":case"<metadata":case"</metadata>":case"<metadataTypes":case"</metadataTypes>":case"</metadataType>":case"</futureMetadata>":case"<bk>":case"</bk>":case"</rc>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<metadataType":a.Types.push({name:t.name});break;case"<futureMetadata":for(var o=0;o<a.Types.length;++o)a.Types[o].name==t.name&&(s=a.Types[o]);break;case"<rc":1==i?a.Cell.push({type:a.Types[t.t-1].name,index:+t.v}):0==i&&a.Value.push({type:a.Types[t.t-1].name,index:+t.v});break;case"<cellMetadata":i=1;break;case"</cellMetadata>":case"</valueMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+t.i);break;default:if(!n&&r.WTF)throw new Error("unrecognized "+t[0]+" in metadata")}return e}),a}(e,0,r)}function gv(e,t,r,a,s){return(".bin"===t.slice(-4)?Hb:_b)(e,r,a,s)}function xv(e,t,r){return(".bin"===t.slice(-4)?ix:ax)(e,r)}var bv,vv=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,yv=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function wv(e,t){var r=e.split(/\s+/),a=[];if(t||(a[0]=r[0]),1===r.length)return a;var s,n,i,o=e.match(vv);if(o)for(i=0;i!=o.length;++i)-1===(n=(s=o[i].match(yv))[1].indexOf(":"))?a[s[1]]=s[2].slice(1,s[2].length-1):a["xmlns:"===s[1].slice(0,6)?"xmlns"+s[1].slice(6):s[1].slice(n+1)]=s[2].slice(1,s[2].length-1);return a}function jv(e){var t={};if(1===e.split(/\s+/).length)return t;var r,a,s,n=e.match(vv);if(n)for(s=0;s!=n.length;++s)-1===(a=(r=n[s].match(yv))[1].indexOf(":"))?t[r[1]]=r[2].slice(1,r[2].length-1):t["xmlns:"===r[1].slice(0,6)?"xmlns"+r[1].slice(6):r[1].slice(a+1)]=r[2].slice(1,r[2].length-1);return t}function Nv(e,t,r,a){var s=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=mu(a);break;case"i2":case"int":s=parseInt(a,10);break;case"r4":case"float":s=parseFloat(a);break;case"date":case"dateTime.tz":s=Ad(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[iu(t)]=s}function kv(e,t,r){if("z"!==e.t){if(!r||!1!==r.cellText)try{"e"===e.t?e.w=e.w||Uf[e.v]:"General"===t?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Mc(e.v):e.w=Fc(e.v):e.w=function(e,t){var r=bv[e]||iu(e);return"General"===r?Fc(t):sd(r,t)}(t||"General",e.v)}catch(bN){if(r.WTF)throw bN}try{var a=bv[t]||t||"General";if(r.cellNF&&(e.z=a),r.cellDates&&"n"==e.t&&ed(a)){var s=Ac(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(bN){if(r.WTF)throw bN}}}function Sv(e,t,r){if(r.cellStyles&&t.Interior){var a=t.Interior;a.Pattern&&(a.patternType=wg[a.Pattern]||a.Pattern)}e[t.ID]=t}function Ev(e,t,r,a,s,n,i,o,l,c){var d="General",u=a.StyleID,h={};c=c||{};var f=[],m=0;for(void 0===u&&o&&(u=o.StyleID),void 0===u&&i&&(u=i.StyleID);void 0!==n[u]&&(n[u].nf&&(d=n[u].nf),n[u].Interior&&f.push(n[u].Interior),n[u].Parent);)u=n[u].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=mu(e);break;case"String":a.t="s",a.r=fu(iu(e)),a.v=e.indexOf("<")>-1?iu(t||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":"Z"!=e.slice(-1)&&(e+="Z"),a.v=(Ad(e)-new Date(Date.UTC(1899,11,30)))/864e5,a.v!==a.v?a.v=iu(e):a.v<60&&(a.v=a.v-1),d&&"General"!=d||(d="yyyy-mm-dd");case"Number":void 0===a.v&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=Wf[e],!1!==c.cellText&&(a.w=e);break;default:""==e&&""==t?a.t="z":(a.t="s",a.v=fu(t||e))}if(kv(a,d,c),!1!==c.cellFormula)if(a.Formula){var p=iu(a.Formula);61==p.charCodeAt(0)&&(p=p.slice(1)),a.f=lx(p,s),delete a.Formula,"RC"==a.ArrayRange?a.F=lx("RC:RC",s):a.ArrayRange&&(a.F=lx(a.ArrayRange,s),l.push([Zh(a.F),a.F]))}else for(m=0;m<l.length;++m)s.r>=l[m][0].s.r&&s.r<=l[m][0].e.r&&s.c>=l[m][0].s.c&&s.c<=l[m][0].e.c&&(a.F=l[m][1]);c.cellStyles&&(f.forEach(function(e){!h.patternType&&e.patternType&&(h.patternType=e.patternType)}),a.s=h),void 0!==a.StyleID&&(a.ixfe=a.StyleID)}function Tv(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),e.v=e.w=e.ixfe=void 0}function _v(e,t){var r=t||{};od();var a=ec(Pu(e));"binary"!=r.type&&"array"!=r.type&&"base64"!=r.type||(a="undefined"!==typeof Zl?Zl.utils.decode(65001,Xl(a)):vu(a));var s,n=a.slice(0,1024).toLowerCase(),i=!1;if((1023&(n=n.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&n.indexOf(","),1023&n.indexOf(";"))){var o=Pd(r);return o.type="string",Op.to_workbook(a,o)}if(-1==n.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach(function(e){n.indexOf("<"+e)>=0&&(i=!0)}),i)return function(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||0==r.length)throw new Error("Invalid HTML: could not find <table>");if(1==r.length)return rf(ny(r[0],t),t);var a={SheetNames:[],Sheets:{}};return r.forEach(function(e,r){kw(a,ny(e,t),"Sheet"+(r+1))}),a}(a,r);bv={"General Number":"General","General Date":Ec[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ec[15],"Short Date":Ec[14],"Long Time":Ec[19],"Medium Time":Ec[18],"Short Time":Ec[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ec[2],Standard:Ec[4],Percent:Ec[10],Scientific:Ec[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[];var d,u={},h=[],f=r.dense?[]:{},m="",p={},g={},x=wv('<Data ss:Type="String">'),b=0,v=0,y=0,w={s:{r:2e6,c:2e6},e:{r:0,c:0}},j={},N={},k="",S=0,E=[],T={},_={},C=0,A=[],D=[],P={},I=[],O=!1,R=[],M=[],F={},L=0,z=0,B={Sheets:[],WBProps:{date1904:!1}},U={};Iu.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/gm,"");for(var W="";s=Iu.exec(a);)switch(s[3]=(W=s[3]).toLowerCase()){case"data":if("data"==W){if("/"===s[1]){if((l=c.pop())[0]!==s[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==s[0].charAt(s[0].length-2)&&c.push([s[3],!0]);break}if(c[c.length-1][1])break;"/"===s[1]?Ev(a.slice(b,s.index),k,x,"comment"==c[c.length-1][0]?P:p,{c:v,r:y},j,I[v],g,R,r):(k="",x=wv(s[0]),b=s.index+s[0].length);break;case"cell":if("/"===s[1])if(D.length>0&&(p.c=D),(!r.sheetRows||r.sheetRows>y)&&void 0!==p.v&&(r.dense?(f[y]||(f[y]=[]),f[y][v]=p):f[Kh(v)+qh(y)]=p),p.HRef&&(p.l={Target:iu(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(L=v+(0|parseInt(p.MergeAcross,10)),z=y+(0|parseInt(p.MergeDown,10)),E.push({s:{c:v,r:y},e:{c:L,r:z}})),r.sheetStubs)if(p.MergeAcross||p.MergeDown){for(var H=v;H<=L;++H)for(var V=y;V<=z;++V)(H>v||V>y)&&(r.dense?(f[V]||(f[V]=[]),f[V][H]={t:"z"}):f[Kh(H)+qh(V)]={t:"z"});v=L+1}else++v;else p.MergeAcross?v=L+1:++v;else(p=jv(s[0])).Index&&(v=+p.Index-1),v<w.s.c&&(w.s.c=v),v>w.e.c&&(w.e.c=v),"/>"===s[0].slice(-2)&&++v,D=[];break;case"row":"/"===s[1]||"/>"===s[0].slice(-2)?(y<w.s.r&&(w.s.r=y),y>w.e.r&&(w.e.r=y),"/>"===s[0].slice(-2)&&(g=wv(s[0])).Index&&(y=+g.Index-1),v=0,++y):((g=wv(s[0])).Index&&(y=+g.Index-1),F={},("0"==g.AutoFitHeight||g.Height)&&(F.hpx=parseInt(g.Height,10),F.hpt=vg(F.hpx),M[y]=F),"1"==g.Hidden&&(F.hidden=!0,M[y]=F));break;case"worksheet":if("/"===s[1]){if((l=c.pop())[0]!==s[3])throw new Error("Bad state: "+l.join("|"));h.push(m),w.s.r<=w.e.r&&w.s.c<=w.e.c&&(f["!ref"]=Qh(w),r.sheetRows&&r.sheetRows<=w.e.r&&(f["!fullref"]=f["!ref"],w.e.r=r.sheetRows-1,f["!ref"]=Qh(w))),E.length&&(f["!merges"]=E),I.length>0&&(f["!cols"]=I),M.length>0&&(f["!rows"]=M),u[m]=f}else w={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=v=0,c.push([s[3],!1]),l=wv(s[0]),m=iu(l.Name),f=r.dense?[]:{},E=[],R=[],M=[],U={name:m,Hidden:0},B.Sheets.push(U);break;case"table":if("/"===s[1]){if((l=c.pop())[0]!==s[3])throw new Error("Bad state: "+l.join("|"))}else{if("/>"==s[0].slice(-2))break;c.push([s[3],!1]),I=[],O=!1}break;case"style":"/"===s[1]?Sv(j,N,r):N=wv(s[0]);break;case"numberformat":N.nf=iu(wv(s[0]).Format||"General"),bv[N.nf]&&(N.nf=bv[N.nf]);for(var G=0;392!=G&&Ec[G]!=N.nf;++G);if(392==G)for(G=57;392!=G;++G)if(null==Ec[G]){nd(N.nf,G);break}break;case"column":if("table"!==c[c.length-1][0])break;if((d=wv(s[0])).Hidden&&(d.hidden=!0,delete d.Hidden),d.Width&&(d.wpx=parseInt(d.Width,10)),!O&&d.wpx>10){O=!0,ug=6;for(var q=0;q<I.length;++q)I[q]&&xg(I[q])}O&&xg(d),I[d.Index-1||I.length]=d;for(var $=0;$<+d.Span;++$)I[I.length]=Pd(d);break;case"namedrange":if("/"===s[1])break;B.Names||(B.Names=[]);var K=ru(s[0]),Y={Name:K.Name,Ref:lx(K.RefersTo.slice(1),{r:0,c:0})};B.Sheets.length>0&&(Y.Sheet=B.Sheets.length-1),B.Names.push(Y);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":case"protection":case"paragraphs":case"name":case"pixelsperinch":case"null":break;case"font":if("/>"===s[0].slice(-2))break;"/"===s[1]?k+=a.slice(S,s.index):S=s.index+s[0].length;break;case"interior":if(!r.cellStyles)break;N.Interior=wv(s[0]);break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if("/>"===s[0].slice(-2))break;"/"===s[1]?fm(T,W,a.slice(C,s.index)):C=s.index+s[0].length;break;case"styles":case"workbook":if("/"===s[1]){if((l=c.pop())[0]!==s[3])throw new Error("Bad state: "+l.join("|"))}else c.push([s[3],!1]);break;case"comment":if("/"===s[1]){if((l=c.pop())[0]!==s[3])throw new Error("Bad state: "+l.join("|"));Tv(P),D.push(P)}else c.push([s[3],!1]),P={a:(l=wv(s[0])).Author};break;case"autofilter":if("/"===s[1]){if((l=c.pop())[0]!==s[3])throw new Error("Bad state: "+l.join("|"))}else if("/"!==s[0].charAt(s[0].length-2)){var J=wv(s[0]);f["!autofilter"]={ref:lx(J.Range).replace(/\$/g,"")},c.push([s[3],!0])}break;case"datavalidation":if("/"===s[1]){if((l=c.pop())[0]!==s[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==s[0].charAt(s[0].length-2)&&c.push([s[3],!0]);break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if("/"===s[1]){if((l=c.pop())[0]!==s[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==s[0].charAt(s[0].length-2)&&c.push([s[3],!0]);break;default:if(0==c.length&&"document"==s[3])return by(a,r);if(0==c.length&&"uof"==s[3])return by(a,r);var X=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(s[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:X=!1}break;case"componentoptions":switch(s[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:X=!1}break;case"excelworkbook":switch(s[3]){case"date1904":B.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:X=!1}break;case"workbookoptions":switch(s[3]){case"owcversion":case"height":case"width":break;default:X=!1}break;case"worksheetoptions":switch(s[3]){case"visible":if("/>"===s[0].slice(-2));else if("/"===s[1])switch(a.slice(C,s.index)){case"SheetHidden":U.Hidden=1;break;case"SheetVeryHidden":U.Hidden=2}else C=s.index+s[0].length;break;case"header":f["!margins"]||ob(f["!margins"]={},"xlml"),isNaN(+ru(s[0]).Margin)||(f["!margins"].header=+ru(s[0]).Margin);break;case"footer":f["!margins"]||ob(f["!margins"]={},"xlml"),isNaN(+ru(s[0]).Margin)||(f["!margins"].footer=+ru(s[0]).Margin);break;case"pagemargins":var Q=ru(s[0]);f["!margins"]||ob(f["!margins"]={},"xlml"),isNaN(+Q.Top)||(f["!margins"].top=+Q.Top),isNaN(+Q.Left)||(f["!margins"].left=+Q.Left),isNaN(+Q.Right)||(f["!margins"].right=+Q.Right),isNaN(+Q.Bottom)||(f["!margins"].bottom=+Q.Bottom);break;case"displayrighttoleft":B.Views||(B.Views=[]),B.Views[0]||(B.Views[0]={}),B.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;default:X=!1}break;case"pivottable":case"pivotcache":switch(s[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:X=!1}break;case"pagebreaks":switch(s[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:X=!1}break;case"autofilter":switch(s[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:X=!1}break;case"querytable":switch(s[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:X=!1}break;case"datavalidation":switch(s[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:X=!1}break;case"sorting":case"conditionalformatting":switch(s[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:X=!1}break;case"mapinfo":case"schema":case"data":switch(s[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:X=!1}break;case"smarttags":break;default:X=!1}if(X)break;if(s[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+s[3]+"|"+c.join("|");if("customdocumentproperties"===c[c.length-1][0]){if("/>"===s[0].slice(-2))break;"/"===s[1]?Nv(_,W,A,a.slice(C,s.index)):(A=s,C=s.index+s[0].length);break}if(r.WTF)throw"Unrecognized tag: "+s[3]+"|"+c.join("|")}var Z={};return r.bookSheets||r.bookProps||(Z.Sheets=u),Z.SheetNames=h,Z.Workbook=B,Z.SSF=Pd(Ec),Z.Props=T,Z.Custprops=_,Z}function Cv(e,t){switch(Jy(t=t||{}),t.type||"base64"){case"base64":return _v(nc(e),t);case"binary":case"buffer":case"file":return _v(e,t);case"array":return _v(hc(e),t)}}function Av(e,t){var r=[];return e.Props&&r.push(function(e,t){var r=[];return gd(hm).map(function(e){for(var t=0;t<em.length;++t)if(em[t][1]==e)return em[t];for(t=0;t<nm.length;++t)if(nm[t][1]==e)return nm[t];throw e}).forEach(function(a){if(null!=e[a[1]]){var s=t&&t.Props&&null!=t.Props[a[1]]?t.Props[a[1]]:e[a[1]];"date"===a[2]&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"Z")),"number"==typeof s?s=String(s):!0===s||!1===s?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(_u(hm[a[1]]||a[1],s))}}),Au("DocumentProperties",r.join(""),{xmlns:Ku})}(e.Props,t)),e.Custprops&&r.push(function(e,t){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",s=[];return e&&gd(e).forEach(function(t){if(Object.prototype.hasOwnProperty.call(e,t)){for(var a=0;a<em.length;++a)if(t==em[a][1])return;for(a=0;a<nm.length;++a)if(t==nm[a][1])return;for(a=0;a<r.length;++a)if(t==r[a])return;var n=e[t],i="string";"number"==typeof n?(i="float",n=String(n)):!0===n||!1===n?(i="boolean",n=n?"1":"0"):n=String(n),s.push(Au(du(t),n,{"dt:dt":i}))}}),t&&gd(t).forEach(function(r){if(Object.prototype.hasOwnProperty.call(t,r)&&(!e||!Object.prototype.hasOwnProperty.call(e,r))){var a=t[r],n="string";"number"==typeof a?(n="float",a=String(a)):!0===a||!1===a?(n="boolean",a=a?"1":"0"):a instanceof Date?(n="dateTime.tz",a=a.toISOString()):a=String(a),s.push(Au(du(r),a,{"dt:dt":n}))}}),"<"+a+' xmlns="'+Ku+'">'+s.join("")+"</"+a+">"}(e.Props,e.Custprops)),r.join("")}function Dv(e){return Au("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+dx(e.Ref,{r:0,c:0})})}function Pv(e,t,r,a,s,n,i){if(!e||void 0==e.v&&void 0==e.f)return"";var o={};if(e.f&&(o["ss:Formula"]="="+cu(dx(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var l=Yh(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==i.r?"":"["+(l.r-i.r)+"]")+"C"+(l.c==i.c?"":"["+(l.c-i.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=cu(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=cu(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],d=0;d!=c.length;++d)c[d].s.c==i.c&&c[d].s.r==i.r&&(c[d].e.c>c[d].s.c&&(o["ss:MergeAcross"]=c[d].e.c-c[d].s.c),c[d].e.r>c[d].s.r&&(o["ss:MergeDown"]=c[d].e.r-c[d].s.r));var u="",h="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":u="Number",h=String(e.v);break;case"b":u="Boolean",h=e.v?"1":"0";break;case"e":u="Error",h=Uf[e.v];break;case"d":u="DateTime",h=new Date(e.v).toISOString(),null==e.z&&(e.z=e.z||Ec[14]);break;case"s":u="String",h=((e.v||"")+"").replace(ou,function(e){return nu[e]}).replace(uu,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}var f=lb(a.cellXfs,e,a);o["ss:StyleID"]="s"+(21+f),o["ss:Index"]=i.c+1;var m=null!=e.v?h:"",p="z"==e.t?"":'<Data ss:Type="'+u+'">'+m+"</Data>";return(e.c||[]).length>0&&(p+=e.c.map(function(e){var t=Au("ss:Data",(e.t||"").replace(/(\r\n|[\r\n])/g,"&#10;"),{xmlns:"http://www.w3.org/TR/REC-html40"});return Au("Comment",t,{"ss:Author":e.a})}).join("")),Au("Cell",p,o)}function Iv(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=yg(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Ov(e,t,r){var a=[],s=r.SheetNames[e],n=r.Sheets[s],i=n?function(e,t,r,a){if(!e)return"";if(!((a||{}).Workbook||{}).Names)return"";for(var s=a.Workbook.Names,n=[],i=0;i<s.length;++i){var o=s[i];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||n.push(Dv(o)))}return n.join("")}(n,0,e,r):"";return i.length>0&&a.push("<Names>"+i+"</Names>"),i=n?function(e,t){if(!e["!ref"])return"";var r=Zh(e["!ref"]),a=e["!merges"]||[],s=0,n=[];e["!cols"]&&e["!cols"].forEach(function(e,t){xg(e);var r=!!e.width,a=ib(t,e),s={"ss:Index":t+1};r&&(s["ss:Width"]=hg(a.width)),e.hidden&&(s["ss:Hidden"]="1"),n.push(Au("Column",null,s))});for(var i=Array.isArray(e),o=r.s.r;o<=r.e.r;++o){for(var l=[Iv(o,(e["!rows"]||[])[o])],c=r.s.c;c<=r.e.c;++c){var d=!1;for(s=0;s!=a.length;++s)if(!(a[s].s.c>c)&&!(a[s].s.r>o)&&!(a[s].e.c<c)&&!(a[s].e.r<o)){a[s].s.c==c&&a[s].s.r==o||(d=!0);break}if(!d){var u={r:o,c:c},h=Jh(u),f=i?(e[o]||[])[c]:e[h];l.push(Pv(f,h,e,t,0,0,u))}}l.push("</Row>"),l.length>2&&n.push(l.join(""))}return n.join("")}(n,t):"",i.length>0&&a.push("<Table>"+i+"</Table>"),a.push(function(e,t,r,a){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(Au("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(Au("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(Au("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)s.push(Au("Visible",1==a.Workbook.Sheets[r].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var n=0;n<r&&(!a.Workbook.Sheets[n]||a.Workbook.Sheets[n].Hidden);++n);n==r&&s.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(_u("ProtectContents","True")),e["!protect"].objects&&s.push(_u("ProtectObjects","True")),e["!protect"].scenarios&&s.push(_u("ProtectScenarios","True")),null==e["!protect"].selectLockedCells||e["!protect"].selectLockedCells?null==e["!protect"].selectUnlockedCells||e["!protect"].selectUnlockedCells||s.push(_u("EnableSelection","UnlockedCells")):s.push(_u("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(t){e["!protect"][t[0]]&&s.push("<"+t[1]+"/>")})),0==s.length?"":Au("WorksheetOptions",s.join(""),{xmlns:Yu})}(n,0,e,r)),a.join("")}function Rv(e,t){t||(t={}),e.SSF||(e.SSF=Pd(Ec)),e.SSF&&(od(),id(e.SSF),t.revssf=vd(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],lb(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Av(e,t)),r.push(""),r.push(""),r.push("");for(var a=0;a<e.SheetNames.length;++a)r.push(Au("Worksheet",Ov(a,t,e),{"ss:Name":cu(e.SheetNames[a])}));return r[2]=function(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(e,t){var a=[];a.push(Au("NumberFormat",null,{"ss:Format":cu(Ec[e.numFmtId])}));var s={"ss:ID":"s"+(21+t)};r.push(Au("Style",a.join(""),s))}),Au("Styles",r.join(""))}(0,t),r[3]=function(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],a=0;a<t.length;++a){var s=t[a];null==s.Sheet&&(s.Name.match(/^_xlfn\./)||r.push(Dv(s)))}return Au("Names",r.join(""))}(e),Jd+Au("Workbook",r.join(""),{xmlns:Ju,"xmlns:o":Ku,"xmlns:x":Yu,"xmlns:ss":Ju,"xmlns:dt":Xu,"xmlns:html":eh})}function Mv(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=function(e){return Pf(e,1)}(r),r.length-r.l<=4)return t;var a=r.read_shift(4);return 0==a||a>40?t:(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4||1907505652!==(a=r.read_shift(4))?t:(t.UnicodeClipboardFormat=function(e){return Pf(e,2)}(r),0==(a=r.read_shift(4))||a>40?t:(r.l-=4,void(t.Reserved2=r.read_shift(0,"lpwstr")))))}var Fv=[60,1084,2066,2165,2175];function Lv(e,t,r,a,s){var n=a,i=[],o=r.slice(r.l,r.l+n);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:s.enc.insitu(o)}i.push(o),r.l+=n;for(var l=kh(r,r.l),c=Kv[l],d=0;null!=c&&Fv.indexOf(l)>-1;)n=kh(r,r.l+2),d=r.l+4,2066==l?d+=4:2165!=l&&2175!=l||(d+=12),o=r.slice(d,r.l+4+n),i.push(o),r.l+=4+n,c=Kv[l=kh(r,r.l)];var u=mc(i);Rh(u,0);var h=0;u.lens=[];for(var f=0;f<i.length;++f)u.lens.push(h),h+=i[f].length;if(u.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+u.length+" < "+a;return t.f(u,u.length,s)}function zv(e,t,r){if("z"!==e.t&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Ec[a])}catch(bN){if(t.WTF)throw bN}if(!t||!1!==t.cellText)try{"e"===e.t?e.w=e.w||Uf[e.v]:0===a||"General"==a?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Mc(e.v):e.w=Fc(e.v):e.w=sd(a,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(bN){if(t.WTF)throw bN}if(t.cellDates&&a&&"n"==e.t&&ed(Ec[a]||String(a))){var s=Ac(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Bv(e,t,r){return{v:e,ixfe:t,t:r}}function Uv(e,t){var r={opts:{}},a={};var s,n,i,o,l,c,d,u,h=t.dense?[]:{},f={},m={},p=null,g=[],x="",b={},v="",y={},w=[],j=[],N=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},S={},E=function(e){return e<8?Bf[e]:e<64&&N[e-8]||Bf[e]},T=function(e,t,r){if(!(F>1)&&!(r.sheetRows&&e.r>=r.sheetRows)){if(r.cellStyles&&t.XF&&t.XF.data&&function(e,t,r){var a,s=t.XF.data;s&&s.patternType&&r&&r.cellStyles&&(t.s={},t.s.patternType=s.patternType,(a=cg(E(s.icvFore)))&&(t.s.fgColor={rgb:a}),(a=cg(E(s.icvBack)))&&(t.s.bgColor={rgb:a}))}(0,t,r),delete t.ixfe,delete t.XF,s=e,v=Jh(e),m&&m.s&&m.e||(m={s:{r:0,c:0},e:{r:0,c:0}}),e.r<m.s.r&&(m.s.r=e.r),e.c<m.s.c&&(m.s.c=e.c),e.r+1>m.e.r&&(m.e.r=e.r+1),e.c+1>m.e.c&&(m.e.c=e.c+1),r.cellFormula&&t.f)for(var a=0;a<w.length;++a)if(!(w[a][0].s.c>e.c||w[a][0].s.r>e.r)&&!(w[a][0].e.c<e.c||w[a][0].e.r<e.r)){t.F=Qh(w[a][0]),w[a][0].s.c==e.c&&w[a][0].s.r==e.r||delete t.f,t.f&&(t.f=""+zx(w[a][1],0,e,O,_));break}r.dense?(h[e.r]||(h[e.r]=[]),h[e.r][e.c]=t):h[v]=t}},_={enc:!1,sbcch:0,snames:[],sharedf:y,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(_.password=t.password);var C=[],A=[],D=[],P=[],I=!1,O=[];O.SheetNames=_.snames,O.sharedf=_.sharedf,O.arrayf=_.arrayf,O.names=[],O.XTI=[];var R,M=0,F=0,L=0,z=[],B=[];_.codepage=1200,Yl(1200);for(var U=!1;e.l<e.length-1;){var W=e.l,H=e.read_shift(2);if(0===H&&10===M)break;var V=e.l===e.length?0:e.read_shift(2),G=Kv[H];if(G&&G.f){if(t.bookSheets&&133===M&&133!==H)break;if(M=H,2===G.r||12==G.r){var q=e.read_shift(2);if(V-=2,!_.enc&&q!==H&&((255&q)<<8|q>>8)!==H)throw new Error("rt mismatch: "+q+"!="+H);12==G.r&&(e.l+=10,V-=10)}var $={};if($=10===H?G.f(e,V,_):Lv(H,G,e,V,_),0==F&&-1===[9,521,1033,2057].indexOf(M))continue;switch(H){case 34:r.opts.Date1904=k.WBProps.date1904=$;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(_.enc||(e.l=0),_.enc=$,!t.password)throw new Error("File is password-protected");if(null==$.valid)throw new Error("Encryption scheme unsupported");if(!$.valid)throw new Error("Password is incorrect");break;case 92:_.lastuser=$;break;case 66:var K=Number($);switch(K){case 21010:K=1200;break;case 32768:K=1e4;break;case 32769:K=1252}Yl(_.codepage=K),U=!0;break;case 317:_.rrtabid=$;break;case 25:_.winlocked=$;break;case 439:r.opts.RefreshAll=$;break;case 12:r.opts.CalcCount=$;break;case 16:r.opts.CalcDelta=$;break;case 17:r.opts.CalcIter=$;break;case 13:r.opts.CalcMode=$;break;case 14:r.opts.CalcPrecision=$;break;case 95:r.opts.CalcSaveRecalc=$;break;case 15:_.CalcRefMode=$;break;case 2211:r.opts.FullCalc=$;break;case 129:$.fDialog&&(h["!type"]="dialog"),$.fBelow||((h["!outline"]||(h["!outline"]={})).above=!0),$.fRight||((h["!outline"]||(h["!outline"]={})).left=!0);break;case 224:j.push($);break;case 430:O.push([$]),O[O.length-1].XTI=[];break;case 35:case 547:O[O.length-1].push($);break;case 24:case 536:R={Name:$.Name,Ref:zx($.rgce,0,null,O,_)},$.itab>0&&(R.Sheet=$.itab-1),O.names.push(R),O[0]||(O[0]=[],O[0].XTI=[]),O[O.length-1].push($),"_xlnm._FilterDatabase"==$.Name&&$.itab>0&&$.rgce&&$.rgce[0]&&$.rgce[0][0]&&"PtgArea3d"==$.rgce[0][0][0]&&(B[$.itab-1]={ref:Qh($.rgce[0][0][1][2])});break;case 22:_.ExternCount=$;break;case 23:0==O.length&&(O[0]=[],O[0].XTI=[]),O[O.length-1].XTI=O[O.length-1].XTI.concat($),O.XTI=O.XTI.concat($);break;case 2196:if(_.biff<8)break;null!=R&&(R.Comment=$[1]);break;case 18:h["!protect"]=$;break;case 19:0!==$&&_.WTF&&console.error("Password verifier: "+$);break;case 133:f[$.pos]=$,_.snames.push($.name);break;case 10:if(--F)break;if(m.e){if(m.e.r>0&&m.e.c>0){if(m.e.r--,m.e.c--,h["!ref"]=Qh(m),t.sheetRows&&t.sheetRows<=m.e.r){var Y=m.e.r;m.e.r=t.sheetRows-1,h["!fullref"]=h["!ref"],h["!ref"]=Qh(m),m.e.r=Y}m.e.r++,m.e.c++}C.length>0&&(h["!merges"]=C),A.length>0&&(h["!objects"]=A),D.length>0&&(h["!cols"]=D),P.length>0&&(h["!rows"]=P),k.Sheets.push(S)}""===x?b=h:a[x]=h,h=t.dense?[]:{};break;case 9:case 521:case 1033:case 2057:if(8===_.biff&&(_.biff={9:2,521:3,1033:4}[H]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[$.BIFFVer]||8),_.biffguess=0==$.BIFFVer,0==$.BIFFVer&&4096==$.dt&&(_.biff=5,U=!0,Yl(_.codepage=28591)),8==_.biff&&0==$.BIFFVer&&16==$.dt&&(_.biff=2),F++)break;if(h=t.dense?[]:{},_.biff<8&&!U&&(U=!0,Yl(_.codepage=t.codepage||1252)),_.biff<5||0==$.BIFFVer&&4096==$.dt){""===x&&(x="Sheet1"),m={s:{r:0,c:0},e:{r:0,c:0}};var J={pos:e.l-V,name:x};f[J.pos]=J,_.snames.push(x)}else x=(f[W]||{name:""}).name;32==$.dt&&(h["!type"]="chart"),64==$.dt&&(h["!type"]="macro"),C=[],A=[],_.arrayf=w=[],D=[],P=[],I=!1,S={Hidden:(f[W]||{hs:0}).hs,name:x};break;case 515:case 3:case 2:"chart"==h["!type"]&&(t.dense?(h[$.r]||[])[$.c]:h[Jh({c:$.c,r:$.r})])&&++$.c,c={ixfe:$.ixfe,XF:j[$.ixfe]||{},v:$.val,t:"n"},L>0&&(c.z=z[c.ixfe>>8&63]),zv(c,t,r.opts.Date1904),T({c:$.c,r:$.r},c,t);break;case 5:case 517:c={ixfe:$.ixfe,XF:j[$.ixfe],v:$.val,t:$.t},L>0&&(c.z=z[c.ixfe>>8&63]),zv(c,t,r.opts.Date1904),T({c:$.c,r:$.r},c,t);break;case 638:c={ixfe:$.ixfe,XF:j[$.ixfe],v:$.rknum,t:"n"},L>0&&(c.z=z[c.ixfe>>8&63]),zv(c,t,r.opts.Date1904),T({c:$.c,r:$.r},c,t);break;case 189:for(var X=$.c;X<=$.C;++X){var Q=$.rkrec[X-$.c][0];c={ixfe:Q,XF:j[Q],v:$.rkrec[X-$.c][1],t:"n"},L>0&&(c.z=z[c.ixfe>>8&63]),zv(c,t,r.opts.Date1904),T({c:X,r:$.r},c,t)}break;case 6:case 518:case 1030:if("String"==$.val){p=$;break}if((c=Bv($.val,$.cell.ixfe,$.tt)).XF=j[c.ixfe],t.cellFormula){var Z=$.formula;if(Z&&Z[0]&&Z[0][0]&&"PtgExp"==Z[0][0][0]){var ee=Z[0][0][1][0],te=Z[0][0][1][1],re=Jh({r:ee,c:te});y[re]?c.f=""+zx($.formula,0,$.cell,O,_):c.F=((t.dense?(h[ee]||[])[te]:h[re])||{}).F}else c.f=""+zx($.formula,0,$.cell,O,_)}L>0&&(c.z=z[c.ixfe>>8&63]),zv(c,t,r.opts.Date1904),T($.cell,c,t),p=$;break;case 7:case 519:if(!p)throw new Error("String record expects Formula");p.val=$,(c=Bv($,p.cell.ixfe,"s")).XF=j[c.ixfe],t.cellFormula&&(c.f=""+zx(p.formula,0,p.cell,O,_)),L>0&&(c.z=z[c.ixfe>>8&63]),zv(c,t,r.opts.Date1904),T(p.cell,c,t),p=null;break;case 33:case 545:w.push($);var ae=Jh($[0].s);if(n=t.dense?(h[$[0].s.r]||[])[$[0].s.c]:h[ae],t.cellFormula&&n){if(!p)break;if(!ae||!n)break;n.f=""+zx($[1],0,$[0],O,_),n.F=Qh($[0])}break;case 1212:if(!t.cellFormula)break;if(v){if(!p)break;y[Jh(p.cell)]=$[0],((n=t.dense?(h[p.cell.r]||[])[p.cell.c]:h[Jh(p.cell)])||{}).f=""+zx($[0],0,s,O,_)}break;case 253:c=Bv(g[$.isst].t,$.ixfe,"s"),g[$.isst].h&&(c.h=g[$.isst].h),c.XF=j[c.ixfe],L>0&&(c.z=z[c.ixfe>>8&63]),zv(c,t,r.opts.Date1904),T({c:$.c,r:$.r},c,t);break;case 513:t.sheetStubs&&(c={ixfe:$.ixfe,XF:j[$.ixfe],t:"z"},L>0&&(c.z=z[c.ixfe>>8&63]),zv(c,t,r.opts.Date1904),T({c:$.c,r:$.r},c,t));break;case 190:if(t.sheetStubs)for(var se=$.c;se<=$.C;++se){var ne=$.ixfe[se-$.c];c={ixfe:ne,XF:j[ne],t:"z"},L>0&&(c.z=z[c.ixfe>>8&63]),zv(c,t,r.opts.Date1904),T({c:se,r:$.r},c,t)}break;case 214:case 516:case 4:(c=Bv($.val,$.ixfe,"s")).XF=j[c.ixfe],L>0&&(c.z=z[c.ixfe>>8&63]),zv(c,t,r.opts.Date1904),T({c:$.c,r:$.r},c,t);break;case 0:case 512:1===F&&(m=$);break;case 252:g=$;break;case 1054:if(4==_.biff){z[L++]=$[1];for(var ie=0;ie<L+163&&Ec[ie]!=$[1];++ie);ie>=163&&nd($[1],L+163)}else nd($[1],$[0]);break;case 30:z[L++]=$;for(var oe=0;oe<L+163&&Ec[oe]!=$;++oe);oe>=163&&nd($,L+163);break;case 229:C=C.concat($);break;case 93:A[$.cmo[0]]=_.lastobj=$;break;case 438:_.lastobj.TxO=$;break;case 127:_.lastobj.ImData=$;break;case 440:for(l=$[0].s.r;l<=$[0].e.r;++l)for(o=$[0].s.c;o<=$[0].e.c;++o)(n=t.dense?(h[l]||[])[o]:h[Jh({c:o,r:l})])&&(n.l=$[1]);break;case 2048:for(l=$[0].s.r;l<=$[0].e.r;++l)for(o=$[0].s.c;o<=$[0].e.c;++o)(n=t.dense?(h[l]||[])[o]:h[Jh({c:o,r:l})])&&n.l&&(n.l.Tooltip=$[1]);break;case 28:if(_.biff<=5&&_.biff>=2)break;n=t.dense?(h[$[0].r]||[])[$[0].c]:h[Jh($[0])];var le=A[$[2]];n||(t.dense?(h[$[0].r]||(h[$[0].r]=[]),n=h[$[0].r][$[0].c]={t:"z"}):n=h[Jh($[0])]={t:"z"},m.e.r=Math.max(m.e.r,$[0].r),m.s.r=Math.min(m.s.r,$[0].r),m.e.c=Math.max(m.e.c,$[0].c),m.s.c=Math.min(m.s.c,$[0].c)),n.c||(n.c=[]),i={a:$[1],t:le.TxO.t},n.c.push(i);break;case 2173:Xg(j[$.ixfe],$.ext);break;case 125:if(!_.cellStyles)break;for(;$.e>=$.s;)D[$.e--]={width:$.w/256,level:$.level||0,hidden:!!(1&$.flags)},I||(I=!0,gg($.w/256)),xg(D[$.e+1]);break;case 520:var ce={};null!=$.level&&(P[$.r]=ce,ce.level=$.level),$.hidden&&(P[$.r]=ce,ce.hidden=!0),$.hpt&&(P[$.r]=ce,ce.hpt=$.hpt,ce.hpx=yg($.hpt));break;case 38:case 39:case 40:case 41:h["!margins"]||ob(h["!margins"]={}),h["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[H]]=$;break;case 161:h["!margins"]||ob(h["!margins"]={}),h["!margins"].header=$.header,h["!margins"].footer=$.footer;break;case 574:$.RTL&&(k.Views[0].RTL=!0);break;case 146:N=$;break;case 2198:u=$;break;case 140:d=$;break;case 442:x?S.CodeName=$||S.name:k.WBProps.CodeName=$||"ThisWorkbook"}}else G||console.error("Missing Info for XLS Record 0x"+H.toString(16)),e.l+=V}return r.SheetNames=gd(f).sort(function(e,t){return Number(e)-Number(t)}).map(function(e){return f[e].name}),t.bookSheets||(r.Sheets=a),!r.SheetNames.length&&b["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=b)):r.Preamble=b,r.Sheets&&B.forEach(function(e,t){r.Sheets[r.SheetNames[t]]["!autofilter"]=e}),r.Strings=g,r.SSF=Pd(Ec),_.enc&&(r.Encryption=_.enc),u&&(r.Themes=u),r.Metadata={},void 0!==d&&(r.Metadata.Country=d),O.names.length>0&&(k.Names=O.names),r.Workbook=k,r}var Wv="e0859ff2f94f6810ab9108002b27b3d9",Hv="02d5cdd59c2e1b10939708002b2cf9ae",Vv="05d5cdd59c2e1b10939708002b2cf9ae";function Gv(e,t){var r,a,s,n;if(t||(t={}),Jy(t),Jl(),t.codepage&&Kl(t.codepage),e.FullPaths){if(hd.find(e,"/encryption"))throw new Error("File is password-protected");r=hd.find(e,"!CompObj"),a=hd.find(e,"/Workbook")||hd.find(e,"/Book")}else{switch(t.type){case"base64":e=dc(nc(e));break;case"binary":e=dc(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e))}Rh(e,0),a={content:e}}if(r&&Mv(r),t.bookProps&&!t.bookSheets)s={};else{var i=ic?"buffer":"array";if(a&&a.content)s=Uv(a.content,t);else if((n=hd.find(e,"PerfectOffice_MAIN"))&&n.content)s=Rp.to_workbook(n.content,(t.type=i,t));else{if(!(n=hd.find(e,"NativeContent_MAIN"))||!n.content)throw(n=hd.find(e,"MN0"))&&n.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");s=Rp.to_workbook(n.content,(t.type=i,t))}t.bookVBA&&e.FullPaths&&hd.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=function(e){var t=hd.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,a){if("/"!==r.slice(-1)&&r.match(/_VBA_PROJECT_CUR/)){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");hd.utils.cfb_add(t,s,e.FileIndex[a].content)}}),hd.write(t)}(e))}var o={};return e.FullPaths&&function(e,t,r){var a=hd.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var s=_m(a,Rf,Hv);for(var n in s)t[n]=s[n]}catch(bN){if(r.WTF)throw bN}var i=hd.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=_m(i,Mf,Wv);for(var l in o)null==t[l]&&(t[l]=o[l])}catch(bN){if(r.WTF)throw bN}t.HeadingPairs&&t.TitlesOfParts&&(om(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}(e,o,t),s.Props=s.Custprops=o,t.bookFiles&&(s.cfb=e),s}function qv(e,t){var r=t||{},a=hd.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return hd.utils.cfb_add(a,s,sy(e,r)),8==r.biff&&(e.Props||e.Custprops)&&function(e,t){var r,a=[],s=[],n=[],i=0,o=xd(Rf,"n"),l=xd(Mf,"n");if(e.Props)for(r=gd(e.Props),i=0;i<r.length;++i)(Object.prototype.hasOwnProperty.call(o,r[i])?a:Object.prototype.hasOwnProperty.call(l,r[i])?s:n).push([r[i],e.Props[r[i]]]);if(e.Custprops)for(r=gd(e.Custprops),i=0;i<r.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},r[i])||(Object.prototype.hasOwnProperty.call(o,r[i])?a:Object.prototype.hasOwnProperty.call(l,r[i])?s:n).push([r[i],e.Custprops[r[i]]]);var c=[];for(i=0;i<n.length;++i)Sm.indexOf(n[i][0])>-1||im.indexOf(n[i][0])>-1||null!=n[i][1]&&c.push(n[i]);s.length&&hd.utils.cfb_add(t,"/\x05SummaryInformation",Cm(s,Wv,l,Mf)),(a.length||c.length)&&hd.utils.cfb_add(t,"/\x05DocumentSummaryInformation",Cm(a,Hv,o,Rf,c.length?c:null,Vv))}(e,a),8==r.biff&&e.vbaraw&&function(e,t){t.FullPaths.forEach(function(r,a){if(0!=a){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");"/"!==s.slice(-1)&&hd.utils.cfb_add(e,s,t.FileIndex[a].content)}})}(a,hd.read(e.vbaraw,{type:"string"==typeof e.vbaraw?"binary":"buffer"})),a}var $v={0:{f:function(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var n=e.read_shift(1);return e.l=a,7&n&&(r.level=7&n),16&n&&(r.hidden=!0),32&n&&(r.hpt=s/20),r}},1:{f:function(e){return[ff(e)]}},2:{f:function(e){return[ff(e),kf(e),"n"]}},3:{f:function(e){return[ff(e),e.read_shift(1),"e"]}},4:{f:function(e){return[ff(e),e.read_shift(1),"b"]}},5:{f:function(e){return[ff(e),Cf(e),"n"]}},6:{f:function(e){return[ff(e),of(e),"str"]}},7:{f:function(e){return[ff(e),e.read_shift(4),"s"]}},8:{f:function(e,t,r){var a=e.l+t,s=ff(e);s.r=r["!row"];var n=[s,of(e),"str"];if(r.cellFormula){e.l+=2;var i=qx(e,a-e.l,r);n[3]=zx(i,0,s,r.supbooks,r)}else e.l=a;return n}},9:{f:function(e,t,r){var a=e.l+t,s=ff(e);s.r=r["!row"];var n=[s,Cf(e),"n"];if(r.cellFormula){e.l+=2;var i=qx(e,a-e.l,r);n[3]=zx(i,0,s,r.supbooks,r)}else e.l=a;return n}},10:{f:function(e,t,r){var a=e.l+t,s=ff(e);s.r=r["!row"];var n=[s,e.read_shift(1),"b"];if(r.cellFormula){e.l+=2;var i=qx(e,a-e.l,r);n[3]=zx(i,0,s,r.supbooks,r)}else e.l=a;return n}},11:{f:function(e,t,r){var a=e.l+t,s=ff(e);s.r=r["!row"];var n=[s,e.read_shift(1),"e"];if(r.cellFormula){e.l+=2;var i=qx(e,a-e.l,r);n[3]=zx(i,0,s,r.supbooks,r)}else e.l=a;return n}},12:{f:function(e){return[pf(e)]}},13:{f:function(e){return[pf(e),kf(e),"n"]}},14:{f:function(e){return[pf(e),e.read_shift(1),"e"]}},15:{f:function(e){return[pf(e),e.read_shift(1),"b"]}},16:{f:Pb},17:{f:function(e){return[pf(e),of(e),"str"]}},18:{f:function(e){return[pf(e),e.read_shift(4),"s"]}},19:{f:df},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),n=wf(e),i=$x(e,0,r),o=vf(e);e.l=a;var l={Name:n,Ptg:i};return s<268435455&&(l.Sheet=s),o&&(l.Comment=o),l}},40:{},42:{},43:{f:function(e,t,r){var a={};a.sz=e.read_shift(2)/20;var s=function(e){var t=e.read_shift(1);return e.l++,{fBold:1&t,fItalic:2&t,fUnderline:4&t,fStrikeout:8&t,fOutline:16&t,fShadow:32&t,fCondense:64&t,fExtend:128&t}}(e);switch(s.fItalic&&(a.italic=1),s.fCondense&&(a.condense=1),s.fExtend&&(a.extend=1),s.fShadow&&(a.shadow=1),s.fOutline&&(a.outline=1),s.fStrikeout&&(a.strike=1),700===e.read_shift(2)&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript"}var n=e.read_shift(1);0!=n&&(a.underline=n);var i=e.read_shift(1);i>0&&(a.family=i);var o=e.read_shift(1);switch(o>0&&(a.charset=o),e.l++,a.color=function(e){var t={},r=e.read_shift(1)>>>1,a=e.read_shift(1),s=e.read_shift(2,"i"),n=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(1);switch(e.l++,r){case 0:t.auto=1;break;case 1:t.index=a;var l=Bf[a];l&&(t.rgb=cg(l));break;case 2:t.rgb=cg([n,i,o]);break;case 3:t.theme=a}return 0!=s&&(t.tint=s>0?s/32767:s/32768),t}(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor"}return a.name=of(e),a}},44:{f:function(e,t){return[e.read_shift(2),of(e)]}},45:{f:Ag},46:{f:Og},47:{f:function(e,t){var r=e.l+t,a=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:s}}},48:{},49:{f:function(e){return e.read_shift(4,"i")}},50:{},51:{f:function(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Sp},62:{f:function(e){return[ff(e),df(e),"is"]}},63:{f:function(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Jh(r);var a=e.read_shift(1);return 2&a&&(t.l="1"),8&a&&(t.a="1"),t}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Mh,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(e){var t=e.read_shift(2);return e.l+=28,{RTL:32&t}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(e,t){var r={},a=e[e.l];return++e.l,r.above=!(64&a),r.left=!(128&a),e.l+=18,r.name=xf(e,t-19),r}},148:{f:Ab,p:16},151:{f:function(){}},152:{},153:{f:function(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?of(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(65536&a),r.backupFile=!!(64&a),r.checkCompatibility=!!(4096&a),r.date1904=!!(1&a),r.filterPrivacy=!!(8&a),r.hidePivotFieldList=!!(1024&a),r.promptedSolutions=!!(16&a),r.publishItems=!!(2048&a),r.refreshAllConnections=!!(262144&a),r.saveExternalLinkValues=!!(128&a),r.showBorderUnselectedTables=!!(4&a),r.showInkAnnotation=!!(32&a),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(32768&a),r.updateLinks=["userSet","never","always"][a>>8&3],r}},154:{},155:{},156:{f:function(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=jf(e,t-8),r.name=of(e),r}},157:{},158:{},159:{T:1,f:function(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:Tf},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Ib},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:of(e)}}},336:{T:-1},337:{f:function(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:jf},357:{},358:{},359:{},360:{T:1},361:{},362:{f:yp},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(e,t,r){var a=e.l+t,s=Ef(e),n=e.read_shift(1),i=[s];if(i[2]=n,r.cellFormula){var o=Gx(e,a-e.l,r);i[1]=o}else e.l=a;return i}},427:{f:function(e,t,r){var a=e.l+t,s=[Tf(e,16)];if(r.cellFormula){var n=Kx(e,a-e.l,r);s[1]=n,e.l=a}else e.l=a;return s}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(e){var t={};return Rb.forEach(function(r){t[r]=Cf(e)}),t}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(e,t){var r=e.l+t,a=Tf(e,16),s=vf(e),n=of(e),i=of(e),o=of(e);e.l=r;var l={rfx:a,relId:s,loc:n,display:o};return i&&(l.Tooltip=i),l}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:jf},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:nx},633:{T:1},634:{T:-1},635:{T:1,f:function(e){var t={};t.iauthor=e.read_shift(4);var r=Tf(e,16);return t.rfx=r.s,t.ref=Jh(r.s),e.l+=16,t}},636:{T:-1},637:{f:uf},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(e,t){return e.l+=10,{name:of(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Kv={6:{f:Wx},10:{f:Am},12:{f:Im},13:{f:Im},14:{f:Dm},15:{f:Dm},16:{f:Cf},17:{f:Dm},18:{f:Dm},19:{f:Im},20:{f:gp},21:{f:gp},23:{f:yp},24:{f:vp},25:{f:Dm},26:{},27:{},28:{f:function(e,t,r){return function(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),o=Wm(e,0,r);return r.biff<8&&e.read_shift(1),[{r:a,c:s},o,i,n]}}(e,0,r)}},29:{},34:{f:Dm},35:{f:xp},38:{f:Cf},39:{f:Cf},40:{f:Cf},41:{f:Cf},42:{f:Dm},43:{f:Dm},47:{f:function(e,t,r){var a={Type:r.biff>=8?e.read_shift(2):0};return a.Type?og(e,t-2,a):function(e,t,r,a){var s={key:Im(e),verificationBytes:Im(e)};r.password&&(s.verifier=sg(r.password)),a.valid=s.verificationBytes===s.verifier,a.valid&&(a.insitu=ig(r.password))}(e,r.biff,r,a),a}},49:{f:function(e,t,r){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10}return a.name=Fm(e,0,r),a}},51:{f:Im},60:{},61:{f:function(e){return{Pos:[e.read_shift(2),e.read_shift(2)],Dim:[e.read_shift(2),e.read_shift(2)],Flags:e.read_shift(2),CurTab:e.read_shift(2),FirstTab:e.read_shift(2),Selected:e.read_shift(2),TabRatio:e.read_shift(2)}}},64:{f:Dm},65:{f:function(){}},66:{f:Im},77:{},80:{},81:{},82:{},85:{f:Im},89:{},90:{},91:{},92:{f:function(e,t,r){if(r.enc)return e.l+=t,"";var a=e.l,s=Wm(e,0,r);return e.read_shift(t+a-e.l),s}},93:{f:function(e,t,r){if(r&&r.biff<8)return function(e,t,r){e.l+=4;var a=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((jp[a]||Mh)(e,t,r)),{cmo:[s,a,n],ft:i}}(e,t,r);var a=sp(e),s=function(e,t){for(var r=e.l+t,a=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{a.push(ip[s](e,r-e.l))}catch(bN){return e.l=r,a}}return e.l!=r&&(e.l=r),a}(e,t-22,a[1]);return{cmo:a,ft:s}}},94:{},95:{f:Dm},96:{},97:{},99:{f:Dm},125:{f:Sp},128:{f:function(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(0!==t[0]&&t[0]--,0!==t[1]&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}},129:{f:function(e,t,r){var a=r&&8==r.biff||2==t?e.read_shift(2):(e.l+=t,0);return{fDialog:16&a,fBelow:64&a,fRight:128&a}}},130:{f:Im},131:{f:Dm},132:{f:Dm},133:{f:function(e,t,r){var a=e.read_shift(4),s=3&e.read_shift(1),n=e.read_shift(1);switch(n){case 0:n="Worksheet";break;case 1:n="Macrosheet";break;case 2:n="Chartsheet";break;case 6:n="VBAModule"}var i=Fm(e,0,r);return 0===i.length&&(i="Sheet1"),{pos:a,hs:s,dt:n,name:i}}},134:{},140:{f:function(e){var t,r=[0,0];return t=e.read_shift(2),r[0]=Ff[t]||t,t=e.read_shift(2),r[1]=Ff[t]||t,r}},141:{f:Im},144:{},146:{f:function(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Ym(e));return r}},151:{},152:{},153:{},154:{},155:{},156:{f:Im},157:{},158:{},160:{f:Tp},161:{f:function(e,t){var r={};return t<32||(e.l+=16,r.header=Cf(e),r.footer=Cf(e),e.l+=2),r}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function(e,t){for(var r=e.l+t-2,a=e.read_shift(2),s=e.read_shift(2),n=[];e.l<r;)n.push(Zm(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(n.length!=i-s+1)throw new Error("MulRK length mismatch");return{r:a,c:s,C:i,rkrec:n}}},190:{f:function(e,t){for(var r=e.l+t-2,a=e.read_shift(2),s=e.read_shift(2),n=[];e.l<r;)n.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(n.length!=i-s+1)throw new Error("MulBlank length mismatch");return{r:a,c:s,C:i,ixfe:n}}},193:{f:Am},197:{},198:{},199:{},200:{},201:{},202:{f:Dm},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Im},220:{},221:{f:Dm},222:{},224:{f:function(e,t,r){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,a.data=function(e,t,r,a){var s={},n=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return s.patternType=Lf[o>>26],a.cellStyles?(s.alc=7&n,s.fWrap=n>>3&1,s.alcV=n>>4&7,s.fJustLast=n>>7&1,s.trot=n>>8&255,s.cIndent=n>>16&15,s.fShrinkToFit=n>>20&1,s.iReadOrder=n>>22&2,s.fAtrNum=n>>26&1,s.fAtrFnt=n>>27&1,s.fAtrAlc=n>>28&1,s.fAtrBdr=n>>29&1,s.fAtrPat=n>>30&1,s.fAtrProt=n>>31&1,s.dgLeft=15&i,s.dgRight=i>>4&15,s.dgTop=i>>8&15,s.dgBottom=i>>12&15,s.icvLeft=i>>16&127,s.icvRight=i>>23&127,s.grbitDiag=i>>30&3,s.icvTop=127&o,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=127&l,s.icvBack=l>>7&127,s.fsxButton=l>>14&1,s):s}(e,0,a.fStyle,r),a}},225:{f:function(e,t){return 0===t||e.read_shift(2),1200}},226:{f:Am},227:{},229:{f:function(e,t){for(var r=[],a=e.read_shift(2);a--;)r.push(ep(e));return r}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function(e,t){for(var r=e.l+t,a=e.read_shift(4),s=e.read_shift(4),n=[],i=0;i!=s&&e.l<r;++i)n.push(Lm(e));return n.Count=a,n.Unique=s,n}},253:{f:function(e){var t=Jm(e);return t.isst=e.read_shift(4),t}},255:{f:function(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Rm},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Dm},353:{f:Am},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function(e,t,r){var a=e.l+t,s=e.read_shift(2),n=e.read_shift(2);if(r.sbcch=n,1025==n||14849==n)return[n,s];if(n<1||n>255)throw new Error("Unexpected SupBook type: "+n);for(var i=Bm(e,n),o=[];a>e.l;)o.push(Um(e));return[n,s,i,o]}},431:{f:Dm},432:{},433:{},434:{},437:{},438:{f:function(e,t,r){var a=e.l,s="";try{e.l+=4;var n=(r.lastobj||{cmo:[0,0]}).cmo[1];-1==[0,5,7,11,12,14].indexOf(n)?e.l+=6:function(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}(e);var i=e.read_shift(2);e.read_shift(2),Im(e);var o=e.read_shift(2);e.l+=o;for(var l=1;l<e.lens.length-1;++l){if(e.l-a!=e.lens[l])throw new Error("TxO: bad continue record");var c=e[e.l];if((s+=Bm(e,e.lens[l+1]-e.lens[l]-1)).length>=(c?i:2*i))break}if(s.length!==i&&s.length!==2*i)throw new Error("cchText: "+i+" != "+s.length);return e.l=a+t,{t:s}}catch(bN){return e.l=a+t,{t:s}}}},439:{f:Dm},440:{f:function(e,t){var r=ep(e);e.l+=16;var a=function(e,t){var r=e.l+t,a=e.read_shift(4);if(2!==a)throw new Error("Unrecognized streamVersion: "+a);var s=e.read_shift(2);e.l+=2;var n,i,o,l,c,d,u="";16&s&&(n=Gm(e,e.l)),128&s&&(i=Gm(e,e.l)),257===(257&s)&&(o=Gm(e,e.l)),1===(257&s)&&(l=Vm(e,e.l)),8&s&&(u=Gm(e,e.l)),32&s&&(c=e.read_shift(16)),64&s&&(d=mm(e)),e.l=r;var h=i||o||l||"";h&&u&&(h+="#"+u),h||(h="#"+u),2&s&&"/"==h.charAt(0)&&"/"!=h.charAt(1)&&(h="file://"+h);var f={Target:h};return c&&(f.guid=c),d&&(f.time=d),n&&(f.Tooltip=n),f}(e,t-24);return[r,a]}},441:{},442:{f:Um},443:{},444:{f:Im},445:{},446:{},448:{f:Am},449:{f:function(e){return e.read_shift(2),e.read_shift(4)},r:2},450:{f:Am},512:{f:fp},513:{f:Ep},515:{f:function(e,t,r){r.biffguess&&2==r.biff&&(r.biff=5);var a=Jm(e),s=Cf(e);return a.val=s,a}},516:{f:function(e,t,r){r.biffguess&&2==r.biff&&(r.biff=5),e.l;var a=Jm(e);2==r.biff&&e.l++;var s=Um(e,e.l,r);return a.val=s,a}},517:{f:pp},519:{f:_p},520:{f:function(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,7&a&&(t.level=7&a),32&a&&(t.hidden=!0),64&a&&(t.hpt=r/20),t}},523:{},545:{f:wp},549:{f:dp},566:{},574:{f:function(e,t,r){return r&&r.biff>=2&&r.biff<5?{}:{RTL:64&e.read_shift(2)}}},638:{f:function(e){var t=e.read_shift(2),r=e.read_shift(2),a=Zm(e);return{r:t,c:r,ixfe:a[0],rknum:a[1]}}},659:{},1048:{},1054:{f:function(e,t,r){return[e.read_shift(2),Wm(e,0,r)]}},1084:{},1212:{f:function(e,t,r){var a=rp(e);e.l++;var s=e.read_shift(1);return[Ux(e,t-=8,r),s,a]}},2048:{f:function(e,t){e.read_shift(2);var r=ep(e),a=e.read_shift((t-10)/2,"dbcs-cont");return[r,a=a.replace(pc,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:op},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Am},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t},r:12},2173:{f:function(e,t){e.l,e.l+=2;var r=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),s=[];a-- >0;)s.push(Jg(e,e.l));return{ixfe:r,ext:s}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Dm,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),s=e.read_shift(2);return[Bm(e,a,r),Bm(e,s,r)]}e.l+=t},r:12},2197:{},2198:{f:function(e,t,r){var a=e.l+t;if(124226!==e.read_shift(4))if(r.cellStyles){var s,n=e.slice(e.l);e.l=a;try{s=Kd(n,{type:"array"})}catch(bN){return}var i=Hd(s,"theme/theme/theme1.xml",!0);if(i)return $g(i,r)}else e.l=a},r:12},2199:{},2200:{},2201:{},2202:{f:function(e){return[0!==e.read_shift(4),0!==e.read_shift(4),e.read_shift(4)]},r:12},2203:{f:Am},2204:{},2205:{},2206:{},2207:{},2211:{f:function(e){var t=function(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}(e);if(2211!=t.type)throw new Error("Invalid Future Record "+t.type);return 0!==e.read_shift(4)}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Im},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function(e,t,r){var a={area:!1};if(5!=r.biff)return e.l+=t,a;var s=e.read_shift(1);return e.l+=3,16&s&&(a.area=!0),a}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Ym(e));return r}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:fp},1:{},2:{f:function(e){var t=Jm(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}},3:{f:function(e){var t=Jm(e);++e.l;var r=Cf(e);return t.t="n",t.val=r,t}},4:{f:function(e,t,r){r.biffguess&&5==r.biff&&(r.biff=2);var a=Jm(e);++e.l;var s=Wm(e,0,r);return a.t="str",a.val=s,a}},5:{f:pp},7:{f:function(e){var t=e.read_shift(1);return 0===t?(e.l++,""):e.read_shift(t,"sbcs-cont")}},8:{},9:{f:op},11:{},22:{f:Im},30:{f:hp},31:{},32:{},33:{f:wp},36:{},37:{f:dp},50:{f:function(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}},62:{},52:{},67:{},68:{f:Im},69:{},86:{},126:{},127:{f:function(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),s={fmt:t,env:r,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,s}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function(e,t,r){var a=e.l+t,s=Jm(e),n=e.read_shift(2),i=Bm(e,n,r);return e.l=a,s.t="str",s.val=i,s}},223:{},234:{},354:{},421:{},518:{f:Wx},521:{f:op},536:{f:vp},547:{f:xp},561:{},579:{},1030:{f:Wx},1033:{f:op},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Yv(e,t,r,a){var s=t;if(!isNaN(s)){var n=a||(r||[]).length||0,i=e.next(4);i.write_shift(2,s),i.write_shift(2,n),n>0&&wh(r)&&e.push(r)}}function Jv(e,t,r){return e||(e=Fh(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function Xv(e,t,r,a){if(null!=t.v)switch(t.t){case"d":case"n":var s="d"==t.t?wd(Ad(t.v)):t.v;return void(s==(0|s)&&s>=0&&s<65536?Yv(e,2,function(e,t,r){var a=Fh(9);return Jv(a,e,t),a.write_shift(2,r),a}(r,a,s)):Yv(e,3,function(e,t,r){var a=Fh(15);return Jv(a,e,t),a.write_shift(8,r,"f"),a}(r,a,s)));case"b":case"e":return void Yv(e,5,function(e,t,r,a){var s=Fh(9);return Jv(s,e,t),Mm(r,a||"b",s),s}(r,a,t.v,t.t));case"s":case"str":return void Yv(e,4,function(e,t,r){var a=Fh(8+2*r.length);return Jv(a,e,t),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}(r,a,(t.v||"").slice(0,255)))}Yv(e,1,Jv(null,r,a))}function Qv(e,t){var r=t||{};for(var a=zh(),s=0,n=0;n<e.SheetNames.length;++n)e.SheetNames[n]==r.sheet&&(s=n);if(0==s&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Yv(a,4==r.biff?1033:3==r.biff?521:9,lp(0,16,r)),function(e,t,r,a){var s,n=Array.isArray(t),i=Zh(t["!ref"]||"A1"),o="",l=[];if(i.e.c>255||i.e.r>16383){if(a.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),s=Qh(i)}for(var c=i.s.r;c<=i.e.r;++c){o=qh(c);for(var d=i.s.c;d<=i.e.c;++d){c===i.s.r&&(l[d]=Kh(d)),s=l[d]+o;var u=n?(t[c]||[])[d]:t[s];u&&Xv(e,u,c,d)}}}(a,e.Sheets[e.SheetNames[s]],0,r),Yv(a,10),a.end()}function Zv(e,t,r){Yv(e,49,function(e,t){var r=e.name||"Arial",a=t&&5==t.biff,s=Fh(a?15+r.length:16+2*r.length);return s.write_shift(2,20*(e.sz||12)),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),a||s.write_shift(1,1),s.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),s}({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function ey(e,t){if(t){var r=0;t.forEach(function(t,a){++r<=256&&t&&Yv(e,125,function(e,t){var r=Fh(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,256*e.width),r.write_shift(2,0);var a=0;return e.hidden&&(a|=1),r.write_shift(1,a),a=e.level||0,r.write_shift(1,a),r.write_shift(2,0),r}(ib(a,t),a))})}}function ty(e,t,r,a,s){var n=16+lb(s.cellXfs,t,s);if(null!=t.v||t.bf)if(t.bf)Yv(e,6,Hx(t,r,a,0,n));else switch(t.t){case"d":case"n":Yv(e,515,function(e,t,r,a){var s=Fh(14);return Xm(e,t,a,s),Af(r,s),s}(r,a,"d"==t.t?wd(Ad(t.v)):t.v,n));break;case"b":case"e":Yv(e,517,function(e,t,r,a,s,n){var i=Fh(8);return Xm(e,t,a,i),Mm(r,n,i),i}(r,a,t.v,n,0,t.t));break;case"s":case"str":if(s.bookSST)Yv(e,253,function(e,t,r,a){var s=Fh(10);return Xm(e,t,a,s),s.write_shift(4,r),s}(r,a,nb(s.Strings,t.v,s.revStrings),n));else Yv(e,516,function(e,t,r,a,s){var n=!s||8==s.biff,i=Fh(+n+8+(1+n)*r.length);return Xm(e,t,a,i),i.write_shift(2,r.length),n&&i.write_shift(1,1),i.write_shift((1+n)*r.length,r,n?"utf16le":"sbcs"),i}(r,a,(t.v||"").slice(0,255),n,s));break;default:Yv(e,513,Xm(r,a,n))}else Yv(e,513,Xm(r,a,n))}function ry(e,t,r){var a,s=zh(),n=r.SheetNames[e],i=r.Sheets[n]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(i),d=8==t.biff,u="",h=[],f=Zh(i["!ref"]||"A1"),m=d?65536:16384;if(f.e.c>255||f.e.r>=m){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");f.e.c=Math.min(f.e.c,255),f.e.r=Math.min(f.e.c,m-1)}Yv(s,2057,lp(0,16,t)),Yv(s,13,Om(1)),Yv(s,12,Om(100)),Yv(s,15,Pm(!0)),Yv(s,17,Pm(!1)),Yv(s,16,Af(.001)),Yv(s,95,Pm(!0)),Yv(s,42,Pm(!1)),Yv(s,43,Pm(!1)),Yv(s,130,Om(1)),Yv(s,128,function(e){var t=Fh(8);return t.write_shift(4,0),t.write_shift(2,e[0]?e[0]+1:0),t.write_shift(2,e[1]?e[1]+1:0),t}([0,0])),Yv(s,131,Pm(!1)),Yv(s,132,Pm(!1)),d&&ey(s,i["!cols"]),Yv(s,512,function(e,t){var r=8!=t.biff&&t.biff?2:4,a=Fh(2*r+6);return a.write_shift(r,e.s.r),a.write_shift(r,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}(f,t)),d&&(i["!links"]=[]);for(var p=f.s.r;p<=f.e.r;++p){u=qh(p);for(var g=f.s.c;g<=f.e.c;++g){p===f.s.r&&(h[g]=Kh(g)),a=h[g]+u;var x=c?(i[p]||[])[g]:i[a];x&&(ty(s,x,p,g,t),d&&x.l&&i["!links"].push([a,x.l]))}}var b=l.CodeName||l.name||n;return d&&Yv(s,574,function(e){var t=Fh(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}((o.Views||[])[0])),d&&(i["!merges"]||[]).length&&Yv(s,229,function(e){var t=Fh(2+8*e.length);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)tp(e[r],t);return t}(i["!merges"])),d&&function(e,t){for(var r=0;r<t["!links"].length;++r){var a=t["!links"][r];Yv(e,440,Np(a)),a[1].Tooltip&&Yv(e,2048,kp(a))}delete t["!links"]}(s,i),Yv(s,442,Hm(b)),d&&function(e,t){var r=Fh(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Yv(e,2151,r),(r=Fh(39)).write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),tp(Zh(t["!ref"]||"A1"),r),r.write_shift(4,4),Yv(e,2152,r)}(s,i),Yv(s,10),s.end()}function ay(e,t,r){var a=zh(),s=(e||{}).Workbook||{},n=s.Sheets||[],i=s.WBProps||{},o=8==r.biff,l=5==r.biff;(Yv(a,2057,lp(0,5,r)),"xla"==r.bookType&&Yv(a,135),Yv(a,225,o?Om(1200):null),Yv(a,193,function(e,t){t||(t=Fh(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}(2)),l&&Yv(a,191),l&&Yv(a,192),Yv(a,226),Yv(a,92,function(e,t){var r=!t||8==t.biff,a=Fh(r?112:54);for(a.write_shift(8==t.biff?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}(0,r)),Yv(a,66,Om(o?1200:1252)),o&&Yv(a,353,Om(0)),o&&Yv(a,448),Yv(a,317,function(e){for(var t=Fh(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}(e.SheetNames.length)),o&&e.vbaraw&&Yv(a,211),o&&e.vbaraw)&&Yv(a,442,Hm(i.CodeName||"ThisWorkbook"));Yv(a,156,Om(17)),Yv(a,25,Pm(!1)),Yv(a,18,Pm(!1)),Yv(a,19,Om(0)),o&&Yv(a,431,Pm(!1)),o&&Yv(a,444,Om(0)),Yv(a,61,function(){var e=Fh(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}()),Yv(a,64,Pm(!1)),Yv(a,141,Om(0)),Yv(a,34,Pm("true"==function(e){return e.Workbook&&e.Workbook.WBProps&&mu(e.Workbook.WBProps.date1904)?"true":"false"}(e))),Yv(a,14,Pm(!0)),o&&Yv(a,439,Pm(!1)),Yv(a,218,Om(0)),Zv(a,0,r),function(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)null!=t[s]&&Yv(e,1054,up(s,t[s],r))})}(a,e.SSF,r),function(e,t){for(var r=0;r<16;++r)Yv(e,224,mp({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(r){Yv(e,224,mp(r,0,t))})}(a,r),o&&Yv(a,352,Pm(!1));var c,d=a.end(),u=zh();o&&Yv(u,140,(c||(c=Fh(4)),c.write_shift(2,1),c.write_shift(2,1),c)),o&&r.Strings&&function(e,t,r,a){var s=a||(r||[]).length||0;if(s<=8224)return Yv(e,t,r,s);var n=t;if(!isNaN(n)){for(var i=r.parts||[],o=0,l=0,c=0;c+(i[o]||8224)<=8224;)c+=i[o]||8224,o++;var d=e.next(4);for(d.write_shift(2,n),d.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c;l<s;){for((d=e.next(4)).write_shift(2,60),c=0;c+(i[o]||8224)<=8224;)c+=i[o]||8224,o++;d.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c}}}(u,252,function(e){var t=Fh(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var r=[],a=0;a<e.length;++a)r[a]=zm(e[a]);var s=mc([t].concat(r));return s.parts=[t.length].concat(r.map(function(e){return e.length})),s}(r.Strings)),Yv(u,10);var h=u.end(),f=zh(),m=0,p=0;for(p=0;p<e.SheetNames.length;++p)m+=(o?12:11)+(o?2:1)*e.SheetNames[p].length;var g=d.length+m+h.length;for(p=0;p<e.SheetNames.length;++p){Yv(f,133,cp({pos:g,hs:(n[p]||{}).Hidden||0,dt:0,name:e.SheetNames[p]},r)),g+=t[p].length}var x=f.end();if(m!=x.length)throw new Error("BS8 "+m+" != "+x.length);var b=[];return d.length&&b.push(d),x.length&&b.push(x),h.length&&b.push(h),mc(b)}function sy(e,t){for(var r=0;r<=e.SheetNames.length;++r){var a=e.Sheets[e.SheetNames[r]];if(a&&a["!ref"])Xh(a["!ref"]).e.c>255&&"undefined"!=typeof console&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}var s=t||{};switch(s.biff||2){case 8:case 5:return function(e,t){var r=t||{},a=[];e&&!e.SSF&&(e.SSF=Pd(Ec)),e&&e.SSF&&(od(),id(e.SSF),r.revssf=vd(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Xy(r),r.cellXfs=[],lb(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)a[a.length]=ry(s,r,e);return a.unshift(ay(e,a,r)),mc(a)}(e,t);case 4:case 3:case 2:return Qv(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function ny(e,t){var r=t||{};var a=r.dense?[]:{},s=(e=e.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var n=e.match(/<\/table/i),i=s.index,o=n&&n.index||e.length,l=Fd(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,d=0,u=0,h=0,f={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(i=0;i<l.length;++i){var p=l[i].trim(),g=p.slice(0,3).toLowerCase();if("<tr"!=g){if("<td"==g||"<th"==g){var x=p.split(/<\/t[dh]>/i);for(o=0;o<x.length;++o){var b=x[o].trim();if(b.match(/<t[dh]/i)){for(var v=b,y=0;"<"==v.charAt(0)&&(y=v.indexOf(">"))>-1;)v=v.slice(y+1);for(var w=0;w<m.length;++w){var j=m[w];j.s.c==d&&j.s.r<c&&c<=j.e.r&&(d=j.e.c+1,w=-1)}var N=ru(b.slice(0,b.indexOf(">")));h=N.colspan?+N.colspan:1,((u=+N.rowspan)>1||h>1)&&m.push({s:{r:c,c:d},e:{r:c+(u||1)-1,c:d+h-1}});var k=N.t||N["data-t"]||"";if(v.length)if(v=ju(v),f.s.r>c&&(f.s.r=c),f.e.r<c&&(f.e.r=c),f.s.c>d&&(f.s.c=d),f.e.c<d&&(f.e.c=d),v.length){var S={t:"s",v:v};r.raw||!v.trim().length||"s"==k||("TRUE"===v?S={t:"b",v:!0}:"FALSE"===v?S={t:"b",v:!1}:isNaN(Od(v))?isNaN(Md(v).getDate())||(S={t:"d",v:Ad(v)},r.cellDates||(S={t:"n",v:wd(S.v)}),S.z=r.dateNF||Ec[14]):S={t:"n",v:Od(v)}),r.dense?(a[c]||(a[c]=[]),a[c][d]=S):a[Jh({r:c,c:d})]=S,d+=h}else d+=h;else d+=h}}}}else{if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}d=0}}return a["!ref"]=Qh(f),m.length&&(a["!merges"]=m),a}function iy(e,t,r,a){for(var s=e["!merges"]||[],n=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,l=0,c=0;c<s.length;++c)if(!(s[c].s.r>r||s[c].s.c>i)&&!(s[c].e.r<r||s[c].e.c<i)){if(s[c].s.r<r||s[c].s.c<i){o=-1;break}o=s[c].e.r-s[c].s.r+1,l=s[c].e.c-s[c].s.c+1;break}if(!(o<0)){var d=Jh({r:r,c:i}),u=a.dense?(e[r]||[])[i]:e[d],h=u&&null!=u.v&&(u.h||hu(u.w||(tf(u),u.w)||""))||"",f={};o>1&&(f.rowspan=o),l>1&&(f.colspan=l),a.editable?h='<span contenteditable="true">'+h+"</span>":u&&(f["data-t"]=u&&u.t||"z",null!=u.v&&(f["data-v"]=u.v),null!=u.z&&(f["data-z"]=u.z),u.l&&"#"!=(u.l.Target||"#").charAt(0)&&(h='<a href="'+u.l.Target+'">'+h+"</a>")),f.id=(a.id||"sjs")+"-"+d,n.push(Au("td",h,f))}}return"<tr>"+n.join("")+"</tr>"}var oy='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',ly="</body></html>";function cy(e,t,r){return[].join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function dy(e,t){var r=t||{},a=null!=r.header?r.header:oy,s=null!=r.footer?r.footer:ly,n=[a],i=Xh(e["!ref"]);r.dense=Array.isArray(e),n.push(cy(0,0,r));for(var o=i.s.r;o<=i.e.r;++o)n.push(iy(e,i,o,r));return n.push("</table>"+s),n.join("")}function uy(e,t,r){var a=r||{};var s=0,n=0;if(null!=a.origin)if("number"==typeof a.origin)s=a.origin;else{var i="string"==typeof a.origin?Yh(a.origin):a.origin;s=i.r,n=i.c}var o=t.getElementsByTagName("tr"),l=Math.min(a.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:s,c:n}};if(e["!ref"]){var d=Xh(e["!ref"]);c.s.r=Math.min(c.s.r,d.s.r),c.s.c=Math.min(c.s.c,d.s.c),c.e.r=Math.max(c.e.r,d.e.r),c.e.c=Math.max(c.e.c,d.e.c),-1==s&&(c.e.r=s=d.e.r+1)}var u=[],h=0,f=e["!rows"]||(e["!rows"]=[]),m=0,p=0,g=0,x=0,b=0,v=0;for(e["!cols"]||(e["!cols"]=[]);m<o.length&&p<l;++m){var y=o[m];if(fy(y)){if(a.display)continue;f[p]={hidden:!0}}var w=y.children;for(g=x=0;g<w.length;++g){var j=w[g];if(!a.display||!fy(j)){var N=j.hasAttribute("data-v")?j.getAttribute("data-v"):j.hasAttribute("v")?j.getAttribute("v"):ju(j.innerHTML),k=j.getAttribute("data-z")||j.getAttribute("z");for(h=0;h<u.length;++h){var S=u[h];S.s.c==x+n&&S.s.r<p+s&&p+s<=S.e.r&&(x=S.e.c+1-n,h=-1)}v=+j.getAttribute("colspan")||1,((b=+j.getAttribute("rowspan")||1)>1||v>1)&&u.push({s:{r:p+s,c:x+n},e:{r:p+s+(b||1)-1,c:x+n+(v||1)-1}});var E={t:"s",v:N},T=j.getAttribute("data-t")||j.getAttribute("t")||"";null!=N&&(0==N.length?E.t=T||"z":a.raw||0==N.trim().length||"s"==T||("TRUE"===N?E={t:"b",v:!0}:"FALSE"===N?E={t:"b",v:!1}:isNaN(Od(N))?isNaN(Md(N).getDate())||(E={t:"d",v:Ad(N)},a.cellDates||(E={t:"n",v:wd(E.v)}),E.z=a.dateNF||Ec[14]):E={t:"n",v:Od(N)})),void 0===E.z&&null!=k&&(E.z=k);var _="",C=j.getElementsByTagName("A");if(C&&C.length)for(var A=0;A<C.length&&(!C[A].hasAttribute("href")||"#"==(_=C[A].getAttribute("href")).charAt(0));++A);_&&"#"!=_.charAt(0)&&(E.l={Target:_}),a.dense?(e[p+s]||(e[p+s]=[]),e[p+s][x+n]=E):e[Jh({c:x+n,r:p+s})]=E,c.e.c<x+n&&(c.e.c=x+n),x+=v}}++p}return u.length&&(e["!merges"]=(e["!merges"]||[]).concat(u)),c.e.r=Math.max(c.e.r,p-1+s),e["!ref"]=Qh(c),p>=l&&(e["!fullref"]=Qh((c.e.r=o.length-m+p-1+s,c))),e}function hy(e,t){return uy((t||{}).dense?[]:{},e,t)}function fy(e){var t="",r=function(e){return e.ownerDocument.defaultView&&"function"===typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"===typeof getComputedStyle?getComputedStyle:null}(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),"none"===t}function my(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(e,t){return Array(parseInt(t,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n");return[iu(t.replace(/<[^>]*>/g,""))]}var py={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function gy(e,t){var r=t||{};var a,s,n,i,o,l,c=Pu(e),d=[],u={name:""},h="",f=0,m={},p=[],g=r.dense?[]:{},x={value:""},b="",v=0,y=[],w=-1,j=-1,N={s:{r:1e6,c:1e7},e:{r:0,c:0}},k=0,S={},E=[],T={},_=[],C=1,A=1,D=[],P={Names:[]},I={},O=["",""],R=[],M={},F="",L=0,z=!1,B=!1,U=0;for(Iu.lastIndex=0,c=c.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");o=Iu.exec(c);)switch(o[3]=o[3].replace(/_.*$/,"")){case"table":case"\u5de5\u4f5c\u8868":"/"===o[1]?(N.e.c>=N.s.c&&N.e.r>=N.s.r?g["!ref"]=Qh(N):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=N.e.r&&(g["!fullref"]=g["!ref"],N.e.r=r.sheetRows-1,g["!ref"]=Qh(N)),E.length&&(g["!merges"]=E),_.length&&(g["!rows"]=_),n.name=n["\u540d\u79f0"]||n.name,"undefined"!==typeof JSON&&JSON.stringify(n),p.push(n.name),m[n.name]=g,B=!1):"/"!==o[0].charAt(o[0].length-2)&&(n=ru(o[0],!1),w=j=-1,N.s.r=N.s.c=1e7,N.e.r=N.e.c=0,g=r.dense?[]:{},E=[],_=[],B=!0);break;case"table-row-group":"/"===o[1]?--k:++k;break;case"table-row":case"\u884c":if("/"===o[1]){w+=C,C=1;break}if((i=ru(o[0],!1))["\u884c\u53f7"]?w=i["\u884c\u53f7"]-1:-1==w&&(w=0),(C=+i["number-rows-repeated"]||1)<10)for(U=0;U<C;++U)k>0&&(_[w+U]={level:k});j=-1;break;case"covered-table-cell":"/"!==o[1]&&++j,r.sheetStubs&&(r.dense?(g[w]||(g[w]=[]),g[w][j]={t:"z"}):g[Jh({r:w,c:j})]={t:"z"}),b="",y=[];break;case"table-cell":case"\u6570\u636e":if("/"===o[0].charAt(o[0].length-2))++j,x=ru(o[0],!1),A=parseInt(x["number-columns-repeated"]||"1",10),l={t:"z",v:null},x.formula&&0!=r.cellFormula&&(l.f=Qx(iu(x.formula))),"string"==(x["\u6570\u636e\u7c7b\u578b"]||x["value-type"])&&(l.t="s",l.v=iu(x["string-value"]||""),r.dense?(g[w]||(g[w]=[]),g[w][j]=l):g[Jh({r:w,c:j})]=l),j+=A-1;else if("/"!==o[1]){b="",v=0,y=[],A=1;var W=C?w+C-1:w;if(++j>N.e.c&&(N.e.c=j),j<N.s.c&&(N.s.c=j),w<N.s.r&&(N.s.r=w),W>N.e.r&&(N.e.r=W),R=[],M={},l={t:(x=ru(o[0],!1))["\u6570\u636e\u7c7b\u578b"]||x["value-type"],v:null},r.cellFormula)if(x.formula&&(x.formula=iu(x.formula)),x["number-matrix-columns-spanned"]&&x["number-matrix-rows-spanned"]&&(T={s:{r:w,c:j},e:{r:w+(parseInt(x["number-matrix-rows-spanned"],10)||0)-1,c:j+(parseInt(x["number-matrix-columns-spanned"],10)||0)-1}},l.F=Qh(T),D.push([T,l.F])),x.formula)l.f=Qx(x.formula);else for(U=0;U<D.length;++U)w>=D[U][0].s.r&&w<=D[U][0].e.r&&j>=D[U][0].s.c&&j<=D[U][0].e.c&&(l.F=D[U][1]);switch((x["number-columns-spanned"]||x["number-rows-spanned"])&&(T={s:{r:w,c:j},e:{r:w+(parseInt(x["number-rows-spanned"],10)||0)-1,c:j+(parseInt(x["number-columns-spanned"],10)||0)-1}},E.push(T)),x["number-columns-repeated"]&&(A=parseInt(x["number-columns-repeated"],10)),l.t){case"boolean":l.t="b",l.v=mu(x["boolean-value"]);break;case"float":case"percentage":case"currency":l.t="n",l.v=parseFloat(x.value);break;case"date":l.t="d",l.v=Ad(x["date-value"]),r.cellDates||(l.t="n",l.v=wd(l.v)),l.z="m/d/yy";break;case"time":l.t="n",l.v=Ed(x["time-value"])/86400,r.cellDates&&(l.t="d",l.v=Sd(l.v)),l.z="HH:MM:SS";break;case"number":l.t="n",l.v=parseFloat(x["\u6570\u636e\u6570\u503c"]);break;default:if("string"!==l.t&&"text"!==l.t&&l.t)throw new Error("Unsupported value type "+l.t);l.t="s",null!=x["string-value"]&&(b=iu(x["string-value"]),y=[])}}else{if(z=!1,"s"===l.t&&(l.v=b||"",y.length&&(l.R=y),z=0==v),I.Target&&(l.l=I),R.length>0&&(l.c=R,R=[]),b&&!1!==r.cellText&&(l.w=b),z&&(l.t="z",delete l.v),(!z||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=w))for(var H=0;H<C;++H){if(A=parseInt(x["number-columns-repeated"]||"1",10),r.dense)for(g[w+H]||(g[w+H]=[]),g[w+H][j]=0==H?l:Pd(l);--A>0;)g[w+H][j+A]=Pd(l);else for(g[Jh({r:w+H,c:j})]=l;--A>0;)g[Jh({r:w+H,c:j+A})]=Pd(l);N.e.c<=j&&(N.e.c=j)}j+=(A=parseInt(x["number-columns-repeated"]||"1",10))-1,A=0,l={},b="",y=[]}I={};break;case"document":case"document-content":case"\u7535\u5b50\u8868\u683c\u6587\u6863":case"spreadsheet":case"\u4e3b\u4f53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if("/"===o[1]){if((a=d.pop())[0]!==o[3])throw"Bad state: "+a}else"/"!==o[0].charAt(o[0].length-2)&&d.push([o[3],!0]);break;case"annotation":if("/"===o[1]){if((a=d.pop())[0]!==o[3])throw"Bad state: "+a;M.t=b,y.length&&(M.R=y),M.a=F,R.push(M)}else"/"!==o[0].charAt(o[0].length-2)&&d.push([o[3],!1]);F="",L=0,b="",v=0,y=[];break;case"creator":"/"===o[1]?F=c.slice(L,o.index):L=o.index+o[0].length;break;case"meta":case"\u5143\u6570\u636e":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===o[1]){if((a=d.pop())[0]!==o[3])throw"Bad state: "+a}else"/"!==o[0].charAt(o[0].length-2)&&d.push([o[3],!1]);b="",v=0,y=[];break;case"scientific-number":case"currency-symbol":case"currency-style":case"script":case"libraries":case"automatic-styles":case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":case"fraction":case"boolean-style":case"boolean":case"text-style":case"text-content":case"text-properties":case"embedded-text":case"body":case"\u7535\u5b50\u8868\u683c":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":case"s":case"date":case"object":case"title":case"\u6807\u9898":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if("/"===o[1]){if(S[u.name]=h,(a=d.pop())[0]!==o[3])throw"Bad state: "+a}else"/"!==o[0].charAt(o[0].length-2)&&(h="",u=ru(o[0],!1),d.push([o[3],!0]));break;case"number":case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(d[d.length-1][0]){case"time-style":case"date-style":s=ru(o[0],!1),h+=py[o[3]]["long"===s.style?1:0]}break;case"text":if("/>"===o[0].slice(-2))break;if("/"===o[1])switch(d[d.length-1][0]){case"number-style":case"date-style":case"time-style":h+=c.slice(f,o.index)}else f=o.index+o[0].length;break;case"named-range":O=eb((s=ru(o[0],!1))["cell-range-address"]);var V={Name:s.name,Ref:O[0]+"!"+O[1]};B&&(V.Sheet=p.length),P.Names.push(V);break;case"p":case"\u6587\u672c\u4e32":if(["master-styles"].indexOf(d[d.length-1][0])>-1)break;if("/"!==o[1]||x&&x["string-value"])ru(o[0],!1),v=o.index+o[0].length;else{var G=my(c.slice(v,o.index));b=(b.length>0?b+"\n":"")+G[0]}break;case"database-range":if("/"===o[1])break;try{m[(O=eb(ru(o[0])["target-range-address"]))[0]]["!autofilter"]={ref:O[1]}}catch(bN){}break;case"a":if("/"!==o[1]){if(!(I=ru(o[0],!1)).href)break;I.Target=iu(I.href),delete I.href,"#"==I.Target.charAt(0)&&I.Target.indexOf(".")>-1?(O=eb(I.Target.slice(1)),I.Target="#"+O[0]+"!"+O[1]):I.Target.match(/^\.\.[\\\/]/)&&(I.Target=I.Target.slice(3))}break;default:switch(o[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5b57:":break;default:if(r.WTF)throw new Error(o)}}var q={Sheets:m,SheetNames:p,Workbook:P};return r.bookSheets&&delete q.Sheets,q}function xy(e,t){t=t||{},Bd(e,"META-INF/manifest.xml")&&function(e,t){for(var r,a,s=Pu(e);r=Iu.exec(s);)switch(r[3]){case"manifest":break;case"file-entry":if("/"==(a=ru(r[0],!1)).path&&"application/vnd.oasis.opendocument.spreadsheet"!==a.type)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw r}}(Wd(e,"META-INF/manifest.xml"),t);var r=Hd(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=gy(vu(r),t);return Bd(e,"meta.xml")&&(a.Props=rm(Wd(e,"meta.xml"))),a}function by(e,t){return gy(e,t)}var vy=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Cu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Jd+t}}(),yy=function(){var e=function(e){return cu(e).replace(/  +/g,function(e){return'<text:s text:c="'+e.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t="          <table:table-cell />\n",r=function(r,a,s){var n=[];n.push('      <table:table table:name="'+cu(a.SheetNames[s])+'" table:style-name="ta1">\n');var i=0,o=0,l=Xh(r["!ref"]||"A1"),c=r["!merges"]||[],d=0,u=Array.isArray(r);if(r["!cols"])for(o=0;o<=l.e.c;++o)n.push("        <table:table-column"+(r["!cols"][o]?' table:style-name="co'+r["!cols"][o].ods+'"':"")+"></table:table-column>\n");var h="",f=r["!rows"]||[];for(i=0;i<l.s.r;++i)h=f[i]?' table:style-name="ro'+f[i].ods+'"':"",n.push("        <table:table-row"+h+"></table:table-row>\n");for(;i<=l.e.r;++i){for(h=f[i]?' table:style-name="ro'+f[i].ods+'"':"",n.push("        <table:table-row"+h+">\n"),o=0;o<l.s.c;++o)n.push(t);for(;o<=l.e.c;++o){var m=!1,p={},g="";for(d=0;d!=c.length;++d)if(!(c[d].s.c>o)&&!(c[d].s.r>i)&&!(c[d].e.c<o)&&!(c[d].e.r<i)){c[d].s.c==o&&c[d].s.r==i||(m=!0),p["table:number-columns-spanned"]=c[d].e.c-c[d].s.c+1,p["table:number-rows-spanned"]=c[d].e.r-c[d].s.r+1;break}if(m)n.push("          <table:covered-table-cell/>\n");else{var x=Jh({r:i,c:o}),b=u?(r[i]||[])[o]:r[x];if(b&&b.f&&(p["table:formula"]=cu(Zx(b.f)),b.F&&b.F.slice(0,x.length)==x)){var v=Xh(b.F);p["table:number-matrix-columns-spanned"]=v.e.c-v.s.c+1,p["table:number-matrix-rows-spanned"]=v.e.r-v.s.r+1}if(b){switch(b.t){case"b":g=b.v?"TRUE":"FALSE",p["office:value-type"]="boolean",p["office:boolean-value"]=b.v?"true":"false";break;case"n":g=b.w||String(b.v||0),p["office:value-type"]="float",p["office:value"]=b.v||0;break;case"s":case"str":g=null==b.v?"":b.v,p["office:value-type"]="string";break;case"d":g=b.w||Ad(b.v).toISOString(),p["office:value-type"]="date",p["office:date-value"]=Ad(b.v).toISOString(),p["table:style-name"]="ce1";break;default:n.push(t);continue}var y=e(g);if(b.l&&b.l.Target){var w=b.l.Target;"#"==(w="#"==w.charAt(0)?"#"+tb(w.slice(1)):w).charAt(0)||w.match(/^\w+:/)||(w="../"+w),y=Au("text:a",y,{"xlink:href":w.replace(/&/g,"&amp;")})}n.push("          "+Au("table:table-cell",Au("text:p",y,{}),p)+"\n")}else n.push(t)}}n.push("        </table:table-row>\n")}return n.push("      </table:table>\n"),n.join("")};return function(e,t){var a=[Jd],s=Cu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),n=Cu({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==t.bookType?(a.push("<office:document"+s+n+">\n"),a.push(Zf().replace(/office:document-meta/g,"office:meta"))):a.push("<office:document-content"+s+">\n"),function(e,t){e.push(" <office:automatic-styles>\n"),e.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),e.push('   <number:month number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push('   <number:day number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push("   <number:year/>\n"),e.push("  </number:date-style>\n");var r=0;t.SheetNames.map(function(e){return t.Sheets[e]}).forEach(function(t){if(t&&t["!cols"])for(var a=0;a<t["!cols"].length;++a)if(t["!cols"][a]){var s=t["!cols"][a];if(null==s.width&&null==s.wpx&&null==s.wch)continue;xg(s),s.ods=r;var n=t["!cols"][a].wpx+"px";e.push('  <style:style style:name="co'+r+'" style:family="table-column">\n'),e.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+n+'"/>\n'),e.push("  </style:style>\n"),++r}});var a=0;t.SheetNames.map(function(e){return t.Sheets[e]}).forEach(function(t){if(t&&t["!rows"])for(var r=0;r<t["!rows"].length;++r)if(t["!rows"][r]){t["!rows"][r].ods=a;var s=t["!rows"][r].hpx+"px";e.push('  <style:style style:name="ro'+a+'" style:family="table-row">\n'),e.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+s+'"/>\n'),e.push("  </style:style>\n"),++a}}),e.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'),e.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),e.push("  </style:style>\n"),e.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),e.push(" </office:automatic-styles>\n")}(a,e),a.push("  <office:body>\n"),a.push("    <office:spreadsheet>\n");for(var i=0;i!=e.SheetNames.length;++i)a.push(r(e.Sheets[e.SheetNames[i]],e,i));return a.push("    </office:spreadsheet>\n"),a.push("  </office:body>\n"),"fods"==t.bookType?a.push("</office:document>"):a.push("</office:document-content>"),a.join("")}}();function wy(e,t){if("fods"==t.bookType)return yy(e,t);var r=$d(),a="",s=[],n=[];return qd(r,a="mimetype","application/vnd.oasis.opendocument.spreadsheet"),qd(r,a="content.xml",yy(e,t)),s.push([a,"text/xml"]),n.push([a,"ContentFile"]),qd(r,a="styles.xml",vy(e,t)),s.push([a,"text/xml"]),n.push([a,"StylesFile"]),qd(r,a="meta.xml",Jd+Zf()),s.push([a,"text/xml"]),n.push([a,"MetadataFile"]),qd(r,a="manifest.rdf",function(e){var t=[Jd];t.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var r=0;r!=e.length;++r)t.push(Xf(e[r][0],e[r][1])),t.push(Qf("",e[r][0]));return t.push(Xf("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}(n)),s.push([a,"application/rdf+xml"]),qd(r,a="META-INF/manifest.xml",function(e){var t=[Jd];t.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),t.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+'"/>\n');return t.push("</manifest:manifest>"),t.join("")}(s)),r}function jy(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Ny(e){return"undefined"!=typeof TextDecoder?(new TextDecoder).decode(e):vu(hc(e))}function ky(e){return"undefined"!=typeof TextEncoder?(new TextEncoder).encode(e):dc(yu(e))}function Sy(e){var t=e.reduce(function(e,t){return e+t.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(e){r.set(e,a),a+=e.length}),r}function Ey(e){return 16843009*((e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135)>>>24}function Ty(e,t){var r=t?t[0]:0,a=127&e[r];e:if(e[r++]>=128){if(a|=(127&e[r])<<7,e[r++]<128)break e;if(a|=(127&e[r])<<14,e[r++]<128)break e;if(a|=(127&e[r])<<21,e[r++]<128)break e;if(a+=(127&e[r])*Math.pow(2,28),++r,e[r++]<128)break e;if(a+=(127&e[r])*Math.pow(2,35),++r,e[r++]<128)break e;if(a+=(127&e[r])*Math.pow(2,42),++r,e[r++]<128)break e}return t&&(t[0]=r),a}function _y(e){var t=new Uint8Array(7);t[0]=127&e;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383)break e;if(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)break e;if(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)break e;if(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)break e;if(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103)break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Cy(e){var t=0,r=127&e[t];e:if(e[t++]>=128){if(r|=(127&e[t])<<7,e[t++]<128)break e;if(r|=(127&e[t])<<14,e[t++]<128)break e;if(r|=(127&e[t])<<21,e[t++]<128)break e;r|=(127&e[t])<<28}return r}function Ay(e){for(var t=[],r=[0];r[0]<e.length;){var a,s=r[0],n=Ty(e,r),i=7&n,o=0;if(0==(n=Math.floor(n/8)))break;switch(i){case 0:for(var l=r[0];e[r[0]++]>=128;);a=e.slice(l,r[0]);break;case 5:o=4,a=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,a=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=Ty(e,r),a=e.slice(r[0],r[0]+o),r[0]+=o;break;default:throw new Error("PB Type ".concat(i," for Field ").concat(n," at offset ").concat(s))}var c={data:a,type:i};null==t[n]?t[n]=[c]:t[n].push(c)}return t}function Dy(e){var t=[];return e.forEach(function(e,r){e.forEach(function(e){e.data&&(t.push(_y(8*r+e.type)),2==e.type&&t.push(_y(e.data.length)),t.push(e.data))})}),Sy(t)}function Py(e,t){return(null==e?void 0:e.map(function(e){return t(e.data)}))||[]}function Iy(e){for(var t,r=[],a=[0];a[0]<e.length;){var s=Ty(e,a),n=Ay(e.slice(a[0],a[0]+s));a[0]+=s;var i={id:Cy(n[1][0].data),messages:[]};n[2].forEach(function(t){var r=Ay(t.data),s=Cy(r[3][0].data);i.messages.push({meta:r,data:e.slice(a[0],a[0]+s)}),a[0]+=s}),(null==(t=n[3])?void 0:t[0])&&(i.merge=Cy(n[3][0].data)>>>0>0),r.push(i)}return r}function Oy(e){var t=[];return e.forEach(function(e){var r=[];r[1]=[{data:_y(e.id),type:0}],r[2]=[],null!=e.merge&&(r[3]=[{data:_y(+!!e.merge),type:0}]);var a=[];e.messages.forEach(function(e){a.push(e.data),e.meta[3]=[{type:0,data:_y(e.data.length)}],r[2].push({data:Dy(e.meta),type:2})});var s=Dy(r);t.push(_y(s.length)),t.push(s),a.forEach(function(e){return t.push(e)})}),Sy(t)}function Ry(e,t){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=Ty(t,r),s=[];r[0]<t.length;){var n=3&t[r[0]];if(0!=n){var i=0,o=0;if(1==n?(o=4+(t[r[0]]>>2&7),i=(224&t[r[0]++])<<3,i|=t[r[0]++]):(o=1+(t[r[0]++]>>2),2==n?(i=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(i=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Sy(s)],0==i)throw new Error("Invalid offset 0");if(i>s[0].length)throw new Error("Invalid offset beyond length");if(o>=i)for(s.push(s[0].slice(-i)),o-=i;o>=s[s.length-1].length;)s.push(s[s.length-1]),o-=s[s.length-1].length;s.push(s[0].slice(-i,-i+o))}else{var l=t[r[0]++]>>2;if(l<60)++l;else{var c=l-59;l=t[r[0]],c>1&&(l|=t[r[0]+1]<<8),c>2&&(l|=t[r[0]+2]<<16),c>3&&(l|=t[r[0]+3]<<24),l>>>=0,l++,r[0]+=c}s.push(t.slice(r[0],r[0]+l)),r[0]+=l}}var d=Sy(s);if(d.length!=a)throw new Error("Unexpected length: ".concat(d.length," != ").concat(a));return d}function My(e){for(var t=[],r=0;r<e.length;){var a=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Ry(a,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Sy(t)}function Fy(e){for(var t=[],r=0;r<e.length;){var a=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var n=_y(a),i=n.length;t.push(n),a<=60?(i++,t.push(new Uint8Array([a-1<<2]))):a<=256?(i+=2,t.push(new Uint8Array([240,a-1&255]))):a<=65536?(i+=3,t.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(i+=4,t.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(i+=5,t.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),t.push(e.slice(r,r+a)),i+=a,s[0]=0,s[1]=255&i,s[2]=i>>8&255,s[3]=i>>16&255,r+=a}return Sy(t)}function Ly(e,t,r){var a,s=jy(e),n=s.getUint32(8,!0),i=12,o=-1,l=-1,c=NaN,d=NaN,u=new Date(2001,0,1);switch(1&n&&(c=function(e,t){for(var r=(127&e[t+15])<<7|e[t+14]>>1,a=1&e[t+14],s=t+13;s>=t;--s)a=256*a+e[s];return(128&e[t+15]?-a:a)*Math.pow(10,r-6176)}(e,i),i+=16),2&n&&(d=s.getFloat64(i,!0),i+=8),4&n&&(u.setTime(u.getTime()+1e3*s.getFloat64(i,!0)),i+=8),8&n&&(l=s.getUint32(i,!0),i+=4),16&n&&(o=s.getUint32(i,!0),i+=4),e[1]){case 0:break;case 2:case 10:a={t:"n",v:c};break;case 3:a={t:"s",v:t[l]};break;case 5:a={t:"d",v:u};break;case 6:a={t:"b",v:d>0};break;case 7:a={t:"n",v:d/86400};break;case 8:a={t:"e",v:0};break;case 9:if(!(o>-1))throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&n," : ").concat(e.slice(0,4)));a={t:"s",v:r[o]};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&n," : ").concat(e.slice(0,4)))}return a}function zy(e,t){var r=new Uint8Array(32),a=jy(r),s=12,n=0;switch(r[0]=5,e.t){case"n":r[1]=2,function(e,t,r){var a=Math.floor(0==r?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,a-6176);e[t+15]|=a>>7,e[t+14]|=(127&a)<<1;for(var n=0;s>=1;++n,s/=256)e[t+n]=255&s;e[t+15]|=r>=0?0:128}(r,s,e.v),n|=1,s+=16;break;case"b":r[1]=6,a.setFloat64(s,e.v?1:0,!0),n|=2,s+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,a.setUint32(s,t.indexOf(e.v),!0),n|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,n,!0),r.slice(0,s)}function By(e,t){var r=new Uint8Array(32),a=jy(r),s=12,n=0;switch(r[0]=3,e.t){case"n":r[2]=2,a.setFloat64(s,e.v,!0),n|=32,s+=8;break;case"b":r[2]=6,a.setFloat64(s,e.v?1:0,!0),n|=32,s+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,a.setUint32(s,t.indexOf(e.v),!0),n|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,n,!0),r.slice(0,s)}function Uy(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return function(e,t,r,a){var s,n=jy(e),i=n.getUint32(4,!0),o=(a>1?12:8)+4*Ey(i&(a>1?3470:398)),l=-1,c=-1,d=NaN,u=new Date(2001,0,1);switch(512&i&&(l=n.getUint32(o,!0),o+=4),o+=4*Ey(i&(a>1?12288:4096)),16&i&&(c=n.getUint32(o,!0),o+=4),32&i&&(d=n.getFloat64(o,!0),o+=8),64&i&&(u.setTime(u.getTime()+1e3*n.getFloat64(o,!0)),o+=8),e[2]){case 0:break;case 2:s={t:"n",v:d};break;case 3:s={t:"s",v:t[c]};break;case 5:s={t:"d",v:u};break;case 6:s={t:"b",v:d>0};break;case 7:s={t:"n",v:d/86400};break;case 8:s={t:"e",v:0};break;case 9:if(l>-1)s={t:"s",v:r[l]};else if(c>-1)s={t:"s",v:t[c]};else{if(isNaN(d))throw new Error("Unsupported cell type ".concat(e.slice(0,4)));s={t:"n",v:d}}break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return s}(e,t,r,e[0]);case 5:return Ly(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Wy(e){return Ty(Ay(e)[1][0].data)}function Hy(e,t){var r=Ay(t.data),a=Cy(r[1][0].data),s=r[3],n=[];return(s||[]).forEach(function(t){var r=Ay(t.data),s=Cy(r[1][0].data)>>>0;switch(a){case 1:n[s]=Ny(r[3][0].data);break;case 8:var i=Ay(e[Wy(r[9][0].data)][0].data),o=e[Wy(i[1][0].data)][0],l=Cy(o.meta[1][0].data);if(2001!=l)throw new Error("2000 unexpected reference to ".concat(l));var c=Ay(o.data);n[s]=c[3].map(function(e){return Ny(e.data)}).join("")}}),n}function Vy(e,t){var r,a=Ay(t.data),s=(null==(r=null==a?void 0:a[7])?void 0:r[0])?Cy(a[7][0].data)>>>0>0?1:0:-1,n=Py(a[5],function(e){return function(e,t){var r,a,s,n,i,o,l,c,d,u,h,f,m,p,g,x,b=Ay(e),v=Cy(b[1][0].data)>>>0,y=Cy(b[2][0].data)>>>0,w=(null==(a=null==(r=b[8])?void 0:r[0])?void 0:a.data)&&Cy(b[8][0].data)>0||!1;if((null==(n=null==(s=b[7])?void 0:s[0])?void 0:n.data)&&0!=t)g=null==(o=null==(i=b[7])?void 0:i[0])?void 0:o.data,x=null==(c=null==(l=b[6])?void 0:l[0])?void 0:c.data;else{if(!(null==(u=null==(d=b[4])?void 0:d[0])?void 0:u.data)||1==t)throw"NUMBERS Tile missing ".concat(t," cell storage");g=null==(f=null==(h=b[4])?void 0:h[0])?void 0:f.data,x=null==(p=null==(m=b[3])?void 0:m[0])?void 0:p.data}for(var j=w?4:1,N=jy(g),k=[],S=0;S<g.length/2;++S){var E=N.getUint16(2*S,!0);E<65535&&k.push([S,E])}if(k.length!=y)throw"Expected ".concat(y," cells, found ").concat(k.length);var T=[];for(S=0;S<k.length-1;++S)T[k[S][0]]=x.subarray(k[S][1]*j,k[S+1][1]*j);return k.length>=1&&(T[k[k.length-1][0]]=x.subarray(k[k.length-1][1]*j)),{R:v,cells:T}}(e,s)});return{nrows:Cy(a[4][0].data)>>>0,data:n.reduce(function(e,t){return e[t.R]||(e[t.R]=[]),t.cells.forEach(function(r,a){if(e[t.R][a])throw new Error("Duplicate cell r=".concat(t.R," c=").concat(a));e[t.R][a]=r}),e},[])}}function Gy(e,t){var r={"!ref":"A1"},a=e[Wy(Ay(t.data)[2][0].data)],s=Cy(a[0].meta[1][0].data);if(6001!=s)throw new Error("6000 unexpected reference to ".concat(s));return function(e,t,r){var a,s=Ay(t.data),n={s:{r:0,c:0},e:{r:0,c:0}};if(n.e.r=(Cy(s[6][0].data)>>>0)-1,n.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(n.e.c=(Cy(s[7][0].data)>>>0)-1,n.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=Qh(n);var i=Ay(s[4][0].data),o=Hy(e,e[Wy(i[4][0].data)][0]),l=(null==(a=i[17])?void 0:a[0])?Hy(e,e[Wy(i[17][0].data)][0]):[],c=Ay(i[3][0].data),d=0;c[1].forEach(function(t){var a=Ay(t.data),s=e[Wy(a[2][0].data)][0],n=Cy(s.meta[1][0].data);if(6002!=n)throw new Error("6001 unexpected reference to ".concat(n));var i=Vy(0,s);i.data.forEach(function(e,t){e.forEach(function(e,a){var s=Jh({r:d+t,c:a}),n=Uy(e,o,l);n&&(r[s]=n)})}),d+=i.nrows})}(e,a[0],r),r}function qy(e,t){var r={SheetNames:[],Sheets:{}};if(Py(Ay(t.data)[1],Wy).forEach(function(t){e[t].forEach(function(t){if(2==Cy(t.meta[1][0].data)){var a=function(e,t){var r,a=Ay(t.data),s={name:(null==(r=a[1])?void 0:r[0])?Ny(a[1][0].data):"",sheets:[]};return Py(a[2],Wy).forEach(function(t){e[t].forEach(function(t){6e3==Cy(t.meta[1][0].data)&&s.sheets.push(Gy(e,t))})}),s}(e,t);a.sheets.forEach(function(e,t){kw(r,e,0==t?a.name:a.name+"_"+t,!0)})}})}),0==r.SheetNames.length)throw new Error("Empty NUMBERS file");return r}function $y(e){var t,r,a,s,n={},i=[];if(e.FullPaths.forEach(function(e){if(e.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(e){if(e.name.match(/\.iwa$/)){var t,r;try{t=My(e.content)}catch(bN){return console.log("?? "+e.content.length+" "+(bN.message||bN))}try{r=Iy(t)}catch(bN){return console.log("## "+(bN.message||bN))}r.forEach(function(e){n[e.id]=e.messages,i.push(e.id)})}}),!i.length)throw new Error("File has no messages");var o=(null==(s=null==(a=null==(r=null==(t=null==n?void 0:n[1])?void 0:t[0])?void 0:r.meta)?void 0:a[1])?void 0:s[0].data)&&1==Cy(n[1][0].meta[1][0].data)&&n[1][0];if(o||i.forEach(function(e){n[e].forEach(function(e){if(1==Cy(e.meta[1][0].data)>>>0){if(o)throw new Error("Document has multiple roots");o=e}})}),!o)throw new Error("Cannot find Document root");return qy(n,o)}function Ky(e,t,r){var a,s,n,i;if(!(null==(a=e[6])?void 0:a[0])||!(null==(s=e[7])?void 0:s[0]))throw"Mutation only works on post-BNC storages!";if((null==(i=null==(n=e[8])?void 0:n[0])?void 0:i.data)&&Cy(e[8][0].data)>0||!1)throw"Math only works with normal offsets";for(var o=0,l=jy(e[7][0].data),c=0,d=[],u=jy(e[4][0].data),h=0,f=[],m=0;m<t.length;++m)if(null!=t[m]){var p,g;switch(l.setUint16(2*m,c,!0),u.setUint16(2*m,h,!0),typeof t[m]){case"string":p=zy({t:"s",v:t[m]},r),g=By({t:"s",v:t[m]},r);break;case"number":p=zy({t:"n",v:t[m]},r),g=By({t:"n",v:t[m]},r);break;case"boolean":p=zy({t:"b",v:t[m]},r),g=By({t:"b",v:t[m]},r);break;default:throw new Error("Unsupported value "+t[m])}d.push(p),c+=p.length,f.push(g),h+=g.length,++o}else l.setUint16(2*m,65535,!0),u.setUint16(2*m,65535);for(e[2][0].data=_y(o);m<e[7][0].data.length/2;++m)l.setUint16(2*m,65535,!0),u.setUint16(2*m,65535,!0);return e[6][0].data=Sy(d),e[3][0].data=Sy(f),o}function Yy(e){return function(t){for(var r=0;r!=e.length;++r){var a=e[r];void 0===t[a[0]]&&(t[a[0]]=a[1]),"n"===a[2]&&(t[a[0]]=Number(t[a[0]]))}}}function Jy(e){Yy([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Xy(e){Yy([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Qy(e,t,r,a,s,n,i,o,l,c,d,u){try{n[a]=Kf(Hd(e,r,!0),t);var h,f=Wd(e,t);switch(o){case"sheet":h=lv(f,t,s,l,n[a],c,d,u);break;case"chart":if(!(h=cv(f,t,s,l,n[a],c))||!h["!drawel"])break;var m=Yd(h["!drawel"].Target,t),p=$f(m),g=function(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}(Hd(e,m,!0),Kf(Hd(e,p,!0),m)),x=Yd(g,m),b=$f(x);h=Vb(Hd(e,x,!0),0,0,Kf(Hd(e,b,!0),x),0,h);break;case"macro":y=t,n[a],y.slice(-4),h={"!type":"macro"};break;case"dialog":h=function(e,t){return t.slice(-4),{"!type":"dialog"}}(0,t,0,0,n[a]);break;default:throw new Error("Unrecognized sheet type "+o)}i[a]=h;var v=[];n&&n[a]&&gd(n[a]).forEach(function(r){var s="";if(n[a][r].Type==qf.CMNT){s=Yd(n[a][r].Target,t);var i=hv(Wd(e,s,!0),s,l);if(!i||!i.length)return;rx(h,i,!1)}n[a][r].Type==qf.TCMNT&&(s=Yd(n[a][r].Target,t),v=v.concat(function(e,t){var r=[],a=!1,s={},n=0;return e.replace(Zd,function(i,o){var l=ru(i);switch(au(l[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<threadedComment":s={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":null!=s.t&&r.push(s);break;case"<text>":case"<text":n=o+i.length;break;case"</text>":s.t=e.slice(n,o).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":case"<ext":a=!0;break;case"</mentions>":case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return i}),r}(Wd(e,s,!0),l)))}),v&&v.length&&rx(h,v,!0,l.people||[])}catch(bN){if(l.WTF)throw bN}var y}function Zy(e){return"/"==e.charAt(0)?e.slice(1):e}function ew(e,t){if(od(),Jy(t=t||{}),Bd(e,"META-INF/manifest.xml"))return xy(e,t);if(Bd(e,"objectdata.xml"))return xy(e,t);if(Bd(e,"Index/Document.iwa")){if("undefined"==typeof Uint8Array)throw new Error("NUMBERS file parsing requires Uint8Array support");if(e.FileIndex)return $y(e);var r=hd.utils.cfb_new();return Gd(e).forEach(function(t){qd(r,t,Vd(e,t))}),$y(r)}if(!Bd(e,"[Content_Types].xml")){if(Bd(e,"index.xml.gz"))throw new Error("Unsupported NUMBERS 08 file");if(Bd(e,"index.xml"))throw new Error("Unsupported NUMBERS 09 file");throw new Error("Unsupported ZIP file")}var a,s,n=Gd(e),i=function(e){var t={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};if(!e||!e.match)return t;var r={};if((e.match(Zd)||[]).forEach(function(e){var a=ru(e);switch(a[0].replace(eu,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":void 0!==t[Hf[a.ContentType]]&&t[Hf[a.ContentType]].push(a.PartName)}}),t.xmlns!==Fu)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}(Hd(e,"[Content_Types].xml")),o=!1;if(0===i.workbooks.length&&Wd(e,s="xl/workbook.xml",!0)&&i.workbooks.push(s),0===i.workbooks.length){if(!Wd(e,s="xl/workbook.bin",!0))throw new Error("Could not find workbook");i.workbooks.push(s),o=!0}"bin"==i.workbooks[0].slice(-3)&&(o=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(rb=[],i.sst)try{rb=uv(Wd(e,Zy(i.sst)),i.sst,t)}catch(bN){if(t.WTF)throw bN}t.cellStyles&&i.themes.length&&(l=function(e,t,r){return $g(e,r)}(Hd(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(c=dv(Wd(e,Zy(i.style)),i.style,l,t))}i.links.map(function(r){try{Kf(Hd(e,$f(Zy(r))),r);return mv(Wd(e,Zy(r)),0,r,t)}catch(bN){}});var d=ov(Wd(e,Zy(i.workbooks[0])),i.workbooks[0],t),u={},h="";i.coreprops.length&&((h=Wd(e,Zy(i.coreprops[0]),!0))&&(u=rm(h)),0!==i.extprops.length&&(h=Wd(e,Zy(i.extprops[0]),!0))&&function(e,t,r){var a={};t||(t={}),e=vu(e),nm.forEach(function(r){var s=(e.match(wu(r[0]))||[])[1];switch(r[2]){case"string":s&&(t[r[1]]=iu(s));break;case"bool":t[r[1]]="true"===s;break;case"raw":var n=e.match(new RegExp("<"+r[0]+"[^>]*>([\\s\\S]*?)</"+r[0]+">"));n&&n.length>0&&(a[r[1]]=n[1])}}),a.HeadingPairs&&a.TitlesOfParts&&om(a.HeadingPairs,a.TitlesOfParts,t,r)}(h,u,t));var f={};t.bookSheets&&!t.bookProps||0!==i.custprops.length&&(h=Hd(e,Zy(i.custprops[0]),!0))&&(f=function(e,t){var r={},a="",s=e.match(cm);if(s)for(var n=0;n!=s.length;++n){var i=s[n],o=ru(i);switch(o[0]){case"<?xml":case"<Properties":break;case"<property":a=iu(o.name);break;case"</property>":a=null;break;default:if(0===i.indexOf("<vt:")){var l=i.split(">"),c=l[0].slice(4),d=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":case"cy":case"error":r[a]=iu(d);break;case"bool":r[a]=mu(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(d);break;case"filetime":case"date":r[a]=Ad(d);break;default:if("/"==c.slice(-1))break;t.WTF&&"undefined"!==typeof console&&console.warn("Unexpected",i,c,l)}}else if("</"===i.slice(0,2));else if(t.WTF)throw new Error(i)}}return r}(h,t));var m={};if((t.bookSheets||t.bookProps)&&(d.Sheets?a=d.Sheets.map(function(e){return e.name}):u.Worksheets&&u.SheetNames.length>0&&(a=u.SheetNames),t.bookProps&&(m.Props=u,m.Custprops=f),t.bookSheets&&"undefined"!==typeof a&&(m.SheetNames=a),t.bookSheets?m.SheetNames:t.bookProps))return m;a={};var p={};t.bookDeps&&i.calcchain&&(p=fv(Wd(e,Zy(i.calcchain)),i.calcchain));var g,x,b=0,v={},y=d.Sheets;u.Worksheets=y.length,u.SheetNames=[];for(var w=0;w!=y.length;++w)u.SheetNames[w]=y[w].name;var j=o?"bin":"xml",N=i.workbooks[0].lastIndexOf("/"),k=(i.workbooks[0].slice(0,N+1)+"_rels/"+i.workbooks[0].slice(N+1)+".rels").replace(/^\//,"");Bd(e,k)||(k="xl/_rels/workbook."+j+".rels");var S=Kf(Hd(e,k,!0),k.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=pv(Wd(e,Zy(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=function(e,t){var r=[],a=!1;return e.replace(Zd,function(e){var s=ru(e);switch(au(s[0])){case"<?xml":case"<personList":case"</personList>":case"</person>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<person":r.push({name:s.displayname,id:s.id});break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return e}),r}(Wd(e,Zy(i.people[0])),t)),S&&(S=function(e,t){if(!e)return 0;try{e=t.map(function(t){return t.id||(t.id=t.strRelID),[t.name,e["!id"][t.id].Target,(r=e["!id"][t.id].Type,qf.WS.indexOf(r)>-1?"sheet":qf.CS&&r==qf.CS?"chart":qf.DS&&r==qf.DS?"dialog":qf.MS&&r==qf.MS?"macro":r&&r.length?r:"sheet")];var r})}catch(bN){return null}return e&&0!==e.length?e:null}(S,d.Sheets));var E=Wd(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(b=0;b!=u.Worksheets;++b){var T="sheet";if(S&&S[b]?(g="xl/"+S[b][1].replace(/[\/]?xl\//,""),Bd(e,g)||(g=S[b][1]),Bd(e,g)||(g=k.replace(/_rels\/.*$/,"")+S[b][1]),T=S[b][2]):g=(g="xl/worksheets/sheet"+(b+1-E)+"."+j).replace(/sheet0\./,"sheet."),x=g.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&null!=t.sheets)switch(typeof t.sheets){case"number":if(b!=t.sheets)continue e;break;case"string":if(u.SheetNames[b].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var _=!1,C=0;C!=t.sheets.length;++C)"number"==typeof t.sheets[C]&&t.sheets[C]==b&&(_=1),"string"==typeof t.sheets[C]&&t.sheets[C].toLowerCase()==u.SheetNames[b].toLowerCase()&&(_=1);if(!_)continue e}}Qy(e,g,x,u.SheetNames[b],b,v,a,T,t,d,l,c)}return m={Directory:i,Workbook:d,Props:u,Custprops:f,Deps:p,Sheets:a,SheetNames:u.SheetNames,Strings:rb,Styles:c,Themes:l,SSF:Pd(Ec)},t&&t.bookFiles&&(e.files?(m.keys=n,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach(function(t,r){t=t.replace(/^Root Entry[\/]/,""),m.keys.push(t),m.files[t]=e.FileIndex[r]}))),t&&t.bookVBA&&(i.vba.length>0?m.vbaraw=Wd(e,Zy(i.vba[0]),!0):i.defaults&&"application/vnd.ms-office.vbaProject"===i.defaults.bin&&(m.vbaraw=Wd(e,"xl/vbaProject.bin",!0))),m}function tw(e,t){var r=t||{},a="Workbook",s=hd.find(e,a);try{if(a="/!DataSpaces/Version",!(s=hd.find(e,a))||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(function(e){var t={};t.id=e.read_shift(0,"lpp4"),t.R=Jp(e,4),t.U=Jp(e,4),t.W=Jp(e,4)}(s.content),a="/!DataSpaces/DataSpaceMap",!(s=hd.find(e,a))||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var n=function(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(Xp(e));return t}(s.content);if(1!==n.length||1!==n[0].comps.length||0!==n[0].comps[0].t||"StrongEncryptionDataSpace"!==n[0].name||"EncryptedPackage"!==n[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(s=hd.find(e,a))||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var i=function(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}(s.content);if(1!=i.length||"StrongEncryptionTransform"!=i[0])throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(s=hd.find(e,a))||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);Qp(s.content)}catch(bN){}if(a="/EncryptionInfo",!(s=hd.find(e,a))||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=function(e){var t=Jp(e);switch(t.Minor){case 2:return[t.Minor,tg(e)];case 3:return[t.Minor,rg()];case 4:return[t.Minor,ag(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}(s.content);if(a="/EncryptedPackage",!(s=hd.find(e,a))||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(4==o[0]&&"undefined"!==typeof decrypt_agile)return decrypt_agile(o[1],s.content,r.password||"",r);if(2==o[0]&&"undefined"!==typeof decrypt_std76)return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function rw(e,t){return"ods"==t.bookType?wy(e,t):"numbers"==t.bookType?function(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=Xh(r["!ref"]);a.s.r=a.s.c=0;var s=!1;a.e.c>9&&(s=!0,a.e.c=9),a.e.r>49&&(s=!0,a.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(Qh(a)));var n=gw(r,{range:a,header:1}),i=["~Sh33tJ5~"];n.forEach(function(e){return e.forEach(function(e){"string"==typeof e&&i.push(e)})});var o={},l=[],c=hd.read(t.numbers,{type:"base64"});c.FileIndex.map(function(e,t){return[e,c.FullPaths[t]]}).forEach(function(e){var t=e[0],r=e[1];2==t.type&&t.name.match(/\.iwa/)&&Iy(My(t.content)).forEach(function(e){l.push(e.id),o[e.id]={deps:[],location:r,type:Cy(e.messages[0].meta[1][0].data)}})}),l.sort(function(e,t){return e-t});var d=l.filter(function(e){return e>1}).map(function(e){return[e,_y(e)]});c.FileIndex.map(function(e,t){return[e,c.FullPaths[t]]}).forEach(function(e){var t=e[0];e[1],t.name.match(/\.iwa/)&&Iy(My(t.content)).forEach(function(e){e.messages.forEach(function(t){d.forEach(function(t){e.messages.some(function(e){return 11006!=Cy(e.meta[1][0].data)&&function(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var a=0;a<t.length;++a)if(e[r+a]!=t[a])continue e;return!0}return!1}(e.data,t[1])})&&o[t[0]].deps.push(e.id)})})})});for(var u,h=hd.find(c,o[1].location),f=Iy(My(h.content)),m=0;m<f.length;++m){var p=f[m];1==p.id&&(u=p)}var g=Wy(Ay(u.messages[0].data)[1][0].data);for(f=Iy(My((h=hd.find(c,o[g].location)).content)),m=0;m<f.length;++m)(p=f[m]).id==g&&(u=p);for(g=Wy(Ay(u.messages[0].data)[2][0].data),f=Iy(My((h=hd.find(c,o[g].location)).content)),m=0;m<f.length;++m)(p=f[m]).id==g&&(u=p);for(g=Wy(Ay(u.messages[0].data)[2][0].data),f=Iy(My((h=hd.find(c,o[g].location)).content)),m=0;m<f.length;++m)(p=f[m]).id==g&&(u=p);var x=Ay(u.messages[0].data);x[6][0].data=_y(a.e.r+1),x[7][0].data=_y(a.e.c+1);for(var b=Wy(x[46][0].data),v=hd.find(c,o[b].location),y=Iy(My(v.content)),w=0;w<y.length&&y[w].id!=b;++w);if(y[w].id!=b)throw"Bad ColumnRowUIDMapArchive";var j=Ay(y[w].messages[0].data);j[1]=[],j[2]=[],j[3]=[];for(var N=0;N<=a.e.c;++N){var k=[];k[1]=k[2]=[{type:0,data:_y(N+420690)}],j[1].push({type:2,data:Dy(k)}),j[2].push({type:0,data:_y(N)}),j[3].push({type:0,data:_y(N)})}j[4]=[],j[5]=[],j[6]=[];for(var S=0;S<=a.e.r;++S)(k=[])[1]=k[2]=[{type:0,data:_y(S+726270)}],j[4].push({type:2,data:Dy(k)}),j[5].push({type:0,data:_y(S)}),j[6].push({type:0,data:_y(S)});y[w].messages[0].data=Dy(j),v.content=Fy(Oy(y)),v.size=v.content.length,delete x[46];var E=Ay(x[4][0].data);E[7][0].data=_y(a.e.r+1);var T=Wy(Ay(E[1][0].data)[2][0].data);if((y=Iy(My((v=hd.find(c,o[T].location)).content)))[0].id!=T)throw"Bad HeaderStorageBucket";var _=Ay(y[0].messages[0].data);for(S=0;S<n.length;++S){var C=Ay(_[2][0].data);C[1][0].data=_y(S),C[4][0].data=_y(n[S].length),_[2][S]={type:_[2][0].type,data:Dy(C)}}y[0].messages[0].data=Dy(_),v.content=Fy(Oy(y)),v.size=v.content.length;var A=Wy(E[2][0].data);if((y=Iy(My((v=hd.find(c,o[A].location)).content)))[0].id!=A)throw"Bad HeaderStorageBucket";for(_=Ay(y[0].messages[0].data),N=0;N<=a.e.c;++N)(C=Ay(_[2][0].data))[1][0].data=_y(N),C[4][0].data=_y(a.e.r+1),_[2][N]={type:_[2][0].type,data:Dy(C)};y[0].messages[0].data=Dy(_),v.content=Fy(Oy(y)),v.size=v.content.length;var D=Wy(E[4][0].data);!function(){for(var e,t=hd.find(c,o[D].location),r=Iy(My(t.content)),a=0;a<r.length;++a){var s=r[a];s.id==D&&(e=s)}var n=Ay(e.messages[0].data);n[3]=[];var l=[];i.forEach(function(e,t){l[1]=[{type:0,data:_y(t)}],l[2]=[{type:0,data:_y(1)}],l[3]=[{type:2,data:ky(e)}],n[3].push({type:2,data:Dy(l)})}),e.messages[0].data=Dy(n);var d=Fy(Oy(r));t.content=d,t.size=t.content.length}();var P=Ay(E[3][0].data),I=P[1][0];delete P[2];var O=Ay(I.data),R=Wy(O[2][0].data);!function(){for(var e,t=hd.find(c,o[R].location),r=Iy(My(t.content)),s=0;s<r.length;++s){var l=r[s];l.id==R&&(e=l)}var d=Ay(e.messages[0].data);delete d[6],delete P[7];var u=new Uint8Array(d[5][0].data);d[5]=[];for(var h=0,f=0;f<=a.e.r;++f){var m=Ay(u);h+=Ky(m,n[f],i),m[1][0].data=_y(f),d[5].push({data:Dy(m),type:2})}d[1]=[{type:0,data:_y(a.e.c+1)}],d[2]=[{type:0,data:_y(a.e.r+1)}],d[3]=[{type:0,data:_y(h)}],d[4]=[{type:0,data:_y(a.e.r+1)}],e.messages[0].data=Dy(d);var p=Fy(Oy(r));t.content=p,t.size=t.content.length}(),I.data=Dy(O),E[3][0].data=Dy(P),x[4][0].data=Dy(E),u.messages[0].data=Dy(x);var M=Fy(Oy(f));return h.content=M,h.size=h.content.length,c}(e,t):"xlsb"==t.bookType?function(e,t){ex=1024,e&&!e.SSF&&(e.SSF=Pd(Ec));e&&e.SSF&&(od(),id(e.SSF),t.revssf=vd(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF);t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,sb?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xlsb"==t.bookType?"bin":"xml",a=ox.indexOf(t.bookType)>-1,s={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};Xy(t=t||{});var n=$d(),i="",o=0;t.cellXfs=[],lb(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});if(qd(n,i="docProps/core.xml",sm(e.Props,t)),s.coreprops.push(i),Jf(t.rels,2,i,qf.CORE_PROPS),i="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,qd(n,i,lm(e.Props)),s.extprops.push(i),Jf(t.rels,3,i,qf.EXT_PROPS),e.Custprops!==e.Props&&gd(e.Custprops||{}).length>0&&(qd(n,i="docProps/custom.xml",dm(e.Custprops)),s.custprops.push(i),Jf(t.rels,4,i,qf.CUST_PROPS));for(o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},u=e.Sheets[e.SheetNames[o-1]];(u||{})["!type"];if(qd(n,i="xl/worksheets/sheet"+o+"."+r,gv(o-1,i,t,e,d)),s.sheets.push(i),Jf(t.wbrels,-1,"worksheets/sheet"+o+"."+r,qf.WS[0]),u){var h=u["!comments"],f=!1,m="";h&&h.length>0&&(qd(n,m="xl/comments"+o+"."+r,xv(h,m,t)),s.comments.push(m),Jf(d,-1,"../comments"+o+"."+r,qf.CMNT),f=!0),u["!legacy"]&&f&&qd(n,"xl/drawings/vmlDrawing"+o+".vml",tx(o,u["!comments"])),delete u["!comments"],delete u["!legacy"]}d["!id"].rId1&&qd(n,$f(i),Yf(d))}null!=t.Strings&&t.Strings.length>0&&(qd(n,i="xl/sharedStrings."+r,function(e,t,r){return(".bin"===t.slice(-4)?Kp:qp)(e,r)}(t.Strings,i,t)),s.strs.push(i),Jf(t.wbrels,-1,"sharedStrings."+r,qf.SST));qd(n,i="xl/workbook."+r,function(e,t,r){return(".bin"===t.slice(-4)?iv:rv)(e,r)}(e,i,t)),s.workbooks.push(i),Jf(t.rels,1,i,qf.WB),qd(n,i="xl/theme/theme1.xml",Kg(e.Themes,t)),s.themes.push(i),Jf(t.wbrels,-1,"theme/theme1.xml",qf.THEME),qd(n,i="xl/styles."+r,function(e,t,r){return(".bin"===t.slice(-4)?Lg:Sg)(e,r)}(e,i,t)),s.styles.push(i),Jf(t.wbrels,-1,"styles."+r,qf.STY),e.vbaraw&&a&&(qd(n,i="xl/vbaProject.bin",e.vbaraw),s.vba.push(i),Jf(t.wbrels,-1,"vbaProject.bin",qf.VBA));return qd(n,i="xl/metadata."+r,function(e){return(".bin"===e.slice(-4)?Qg:Zg)()}(i)),s.metadata.push(i),Jf(t.wbrels,-1,"metadata."+r,qf.XLMETA),qd(n,"[Content_Types].xml",Gf(s,t)),qd(n,"_rels/.rels",Yf(t.rels)),qd(n,"xl/_rels/workbook."+r+".rels",Yf(t.wbrels)),delete t.revssf,delete t.ssf,n}(e,t):aw(e,t)}function aw(e,t){ex=1024,e&&!e.SSF&&(e.SSF=Pd(Ec)),e&&e.SSF&&(od(),id(e.SSF),t.revssf=vd(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,sb?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",a=ox.indexOf(t.bookType)>-1,s={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};Xy(t=t||{});var n=$d(),i="",o=0;if(t.cellXfs=[],lb(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),qd(n,i="docProps/core.xml",sm(e.Props,t)),s.coreprops.push(i),Jf(t.rels,2,i,qf.CORE_PROPS),i="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,qd(n,i,lm(e.Props)),s.extprops.push(i),Jf(t.rels,3,i,qf.EXT_PROPS),e.Custprops!==e.Props&&gd(e.Custprops||{}).length>0&&(qd(n,i="docProps/custom.xml",dm(e.Custprops)),s.custprops.push(i),Jf(t.rels,4,i,qf.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},h=e.Sheets[e.SheetNames[o-1]];(h||{})["!type"];if(qd(n,i="xl/worksheets/sheet"+o+"."+r,_b(o-1,t,e,u)),s.sheets.push(i),Jf(t.wbrels,-1,"worksheets/sheet"+o+"."+r,qf.WS[0]),h){var f=h["!comments"],m=!1,p="";if(f&&f.length>0){var g=!1;f.forEach(function(e){e[1].forEach(function(e){1==e.T&&(g=!0)})}),g&&(qd(n,p="xl/threadedComments/threadedComment"+o+"."+r,sx(f,d,t)),s.threadedcomments.push(p),Jf(u,-1,"../threadedComments/threadedComment"+o+"."+r,qf.TCMNT)),qd(n,p="xl/comments"+o+"."+r,ax(f)),s.comments.push(p),Jf(u,-1,"../comments"+o+"."+r,qf.CMNT),m=!0}h["!legacy"]&&m&&qd(n,"xl/drawings/vmlDrawing"+o+".vml",tx(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&qd(n,$f(i),Yf(u))}return null!=t.Strings&&t.Strings.length>0&&(qd(n,i="xl/sharedStrings."+r,qp(t.Strings,t)),s.strs.push(i),Jf(t.wbrels,-1,"sharedStrings."+r,qf.SST)),qd(n,i="xl/workbook."+r,rv(e)),s.workbooks.push(i),Jf(t.rels,1,i,qf.WB),qd(n,i="xl/theme/theme1.xml",Kg(e.Themes,t)),s.themes.push(i),Jf(t.wbrels,-1,"theme/theme1.xml",qf.THEME),qd(n,i="xl/styles."+r,Sg(e,t)),s.styles.push(i),Jf(t.wbrels,-1,"styles."+r,qf.STY),e.vbaraw&&a&&(qd(n,i="xl/vbaProject.bin",e.vbaraw),s.vba.push(i),Jf(t.wbrels,-1,"vbaProject.bin",qf.VBA)),qd(n,i="xl/metadata."+r,Zg()),s.metadata.push(i),Jf(t.wbrels,-1,"metadata."+r,qf.XLMETA),d.length>1&&(qd(n,i="xl/persons/person.xml",function(e){var t=[Jd,Au("personList",null,{xmlns:zu,"xmlns:x":$u[0]}).replace(/[\/]>/,">")];return e.forEach(function(e,r){t.push(Au("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:e,providerId:"None"}))}),t.push("</personList>"),t.join("")}(d)),s.people.push(i),Jf(t.wbrels,-1,"persons/person.xml",qf.PEOPLE)),qd(n,"[Content_Types].xml",Gf(s,t)),qd(n,"_rels/.rels",Yf(t.rels)),qd(n,"xl/_rels/workbook.xml.rels",Yf(t.wbrels)),delete t.revssf,delete t.ssf,n}function sw(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=nc(e.slice(0,12));break;case"binary":r=e;break;default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function nw(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Cv(e.slice(r),t);default:break e}return Op.to_workbook(e,t)}function iw(e,t,r,a){return a?(r.type="string",Op.to_workbook(e,r)):Op.to_workbook(t,r)}function ow(e,t){Jl();var r=t||{};if("undefined"!==typeof ArrayBuffer&&e instanceof ArrayBuffer)return ow(new Uint8Array(e),((r=Pd(r)).type="array",r));"undefined"!==typeof Uint8Array&&e instanceof Uint8Array&&!r.type&&(r.type="undefined"!==typeof Deno?"buffer":"array");var a,s=e,n=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),ab={},r.dateNF&&(ab.dateNF=r.dateNF),r.type||(r.type=ic&&Buffer.isBuffer(e)?"buffer":"base64"),"file"==r.type&&(r.type=ic?"buffer":"binary",s=function(e){if("undefined"!==typeof fd)return fd.readFileSync(e);if("undefined"!==typeof Deno)return Deno.readFileSync(e);if("undefined"!==typeof $&&"undefined"!==typeof File&&"undefined"!==typeof Folder)try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(bN){if(!bN.message||!bN.message.match(/onstruct/))throw bN}throw new Error("Cannot access file "+e)}(e),"undefined"===typeof Uint8Array||ic||(r.type="array")),"string"==r.type&&(n=!0,r.type="binary",r.codepage=65001,s=function(e){return e.match(/[^\x00-\x7F]/)?yu(e):e}(e)),"array"==r.type&&"undefined"!==typeof Uint8Array&&e instanceof Uint8Array&&"undefined"!==typeof ArrayBuffer){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return(r=Pd(r)).type="array",ow(fc(s),r)}switch((a=sw(s,r))[0]){case 208:if(207===a[1]&&17===a[2]&&224===a[3]&&161===a[4]&&177===a[5]&&26===a[6]&&225===a[7])return function(e,t){return hd.find(e,"EncryptedPackage")?tw(e,t):Gv(e,t)}(hd.read(s,r),r);break;case 9:if(a[1]<=8)return Gv(s,r);break;case 60:return Cv(s,r);case 73:if(73===a[1]&&42===a[2]&&0===a[3])throw new Error("TIFF Image File is not a spreadsheet");if(68===a[1])return function(e,t){var r=t||{},a=!!r.WTF;r.WTF=!0;try{var s=Dp.to_workbook(e,r);return r.WTF=a,s}catch(bN){if(r.WTF=a,!bN.message.match(/SYLK bad record ID/)&&a)throw bN;return Op.to_workbook(e,t)}}(s,r);break;case 84:if(65===a[1]&&66===a[2]&&76===a[3])return Pp.to_workbook(s,r);break;case 80:return 75===a[1]&&a[2]<9&&a[3]<9?function(e,t){var r=e,a=t||{};return a.type||(a.type=ic&&Buffer.isBuffer(e)?"buffer":"base64"),ew(Kd(r,a),a)}(s,r):iw(e,s,r,n);case 239:return 60===a[3]?Cv(s,r):iw(e,s,r,n);case 255:if(254===a[1])return function(e,t){var r=e;return"base64"==t.type&&(r=nc(r)),r=Zl.utils.decode(1200,r.slice(2),"str"),t.type="binary",nw(r,t)}(s,r);if(0===a[1]&&2===a[2]&&0===a[3])return Rp.to_workbook(s,r);break;case 0:if(0===a[1]){if(a[2]>=2&&0===a[3])return Rp.to_workbook(s,r);if(0===a[2]&&(8===a[3]||9===a[3]))return Rp.to_workbook(s,r)}break;case 3:case 131:case 139:case 140:return Ap.to_workbook(s,r);case 123:if(92===a[1]&&114===a[2]&&116===a[3])return lg.to_workbook(s,r);break;case 10:case 13:case 32:return function(e,t){var r="",a=sw(e,t);switch(t.type){case"base64":r=nc(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Dd(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==a[0]&&187==a[1]&&191==a[2]&&(r=vu(r)),t.type="binary",nw(r,t)}(s,r);case 137:if(80===a[1]&&78===a[2]&&71===a[3])throw new Error("PNG Image File is not a spreadsheet")}return Cp.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?Ap.to_workbook(s,r):iw(e,s,r,n)}function lw(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return pd(t.file,hd.write(e,{type:ic?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return hd.write(e,t)}function cw(e,t){var r={},a=ic?"nodebuffer":"undefined"!==typeof Uint8Array?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=a;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?hd.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if("undefined"!==typeof Deno&&"string"==typeof s){if("binary"==t.type||"base64"==t.type)return s;s=new Uint8Array(uc(s))}return t.password&&"undefined"!==typeof encrypt_agile?lw(encrypt_agile(s,t.password),t):"file"===t.type?pd(t.file,s):"string"==t.type?vu(s):s}function dw(e,t,r){r||(r="");var a=r+e;switch(t.type){case"base64":return sc(yu(a));case"binary":return yu(a);case"string":return e;case"file":return pd(t.file,a,"utf8");case"buffer":return ic?oc(a,"utf8"):"undefined"!==typeof TextEncoder?(new TextEncoder).encode(a):dw(a,{type:"binary"}).split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function uw(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",a=0;a<e.length;++a)r+=String.fromCharCode(e[a]);return"base64"==t.type?sc(r):"string"==t.type?vu(r):r;case"file":return pd(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function hw(e,t){Jl(),ev(e);var r=Pd(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),"array"==r.type){r.type="binary";var a=hw(e,r);return r.type="array",uc(a)}var s=0;if(r.sheet&&(s="number"==typeof r.sheet?r.sheet:e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return dw(Rv(e,r),r);case"slk":case"sylk":return dw(Dp.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return dw(dy(e.Sheets[e.SheetNames[s]],r),r);case"txt":return function(e,t){switch(t.type){case"base64":return sc(e);case"binary":case"string":return e;case"file":return pd(t.file,e,"binary");case"buffer":return ic?oc(e,"binary"):e.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}(yw(e.Sheets[e.SheetNames[s]],r),r);case"csv":return dw(vw(e.Sheets[e.SheetNames[s]],r),r,"\ufeff");case"dif":return dw(Pp.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return uw(Ap.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return dw(Op.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return dw(lg.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return dw(Ip.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return dw(wy(e,r),r);case"wk1":return uw(Rp.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return uw(Rp.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),uw(sy(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),function(e,t){var r=t||{};return lw(qv(e,r),r)}(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return function(e,t){var r=Pd(t||{});return cw(rw(e,r),r)}(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function fw(e){if(!e.bookType){var t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[e.bookType]||e.bookType}}function mw(e,t,r){var a=r||{};return a.type="file",a.file=t,fw(a),hw(e,a)}function pw(e,t,r,a,s,n,i,o){var l=qh(r),c=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),u=!0,h=1===s?[]:{};if(1!==s)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch(bN){h.__rowNum__=r}else h.__rowNum__=r;if(!i||e[r])for(var f=t.s.c;f<=t.e.c;++f){var m=i?e[r][f]:e[a[f]+l];if(void 0!==m&&void 0!==m.t){var p=m.v;switch(m.t){case"z":if(null==p)break;continue;case"e":p=0==p?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(null!=n[f]){if(null==p)if("e"==m.t&&null===p)h[n[f]]=null;else if(void 0!==c)h[n[f]]=c;else{if(!d||null!==p)continue;h[n[f]]=null}else h[n[f]]=d&&("n"!==m.t||"n"===m.t&&!1!==o.rawNumbers)?p:tf(m,p,o);null!=p&&(u=!1)}}else{if(void 0===c)continue;null!=n[f]&&(h[n[f]]=c)}}return{row:h,isempty:u}}function gw(e,t){if(null==e||null==e["!ref"])return[];var r={t:"n",v:0},a=0,s=1,n=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},d=null!=c.range?c.range:e["!ref"];switch(1===c.header?a=1:"A"===c.header?a=2:Array.isArray(c.header)?a=3:null==c.header&&(a=0),typeof d){case"string":l=Zh(d);break;case"number":(l=Zh(e["!ref"])).s.r=d;break;default:l=d}a>0&&(s=0);var u=qh(l.s.r),h=[],f=[],m=0,p=0,g=Array.isArray(e),x=l.s.r,b=0,v={};g&&!e[x]&&(e[x]=[]);var y=c.skipHidden&&e["!cols"]||[],w=c.skipHidden&&e["!rows"]||[];for(b=l.s.c;b<=l.e.c;++b)if(!(y[b]||{}).hidden)switch(h[b]=Kh(b),r=g?e[x][b]:e[h[b]+u],a){case 1:n[b]=b-l.s.c;break;case 2:n[b]=h[b];break;case 3:n[b]=c.header[b-l.s.c];break;default:if(null==r&&(r={w:"__EMPTY",t:"s"}),o=i=tf(r,null,c),p=v[i]||0){do{o=i+"_"+p++}while(v[o]);v[i]=p,v[o]=1}else v[i]=1;n[b]=o}for(x=l.s.r+s;x<=l.e.r;++x)if(!(w[x]||{}).hidden){var j=pw(e,l,x,h,a,n,g,c);(!1===j.isempty||(1===a?!1!==c.blankrows:c.blankrows))&&(f[m++]=j.row)}return f.length=m,f}var xw=/"/g;function bw(e,t,r,a,s,n,i,o){for(var l=!0,c=[],d="",u=qh(r),h=t.s.c;h<=t.e.c;++h)if(a[h]){var f=o.dense?(e[r]||[])[h]:e[a[h]+u];if(null==f)d="";else if(null!=f.v){l=!1,d=""+(o.rawNumbers&&"n"==f.t?f.v:tf(f,null,o));for(var m=0,p=0;m!==d.length;++m)if((p=d.charCodeAt(m))===s||p===n||34===p||o.forceQuotes){d='"'+d.replace(xw,'""')+'"';break}"ID"==d&&(d='"ID"')}else null==f.f||f.F?d="":(l=!1,(d="="+f.f).indexOf(",")>=0&&(d='"'+d.replace(xw,'""')+'"'));c.push(d)}return!1===o.blankrows&&l?null:c.join(i)}function vw(e,t){var r=[],a=null==t?{}:t;if(null==e||null==e["!ref"])return"";var s=Zh(e["!ref"]),n=void 0!==a.FS?a.FS:",",i=n.charCodeAt(0),o=void 0!==a.RS?a.RS:"\n",l=o.charCodeAt(0),c=new RegExp(("|"==n?"\\|":n)+"+$"),d="",u=[];a.dense=Array.isArray(e);for(var h=a.skipHidden&&e["!cols"]||[],f=a.skipHidden&&e["!rows"]||[],m=s.s.c;m<=s.e.c;++m)(h[m]||{}).hidden||(u[m]=Kh(m));for(var p=0,g=s.s.r;g<=s.e.r;++g)(f[g]||{}).hidden||null!=(d=bw(e,s,g,u,i,l,n,a))&&(a.strip&&(d=d.replace(c,"")),(d||!1!==a.blankrows)&&r.push((p++?o:"")+d));return delete a.dense,r.join("")}function yw(e,t){t||(t={}),t.FS="\t",t.RS="\n";var r=vw(e,t);if("undefined"==typeof Zl||"string"==t.type)return r;var a=Zl.utils.encode(1200,r,"str");return String.fromCharCode(255)+String.fromCharCode(254)+a}function ww(e,t,r){var a,s=r||{},n=+!s.skipHeader,i=e||{},o=0,l=0;if(i&&null!=s.origin)if("number"==typeof s.origin)o=s.origin;else{var c="string"==typeof s.origin?Yh(s.origin):s.origin;o=c.r,l=c.c}var d={s:{c:0,r:0},e:{c:l,r:o+t.length-1+n}};if(i["!ref"]){var u=Zh(i["!ref"]);d.e.c=Math.max(d.e.c,u.e.c),d.e.r=Math.max(d.e.r,u.e.r),-1==o&&(o=u.e.r+1,d.e.r=o+t.length-1+n)}else-1==o&&(o=0,d.e.r=t.length-1+n);var h=s.header||[],f=0;t.forEach(function(e,t){gd(e).forEach(function(r){-1==(f=h.indexOf(r))&&(h[f=h.length]=r);var c=e[r],d="z",u="",m=Jh({c:l+f,r:o+t+n});a=jw(i,m),!c||"object"!==typeof c||c instanceof Date?("number"==typeof c?d="n":"boolean"==typeof c?d="b":"string"==typeof c?d="s":c instanceof Date?(d="d",s.cellDates||(d="n",c=wd(c)),u=s.dateNF||Ec[14]):null===c&&s.nullError&&(d="e",c=0),a?(a.t=d,a.v=c,delete a.w,delete a.R,u&&(a.z=u)):i[m]=a={t:d,v:c},u&&(a.z=u)):i[m]=c})}),d.e.c=Math.max(d.e.c,l+h.length-1);var m=qh(o);if(n)for(f=0;f<h.length;++f)i[Kh(f+l)+m]={t:"s",v:h[f]};return i["!ref"]=Qh(d),i}function jw(e,t,r){if("string"==typeof t){if(Array.isArray(e)){var a=Yh(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return jw(e,Jh("number"!=typeof t?t:{r:t,c:r||0}))}function Nw(){return{SheetNames:[],Sheets:{}}}function kw(e,t,r,a){var s=1;if(!r)for(;s<=65535&&-1!=e.SheetNames.indexOf(r="Sheet"+s);++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var n=r.match(/(^.*?)(\d+)$/);s=n&&+n[2]||0;var i=n&&n[1]||r;for(++s;s<=65535&&-1!=e.SheetNames.indexOf(r=i+s);++s);}if(Zb(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function Sw(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}var Ew={encode_col:Kh,encode_row:qh,encode_cell:Jh,encode_range:Qh,decode_col:$h,decode_row:Gh,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:Yh,decode_range:Xh,format_cell:tf,sheet_add_aoa:af,sheet_add_json:ww,sheet_add_dom:uy,aoa_to_sheet:sf,json_to_sheet:function(e,t){return ww(null,e,t)},table_to_sheet:hy,table_to_book:function(e,t){return rf(hy(e,t),t)},sheet_to_csv:vw,sheet_to_txt:yw,sheet_to_json:gw,sheet_to_html:dy,sheet_to_formulae:function(e){var t,r="",a="";if(null==e||null==e["!ref"])return[];var s,n=Zh(e["!ref"]),i="",o=[],l=[],c=Array.isArray(e);for(s=n.s.c;s<=n.e.c;++s)o[s]=Kh(s);for(var d=n.s.r;d<=n.e.r;++d)for(i=qh(d),s=n.s.c;s<=n.e.c;++s)if(r=o[s]+i,a="",void 0!==(t=c?(e[d]||[])[s]:e[r])){if(null!=t.F){if(r=t.F,!t.f)continue;a=t.f,-1==r.indexOf(":")&&(r=r+":"+r)}if(null!=t.f)a=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)a=""+t.v;else if("b"==t.t)a=t.v?"TRUE":"FALSE";else if(void 0!==t.w)a="'"+t.w;else{if(void 0===t.v)continue;a="s"==t.t?"'"+t.v:""+t.v}}l[l.length]=r+"="+a}return l},sheet_to_row_object_array:gw,sheet_get_cell:jw,book_new:Nw,book_append_sheet:kw,book_set_sheet_visibility:function(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=function(e,t){if("number"==typeof t){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"==typeof t){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}throw new Error("Cannot find sheet |"+t+"|")}(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r},cell_set_number_format:function(e,t){return e.z=t,e},cell_set_hyperlink:Sw,cell_set_internal_link:function(e,t,r){return Sw(e,"#"+t,r)},cell_add_comment:function(e,t,r){e.c||(e.c=[]),e.c.push({t:t,a:r||"SheetJS"})},sheet_set_array_formula:function(e,t,r,a){for(var s="string"!=typeof t?t:Zh(t),n="string"==typeof t?t:Qh(t),i=s.s.r;i<=s.e.r;++i)for(var o=s.s.c;o<=s.e.c;++o){var l=jw(e,i,o);l.t="n",l.F=n,delete l.v,i==s.s.r&&o==s.s.c&&(l.f=r,a&&(l.D=!0))}return e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};Hl.version;oo.register(rl,il,Po,Lo,Zo,Mo);const Tw=e=>{let{projects:t=[],tasksByProject:r={},purchaseOrdersByProject:s={},advancesByProject:n={},invoicesByProject:i={}}=e;const[o,l]=(0,a.useState)("12"),[c,d]=(0,a.useState)((new Date).toISOString().split("T")[0]),u=t.filter(e=>"active"===e.status);console.log("\ud83d\udd0d CONSOLIDATED CASHFLOW DEBUG:",{projects:(null===t||void 0===t?void 0:t.length)||0,activeProjects:u.length,tasksByProject:Object.keys(r||{}).length,purchaseOrdersByProject:Object.keys(s||{}).length,advancesByProject:Object.keys(n||{}).length,invoicesByProject:Object.keys(i||{}).length,activeProjectIds:u.map(e=>e.id)}),Object.keys(s||{}).forEach(e=>{const t=s[e]||[];console.log("\ud83d\udd0d \xd3RDENES DE COMPRA para proyecto ".concat(e,":"),{total:t.length,orders:t.map(e=>({id:e.id,number:e.number,approvalDate:e.approvalDate,date:e.date,status:e.status,totalAmount:e.totalAmount}))})});const h=(e,t)=>{if(!e||0===e.length)return 0;const r=new Date(t.getFullYear(),t.getMonth(),1),a=new Date(t.getFullYear(),t.getMonth()+1,0);return e.reduce((e,t)=>{const s=new Date(t.startDate),n=new Date(t.endDate);return s<=a&&n>=r?e+(t.cost||0):e},0)},f=(e,t)=>{if(console.log("\ud83d\udd0d CALCULANDO GASTO COMPROMETIDO - Iniciando funci\xf3n:",{purchaseOrdersLength:(null===e||void 0===e?void 0:e.length)||0,monthDate:t.toISOString().substring(0,7),purchaseOrders:e}),!e||0===e.length)return console.log("\ud83d\udd0d No hay \xf3rdenes de compra para calcular gasto comprometido"),0;const r=new Date(t.getFullYear(),t.getMonth(),1),a=new Date(t.getFullYear(),t.getMonth()+1,0);return r.setHours(0,0,0,0),a.setHours(23,59,59,999),console.log("\ud83d\udd0d Calculando gasto comprometido para mes:",{month:t.toISOString().substring(0,7),monthStart:r.toISOString().split("T")[0],monthEnd:a.toISOString().split("T")[0],totalPOs:e.length}),console.log("\ud83d\udd0d DETALLE COMPLETO DE \xd3RDENES DE COMPRA:"),e.forEach((e,t)=>{console.log("\ud83d\udd0d OC ".concat(t+1,":"),{id:e.id,number:e.number,approvalDate:e.approvalDate,date:e.date,status:e.status,totalAmount:e.totalAmount,allFields:Object.keys(e)})}),e.reduce((e,s)=>{const n="approved"===s.status||"delivered"===s.status;if(!n)return e;let i;if(s.approvalDate&&""!==s.approvalDate.trim())i=new Date(s.approvalDate+"T00:00:00");else{if(!s.date||""===s.date.trim())return console.log("\u26a0\ufe0f OC sin fecha v\xe1lida:",{id:s.id,number:s.number,approvalDate:s.approvalDate,date:s.date}),e;i=new Date(s.date+"T00:00:00")}if(isNaN(i.getTime()))return console.log("\u26a0\ufe0f OC con fecha inv\xe1lida:",{id:s.id,number:s.number,approvalDate:s.approvalDate,date:s.date,poDate:i}),e;const o=i>=r&&i<=a;return console.log("\ud83d\udd0d Evaluando OC:",{id:s.id,number:s.number,approvalDate:s.approvalDate,date:s.date,poDate:i.toISOString().split("T")[0],monthStart:r.toISOString().split("T")[0],monthEnd:a.toISOString().split("T")[0],status:s.status,totalAmount:s.totalAmount,isInMonth:o,isApproved:n,willInclude:o&&n}),o?(console.log("\u2705 INCLUYENDO OC ".concat(s.number,": $").concat(s.totalAmount," en mes ").concat(t.toISOString().substring(0,7))),e+(s.totalAmount||0)):e},0)},m=(e,t,r)=>{if(!e&&!t)return 0;const a=new Date(r.getFullYear(),r.getMonth(),1),s=new Date(r.getFullYear(),r.getMonth()+1,0);let n=0;return e&&e.length>0&&(n+=e.reduce((e,t)=>{if(!t.paymentDate||""===t.paymentDate.trim())return e;const r=new Date(t.paymentDate+"T00:00:00");if(isNaN(r.getTime()))return e;const n=r>=a&&r<=s,i="paid"===t.status;return n&&i?e+(t.amount||0):e},0)),t&&t.length>0&&(n+=t.reduce((e,t)=>{if(!t.paymentDate||""===t.paymentDate.trim())return e;const r=new Date(t.paymentDate+"T00:00:00");if(isNaN(r.getTime()))return e;const n=r>=a&&r<=s,i="pagada"===t.status;return n&&i?e+(t.amount||0):e},0)),n},p=(0,a.useMemo)(()=>{if(0===u.length)return{projection:[],metrics:{}};const e=[],t=new Date(c);for(let a=0;a<parseInt(o);a++){const o=new Date(t.getFullYear(),t.getMonth()+a,1),l=o.toISOString().split("T")[0].substring(0,7);let c=0,d=0,p=0;u.forEach(e=>{const t=r[e.id]||[],a=s[e.id]||[],u=n[e.id]||[],g=i[e.id]||[];console.log("\ud83d\udd0d Proyecto ".concat(e.id," (").concat(e.name,"):"),{tasks:t.length,purchaseOrders:a.length,advances:u.length,invoices:g.length});const x=h(t,o);c+=x,console.log("\ud83d\udd0d LLAMANDO calculateMonthCommittedExpense para proyecto ".concat(e.id," en mes ").concat(l));const b=f(a,o);console.log("\ud83d\udd0d RESULTADO calculateMonthCommittedExpense: $".concat(b)),d+=b;const v=m(u,g,o);p+=v,console.log("\ud83d\udd0d Gastos del mes ".concat(l," para proyecto ").concat(e.id,":"),{planned:x,committed:b,real:v})}),e.push({month:o.toLocaleDateString("es-ES",{month:"long",year:"numeric"}),monthKey:l,revenue:c,expenses:d,realExpenses:p,netFlow:c-p})}return{projection:e,metrics:{totalPlannedExpense:e.reduce((e,t)=>e+t.revenue,0),totalCommittedExpenses:e.reduce((e,t)=>e+t.expenses,0),totalRealExpenses:e.reduce((e,t)=>e+t.realExpenses,0),totalNetCashFlow:e.reduce((e,t)=>e+t.netFlow,0)}}},[u,r,s,n,i,o,c]);return 0===u.length?(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-blue-500",children:[(0,bt.jsxs)("h2",{className:"text-2xl font-bold text-gray-800 mb-4 flex items-center",children:[(0,bt.jsx)("span",{className:"text-3xl mr-3",children:"\ud83d\udcb0"}),"Flujo de Caja Consolidado"]}),(0,bt.jsx)("div",{className:"text-center py-8",children:(0,bt.jsx)("div",{className:"text-gray-500 text-lg",children:"No hay proyectos activos para mostrar el flujo de caja consolidado"})})]}):(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-blue-500",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,bt.jsxs)("h2",{className:"text-2xl font-bold text-gray-800 flex items-center",children:[(0,bt.jsx)("span",{className:"text-3xl mr-3",children:"\ud83d\udcb0"}),"Flujo de Caja Consolidado"]}),(0,bt.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,bt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,bt.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Per\xedodo:"}),(0,bt.jsxs)("select",{value:o,onChange:e=>l(e.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,bt.jsx)("option",{value:"6",children:"6 meses"}),(0,bt.jsx)("option",{value:"12",children:"12 meses"}),(0,bt.jsx)("option",{value:"18",children:"18 meses"}),(0,bt.jsx)("option",{value:"24",children:"24 meses"})]})]}),(0,bt.jsxs)("button",{onClick:()=>{const e=p.projection.map(e=>({Mes:e.month,"Gasto Planificado":e.revenue,"Gasto Comprometido (OCs)":e.expenses,"Gasto Real":e.realExpenses,"Flujo Neto":e.netFlow})),t=Ew.json_to_sheet(e),r=Ew.book_new();Ew.book_append_sheet(r,t,"Flujo de Caja Consolidado");mw(r,"Flujo_Caja_Consolidado_".concat((new Date).toISOString().split("T")[0],".xlsx"))},className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 flex items-center space-x-2 transition-colors",children:[(0,bt.jsx)("span",{children:"\ud83d\udcca"}),(0,bt.jsx)("span",{children:"Exportar Excel"})]})]})]}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[(0,bt.jsxs)("div",{className:"bg-orange-50 rounded-lg p-4 border border-orange-200",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,bt.jsx)("span",{className:"text-lg",children:"\ud83d\udcb0"}),(0,bt.jsx)("span",{className:"text-sm font-medium text-orange-600",children:"Gasto Planificado Total"})]}),(0,bt.jsxs)("div",{className:"text-2xl font-bold text-orange-800",children:["$",(p.metrics.totalPlannedExpense/1e3).toFixed(0),"K"]})]}),(0,bt.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,bt.jsx)("span",{className:"text-lg",children:"\ud83d\udccb"}),(0,bt.jsx)("span",{className:"text-sm font-medium text-blue-600",children:"Gasto Comprometido Total"})]}),(0,bt.jsxs)("div",{className:"text-2xl font-bold text-blue-800",children:["$",(p.metrics.totalCommittedExpenses/1e3).toFixed(0),"K"]})]}),(0,bt.jsxs)("div",{className:"bg-red-50 rounded-lg p-4 border border-red-200",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,bt.jsx)("span",{className:"text-lg",children:"\ud83d\udcb8"}),(0,bt.jsx)("span",{className:"text-sm font-medium text-red-600",children:"Gasto Real Total"})]}),(0,bt.jsxs)("div",{className:"text-2xl font-bold text-red-800",children:["$",(p.metrics.totalRealExpenses/1e3).toFixed(0),"K"]})]}),(0,bt.jsxs)("div",{className:"bg-green-50 rounded-lg p-4 border border-green-200",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,bt.jsx)("span",{className:"text-lg",children:"\ud83d\udcc8"}),(0,bt.jsx)("span",{className:"text-sm font-medium text-green-600",children:"Flujo Neto Total"})]}),(0,bt.jsxs)("div",{className:"text-2xl font-bold text-green-800",children:["$",(p.metrics.totalNetCashFlow/1e3).toFixed(0),"K"]})]})]}),(0,bt.jsxs)("div",{className:"mb-8",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Gasto Planificado vs Gasto Comprometido vs Gasto Real"}),(0,bt.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,bt.jsx)(Wl,{data:{labels:p.projection.map(e=>e.month),datasets:[{label:"Gasto Planificado",data:p.projection.map(e=>e.revenue),backgroundColor:"rgba(255, 159, 64, 0.8)",borderColor:"rgba(255, 159, 64, 1)",borderWidth:1},{label:"Gasto Comprometido (OCs)",data:p.projection.map(e=>e.expenses),backgroundColor:"rgba(54, 162, 235, 0.8)",borderColor:"rgba(54, 162, 235, 1)",borderWidth:1},{label:"Gasto Real",data:p.projection.map(e=>e.realExpenses),backgroundColor:"rgba(255, 99, 132, 0.8)",borderColor:"rgba(255, 99, 132, 1)",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{title:{display:!1},legend:{position:"bottom",labels:{padding:20,usePointStyle:!0}}},scales:{x:{stacked:!1,title:{display:!0,text:"Meses"},ticks:{maxRotation:60,minRotation:60,padding:15,font:{size:9}}},y:{stacked:!1,beginAtZero:!0,title:{display:!0,text:"Monto (USD)"},ticks:{callback:function(e){return"$"+e.toLocaleString()}}}}},height:400})})]}),(0,bt.jsx)("div",{className:"overflow-x-auto",children:(0,bt.jsxs)("table",{className:"w-full border-collapse",children:[(0,bt.jsx)("thead",{children:(0,bt.jsxs)("tr",{className:"bg-gray-50",children:[(0,bt.jsx)("th",{className:"w-1/5 border border-gray-300 px-4 py-3 text-left font-semibold text-gray-700",children:"Mes"}),(0,bt.jsx)("th",{className:"w-1/5 border border-gray-300 px-4 py-3 text-right font-semibold text-gray-700",children:"Gasto Planificado"}),(0,bt.jsx)("th",{className:"w-1/5 border border-gray-300 px-4 py-3 text-right font-semibold text-gray-700",children:"Gasto Comprometido (OCs)"}),(0,bt.jsx)("th",{className:"w-1/5 border border-gray-300 px-4 py-3 text-right font-semibold text-gray-700",children:"Gasto Real"}),(0,bt.jsx)("th",{className:"w-1/5 border border-gray-300 px-4 py-3 text-right font-semibold text-gray-700",children:"Flujo Neto"})]})}),(0,bt.jsx)("tbody",{children:p.projection.map((e,t)=>(0,bt.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,bt.jsx)("td",{className:"w-1/5 border border-gray-300 px-4 py-3 font-medium text-gray-800",children:e.month}),(0,bt.jsxs)("td",{className:"w-1/5 border border-gray-300 px-4 py-3 text-right text-orange-600 font-medium",children:["$",e.revenue.toLocaleString()]}),(0,bt.jsxs)("td",{className:"w-1/5 border border-gray-300 px-4 py-3 text-right text-blue-600 font-medium",children:["$",e.expenses.toLocaleString()]}),(0,bt.jsxs)("td",{className:"w-1/5 border border-gray-300 px-4 py-3 text-right text-red-600 font-medium",children:["$",e.realExpenses.toLocaleString()]}),(0,bt.jsxs)("td",{className:"w-1/5 border border-gray-300 px-4 py-3 text-right font-medium ".concat(e.netFlow>=0?"text-green-600":"text-red-600"),children:["$",e.netFlow.toLocaleString()]})]},t))})]})})]})},_w=e=>{let{projects:t,portfolioMetrics:r,workPackages:a=[],risks:s=[],purchaseOrders:n=[],advances:i=[],invoices:o=[],tasksByProject:l={},purchaseOrdersByProject:c={},advancesByProject:d={},invoicesByProject:u={}}=e;const h=(null===t||void 0===t?void 0:t.filter(e=>"active"===e.status))||[],f=h.reduce((e,t)=>e+(t.budget||0),0),m=h.reduce((e,t)=>e+.15*(t.budget||0),0),p=h.map(e=>({start:e.startDate?new Date(e.startDate):null,end:e.endDate?new Date(e.endDate):null})).filter(e=>e.start&&e.end),g=p.length>0?new Date(Math.min(...p.map(e=>e.start.getTime()))):null,x=p.length>0?new Date(Math.max(...p.map(e=>e.end.getTime()))):null,b=(null===n||void 0===n?void 0:n.reduce((e,t)=>e+(t.totalAmount||0),0))||0,v=(null===i||void 0===i?void 0:i.reduce((e,t)=>e+(t.amount||0),0))||0,y=(null===o||void 0===o?void 0:o.reduce((e,t)=>e+(t.amount||0),0))||0,w=(null===s||void 0===s?void 0:s.filter(e=>"active"===e.status))||[],j=w.filter(e=>"high"===e.priority),N=w.filter(e=>"medium"===e.priority),k=w.filter(e=>"low"===e.priority),S=Object.values(l||{}).flat(),E=S.filter(e=>e.isMilestone),T=E.filter(e=>"completed"===e.status),_=E.filter(e=>"in-progress"===e.status||"pending"===e.status||void 0===e.status||null===e.status),C=E.filter(e=>"delayed"===e.status),A=[...new Set(E.map(e=>e.status))];let D,P,I;if(console.log("\ud83d\udd0d DEBUG HITOS PORTFOLIO:",{totalTasks:S.length,totalMilestones:E.length,completed:T.length,inProgress:_.length,delayed:C.length,uniqueStatuses:A,milestonesData:E.slice(0,10).map(e=>({id:e.id,name:e.name,status:e.status,statusType:typeof e.status,progress:e.progress,endDate:e.endDate,isMilestone:e.isMilestone})),allMilestonesStatuses:E.map(e=>e.status)}),a&&a.length>0)D=a.reduce((e,t)=>e+(t.budget||0),0),P=a.reduce((e,t)=>e+(t.earnedValue||0),0),I=a.reduce((e,t)=>e+(t.actualCost||0),0);else{const e=Object.values(l||{}).flat();D=e.reduce((e,t)=>e+(t.cost||0),0),P=e.reduce((e,t)=>{const r=(t.progress||0)/100;return e+(t.cost||0)*r},0),I=e.reduce((e,t)=>{const r=(t.progress||0)/100;return e+(t.cost||0)*r*.8},0)}const O=I>0?P/I:1,R=D>0?P/D:1,M=D-(I+(D-P)),F=D/O;console.log("\ud83d\udcca M\xc9TRICAS EVM CALCULADAS:",{dataSource:a&&a.length>0?"workPackages":"tasks",workPackagesCount:(null===a||void 0===a?void 0:a.length)||0,tasksCount:Object.values(l||{}).flat().length,totalWorkPackageBudget:D,totalWorkPackageEarned:P,totalWorkPackageActual:I,consolidatedCPI:O,consolidatedSPI:R,consolidatedVAC:M,consolidatedEAC:F});const L=(e,t)=>"cpi"===t||"spi"===t?e>=1?"text-green-600":e>=.9?"text-yellow-600":"text-red-600":"variance"===t?e>=0?"text-green-600":"text-red-600":"text-gray-600",z=e=>{switch(e){case"active":return"\ud83d\udd04";case"completed":return"\u2705";case"on-hold":default:return"\u23f8\ufe0f";case"cancelled":return"\u274c"}};return(0,bt.jsxs)("div",{className:"space-y-8",children:[(0,bt.jsxs)("div",{className:"bg-gradient-to-r from-indigo-600 via-purple-600 to-blue-600 rounded-xl shadow-lg p-6 text-white",children:[(0,bt.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"\ud83d\udcc8 Dashboard Consolidado"}),(0,bt.jsx)("p",{className:"text-indigo-100 text-lg",children:"Vista ejecutiva del estado general del portfolio de proyectos"})]}),(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-blue-500",children:[(0,bt.jsxs)("h2",{className:"text-2xl font-bold text-gray-800 mb-6 flex items-center",children:[(0,bt.jsx)("span",{className:"text-3xl mr-3",children:"\ud83c\udfe2"}),"Vista General del Portfolio"]}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,bt.jsxs)("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 p-6 rounded-lg border border-blue-200",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,bt.jsx)("span",{className:"text-2xl",children:"\ud83d\udcca"}),(0,bt.jsx)("span",{className:"text-sm font-medium text-blue-600",children:"Proyectos Activos"})]}),(0,bt.jsx)("div",{className:"text-3xl font-bold text-blue-800",children:h.length}),(0,bt.jsxs)("div",{className:"text-sm text-blue-600 mt-1",children:["de ",(null===t||void 0===t?void 0:t.length)||0," total"]})]}),(0,bt.jsxs)("div",{className:"bg-gradient-to-br from-green-50 to-green-100 p-6 rounded-lg border border-green-200",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,bt.jsx)("span",{className:"text-2xl",children:"\ud83d\udcb0"}),(0,bt.jsx)("span",{className:"text-sm font-medium text-green-600",children:"Presupuesto Total"})]}),(0,bt.jsxs)("div",{className:"text-3xl font-bold text-green-800",children:["$",(f/1e3).toFixed(0),"K"]}),(0,bt.jsx)("div",{className:"text-sm text-green-600 mt-1",children:"Presupuesto asignado"})]}),(0,bt.jsxs)("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 p-6 rounded-lg border border-purple-200",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,bt.jsx)("span",{className:"text-2xl",children:"\ud83d\udcc5"}),(0,bt.jsx)("span",{className:"text-sm font-medium text-purple-600",children:"Inicio M\xe1s Temprano"})]}),(0,bt.jsx)("div",{className:"text-xl font-bold text-purple-800",children:g?g.toLocaleDateString("es-ES"):"N/A"}),(0,bt.jsx)("div",{className:"text-sm text-purple-600 mt-1",children:"Fecha de inicio del portfolio"})]}),(0,bt.jsxs)("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 p-6 rounded-lg border border-orange-200",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,bt.jsx)("span",{className:"text-2xl",children:"\ud83c\udfc1"}),(0,bt.jsx)("span",{className:"text-sm font-medium text-orange-600",children:"Fin M\xe1s Tard\xedo"})]}),(0,bt.jsx)("div",{className:"text-xl font-bold text-orange-800",children:x?x.toLocaleDateString("es-ES"):"N/A"}),(0,bt.jsx)("div",{className:"text-sm text-orange-600 mt-1",children:"Fecha de fin del portfolio"})]})]})]}),(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-green-500",children:[(0,bt.jsxs)("h2",{className:"text-2xl font-bold text-gray-800 mb-6 flex items-center",children:[(0,bt.jsx)("span",{className:"text-3xl mr-3",children:"\ud83d\udcca"}),"Indicadores por Proyecto"]}),(0,bt.jsx)("div",{className:"overflow-x-auto",children:(0,bt.jsxs)("table",{className:"w-full text-sm",children:[(0,bt.jsx)("thead",{children:(0,bt.jsxs)("tr",{className:"bg-gray-50",children:[(0,bt.jsx)("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Proyecto"}),(0,bt.jsx)("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Estatus"}),(0,bt.jsx)("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Presupuesto"}),(0,bt.jsx)("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Inicio"}),(0,bt.jsx)("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Fin"}),(0,bt.jsx)("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Progreso"})]})}),(0,bt.jsx)("tbody",{children:h.map((e,t)=>(0,bt.jsxs)("tr",{className:"border-b border-gray-200 hover:bg-gray-50",children:[(0,bt.jsx)("td",{className:"px-4 py-3",children:(0,bt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,bt.jsx)("span",{className:"text-lg",children:z(e.status)}),(0,bt.jsx)("span",{className:"font-medium text-gray-800",children:e.name})]})}),(0,bt.jsx)("td",{className:"px-4 py-3",children:(0,bt.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("active"===e.status?"bg-green-100 text-green-800":"completed"===e.status?"bg-blue-100 text-blue-800":"on-hold"===e.status?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:"active"===e.status?"Activo":"completed"===e.status?"Completado":"on-hold"===e.status?"En Pausa":"Cancelado"})}),(0,bt.jsxs)("td",{className:"px-4 py-3 font-medium text-gray-800",children:["$",((e.budget||0)/1e3).toFixed(0),"K"]}),(0,bt.jsx)("td",{className:"px-4 py-3 text-gray-600",children:e.startDate?new Date(e.startDate).toLocaleDateString("es-ES"):"N/A"}),(0,bt.jsx)("td",{className:"px-4 py-3 text-gray-600",children:e.endDate?new Date(e.endDate).toLocaleDateString("es-ES"):"N/A"}),(0,bt.jsx)("td",{className:"px-4 py-3",children:(0,bt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,bt.jsx)("div",{className:"w-16 bg-gray-200 rounded-full h-2",children:(0,bt.jsx)("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:"".concat(Math.min(100,Math.max(0,e.progress||0)),"%")}})}),(0,bt.jsxs)("span",{className:"text-xs text-gray-600",children:[Math.round(e.progress||0),"%"]})]})})]},e.id))})]})})]}),(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-emerald-500",children:[(0,bt.jsxs)("h2",{className:"text-2xl font-bold text-gray-800 mb-6 flex items-center",children:[(0,bt.jsx)("span",{className:"text-3xl mr-3",children:"\ud83d\udcb3"}),"Indicadores Financieros Consolidados"]}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,bt.jsxs)("div",{className:"bg-gradient-to-br from-emerald-50 to-emerald-100 p-6 rounded-lg border border-emerald-200",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,bt.jsx)("span",{className:"text-2xl",children:"\ud83d\udccb"}),(0,bt.jsx)("span",{className:"text-sm font-medium text-emerald-600",children:"\xd3rdenes de Compra"})]}),(0,bt.jsxs)("div",{className:"text-3xl font-bold text-emerald-800",children:["$",(b/1e3).toFixed(0),"K"]}),(0,bt.jsx)("div",{className:"text-sm text-emerald-600 mt-1",children:"Total en OC aprobadas"})]}),(0,bt.jsxs)("div",{className:"bg-gradient-to-br from-amber-50 to-amber-100 p-6 rounded-lg border border-amber-200",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,bt.jsx)("span",{className:"text-2xl",children:"\ud83d\udcb8"}),(0,bt.jsx)("span",{className:"text-sm font-medium text-amber-600",children:"Anticipos"})]}),(0,bt.jsxs)("div",{className:"text-3xl font-bold text-amber-800",children:["$",(v/1e3).toFixed(0),"K"]}),(0,bt.jsx)("div",{className:"text-sm text-amber-600 mt-1",children:"Anticipos solicitados"})]}),(0,bt.jsxs)("div",{className:"bg-gradient-to-br from-cyan-50 to-cyan-100 p-6 rounded-lg border border-cyan-200",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,bt.jsx)("span",{className:"text-2xl",children:"\ud83e\uddfe"}),(0,bt.jsx)("span",{className:"text-sm font-medium text-cyan-600",children:"Facturas"})]}),(0,bt.jsxs)("div",{className:"text-3xl font-bold text-cyan-800",children:["$",(y/1e3).toFixed(0),"K"]}),(0,bt.jsx)("div",{className:"text-sm text-cyan-600 mt-1",children:"Facturas ingresadas"})]}),(0,bt.jsxs)("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 p-6 rounded-lg border border-purple-200",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,bt.jsx)("span",{className:"text-2xl",children:"\ud83d\udee1\ufe0f"}),(0,bt.jsx)("span",{className:"text-sm font-medium text-purple-600",children:"Reservas"})]}),(0,bt.jsxs)("div",{className:"text-3xl font-bold text-purple-800",children:["$",(m/1e3).toFixed(0),"K"]}),(0,bt.jsx)("div",{className:"text-sm text-purple-600 mt-1",children:"Contingencia + Gesti\xf3n"})]})]})]}),(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-red-500",children:[(0,bt.jsxs)("h2",{className:"text-2xl font-bold text-gray-800 mb-6 flex items-center",children:[(0,bt.jsx)("span",{className:"text-3xl mr-3",children:"\ud83d\udee1\ufe0f"}),"Indicadores de Riesgos del Portfolio"]}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,bt.jsxs)("div",{className:"bg-gradient-to-br from-red-50 to-red-100 p-6 rounded-lg border border-red-200",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,bt.jsx)("span",{className:"text-2xl",children:"\ud83d\udea8"}),(0,bt.jsx)("span",{className:"text-sm font-medium text-red-600",children:"Riesgos Activos"})]}),(0,bt.jsx)("div",{className:"text-3xl font-bold text-red-800",children:w.length}),(0,bt.jsx)("div",{className:"text-sm text-red-600 mt-1",children:"Total de riesgos identificados"})]}),(0,bt.jsxs)("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 p-6 rounded-lg border border-orange-200",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,bt.jsx)("span",{className:"text-2xl",children:"\u26a0\ufe0f"}),(0,bt.jsx)("span",{className:"text-sm font-medium text-orange-600",children:"Alta Prioridad"})]}),(0,bt.jsx)("div",{className:"text-3xl font-bold text-orange-800",children:j.length}),(0,bt.jsx)("div",{className:"text-sm text-orange-600 mt-1",children:"Requieren atenci\xf3n inmediata"})]}),(0,bt.jsxs)("div",{className:"bg-gradient-to-br from-yellow-50 to-yellow-100 p-6 rounded-lg border border-yellow-200",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,bt.jsx)("span",{className:"text-2xl",children:"\ud83d\udcca"}),(0,bt.jsx)("span",{className:"text-sm font-medium text-yellow-600",children:"Distribuci\xf3n"})]}),(0,bt.jsxs)("div",{className:"text-sm text-yellow-800",children:[(0,bt.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,bt.jsxs)("span",{children:["Alta: ",j.length]}),(0,bt.jsxs)("span",{children:["Media: ",N.length]})]}),(0,bt.jsxs)("div",{className:"flex justify-between",children:[(0,bt.jsxs)("span",{children:["Baja: ",k.length]}),(0,bt.jsxs)("span",{children:["Total: ",w.length]})]})]})]})]})]}),(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-purple-500",children:[(0,bt.jsxs)("h2",{className:"text-2xl font-bold text-gray-800 mb-6 flex items-center",children:[(0,bt.jsx)("span",{className:"text-3xl mr-3",children:"\ud83c\udfaf"}),"Hitos del Portafolio"]}),(0,bt.jsx)("div",{className:"space-y-6",children:t&&t.length>0?t.filter(e=>"active"===e.status).map(e=>{const t=((null===l||void 0===l?void 0:l[e.id])||[]).filter(e=>e.isMilestone),r=t.filter(e=>"completed"===e.status),a=t.filter(e=>"in-progress"===e.status||"pending"===e.status||void 0===e.status||null===e.status),s=t.filter(e=>"delayed"===e.status),n=t.length>0?Math.round(r.length/t.length*100):0;return(0,bt.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[(0,bt.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[(0,bt.jsx)("span",{className:"text-xl mr-2",children:"\ud83d\udccb"}),e.name,(0,bt.jsxs)("span",{className:"ml-2 text-sm font-normal text-gray-500",children:["(",t.length," hitos)"]})]}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,bt.jsxs)("div",{className:"bg-gradient-to-br from-green-50 to-green-100 p-4 rounded-lg border border-green-200",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,bt.jsx)("span",{className:"text-xl",children:"\u2705"}),(0,bt.jsx)("span",{className:"text-xs font-medium text-green-600",children:"Completados"})]}),(0,bt.jsx)("div",{className:"text-2xl font-bold text-green-800",children:r.length}),(0,bt.jsx)("div",{className:"text-xs text-green-600 mt-1",children:"Hitos realizados"})]}),(0,bt.jsxs)("div",{className:"bg-gradient-to-br from-yellow-50 to-yellow-100 p-4 rounded-lg border border-yellow-200",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,bt.jsx)("span",{className:"text-xl",children:"\ud83d\udd04"}),(0,bt.jsx)("span",{className:"text-xs font-medium text-yellow-600",children:"En Proceso"})]}),(0,bt.jsx)("div",{className:"text-2xl font-bold text-yellow-800",children:a.length}),(0,bt.jsx)("div",{className:"text-xs text-yellow-600 mt-1",children:"Hitos en ejecuci\xf3n"})]}),(0,bt.jsxs)("div",{className:"bg-gradient-to-br from-red-50 to-red-100 p-4 rounded-lg border border-red-200",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,bt.jsx)("span",{className:"text-xl",children:"\u26a0\ufe0f"}),(0,bt.jsx)("span",{className:"text-xs font-medium text-red-600",children:"Atrasados"})]}),(0,bt.jsx)("div",{className:"text-2xl font-bold text-red-800",children:s.length}),(0,bt.jsx)("div",{className:"text-xs text-red-600 mt-1",children:"Hitos retrasados"})]}),(0,bt.jsxs)("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 p-4 rounded-lg border border-blue-200",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,bt.jsx)("span",{className:"text-xl",children:"\ud83d\udcc8"}),(0,bt.jsx)("span",{className:"text-xs font-medium text-blue-600",children:"Progreso"})]}),(0,bt.jsxs)("div",{className:"text-2xl font-bold text-blue-800",children:[n,"%"]}),(0,bt.jsx)("div",{className:"text-xs text-blue-600 mt-1",children:"Completitud"})]})]})]},e.id)}):(0,bt.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,bt.jsx)("span",{className:"text-4xl mb-4 block",children:"\ud83d\udccb"}),(0,bt.jsx)("p",{children:"No hay proyectos activos con hitos"})]})}),t&&t.filter(e=>"active"===e.status).length>1&&(0,bt.jsxs)("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[(0,bt.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[(0,bt.jsx)("span",{className:"text-xl mr-2",children:"\ud83d\udcca"}),"Resumen Consolidado"]}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,bt.jsxs)("div",{className:"bg-gradient-to-br from-green-50 to-green-100 p-4 rounded-lg border border-green-200",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,bt.jsx)("span",{className:"text-xl",children:"\u2705"}),(0,bt.jsx)("span",{className:"text-xs font-medium text-green-600",children:"Total Completados"})]}),(0,bt.jsx)("div",{className:"text-2xl font-bold text-green-800",children:T.length}),(0,bt.jsx)("div",{className:"text-xs text-green-600 mt-1",children:"Hitos realizados"})]}),(0,bt.jsxs)("div",{className:"bg-gradient-to-br from-yellow-50 to-yellow-100 p-4 rounded-lg border border-yellow-200",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,bt.jsx)("span",{className:"text-xl",children:"\ud83d\udd04"}),(0,bt.jsx)("span",{className:"text-xs font-medium text-yellow-600",children:"Total En Proceso"})]}),(0,bt.jsx)("div",{className:"text-2xl font-bold text-yellow-800",children:_.length}),(0,bt.jsx)("div",{className:"text-xs text-yellow-600 mt-1",children:"Hitos en ejecuci\xf3n"})]}),(0,bt.jsxs)("div",{className:"bg-gradient-to-br from-red-50 to-red-100 p-4 rounded-lg border border-red-200",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,bt.jsx)("span",{className:"text-xl",children:"\u26a0\ufe0f"}),(0,bt.jsx)("span",{className:"text-xs font-medium text-red-600",children:"Total Atrasados"})]}),(0,bt.jsx)("div",{className:"text-2xl font-bold text-red-800",children:C.length}),(0,bt.jsx)("div",{className:"text-xs text-red-600 mt-1",children:"Hitos retrasados"})]}),(0,bt.jsxs)("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 p-4 rounded-lg border border-blue-200",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,bt.jsx)("span",{className:"text-xl",children:"\ud83d\udcc8"}),(0,bt.jsx)("span",{className:"text-xs font-medium text-blue-600",children:"Progreso General"})]}),(0,bt.jsxs)("div",{className:"text-2xl font-bold text-blue-800",children:[E.length>0?Math.round(T.length/E.length*100):0,"%"]}),(0,bt.jsx)("div",{className:"text-xs text-blue-600 mt-1",children:"Completitud general"})]})]})]})]}),(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-indigo-500",children:[(0,bt.jsxs)("h2",{className:"text-2xl font-bold text-gray-800 mb-6 flex items-center",children:[(0,bt.jsx)("span",{className:"text-3xl mr-3",children:"\ud83d\udcca"}),"Indicadores PMBOK v7 - Gesti\xf3n de Costos"]}),(0,bt.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:(0,bt.jsxs)("div",{className:"flex items-center",children:[(0,bt.jsx)("div",{className:"text-blue-600 text-xl mr-3",children:"\u2139\ufe0f"}),(0,bt.jsxs)("div",{className:"text-blue-800",children:[(0,bt.jsx)("strong",{children:"Fuente de datos:"})," ",a&&a.length>0?"Calculado basado en ".concat(a.length," paquetes de trabajo"):"Calculado basado en ".concat(Object.values(l||{}).flat().length," tareas del cronograma"),!(a&&a.length>0)&&(0,bt.jsx)("span",{className:"block text-sm mt-1",children:'Los costos se estiman bas\xe1ndose en el campo "Costo" de cada tarea y su progreso actual.'})]})]})}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,bt.jsxs)("div",{className:"space-y-6",children:[(0,bt.jsxs)("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 p-6 rounded-lg border border-blue-200",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-blue-800",children:"CPI - Cost Performance Index"}),(0,bt.jsx)("span",{className:"text-2xl",children:"\ud83d\udcb0"})]}),(0,bt.jsx)("div",{className:"text-3xl font-bold text-blue-800 mb-2",children:O.toFixed(2)}),(0,bt.jsx)("div",{className:"text-sm font-medium mb-2 ".concat(L(O,"cpi")),children:O>=1?"\u2705 Eficiencia de costos positiva":O>=.9?"\u26a0\ufe0f Eficiencia de costos aceptable":"\u274c Eficiencia de costos deficiente"}),(0,bt.jsxs)("div",{className:"text-xs text-gray-600",children:[(0,bt.jsx)("strong",{children:"\xbfQu\xe9 significa?"})," Mide la eficiencia del costo del trabajo realizado. Valores \u2265 1.0 indican que el proyecto est\xe1 dentro del presupuesto."]})]}),(0,bt.jsxs)("div",{className:"bg-gradient-to-br from-green-50 to-green-100 p-6 rounded-lg border border-green-200",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-green-800",children:"SPI - Schedule Performance Index"}),(0,bt.jsx)("span",{className:"text-2xl",children:"\ud83d\udcc5"})]}),(0,bt.jsx)("div",{className:"text-3xl font-bold text-green-800 mb-2",children:R.toFixed(2)}),(0,bt.jsx)("div",{className:"text-sm font-medium mb-2 ".concat(L(R,"spi")),children:R>=1?"\u2705 Eficiencia de cronograma positiva":R>=.9?"\u26a0\ufe0f Eficiencia de cronograma aceptable":"\u274c Eficiencia de cronograma deficiente"}),(0,bt.jsxs)("div",{className:"text-xs text-gray-600",children:[(0,bt.jsx)("strong",{children:"\xbfQu\xe9 significa?"})," Mide la eficiencia del cronograma del trabajo realizado. Valores \u2265 1.0 indican que el proyecto est\xe1 adelantado."]})]})]}),(0,bt.jsxs)("div",{className:"space-y-6",children:[(0,bt.jsxs)("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 p-6 rounded-lg border border-purple-200",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-purple-800",children:"VAC - Variance at Completion"}),(0,bt.jsx)("span",{className:"text-2xl",children:"\ud83d\udcca"})]}),(0,bt.jsxs)("div",{className:"text-3xl font-bold mb-2 ".concat(L(M,"variance")),children:["$",(M/1e3).toFixed(0),"K"]}),(0,bt.jsx)("div",{className:"text-sm font-medium mb-2 ".concat(L(M,"variance")),children:M>=0?"\u2705 Proyecto dentro del presupuesto":"\u274c Proyecto exceder\xe1 el presupuesto"}),(0,bt.jsxs)("div",{className:"text-xs text-gray-600",children:[(0,bt.jsx)("strong",{children:"\xbfQu\xe9 significa?"})," Predice la diferencia entre el presupuesto total y el costo final estimado. Valores positivos indican ahorro proyectado."]})]}),(0,bt.jsxs)("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 p-6 rounded-lg border border-orange-200",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-orange-800",children:"EAC - Estimate at Completion"}),(0,bt.jsx)("span",{className:"text-2xl",children:"\ud83c\udfaf"})]}),(0,bt.jsxs)("div",{className:"text-3xl font-bold text-orange-800 mb-2",children:["$",(F/1e3).toFixed(0),"K"]}),(0,bt.jsx)("div",{className:"text-sm font-medium mb-2 text-orange-700",children:"Costo total estimado del proyecto"}),(0,bt.jsxs)("div",{className:"text-xs text-gray-600",children:[(0,bt.jsx)("strong",{children:"\xbfQu\xe9 significa?"})," Predice el costo total del proyecto basado en el rendimiento actual. Se calcula como: Presupuesto Total \xf7 CPI."]})]})]})]})]}),(0,bt.jsx)(Tw,{projects:t,tasksByProject:l,purchaseOrdersByProject:c,advancesByProject:d,invoicesByProject:u})]})},Cw={maxFileSize:10485760,maxFilesPerProject:100,maxTotalSizePerProject:524288e3,allowedTypes:["pdf","jpg","jpeg","png","doc","docx","xls","xlsx"],allowedMimeTypes:["application/pdf","image/jpeg","image/jpg","image/png","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]},Aw=e=>{const[t,r]=(0,a.useState)([]),[s,i]=(0,a.useState)(!1),[o,l]=(0,a.useState)(null),[c,d]=(0,a.useState)("local"),[u,h]=(0,a.useState)(!1);(0,a.useEffect)(()=>{(async()=>{try{if(Nt.default.isAuthenticated()){console.log("\ud83d\udd0d Verificando disponibilidad de Supabase Storage...");const e=await Nt.default.initializeStorage();h(e),d(e?"supabase":"local"),console.log("\u2705 Storage provider configurado: ".concat(e?"Supabase":"Local"))}else console.log("\u26a0\ufe0f Usuario no autenticado, usando almacenamiento local"),h(!1),d("local")}catch(o){console.error("\u274c Error verificando Supabase:",o),console.log("\ud83d\udd04 Fallback a localStorage debido a error de Supabase"),h(!1),d("local")}})()},[]),(0,a.useEffect)(()=>{e&&f()},[e,c,u]);const f=(0,a.useCallback)(async()=>{if(e){i(!0),l(null);try{if(u&&"supabase"===c){console.log("\ud83d\udcc2 Cargando archivos desde Supabase para proyecto ".concat(e,"..."));const{success:t,files:a,error:s}=await Nt.default.listProjectFiles(e);if(t){const e=a.map(e=>{var t,r,a,s;return(0,n.A)((0,n.A)({},e),{},{mimeType:(null===(t=e.metadata)||void 0===t?void 0:t.mimeType)||"application/octet-stream",description:(null===(r=e.metadata)||void 0===r?void 0:r.description)||"",relatedItemId:(null===(a=e.metadata)||void 0===a?void 0:a.relatedItemId)||null,content:e.publicUrl,fileExtension:(null===(s=e.fileName.split(".").pop())||void 0===s?void 0:s.toLowerCase())||""})});r(e),console.log("\u2705 ".concat(e.length," archivos cargados desde Supabase"))}else console.error("\u274c Error cargando desde Supabase:",s),m()}else m()}catch(o){console.error("\u274c Error cargando archivos:",o),l("Error al cargar archivos del proyecto"),m()}finally{i(!1)}}},[e,u,c]),m=(0,a.useCallback)(()=>{try{const t=localStorage.getItem("project-files-".concat(e));if(t){const e=JSON.parse(t);r(e),console.log("\u2705 ".concat(e.length," archivos cargados desde localStorage"))}}catch(o){console.error("\u274c Error cargando desde localStorage:",o),l("Error al cargar archivos del proyecto")}},[e]),p=(0,a.useCallback)(t=>{if(e)try{localStorage.setItem("project-files-".concat(e),JSON.stringify(t))}catch(o){console.error("Error saving project files:",o),l("Error al guardar archivos del proyecto")}},[e]),g=(0,a.useCallback)(e=>{if(e.size>Cw.maxFileSize)throw new Error("El archivo es demasiado grande. M\xe1ximo ".concat(Cw.maxFileSize/1048576,"MB"));const t=e.name.split(".").pop().toLowerCase();if(!Cw.allowedTypes.includes(t))throw new Error("Tipo de archivo no permitido. Tipos permitidos: ".concat(Cw.allowedTypes.join(", ")));if(!Cw.allowedMimeTypes.includes(e.type))throw new Error("Tipo de archivo no v\xe1lido");return!0},[]),x=(0,a.useCallback)(async e=>e.type.startsWith("image/")?new Promise(t=>{const r=document.createElement("canvas"),a=r.getContext("2d"),s=new Image;s.onload=()=>{const n=1200;let{width:i,height:o}=s;i>o&&i>n?(o=o*n/i,i=n):o>n&&(i=i*n/o,o=n),r.width=i,r.height=o,a.drawImage(s,0,0,i,o),r.toBlob(r=>{const a=new File([r],e.name,{type:e.type,lastModified:Date.now()});t(a)},e.type,.8)},s.src=URL.createObjectURL(e)}):e,[]),b=(0,a.useCallback)(e=>new Promise((t,r)=>{const a=new FileReader;a.readAsDataURL(e),a.onload=()=>t(a.result),a.onerror=e=>r(e)}),[]),v=(0,a.useCallback)(async function(a,s,d){let h=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";i(!0),l(null);try{if(g(a),t.length>=Cw.maxFilesPerProject)throw new Error("L\xedmite de archivos alcanzado. M\xe1ximo ".concat(Cw.maxFilesPerProject," archivos por proyecto"));if(t.reduce((e,t)=>e+t.fileSize,0)+a.size>Cw.maxTotalSizePerProject)throw new Error("L\xedmite de tama\xf1o alcanzado. M\xe1ximo ".concat(Cw.maxTotalSizePerProject/1048576,"MB por proyecto"));const i=await x(a);let o;if(u&&"supabase"===c){var f;console.log("\u2601\ufe0f Subiendo archivo a Supabase Storage...");const l={description:h,relatedItemId:d,originalName:a.name,uploadedBy:(null===(f=Nt.default.getCurrentUser())||void 0===f?void 0:f.email)||"Usuario",mimeType:a.type},c=await Nt.default.uploadFileToStorage(i,e,s,l);var m;if(!c.success)throw new Error("Error subiendo a Supabase: ".concat((null===(m=c.error)||void 0===m?void 0:m.message)||"Error desconocido"));{var v;o=(0,n.A)((0,n.A)({},c.file),{},{description:h,relatedItemId:d,fileExtension:a.name.split(".").pop().toLowerCase(),uploadedBy:(null===(v=Nt.default.getCurrentUser())||void 0===v?void 0:v.email)||"Usuario Actual"});const e=t.slice();e.push(o),r(e),console.log("\u2705 Archivo subido exitosamente a Supabase Storage:",o.fileName)}}else{console.log("\ud83d\udcbe Subiendo archivo a localStorage...");const n=await b(i);o={id:"file-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),projectId:e,category:s,relatedItemId:d,fileName:a.name,originalName:a.name,fileSize:i.size,mimeType:a.type,uploadDate:(new Date).toISOString(),uploadedBy:"Usuario Actual",description:h,content:n,fileExtension:a.name.split(".").pop().toLowerCase(),metadata:{storageProvider:"local"}};const l=t.slice();l.push(o),r(l),p(l),console.log("\u2705 Archivo subido exitosamente a localStorage:",o.fileName)}return o}catch(o){throw console.error("Error uploading file:",o),l(o.message),o}finally{i(!1)}},[t,e,g,x,b,p,u,c]),y=(0,a.useCallback)(async e=>{try{const a=t.find(t=>t.id===e);if(!a)throw new Error("Archivo no encontrado");if(u&&"supabase"===c&&a.storagePath){console.log("\ud83d\uddd1\ufe0f Eliminando archivo de Supabase Storage...");const e=await Nt.default.deleteFileFromStorage(a.storagePath);e.success?console.log("\u2705 Archivo eliminado de Supabase Storage"):console.warn("\u26a0\ufe0f Error eliminando archivo de Supabase Storage:",e.error)}const s=t.filter(t=>t.id!==e);r(s),"local"===c&&p(s),console.log("\u2705 Archivo eliminado exitosamente:",e)}catch(o){console.error("Error deleting file:",o),l("Error al eliminar archivo")}},[t,p,u,c]),w=(0,a.useCallback)(e=>"financial-only"===e?t.filter(e=>["purchase-order","invoice","advance","contract"].includes(e.category)):"risk-evidence"===e?t.filter(e=>["risk-evidence"].includes(e.category)):t.filter(t=>t.category===e),[t]),j=(0,a.useCallback)(e=>t.filter(t=>t.relatedItemId===e),[t]),N=(0,a.useCallback)(e=>{const r=e.toLowerCase();return t.filter(e=>e.fileName.toLowerCase().includes(r)||e.description.toLowerCase().includes(r)||e.category.toLowerCase().includes(r))},[t]),k=(0,a.useCallback)(()=>{const e=t.reduce((e,t)=>e+t.fileSize,0),r=Array.from(new Set(t.map(e=>e.category)));return{totalFiles:t.length,totalSize:e,totalSizeMB:(e/1048576).toFixed(2),categories:r,filesByCategory:r.reduce((e,r)=>(e[r]=t.filter(e=>e.category===r).length,e),{})}},[t]),S=(0,a.useCallback)(()=>{if(e)try{localStorage.removeItem("project-files-".concat(e)),r([]),console.log("\u2705 Archivos del proyecto limpiados")}catch(o){console.error("Error clearing project files:",o),l("Error al limpiar archivos del proyecto")}},[e]),E=(0,a.useCallback)(async e=>"supabase"!==e||u?(d(e),console.log("\ud83d\udd04 Cambiando a proveedor de almacenamiento: ".concat(e)),await f(),!0):(console.warn("\u26a0\ufe0f Supabase no est\xe1 disponible"),!1),[u,f]),T=(0,a.useCallback)(async()=>{if(!u)return console.warn("\u26a0\ufe0f Supabase no est\xe1 disponible para sincronizaci\xf3n"),!1;try{console.log("\ud83d\udd04 Iniciando sincronizaci\xf3n con Supabase...");const e=t.filter(e=>{var t;return"local"===(null===(t=e.metadata)||void 0===t?void 0:t.storageProvider)});if(0===e.length)return console.log("\u2705 No hay archivos locales para sincronizar"),!0;let a=0,s=0;for(const i of e)try{const e=await fetch(i.content),o=await e.blob(),l=new File([o],i.fileName,{type:i.mimeType}),c=await Nt.default.uploadFileToStorage(l,i.projectId,i.category,{description:i.description,relatedItemId:i.relatedItemId,originalName:i.fileName,uploadedBy:i.uploadedBy,mimeType:i.mimeType});if(c.success){const e=(0,n.A)((0,n.A)((0,n.A)({},i),c.file),{},{metadata:(0,n.A)((0,n.A)({},i.metadata),{},{storageProvider:"supabase",syncedAt:(new Date).toISOString()})}),s=t.map(t=>t.id===i.id?e:t);r(s),a++,console.log("\u2705 Sincronizado: ".concat(i.fileName))}else console.error("\u274c Error sincronizando ".concat(i.fileName,":"),c.error),s++}catch(o){console.error("\u274c Error procesando ".concat(i.fileName,":"),o),s++}return console.log("\ud83c\udf89 Sincronizaci\xf3n completada: ".concat(a," exitosos, ").concat(s," errores")),!0}catch(o){return console.error("\u274c Error en sincronizaci\xf3n:",o),!1}},[t,u]);return{files:t,isLoading:s,error:o,storageProvider:c,isSupabaseAvailable:u,uploadFile:v,deleteFile:y,getFilesByCategory:w,getFilesByRelatedItem:j,searchFiles:N,getFileStats:k,clearProjectFiles:S,switchStorageProvider:E,syncWithSupabase:T,loadProjectFiles:f,fileLimits:Cw}},Dw=e=>{let{projectId:t,category:r="general",relatedItemId:s=null,onFileUploaded:n=null,showUploadArea:i=!0,isContextual:o=!1,title:l="\ud83d\udcce Gesti\xf3n de Archivos"}=e;const{permissions:c}=kt(),{files:d,isLoading:u,error:h,uploadFile:f,deleteFile:m,getFilesByCategory:p,getFilesByRelatedItem:g,searchFiles:x,getFileStats:b,fileLimits:v}=Aw(t),[y,w]=(0,a.useState)(!1),[j,N]=(0,a.useState)(""),[k,S]=(0,a.useState)(r),[E,T]=(0,a.useState)(!1),[_,C]=(0,a.useState)(""),A=i&&c.canEdit,[D,P]=(0,a.useState)([]),[I,O]=(0,a.useState)("grid"),R=(0,a.useRef)(null),M=(0,a.useMemo)(()=>{let e=d;return console.log("\ud83d\udd0d FileManager - Filtrado:",{totalFiles:d.length,category:r,selectedCategory:k,isContextual:o,searchTerm:j}),"general"!==r&&o?(e=p(r),console.log("\ud83d\udcc2 Filtrado por categor\xeda contextual:",r,"archivos:",e.length)):"general"!==k&&(e=p(k),console.log("\ud83d\udcc2 Filtrado por categor\xeda seleccionada:",k,"archivos:",e.length)),s&&(e=g(s),console.log("\ud83d\udd17 Filtrado por item relacionado:",s,"archivos:",e.length)),j&&(e=x(j),console.log("\ud83d\udd0d Filtrado por b\xfasqueda:",j,"archivos:",e.length)),console.log("\u2705 Archivos finales filtrados:",e.length),e.sort((e,t)=>new Date(t.uploadDate)-new Date(e.uploadDate))},[d,r,k,s,j,o,p,g,x]),F=(0,a.useMemo)(()=>b(),[b]),L=e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?w(!0):"dragleave"===e.type&&w(!1)},z=async e=>{P(Array.from(e)),T(!0)},B=e=>{const t=document.createElement("a");t.href=e.content,t.download=e.fileName,document.body.appendChild(t),t.click(),document.body.removeChild(t)},U=e=>{const t=e.mimeType||e.type||"";t.startsWith("image/")||"application/pdf"===t?window.open(e.content,"_blank"):B(e)},W=e=>{const t=e.mimeType||e.type||"";return t.startsWith("image/")?"\ud83d\uddbc\ufe0f":"application/pdf"===t?"\ud83d\udcc4":t.includes("word")?"\ud83d\udcdd":t.includes("excel")?"\ud83d\udcca":"\ud83d\udcce"},H=e=>{const t=e.type||"";return t.startsWith("image/")?"\ud83d\uddbc\ufe0f":"application/pdf"===t?"\ud83d\udcc4":t.includes("word")?"\ud83d\udcdd":t.includes("excel")?"\ud83d\udcca":"\ud83d\udcce"},V=e=>{const t=e.mimeType||e.type||"";return t.startsWith("image/")?"from-pink-500 to-rose-500":"application/pdf"===t?"from-red-500 to-pink-500":t.includes("word")?"from-blue-500 to-indigo-500":t.includes("excel")?"from-green-500 to-emerald-500":"from-gray-500 to-slate-500"},G=e=>{if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]},q=[{id:"purchase-order",name:"\xd3rdenes de Compra",icon:"\ud83d\uded2",color:"bg-blue-100 text-blue-800"},{id:"invoice",name:"Facturas",icon:"\ud83e\uddfe",color:"bg-green-100 text-green-800"},{id:"advance",name:"Anticipos",icon:"\ud83d\udcb0",color:"bg-yellow-100 text-yellow-800"},{id:"contract",name:"Contratos",icon:"\ud83d\udccb",color:"bg-purple-100 text-purple-800"},{id:"risk-evidence",name:"Evidencia de Riesgos",icon:"\ud83d\udee1\ufe0f",color:"bg-red-100 text-red-800"},{id:"general",name:"General",icon:"\ud83d\udcc1",color:"bg-gray-100 text-gray-800"}],$=q.find(e=>e.id===k);return(0,bt.jsxs)("div",{className:"space-y-6",children:[(0,bt.jsxs)("div",{className:"bg-gradient-to-r from-slate-50 to-gray-50 rounded-xl shadow-sm border border-gray-100 p-6",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,bt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,bt.jsx)("div",{className:"p-3 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-xl text-white",children:(0,bt.jsx)("span",{className:"text-2xl",children:"\ud83d\udcce"})}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h3",{className:"text-xl font-bold text-gray-800",children:l}),(0,bt.jsx)("p",{className:"text-sm text-gray-600",children:o?"Archivos relacionados con este contexto":"Gesti\xf3n completa de documentos del proyecto"})]})]}),(0,bt.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,bt.jsxs)("div",{className:"text-right",children:[(0,bt.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:F.totalFiles}),(0,bt.jsx)("div",{className:"text-sm text-gray-600",children:"archivos"})]}),(0,bt.jsxs)("div",{className:"text-right",children:[(0,bt.jsxs)("div",{className:"text-lg font-semibold text-gray-800",children:[F.totalSizeMB,"MB"]}),(0,bt.jsx)("div",{className:"text-xs text-gray-500",children:"total"})]}),A&&(0,bt.jsxs)("button",{onClick:()=>{var e;return null===(e=R.current)||void 0===e?void 0:e.click()},className:"px-6 py-3 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-xl hover:from-blue-700 hover:to-indigo-700 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",children:[(0,bt.jsx)("span",{className:"mr-2",children:"\ud83d\udce4"}),"Subir Archivos"]})]})]}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[(0,bt.jsx)("div",{className:"lg:col-span-2",children:(0,bt.jsxs)("div",{className:"relative",children:[(0,bt.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,bt.jsx)("span",{className:"text-gray-400",children:"\ud83d\udd0d"})}),(0,bt.jsx)("input",{type:"text",placeholder:"Buscar archivos por nombre, descripci\xf3n o categor\xeda...",value:j,onChange:e=>N(e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white shadow-sm transition-all duration-200"})]})}),"general"===r&&(0,bt.jsx)("div",{children:(0,bt.jsx)("select",{value:k,onChange:e=>S(e.target.value),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white shadow-sm transition-all duration-200",children:q.map(e=>(0,bt.jsxs)("option",{value:e.id,children:[e.icon," ",e.name]},e.id))})})]}),$&&(0,bt.jsxs)("div",{className:"mt-4 flex items-center space-x-2",children:[(0,bt.jsxs)("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat($.color),children:[$.icon," ",$.name]}),(0,bt.jsxs)("span",{className:"text-sm text-gray-500",children:[M.length," archivo",1!==M.length?"s":""," encontrado",1!==M.length?"s":""]})]})]}),!c.canEdit&&i&&(0,bt.jsx)("div",{className:"bg-orange-50 border border-orange-200 rounded-xl p-6 text-center",children:(0,bt.jsxs)("div",{className:"flex items-center justify-center space-x-3 text-orange-700",children:[(0,bt.jsx)("span",{className:"text-2xl",children:"\ud83d\udc40"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("p",{className:"font-medium text-lg",children:"Modo Solo Lectura"}),(0,bt.jsx)("p",{className:"text-sm text-orange-600",children:"Puedes visualizar y descargar archivos, pero no subir nuevos"})]})]})}),A&&(0,bt.jsx)("div",{className:"border-2 border-dashed rounded-xl p-12 text-center transition-all duration-300 ".concat(y?"border-blue-500 bg-gradient-to-r from-blue-50 to-indigo-50 scale-105":"border-gray-300 hover:border-blue-400 hover:bg-gradient-to-r hover:from-gray-50 hover:to-blue-50"),onDragEnter:L,onDragLeave:L,onDragOver:L,onDrop:e=>{e.preventDefault(),e.stopPropagation(),w(!1),e.dataTransfer.files&&e.dataTransfer.files[0]&&z(e.dataTransfer.files)},children:(0,bt.jsxs)("div",{className:"space-y-6",children:[(0,bt.jsx)("div",{className:"text-6xl",children:"\ud83d\udcc1"}),(0,bt.jsxs)("div",{className:"space-y-2",children:[(0,bt.jsx)("div",{className:"text-2xl font-bold text-gray-700",children:"Arrastra archivos aqu\xed"}),(0,bt.jsx)("div",{className:"text-lg text-gray-600",children:"o haz clic para seleccionar"})]}),(0,bt.jsxs)("div",{className:"text-sm text-gray-500 max-w-md mx-auto",children:["Tipos permitidos: PDF, JPG, PNG, DOC, DOCX, XLS, XLSX",(0,bt.jsx)("br",{}),"Tama\xf1o m\xe1ximo: ",v.maxFileSize/1048576,"MB por archivo"]}),(0,bt.jsx)("button",{onClick:()=>{var e;return null===(e=R.current)||void 0===e?void 0:e.click()},className:"px-8 py-4 bg-gradient-to-r from-gray-100 to-gray-200 text-gray-700 rounded-xl hover:from-gray-200 hover:to-gray-300 transition-all duration-200 font-medium shadow-sm hover:shadow-md",children:"Seleccionar Archivos"})]})}),M.length>0&&(0,bt.jsx)("div",{className:"flex items-center justify-between",children:(0,bt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,bt.jsx)("span",{className:"text-sm text-gray-600",children:"Vista:"}),(0,bt.jsx)("button",{onClick:()=>O("grid"),className:"p-2 rounded-lg transition-colors ".concat("grid"===I?"bg-blue-100 text-blue-600":"text-gray-400 hover:text-gray-600"),children:"\u2b1b\u2b1b"}),(0,bt.jsx)("button",{onClick:()=>O("list"),className:"p-2 rounded-lg transition-colors ".concat("list"===I?"bg-blue-100 text-blue-600":"text-gray-400 hover:text-gray-600"),children:"\u2630"})]})}),M.length>0?(0,bt.jsx)("div",{className:"space-y-4",children:"grid"===I?(0,bt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:M.map(e=>(0,bt.jsxs)("div",{className:"group bg-white rounded-xl shadow-sm border border-gray-100 hover:shadow-lg transition-all duration-200 hover:-translate-y-1",children:[(0,bt.jsx)("div",{className:"p-4 bg-gradient-to-r ".concat(V(e)," rounded-t-xl text-white"),children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsx)("span",{className:"text-2xl",children:W(e)}),(0,bt.jsx)("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:(0,bt.jsx)("button",{onClick:()=>m(e.id),className:"p-1 bg-white bg-opacity-20 rounded hover:bg-opacity-30 transition-colors",title:"Eliminar",children:"\ud83d\uddd1\ufe0f"})})]})}),(0,bt.jsxs)("div",{className:"p-4",children:[(0,bt.jsxs)("div",{className:"space-y-3",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("div",{className:"font-semibold text-gray-900 truncate",title:e.fileName,children:e.fileName}),(0,bt.jsx)("div",{className:"text-xs text-gray-500",children:G(e.fileSize)})]}),e.description&&(0,bt.jsx)("div",{className:"text-sm text-gray-600 line-clamp-2",children:e.description}),(0,bt.jsx)("div",{className:"text-xs text-gray-400",children:new Date(e.uploadDate).toLocaleDateString()})]}),(0,bt.jsxs)("div",{className:"mt-4 flex items-center justify-between opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:[(0,bt.jsx)("button",{onClick:()=>U(e),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Vista previa",children:"\ud83d\udc41\ufe0f"}),(0,bt.jsx)("button",{onClick:()=>B(e),className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Descargar",children:"\u2b07\ufe0f"})]})]})]},e.id))}):(0,bt.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:(0,bt.jsx)("div",{className:"overflow-x-auto",children:(0,bt.jsxs)("table",{className:"w-full",children:[(0,bt.jsx)("thead",{className:"bg-gradient-to-r from-gray-50 to-gray-100",children:(0,bt.jsxs)("tr",{children:[(0,bt.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Archivo"}),(0,bt.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tama\xf1o"}),(0,bt.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fecha"}),(0,bt.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),(0,bt.jsx)("tbody",{className:"divide-y divide-gray-100",children:M.map(e=>(0,bt.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors",children:[(0,bt.jsx)("td",{className:"px-6 py-4",children:(0,bt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,bt.jsx)("div",{className:"p-2 rounded-lg bg-gradient-to-r ".concat(V(e)," text-white"),children:W(e)}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("div",{className:"font-medium text-gray-900",children:e.fileName}),e.description&&(0,bt.jsx)("div",{className:"text-sm text-gray-500",children:e.description})]})]})}),(0,bt.jsx)("td",{className:"px-6 py-4 text-sm text-gray-500",children:G(e.fileSize)}),(0,bt.jsx)("td",{className:"px-6 py-4 text-sm text-gray-500",children:new Date(e.uploadDate).toLocaleDateString()}),(0,bt.jsx)("td",{className:"px-6 py-4",children:(0,bt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,bt.jsx)("button",{onClick:()=>U(e),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Vista previa",children:"\ud83d\udc41\ufe0f"}),(0,bt.jsx)("button",{onClick:()=>B(e),className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Descargar",children:"\u2b07\ufe0f"}),(0,bt.jsx)("button",{onClick:()=>m(e.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Eliminar",children:"\ud83d\uddd1\ufe0f"})]})})]},e.id))})]})})})}):(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-12 text-center",children:[(0,bt.jsx)("div",{className:"text-6xl mb-6",children:"\ud83d\udcc1"}),(0,bt.jsxs)("div",{className:"space-y-2",children:[(0,bt.jsx)("div",{className:"text-2xl font-bold text-gray-700",children:"No hay archivos"}),(0,bt.jsx)("div",{className:"text-gray-500 max-w-md mx-auto",children:j?"No se encontraron archivos con esa b\xfasqueda":"Sube tu primer archivo para comenzar"})]})]}),(0,bt.jsx)("input",{ref:R,type:"file",multiple:!0,accept:".pdf,.jpg,.jpeg,.png,.doc,.docx,.xls,.xlsx",onChange:e=>{e.target.files&&e.target.files[0]&&z(e.target.files)},className:"hidden"}),E&&(0,bt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:(0,bt.jsx)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md max-h-[90vh] overflow-y-auto",children:(0,bt.jsxs)("div",{className:"p-6",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,bt.jsx)("h3",{className:"text-xl font-bold text-gray-800",children:"\ud83d\udce4 Subir Archivos"}),(0,bt.jsx)("button",{onClick:()=>{T(!1),P([]),C("")},className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-full transition-colors",children:"\u2715"})]}),(0,bt.jsxs)("div",{className:"space-y-6",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\ud83d\udcc2 Categor\xeda"}),(0,bt.jsx)("select",{value:k,onChange:e=>S(e.target.value),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",children:q.map(e=>(0,bt.jsxs)("option",{value:e.id,children:[e.icon," ",e.name]},e.id))})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\ud83d\udcdd Descripci\xf3n (opcional)"}),(0,bt.jsx)("textarea",{value:_,onChange:e=>C(e.target.value),placeholder:"Describe brevemente estos archivos...",className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors resize-none",rows:"3"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["\ud83d\udcce Archivos seleccionados (",D.length,")"]}),(0,bt.jsx)("div",{className:"max-h-32 overflow-y-auto space-y-2",children:D.map((e,t)=>(0,bt.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,bt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,bt.jsx)("span",{className:"text-lg",children:H(e)}),(0,bt.jsx)("span",{className:"text-sm font-medium text-gray-700",children:e.name})]}),(0,bt.jsx)("span",{className:"text-xs text-gray-500",children:G(e.size)})]},t))})]})]}),(0,bt.jsxs)("div",{className:"flex justify-end space-x-3 mt-8",children:[(0,bt.jsx)("button",{onClick:()=>{T(!1),P([]),C("")},className:"px-6 py-3 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-xl transition-colors font-medium",children:"Cancelar"}),(0,bt.jsx)("button",{onClick:async()=>{try{for(const e of D)await f(e,k,s,_);T(!1),P([]),C(""),n&&n()}catch(h){console.error("Error uploading files:",h)}},disabled:u,className:"px-6 py-3 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-xl hover:from-blue-700 hover:to-indigo-700 disabled:opacity-50 transition-all duration-200 font-medium shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 disabled:transform-none",children:u?(0,bt.jsxs)("span",{className:"flex items-center",children:[(0,bt.jsx)("span",{className:"animate-spin mr-2",children:"\u23f3"}),"Subiendo..."]}):(0,bt.jsxs)("span",{className:"flex items-center",children:[(0,bt.jsx)("span",{className:"mr-2",children:"\ud83d\udce4"}),"Subir Archivos"]})})]})]})})}),h&&(0,bt.jsx)("div",{className:"bg-gradient-to-r from-red-50 to-pink-50 border border-red-200 rounded-xl p-4",children:(0,bt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,bt.jsx)("span",{className:"text-red-600 text-lg",children:"\u274c"}),(0,bt.jsx)("span",{className:"text-red-800 font-medium",children:h})]})})]})},Pw=e=>{let{error:t}=e;return t?(0,bt.jsx)("p",{className:"text-red-500 text-xs mt-1",children:t}):null},Iw=e=>{var t,r;let{projects:s,currentProjectId:i,setCurrentProjectId:o,portfolioMetrics:l,workPackages:c,risks:d,globalResources:u,setGlobalResources:h,createProject:f,updateProject:m,deleteProject:p,duplicateProject:g,archiveProject:x}=e;const[b,v]=(0,a.useState)(!1),[y,w]=(0,a.useState)(null),[j,N]=(0,a.useState)(!1),[k,S]=(0,a.useState)(null),[E,T]=(0,a.useState)({}),{permissions:_,isReadOnly:C,isLoading:A}=kt(),D=e=>{switch(e){case"high":return"bg-red-100 text-red-800 border-red-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"low":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},P=e=>{switch(e){case"active":return"bg-blue-100 text-blue-800 border-blue-200";case"completed":return"bg-green-100 text-green-800 border-green-200";case"on-hold":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"cancelled":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},I=e=>{switch(e){case"active":return"\ud83d\udd04";case"completed":return"\u2705";case"on-hold":default:return"\u23f8\ufe0f";case"cancelled":return"\u274c"}},O=(e,t)=>{S(r=>(0,n.A)((0,n.A)({},r),{},{[e]:t}))},R=(e,t)=>{const r=Object.assign({},E);switch(e){case"name":!t||t.trim().length<3?r.name="El nombre debe tener al menos 3 caracteres":delete r.name;break;case"manager":!t||t.trim().length<2?r.manager="El manager debe tener al menos 2 caracteres":delete r.manager;break;case"sponsor":!t||t.trim().length<2?r.sponsor="El sponsor debe tener al menos 2 caracteres":delete r.sponsor;break;case"startDate":t?delete r.startDate:r.startDate="La fecha de inicio es requerida";break;case"endDate":t?null!==k&&void 0!==k&&k.startDate&&t<=k.startDate?r.endDate="La fecha de fin debe ser posterior a la fecha de inicio":delete r.endDate:r.endDate="La fecha de fin es requerida";break;case"budget":!t||t<=0?r.budget="El presupuesto debe ser mayor a 0":delete r.budget;break;case"irr":t&&(t<0||t>100)?r.irr="La TIR debe estar entre 0% y 100%":delete r.irr}return T(r),0===Object.keys(r).length},M=()=>{S({id:"",name:"",description:"",status:"inactive",priority:"medium",startDate:(new Date).toISOString().split("T")[0],endDate:new Date(Date.now()+7776e6).toISOString().split("T")[0],budget:1e5,contingencyReserve:1e4,managementReserve:5e3,manager:"",sponsor:"",objective:"",businessCase:"",irr:0,roi:0,kickoffDate:"",stakeholders:[],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),version:"1.0.0"}),T({}),N(!0)},F=(0,a.useMemo)(()=>{if(!s||0===s.length)return{totalProjects:0,activeProjects:0,completedProjects:0,totalBudget:0,averageProgress:0,totalWorkPackages:0,totalRisks:0,activeRisks:0};const e=s.length,t=s.filter(e=>"active"===e.status).length,r=s.filter(e=>"completed"===e.status).length,a=s.filter(e=>"active"===e.status),n=a.reduce((e,t)=>e+(t.budget||0),0),i=a.length>0?a.reduce((e,t)=>e+(t.progress||0),0)/a.length:0,o=c?c.length:0,l=d?d.length:0,u=d?d.filter(e=>"active"===e.status).length:0;return{totalProjects:e,activeProjects:t,completedProjects:r,totalBudget:n,averageProgress:Math.round(i),totalWorkPackages:o,totalRisks:l,activeRisks:u}},[s,c,d]),L=l||F;return(0,bt.jsxs)("div",{className:"space-y-6",children:[(0,bt.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,bt.jsxs)("div",{className:"flex items-center",children:[(0,bt.jsx)("div",{className:"text-blue-600 text-xl mr-3",children:"\u2139\ufe0f"}),(0,bt.jsxs)("div",{className:"text-blue-800",children:[(0,bt.jsx)("strong",{children:"Nota:"}),' Las m\xe9tricas financieras y KPIs solo consideran proyectos con estado "Activo". Los proyectos "Inactivos" o "Completados" no influyen en los indicadores financieros.']})]})}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,bt.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-blue-500",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:"Total Proyectos"}),(0,bt.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:L.totalProjects})]}),(0,bt.jsx)("div",{className:"text-blue-500 text-2xl",children:"\ud83d\udcca"})]})}),(0,bt.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-green-500",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:"Proyectos Activos"}),(0,bt.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:L.activeProjects})]}),(0,bt.jsx)("div",{className:"text-green-500 text-2xl",children:"\ud83d\udd04"})]})}),(0,bt.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-purple-500",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:"Completados"}),(0,bt.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:L.completedProjects})]}),(0,bt.jsx)("div",{className:"text-purple-500 text-2xl",children:"\u2705"})]})}),(0,bt.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-indigo-500",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:"Presupuesto Proyectos Activos"}),(0,bt.jsxs)("div",{className:"text-2xl font-bold text-gray-800",children:["$",(L.totalBudget/1e3).toFixed(0),"K"]})]}),(0,bt.jsx)("div",{className:"text-indigo-500 text-2xl",children:"\ud83d\udcb0"})]})})]}),(0,bt.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,bt.jsx)("h2",{className:"text-lg font-semibold text-gray-800",children:"Acciones del Portfolio"}),(0,bt.jsxs)("div",{className:"flex space-x-2",children:[_.canEdit&&(0,bt.jsxs)("button",{onClick:M,className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 flex items-center space-x-2",children:[(0,bt.jsx)("span",{children:"\u2795"}),(0,bt.jsx)("span",{children:"Nuevo Proyecto"})]}),C()&&(0,bt.jsxs)("div",{className:"text-sm text-gray-500 italic bg-gray-50 px-3 py-2 rounded-lg border",children:[(0,bt.jsx)("span",{children:"\ud83d\udc40"})," Modo solo lectura"]})]})]})}),(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-4",children:[(0,bt.jsx)("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Proyectos del Portfolio"}),0===s.length?(0,bt.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,bt.jsx)("div",{className:"text-4xl mb-2",children:"\ud83d\udcc1"}),(0,bt.jsx)("div",{children:"No hay proyectos en el portfolio"}),(0,bt.jsx)("button",{onClick:M,className:"mt-4 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Crear Primer Proyecto"})]}):(0,bt.jsx)("div",{className:"space-y-3",children:s.map(e=>(0,bt.jsx)("div",{className:"border rounded-lg p-4 transition-all duration-200 cursor-pointer hover:shadow-md ".concat(i===e.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),onClick:()=>o(e.id),children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{className:"flex-1",children:[(0,bt.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,bt.jsx)("h3",{className:"font-semibold text-gray-900",children:e.name}),(0,bt.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium border ".concat(D(e.priority)),children:e.priority}),(0,bt.jsxs)("span",{className:"px-2 py-1 rounded-full text-xs font-medium border ".concat(P(e.status)),children:[I(e.status)," ",e.status]})]}),(0,bt.jsx)("div",{className:"text-sm text-gray-600 mb-2",children:e.description}),(0,bt.jsxs)("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[(0,bt.jsxs)("span",{children:["\ud83d\udcc5 ",e.startDate," - ",e.endDate]}),(0,bt.jsxs)("span",{children:["\ud83d\udcb0 $",(e.budget/1e3).toFixed(0),"K"]}),(0,bt.jsxs)("span",{children:["\ud83d\udc64 ",e.manager]})]})]}),(0,bt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,bt.jsx)("button",{onClick:t=>{t.stopPropagation(),w(e),v(!0)},className:"p-2 text-gray-400 hover:text-purple-600 hover:bg-purple-50 rounded transition-colors",title:"Ver archivos del proyecto",children:"\ud83d\udcce"}),(0,bt.jsx)("button",{onClick:t=>{t.stopPropagation(),g(e.id)},className:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded",title:"Duplicar proyecto",children:"\ud83d\udccb"}),(0,bt.jsx)("button",{onClick:t=>{t.stopPropagation(),(e=>{console.log("\ud83d\udd0d Proyecto original para editar:",e),console.log("\ud83d\udd0d Estado del proyecto original:",e.status);const t=(0,n.A)((0,n.A)({},e),{},{description:e.description||"",objective:e.objective||"",businessCase:e.businessCase||"",kickoffDate:e.kickoffDate||"",stakeholders:e.stakeholders||[]});console.log("\ud83d\udd0d Proyecto preparado para editar:",t),console.log("\ud83d\udd0d Estado del proyecto preparado:",t.status),S(t),T({}),N(!0)})(e)},className:"p-2 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded",title:"Editar proyecto",children:"\u270f\ufe0f"}),(0,bt.jsx)("button",{onClick:t=>{t.stopPropagation(),window.confirm('\xbfArchivar proyecto "'.concat(e.name,'"? Se mover\xe1 al archivo y se limpiar\xe1n sus datos del sistema activo.'))&&x(e.id)},className:"p-2 text-gray-400 hover:text-orange-600 hover:bg-orange-50 rounded",title:"Archivar proyecto",children:"\ud83d\udcc1"}),(0,bt.jsx)("button",{onClick:t=>{t.stopPropagation(),window.confirm('\xbfEliminar proyecto "'.concat(e.name,'"? Esta acci\xf3n no se puede deshacer.'))&&p(e.id)},className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded",title:"Eliminar proyecto",children:"\ud83d\uddd1\ufe0f"})]})]})},e.id))})]}),i&&(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-4",children:[(0,bt.jsx)("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"M\xe9tricas del Proyecto Actual"}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,bt.jsxs)("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[(0,bt.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:(null===l||void 0===l||null===(t=l.currentProjectCPI)||void 0===t?void 0:t.toFixed(2))||"N/A"}),(0,bt.jsx)("div",{className:"text-xs text-gray-600",children:"CPI"})]}),(0,bt.jsxs)("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[(0,bt.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:(null===l||void 0===l||null===(r=l.currentProjectSPI)||void 0===r?void 0:r.toFixed(2))||"N/A"}),(0,bt.jsx)("div",{className:"text-xs text-gray-600",children:"SPI"})]}),(0,bt.jsxs)("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[(0,bt.jsxs)("div",{className:"text-2xl font-bold text-gray-800",children:["$",((null===l||void 0===l?void 0:l.currentProjectCV)/1e3).toFixed(0),"K"]}),(0,bt.jsx)("div",{className:"text-xs text-gray-600",children:"CV"})]}),(0,bt.jsxs)("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[(0,bt.jsxs)("div",{className:"text-2xl font-bold text-gray-800",children:["$",((null===l||void 0===l?void 0:l.currentProjectSV)/1e3).toFixed(0),"K"]}),(0,bt.jsx)("div",{className:"text-xs text-gray-600",children:"SV"})]})]})]}),(0,bt.jsx)(Tt,{projects:s,portfolioMetrics:l}),(0,bt.jsx)(Et,{projects:s,portfolioMetrics:l,workPackages:c,risks:d}),b&&y&&(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,bt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,bt.jsx)("div",{className:"p-3 bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl text-white",children:(0,bt.jsx)("span",{className:"text-2xl",children:"\ud83d\udcce"})}),(0,bt.jsxs)("div",{children:[(0,bt.jsxs)("h3",{className:"text-xl font-bold text-gray-800",children:["Archivos del Proyecto: ",y.name]}),(0,bt.jsx)("p",{className:"text-sm text-gray-600",children:"Gesti\xf3n completa de documentos y archivos adjuntos"})]})]}),(0,bt.jsx)("button",{onClick:()=>{v(!1),w(null)},className:"px-4 py-2 bg-gradient-to-r from-gray-500 to-gray-600 text-white rounded-lg hover:from-gray-600 hover:to-gray-700 transition-all duration-200 shadow-sm hover:shadow-md",children:"\u2715 Cerrar"})]}),(0,bt.jsx)(Dw,{projectId:y.id,category:"general",isContextual:!0,title:"\ud83d\udcce Archivos de ".concat(y.name),onFileUploaded:()=>{}})]}),j&&(0,bt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[9999] flex items-center justify-center p-4",children:(0,bt.jsx)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:(0,bt.jsxs)("div",{className:"p-6",children:[(0,bt.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,bt.jsx)("h2",{className:"text-xl font-bold",children:null!==k&&void 0!==k&&k.id?"Editar Proyecto":"Nuevo Proyecto"}),(0,bt.jsx)("button",{onClick:()=>{N(!1),S(null)},className:"text-gray-500 hover:text-gray-700 text-2xl font-bold",children:"\xd7"})]}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre del Proyecto *"}),(0,bt.jsx)("input",{type:"text",className:"w-full border rounded px-3 py-2 ".concat(E.name?"border-red-500":"border-gray-300"),value:(null===k||void 0===k?void 0:k.name)||"",onChange:e=>{S({id:k.id,name:k.name,manager:k.manager,sponsor:k.sponsor,priority:k.priority,status:k.status,startDate:k.startDate,endDate:k.endDate,budget:k.budget,irr:k.irr,description:k.description,objectives:k.objectives,scope:k.scope,deliverables:k.deliverables,assumptions:k.assumptions,constraints:k.constraints,dependencies:k.dependencies,risks:k.risks,stakeholders:k.stakeholders,team:k.team,resources:k.resources,timeline:k.timeline,milestones:k.milestones,successCriteria:k.successCriteria,qualityStandards:k.qualityStandards,communicationPlan:k.communicationPlan,riskManagement:k.riskManagement,changeManagement:k.changeManagement,lessonsLearned:k.lessonsLearned,createdAt:k.createdAt,updatedAt:k.updatedAt,version:k.version,progress:k.progress,name:e.target.value}),R("name",e.target.value)},onBlur:e=>R("name",e.target.value),placeholder:"Nombre del proyecto"}),(0,bt.jsx)(Pw,{error:E.name})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Manager *"}),(0,bt.jsx)("input",{type:"text",className:"w-full border rounded px-3 py-2 ".concat(E.manager?"border-red-500":"border-gray-300"),value:(null===k||void 0===k?void 0:k.manager)||"",onChange:e=>{S({id:k.id,name:k.name,manager:k.manager,sponsor:k.sponsor,priority:k.priority,status:k.status,startDate:k.startDate,endDate:k.endDate,budget:k.budget,irr:k.irr,description:k.description,objectives:k.objectives,scope:k.scope,deliverables:k.deliverables,assumptions:k.assumptions,constraints:k.constraints,dependencies:k.dependencies,risks:k.risks,stakeholders:k.stakeholders,team:k.team,resources:k.resources,timeline:k.timeline,milestones:k.milestones,successCriteria:k.successCriteria,qualityStandards:k.qualityStandards,communicationPlan:k.communicationPlan,riskManagement:k.riskManagement,changeManagement:k.changeManagement,lessonsLearned:k.lessonsLearned,createdAt:k.createdAt,updatedAt:k.updatedAt,version:k.version,progress:k.progress,manager:e.target.value}),R("manager",e.target.value)},onBlur:e=>R("manager",e.target.value),placeholder:"Gerente del proyecto"}),(0,bt.jsx)(Pw,{error:E.manager})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sponsor *"}),(0,bt.jsx)("input",{type:"text",className:"w-full border rounded px-3 py-2 ".concat(E.sponsor?"border-red-500":"border-gray-300"),value:(null===k||void 0===k?void 0:k.sponsor)||"",onChange:e=>{O("sponsor",e.target.value),R("sponsor",e.target.value)},onBlur:e=>R("sponsor",e.target.value),placeholder:"Patrocinador del proyecto"}),(0,bt.jsx)(Pw,{error:E.sponsor})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prioridad"}),(0,bt.jsxs)("select",{className:"w-full border rounded px-3 py-2",value:(null===k||void 0===k?void 0:k.priority)||"medium",onChange:e=>S({id:k.id,name:k.name,manager:k.manager,sponsor:k.sponsor,priority:k.priority,status:k.status,startDate:k.startDate,endDate:k.endDate,budget:k.budget,irr:k.irr,description:k.description,objectives:k.objectives,scope:k.scope,deliverables:k.deliverables,assumptions:k.assumptions,constraints:k.constraints,dependencies:k.dependencies,risks:k.risks,stakeholders:k.stakeholders,team:k.team,resources:k.resources,timeline:k.timeline,milestones:k.milestones,successCriteria:k.successCriteria,qualityStandards:k.qualityStandards,communicationPlan:k.communicationPlan,riskManagement:k.riskManagement,changeManagement:k.changeManagement,lessonsLearned:k.lessonsLearned,createdAt:k.createdAt,updatedAt:k.updatedAt,version:k.version,progress:k.progress,priority:e.target.value}),children:[(0,bt.jsx)("option",{value:"low",children:"Baja"}),(0,bt.jsx)("option",{value:"medium",children:"Media"}),(0,bt.jsx)("option",{value:"high",children:"Alta"})]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estado del Proyecto *"}),(0,bt.jsxs)("select",{className:"w-full border rounded px-3 py-2",value:(null===k||void 0===k?void 0:k.status)||"inactive",onChange:e=>S({id:k.id,name:k.name,manager:k.manager,sponsor:k.sponsor,priority:k.priority,status:k.status,startDate:k.startDate,endDate:k.endDate,budget:k.budget,irr:k.irr,description:k.description,objectives:k.objectives,scope:k.scope,deliverables:k.deliverables,assumptions:k.assumptions,constraints:k.constraints,dependencies:k.dependencies,risks:k.risks,stakeholders:k.stakeholders,team:k.team,resources:k.resources,timeline:k.timeline,milestones:k.milestones,successCriteria:k.successCriteria,qualityStandards:k.qualityStandards,communicationPlan:k.communicationPlan,riskManagement:k.riskManagement,changeManagement:k.changeManagement,lessonsLearned:k.lessonsLearned,createdAt:k.createdAt,updatedAt:k.updatedAt,version:k.version,progress:k.progress,status:e.target.value}),children:[(0,bt.jsx)("option",{value:"inactive",children:"\u26ab Inactivo"}),(0,bt.jsx)("option",{value:"active",children:"\ud83d\udfe2 Activo"})]}),(0,bt.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[(0,bt.jsx)("strong",{children:"Por defecto:"}),' Los proyectos nuevos y duplicados aparecen como "Inactivos" para revisi\xf3n. Solo los proyectos "Activos" suman al dashboard consolidado y aparecen en Gesti\xf3n de Proyectos.']})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha de Inicio *"}),(0,bt.jsx)("input",{type:"date",className:"w-full border rounded px-3 py-2 ".concat(E.startDate?"border-red-500":"border-gray-300"),value:(null===k||void 0===k?void 0:k.startDate)||"",onChange:e=>{S({id:k.id,name:k.name,manager:k.manager,sponsor:k.sponsor,priority:k.priority,status:k.status,startDate:k.startDate,endDate:k.endDate,budget:k.budget,irr:k.irr,description:k.description,objectives:k.objectives,scope:k.scope,deliverables:k.deliverables,assumptions:k.assumptions,constraints:k.constraints,dependencies:k.dependencies,risks:k.risks,stakeholders:k.stakeholders,team:k.team,resources:k.resources,timeline:k.timeline,milestones:k.milestones,successCriteria:k.successCriteria,qualityStandards:k.qualityStandards,communicationPlan:k.communicationPlan,riskManagement:k.riskManagement,changeManagement:k.changeManagement,lessonsLearned:k.lessonsLearned,createdAt:k.createdAt,updatedAt:k.updatedAt,version:k.version,progress:k.progress,startDate:e.target.value}),R("startDate",e.target.value),null!==k&&void 0!==k&&k.endDate&&R("endDate",k.endDate)},onBlur:e=>R("startDate",e.target.value)}),(0,bt.jsx)(Pw,{error:E.startDate})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha de Fin *"}),(0,bt.jsx)("input",{type:"text",className:"w-full border rounded px-3 py-2 ".concat(E.endDate?"border-red-500":"border-gray-300"),value:(null===k||void 0===k?void 0:k.endDate)||"",onChange:e=>{S({id:k.id,name:k.name,manager:k.manager,sponsor:k.sponsor,priority:k.priority,status:k.status,startDate:k.startDate,endDate:k.endDate,budget:k.budget,irr:k.irr,description:k.description,objectives:k.objectives,scope:k.scope,deliverables:k.deliverables,assumptions:k.assumptions,constraints:k.constraints,dependencies:k.dependencies,risks:k.risks,stakeholders:k.stakeholders,team:k.team,resources:k.resources,timeline:k.timeline,milestones:k.milestones,successCriteria:k.successCriteria,qualityStandards:k.qualityStandards,communicationPlan:k.communicationPlan,riskManagement:k.riskManagement,changeManagement:k.changeManagement,lessonsLearned:k.lessonsLearned,createdAt:k.createdAt,updatedAt:k.updatedAt,version:k.version,progress:k.progress,endDate:e.target.value}),R("endDate",e.target.value)},onBlur:e=>R("endDate",e.target.value),placeholder:"YYYY-MM-DD"}),(0,bt.jsx)(Pw,{error:E.endDate})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Presupuesto (USD) *"}),(0,bt.jsx)("input",{type:"number",className:"w-full border rounded px-3 py-2 ".concat(E.budget?"border-red-500":"border-gray-300"),value:(null===k||void 0===k?void 0:k.budget)||"",onChange:e=>{const t=e.target.value;if(""===t||/^\d+$/.test(t)){const e=""===t?"":Number(t);S({id:k.id,name:k.name,manager:k.manager,sponsor:k.sponsor,priority:k.priority,status:k.status,startDate:k.startDate,endDate:k.endDate,budget:k.budget,irr:k.irr,description:k.description,objectives:k.objectives,scope:k.scope,deliverables:k.deliverables,assumptions:k.assumptions,constraints:k.constraints,dependencies:k.dependencies,risks:k.risks,stakeholders:k.stakeholders,team:k.team,resources:k.resources,timeline:k.timeline,milestones:k.milestones,successCriteria:k.successCriteria,qualityStandards:k.qualityStandards,communicationPlan:k.communicationPlan,riskManagement:k.riskManagement,changeManagement:k.changeManagement,lessonsLearned:k.lessonsLearned,createdAt:k.createdAt,updatedAt:k.updatedAt,version:k.version,progress:k.progress,budget:e}),R("budget",e)}},onBlur:e=>{const t=""===e.target.value?"":Number(e.target.value);R("budget",t)},placeholder:"Presupuesto en USD (ej: 100000)",min:"0"}),(0,bt.jsx)(Pw,{error:E.budget})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"TIR (%)"}),(0,bt.jsx)("input",{type:"number",className:"w-full border rounded px-3 py-2 ".concat(E.irr?"border-red-500":"border-gray-300"),value:(null===k||void 0===k?void 0:k.irr)||"",onChange:e=>{const t=e.target.value;if(""===t||/^\d*\.?\d*$/.test(t)){const e=""===t?"":Number(t);O("irr",e),R("irr",e)}},onBlur:e=>{const t=""===e.target.value?"":Number(e.target.value);R("irr",t)},placeholder:"Tasa Interna de Retorno (ej: 15.5)",min:"0",max:"100",step:"0.01"}),(0,bt.jsx)(Pw,{error:E.irr})]}),(0,bt.jsxs)("div",{className:"md:col-span-2",children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripci\xf3n"}),(0,bt.jsx)("textarea",{className:"w-full border rounded px-3 py-2",rows:"3",value:(null===k||void 0===k?void 0:k.description)||"",onChange:e=>S({id:k.id,name:k.name,manager:k.manager,sponsor:k.sponsor,priority:k.priority,status:k.status,startDate:k.startDate,endDate:k.endDate,budget:k.budget,irr:k.irr,description:k.description,objectives:k.objectives,scope:k.scope,deliverables:k.deliverables,assumptions:k.assumptions,constraints:k.constraints,dependencies:k.dependencies,risks:k.risks,stakeholders:k.stakeholders,team:k.team,resources:k.resources,timeline:k.timeline,milestones:k.milestones,successCriteria:k.successCriteria,qualityStandards:k.qualityStandards,communicationPlan:k.communicationPlan,riskManagement:k.riskManagement,changeManagement:k.changeManagement,lessonsLearned:k.lessonsLearned,createdAt:k.createdAt,updatedAt:k.updatedAt,version:k.version,progress:k.progress,description:e.target.value}),placeholder:"Descripci\xf3n detallada del proyecto"})]}),(0,bt.jsxs)("div",{className:"md:col-span-2",children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Objetivo del Proyecto"}),(0,bt.jsx)("textarea",{className:"w-full border rounded px-3 py-2",rows:"3",value:(null===k||void 0===k?void 0:k.objective)||"",onChange:e=>O("objective",e.target.value),placeholder:"\xbfQu\xe9 se busca lograr con este proyecto?"})]}),(0,bt.jsxs)("div",{className:"md:col-span-2",children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Caso de Negocio"}),(0,bt.jsx)("textarea",{className:"w-full border rounded px-3 py-2",rows:"3",value:(null===k||void 0===k?void 0:k.businessCase)||"",onChange:e=>O("businessCase",e.target.value),placeholder:"Justificaci\xf3n del proyecto desde el punto de vista del negocio"})]})]}),(0,bt.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,bt.jsx)("button",{onClick:()=>{N(!1),S(null)},className:"px-4 py-2 border border-gray-300 rounded text-gray-700 hover:bg-gray-50",children:"Cancelar"}),(0,bt.jsxs)("button",{onClick:()=>{T({});const e={};if((!k.name||k.name.trim().length<3)&&(e.name="El nombre debe tener al menos 3 caracteres"),(!k.manager||k.manager.trim().length<2)&&(e.manager="El manager debe tener al menos 2 caracteres"),(!k.sponsor||k.sponsor.trim().length<2)&&(e.sponsor="El sponsor debe tener al menos 2 caracteres"),k.startDate||(e.startDate="La fecha de inicio es requerida"),k.endDate?k.startDate&&k.endDate<=k.startDate&&(e.endDate="La fecha de fin debe ser posterior a la fecha de inicio"):e.endDate="La fecha de fin es requerida",(!k.budget||k.budget<=0)&&(e.budget="El presupuesto debe ser mayor a 0"),k.irr&&(k.irr<0||k.irr>100)&&(e.irr="La TIR debe estar entre 0% y 100%"),Object.keys(e).length>0)return T(e),void alert("\u274c No se puede guardar el proyecto. Hay ".concat(Object.keys(e).length," errores de validaci\xf3n."));try{k.id?(m(k.id,k),alert("\u2705 Proyecto actualizado exitosamente")):(f(k),alert("\u2705 Proyecto creado exitosamente")),N(!1),S(null),T({})}catch(t){alert("\u274c Error al guardar el proyecto: ".concat(t.message))}},disabled:Object.keys(E).length>0,className:"px-4 py-2 rounded transition-colors ".concat(Object.keys(E).length>0?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),children:["Guardar Proyecto ",Object.keys(E).length>0&&"(".concat(Object.keys(E).length," errores)")]})]})]})})})]})},Ow=e=>{let{globalResources:t,setGlobalResources:r}=e;const[s,n]=(0,a.useState)(!1),[i,o]=(0,a.useState)(!1),[l,c]=(0,a.useState)(null),[d,u]=(0,a.useState)(""),[h,f]=(0,a.useState)("all"),[m,p]=(0,a.useState)("all"),[g,x]=(0,a.useState)({name:"",role:"",skills:"",availability:100,hourlyRate:0,status:"active",email:"",phone:"",department:"",experience:"",certifications:"",notes:""}),b=(0,a.useMemo)(()=>t.filter(e=>{const t=!d||e.name.toLowerCase().includes(d.toLowerCase())||e.role.toLowerCase().includes(d.toLowerCase())||e.email&&e.email.toLowerCase().includes(d.toLowerCase()),r="all"===h||e.role===h,a="all"===m||e.status===m;return t&&r&&a}),[t,d,h,m]),v=(0,a.useMemo)(()=>{const e=t.map(e=>e.role);return Array.from(new Set(e))},[t]),y=(0,a.useMemo)(()=>({totalResources:t.length,activeResources:t.filter(e=>"active"===e.status).length,inactiveResources:t.filter(e=>"inactive"===e.status).length,onLeaveResources:t.filter(e=>"on-leave"===e.status).length,totalCost:t.reduce((e,t)=>e+160*t.availability*t.hourlyRate,0)}),[t]),w=e=>{switch(e){case"active":return"bg-green-100 text-green-800";case"inactive":default:return"bg-gray-100 text-gray-800";case"on-leave":return"bg-yellow-100 text-yellow-800";case"terminated":return"bg-red-100 text-red-800"}},j=e=>{switch(e){case"active":return"\u2705";case"inactive":default:return"\u23f8\ufe0f";case"on-leave":return"\ud83c\udfd6\ufe0f";case"terminated":return"\u274c"}};return(0,bt.jsxs)("div",{className:"space-y-6",children:[(0,bt.jsxs)("div",{className:"flex items-center mb-6",children:[(0,bt.jsx)("div",{className:"bg-blue-100 rounded-2xl p-3 mr-4 shadow-sm",children:(0,bt.jsx)("span",{className:"text-3xl",children:"\ud83d\udc65"})}),(0,bt.jsx)("div",{children:(0,bt.jsx)("p",{className:"text-gray-600 text-lg",children:"Gesti\xf3n global de recursos humanos del portafolio"})})]}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[(0,bt.jsxs)("div",{className:"bg-white rounded-xl p-4 border border-blue-200 hover:shadow-md transition-all duration-300",children:[(0,bt.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,bt.jsx)("span",{className:"text-lg",children:"\ud83d\udc65"}),(0,bt.jsx)("span",{className:"text-sm font-medium text-blue-600",children:"Total Recursos"})]}),(0,bt.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:y.totalResources})]}),(0,bt.jsxs)("div",{className:"bg-white rounded-xl p-4 border border-green-200 hover:shadow-md transition-all duration-300",children:[(0,bt.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,bt.jsx)("span",{className:"text-lg",children:"\u2705"}),(0,bt.jsx)("span",{className:"text-sm font-medium text-green-600",children:"Activos"})]}),(0,bt.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:y.activeResources})]}),(0,bt.jsxs)("div",{className:"bg-white rounded-xl p-4 border border-gray-200 hover:shadow-md transition-all duration-300",children:[(0,bt.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,bt.jsx)("span",{className:"text-lg",children:"\u23f8\ufe0f"}),(0,bt.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"Inactivos"})]}),(0,bt.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:y.inactiveResources})]}),(0,bt.jsxs)("div",{className:"bg-white rounded-xl p-4 border border-yellow-200 hover:shadow-md transition-all duration-300",children:[(0,bt.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,bt.jsx)("span",{className:"text-lg",children:"\ud83c\udfd6\ufe0f"}),(0,bt.jsx)("span",{className:"text-sm font-medium text-yellow-600",children:"En Licencia"})]}),(0,bt.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:y.onLeaveResources})]}),(0,bt.jsxs)("div",{className:"bg-white rounded-xl p-4 border border-purple-200 hover:shadow-md transition-all duration-300",children:[(0,bt.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,bt.jsx)("span",{className:"text-lg",children:"\ud83d\udcb0"}),(0,bt.jsx)("span",{className:"text-sm font-medium text-purple-600",children:"Costo Mensual"})]}),(0,bt.jsxs)("div",{className:"text-2xl font-bold text-gray-800",children:["$",(y.totalCost/1e3).toFixed(0),"K"]})]})]}),(0,bt.jsx)("div",{className:"bg-white rounded-xl p-4 border border-blue-200",children:(0,bt.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0",children:[(0,bt.jsxs)("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-4",children:[(0,bt.jsx)("input",{type:"text",placeholder:"Buscar recursos...",value:d,onChange:e=>u(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,bt.jsxs)("select",{value:h,onChange:e=>f(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,bt.jsx)("option",{value:"all",children:"Todos los roles"}),v.map(e=>(0,bt.jsx)("option",{value:e,children:e},e))]}),(0,bt.jsxs)("select",{value:m,onChange:e=>p(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,bt.jsx)("option",{value:"all",children:"Todos los estados"}),(0,bt.jsx)("option",{value:"active",children:"Activo"}),(0,bt.jsx)("option",{value:"inactive",children:"Inactivo"}),(0,bt.jsx)("option",{value:"on-leave",children:"En licencia"}),(0,bt.jsx)("option",{value:"terminated",children:"Terminado"})]})]}),(0,bt.jsx)("div",{className:"flex space-x-2",children:(0,bt.jsxs)("button",{onClick:()=>n(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[(0,bt.jsx)("span",{children:"\u2795"}),(0,bt.jsx)("span",{children:"Agregar Recurso"})]})})]})}),(0,bt.jsx)("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden border border-gray-200",children:(0,bt.jsx)("div",{className:"overflow-x-auto",children:(0,bt.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,bt.jsx)("thead",{className:"bg-gray-50",children:(0,bt.jsxs)("tr",{children:[(0,bt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Recurso"}),(0,bt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rol"}),(0,bt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Disponibilidad"}),(0,bt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Costo/Hora"}),(0,bt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estado"}),(0,bt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),(0,bt.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:0===b.length?(0,bt.jsx)("tr",{children:(0,bt.jsx)("td",{colSpan:"6",className:"px-6 py-12 text-center text-gray-500",children:(0,bt.jsxs)("div",{className:"flex flex-col items-center",children:[(0,bt.jsx)("span",{className:"text-4xl mb-2",children:"\ud83d\udc65"}),(0,bt.jsx)("p",{className:"text-lg font-medium",children:"No hay recursos registrados"}),(0,bt.jsx)("p",{className:"text-sm",children:"Agrega tu primer recurso para comenzar"})]})})}):b.map(e=>(0,bt.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,bt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,bt.jsxs)("div",{className:"flex items-center",children:[(0,bt.jsx)("div",{className:"flex-shrink-0 h-10 w-10",children:(0,bt.jsx)("div",{className:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center",children:(0,bt.jsx)("span",{className:"text-sm font-medium text-blue-700",children:e.name.split(" ").map(e=>e[0]).join("")})})}),(0,bt.jsxs)("div",{className:"ml-4",children:[(0,bt.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,bt.jsx)("div",{className:"text-sm text-gray-500",children:e.email||"Sin email"})]})]})}),(0,bt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,bt.jsx)("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:e.role})}),(0,bt.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[e.availability,"%"]}),(0,bt.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["$",e.hourlyRate,"/h"]}),(0,bt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,bt.jsxs)("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat(w(e.status)),children:[j(e.status)," ","active"===e.status?"Activo":"inactive"===e.status?"Inactivo":"on-leave"===e.status?"Licencia":"Terminado"]})}),(0,bt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,bt.jsxs)("div",{className:"flex space-x-2",children:[(0,bt.jsx)("button",{onClick:()=>(e=>{c(Object.assign({},e,{skills:Array.isArray(e.skills)?e.skills.join(", "):e.skills,certifications:Array.isArray(e.certifications)?e.certifications.join(", "):e.certifications})),o(!0)})(e),className:"text-blue-600 hover:text-blue-900",title:"Editar recurso",children:"\u270f\ufe0f"}),(0,bt.jsx)("button",{onClick:()=>{return t=e.id,void(window.confirm("\xbfEst\xe1s seguro de que quieres eliminar este recurso?")&&r(e=>e.filter(e=>e.id!==t)));var t},className:"text-red-600 hover:text-red-900",title:"Eliminar recurso",children:"\ud83d\uddd1\ufe0f"})]})})]},e.id))})]})})}),s&&(0,bt.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,bt.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:(0,bt.jsxs)("div",{className:"mt-3",children:[(0,bt.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Agregar Nuevo Recurso"}),(0,bt.jsxs)("div",{className:"space-y-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Nombre *"}),(0,bt.jsx)("input",{type:"text",value:g.name,onChange:e=>x({id:g.id,name:g.name,role:g.role,email:g.email,skills:g.skills,availability:g.availability,hourlyRate:g.hourlyRate,status:g.status,projectId:g.projectId,name:e.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Nombre completo"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Rol *"}),(0,bt.jsx)("input",{type:"text",value:g.role,onChange:e=>x({id:g.id,name:g.name,role:g.role,email:g.email,skills:g.skills,availability:g.availability,hourlyRate:g.hourlyRate,status:g.status,projectId:g.projectId,role:e.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Ej: Project Manager, Desarrollador, etc."})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),(0,bt.jsx)("input",{type:"email",value:g.email,onChange:e=>x({id:g.id,name:g.name,role:g.role,email:g.email,skills:g.skills,availability:g.availability,hourlyRate:g.hourlyRate,status:g.status,projectId:g.projectId,email:e.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"email@empresa.com"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Habilidades (separadas por comas)"}),(0,bt.jsx)("input",{type:"text",value:g.skills,onChange:e=>x({id:g.id,name:g.name,role:g.role,email:g.email,skills:g.skills,availability:g.availability,hourlyRate:g.hourlyRate,status:g.status,projectId:g.projectId,skills:e.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"React, JavaScript, PMBOK, etc."})]}),(0,bt.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Disponibilidad (%)"}),(0,bt.jsx)("input",{type:"number",min:"0",max:"100",value:g.availability,onChange:e=>x({id:g.id,name:g.name,role:g.role,email:g.email,skills:g.skills,availability:g.availability,hourlyRate:g.hourlyRate,status:g.status,projectId:g.projectId,availability:Number(e.target.value)}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Costo por Hora ($)"}),(0,bt.jsx)("input",{type:"number",min:"0",value:g.hourlyRate,onChange:e=>x({id:g.id,name:g.name,role:g.role,email:g.email,skills:g.skills,availability:g.availability,hourlyRate:g.hourlyRate,status:g.status,projectId:g.projectId,hourlyRate:Number(e.target.value)}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Estado"}),(0,bt.jsxs)("select",{value:g.status,onChange:e=>x({id:g.id,name:g.name,role:g.role,email:g.email,skills:g.skills,availability:g.availability,hourlyRate:g.hourlyRate,status:g.status,projectId:g.projectId,status:e.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,bt.jsx)("option",{value:"active",children:"Activo"}),(0,bt.jsx)("option",{value:"inactive",children:"Inactivo"}),(0,bt.jsx)("option",{value:"on-leave",children:"En licencia"}),(0,bt.jsx)("option",{value:"terminated",children:"Terminado"})]})]})]}),(0,bt.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,bt.jsx)("button",{onClick:()=>n(!1),className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 transition-colors",children:"Cancelar"}),(0,bt.jsx)("button",{onClick:()=>{if(!g.name||!g.role)return;const e={id:"res-"+String(Date.now()).slice(-6),name:g.name,role:g.role,skills:g.skills.split(",").map(e=>e.trim()).filter(e=>e),experience:g.experience,certifications:g.certifications?g.certifications.split(",").map(e=>e.trim()).filter(e=>e):[],notes:g.notes};console.log("\u2795 Agregando nuevo recurso:",e),console.log("\u2795 Recursos actuales antes de agregar:",t),r(t=>{const r=t.slice();return r.push(e),console.log("\u2795 Nuevos recursos despu\xe9s de agregar:",r),r}),n(!1),x({name:"",role:"",skills:"",availability:100,hourlyRate:0,status:"active",email:"",phone:"",department:"",experience:"",certifications:"",notes:""})},className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Agregar"})]})]})})}),i&&l&&(0,bt.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,bt.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:(0,bt.jsxs)("div",{className:"mt-3",children:[(0,bt.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Editar Recurso"}),(0,bt.jsxs)("div",{className:"space-y-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Nombre *"}),(0,bt.jsx)("input",{type:"text",value:l.name,onChange:e=>c({id:l.id,name:l.name,role:l.role,email:l.email,skills:l.skills,availability:l.availability,hourlyRate:l.hourlyRate,status:l.status,projectId:l.projectId,name:e.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Rol *"}),(0,bt.jsx)("input",{type:"text",value:l.role,onChange:e=>c({id:l.id,name:l.name,role:l.role,email:l.email,skills:l.skills,availability:l.availability,hourlyRate:l.hourlyRate,status:l.status,projectId:l.projectId,role:e.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),(0,bt.jsx)("input",{type:"email",value:l.email,onChange:e=>c({id:l.id,name:l.name,role:l.role,email:l.email,skills:l.skills,availability:l.availability,hourlyRate:l.hourlyRate,status:l.status,projectId:l.projectId,email:e.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Habilidades (separadas por comas)"}),(0,bt.jsx)("input",{type:"text",value:l.skills,onChange:e=>c({id:l.id,name:l.name,role:l.role,email:l.email,skills:l.skills,availability:l.availability,hourlyRate:l.hourlyRate,status:l.status,projectId:l.projectId,skills:e.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,bt.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Disponibilidad (%)"}),(0,bt.jsx)("input",{type:"number",min:"0",max:"100",value:l.availability,onChange:e=>c({id:l.id,name:l.name,role:l.role,email:l.email,skills:l.skills,availability:l.availability,hourlyRate:l.hourlyRate,status:l.status,projectId:l.projectId,availability:Number(e.target.value)}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Costo por Hora ($)"}),(0,bt.jsx)("input",{type:"number",min:"0",value:l.hourlyRate,onChange:e=>c({id:l.id,name:l.name,role:l.role,email:l.email,skills:l.skills,availability:l.availability,hourlyRate:l.hourlyRate,status:l.status,projectId:l.projectId,hourlyRate:Number(e.target.value)}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Estado"}),(0,bt.jsxs)("select",{value:l.status,onChange:e=>c({id:l.id,name:l.name,role:l.role,email:l.email,skills:l.skills,availability:l.availability,hourlyRate:l.hourlyRate,status:l.status,projectId:l.projectId,status:e.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,bt.jsx)("option",{value:"active",children:"Activo"}),(0,bt.jsx)("option",{value:"inactive",children:"Inactivo"}),(0,bt.jsx)("option",{value:"on-leave",children:"En licencia"}),(0,bt.jsx)("option",{value:"terminated",children:"Terminado"})]})]})]}),(0,bt.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,bt.jsx)("button",{onClick:()=>{o(!1),c(null)},className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 transition-colors",children:"Cancelar"}),(0,bt.jsx)("button",{onClick:()=>{l&&(r(e=>e.map(e=>e.id===l.id?Object.assign({},e,{name:l.name,role:l.role,skills:l.skills.split(",").map(e=>e.trim()).filter(e=>e),availability:l.availability,hourlyRate:l.hourlyRate,status:l.status,email:l.email||e.email,phone:l.phone||e.phone,department:l.department||e.department,experience:l.experience||e.experience,certifications:l.certifications?l.certifications.split(",").map(e=>e.trim()).filter(e=>e):e.certifications,notes:l.notes||e.notes}):e)),o(!1),c(null))},className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Guardar Cambios"})]})]})})})]})},Rw=e=>{let{error:t}=e;return t?(0,bt.jsxs)("div",{className:"text-red-600 text-xs mt-1 flex items-center",children:[(0,bt.jsx)("span",{className:"mr-1",children:"\u26a0\ufe0f"}),t]}):null},Mw=e=>{let{projects:t,setProjects:r,currentProjectId:s,setCurrentProjectId:n,portfolioMetrics:i,workPackages:o,risks:l,globalResources:c,setGlobalResources:d,createProject:u,updateProject:h,deleteProject:f,duplicateProject:m,tasks:p,purchaseOrders:g,advances:x,invoices:b,contracts:v,auditLogs:y}=e;const[w,j]=(0,a.useState)(!1),[N,k]=(0,a.useState)(null),[S,E]=(0,a.useState)("overview"),[T,_]=(0,a.useState)({}),[C,A]=(0,a.useState)("all"),[D,P]=(0,a.useState)([]),[I,O]=(0,a.useState)(null),[R,M]=(0,a.useState)(!1);a.useEffect(()=>{Object.keys(T).length>0&&console.log("\u274c Errores de validaci\xf3n:",T)},[T]);const F=t.find(e=>e.id===s),L=e=>{const t=[];console.log("\ud83d\udd0d VALIDANDO ARCHIVADO para proyecto:",e.name),console.log("\ud83d\udcca Progreso del proyecto:",e.progress),console.log("\ud83d\udccb Total de tareas disponibles:",p.length),e.progress<100&&t.push("El proyecto debe estar 100% completado (actual: ".concat(e.progress,"%)"));const r=p.filter(t=>t.workPackageId===e.id||t.projectId===e.id);console.log("\ud83d\udccb Tareas del proyecto:",r.length);const a=r.filter(e=>e.progress<100&&"completed"!==e.status);console.log("\u274c Tareas incompletas:",a.length),a.length>0&&t.push("Todas las tareas deben estar completadas (".concat(a.length," tareas pendientes)"));r.filter(e=>e.predecessors&&e.predecessors.length>0).filter(e=>e.predecessors.map(e=>r.find(t=>t.id===e)).filter(Boolean).some(e=>e.progress<100)).length>0&&t.push("No debe haber dependencias activas con tareas incompletas");const s=[],n=["Acta de Inicio","Cronograma","Presupuesto","Acta de Cierre"].filter(e=>!s.some(t=>t.name.includes(e)));n.length>0&&t.push("Documentaci\xf3n incompleta: ".concat(n.join(", ")));const i=g.filter(t=>t.projectId===e.id||t.workPackageId===e.id),o=b.filter(t=>t.projectId===e.id||t.workPackageId===e.id),l=v.filter(t=>t.projectId===e.id||t.workPackageId===e.id),c=[];return i.some(e=>"pending"===e.status)&&c.push("\xd3rdenes de compra pendientes"),o.some(e=>"pending"===e.status)&&c.push("Facturas pendientes"),l.some(e=>"pending"===e.status)&&c.push("Contratos pendientes"),c.length>0&&t.push("Aprobaciones pendientes: ".concat(c.join(", "))),console.log("\u2705 Validaciones encontradas:",t),console.log("\ud83c\udfaf Puede archivar:",0===t.length),{canArchive:0===t.length,validations:t}},z=()=>{O(null),M(!1)},B=e=>{switch(e){case"active":return"bg-green-100 text-green-800 border-green-200";case"inactive":return"bg-gray-100 text-gray-600 border-gray-300";case"completed":return"bg-blue-100 text-blue-800 border-blue-200";case"on-hold":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"cancelled":return"bg-red-100 text-red-800 border-red-200";case"archived":return"bg-purple-100 text-purple-800 border-purple-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},U=e=>{switch(e){case"active":return"\ud83d\udfe2";case"inactive":return"\u26ab";case"completed":return"\u2705";case"on-hold":default:return"\u23f8\ufe0f";case"cancelled":return"\u274c";case"archived":return"\ud83d\udcc1"}},W=(e,t)=>{const r=Object.assign({},T);switch(e){case"name":t&&""!==t.trim()?t.length<3?r.name="El nombre debe tener al menos 3 caracteres":delete r.name:r.name="El nombre del proyecto es obligatorio";break;case"manager":t&&""!==t.trim()?delete r.manager:r.manager="El manager es obligatorio";break;case"sponsor":t&&""!==t.trim()?delete r.sponsor:r.sponsor="El sponsor es obligatorio";break;case"startDate":t?delete r.startDate:r.startDate="La fecha de inicio es obligatoria";break;case"endDate":t?null!==N&&void 0!==N&&N.startDate&&new Date(t)<=new Date(N.startDate)?r.endDate="La fecha de fin debe ser posterior a la fecha de inicio":delete r.endDate:r.endDate="La fecha de fin es obligatoria";break;case"budget":""===t||isNaN(t)?r.budget="El presupuesto debe ser un n\xfamero v\xe1lido":!t||t<=0?r.budget="El presupuesto debe ser mayor a 0":t>1e9?r.budget="El presupuesto no puede exceder 1,000,000,000":delete r.budget;break;case"irr":""===t||isNaN(t)?r.irr="La TIR debe ser un n\xfamero v\xe1lido":t<0||t>100?r.irr="La TIR debe estar entre 0% y 100%":delete r.irr}return _(r),0===Object.keys(r).length};return(0,bt.jsxs)("div",{className:"space-y-6",children:[(0,bt.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-100 rounded-2xl shadow-lg p-6 text-gray-800 relative overflow-hidden",children:[(0,bt.jsx)("div",{className:"absolute top-0 right-0 w-32 h-32 bg-blue-100/30 rounded-full -translate-y-16 translate-x-16"}),(0,bt.jsx)("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-indigo-100/30 rounded-full translate-y-12 -translate-x-12"}),(0,bt.jsx)("div",{className:"relative z-10",children:(0,bt.jsxs)("div",{className:"flex items-center",children:[(0,bt.jsx)("div",{className:"bg-white/60 backdrop-blur rounded-2xl p-3 mr-4 shadow-sm",children:(0,bt.jsx)("span",{className:"text-3xl",children:"\ud83c\udfe2"})}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h1",{className:"text-4xl font-bold mb-2 text-gray-800",children:"Portafolio de Proyectos"}),(0,bt.jsx)("p",{className:"text-gray-600 text-lg",children:"Gesti\xf3n estrat\xe9gica y configuraci\xf3n de proyectos"})]})]})})]}),(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm",children:[(0,bt.jsx)("div",{className:"border-b border-gray-200",children:(0,bt.jsx)("nav",{className:"flex space-x-8 px-6",children:[{id:"overview",name:"Vista General",icon:"\ud83d\udcca"},{id:"projects",name:"Lista de Proyectos",icon:"\ud83d\udccb"},{id:"resources",name:"Lista de Recursos",icon:"\ud83d\udc65"},{id:"archive",name:"Archivado de Proyectos",icon:"\ud83d\udcc1"},{id:"metrics",name:"M\xe9tricas del Portfolio",icon:"\ud83d\udcc8"}].map(e=>(0,bt.jsxs)("button",{onClick:()=>E(e.id),className:"py-4 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 ".concat(S===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[(0,bt.jsx)("span",{children:e.icon}),(0,bt.jsx)("span",{children:e.name})]},e.id))})}),(0,bt.jsxs)("div",{className:"p-6",children:["overview"===S&&(0,bt.jsxs)("div",{className:"space-y-6",children:[(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,bt.jsxs)("div",{className:"bg-blue-50 p-6 rounded-lg border border-blue-200",children:[(0,bt.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[(0,bt.jsx)("span",{className:"text-2xl",children:"\ud83d\udcca"}),(0,bt.jsx)("h3",{className:"text-lg font-semibold text-blue-800",children:"Total Proyectos"})]}),(0,bt.jsx)("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:t.length}),(0,bt.jsxs)("div",{className:"text-sm text-blue-600",children:[t.filter(e=>"active"===e.status).length," activos"]})]}),(0,bt.jsxs)("div",{className:"bg-green-50 p-6 rounded-lg border border-green-200",children:[(0,bt.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[(0,bt.jsx)("span",{className:"text-2xl",children:"\ud83d\udcb0"}),(0,bt.jsx)("h3",{className:"text-lg font-semibold text-green-800",children:"Presupuesto Total"})]}),(0,bt.jsxs)("div",{className:"text-3xl font-bold text-green-600 mb-2",children:["$",(t.filter(e=>"active"===e.status).reduce((e,t)=>e+t.budget,0)/1e3).toFixed(0),"K USD"]}),(0,bt.jsx)("div",{className:"text-sm text-green-600",children:"Solo proyectos activos"})]}),(0,bt.jsxs)("div",{className:"bg-purple-50 p-6 rounded-lg border border-purple-200",children:[(0,bt.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[(0,bt.jsx)("span",{className:"text-2xl",children:"\ud83c\udfaf"}),(0,bt.jsx)("h3",{className:"text-lg font-semibold text-purple-800",children:"Proyectos Prioritarios"})]}),(0,bt.jsx)("div",{className:"text-3xl font-bold text-purple-600 mb-2",children:t.filter(e=>"high"===e.priority&&"active"===e.status).length}),(0,bt.jsx)("div",{className:"text-sm text-purple-600",children:"Prioridad alta (activos)"})]})]}),F&&(0,bt.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Proyecto Destacado"}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"Informaci\xf3n General"}),(0,bt.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("span",{className:"font-medium",children:"Nombre:"})," ",F.name]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("span",{className:"font-medium",children:"Manager:"})," ",F.manager]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("span",{className:"font-medium",children:"Sponsor:"})," ",F.sponsor]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("span",{className:"font-medium",children:"Estado:"}),(0,bt.jsxs)("span",{className:"ml-2 px-2 py-1 rounded-full text-xs ".concat(B(F.status)),children:[U(F.status)," ",F.status]})]})]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"M\xe9tricas Financieras"}),(0,bt.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("span",{className:"font-medium",children:"Presupuesto:"})," $",(F.budget/1e3).toFixed(0),"K USD"]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("span",{className:"font-medium",children:"Reserva Contingencia:"})," $",(F.contingencyReserve/1e3).toFixed(0),"K USD"]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("span",{className:"font-medium",children:"Reserva Gesti\xf3n:"})," $",(F.managementReserve/1e3).toFixed(0),"K USD"]}),F.irr>0&&(0,bt.jsxs)("div",{children:[(0,bt.jsx)("span",{className:"font-medium",children:"TIR:"})," ",F.irr.toFixed(2),"%"]})]})]})]})]})]}),"projects"===S&&(0,bt.jsx)(Iw,{projects:t,currentProjectId:s,setCurrentProjectId:n,portfolioMetrics:i,workPackages:o,risks:l,globalResources:c,setGlobalResources:d,createProject:u,updateProject:h,deleteProject:f,duplicateProject:e=>{console.log("\ud83d\udccb Duplicando proyecto con ID:",e);const r=t.find(t=>t.id===e);if(!r)return void console.error("\u274c Proyecto no encontrado para duplicar");const a={id:"proj-"+String(Date.now()).slice(-6),name:"".concat(r.name," (Copia)"),description:r.description,startDate:r.startDate,endDate:r.endDate,budget:r.budget,status:r.status,priority:r.priority,manager:r.manager,team:r.team,createdAt:r.createdAt,updatedAt:r.updatedAt,version:r.version,progress:r.progress};console.log("\ud83d\udccb Proyecto duplicado creado:",a),u(a)}}),"resources"===S&&(0,bt.jsx)(Ow,{globalResources:c,setGlobalResources:d}),"archive"===S&&(0,bt.jsxs)("div",{className:"space-y-6",children:[(0,bt.jsx)("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg p-6 border border-purple-200",children:(0,bt.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,bt.jsx)("span",{className:"text-3xl",children:"\ud83d\udcc1"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h3",{className:"text-xl font-semibold text-gray-800",children:"Archivado de Proyectos"}),(0,bt.jsx)("p",{className:"text-gray-600",children:"Gesti\xf3n centralizada del ciclo de vida completo de proyectos"})]})]})}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[(0,bt.jsxs)("div",{className:"p-6 border-b border-gray-200",children:[(0,bt.jsxs)("h4",{className:"text-lg font-semibold text-gray-800 flex items-center space-x-2",children:[(0,bt.jsx)("span",{children:"\ud83d\udccb"}),(0,bt.jsx)("span",{children:"Proyectos Activos"})]}),(0,bt.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Selecciona un proyecto para archivarlo"})]}),(0,bt.jsx)("div",{className:"p-6",children:0===t.filter(e=>"active"===e.status).length?(0,bt.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,bt.jsx)("span",{className:"text-4xl mb-2 block",children:"\ud83d\udced"}),(0,bt.jsx)("p",{children:"No hay proyectos activos para archivar"})]}):(0,bt.jsx)("div",{className:"space-y-3",children:t.filter(e=>"active"===e.status).map(e=>{const a=L(e),i=a.canArchive;return(0,bt.jsxs)("div",{className:"flex items-center justify-between p-4 rounded-lg border ".concat(i?"bg-gray-50 border-gray-200":"bg-red-50 border-red-200"),children:[(0,bt.jsxs)("div",{className:"flex-1",children:[(0,bt.jsx)("h5",{className:"font-medium text-gray-800",children:e.name}),(0,bt.jsx)("p",{className:"text-sm text-gray-600",children:e.description}),(0,bt.jsxs)("div",{className:"flex items-center space-x-4 mt-2",children:[(0,bt.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(B(e.status)),children:e.status}),(0,bt.jsxs)("span",{className:"text-xs text-gray-500",children:["Progreso: ",e.progress,"%"]}),(0,bt.jsxs)("span",{className:"text-xs text-gray-500",children:["Creado: ",new Date(e.createdAt).toLocaleDateString()]})]}),!i&&(0,bt.jsxs)("div",{className:"mt-2 p-2 bg-red-100 rounded border border-red-200",children:[(0,bt.jsx)("p",{className:"text-xs text-red-700 font-medium mb-1",children:"\u26a0\ufe0f Requisitos pendientes para archivado:"}),(0,bt.jsx)("ul",{className:"text-xs text-red-600 space-y-1",children:a.validations.map((e,t)=>(0,bt.jsxs)("li",{className:"flex items-start",children:[(0,bt.jsx)("span",{className:"mr-1",children:"\u2022"}),(0,bt.jsx)("span",{children:e})]},t))})]})]}),(0,bt.jsxs)("div",{className:"ml-4 flex flex-col space-y-2",children:[(0,bt.jsxs)("button",{onClick:()=>(e=>{const a=t.find(t=>t.id===e);if(!a)return;const i=L(a);if(!i.canArchive){const e=i.validations.join("\n\u2022 ");return void alert('\u274c No se puede archivar el proyecto "'.concat(a.name,'"\n\nRazones:\n\u2022 ').concat(e,"\n\nPor favor, complete todos los requisitos antes de archivar."))}const o='\xbfEst\xe1 seguro de que desea archivar el proyecto "'.concat(a.name,'"?\n\nEste proyecto ser\xe1 movido al archivo y ya no estar\xe1 disponible para edici\xf3n.');if(!window.confirm(o))return;const l={id:a.id,name:a.name,description:a.description,startDate:a.startDate,endDate:a.endDate,budget:a.budget,status:a.status,priority:a.priority,manager:a.manager,team:a.team,createdAt:a.createdAt,updatedAt:a.updatedAt,version:a.version,progress:a.progress,archivedAt:(new Date).toISOString(),archivedBy:"Usuario Actual"};P(e=>{const t=e.slice();return t.push(l),t});const c=t.map(t=>t.id===e?{id:t.id,name:t.name,description:t.description,startDate:t.startDate,endDate:t.endDate,budget:t.budget,status:"archived",priority:t.priority,manager:t.manager,team:t.team,createdAt:t.createdAt,updatedAt:t.updatedAt,version:t.version,progress:t.progress,archivedAt:(new Date).toISOString()}:t);if(r(c),s===e){const e=c.filter(e=>"active"===e.status);e.length>0&&n(e[0].id)}alert('\u2705 Proyecto "'.concat(a.name,'" archivado exitosamente.'))})(e.id),disabled:!i,className:"px-4 py-2 rounded-lg transition-colors flex items-center space-x-2 ".concat(i?"bg-purple-600 text-white hover:bg-purple-700":"bg-gray-300 text-gray-500 cursor-not-allowed"),title:i?"Archivar proyecto":"No cumple requisitos para archivado",children:[(0,bt.jsx)("span",{children:"\ud83d\udcc1"}),(0,bt.jsx)("span",{children:"Archivar"})]}),!i&&(0,bt.jsx)("span",{className:"text-xs text-red-600 text-center",children:"No disponible"})]})]},e.id)})})})]}),(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[(0,bt.jsxs)("div",{className:"p-6 border-b border-gray-200",children:[(0,bt.jsxs)("h4",{className:"text-lg font-semibold text-gray-800 flex items-center space-x-2",children:[(0,bt.jsx)("span",{children:"\ud83d\udce6"}),(0,bt.jsx)("span",{children:"Proyectos Archivados"})]}),(0,bt.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Historial de proyectos archivados"})]}),(0,bt.jsx)("div",{className:"p-6",children:0===D.length?(0,bt.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,bt.jsx)("span",{className:"text-4xl mb-2 block",children:"\ud83d\udced"}),(0,bt.jsx)("p",{children:"No hay proyectos archivados"})]}):(0,bt.jsx)("div",{className:"space-y-3",children:D.map(e=>(0,bt.jsx)("div",{className:"p-4 bg-gray-50 rounded-lg border border-gray-200",children:(0,bt.jsxs)("div",{className:"flex items-start justify-between",children:[(0,bt.jsxs)("div",{className:"flex-1",children:[(0,bt.jsx)("h5",{className:"font-medium text-gray-800",children:e.name}),(0,bt.jsx)("p",{className:"text-sm text-gray-600",children:e.description}),(0,bt.jsxs)("div",{className:"flex items-center space-x-4 mt-2",children:[(0,bt.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:"Archivado"}),(0,bt.jsxs)("span",{className:"text-xs text-gray-500",children:["Archivado: ",new Date(e.archivedAt).toLocaleDateString()]}),(0,bt.jsxs)("span",{className:"text-xs text-gray-500",children:["Por: ",e.archivedBy]})]})]}),(0,bt.jsx)("div",{className:"ml-4 flex space-x-2",children:(0,bt.jsxs)("button",{onClick:()=>(e=>{O(e),M(!0)})(e),className:"px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700 transition-colors flex items-center space-x-1",title:"Ver detalles del proyecto archivado",children:[(0,bt.jsx)("span",{children:"\ud83d\udc41\ufe0f"}),(0,bt.jsx)("span",{children:"Ver"})]})})]})},e.id))})})]})]})]}),"metrics"===S&&(0,bt.jsxs)("div",{className:"space-y-6",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"M\xe9tricas del Portfolio"}),(0,bt.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,bt.jsxs)("div",{className:"flex items-center",children:[(0,bt.jsx)("div",{className:"text-blue-600 text-xl mr-3",children:"\u2139\ufe0f"}),(0,bt.jsxs)("div",{className:"text-blue-800 text-sm",children:[(0,bt.jsx)("strong",{children:"Importante:"}),' Las m\xe9tricas financieras solo consideran proyectos con estado "Activo". Los proyectos "Inactivos" no suman al presupuesto total ni a las reservas del portfolio.']})]})}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,bt.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[(0,bt.jsx)("h4",{className:"font-semibold text-gray-800 mb-4",children:"Distribuci\xf3n por Estado"}),(0,bt.jsx)("div",{className:"space-y-3",children:["active","completed","on-hold","cancelled"].map(e=>{const r=t.filter(t=>t.status===e).length,a=t.length>0?r/t.length*100:0;return(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,bt.jsx)("span",{children:U(e)}),(0,bt.jsx)("span",{className:"capitalize",children:e})]}),(0,bt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,bt.jsx)("div",{className:"w-24 bg-gray-200 rounded-full h-2",children:(0,bt.jsx)("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:"".concat(a,"%")}})}),(0,bt.jsx)("span",{className:"text-sm text-gray-600 w-8 text-right",children:r})]})]},e)})})]}),(0,bt.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[(0,bt.jsx)("h4",{className:"font-semibold text-gray-800 mb-4",children:"Distribuci\xf3n por Prioridad"}),(0,bt.jsx)("div",{className:"space-y-3",children:["high","medium","low"].map(e=>{const r=t.filter(t=>t.priority===e).length,a=t.length>0?r/t.length*100:0;return(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsx)("div",{className:"flex items-center space-x-2",children:(0,bt.jsx)("span",{className:"capitalize",children:e})}),(0,bt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,bt.jsx)("div",{className:"w-24 bg-gray-200 rounded-full h-2",children:(0,bt.jsx)("div",{className:"bg-green-500 h-2 rounded-full",style:{width:"".concat(a,"%")}})}),(0,bt.jsx)("span",{className:"text-sm text-gray-600 w-8 text-right",children:r})]})]},e)})})]})]}),(0,bt.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[(0,bt.jsx)("h4",{className:"font-semibold text-gray-800 mb-4",children:"An\xe1lisis Financiero (Solo Proyectos Activos)"}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,bt.jsxs)("div",{className:"text-center",children:[(0,bt.jsxs)("div",{className:"text-2xl font-bold text-blue-600",children:["$",(t.filter(e=>"active"===e.status).reduce((e,t)=>e+t.budget,0)/1e3).toFixed(0),"K USD"]}),(0,bt.jsx)("div",{className:"text-sm text-gray-600",children:"Presupuesto Total"})]}),(0,bt.jsxs)("div",{className:"text-center",children:[(0,bt.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:["$",(t.filter(e=>"active"===e.status).reduce((e,t)=>e+t.contingencyReserve+t.managementReserve,0)/1e3).toFixed(0),"K USD"]}),(0,bt.jsx)("div",{className:"text-sm text-gray-600",children:"Reservas Totales"})]}),(0,bt.jsxs)("div",{className:"text-center",children:[(0,bt.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:t.filter(e=>"active"===e.status&&e.irr>0).length}),(0,bt.jsx)("div",{className:"text-sm text-gray-600",children:"Proyectos con TIR"})]})]}),(0,bt.jsx)("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:(0,bt.jsxs)("div",{className:"text-sm text-blue-800",children:[(0,bt.jsx)("strong",{children:"Nota:"}),' Las m\xe9tricas financieras solo consideran proyectos con estado "Activo". Los proyectos "Inactivos" o "Completados" no influyen en los indicadores financieros.']})})]})]})]})]}),console.log("\ud83c\udfad Renderizando modal - showNewProjectModal:",w),w&&(0,bt.jsxs)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[9999] flex items-center justify-center p-4",children:[console.log("\ud83c\udfad Modal renderizado - editingProject:",N),(0,bt.jsx)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:(0,bt.jsxs)("div",{className:"p-6",children:[(0,bt.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,bt.jsx)("h2",{className:"text-xl font-bold",children:null!==N&&void 0!==N&&N.id?"Editar Proyecto":"Nuevo Proyecto"}),(0,bt.jsx)("button",{onClick:()=>{j(!1),k(null)},className:"text-gray-500 hover:text-gray-700 text-2xl font-bold",children:"\xd7"})]}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre del Proyecto *"}),(0,bt.jsx)("input",{type:"text",className:"w-full border rounded px-3 py-2 ".concat(T.name?"border-red-500":"border-gray-300"),value:(null===N||void 0===N?void 0:N.name)||"",onChange:e=>{k({id:N.id,name:N.name,description:N.description,startDate:N.startDate,endDate:N.endDate,budget:N.budget,status:N.status,priority:N.priority,manager:N.manager,team:N.team,createdAt:N.createdAt,updatedAt:N.updatedAt,version:N.version,progress:N.progress,name:e.target.value}),W("name",e.target.value)},onBlur:e=>W("name",e.target.value),placeholder:"Nombre del proyecto"}),(0,bt.jsx)(Rw,{error:T.name})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Manager *"}),(0,bt.jsx)("input",{type:"text",className:"w-full border rounded px-3 py-2 ".concat(T.manager?"border-red-500":"border-gray-300"),value:(null===N||void 0===N?void 0:N.manager)||"",onChange:e=>{k({id:N.id,name:N.name,description:N.description,startDate:N.startDate,endDate:N.endDate,budget:N.budget,status:N.status,priority:N.priority,manager:N.manager,team:N.team,createdAt:N.createdAt,updatedAt:N.updatedAt,version:N.version,progress:N.progress,manager:e.target.value}),W("manager",e.target.value)},onBlur:e=>W("manager",e.target.value),placeholder:"Gerente del proyecto"}),(0,bt.jsx)(Rw,{error:T.manager})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sponsor *"}),(0,bt.jsx)("input",{type:"text",className:"w-full border rounded px-3 py-2 ".concat(T.sponsor?"border-red-500":"border-gray-300"),value:(null===N||void 0===N?void 0:N.sponsor)||"",onChange:e=>{k({id:N.id,name:N.name,description:N.description,startDate:N.startDate,endDate:N.endDate,budget:N.budget,status:N.status,priority:N.priority,manager:N.manager,team:N.team,createdAt:N.createdAt,updatedAt:N.updatedAt,version:N.version,progress:N.progress,sponsor:e.target.value}),W("sponsor",e.target.value)},onBlur:e=>W("sponsor",e.target.value),placeholder:"Patrocinador del proyecto"}),(0,bt.jsx)(Rw,{error:T.sponsor})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prioridad"}),(0,bt.jsxs)("select",{className:"w-full border rounded px-3 py-2",value:(null===N||void 0===N?void 0:N.priority)||"medium",onChange:e=>k({id:N.id,name:N.name,description:N.description,startDate:N.startDate,endDate:N.endDate,budget:N.budget,status:N.status,priority:N.priority,manager:N.manager,team:N.team,createdAt:N.createdAt,updatedAt:N.updatedAt,version:N.version,progress:N.progress,priority:e.target.value}),children:[(0,bt.jsx)("option",{value:"low",children:"Baja"}),(0,bt.jsx)("option",{value:"medium",children:"Media"}),(0,bt.jsx)("option",{value:"high",children:"Alta"})]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estado del Proyecto *"}),(0,bt.jsxs)("select",{className:"w-full border rounded px-3 py-2",value:(null===N||void 0===N?void 0:N.status)||"inactive",onChange:e=>k({id:N.id,name:N.name,description:N.description,startDate:N.startDate,endDate:N.endDate,budget:N.budget,status:N.status,priority:N.priority,manager:N.manager,team:N.team,createdAt:N.createdAt,updatedAt:N.updatedAt,version:N.version,progress:N.progress,status:e.target.value}),children:[(0,bt.jsx)("option",{value:"inactive",children:"\u26ab Inactivo"}),(0,bt.jsx)("option",{value:"active",children:"\ud83d\udfe2 Activo"})]}),(0,bt.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[(0,bt.jsx)("strong",{children:"Por defecto:"}),' Los proyectos nuevos y duplicados aparecen como "Inactivos" para revisi\xf3n. Solo los proyectos "Activos" suman al dashboard consolidado y aparecen en Gesti\xf3n de Proyectos.']})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha de Inicio *"}),(0,bt.jsx)("input",{type:"date",className:"w-full border rounded px-3 py-2 ".concat(T.startDate?"border-red-500":"border-gray-300"),value:(null===N||void 0===N?void 0:N.startDate)||"",onChange:e=>{k({id:N.id,name:N.name,description:N.description,startDate:N.startDate,endDate:N.endDate,budget:N.budget,status:N.status,priority:N.priority,manager:N.manager,team:N.team,createdAt:N.createdAt,updatedAt:N.updatedAt,version:N.version,progress:N.progress,startDate:e.target.value}),W("startDate",e.target.value),null!==N&&void 0!==N&&N.endDate&&W("endDate",N.endDate)},onBlur:e=>W("startDate",e.target.value)}),(0,bt.jsx)(Rw,{error:T.startDate})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha de Fin *"}),(0,bt.jsx)("input",{type:"date",className:"w-full border rounded px-3 py-2 ".concat(T.endDate?"border-red-500":"border-gray-300"),value:(null===N||void 0===N?void 0:N.endDate)||"",onChange:e=>{k({id:N.id,name:N.name,description:N.description,startDate:N.startDate,endDate:N.endDate,budget:N.budget,status:N.status,priority:N.priority,manager:N.manager,team:N.team,createdAt:N.createdAt,updatedAt:N.updatedAt,version:N.version,progress:N.progress,endDate:e.target.value}),W("endDate",e.target.value)},onBlur:e=>W("endDate",e.target.value)}),(0,bt.jsx)(Rw,{error:T.endDate})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Presupuesto (USD) *"}),(0,bt.jsx)("input",{type:"number",className:"w-full border rounded px-3 py-2 ".concat(T.budget?"border-red-500":"border-gray-300"),value:(null===N||void 0===N?void 0:N.budget)||"",onChange:e=>{const t=e.target.value;if(""===t||/^\d+$/.test(t)){const e=""===t?"":Number(t);k({id:N.id,name:N.name,description:N.description,startDate:N.startDate,endDate:N.endDate,budget:N.budget,status:N.status,priority:N.priority,manager:N.manager,team:N.team,createdAt:N.createdAt,updatedAt:N.updatedAt,version:N.version,progress:N.progress,budget:e}),W("budget",e)}},onBlur:e=>{const t=""===e.target.value?"":Number(e.target.value);W("budget",t)},placeholder:"Presupuesto en USD (ej: 100000)",min:"0"}),(0,bt.jsx)(Rw,{error:T.budget})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"TIR (%)"}),(0,bt.jsx)("input",{type:"number",className:"w-full border rounded px-3 py-2 ".concat(T.irr?"border-red-500":"border-gray-300"),value:(null===N||void 0===N?void 0:N.irr)||"",onChange:e=>{const t=e.target.value;if(""===t||/^\d*\.?\d*$/.test(t)){const e=""===t?"":Number(t);k({id:N.id,name:N.name,description:N.description,startDate:N.startDate,endDate:N.endDate,budget:N.budget,status:N.status,priority:N.priority,manager:N.manager,team:N.team,createdAt:N.createdAt,updatedAt:N.updatedAt,version:N.version,progress:N.progress,irr:e}),W("irr",e)}},onBlur:e=>{const t=""===e.target.value?"":Number(e.target.value);W("irr",t)},placeholder:"Tasa Interna de Retorno (ej: 15.5)",min:"0",max:"100",step:"0.01"}),(0,bt.jsx)(Rw,{error:T.irr})]}),(0,bt.jsxs)("div",{className:"md:col-span-2",children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripci\xf3n"}),(0,bt.jsx)("textarea",{className:"w-full border rounded px-3 py-2",rows:"3",value:(null===N||void 0===N?void 0:N.description)||"",onChange:e=>k({id:N.id,name:N.name,description:N.description,startDate:N.startDate,endDate:N.endDate,budget:N.budget,status:N.status,priority:N.priority,manager:N.manager,team:N.team,createdAt:N.createdAt,updatedAt:N.updatedAt,version:N.version,progress:N.progress,description:e.target.value}),placeholder:"Descripci\xf3n detallada del proyecto"})]}),(0,bt.jsxs)("div",{className:"md:col-span-2",children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Objetivo del Proyecto"}),(0,bt.jsx)("textarea",{className:"w-full border rounded px-3 py-2",rows:"3",value:(null===N||void 0===N?void 0:N.objective)||"",onChange:e=>k({id:N.id,name:N.name,description:N.description,startDate:N.startDate,endDate:N.endDate,budget:N.budget,status:N.status,priority:N.priority,manager:N.manager,team:N.team,createdAt:N.createdAt,updatedAt:N.updatedAt,version:N.version,progress:N.progress,objective:e.target.value}),placeholder:"\xbfQu\xe9 se busca lograr con este proyecto?"})]}),(0,bt.jsxs)("div",{className:"md:col-span-2",children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Caso de Negocio"}),(0,bt.jsx)("textarea",{className:"w-full border rounded px-3 py-2",rows:"3",value:(null===N||void 0===N?void 0:N.businessCase)||"",onChange:e=>k({id:N.id,name:N.name,description:N.description,startDate:N.startDate,endDate:N.endDate,budget:N.budget,status:N.status,priority:N.priority,manager:N.manager,team:N.team,createdAt:N.createdAt,updatedAt:N.updatedAt,version:N.version,progress:N.progress,businessCase:e.target.value}),placeholder:"Justificaci\xf3n del proyecto desde el punto de vista del negocio"})]})]}),(0,bt.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,bt.jsx)("button",{onClick:()=>{j(!1),k(null)},className:"px-4 py-2 border border-gray-300 rounded text-gray-700 hover:bg-gray-50",children:"Cancelar"}),(0,bt.jsxs)("button",{onClick:()=>{console.log("\ud83d\udcbe Guardando proyecto:",N),console.log("\ud83d\udcbe ID del proyecto a guardar:",null===N||void 0===N?void 0:N.id),console.log("\ud83d\udcbe \xbfEs edici\xf3n?",!(null===N||void 0===N||!N.id));const e=W("name",N.name),t=W("manager",N.manager),r=W("sponsor",N.sponsor),a=W("startDate",N.startDate),s=W("endDate",N.endDate),n=W("budget",N.budget),i=W("irr",N.irr);console.log("\u2705 Validaciones:",{isNameValid:e,isManagerValid:t,isSponsorValid:r,isStartDateValid:a,isEndDateValid:s,isBudgetValid:n,isIRRValid:i}),e&&t&&r&&a&&s&&n&&i?(N.id&&""!==N.id?(console.log("\ud83d\udd04 Actualizando proyecto existente con ID:",N.id),console.log("\ud83d\udd04 Datos a actualizar:",N),h(N.id,N)):(console.log("\u2795 Creando nuevo proyecto (sin ID)"),console.log("\u2795 Datos del nuevo proyecto:",N),u(N)),j(!1),k(null),_({})):console.log("\u274c Errores de validaci\xf3n:",T)},disabled:Object.keys(T).length>0,className:"px-4 py-2 rounded transition-colors ".concat(Object.keys(T).length>0?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),children:["Guardar Proyecto ",Object.keys(T).length>0&&"(".concat(Object.keys(T).length," errores)")]})]})]})})]}),R&&I&&(0,bt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[(0,bt.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,bt.jsx)("span",{className:"text-3xl",children:"\ud83d\udcc1"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h3",{className:"text-xl font-semibold text-gray-800",children:I.name}),(0,bt.jsx)("p",{className:"text-sm text-gray-600",children:"Proyecto Archivado"})]})]}),(0,bt.jsx)("button",{onClick:z,className:"text-gray-400 hover:text-gray-600 text-2xl",children:"\xd7"})]})}),(0,bt.jsxs)("div",{className:"p-6 space-y-6",children:[(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,bt.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,bt.jsx)("h4",{className:"font-semibold text-gray-800 mb-3",children:"\ud83d\udcca Informaci\xf3n General"}),(0,bt.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,bt.jsxs)("div",{className:"flex justify-between",children:[(0,bt.jsx)("span",{className:"text-gray-600",children:"Estado:"}),(0,bt.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:"Archivado"})]}),(0,bt.jsxs)("div",{className:"flex justify-between",children:[(0,bt.jsx)("span",{className:"text-gray-600",children:"Progreso:"}),(0,bt.jsxs)("span",{className:"font-medium",children:[I.progress,"%"]})]}),(0,bt.jsxs)("div",{className:"flex justify-between",children:[(0,bt.jsx)("span",{className:"text-gray-600",children:"Archivado:"}),(0,bt.jsx)("span",{children:new Date(I.archivedAt).toLocaleDateString()})]}),(0,bt.jsxs)("div",{className:"flex justify-between",children:[(0,bt.jsx)("span",{className:"text-gray-600",children:"Archivado por:"}),(0,bt.jsx)("span",{children:I.archivedBy})]}),(0,bt.jsxs)("div",{className:"flex justify-between",children:[(0,bt.jsx)("span",{className:"text-gray-600",children:"Creado:"}),(0,bt.jsx)("span",{children:new Date(I.createdAt).toLocaleDateString()})]})]})]}),(0,bt.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,bt.jsx)("h4",{className:"font-semibold text-gray-800 mb-3",children:"\ud83d\udcdd Descripci\xf3n"}),(0,bt.jsx)("p",{className:"text-sm text-gray-600",children:I.description||"Sin descripci\xf3n disponible"})]})]}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,bt.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,bt.jsxs)("h4",{className:"font-semibold text-gray-800 mb-3 flex items-center space-x-2",children:[(0,bt.jsx)("span",{children:"\ud83d\udccb"}),(0,bt.jsx)("span",{children:"Tareas del Cronograma"})]}),(0,bt.jsx)("div",{className:"space-y-2",children:(()=>{const e=p.filter(e=>e.workPackageId===I.id||e.projectId===I.id);return 0===e.length?(0,bt.jsx)("p",{className:"text-sm text-gray-500 italic",children:"No hay tareas registradas para este proyecto"}):(0,bt.jsxs)("div",{className:"space-y-1",children:[(0,bt.jsxs)("p",{className:"text-sm text-gray-600",children:["Total: ",e.length," tareas"]}),(0,bt.jsxs)("p",{className:"text-sm text-gray-600",children:["Completadas: ",e.filter(e=>100===e.progress).length]}),(0,bt.jsxs)("p",{className:"text-sm text-gray-600",children:["Pendientes: ",e.filter(e=>e.progress<100).length]})]})})()})]}),(0,bt.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg",children:[(0,bt.jsxs)("h4",{className:"font-semibold text-gray-800 mb-3 flex items-center space-x-2",children:[(0,bt.jsx)("span",{children:"\ud83d\udcce"}),(0,bt.jsx)("span",{children:"Auditor\xeda Documental"})]}),(0,bt.jsx)("div",{className:"space-y-2",children:(()=>{const e=y.filter(e=>e.projectId===I.id||e.workPackageId===I.id);if(0===e.length)return(0,bt.jsx)("p",{className:"text-sm text-gray-500 italic",children:"No hay registros de auditor\xeda para este proyecto"});const t=e.reduce((e,t)=>{const r=t.documentType||"Otros";return e[r]||(e[r]=[]),e[r].push(t),e},{});return(0,bt.jsxs)("div",{className:"space-y-2",children:[(0,bt.jsxs)("p",{className:"text-sm text-gray-600 font-medium",children:["Total de documentos: ",e.length]}),(0,bt.jsx)("div",{className:"space-y-1",children:Object.entries(t).map(e=>{let[t,r]=e;return(0,bt.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,bt.jsxs)("span",{className:"text-gray-600",children:[t,":"]}),(0,bt.jsx)("span",{className:"font-medium",children:r.length})]},t)})})]})})()})]})]}),(0,bt.jsxs)("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[(0,bt.jsxs)("h4",{className:"font-semibold text-gray-800 mb-3 flex items-center space-x-2",children:[(0,bt.jsx)("span",{children:"\ud83d\udcc8"}),(0,bt.jsx)("span",{children:"M\xe9tricas Finales"})]}),(0,bt.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,bt.jsxs)("div",{className:"text-center",children:[(0,bt.jsxs)("div",{className:"text-2xl font-bold text-blue-600",children:[I.progress,"%"]}),(0,bt.jsx)("div",{className:"text-gray-600",children:"Progreso Final"})]}),(0,bt.jsxs)("div",{className:"text-center",children:[(0,bt.jsx)("div",{className:"text-2xl font-bold text-green-600",children:p.filter(e=>e.workPackageId===I.id||e.projectId===I.id).length}),(0,bt.jsx)("div",{className:"text-gray-600",children:"Tareas Totales"})]}),(0,bt.jsxs)("div",{className:"text-center",children:[(0,bt.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:new Date(I.archivedAt).toLocaleDateString()}),(0,bt.jsx)("div",{className:"text-gray-600",children:"Fecha de Archivado"})]}),(0,bt.jsxs)("div",{className:"text-center",children:[(0,bt.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:I.archivedBy}),(0,bt.jsx)("div",{className:"text-gray-600",children:"Responsable"})]})]})]}),(0,bt.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,bt.jsxs)("h4",{className:"font-semibold text-gray-800 mb-3 flex items-center space-x-2",children:[(0,bt.jsx)("span",{children:"\ud83d\udccb"}),(0,bt.jsx)("span",{children:"Registro de Auditor\xeda Documental"})]}),(0,bt.jsx)("div",{className:"space-y-3",children:(()=>{const e=y.filter(e=>e.projectId===I.id||e.workPackageId===I.id);if(0===e.length)return(0,bt.jsx)("p",{className:"text-sm text-gray-500 italic text-center py-4",children:"No hay registros de auditor\xeda documental para este proyecto"});const t=e.sort((e,t)=>new Date(t.timestamp)-new Date(e.timestamp));return(0,bt.jsx)("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:t.map((e,t)=>(0,bt.jsx)("div",{className:"bg-white p-3 rounded border border-gray-200",children:(0,bt.jsx)("div",{className:"flex items-start justify-between",children:(0,bt.jsxs)("div",{className:"flex-1",children:[(0,bt.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,bt.jsx)("span",{className:"text-sm font-medium text-gray-800",children:e.documentType||"Documento"}),(0,bt.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("create"===e.action?"bg-green-100 text-green-800":"update"===e.action?"bg-blue-100 text-blue-800":"delete"===e.action?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"),children:"create"===e.action?"Creado":"update"===e.action?"Modificado":"delete"===e.action?"Eliminado":"Acci\xf3n"})]}),(0,bt.jsx)("p",{className:"text-xs text-gray-600 mb-1",children:e.description||"Sin descripci\xf3n"}),(0,bt.jsxs)("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[(0,bt.jsxs)("span",{children:["Por: ",e.user||"Sistema"]}),(0,bt.jsx)("span",{children:"\u2022"}),(0,bt.jsx)("span",{children:new Date(e.timestamp).toLocaleString()})]})]})})},t))})})()})]}),(0,bt.jsx)("div",{className:"bg-gray-100 p-4 rounded-lg border-l-4 border-gray-400",children:(0,bt.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,bt.jsx)("span",{className:"text-yellow-600 text-xl",children:"\u26a0\ufe0f"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h5",{className:"font-medium text-gray-800",children:"Proyecto Archivado"}),(0,bt.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Este proyecto est\xe1 archivado y es de solo lectura. Los datos se mantienen para consulta hist\xf3rica y auditor\xeda, pero no se puede modificar."})]})]})})]}),(0,bt.jsx)("div",{className:"p-6 border-t border-gray-200 flex justify-end space-x-3",children:(0,bt.jsx)("button",{onClick:z,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"Cerrar"})})]})})]})},Fw=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const[s,i]=(0,a.useState)([]),[o,l]=(0,a.useState)(!1);(0,a.useEffect)(()=>{(async()=>{if(e){l(!0);try{if(t){const{default:t}=await Promise.resolve().then(r.bind(r,874));if(t.isAuthenticated()){const r=await t.loadAuditEvents(e);if(r.success)i(r.events),console.log("\u2705 Logs de auditor\xeda cargados desde Supabase para proyecto ".concat(e,": ").concat(r.events.length," eventos"));else{const t=localStorage.getItem("audit-log-".concat(e));i(t?JSON.parse(t):[])}}else{const t=localStorage.getItem("audit-log-".concat(e));i(t?JSON.parse(t):[])}}else{const t=localStorage.getItem("audit-log-".concat(e));i(t?JSON.parse(t):[])}}catch(a){console.error("Error loading audit log:",a);const t=localStorage.getItem("audit-log-".concat(e));t&&i(JSON.parse(t))}finally{l(!1)}}})()},[e,t]);const c=(0,a.useCallback)(async t=>{localStorage.setItem("audit-log-".concat(e),JSON.stringify(t)),console.log("\ud83d\udccb Logs de auditor\xeda guardados en localStorage para proyecto ".concat(e,": ").concat(t.length," eventos"))},[e]),d=(0,a.useCallback)(async a=>{if(t)try{const{default:t}=await Promise.resolve().then(r.bind(r,874));if(t.isAuthenticated()){const r=await t.saveAuditEvents(e,[a]);r.success?console.log("\u2705 Evento de auditor\xeda guardado en Supabase: ".concat(a.action)):console.warn("\u26a0\ufe0f Error guardando evento en Supabase:",r.error)}}catch(s){console.error("Error guardando evento en Supabase:",s)}},[e,t]),u=(0,a.useCallback)(async t=>{const r=(0,n.A)({id:crypto.randomUUID(),timestamp:(new Date).toISOString(),projectId:e},t);return i(e=>{const t=[r,...e];return c(t),t}),d(r),r},[e,c,d]),h=(0,a.useCallback)((e,t,r)=>{u({category:"project-status",action:"status-changed",description:'Estado del proyecto cambiado de "'.concat(e,'" a "').concat(t,'"'),details:{previousStatus:e,newStatus:t,projectName:r.name,manager:r.manager,budget:r.budget},severity:"high",user:r.manager||"Sistema"})},[u]),f=(0,a.useCallback)((e,t)=>{u({category:"work-package",action:"created",description:'Work Package "'.concat(e.name,'" creado'),details:{workPackageId:e.id,name:e.name,budget:e.budget,status:e.status},severity:"medium",user:t.manager||"Sistema"})},[u]),m=(0,a.useCallback)((e,t,r)=>{u({category:"work-package",action:"modified",description:'Work Package "'.concat(e.name,'" modificado'),details:{workPackageId:e.id,name:e.name,changes:Object.keys(t),previousValues:t},severity:"medium",user:r.manager||"Sistema"})},[u]),p=(0,a.useCallback)((e,t)=>{u({category:"risk",action:"created",description:'Riesgo "'.concat(e.name,'" identificado'),details:{riskId:e.id,name:e.name,probability:e.probability,impact:e.impact,priority:e.priority},severity:"high"===e.priority?"high":"medium",user:t.manager||"Sistema"})},[u]),g=(0,a.useCallback)((e,t,r)=>{const a={"purchase-order":{action:"created",description:'Orden de Compra "'.concat(t.description,'" creada'),details:{poId:t.id,description:t.description,amount:t.amount,supplier:t.supplier}},advance:{action:"created",description:'Anticipo "'.concat(t.description,'" creado'),details:{advanceId:t.id,description:t.description,amount:t.amount,recipient:t.recipient}},invoice:{action:"created",description:'Factura "'.concat(t.description,'" creada'),details:{invoiceId:t.id,description:t.description,amount:t.amount,supplier:t.supplier}},contract:{action:"created",description:'Contrato "'.concat(t.name,'" creado'),details:{contractId:t.id,name:t.name,value:t.value,contractor:t.contractor}}}[e];a&&u({category:"financial",action:a.action,description:a.description,details:a.details,severity:"high",user:r.manager||"Sistema"})},[u]),x=(0,a.useCallback)((e,t)=>{u({category:"resources",action:"assigned",description:"Recurso asignado al proyecto",details:{assignmentId:e.id,resourceId:e.resourceId,role:e.role,allocation:e.allocation},severity:"medium",user:t.manager||"Sistema"})},[u]),b=(0,a.useCallback)((e,t)=>{u({category:"minutes",action:"minute-task-created",description:'Tarea de minuta "'.concat(e.tarea,'" creada'),details:{taskId:e.id,tarea:e.tarea,responsable:e.responsable,fecha:e.fecha,hitoId:e.hitoId,estatus:e.estatus},severity:"medium",user:t.manager||"Sistema"})},[u]),v=(0,a.useCallback)((e,t,r)=>{u({category:"minutes",action:"minute-task-updated",description:'Tarea de minuta "'.concat(e.tarea,'" actualizada'),details:{taskId:e.id,tarea:e.tarea,changes:t,newStatus:e.estatus},severity:"medium",user:r.manager||"Sistema"})},[u]),y=(0,a.useCallback)(()=>{i([]),localStorage.removeItem("audit-log-".concat(e))},[e]),w=(0,a.useCallback)(()=>{const t={projectId:e,exportDate:(new Date).toISOString(),totalEvents:s.length,events:s},r=JSON.stringify(t,null,2),a=new Blob([r],{type:"application/json"}),n=URL.createObjectURL(a),i=document.createElement("a");i.href=n,i.download="audit-log-".concat(e,"-").concat((new Date).toISOString().split("T")[0],".json"),i.click(),URL.revokeObjectURL(n)},[s,e]);return{auditLog:s,isLoading:o,addAuditEvent:u,logProjectStatusChange:h,logWorkPackageCreated:f,logWorkPackageModified:m,logRiskCreated:p,logFinancialEvent:g,logResourceAssignment:x,logMinutaTaskCreated:b,logMinutaTaskUpdated:v,clearAuditLog:y,exportAuditLog:w}},Lw=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()))(e);return t.charAt(0).toUpperCase()+t.slice(1)},zw=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>Boolean(e)&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var Bw={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Uw=["color","size","strokeWidth","absoluteStrokeWidth","className","children","iconNode"],Ww=(0,a.forwardRef)((e,t)=>{let{color:r="currentColor",size:s=24,strokeWidth:o=2,absoluteStrokeWidth:l,className:c="",children:d,iconNode:u}=e,h=i(e,Uw);return(0,a.createElement)("svg",(0,n.A)((0,n.A)((0,n.A)({ref:t},Bw),{},{width:s,height:s,stroke:r,strokeWidth:l?24*Number(o)/Number(s):o,className:zw("lucide",c)},!d&&!(e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(h)&&{"aria-hidden":"true"}),h),[...u.map(e=>{let[t,r]=e;return(0,a.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),Hw=["className"],Vw=(e,t)=>{const r=(0,a.forwardRef)((r,s)=>{let{className:o}=r,l=i(r,Hw);return(0,a.createElement)(Ww,(0,n.A)({ref:s,iconNode:t,className:zw("lucide-".concat((c=Lw(e),c.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase())),"lucide-".concat(e),o)},l));var c});return r.displayName=Lw(e),r},Gw=Vw("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),qw=Vw("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),$w=Vw("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),Kw=Vw("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Yw=Vw("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),Jw=Vw("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),Xw=Vw("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),Qw=Vw("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Zw=Vw("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),ej=Vw("shuffle",[["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22",key:"1ailkh"}],["path",{d:"M2 6h1.972a4 4 0 0 1 3.6 2.2",key:"km57vx"}],["path",{d:"M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45",key:"os18l9"}]]),tj=Vw("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),rj=Vw("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),aj=Vw("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),sj=Vw("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),nj=Vw("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),ij=Vw("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),oj=e=>{var t;let{projects:s,currentProjectId:i,setCurrentProjectId:o,risks:l,setRisks:c,setProjects:d,useSupabase:u=!1}=e;console.log("RiskManagement - risks recibidos:",l),console.log("RiskManagement - tipo de risks:",typeof l),console.log("RiskManagement - es array:",Array.isArray(l));const[h,f]=(0,a.useState)(null),[m,p]=(0,a.useState)("matrix"),[g,x]=(0,a.useState)("all"),[b,v]=(0,a.useState)("all"),[y,w]=(0,a.useState)("all"),[j,N]=(0,a.useState)(!1),[k,S]=(0,a.useState)(null),[E,T]=(0,a.useState)(!1),[_,C]=(0,a.useState)(null),[A,D]=(0,a.useState)(""),[P,I]=(0,a.useState)(!1),{logRiskCreated:O}=((0,a.useRef)(null),Fw(i,u)),R=(e,t)=>{C(r=>(0,n.A)((0,n.A)({},r),{},{[e]:t}))},M={technical:{label:"T\xe9cnico",color:"blue",icon:Gw},financial:{label:"Financiero",color:"green",icon:qw},organizational:{label:"Organizacional",color:"purple",icon:$w},external:{label:"Externo",color:"orange",icon:Kw},schedule:{label:"Cronograma",color:"yellow",icon:Yw},resource:{label:"Recursos",color:"indigo",icon:$w},quality:{label:"Calidad",color:"pink",icon:Jw},scope:{label:"Alcance",color:"teal",icon:Xw}},F={avoid:{label:"Evitar",color:"red",description:"Eliminar la amenaza o proteger el proyecto"},mitigate:{label:"Mitigar",color:"yellow",description:"Reducir probabilidad o impacto"},transfer:{label:"Transferir",color:"blue",description:"Trasladar el riesgo a un tercero"},accept:{label:"Aceptar",color:"green",description:"Reconocer el riesgo sin acci\xf3n"},exploit:{label:"Explotar",color:"emerald",description:"Aprovechar la oportunidad"},enhance:{label:"Mejorar",color:"cyan",description:"Aumentar probabilidad o impacto positivo"},share:{label:"Compartir",color:"violet",description:"Compartir la oportunidad con terceros"}},L={initiation:"Iniciaci\xf3n",planning:"Planificaci\xf3n",execution:"Ejecuci\xf3n",monitoring:"Monitoreo y Control",closure:"Cierre"},z=(0,a.useMemo)(()=>{if(!l||!Array.isArray(l))return{totalRisks:0,activeRisks:0,highPriority:0,totalExposure:0,avgRiskScore:"0.00",mitigatedRisks:0,occurredRisks:0};const e=l.filter(e=>"active"===e.status),t=e.filter(e=>"high"===e.priority).length,r=e.reduce((e,t)=>e+t.costImpact*t.probability,0),a=e.reduce((e,t)=>e+t.riskScore,0)/e.length,s=l.filter(e=>"mitigated"===e.status).length,n=l.filter(e=>e.actualOccurred).length;return{totalRisks:l.length,activeRisks:e.length,highPriority:t,totalExposure:Math.round(r),avgRiskScore:a.toFixed(2),mitigatedRisks:s,occurredRisks:n}},[l]),B=null===s||void 0===s?void 0:s.find(e=>e.id===i),U=()=>{if(!l||!Array.isArray(l))return.05*(null===B||void 0===B?void 0:B.budget)||0;const e=l.filter(e=>"active"===e.status);if(0===e.length)return.05*(null===B||void 0===B?void 0:B.budget)||0;return.05*((null===B||void 0===B?void 0:B.budget)||0)+e.reduce((e,t)=>e+t.probability*t.costImpact*("high"===t.priority?1.5:"medium"===t.priority?1.2:1),0)},W=()=>{if(!B)return 0;const e=B.budget||0;if(!l||!Array.isArray(l))return.1*e;const t=l.filter(e=>"active"===e.status);let r=.1*e;t.length>10?r*=1.2:t.length>5&&(r*=1.1);return t.filter(e=>"high"===e.priority).length>3&&(r*=1.15),r},H=()=>{T(!1),C(null)},V=(0,a.useMemo)(()=>l&&Array.isArray(l)?l.filter(e=>{const t="all"===g||e.category===g,r="all"===b||e.status===b,a="all"===y||e.priority===y,s=e.name.toLowerCase().includes(A.toLowerCase())||e.description.toLowerCase().includes(A.toLowerCase())||e.code.toLowerCase().includes(A.toLowerCase());return t&&r&&a&&s}):[],[l,g,b,y,A]),G=e=>{if(!e||!B||!d)return;const t=Math.max(0,e.p80-e.baseBudget),r=Math.max(0,e.p95-e.p80);if(console.log("\ud83d\udd04 Actualizando reservas bas\xe1ndose en Monte Carlo:"),console.log("\ud83d\udcca P80 Contingency:",t),console.log("\ud83d\udcca P95 Management:",r),B&&d){const a=(0,n.A)((0,n.A)({},B),{},{contingencyReserve:t,managementReserve:r,monteCarloResults:{lastUpdate:(new Date).toISOString(),p80Contingency:t,p95Management:r,recommendedBudget:e.p95}});d(e=>e.map(e=>e.id===B.id?a:e)),alert("\u2705 Reservas actualizadas bas\xe1ndose en an\xe1lisis Monte Carlo:\n      \n\ud83d\udcca Reserva de Contingencia: $".concat((t/1e3).toFixed(1),"K (P80)\n\ud83d\udcca Reserva de Gesti\xf3n: $").concat((r/1e3).toFixed(1),"K (P95)\n\ud83d\udcca Presupuesto Total Recomendado: $").concat((e.p95/1e3).toFixed(1),"K\n\nLas reservas se han actualizado en el proyecto y se reflejar\xe1n en todos los m\xf3dulos.")),console.log("\u2705 Proyecto actualizado con nuevas reservas de Monte Carlo")}};return(0,bt.jsxs)("div",{className:"min-h-screen bg-gray-50 p-4",children:[(0,bt.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,bt.jsxs)("div",{className:"bg-gradient-to-r from-red-50 to-orange-100 rounded-2xl shadow-lg p-6 mb-6 text-gray-800 relative overflow-hidden",children:[(0,bt.jsx)("div",{className:"absolute top-0 right-0 w-32 h-32 bg-red-100/30 rounded-full -translate-y-16 translate-x-16"}),(0,bt.jsx)("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-orange-100/30 rounded-full translate-y-12 -translate-x-12"}),(0,bt.jsx)("div",{className:"relative z-10",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{className:"flex items-center",children:[(0,bt.jsx)("div",{className:"bg-white/60 backdrop-blur rounded-2xl p-3 mr-4 shadow-sm",children:(0,bt.jsx)("span",{className:"text-3xl",children:"\ud83d\udee1\ufe0f"})}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h1",{className:"text-4xl font-bold mb-2 text-gray-800",children:"Gesti\xf3n de Riesgos"}),(0,bt.jsx)("p",{className:"text-gray-600 text-lg",children:"Identificaci\xf3n, an\xe1lisis y respuesta a riesgos del proyecto seg\xfan PMBOK"})]})]}),(0,bt.jsx)("div",{className:"flex items-center space-x-4",children:(0,bt.jsxs)("select",{value:i||"",onChange:e=>o(e.target.value),className:"px-4 py-2 rounded-lg bg-white text-gray-800 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-red-500 shadow-sm",children:[(0,bt.jsx)("option",{value:"",children:"Seleccionar Proyecto"}),null===s||void 0===s?void 0:s.filter(e=>"active"===e.status).map(e=>(0,bt.jsx)("option",{value:e.id,children:e.name},e.id))]})})]})})]}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-6",children:[(0,bt.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-red-500",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:z.activeRisks}),(0,bt.jsx)("div",{className:"text-sm text-gray-600",children:"Riesgos Activos"})]}),(0,bt.jsx)(Qw,{className:"text-red-500",size:32})]})}),(0,bt.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-orange-500",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:z.highPriority}),(0,bt.jsx)("div",{className:"text-sm text-gray-600",children:"Alta Prioridad"})]}),(0,bt.jsx)(Gw,{className:"text-orange-500",size:32})]})}),(0,bt.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-yellow-500",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsxs)("div",{className:"text-2xl font-bold text-gray-800",children:["$",(z.totalExposure/1e3).toFixed(0),"K"]}),(0,bt.jsx)("div",{className:"text-sm text-gray-600",children:"Exposici\xf3n Total"})]}),(0,bt.jsx)(qw,{className:"text-yellow-500",size:32})]})}),(0,bt.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-green-500",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:z.mitigatedRisks}),(0,bt.jsx)("div",{className:"text-sm text-gray-600",children:"Mitigados"})]}),(0,bt.jsx)(Zw,{className:"text-green-500",size:32})]})}),(0,bt.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-purple-500",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsxs)("div",{className:"text-2xl font-bold text-gray-800",children:["$",((()=>{if(!B)return 0;const e=B.budget||0;if(!l||!Array.isArray(l))return 1.15*e;return e+U()+W()})()/1e3).toFixed(0),"K"]}),(0,bt.jsx)("div",{className:"text-sm text-gray-600",children:"Presupuesto Total"})]}),(0,bt.jsx)(qw,{className:"text-purple-500",size:32})]})})]}),(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Reservas de Costos"}),B?(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,bt.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,bt.jsx)("h4",{className:"font-medium text-gray-800 mb-2",children:"Presupuesto Base"}),(0,bt.jsxs)("div",{className:"text-2xl font-bold text-gray-900",children:["$",((B.budget||0)/1e3).toFixed(0),"K"]}),(0,bt.jsx)("p",{className:"text-sm text-gray-700 mt-1",children:"Presupuesto asignado al proyecto"})]}),(0,bt.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4",children:[(0,bt.jsx)("h4",{className:"font-medium text-blue-800 mb-2",children:"Reserva de Contingencia"}),(0,bt.jsxs)("div",{className:"text-2xl font-bold text-blue-900",children:["$",(U()/1e3).toFixed(0),"K"]}),(0,bt.jsx)("p",{className:"text-sm text-blue-700 mt-1",children:"Basada en an\xe1lisis cuantitativo de riesgos activos"})]}),(0,bt.jsxs)("div",{className:"bg-green-50 rounded-lg p-4",children:[(0,bt.jsx)("h4",{className:"font-medium text-green-800 mb-2",children:"Reserva de Gesti\xf3n"}),(0,bt.jsxs)("div",{className:"text-2xl font-bold text-green-900",children:["$",(W()/1e3).toFixed(0),"K"]}),(0,bt.jsx)("p",{className:"text-sm text-green-700 mt-1",children:"10% del presupuesto base del proyecto"})]})]}):(0,bt.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,bt.jsx)(Zw,{size:48,className:"mx-auto mb-4 text-gray-300"}),(0,bt.jsx)("p",{children:"Selecciona un proyecto para ver las reservas de costos"})]})]}),(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold",children:"An\xe1lisis Monte Carlo"}),(0,bt.jsxs)("button",{onClick:()=>{if(!B||!l||!Array.isArray(l))return;const e=1e4,t=B.budget||0,r=l.filter(e=>"active"===e.status);if(0===r.length)return void S({averageCost:t,p50:t,p80:t,p95:t,iterations:e,note:"No hay riesgos activos para simular"});let a=0,s=[];for(let o=0;o<e;o++){let e=t;r.forEach(t=>{if(Math.random()<t.probability){const r=.8+.4*Math.random();e+=t.costImpact*r}}),a+=e,s.push(e)}s.sort((e,t)=>e-t);const n=a/e,i={averageCost:n,p50:s[Math.floor(5e3)],p80:s[Math.floor(8e3)],p95:s[Math.floor(9500)],iterations:e,riskCount:r.length,baseBudget:t,riskImpact:n-t};S(i),G(i)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center space-x-2",children:[(0,bt.jsx)(ej,{size:16}),(0,bt.jsx)("span",{children:"Ejecutar Simulaci\xf3n"})]})]}),k?(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,bt.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4",children:[(0,bt.jsx)("h4",{className:"font-medium text-blue-800 mb-2",children:"Costo Promedio"}),(0,bt.jsxs)("div",{className:"text-2xl font-bold text-blue-900",children:["$",(k.averageCost/1e3).toFixed(0),"K"]})]}),(0,bt.jsxs)("div",{className:"bg-green-50 rounded-lg p-4",children:[(0,bt.jsx)("h4",{className:"font-medium text-green-800 mb-2",children:"P50 (Mediana)"}),(0,bt.jsxs)("div",{className:"text-2xl font-bold text-green-900",children:["$",(k.p50/1e3).toFixed(0),"K"]})]}),(0,bt.jsxs)("div",{className:"bg-yellow-50 rounded-lg p-4",children:[(0,bt.jsx)("h4",{className:"font-medium text-yellow-800 mb-2",children:"P80"}),(0,bt.jsxs)("div",{className:"text-2xl font-bold text-yellow-900",children:["$",(k.p80/1e3).toFixed(0),"K"]})]}),(0,bt.jsxs)("div",{className:"bg-red-50 rounded-lg p-4",children:[(0,bt.jsx)("h4",{className:"font-medium text-red-800 mb-2",children:"P95"}),(0,bt.jsxs)("div",{className:"text-2xl font-bold text-red-900",children:["$",(k.p95/1e3).toFixed(0),"K"]})]})]}):(0,bt.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,bt.jsx)(ej,{size:48,className:"mx-auto mb-4 text-gray-300"}),(0,bt.jsx)("p",{children:"Ejecuta la simulaci\xf3n Monte Carlo para ver los resultados"})]})]}),(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold",children:"Gesti\xf3n de Riesgos"}),(0,bt.jsxs)("button",{onClick:()=>{C({id:"R".concat(Date.now()),code:"",name:"",description:"",category:"technical",phase:"planning",probability:.5,impact:.5,riskScore:.25,status:"active",priority:"medium",owner:"",identifiedDate:(new Date).toISOString().split("T")[0],reviewDate:"",response:"mitigate",responsePlan:"",contingencyPlan:"",triggerConditions:"",costImpact:0,scheduleImpact:0,residualProbability:0,residualImpact:0,monitoringFrequency:"weekly",earlyWarnings:[],actualOccurred:!1,stakeholders:[],assumptions:[],constraints:[],projectId:i}),T(!0)},className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center space-x-2",children:[(0,bt.jsx)(tj,{size:16}),(0,bt.jsx)("span",{children:"Nuevo Riesgo"})]})]}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-4",children:[(0,bt.jsxs)("div",{className:"relative",children:[(0,bt.jsx)(rj,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),(0,bt.jsx)("input",{type:"text",placeholder:"Buscar riesgos...",value:A,onChange:e=>D(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,bt.jsxs)("select",{value:g,onChange:e=>x(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,bt.jsx)("option",{value:"all",children:"Todas las Categor\xedas"}),Object.entries(M).map(e=>{let[t,r]=e;return(0,bt.jsx)("option",{value:t,children:r.label},t)})]}),(0,bt.jsxs)("select",{value:b,onChange:e=>v(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,bt.jsx)("option",{value:"all",children:"Todos los Estados"}),(0,bt.jsx)("option",{value:"active",children:"Activo"}),(0,bt.jsx)("option",{value:"mitigated",children:"Mitigado"}),(0,bt.jsx)("option",{value:"closed",children:"Cerrado"})]}),(0,bt.jsxs)("select",{value:y,onChange:e=>w(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,bt.jsx)("option",{value:"all",children:"Todas las Prioridades"}),(0,bt.jsx)("option",{value:"high",children:"Alta"}),(0,bt.jsx)("option",{value:"medium",children:"Media"}),(0,bt.jsx)("option",{value:"low",children:"Baja"})]}),(0,bt.jsxs)("select",{value:m,onChange:e=>p(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,bt.jsx)("option",{value:"matrix",children:"Vista Matriz"}),(0,bt.jsx)("option",{value:"list",children:"Vista Lista"})]})]}),(0,bt.jsxs)("div",{className:"space-y-4",children:[V.map(e=>(0,bt.jsx)("div",{className:"border rounded-lg p-4 hover:bg-gray-50",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{className:"flex-1",children:[(0,bt.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,bt.jsx)("span",{className:"font-medium text-gray-900",children:e.code}),(0,bt.jsx)("span",{className:"font-medium text-gray-900",children:e.name}),(0,bt.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("high"===e.priority?"bg-red-100 text-red-700":"medium"===e.priority?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"),children:e.priority.toUpperCase()}),(0,bt.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("active"===e.status?"bg-red-100 text-red-700":"mitigated"===e.status?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"),children:e.status.toUpperCase()})]}),(0,bt.jsx)("div",{className:"text-sm text-gray-600 mb-2",children:e.description}),(0,bt.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4 text-xs text-gray-500",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("span",{className:"font-medium",children:"Probabilidad:"})," ",(100*e.probability).toFixed(0),"%"]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("span",{className:"font-medium",children:"Impacto:"})," ",(100*e.impact).toFixed(0),"%"]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("span",{className:"font-medium",children:"Costo:"})," $",(e.costImpact/1e3).toFixed(0),"K"]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("span",{className:"font-medium",children:"Cronograma:"})," ",e.scheduleImpact," d\xedas"]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("span",{className:"font-medium",children:"Responsable:"})," ",e.owner]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("span",{className:"font-medium",children:"Fase:"})," ",L[e.phase]]})]})]}),(0,bt.jsxs)("div",{className:"flex items-center space-x-2 ml-4",children:[(0,bt.jsxs)("div",{className:"text-right",children:[(0,bt.jsx)("div",{className:"text-lg font-bold text-gray-900",children:e.riskScore.toFixed(2)}),(0,bt.jsx)("div",{className:"text-xs text-gray-500",children:"Risk Score"})]}),(0,bt.jsxs)("div",{className:"flex flex-col space-y-1",children:[(0,bt.jsx)("button",{onClick:()=>(e=>{C(Object.assign({},e,{projectId:i})),T(!0)})(e),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg",title:"Editar",children:(0,bt.jsx)(aj,{size:16})}),(0,bt.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("\xbfEst\xe1s seguro de que quieres eliminar este riesgo?"))try{const{default:t}=await Promise.resolve().then(r.bind(r,874)),a=await t.deleteRisk(e);a.success?l&&Array.isArray(l)&&(c(l.filter(t=>t.id!==e)),console.log("\u2705 Riesgo eliminado localmente y de Supabase")):(console.error("\u274c Error eliminando riesgo de Supabase:",a.error),alert("Error eliminando el riesgo. Int\xe9ntalo de nuevo."))}catch(t){console.error("\u274c Error inesperado eliminando riesgo:",t),alert("Error inesperado eliminando el riesgo. Int\xe9ntalo de nuevo.")}})(e.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",title:"Eliminar",children:(0,bt.jsx)(sj,{size:16})})]})]})]})},e.id)),0===V.length&&(0,bt.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,bt.jsx)(Qw,{size:48,className:"mx-auto mb-4 text-gray-300"}),(0,bt.jsx)("p",{children:"No se encontraron riesgos con los filtros aplicados"})]})]})]})]}),E&&(0,bt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,bt.jsx)("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:(0,bt.jsxs)("div",{className:"p-6",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,bt.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:null!==_&&void 0!==_&&_.id&&l&&Array.isArray(l)&&l.find(e=>e.id===_.id)?"Editar Riesgo":"Nuevo Riesgo"}),(0,bt.jsx)("button",{onClick:H,className:"text-gray-400 hover:text-gray-600",children:(0,bt.jsx)(nj,{size:24})})]}),(0,bt.jsxs)("form",{onSubmit:e=>{e.preventDefault(),(()=>{if(_){const e=_.probability*_.impact,t=Object.assign({},_,{riskScore:e});if(l&&Array.isArray(l))if(l.find(e=>e.id===_.id))c(l.map(e=>e.id===_.id?t:e));else{const e=l.slice();e.push(t),c(e),O&&B&&O(t,B)}else c([t]);T(!1),C(null)}})()},children:[(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,bt.jsxs)("div",{className:"space-y-4",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-800 border-b pb-2",children:"Informaci\xf3n B\xe1sica"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"C\xf3digo del Riesgo"}),(0,bt.jsx)("input",{type:"text",value:(null===_||void 0===_?void 0:_.code)||"",onChange:e=>R("code",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Ej: TECH-001",required:!0})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre del Riesgo"}),(0,bt.jsx)("input",{type:"text",value:(null===_||void 0===_?void 0:_.name)||"",onChange:e=>R("name",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Descripci\xf3n breve del riesgo",required:!0})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripci\xf3n"}),(0,bt.jsx)("textarea",{value:(null===_||void 0===_?void 0:_.description)||"",onChange:e=>R("description",e.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Descripci\xf3n detallada del riesgo",required:!0})]}),(0,bt.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Categor\xeda"}),(0,bt.jsx)("select",{value:(null===_||void 0===_?void 0:_.category)||"technical",onChange:e=>R("category",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:Object.entries(M).map(e=>{let[t,r]=e;return(0,bt.jsx)("option",{value:t,children:r.label},t)})})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fase del Proyecto"}),(0,bt.jsx)("select",{value:(null===_||void 0===_?void 0:_.phase)||"planning",onChange:e=>R("phase",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:Object.entries(L).map(e=>{let[t,r]=e;return(0,bt.jsx)("option",{value:t,children:r},t)})})]})]})]}),(0,bt.jsxs)("div",{className:"space-y-4",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-800 border-b pb-2",children:"An\xe1lisis Cualitativo"}),(0,bt.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Probabilidad (0-1)"}),(0,bt.jsx)("input",{type:"number",step:"0.1",min:"0",max:"1",value:(null===_||void 0===_?void 0:_.probability)||.5,onChange:e=>R("probability",parseFloat(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Impacto (0-1)"}),(0,bt.jsx)("input",{type:"number",step:"0.1",min:"0",max:"1",value:(null===_||void 0===_?void 0:_.impact)||.5,onChange:e=>R("impact",parseFloat(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]})]}),(0,bt.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prioridad"}),(0,bt.jsxs)("select",{value:(null===_||void 0===_?void 0:_.priority)||"medium",onChange:e=>R("priority",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,bt.jsx)("option",{value:"high",children:"Alta"}),(0,bt.jsx)("option",{value:"medium",children:"Media"}),(0,bt.jsx)("option",{value:"low",children:"Baja"})]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estado"}),(0,bt.jsxs)("select",{value:(null===_||void 0===_?void 0:_.status)||"active",onChange:e=>R("status",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,bt.jsx)("option",{value:"active",children:"Activo"}),(0,bt.jsx)("option",{value:"mitigated",children:"Mitigado"}),(0,bt.jsx)("option",{value:"closed",children:"Cerrado"})]})]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Responsable"}),(0,bt.jsx)("input",{type:"text",value:(null===_||void 0===_?void 0:_.owner)||"",onChange:e=>R("owner",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Nombre del responsable",required:!0})]})]})]}),(0,bt.jsxs)("div",{className:"mt-6 space-y-4",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-800 border-b pb-2",children:"An\xe1lisis Cuantitativo"}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Impacto en Costos (USD)"}),(0,bt.jsx)("input",{type:"number",value:(null===_||void 0===_?void 0:_.costImpact)||0,onChange:e=>R("costImpact",parseInt(e.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Impacto en Cronograma (d\xedas)"}),(0,bt.jsx)("input",{type:"number",value:(null===_||void 0===_?void 0:_.scheduleImpact)||0,onChange:e=>R("scheduleImpact",parseInt(e.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Frecuencia de Monitoreo"}),(0,bt.jsx)("select",{value:(null===_||void 0===_?void 0:_.monitoringFrequency)||"weekly",onChange:e=>R("monitoringFrequency",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:Object.entries({daily:"Diario",weekly:"Semanal",biweekly:"Quincenal",monthly:"Mensual",quarterly:"Trimestral"}).map(e=>{let[t,r]=e;return(0,bt.jsx)("option",{value:t,children:r},t)})})]})]})]}),(0,bt.jsxs)("div",{className:"mt-6 space-y-4",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-800 border-b pb-2",children:"Plan de Respuesta"}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estrategia de Respuesta"}),(0,bt.jsx)("select",{value:(null===_||void 0===_?void 0:_.response)||"mitigate",onChange:e=>R("response",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:Object.entries(F).map(e=>{let[t,r]=e;return(0,bt.jsx)("option",{value:t,children:r.label},t)})}),(0,bt.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:null===(t=F[(null===_||void 0===_?void 0:_.response)||"mitigate"])||void 0===t?void 0:t.description})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha de Revisi\xf3n"}),(0,bt.jsx)("input",{type:"date",value:(null===_||void 0===_?void 0:_.reviewDate)||"",onChange:e=>R("reviewDate",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Plan de Respuesta"}),(0,bt.jsx)("textarea",{value:(null===_||void 0===_?void 0:_.responsePlan)||"",onChange:e=>R("responsePlan",e.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Describe las acciones espec\xedficas para responder al riesgo"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Plan de Contingencia"}),(0,bt.jsx)("textarea",{value:(null===_||void 0===_?void 0:_.contingencyPlan)||"",onChange:e=>R("contingencyPlan",e.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Describe las acciones a tomar si el riesgo se materializa"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Condiciones Trigger"}),(0,bt.jsx)("textarea",{value:(null===_||void 0===_?void 0:_.triggerConditions)||"",onChange:e=>R("triggerConditions",e.target.value),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Describe las condiciones que activan el plan de contingencia"})]})]}),(0,bt.jsxs)("div",{className:"flex justify-end space-x-3 mt-8 pt-6 border-t",children:[(0,bt.jsx)("button",{type:"button",onClick:H,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Cancelar"}),(0,bt.jsxs)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center space-x-2",children:[(0,bt.jsx)(ij,{size:16}),(0,bt.jsx)("span",{children:"Guardar Riesgo"})]})]})]})]})})}),(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"\ud83d\udcce Evidencia y Documentos de Riesgos"}),(0,bt.jsxs)("button",{onClick:()=>I(!P),className:"bg-gradient-to-r from-red-600 to-orange-600 text-white px-4 py-2 rounded-lg text-sm hover:from-red-700 hover:to-orange-700 transition-all duration-200 shadow-sm hover:shadow-md",children:[P?"Ocultar":"Mostrar"," Gestor"]})]}),P&&(0,bt.jsx)(Dw,{projectId:i,category:"risk-evidence",isContextual:!0,title:"\ud83d\udee1\ufe0f Documentos de Riesgos del Proyecto",onFileUploaded:()=>{}})]})]})},lj=e=>{let{isOpen:t,onClose:r,hitos:s,onSave:i}=e;const[o,l]=(0,a.useState)([{id:1,tarea:"",responsable:"",fecha:"",hitoId:""},{id:2,tarea:"",responsable:"",fecha:"",hitoId:""},{id:3,tarea:"",responsable:"",fecha:"",hitoId:""},{id:4,tarea:"",responsable:"",fecha:"",hitoId:""},{id:5,tarea:"",responsable:"",fecha:"",hitoId:""},{id:6,tarea:"",responsable:"",fecha:"",hitoId:""}]);(0,a.useEffect)(()=>{t&&l([{id:1,tarea:"",responsable:"",fecha:"",hitoId:""},{id:2,tarea:"",responsable:"",fecha:"",hitoId:""},{id:3,tarea:"",responsable:"",fecha:"",hitoId:""},{id:4,tarea:"",responsable:"",fecha:"",hitoId:""},{id:5,tarea:"",responsable:"",fecha:"",hitoId:""},{id:6,tarea:"",responsable:"",fecha:"",hitoId:""}])},[t]);const c=(e,t,r)=>{l(a=>a.map(a=>a.id===e?(0,n.A)((0,n.A)({},a),{},{[t]:r}):a))};return t?(0,bt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-6xl w-full mx-4 p-6 max-h-[90vh] overflow-y-auto",children:[(0,bt.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,bt.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"\ud83d\udccb Nueva Minuta"}),(0,bt.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 text-2xl font-bold",children:"\xd7"})]}),(0,bt.jsx)("div",{className:"mb-4",children:(0,bt.jsx)("p",{className:"text-gray-600 text-sm",children:"Complete las tareas derivadas de la reuni\xf3n. Los campos marcados son obligatorios."})}),(0,bt.jsx)("div",{className:"overflow-x-auto",children:(0,bt.jsxs)("table",{className:"w-full border-collapse border border-gray-300",children:[(0,bt.jsx)("thead",{children:(0,bt.jsxs)("tr",{className:"bg-blue-50",children:[(0,bt.jsx)("th",{className:"border border-gray-300 px-4 py-3 text-left font-semibold text-gray-700",children:"#"}),(0,bt.jsx)("th",{className:"border border-gray-300 px-4 py-3 text-left font-semibold text-gray-700",children:"Tarea *"}),(0,bt.jsx)("th",{className:"border border-gray-300 px-4 py-3 text-left font-semibold text-gray-700",children:"Responsable *"}),(0,bt.jsx)("th",{className:"border border-gray-300 px-4 py-3 text-left font-semibold text-gray-700",children:"Fecha *"}),(0,bt.jsx)("th",{className:"border border-gray-300 px-4 py-3 text-left font-semibold text-gray-700",children:"Hito relacionado *"})]})}),(0,bt.jsx)("tbody",{children:o.map(e=>(0,bt.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,bt.jsx)("td",{className:"border border-gray-300 px-4 py-3 text-center font-medium text-gray-600",children:e.id}),(0,bt.jsxs)("td",{className:"border border-gray-300 px-2 py-2",children:[(0,bt.jsx)("textarea",{value:e.tarea,onChange:t=>c(e.id,"tarea",t.target.value),placeholder:"Descripci\xf3n de la tarea...",maxLength:70,rows:2,className:"w-full p-2 border border-gray-200 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none text-sm"}),(0,bt.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:[e.tarea.length,"/70 caracteres"]})]}),(0,bt.jsx)("td",{className:"border border-gray-300 px-2 py-2",children:(0,bt.jsx)("input",{type:"text",value:e.responsable,onChange:t=>c(e.id,"responsable",t.target.value),placeholder:"Nombre del responsable",className:"w-full p-2 border border-gray-200 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"})}),(0,bt.jsx)("td",{className:"border border-gray-300 px-2 py-2",children:(0,bt.jsx)("input",{type:"date",value:e.fecha,onChange:t=>c(e.id,"fecha",t.target.value),className:"w-full p-2 border border-gray-200 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"})}),(0,bt.jsx)("td",{className:"border border-gray-300 px-2 py-2",children:(0,bt.jsxs)("select",{value:e.hitoId,onChange:t=>c(e.id,"hitoId",t.target.value),className:"w-full p-2 border border-gray-200 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",children:[(0,bt.jsx)("option",{value:"",children:"Seleccionar hito..."}),s.map(e=>(0,bt.jsxs)("option",{value:e.id,children:[e.wbsCode," - ",e.name]},e.id))]})})]},e.id))})]})}),(0,bt.jsxs)("div",{className:"flex justify-end space-x-4 mt-6",children:[(0,bt.jsx)("button",{onClick:r,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancelar"}),(0,bt.jsx)("button",{onClick:()=>{const e=o.filter(e=>""!==e.tarea.trim());if(0===e.length)return void alert("Debe agregar al menos una tarea para guardar la minuta.");if(e.filter(e=>!e.responsable.trim()||!e.fecha||!e.hitoId).length>0)return void alert("Todas las tareas deben tener: Responsable, Fecha y Hito relacionado.");const t=e.map(e=>(0,n.A)((0,n.A)({},e),{},{id:crypto.randomUUID(),fechaCreacion:(new Date).toISOString(),estatus:"Pendiente"}));i(t),r()},className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"\ud83d\udcbe Guardar Minuta"})]})]})}):null},cj=e=>{let{isOpen:t,onClose:r,minuta:s,hitos:i,onUpdate:o}=e;const[l,c]=(0,a.useState)({id:"",tarea:"",responsable:"",fecha:"",hitoId:"",estatus:"Pendiente"});(0,a.useEffect)(()=>{t&&s&&c({id:s.id,tarea:s.tarea||"",responsable:s.responsable||"",fecha:s.fecha||"",hitoId:s.hitoId||"",estatus:s.estatus||"Pendiente"})},[t,s]);const d=(e,t)=>{c(r=>(0,n.A)((0,n.A)({},r),{},{[e]:t}))};return t?(0,bt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 p-6",children:[(0,bt.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,bt.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"\u270f\ufe0f Editar Minuta"}),(0,bt.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 text-2xl font-bold",children:"\xd7"})]}),(0,bt.jsxs)("div",{className:"space-y-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tarea *"}),(0,bt.jsx)("textarea",{value:l.tarea,onChange:e=>d("tarea",e.target.value),placeholder:"Descripci\xf3n de la tarea...",maxLength:70,rows:3,className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"}),(0,bt.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:[l.tarea.length,"/70 caracteres"]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Responsable *"}),(0,bt.jsx)("input",{type:"text",value:l.responsable,onChange:e=>d("responsable",e.target.value),placeholder:"Nombre del responsable",className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fecha *"}),(0,bt.jsx)("input",{type:"date",value:l.fecha,onChange:e=>d("fecha",e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Hito relacionado *"}),(0,bt.jsxs)("select",{value:l.hitoId,onChange:e=>d("hitoId",e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,bt.jsx)("option",{value:"",children:"Seleccionar hito..."}),i.map(e=>(0,bt.jsxs)("option",{value:e.id,children:[e.wbsCode," - ",e.name]},e.id))]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Estatus"}),(0,bt.jsxs)("select",{value:l.estatus,onChange:e=>d("estatus",e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,bt.jsx)("option",{value:"Pendiente",children:"Pendiente"}),(0,bt.jsx)("option",{value:"En Proceso",children:"En Proceso"}),(0,bt.jsx)("option",{value:"Completado",children:"Completado"})]})]})]}),(0,bt.jsxs)("div",{className:"flex justify-end space-x-4 mt-6",children:[(0,bt.jsx)("button",{onClick:r,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancelar"}),(0,bt.jsx)("button",{onClick:()=>{l.tarea.trim()?l.responsable.trim()?l.fecha?l.hitoId?(o(l),r()):alert("El hito relacionado es requerido"):alert("La fecha es requerida"):alert("El responsable es requerido"):alert("La tarea es requerida")},className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"\ud83d\udcbe Guardar Cambios"})]})]})}):null},dj=e=>{var t,r,s;let{wizardData:n,onUpdate:i,availableTemplates:o}=e;const[l,c]=(0,a.useState)(null),[d,u]=(0,a.useState)(""),h=[{value:"development",label:"Desarrollo de Software",icon:"\ud83d\udcbb"},{value:"equipment_installation",label:"Compra e Instalaci\xf3n de Equipos",icon:"\ud83c\udfed"},{value:"construction",label:"Construcci\xf3n",icon:"\ud83c\udfd7\ufe0f"},{value:"campaign",label:"Campa\xf1a de Marketing",icon:"\ud83d\udce2"},{value:"research",label:"Proyecto de Investigaci\xf3n",icon:"\ud83d\udd2c"},{value:"custom",label:"Personalizado",icon:"\u2699\ufe0f"}],f=[{value:"agile",label:"Agile/Scrum",description:"Iterativo, adaptativo"},{value:"waterfall",label:"Waterfall",description:"Secuencial, planificado"},{value:"hybrid",label:"H\xedbrido",description:"Combinaci\xf3n de ambos"},{value:"kanban",label:"Kanban",description:"Flujo continuo"}],m=[{value:"software",label:"Software/Tecnolog\xeda"},{value:"equipment",label:"Maquinaria/Equipos"},{value:"construction",label:"Construcci\xf3n"},{value:"marketing",label:"Marketing/Publicidad"},{value:"research",label:"Investigaci\xf3n/Desarrollo"},{value:"manufacturing",label:"Manufactura"},{value:"services",label:"Servicios"},{value:"other",label:"Otro"}];(0,a.useEffect)(()=>{if(l){const e={projectType:l.project_type,industry:l.industry,methodology:l.methodology,templateId:l.id,templateName:l.name};Object.keys(e).some(t=>n[t]!==e[t])&&i(e)}},[l]),(0,a.useEffect)(()=>{if("custom"===n.projectType&&d){const e=d.toLowerCase().replace(/\s+/g,"_");n.customProjectType!==d&&i({projectType:e,customProjectType:d})}},[d,n.projectType]);return(0,bt.jsxs)("div",{className:"space-y-6",children:[(0,bt.jsxs)("div",{className:"text-center",children:[(0,bt.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"\ud83d\udccb An\xe1lisis del Proyecto"}),(0,bt.jsx)("p",{className:"text-gray-600",children:"Proporciona informaci\xf3n b\xe1sica sobre tu proyecto para generar el cronograma m\xe1s apropiado"})]}),(0,bt.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6",children:[(0,bt.jsxs)("h4",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[(0,bt.jsx)("span",{className:"text-xl mr-2",children:"\ud83d\udcdd"}),"Informaci\xf3n B\xe1sica"]}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre del Proyecto *"}),(0,bt.jsx)("input",{type:"text",value:n.projectName||"",onChange:e=>i({projectName:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Ej: Sistema de Gesti\xf3n de Inventarios"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Gerente del Proyecto"}),(0,bt.jsx)("input",{type:"text",value:n.projectManager||"",onChange:e=>i({projectManager:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Ej: Juan P\xe9rez"})]})]}),(0,bt.jsxs)("div",{className:"mt-4",children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Descripci\xf3n del Proyecto"}),(0,bt.jsx)("textarea",{value:n.projectDescription||"",onChange:e=>i({projectDescription:e.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Describe brevemente los objetivos y alcance del proyecto..."})]})]}),(0,bt.jsxs)("div",{className:"bg-blue-50 rounded-lg p-6",children:[(0,bt.jsxs)("h4",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[(0,bt.jsx)("span",{className:"text-xl mr-2",children:"\ud83c\udfaf"}),"Tipo de Proyecto *"]}),(0,bt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:h.map(e=>(0,bt.jsx)("button",{onClick:()=>(e=>{i({projectType:e});const t=o.find(t=>t.project_type===e);c(t||null)})(e.value),className:"p-4 rounded-lg border-2 transition-all text-left ".concat(n.projectType===e.value?"border-purple-500 bg-purple-50 text-purple-800":"border-gray-200 hover:border-purple-300 hover:bg-purple-25"),children:(0,bt.jsxs)("div",{className:"flex items-center",children:[(0,bt.jsx)("span",{className:"text-2xl mr-3",children:e.icon}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("div",{className:"font-semibold",children:e.label}),"equipment_installation"===e.value&&(0,bt.jsx)("div",{className:"text-sm text-gray-600 mt-1",children:"Incluye compra, instalaci\xf3n y puesta en marcha"})]})]})},e.value))}),"custom"===n.projectType&&(0,bt.jsxs)("div",{className:"mt-4",children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Especifica el tipo de proyecto"}),(0,bt.jsx)("input",{type:"text",value:d,onChange:e=>u(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Ej: Migraci\xf3n de Datos, Implementaci\xf3n de ERP"})]})]}),(0,bt.jsxs)("div",{className:"bg-green-50 rounded-lg p-6",children:[(0,bt.jsxs)("h4",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[(0,bt.jsx)("span",{className:"text-xl mr-2",children:"\ud83c\udfe2"}),"Industria"]}),(0,bt.jsxs)("select",{value:n.industry||"",onChange:e=>i({industry:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[(0,bt.jsx)("option",{value:"",children:"Selecciona una industria"}),m.map(e=>(0,bt.jsx)("option",{value:e.value,children:e.label},e.value))]})]}),(0,bt.jsxs)("div",{className:"bg-yellow-50 rounded-lg p-6",children:[(0,bt.jsxs)("h4",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[(0,bt.jsx)("span",{className:"text-xl mr-2",children:"\ud83d\udcca"}),"Metodolog\xeda Preferida"]}),(0,bt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:f.map(e=>(0,bt.jsxs)("button",{onClick:()=>i({methodology:e.value}),className:"p-4 rounded-lg border-2 transition-all text-left ".concat(n.methodology===e.value?"border-purple-500 bg-purple-50 text-purple-800":"border-gray-200 hover:border-purple-300 hover:bg-purple-25"),children:[(0,bt.jsx)("div",{className:"font-semibold",children:e.label}),(0,bt.jsx)("div",{className:"text-sm text-gray-600 mt-1",children:e.description})]},e.value))})]}),o.length>0&&(0,bt.jsxs)("div",{className:"bg-purple-50 rounded-lg p-6",children:[(0,bt.jsxs)("h4",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[(0,bt.jsx)("span",{className:"text-xl mr-2",children:"\ud83d\udccb"}),"Templates Disponibles"]}),(0,bt.jsx)("div",{className:"space-y-3",children:o.filter(e=>!n.projectType||e.project_type===n.projectType||e.industry===n.industry).map(e=>(0,bt.jsx)("button",{onClick:()=>(e=>{c(e)})(e),className:"w-full p-4 rounded-lg border-2 transition-all text-left ".concat((null===l||void 0===l?void 0:l.id)===e.id?"border-purple-500 bg-purple-100 text-purple-800":"border-gray-200 hover:border-purple-300 hover:bg-purple-25"),children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("div",{className:"font-semibold",children:e.name}),(0,bt.jsx)("div",{className:"text-sm text-gray-600 mt-1",children:e.description}),(0,bt.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:[e.methodology," \u2022 ",e.estimated_duration_days," d\xedas \u2022 Equipo: ",e.team_size_min,"-",e.team_size_max," personas"]})]}),(null===l||void 0===l?void 0:l.id)===e.id&&(0,bt.jsx)("span",{className:"text-purple-600 text-xl",children:"\u2713"})]})},e.id))})]}),(0,bt.jsxs)("div",{className:"bg-orange-50 rounded-lg p-6",children:[(0,bt.jsxs)("h4",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[(0,bt.jsx)("span",{className:"text-xl mr-2",children:"\ud83d\udcc5"}),"Fechas del Proyecto"]}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fecha de Inicio"}),(0,bt.jsx)("input",{type:"date",value:n.startDate||"",onChange:e=>i({startDate:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fecha L\xedmite (Opcional)"}),(0,bt.jsx)("input",{type:"date",value:n.endDate||"",onChange:e=>i({endDate:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]})]}),(n.projectName||n.projectType)&&(0,bt.jsxs)("div",{className:"bg-gray-100 rounded-lg p-4",children:[(0,bt.jsx)("h5",{className:"font-semibold text-gray-800 mb-2",children:"Resumen de Selecci\xf3n:"}),(0,bt.jsxs)("div",{className:"text-sm text-gray-600 space-y-1",children:[n.projectName&&(0,bt.jsxs)("div",{children:["\u2022 Proyecto: ",n.projectName]}),n.projectType&&(0,bt.jsxs)("div",{children:["\u2022 Tipo: ",null===(t=h.find(e=>e.value===n.projectType))||void 0===t?void 0:t.label]}),n.industry&&(0,bt.jsxs)("div",{children:["\u2022 Industria: ",null===(r=m.find(e=>e.value===n.industry))||void 0===r?void 0:r.label]}),n.methodology&&(0,bt.jsxs)("div",{children:["\u2022 Metodolog\xeda: ",null===(s=f.find(e=>e.value===n.methodology))||void 0===s?void 0:s.label]}),l&&(0,bt.jsxs)("div",{children:["\u2022 Template: ",l.name]})]})]})]})},uj=e=>{var t,r;let{wizardData:s,onUpdate:i}=e;const[o,l]=(0,a.useState)([]),[c,d]=(0,a.useState)({name:"",role:"",experience:"intermediate"}),u=[{value:"junior",label:"Junior (0-2 a\xf1os)",description:"Reci\xe9n iniciado, necesita supervisi\xf3n"},{value:"intermediate",label:"Intermedio (2-5 a\xf1os)",description:"Experiencia moderada, trabajo independiente"},{value:"senior",label:"Senior (5-10 a\xf1os)",description:"Experiencia s\xf3lida, puede liderar"},{value:"expert",label:"Experto (10+ a\xf1os)",description:"Experiencia avanzada, mentor\xeda"}],h=[{value:"project_manager",label:"Project Manager",icon:"\ud83d\udc68\u200d\ud83d\udcbc"},{value:"team_lead",label:"Team Lead",icon:"\ud83d\udc68\u200d\ud83d\udcbb"},{value:"developer",label:"Desarrollador",icon:"\ud83d\udcbb"},{value:"designer",label:"Dise\xf1ador",icon:"\ud83c\udfa8"},{value:"qa_tester",label:"QA/Tester",icon:"\ud83d\udd0d"},{value:"devops",label:"DevOps",icon:"\u2699\ufe0f"},{value:"analyst",label:"Analista",icon:"\ud83d\udcca"},{value:"engineer",label:"Ingeniero",icon:"\ud83d\udd27"},{value:"technician",label:"T\xe9cnico",icon:"\ud83d\udee0\ufe0f"},{value:"specialist",label:"Especialista",icon:"\ud83c\udfaf"},{value:"other",label:"Otro",icon:"\ud83d\udc64"}],f=[{value:"low",label:"Bajo",description:"Prefiero estimaciones conservadoras con m\xe1s tiempo"},{value:"medium",label:"Medio",description:"Equilibrio entre tiempo y riesgo"},{value:"high",label:"Alto",description:"Estimaciones agresivas, menos tiempo"}];(0,a.useEffect)(()=>{if(o.length>0){const e={junior:1,intermediate:2,senior:3,expert:4},t=o.reduce((t,r)=>t+(e[r.experience]||2),0)/o.length;let r="intermediate";t<=1.5?r="junior":t>=3.5?r="expert":t>=2.5&&(r="senior"),i({teamSize:o.length,teamExperience:r,teamMembers:o})}else i({teamSize:s.teamSize||1,teamExperience:s.teamExperience||"intermediate",teamMembers:[]})},[o,i]);const m=e=>{const t=h.find(t=>t.value===e);return t?t.icon:"\ud83d\udc64"},p=e=>{const t=h.find(t=>t.value===e);return t?t.label:e};return(0,bt.jsxs)("div",{className:"space-y-6",children:[(0,bt.jsxs)("div",{className:"text-center",children:[(0,bt.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"\ud83d\udc65 Configuraci\xf3n de Recursos"}),(0,bt.jsx)("p",{className:"text-gray-600",children:"Define el equipo y recursos disponibles para optimizar el cronograma"})]}),(0,bt.jsxs)("div",{className:"bg-blue-50 rounded-lg p-6",children:[(0,bt.jsxs)("h4",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[(0,bt.jsx)("span",{className:"text-xl mr-2",children:"\ud83d\udc65"}),"Tama\xf1o del Equipo"]}),(0,bt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[1,2,3,4,5,6,7,8,9,10].map(e=>(0,bt.jsxs)("button",{onClick:()=>i({teamSize:e}),className:"p-4 rounded-lg border-2 transition-all text-center ".concat(s.teamSize===e?"border-blue-500 bg-blue-100 text-blue-800":"border-gray-200 hover:border-blue-300 hover:bg-blue-25"),children:[(0,bt.jsx)("div",{className:"text-2xl font-bold",children:e}),(0,bt.jsx)("div",{className:"text-sm text-gray-600",children:1===e?"persona":"personas"})]},e))})]}),(0,bt.jsxs)("div",{className:"bg-green-50 rounded-lg p-6",children:[(0,bt.jsxs)("h4",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[(0,bt.jsx)("span",{className:"text-xl mr-2",children:"\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d\udc66"}),"Composici\xf3n del Equipo"]}),(0,bt.jsxs)("div",{className:"bg-white rounded-lg p-4 mb-4 border border-gray-200",children:[(0,bt.jsx)("h5",{className:"font-semibold text-gray-700 mb-3",children:"Agregar Miembro del Equipo"}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre"}),(0,bt.jsx)("input",{type:"text",value:c.name,onChange:e=>d(t=>(0,n.A)((0,n.A)({},t),{},{name:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Ej: Mar\xeda Garc\xeda"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rol"}),(0,bt.jsxs)("select",{value:c.role,onChange:e=>d(t=>(0,n.A)((0,n.A)({},t),{},{role:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[(0,bt.jsx)("option",{value:"",children:"Seleccionar rol"}),h.map(e=>(0,bt.jsxs)("option",{value:e.value,children:[e.icon," ",e.label]},e.value))]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Experiencia"}),(0,bt.jsx)("select",{value:c.experience,onChange:e=>d(t=>(0,n.A)((0,n.A)({},t),{},{experience:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:u.map(e=>(0,bt.jsx)("option",{value:e.value,children:e.label},e.value))})]})]}),(0,bt.jsx)("button",{onClick:()=>{if(c.name.trim()&&c.role){const e={id:Date.now(),name:c.name.trim(),role:c.role,experience:c.experience};l(t=>[...t,e]),d({name:"",role:"",experience:"intermediate"})}},disabled:!c.name.trim()||!c.role,className:"mt-3 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:"+ Agregar Miembro"})]}),o.length>0&&(0,bt.jsxs)("div",{className:"space-y-2",children:[(0,bt.jsxs)("h5",{className:"font-semibold text-gray-700",children:["Miembros del Equipo (",o.length,")"]}),o.map(e=>{var t;return(0,bt.jsxs)("div",{className:"bg-white rounded-lg p-3 border border-gray-200 flex items-center justify-between",children:[(0,bt.jsxs)("div",{className:"flex items-center",children:[(0,bt.jsx)("span",{className:"text-xl mr-3",children:m(e.role)}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("div",{className:"font-semibold",children:e.name}),(0,bt.jsxs)("div",{className:"text-sm text-gray-600",children:[p(e.role)," \u2022 ",null===(t=u.find(t=>t.value===e.experience))||void 0===t?void 0:t.label]})]})]}),(0,bt.jsx)("button",{onClick:()=>{return t=e.id,void l(e=>e.filter(e=>e.id!==t));var t},className:"text-red-500 hover:text-red-700 transition-colors",children:"\ud83d\uddd1\ufe0f"})]},e.id)})]})]}),(0,bt.jsxs)("div",{className:"bg-yellow-50 rounded-lg p-6",children:[(0,bt.jsxs)("h4",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[(0,bt.jsx)("span",{className:"text-xl mr-2",children:"\ud83c\udf93"}),"Nivel de Experiencia del Equipo"]}),(0,bt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:u.map(e=>(0,bt.jsxs)("button",{onClick:()=>i({teamExperience:e.value}),className:"p-4 rounded-lg border-2 transition-all text-left ".concat(s.teamExperience===e.value?"border-yellow-500 bg-yellow-100 text-yellow-800":"border-gray-200 hover:border-yellow-300 hover:bg-yellow-25"),children:[(0,bt.jsx)("div",{className:"font-semibold",children:e.label}),(0,bt.jsx)("div",{className:"text-sm text-gray-600 mt-1",children:e.description})]},e.value))})]}),(0,bt.jsxs)("div",{className:"bg-purple-50 rounded-lg p-6",children:[(0,bt.jsxs)("h4",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[(0,bt.jsx)("span",{className:"text-xl mr-2",children:"\u23f0"}),"Disponibilidad del Equipo"]}),(0,bt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[{value:25,label:"25%",description:"Tiempo parcial"},{value:50,label:"50%",description:"Medio tiempo"},{value:75,label:"75%",description:"Tiempo completo"},{value:100,label:"100%",description:"Dedicaci\xf3n total"}].map(e=>(0,bt.jsxs)("button",{onClick:()=>i({teamAvailability:e.value}),className:"p-4 rounded-lg border-2 transition-all text-center ".concat(s.teamAvailability===e.value?"border-purple-500 bg-purple-100 text-purple-800":"border-gray-200 hover:border-purple-300 hover:bg-purple-25"),children:[(0,bt.jsx)("div",{className:"text-2xl font-bold",children:e.label}),(0,bt.jsx)("div",{className:"text-sm text-gray-600",children:e.description})]},e.value))})]}),(0,bt.jsxs)("div",{className:"bg-red-50 rounded-lg p-6",children:[(0,bt.jsxs)("h4",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[(0,bt.jsx)("span",{className:"text-xl mr-2",children:"\u26a0\ufe0f"}),"Tolerancia al Riesgo"]}),(0,bt.jsx)("div",{className:"space-y-3",children:f.map(e=>(0,bt.jsxs)("button",{onClick:()=>i({riskTolerance:e.value}),className:"w-full p-4 rounded-lg border-2 transition-all text-left ".concat(s.riskTolerance===e.value?"border-red-500 bg-red-100 text-red-800":"border-gray-200 hover:border-red-300 hover:bg-red-25"),children:[(0,bt.jsx)("div",{className:"font-semibold",children:e.label}),(0,bt.jsx)("div",{className:"text-sm text-gray-600 mt-1",children:e.description})]},e.value))})]}),(0,bt.jsxs)("div",{className:"bg-indigo-50 rounded-lg p-6",children:[(0,bt.jsxs)("h4",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[(0,bt.jsx)("span",{className:"text-xl mr-2",children:"\ud83d\udcb0"}),"Presupuesto del Proyecto"]}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Presupuesto Total (USD)"}),(0,bt.jsx)("input",{type:"number",value:s.budget||"",onChange:e=>i({budget:parseFloat(e.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"Ej: 50000"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Presupuesto por Mes (USD)"}),(0,bt.jsx)("input",{type:"number",value:s.monthlyBudget||"",onChange:e=>i({monthlyBudget:parseFloat(e.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"Ej: 10000"})]})]})]}),(0,bt.jsxs)("div",{className:"bg-gray-100 rounded-lg p-4",children:[(0,bt.jsx)("h5",{className:"font-semibold text-gray-800 mb-2",children:"Resumen de Configuraci\xf3n:"}),(0,bt.jsxs)("div",{className:"text-sm text-gray-600 space-y-1",children:[(0,bt.jsxs)("div",{children:["\u2022 Equipo: ",s.teamSize||1," personas"]}),(0,bt.jsxs)("div",{children:["\u2022 Experiencia: ",null===(t=u.find(e=>e.value===s.teamExperience))||void 0===t?void 0:t.label]}),s.teamAvailability&&(0,bt.jsxs)("div",{children:["\u2022 Disponibilidad: ",s.teamAvailability,"%"]}),s.riskTolerance&&(0,bt.jsxs)("div",{children:["\u2022 Riesgo: ",null===(r=f.find(e=>e.value===s.riskTolerance))||void 0===r?void 0:r.label]}),s.budget&&(0,bt.jsxs)("div",{children:["\u2022 Presupuesto: $",s.budget.toLocaleString()]}),o.length>0&&(0,bt.jsxs)("div",{children:["\u2022 Miembros definidos: ",o.length]})]})]})]})},hj=e=>{let{wizardData:t,onUpdate:r}=e;const[s,i]=(0,a.useState)([]),[o,l]=(0,a.useState)(""),[c,d]=(0,a.useState)(!1);(0,a.useEffect)(()=>{const e=u(t.projectType);i(e)},[t.projectType]),(0,a.useEffect)(()=>{r({milestones:s})},[s,r]);const u=e=>{const t={construccion:[{id:"milestone-1",name:"HITO: Aprobaci\xf3n de planos",description:"Aprobaci\xf3n final de planos arquitect\xf3nicos y estructurales"},{id:"milestone-2",name:"HITO: Inicio de obra",description:"Inicio formal de la construcci\xf3n"},{id:"milestone-3",name:"HITO: Estructura terminada",description:"Completar estructura principal"},{id:"milestone-4",name:"HITO: Instalaciones completadas",description:"Instalaciones el\xe9ctricas, hidr\xe1ulicas y sanitarias"},{id:"milestone-5",name:"HITO: Obra terminada",description:"Construcci\xf3n completamente terminada"}],software:[{id:"milestone-1",name:"HITO: An\xe1lisis completado",description:"An\xe1lisis de requisitos y dise\xf1o de sistema"},{id:"milestone-2",name:"HITO: Prototipo funcional",description:"Primera versi\xf3n funcional del software"},{id:"milestone-3",name:"HITO: Desarrollo terminado",description:"Desarrollo completo de funcionalidades"},{id:"milestone-4",name:"HITO: Pruebas completadas",description:"Testing y correcci\xf3n de errores"},{id:"milestone-5",name:"HITO: Despliegue en producci\xf3n",description:"Lanzamiento oficial del software"}],manufactura:[{id:"milestone-1",name:"HITO: Dise\xf1o de producto",description:"Dise\xf1o final del producto a manufacturar"},{id:"milestone-2",name:"HITO: Prototipo validado",description:"Prototipo aprobado y validado"},{id:"milestone-3",name:"HITO: L\xednea de producci\xf3n",description:"Configuraci\xf3n de l\xednea de producci\xf3n"},{id:"milestone-4",name:"HITO: Producci\xf3n piloto",description:"Primera producci\xf3n de prueba"},{id:"milestone-5",name:"HITO: Producci\xf3n en masa",description:"Inicio de producci\xf3n comercial"}],general:[{id:"milestone-1",name:"HITO: Proyecto iniciado",description:"Kickoff formal del proyecto"},{id:"milestone-2",name:"HITO: Planificaci\xf3n completada",description:"Plan detallado del proyecto aprobado"},{id:"milestone-3",name:"HITO: Fase de ejecuci\xf3n",description:"Inicio de la fase principal de ejecuci\xf3n"},{id:"milestone-4",name:"HITO: Entregables completados",description:"Todos los entregables principales terminados"},{id:"milestone-5",name:"HITO: Proyecto cerrado",description:"Cierre formal del proyecto"}]};return t[e]||t.general},h=()=>{if(!o.trim())return;const e={id:"milestone-".concat(Date.now()),name:o.trim(),description:"",isCustom:!0};i(t=>[...t,e]),l(""),d(!1)},f=(e,t,r)=>{i(a=>a.map(a=>a.id===e?(0,n.A)((0,n.A)({},a),{},{[t]:r}):a))},m=(e,t)=>{i(r=>{const a=[...r],[s]=a.splice(e,1);return a.splice(t,0,s),a})};return(0,bt.jsxs)("div",{className:"max-w-4xl mx-auto p-6",children:[(0,bt.jsxs)("div",{className:"mb-8",children:[(0,bt.jsxs)("h2",{className:"text-3xl font-bold text-gray-800 mb-4 flex items-center",children:[(0,bt.jsx)("span",{className:"text-4xl mr-3",children:"\ud83c\udfaf"}),"Definir hitos del proyecto"]}),(0,bt.jsx)("p",{className:"text-gray-600 text-lg leading-relaxed",children:"Los hitos son puntos clave en tu proyecto que marcan el progreso y la entrega de resultados importantes. Hemos predefinido algunos hitos comunes para tu tipo de proyecto, pero puedes personalizarlos."})]}),(0,bt.jsx)("div",{className:"space-y-4 mb-6",children:s.map((e,t)=>(0,bt.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm",children:(0,bt.jsxs)("div",{className:"flex items-start justify-between",children:[(0,bt.jsxs)("div",{className:"flex-1",children:[(0,bt.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,bt.jsx)("span",{className:"text-2xl",children:"\ud83c\udfaf"}),(0,bt.jsx)("div",{className:"flex-1",children:(0,bt.jsx)("input",{type:"text",value:e.name,onChange:t=>f(e.id,"name",t.target.value),className:"w-full text-lg font-semibold text-gray-800 border-none bg-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 rounded px-2 py-1",placeholder:"Nombre del hito"})})]}),(0,bt.jsx)("textarea",{value:e.description,onChange:t=>f(e.id,"description",t.target.value),className:"w-full text-gray-600 border border-gray-200 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Descripci\xf3n del hito (opcional)",rows:2}),e.isCustom&&(0,bt.jsx)("div",{className:"mt-2",children:(0,bt.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"\u2728 Personalizado"})})]}),(0,bt.jsxs)("div",{className:"flex items-center space-x-2 ml-4",children:[t>0&&(0,bt.jsx)("button",{onClick:()=>m(t,t-1),className:"text-gray-400 hover:text-gray-600 transition-colors",title:"Mover hacia arriba",children:"\u2b06\ufe0f"}),t<s.length-1&&(0,bt.jsx)("button",{onClick:()=>m(t,t+1),className:"text-gray-400 hover:text-gray-600 transition-colors",title:"Mover hacia abajo",children:"\u2b07\ufe0f"}),(0,bt.jsx)("button",{onClick:()=>{return t=e.id,void i(e=>e.filter(e=>e.id!==t));var t},className:"text-red-400 hover:text-red-600 transition-colors",title:"Eliminar hito",children:"\ud83d\uddd1\ufe0f"})]})]})},e.id))}),c?(0,bt.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-blue-800 mb-3",children:"Agregar nuevo hito"}),(0,bt.jsxs)("div",{className:"space-y-3",children:[(0,bt.jsx)("input",{type:"text",value:o,onChange:e=>l(e.target.value),className:"w-full px-3 py-2 border border-blue-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Nombre del nuevo hito",onKeyPress:e=>"Enter"===e.key&&h(),autoFocus:!0}),(0,bt.jsxs)("div",{className:"flex space-x-3",children:[(0,bt.jsx)("button",{onClick:h,disabled:!o.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Agregar hito"}),(0,bt.jsx)("button",{onClick:()=>{d(!1),l("")},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancelar"})]})]})]}):(0,bt.jsxs)("button",{onClick:()=>d(!0),className:"w-full py-3 border-2 border-dashed border-gray-300 rounded-lg text-gray-600 hover:border-blue-400 hover:text-blue-600 transition-colors",children:[(0,bt.jsx)("span",{className:"text-xl mr-2",children:"\u2795"}),"Agregar hito personalizado"]}),(0,bt.jsxs)("div",{className:"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[(0,bt.jsxs)("h4",{className:"font-semibold text-yellow-800 mb-2 flex items-center",children:[(0,bt.jsx)("span",{className:"mr-2",children:"\ud83d\udca1"}),"Consejos para definir hitos"]}),(0,bt.jsxs)("ul",{className:"text-sm text-yellow-700 space-y-1",children:[(0,bt.jsx)("li",{children:"\u2022 Los hitos deben ser medibles y verificables"}),(0,bt.jsx)("li",{children:"\u2022 Deben representar entregables tangibles"}),(0,bt.jsx)("li",{children:"\u2022 Considera las dependencias entre hitos"}),(0,bt.jsx)("li",{children:"\u2022 Incluye hitos de aprobaci\xf3n y validaci\xf3n"})]})]}),(0,bt.jsx)("div",{className:"mt-6 p-4 bg-gray-50 border border-gray-200 rounded-lg",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h4",{className:"font-semibold text-gray-800",children:"Resumen de hitos"}),(0,bt.jsxs)("p",{className:"text-gray-600 text-sm",children:[s.length," hitos definidos para el proyecto"]})]}),(0,bt.jsxs)("div",{className:"text-right",children:[(0,bt.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:s.length}),(0,bt.jsx)("div",{className:"text-sm text-gray-500",children:"hitos"})]})]})})]})};const fj=new class{constructor(){this.maxFileSize=10485760,this.allowedMimeTypes=["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel"],this.allowedExtensions=[".xlsx",".xls"],this.maxTasksPerFile=500,this.maxProjectsPerOrganization=1e3}validateFile(e){const t=[];e.size>this.maxFileSize&&t.push("El archivo es demasiado grande. M\xe1ximo permitido: ".concat(this.maxFileSize/1024/1024,"MB")),this.allowedMimeTypes.includes(e.type)||t.push("Tipo de archivo no soportado. Solo se permiten archivos Excel (.xlsx, .xls)");const r=e.name.toLowerCase().substring(e.name.lastIndexOf("."));this.allowedExtensions.includes(r)||t.push("Extensi\xf3n de archivo no v\xe1lida. Solo se permiten .xlsx y .xls"),e.name.length>255&&t.push("El nombre del archivo es demasiado largo");return/[<>:"/\\|?*\x00-\x1f]/.test(e.name)&&t.push("El nombre del archivo contiene caracteres no v\xe1lidos"),{isValid:0===t.length,errors:t}}validateExtractedData(e,t){const r=[],a=[];if(!e||!Array.isArray(e))return r.push("No se encontraron datos v\xe1lidos en el archivo"),{isValid:!1,errors:r,warnings:a};e.length<2&&r.push("El archivo debe tener al menos una fila de headers y una fila de datos"),e.length>this.maxTasksPerFile&&r.push("Demasiadas tareas en el archivo. M\xe1ximo permitido: ".concat(this.maxTasksPerFile));const s=this.findHeaders(e);(!s||Object.keys(s).length<2)&&r.push("No se encontraron headers v\xe1lidos (se requieren al menos: Tarea, Duraci\xf3n)");const n=this.extractTasksFromData(e,s);return 0===n.length&&r.push("No se encontraron tareas v\xe1lidas en el archivo"),n.forEach((e,t)=>{e.name&&0!==e.name.trim().length||r.push("Tarea en fila ".concat(t+2,": Nombre vac\xedo o inv\xe1lido")),e.name&&e.name.length>255&&r.push("Tarea en fila ".concat(t+2,": Nombre demasiado largo (m\xe1ximo 255 caracteres)")),e.duration&&(e.duration<0||e.duration>365)&&a.push("Tarea en fila ".concat(t+2,": Duraci\xf3n inusual (").concat(e.duration," d\xedas)")),e.startDate&&!this.isValidDate(e.startDate)&&a.push("Tarea en fila ".concat(t+2,": Fecha de inicio inv\xe1lida")),e.endDate&&!this.isValidDate(e.endDate)&&a.push("Tarea en fila ".concat(t+2,": Fecha de fin inv\xe1lida"))}),{isValid:0===r.length,errors:r,warnings:a,stats:{totalRows:e.length,validTasks:n.length,headersFound:s?Object.keys(s).length:0}}}validateExtractedPatterns(e,t){const r=[],a=[];if(!e||"object"!==typeof e)return r.push("Patrones extra\xeddos no v\xe1lidos"),{isValid:!1,errors:r,warnings:a};if(e.phaseStructure){const{phases:t,phaseOrder:r,phaseDurations:s}=e.phaseStructure;t&&t.length>20&&a.push("N\xfamero inusual de fases detectadas"),s&&Object.entries(s).forEach(e=>{let[t,r]=e;r.avg>365&&a.push('Fase "'.concat(t,'": Duraci\xf3n promedio muy larga (').concat(r.avg," d\xedas)"))})}if(e.durationPatterns){const{activityTypes:t,milestoneSpacing:r}=e.durationPatterns;t&&Object.entries(t).forEach(e=>{let[t,r]=e;r.avg>100&&a.push('Actividad "'.concat(t,'": Duraci\xf3n promedio muy larga (').concat(r.avg," d\xedas)"))}),r&&r.avgDaysBetween>90&&a.push("Espaciado promedio entre hitos muy largo")}if(e.metadata){const{totalTasks:t,totalMilestones:r,projectDuration:s}=e.metadata;t>200&&a.push("N\xfamero alto de tareas detectado"),s>1095&&a.push("Duraci\xf3n del proyecto muy larga (m\xe1s de 3 a\xf1os)")}return{isValid:0===r.length,errors:r,warnings:a}}async validateOrganizationLimits(e,t){try{if(!t||!e)return{isValid:!0,warnings:[]};const{count:r}=await t.from("ai_learning_patterns").select("*",{count:"exact",head:!0}).eq("organization_id",e),a=[];return r>=this.maxProjectsPerOrganization&&a.push("L\xedmite de patrones de aprendizaje alcanzado para la organizaci\xf3n"),r>.8*this.maxProjectsPerOrganization&&a.push("Cerca del l\xedmite de patrones de aprendizaje"),{isValid:r<this.maxProjectsPerOrganization,warnings:a,currentCount:r,maxAllowed:this.maxProjectsPerOrganization}}catch(r){return console.error("Error validando l\xedmites de organizaci\xf3n:",r),{isValid:!0,warnings:["No se pudieron validar los l\xedmites de la organizaci\xf3n"]}}}sanitizePatternData(e){const t=JSON.parse(JSON.stringify(e));if(t.phaseStructure&&t.phaseStructure.phases&&(t.phaseStructure.phases=t.phaseStructure.phases.map(e=>this.sanitizeString(e,50))),t.durationPatterns&&t.durationPatterns.activityTypes){const e={};Object.entries(t.durationPatterns.activityTypes).forEach(t=>{let[r,a]=t;const s=this.sanitizeString(r,50);e[s]=a}),t.durationPatterns.activityTypes=e}return t.namingConventions&&(t.namingConventions.activityPrefixes&&(t.namingConventions.activityPrefixes=t.namingConventions.activityPrefixes.map(e=>this.sanitizeString(e,30))),t.namingConventions.milestonePrefixes&&(t.namingConventions.milestonePrefixes=t.namingConventions.milestonePrefixes.map(e=>this.sanitizeString(e,30))),t.namingConventions.commonTerms&&(t.namingConventions.commonTerms=t.namingConventions.commonTerms.map(e=>this.sanitizeString(e,50)))),t.metadata&&(t.metadata.totalTasks=Math.min(t.metadata.totalTasks||0,1e3),t.metadata.totalMilestones=Math.min(t.metadata.totalMilestones||0,100),t.metadata.projectDuration=Math.min(t.metadata.projectDuration||0,3650)),t}sanitizeString(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:255;return e&&"string"===typeof e?e.trim().substring(0,t).replace(/[<>:"/\\|?*\x00-\x1f]/g,"").replace(/\s+/g," "):""}isValidDate(e){if(!e)return!1;const t=new Date(e);return!isNaN(t.getTime())&&t.getFullYear()>=1900&&t.getFullYear()<=2100}findHeaders(e){for(let t=0;t<Math.min(e.length,10);t++){const r=e[t];if(!r||!Array.isArray(r))continue;const a={};let s=0;if(r.forEach((e,t)=>{if(!e||"string"!==typeof e)return;const r=e.toLowerCase().trim();r.includes("tarea")||r.includes("task")||r.includes("actividad")?(a.name={index:t,value:e},s++):r.includes("duraci\xf3n")||r.includes("duration")||r.includes("d\xedas")?(a.duration={index:t,value:e},s++):r.includes("inicio")||r.includes("start")?(a.start={index:t,value:e},s++):(r.includes("fin")||r.includes("end"))&&(a.end={index:t,value:e},s++)}),s>=2)return a}return null}extractTasksFromData(e,t){if(!t||!e)return[];const r=[];for(let a=this.findHeaderRowIndex(e,t)+1;a<e.length;a++){const s=e[a];if(!s||!Array.isArray(s))continue;const n={name:t.name?String(s[t.name.index]||"").trim():"",duration:t.duration?this.parseDuration(s[t.duration.index]):1,startDate:t.start?this.parseDate(s[t.start.index]):null,endDate:t.end?this.parseDate(s[t.end.index]):null};n.name&&r.push(n)}return r}findHeaderRowIndex(e,t){for(let r=0;r<Math.min(e.length,10);r++){const a=e[r];if(!a||!Array.isArray(a))continue;if(Object.values(t).some(e=>a[e.index]===e.value))return r}return 0}parseDuration(e){if(!e)return 1;const t=parseFloat(e);return isNaN(t)?1:Math.max(1,Math.round(t))}parseDate(e){if(!e)return null;try{if("number"===typeof e){return new Date(1900,0,e-2).toISOString().split("T")[0]}if("string"===typeof e){const t=new Date(e);if(!isNaN(t.getTime()))return t.toISOString().split("T")[0]}return null}catch(t){return null}}createSafeFallback(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Error en aprendizaje";return(0,n.A)((0,n.A)({},e),{},{learningMetadata:{enhanced:!1,fallback:!0,reason:"validation-failed",errorMessage:t,fallbackAt:(new Date).toISOString()}})}async logValidationResult(e,t,r,a,s){try{var n;if(!s||!e)return;await s.from("ai_learning_logs").insert({organization_id:e,user_id:t,file_name:r,analysis_status:a.isValid?"completed":"failed",error_message:a.errors.join("; "),patterns_extracted:(null===(n=a.stats)||void 0===n?void 0:n.validTasks)||0})}catch(i){console.error("Error guardando log de validaci\xf3n:",i)}}},mj=fj;const pj=new class{constructor(){this.supabase=null,this.organizationId=null,this.userId=null}async initialize(e,t,r){this.supabase=e,this.organizationId=t,this.userId=r,console.log("\ud83e\udd16 AILearningService inicializado:",{organizationId:t,userId:r})}async analyzeScheduleFile(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"general";try{console.log("\ud83d\udd0d Analizando archivo Excel:",e.name);const r=mj.validateFile(e);if(!r.isValid){const t="Archivo inv\xe1lido: ".concat(r.errors.join(", "));return console.error("\u274c Validaci\xf3n de archivo fallida:",t),await this.logAnalysisError(e.name,t),{success:!1,error:t}}const a=await mj.validateOrganizationLimits(this.organizationId,this.supabase);if(!a.isValid){const t="L\xedmite de patrones de aprendizaje alcanzado para la organizaci\xf3n";return console.error("\u274c L\xedmite de organizaci\xf3n alcanzado"),await this.logAnalysisError(e.name,t),{success:!1,error:t}}const s=ow(await e.arrayBuffer()),n=s.Sheets[s.SheetNames[0]],i=Ew.sheet_to_json(n,{header:1}),o=mj.validateExtractedData(i,e.name);if(!o.isValid){const t="Datos inv\xe1lidos: ".concat(o.errors.join(", "));return console.error("\u274c Validaci\xf3n de datos fallida:",t),await this.logAnalysisError(e.name,t),await mj.logValidationResult(this.organizationId,this.userId,e.name,o,this.supabase),{success:!1,error:t}}const l=this.extractPatternsFromData(i,t),c=mj.validateExtractedPatterns(l,e.name);if(!c.isValid){const t="Patrones inv\xe1lidos: ".concat(c.errors.join(", "));return console.error("\u274c Validaci\xf3n de patrones fallida:",t),await this.logAnalysisError(e.name,t),{success:!1,error:t}}const d=mj.sanitizePatternData(l);return await this.saveLearningPattern(d,t,e.name),console.log("\u2705 Patrones extra\xeddos exitosamente:",d),{success:!0,patterns:d,metadata:{fileName:e.name,fileSize:e.size,projectType:t,extractedAt:(new Date).toISOString(),validationWarnings:[...o.warnings,...c.warnings,...a.warnings]}}}catch(r){return console.error("\u274c Error analizando archivo:",r),await this.logAnalysisError(e.name,r.message),{success:!1,error:r.message}}}extractPatternsFromData(e,t){if(!e||e.length<2)throw new Error("Archivo Excel vac\xedo o sin datos v\xe1lidos");const r=this.findHeaders(e);if(!r)throw new Error("No se encontraron headers v\xe1lidos en el Excel");const a=this.extractTasks(e,r),s=a.filter(e=>this.isMilestone(e));return{phaseStructure:this.analyzePhaseStructure(a,s),durationPatterns:this.analyzeDurationPatterns(a),dependencyPatterns:this.analyzeDependencyPatterns(a),namingConventions:this.analyzeNamingConventions(a,s),metadata:{totalTasks:a.length,totalMilestones:s.length,projectDuration:this.calculateProjectDuration(a),complexity:this.assessComplexity(a,s)}}}findHeaders(e){const t=[["Tarea","Actividad","Task","Activity"],["Duraci\xf3n","Duration","D\xedas","Days"],["Inicio","Start","Fecha Inicio","Start Date"],["Fin","End","Fecha Fin","End Date"],["Predecesoras","Predecessors","Dependencias","Dependencies"]];for(let r=0;r<Math.min(e.length,10);r++){const a=e[r];if(!a||!Array.isArray(a))continue;const s={};let n=0;if(a.forEach((e,r)=>{if(!e||"string"!==typeof e)return;const a=e.toLowerCase().trim();t.forEach(t=>{t.forEach(t=>{if(a.includes(t.toLowerCase())){const a=this.getHeaderCategory(t);a&&(s[a]={index:r,value:e},n++)}})})}),n>=3)return console.log("\u2705 Headers encontrados:",s),s}return null}getHeaderCategory(e){return{Tarea:"name",Actividad:"name",Task:"name",Activity:"name","Duraci\xf3n":"duration",Duration:"duration","D\xedas":"duration",Days:"duration",Inicio:"start",Start:"start","Fecha Inicio":"start","Start Date":"start",Fin:"end",End:"end","Fecha Fin":"end","End Date":"end",Predecesoras:"predecessors",Predecessors:"predecessors",Dependencias:"predecessors",Dependencies:"predecessors"}[e]||null}extractTasks(e,t){const r=[];for(let a=this.findHeaderRowIndex(e,t)+1;a<e.length;a++){const s=e[a];if(!s||!Array.isArray(s))continue;const n=this.parseTaskRow(s,t);n&&n.name&&r.push(n)}return console.log("\ud83d\udcca Tareas extra\xeddas: ".concat(r.length)),r}findHeaderRowIndex(e,t){for(let r=0;r<Math.min(e.length,10);r++){const a=e[r];if(!a||!Array.isArray(a))continue;if(Object.values(t).some(e=>a[e.index]===e.value))return r}return 0}parseTaskRow(e,t){try{const r={};if(t.name&&(r.name=String(e[t.name.index]||"").trim()),t.duration){const a=e[t.duration.index];r.duration=this.parseDuration(a)}return t.start&&(r.startDate=this.parseDate(e[t.start.index])),t.end&&(r.endDate=this.parseDate(e[t.end.index])),t.predecessors&&(r.predecessors=this.parsePredecessors(e[t.predecessors.index])),r.isMilestone=this.isMilestone(r),r}catch(r){return console.warn("\u26a0\ufe0f Error parseando fila:",r),null}}parseDuration(e){if(!e)return 1;const t=parseFloat(e);return isNaN(t)?1:Math.max(1,Math.round(t))}parseDate(e){if(!e)return null;try{if("number"===typeof e){return new Date(1900,0,e-2).toISOString().split("T")[0]}if("string"===typeof e){const t=new Date(e);if(!isNaN(t.getTime()))return t.toISOString().split("T")[0]}return null}catch(t){return null}}parsePredecessors(e){if(!e)return[];return String(e).split(/[,;]/).map(e=>e.trim()).filter(e=>e.length>0)}isMilestone(e){if(!e.name)return!1;const t=e.name.toLowerCase();return["hito","milestone","entregable","deliverable","revisi\xf3n","aprobaci\xf3n"].some(e=>t.includes(e))||0===e.duration}analyzePhaseStructure(e,t){const r=new Set,a=[],s={};return e.forEach(e=>{const t=this.extractPhaseFromName(e.name);t&&(r.add(t),a.includes(t)||a.push(t))}),r.forEach(t=>{const r=e.filter(e=>this.extractPhaseFromName(e.name)===t).map(e=>e.duration||1);r.length>0&&(s[t]={min:Math.min(...r),max:Math.max(...r),avg:Math.round(r.reduce((e,t)=>e+t,0)/r.length)})}),{phases:Array.from(r),phaseOrder:a,phaseDurations:s}}extractPhaseFromName(e){if(!e)return null;const t=e.toLowerCase(),r={inicio:["inicio","start","kickoff","lanzamiento"],"planificaci\xf3n":["planificaci\xf3n","planning","plan","dise\xf1o"],"ejecuci\xf3n":["ejecuci\xf3n","execution","implementaci\xf3n","desarrollo"],cierre:["cierre","close","finalizaci\xf3n","entrega"]};for(const[a,s]of Object.entries(r))if(s.some(e=>t.includes(e)))return a;return null}analyzeDurationPatterns(e){const t={},r=[];e.forEach(e=>{if(e.isMilestone)r.push(e.duration||0);else{const r=this.categorizeActivityType(e.name);t[r]||(t[r]=[]),t[r].push(e.duration||1)}}),Object.keys(t).forEach(e=>{const r=t[e];r.length>0&&(t[e]={min:Math.min(...r),max:Math.max(...r),avg:Math.round(r.reduce((e,t)=>e+t,0)/r.length)})});const a=r.length>0?Math.round(r.reduce((e,t)=>e+t,0)/r.length):15;return{activityTypes:t,milestoneSpacing:{avgDaysBetween:a,commonIntervals:this.findCommonIntervals(r)}}}categorizeActivityType(e){if(!e)return"General";const t=e.toLowerCase(),r={"An\xe1lisis":["an\xe1lisis","analysis","estudio","investigaci\xf3n"],"Dise\xf1o":["dise\xf1o","design","arquitectura","plan"],"Implementaci\xf3n":["implementaci\xf3n","implementation","desarrollo","construcci\xf3n"],Pruebas:["prueba","test","validaci\xf3n","verificaci\xf3n"],"Documentaci\xf3n":["documentaci\xf3n","documentation","manual","gu\xeda"]};for(const[a,s]of Object.entries(r))if(s.some(e=>t.includes(e)))return a;return"General"}findCommonIntervals(e){const t=[7,14,21,30,45,60],r=[];return e.forEach(e=>{t.forEach(t=>{Math.abs(e-t)<=2&&!r.includes(t)&&r.push(t)})}),r.length>0?r:[14,21,30]}analyzeDependencyPatterns(e){const t=[],r={};e.forEach(t=>{if(t.predecessors&&t.predecessors.length>0){const a=this.categorizeActivityType(t.name);t.predecessors.forEach(t=>{const s=e.find(e=>e.name===t);if(s){const e=this.categorizeActivityType(s.name),t="".concat(e,"->").concat(a);r[t]=(r[t]||0)+1}})}});const a=e.length;Object.entries(r).forEach(e=>{let[r,s]=e;const[n,i]=r.split("->");t.push({from:n,to:i,frequency:Math.round(s/a*100)/100})});const s=e.map(t=>this.calculateDependencyDepth(t,e)),n=s.length>0?Math.round(s.reduce((e,t)=>e+t,0)/s.length*10)/10:0;return{commonDependencies:t.sort((e,t)=>t.frequency-e.frequency),dependencyDepth:{avg:n,max:Math.max(...s)}}}calculateDependencyDepth(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;if(r.has(e.name))return 0;if(r.add(e.name),!e.predecessors||0===e.predecessors.length)return 0;let a=0;return e.predecessors.forEach(e=>{const s=t.find(t=>t.name===e);if(s){const e=1+this.calculateDependencyDepth(s,t,new Set(r));a=Math.max(a,e)}}),a}analyzeNamingConventions(e,t){const r=new Set,a=new Set,s=new Set;return e.forEach(e=>{const t=e.name.split(/[\s\-_]+/).filter(e=>e.length>0);if(t.length>0){const s=t[0];e.isMilestone?a.add(s):r.add(s)}t.forEach(e=>{e.length>3&&s.add(e.toLowerCase())})}),{activityPrefixes:Array.from(r),milestonePrefixes:Array.from(a),commonTerms:Array.from(s).slice(0,20)}}calculateProjectDuration(e){if(0===e.length)return 0;const t=e.filter(e=>e.startDate||e.endDate).flatMap(e=>[e.startDate,e.endDate]).filter(e=>e).map(e=>new Date(e)).filter(e=>!isNaN(e.getTime()));if(0===t.length)return 0;const r=new Date(Math.min(...t)),a=new Date(Math.max(...t));return Math.ceil((a-r)/864e5)+1}assessComplexity(e,t){const r=e.length,a=(t.length,e.reduce((e,t)=>e+(t.duration||1),0)/r),s=e.reduce((e,t)=>{var r;return e+((null===(r=t.predecessors)||void 0===r?void 0:r.length)||0)},0);let n=0;return r>50?n+=3:r>25?n+=2:r>10&&(n+=1),a>10?n+=2:a>5&&(n+=1),s>.5*r?n+=2:s>.3*r&&(n+=1),n>=5?"high":n>=3?"medium":"low"}async saveLearningPattern(e,t,r){if(!this.supabase||!this.organizationId)throw new Error("Servicio no inicializado");try{var a;const{data:r,error:s}=await this.supabase.from("ai_learning_patterns").insert({organization_id:this.organizationId,user_id:this.userId,project_type:t,analysis_data:e}).select();if(s)throw s;return console.log("\u2705 Patr\xf3n guardado en base de datos:",null===(a=r[0])||void 0===a?void 0:a.id),await this.updateLearningStats(t),r[0]}catch(s){throw console.error("\u274c Error guardando patr\xf3n:",s),s}}async updateLearningStats(e){try{const{count:t}=await this.supabase.from("ai_learning_patterns").select("*",{count:"exact",head:!0}).eq("organization_id",this.organizationId).eq("project_type",e),{error:r}=await this.supabase.from("ai_learning_stats").upsert({organization_id:this.organizationId,project_type:e,total_patterns:t||0,last_analysis_date:(new Date).toISOString()});if(r)throw r}catch(t){console.error("\u274c Error actualizando estad\xedsticas:",t)}}async getLearningPatterns(e){if(!this.supabase||!this.organizationId)return[];try{const{data:t,error:r}=await this.supabase.from("ai_learning_patterns").select("*").eq("organization_id",this.organizationId).eq("project_type",e).order("created_at",{ascending:!1}).limit(10);if(r)throw r;return t||[]}catch(t){return console.error("\u274c Error obteniendo patrones:",t),[]}}async logAnalysisError(e,t){if(this.supabase&&this.organizationId)try{await this.supabase.from("ai_learning_logs").insert({organization_id:this.organizationId,user_id:this.userId,file_name:e,analysis_status:"failed",error_message:t})}catch(r){console.error("\u274c Error guardando log:",r)}}async getLearningStats(){if(!this.supabase||!this.organizationId)return{};try{const{data:e,error:t}=await this.supabase.from("ai_learning_stats").select("*").eq("organization_id",this.organizationId);if(t)throw t;const r={};return null===e||void 0===e||e.forEach(e=>{r[e.project_type]=e}),r}catch(e){return console.error("\u274c Error obteniendo estad\xedsticas:",e),{}}}},gj=pj,xj=e=>{let{onComplete:t,onBack:s,projectType:i="general",organizationId:o,userId:l}=e;const[c,d]=(0,a.useState)([]),[u,h]=(0,a.useState)(!1),[f,m]=(0,a.useState)([]),[p,g]=(0,a.useState)(!1),[x,b]=(0,a.useState)(null);a.useEffect(()=>{(async()=>{try{const{default:e}=await Promise.resolve().then(r.bind(r,874));e.supabase&&o&&l&&(await gj.initialize(e.supabase,o,l),console.log("\ud83e\udd16 Servicio de aprendizaje inicializado"))}catch(x){console.warn("\u26a0\ufe0f No se pudo inicializar el servicio de aprendizaje:",x)}})()},[o,l]);const v=(0,a.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?g(!0):"dragleave"===e.type&&g(!1)},[]),y=(0,a.useCallback)(e=>{if(e.preventDefault(),e.stopPropagation(),g(!1),e.dataTransfer.files&&e.dataTransfer.files[0]){const t=Array.from(e.dataTransfer.files).filter(e=>"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===e.type||"application/vnd.ms-excel"===e.type||e.name.endsWith(".xlsx")||e.name.endsWith(".xls"));d(e=>[...e,...t])}},[]);return(0,bt.jsxs)("div",{className:"max-w-4xl mx-auto p-6",children:[(0,bt.jsxs)("div",{className:"mb-8",children:[(0,bt.jsxs)("h2",{className:"text-3xl font-bold text-gray-800 mb-4 flex items-center",children:[(0,bt.jsx)("span",{className:"text-4xl mr-3",children:"\ud83e\udde0"}),"Comparte ejemplos de cronogramas"]}),(0,bt.jsx)("p",{className:"text-gray-600 text-lg leading-relaxed",children:"Ayuda a mejorar el Asistente de IA subiendo ejemplos de cronogramas exitosos. El sistema analizar\xe1 patrones, duraciones y estructuras para generar mejores cronogramas en el futuro."})]}),(0,bt.jsx)("div",{className:"border-2 border-dashed rounded-lg p-8 text-center transition-colors ".concat(p?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"),onDragEnter:v,onDragLeave:v,onDragOver:v,onDrop:y,children:(0,bt.jsxs)("div",{className:"space-y-4",children:[(0,bt.jsx)("div",{className:"text-6xl text-gray-400",children:"\ud83d\udcca"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"Arrastra archivos Excel aqu\xed"}),(0,bt.jsx)("p",{className:"text-gray-500 mb-4",children:"O haz clic para seleccionar archivos"}),(0,bt.jsx)("input",{type:"file",multiple:!0,accept:".xlsx,.xls",onChange:e=>{if(e.target.files){const t=Array.from(e.target.files).filter(e=>"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===e.type||"application/vnd.ms-excel"===e.type||e.name.endsWith(".xlsx")||e.name.endsWith(".xls"));d(e=>[...e,...t])}},className:"hidden",id:"file-input"}),(0,bt.jsxs)("label",{htmlFor:"file-input",className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 cursor-pointer transition-colors",children:[(0,bt.jsx)("span",{className:"mr-2",children:"\ud83d\udcc1"}),"Seleccionar archivos"]})]}),(0,bt.jsx)("p",{className:"text-sm text-gray-400",children:"Formatos soportados: .xlsx, .xls"})]})}),c.length>0&&(0,bt.jsxs)("div",{className:"mt-6",children:[(0,bt.jsxs)("h3",{className:"text-lg font-semibold text-gray-700 mb-3",children:["Archivos seleccionados (",c.length,")"]}),(0,bt.jsx)("div",{className:"space-y-2",children:c.map((e,t)=>(0,bt.jsxs)("div",{className:"flex items-center justify-between bg-gray-50 rounded-lg p-3",children:[(0,bt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,bt.jsx)("span",{className:"text-2xl",children:"\ud83d\udcca"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("p",{className:"font-medium text-gray-700",children:e.name}),(0,bt.jsxs)("p",{className:"text-sm text-gray-500",children:[(e.size/1024/1024).toFixed(2)," MB"]})]})]}),(0,bt.jsx)("button",{onClick:()=>(e=>{d(t=>t.filter((t,r)=>r!==e))})(t),className:"text-red-500 hover:text-red-700 transition-colors",title:"Eliminar archivo",children:"\ud83d\uddd1\ufe0f"})]},t))}),(0,bt.jsx)("div",{className:"mt-4 flex space-x-3",children:(0,bt.jsx)("button",{onClick:async()=>{if(0===c.length)return void b("Por favor selecciona al menos un archivo Excel");h(!0),b(null);const e=[];try{for(const a of c){console.log("\ud83d\udd0d Analizando archivo:",a.name);const t=await gj.analyzeScheduleFile(a,i);e.push((0,n.A)({fileName:a.name,fileSize:a.size},t))}m(e);const t=e.filter(e=>e.success).length,r=e.length;t>0?console.log("\u2705 ".concat(t,"/").concat(r," archivos analizados exitosamente")):b("No se pudieron analizar los archivos. Verifica que sean cronogramas v\xe1lidos.")}catch(x){console.error("\u274c Error analizando archivos:",x),b("Error analizando archivos: ".concat(x.message))}finally{h(!1)}},disabled:u,className:"px-6 py-2 rounded-lg font-medium transition-colors ".concat(u?"bg-gray-400 text-gray-600 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"),children:u?(0,bt.jsxs)("span",{className:"flex items-center",children:[(0,bt.jsx)("span",{className:"animate-spin mr-2",children:"\u23f3"}),"Analizando..."]}):(0,bt.jsxs)("span",{className:"flex items-center",children:[(0,bt.jsx)("span",{className:"mr-2",children:"\ud83d\udd0d"}),"Analizar patrones"]})})})]}),f.length>0&&(0,bt.jsxs)("div",{className:"mt-6",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-700 mb-3",children:"Resultados del an\xe1lisis"}),(0,bt.jsx)("div",{className:"space-y-3",children:f.map((e,t)=>{var r,a,s;return(0,bt.jsx)("div",{className:"p-4 rounded-lg border-l-4 ".concat(e.success?"bg-green-50 border-green-500":"bg-red-50 border-red-500"),children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,bt.jsx)("span",{className:"text-2xl",children:e.success?"\u2705":"\u274c"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("p",{className:"font-medium text-gray-700",children:e.fileName}),(0,bt.jsx)("p",{className:"text-sm text-gray-500",children:e.success?"Patrones extra\xeddos: ".concat(e.patterns?Object.keys(e.patterns).length:0):e.error})]})]}),e.success&&e.patterns&&(0,bt.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,bt.jsxs)("div",{children:["Actividades: ",(null===(r=e.patterns.metadata)||void 0===r?void 0:r.totalTasks)||0]}),(0,bt.jsxs)("div",{children:["Hitos: ",(null===(a=e.patterns.metadata)||void 0===a?void 0:a.totalMilestones)||0]}),(0,bt.jsxs)("div",{children:["Duraci\xf3n: ",(null===(s=e.patterns.metadata)||void 0===s?void 0:s.projectDuration)||0," d\xedas"]})]})]})},t)})})]}),x&&(0,bt.jsx)("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,bt.jsx)("p",{className:"text-red-700",children:x})}),(0,bt.jsxs)("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,bt.jsxs)("h4",{className:"font-semibold text-blue-800 mb-2 flex items-center",children:[(0,bt.jsx)("span",{className:"mr-2",children:"\ud83d\udd12"}),"Privacidad y seguridad"]}),(0,bt.jsxs)("ul",{className:"text-sm text-blue-700 space-y-1",children:[(0,bt.jsx)("li",{children:"\u2022 Solo se extraen patrones y estructuras, no contenido espec\xedfico"}),(0,bt.jsx)("li",{children:"\u2022 Los archivos no se almacenan permanentemente"}),(0,bt.jsx)("li",{children:"\u2022 Los patrones aprendidos son privados de tu organizaci\xf3n"}),(0,bt.jsx)("li",{children:"\u2022 Puedes eliminar los patrones en cualquier momento"})]})]}),(0,bt.jsxs)("div",{className:"flex justify-between mt-8",children:[(0,bt.jsx)("button",{onClick:s,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"\u2190 Anterior"}),(0,bt.jsxs)("div",{className:"space-x-3",children:[(0,bt.jsx)("button",{onClick:()=>{t({learningEnabled:!1,patternsLearned:0,analysisResults:[]})},className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Omitir aprendizaje"}),(0,bt.jsxs)("button",{onClick:()=>{const e=f.filter(e=>e.success);e.length>0?t({learningEnabled:!0,patternsLearned:e.length,analysisResults:e}):t({learningEnabled:!1,patternsLearned:0,analysisResults:[]})},disabled:u,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[f.length>0?"Continuar con aprendizaje":"Continuar sin aprendizaje"," \u2192"]})]})]})]})},bj=e=>{var t,r,s,n,i,o,l,c;let{wizardData:d,generatedSchedule:u,isGenerating:h,onGenerate:f}=e;const[m,p]=(0,a.useState)("overview"),[g,x]=(0,a.useState)(!0),b=e=>e<7?"".concat(e," d\xedas"):e<30?"".concat(Math.round(e/7)," semanas"):"".concat(Math.round(e/30)," meses"),v=(e=>{var t;if(!e)return null;const r=e.activities||[],a=e.milestones||[],s=r.reduce((e,t)=>e+(t.duration||0),0),n=r.filter(e=>"high"===e.priority).length,i=(null===(t=e.criticalPath)||void 0===t?void 0:t.length)||0;return{totalActivities:r.length,totalMilestones:a.length,totalDuration:s,highPriorityActivities:n,criticalPathActivities:i,averageActivityDuration:r.length>0?Math.round(s/r.length):0}})(u);return(0,bt.jsxs)("div",{className:"space-y-6",children:[(0,bt.jsxs)("div",{className:"text-center",children:[(0,bt.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"\ud83d\udcca Vista Previa del Cronograma"}),(0,bt.jsx)("p",{className:"text-gray-600",children:"Revisa el cronograma generado por IA antes de aplicarlo a tu proyecto"})]}),!u&&!h&&(0,bt.jsxs)("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 rounded-lg p-8 text-center",children:[(0,bt.jsx)("div",{className:"text-6xl mb-4",children:"\ud83e\udd16"}),(0,bt.jsx)("h4",{className:"text-xl font-semibold text-gray-800 mb-2",children:"\xa1Listo para Generar tu Cronograma!"}),(0,bt.jsx)("p",{className:"text-gray-600 mb-6",children:"Con la informaci\xf3n proporcionada, nuestro asistente de IA generar\xe1 un cronograma optimizado para tu proyecto."}),(0,bt.jsx)("button",{onClick:()=>{u||h||f()},className:"bg-gradient-to-r from-purple-600 to-blue-600 text-white px-8 py-3 rounded-lg font-semibold hover:from-purple-700 hover:to-blue-700 transition-all transform hover:scale-105",children:"\ud83d\ude80 Generar Cronograma con IA"})]}),h&&(0,bt.jsxs)("div",{className:"bg-blue-50 rounded-lg p-8 text-center",children:[(0,bt.jsx)("div",{className:"animate-spin text-6xl mb-4",children:"\ud83e\udd16"}),(0,bt.jsx)("h4",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Generando Cronograma..."}),(0,bt.jsx)("p",{className:"text-gray-600 mb-4",children:"Nuestro asistente de IA est\xe1 analizando tu proyecto y generando el cronograma m\xe1s apropiado."}),(0,bt.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,bt.jsx)("div",{className:"animate-bounce w-2 h-2 bg-blue-600 rounded-full"}),(0,bt.jsx)("div",{className:"animate-bounce w-2 h-2 bg-blue-600 rounded-full",style:{animationDelay:"0.1s"}}),(0,bt.jsx)("div",{className:"animate-bounce w-2 h-2 bg-blue-600 rounded-full",style:{animationDelay:"0.2s"}})]})]}),u&&(0,bt.jsxs)(bt.Fragment,{children:[(0,bt.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6",children:[(0,bt.jsxs)("h4",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[(0,bt.jsx)("span",{className:"text-xl mr-2",children:"\ud83d\udccb"}),"Informaci\xf3n del Proyecto"]}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Proyecto"}),(0,bt.jsx)("p",{className:"text-gray-900 font-semibold",children:d.projectName})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Tipo"}),(0,bt.jsx)("p",{className:"text-gray-900",children:d.projectType})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Metodolog\xeda"}),(0,bt.jsx)("p",{className:"text-gray-900",children:d.methodology})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Equipo"}),(0,bt.jsxs)("p",{className:"text-gray-900",children:[d.teamSize," personas"]})]})]})]}),v&&(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,bt.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4 text-center",children:[(0,bt.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:v.totalActivities}),(0,bt.jsx)("div",{className:"text-sm text-gray-600",children:"Actividades"})]}),(0,bt.jsxs)("div",{className:"bg-green-50 rounded-lg p-4 text-center",children:[(0,bt.jsx)("div",{className:"text-2xl font-bold text-green-600",children:v.totalMilestones}),(0,bt.jsx)("div",{className:"text-sm text-gray-600",children:"Hitos"})]}),(0,bt.jsxs)("div",{className:"bg-purple-50 rounded-lg p-4 text-center",children:[(0,bt.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:b(v.totalDuration)}),(0,bt.jsx)("div",{className:"text-sm text-gray-600",children:"Duraci\xf3n Total"})]}),(0,bt.jsxs)("div",{className:"bg-orange-50 rounded-lg p-4 text-center",children:[(0,bt.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:v.criticalPathActivities}),(0,bt.jsx)("div",{className:"text-sm text-gray-600",children:"Ruta Cr\xedtica"})]})]}),(0,bt.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200",children:[(0,bt.jsx)("div",{className:"flex border-b border-gray-200",children:[{id:"overview",label:"Resumen",icon:"\ud83d\udcca"},{id:"activities",label:"Actividades",icon:"\ud83d\udccb"},{id:"milestones",label:"Hitos",icon:"\ud83c\udfaf"},{id:"timeline",label:"Cronograma",icon:"\ud83d\udcc5"}].map(e=>(0,bt.jsxs)("button",{onClick:()=>p(e.id),className:"flex-1 px-4 py-3 text-sm font-medium transition-colors ".concat(m===e.id?"text-purple-600 border-b-2 border-purple-600 bg-purple-50":"text-gray-600 hover:text-gray-800 hover:bg-gray-50"),children:[(0,bt.jsx)("span",{className:"mr-2",children:e.icon}),e.label]},e.id))}),(0,bt.jsxs)("div",{className:"p-6",children:["overview"===m&&(0,bt.jsxs)("div",{className:"space-y-6",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h5",{className:"font-semibold text-gray-800 mb-3",children:"Resumen del Cronograma"}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,bt.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,bt.jsx)("h6",{className:"font-semibold text-gray-700 mb-2",children:"Duraci\xf3n del Proyecto"}),(0,bt.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:b(v.totalDuration)}),(0,bt.jsxs)("p",{className:"text-sm text-gray-600",children:[v.averageActivityDuration," d\xedas promedio por actividad"]})]}),(0,bt.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,bt.jsx)("h6",{className:"font-semibold text-gray-700 mb-2",children:"Complejidad"}),(0,bt.jsx)("p",{className:"text-2xl font-bold text-gray-900 capitalize",children:(null===(t=u.metadata)||void 0===t?void 0:t.complexity)||"medium"}),(0,bt.jsxs)("p",{className:"text-sm text-gray-600",children:[v.highPriorityActivities," actividades de alta prioridad"]})]})]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h5",{className:"font-semibold text-gray-800 mb-3",children:"Template Utilizado"}),(0,bt.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4",children:[(0,bt.jsx)("p",{className:"font-semibold text-blue-800",children:(null===(r=u.metadata)||void 0===r?void 0:r.templateUsed)||"Template Gen\xe9rico de Proyecto"}),(0,bt.jsxs)("p",{className:"text-sm text-blue-600 mt-1",children:["Generado el ",(y=null===(s=u.metadata)||void 0===s?void 0:s.generatedAt,y?new Date(y).toLocaleDateString("es-ES"):"No definida")]}),!(null!==(n=u.metadata)&&void 0!==n&&n.templateUsed)&&(0,bt.jsx)("p",{className:"text-xs text-blue-500 mt-2",children:"\u2139\ufe0f Se utiliz\xf3 un template gen\xe9rico basado en mejores pr\xe1cticas"})]})]})]}),"activities"===m&&(0,bt.jsxs)("div",{children:[(0,bt.jsxs)("h5",{className:"font-semibold text-gray-800 mb-4",children:["Actividades Generadas (",(null===(i=u.activities)||void 0===i?void 0:i.length)||0,")"]}),(0,bt.jsx)("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:null===(o=u.activities)||void 0===o?void 0:o.map((e,t)=>(0,bt.jsx)("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{className:"flex-1",children:[(0,bt.jsx)("h6",{className:"font-semibold text-gray-800",children:e.name}),(0,bt.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.description}),(0,bt.jsxs)("div",{className:"flex items-center space-x-4 mt-2 text-xs text-gray-500",children:[(0,bt.jsxs)("span",{children:["\u23f1\ufe0f ",e.duration," d\xedas"]}),(0,bt.jsxs)("span",{children:["\ud83d\udcc2 ",e.category]}),(0,bt.jsxs)("span",{children:["\ud83c\udfaf ",e.priority]}),(0,bt.jsxs)("span",{children:["\ud83d\udc64 ",e.assignedTo]})]})]}),(0,bt.jsxs)("div",{className:"text-right",children:[(0,bt.jsx)("div",{className:"px-2 py-1 rounded-full text-xs font-semibold ".concat("high"===e.priority?"bg-red-100 text-red-800":"medium"===e.priority?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"),children:e.priority}),e.confidence&&(0,bt.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["Confianza: ",Math.round(100*e.confidence),"%"]})]})]})},e.id))})]}),"milestones"===m&&(0,bt.jsxs)("div",{children:[(0,bt.jsxs)("h5",{className:"font-semibold text-gray-800 mb-4",children:["Hitos Generados (",(null===(l=u.milestones)||void 0===l?void 0:l.length)||0,")"]}),(0,bt.jsx)("div",{className:"space-y-3",children:null===(c=u.milestones)||void 0===c?void 0:c.map((e,t)=>(0,bt.jsx)("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 rounded-lg p-4 border border-purple-200",children:(0,bt.jsxs)("div",{className:"flex items-center",children:[(0,bt.jsx)("span",{className:"text-2xl mr-3",children:"\ud83c\udfaf"}),(0,bt.jsxs)("div",{className:"flex-1",children:[(0,bt.jsx)("h6",{className:"font-semibold text-gray-800",children:e.name}),(0,bt.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.description}),(0,bt.jsxs)("div",{className:"flex items-center space-x-4 mt-2 text-xs text-gray-500",children:[(0,bt.jsxs)("span",{children:["\ud83d\udcc2 ",e.phase]}),(0,bt.jsxs)("span",{children:["\ud83d\udc64 ",e.assignedTo]})]}),e.criteria&&(0,bt.jsx)("div",{className:"mt-2 p-2 bg-white rounded border border-gray-200",children:(0,bt.jsxs)("p",{className:"text-xs text-gray-600",children:[(0,bt.jsx)("strong",{children:"Criterio:"})," ",e.criteria]})})]})]})},e.id))})]}),"timeline"===m&&(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h5",{className:"font-semibold text-gray-800 mb-4",children:"Cronograma Temporal"}),(0,bt.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,bt.jsx)("p",{className:"text-gray-600 text-center",children:"\ud83d\udcc5 Vista de cronograma temporal disponible despu\xe9s de aplicar el cronograma"}),(0,bt.jsx)("p",{className:"text-sm text-gray-500 text-center mt-2",children:"Una vez aplicado, podr\xe1s ver el cronograma completo en la vista Gantt"})]})]})]})]}),u.recommendations&&u.recommendations.length>0&&(0,bt.jsxs)("div",{className:"bg-yellow-50 rounded-lg p-6",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,bt.jsxs)("h4",{className:"text-lg font-semibold text-gray-800 flex items-center",children:[(0,bt.jsx)("span",{className:"text-xl mr-2",children:"\ud83d\udca1"}),"Recomendaciones de IA"]}),(0,bt.jsx)("button",{onClick:()=>x(!g),className:"text-gray-600 hover:text-gray-800 transition-colors",children:g?"\ud83d\udc41\ufe0f\u200d\ud83d\udde8\ufe0f Ocultar":"\ud83d\udc41\ufe0f Mostrar"})]}),g&&(0,bt.jsx)("div",{className:"space-y-3",children:u.recommendations.map((e,t)=>(0,bt.jsx)("div",{className:"p-4 rounded-lg border-l-4 ".concat("high"===e.priority?"border-red-500 bg-red-50":"medium"===e.priority?"border-yellow-500 bg-yellow-50":"border-green-500 bg-green-50"),children:(0,bt.jsxs)("div",{className:"flex items-start",children:[(0,bt.jsx)("span",{className:"text-lg mr-3",children:"high"===e.priority?"\u26a0\ufe0f":"medium"===e.priority?"\ud83d\udca1":"\u2705"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h6",{className:"font-semibold text-gray-800",children:e.title}),(0,bt.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.description}),e.action&&(0,bt.jsxs)("p",{className:"text-sm text-gray-700 mt-2 font-medium",children:[(0,bt.jsx)("strong",{children:"Acci\xf3n sugerida:"})," ",e.action]})]})]})},t))})]}),(0,bt.jsx)("div",{className:"bg-blue-50 rounded-lg p-4",children:(0,bt.jsxs)("div",{className:"flex items-center",children:[(0,bt.jsx)("span",{className:"text-2xl mr-3",children:"\ud83e\udd16"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h6",{className:"font-semibold text-blue-800",children:"Generado por Asistente de IA"}),(0,bt.jsx)("p",{className:"text-sm text-blue-600",children:"Este cronograma fue generado autom\xe1ticamente bas\xe1ndose en las mejores pr\xe1cticas y patrones de proyectos similares. Puedes modificarlo despu\xe9s de aplicarlo a tu proyecto."})]})]})})]})]});var y};const vj=new class{constructor(){this.supabase=null,this.organizationId=null,this.userId=null}async initialize(e,t,r){this.supabase=e,this.organizationId=t,this.userId=r,await gj.initialize(e,t,r),console.log("\ud83e\udde0 AILearningEngine inicializado")}async generateEnhancedTemplate(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{console.log("\ud83e\udde0 Generando template mejorado para:",t);const a=await gj.getLearningPatterns(t);if(!a||0===a.length)return console.log("\ud83d\udccb No hay patrones aprendidos, usando template base"),this.addFallbackMetadata(e,"no-patterns");const s=this.analyzeLearnedPatterns(a),n=this.applyPatternEnhancements(e,s,r);return console.log("\u2705 Template mejorado generado"),n}catch(a){return console.error("\u274c Error generando template mejorado:",a),this.addFallbackMetadata(e,"error",a.message)}}analyzeLearnedPatterns(e){const t={phaseStructure:this.analyzePhasePatterns(e),durationPatterns:this.analyzeDurationInsights(e),dependencyPatterns:this.analyzeDependencyInsights(e),namingConventions:this.analyzeNamingInsights(e),complexityFactors:this.analyzeComplexityFactors(e),confidence:this.calculateConfidenceScore(e)};return console.log("\ud83d\udd0d An\xe1lisis de patrones completado:",{confidence:t.confidence,patternsAnalyzed:e.length}),t}analyzePhasePatterns(e){const t={},r=[],a={};e.forEach(e=>{const s=e.analysis_data;if(s.phaseStructure){const{phases:e,phaseOrder:n,phaseDurations:i}=s.phaseStructure;e.forEach(e=>{t[e]=(t[e]||0)+1}),n&&n.length>0&&r.push(n),Object.entries(i||{}).forEach(e=>{let[t,r]=e;a[t]||(a[t]={durations:[],counts:[]}),a[t].durations.push(r.avg),a[t].counts.push(1)})}});const s=Object.entries(t).sort((e,t)=>{let[,r]=e,[,a]=t;return a-r}).slice(0,6),n=this.findMostCommonPhaseOrder(r),i={};return Object.entries(a).forEach(e=>{let[t,r]=e;const a=r.durations.reduce((e,t,a)=>e+t*r.counts[a],0),s=r.counts.reduce((e,t)=>e+t,0);i[t]=s>0?Math.round(a/s):15}),{commonPhases:s.map(e=>{let[t]=e;return t}),recommendedOrder:n,avgDurations:i,confidence:Math.min(s.length/3,1)}}findMostCommonPhaseOrder(e){if(0===e.length)return["Inicio","Planificaci\xf3n","Ejecuci\xf3n","Cierre"];const t={};e.forEach(e=>{const r=e.join("->");t[r]=(t[r]||0)+1});const r=Object.entries(t).sort((e,t)=>{let[,r]=e,[,a]=t;return a-r})[0];return r?r[0].split("->"):e[0]}analyzeDurationInsights(e){const t={},r=[];e.forEach(e=>{const a=e.analysis_data;if(a.durationPatterns){const{activityTypes:e,milestoneSpacing:s}=a.durationPatterns;Object.entries(e||{}).forEach(e=>{let[r,a]=e;t[r]||(t[r]={durations:[],counts:[]}),t[r].durations.push(a.avg),t[r].counts.push(1)}),s&&s.avgDaysBetween&&r.push(s.avgDaysBetween)}});const a={};Object.entries(t).forEach(e=>{let[t,r]=e;const s=r.durations.reduce((e,t,a)=>e+t*r.counts[a],0),n=r.counts.reduce((e,t)=>e+t,0);a[t]=n>0?Math.round(s/n):5});const s=r.length>0?Math.round(r.reduce((e,t)=>e+t,0)/r.length):14;return{avgDurationsByType:a,avgMilestoneSpacing:s,confidence:Math.min(Object.keys(a).length/5,1)}}analyzeDependencyInsights(e){const t={},r=[];e.forEach(e=>{const a=e.analysis_data;if(a.dependencyPatterns){const{commonDependencies:e,dependencyDepth:s}=a.dependencyPatterns;e.forEach(e=>{const r="".concat(e.from,"->").concat(e.to);t[r]||(t[r]={frequency:0,count:0}),t[r].frequency+=e.frequency,t[r].count+=1}),s&&s.avg&&r.push(s.avg)}});const a=Object.entries(t).map(e=>{let[t,r]=e;return{dependency:t,avgFrequency:r.frequency/r.count,confidence:r.count}}).sort((e,t)=>t.avgFrequency-e.avgFrequency).slice(0,10);return{commonDependencies:a,avgDependencyDepth:r.length>0?Math.round(r.reduce((e,t)=>e+t,0)/r.length*10)/10:2,confidence:Math.min(a.length/5,1)}}analyzeNamingInsights(e){const t={},r={},a={};e.forEach(e=>{const s=e.analysis_data;if(s.namingConventions){const{activityPrefixes:e,milestonePrefixes:n,commonTerms:i}=s.namingConventions;e.forEach(e=>{t[e]=(t[e]||0)+1}),n.forEach(e=>{r[e]=(r[e]||0)+1}),i.forEach(e=>{a[e]=(a[e]||0)+1})}});const s=Object.entries(t).sort((e,t)=>{let[,r]=e,[,a]=t;return a-r}).slice(0,5).map(e=>{let[t]=e;return t});return{recommendedActivityPrefixes:s,recommendedMilestonePrefixes:Object.entries(r).sort((e,t)=>{let[,r]=e,[,a]=t;return a-r}).slice(0,3).map(e=>{let[t]=e;return t}),commonTerms:Object.entries(a).sort((e,t)=>{let[,r]=e,[,a]=t;return a-r}).slice(0,10).map(e=>{let[t]=e;return t}),confidence:Math.min(s.length/3,1)}}analyzeComplexityFactors(e){var t;const r={low:0,medium:0,high:0},a=[],s=[];e.forEach(e=>{const t=e.analysis_data;if(t.metadata){const{complexity:e,totalTasks:n,projectDuration:i}=t.metadata;e&&(r[e]=(r[e]||0)+1),n&&a.push(n),i&&s.push(i)}});const n=a.length>0?Math.round(a.reduce((e,t)=>e+t,0)/a.length):20,i=s.length>0?Math.round(s.reduce((e,t)=>e+t,0)/s.length):90;return{mostCommonComplexity:(null===(t=Object.entries(r).sort((e,t)=>{let[,r]=e,[,a]=t;return a-r})[0])||void 0===t?void 0:t[0])||"medium",avgTaskCount:n,avgProjectDuration:i,complexityDistribution:r,confidence:Math.min(e.length/5,1)}}calculateConfidenceScore(e){const t=e.length;return 0===t?0:t<3?.3:t<5?.5:t<10?.7:.9}applyPatternEnhancements(e,t,r){const a=JSON.parse(JSON.stringify(e));if(t.confidence<.3)return console.log("\u26a0\ufe0f Confianza insuficiente, usando template base"),this.addFallbackMetadata(a,"low-confidence");try{return t.phaseStructure.confidence>.5&&(a.phases=this.enhancePhaseStructure(a.phases,t.phaseStructure)),t.durationPatterns.confidence>.5&&(a.activities=this.enhanceActivityDurations(a.activities,t.durationPatterns)),t.durationPatterns.avgMilestoneSpacing&&(a.milestones=this.enhanceMilestoneSpacing(a.milestones,t.durationPatterns.avgMilestoneSpacing)),t.namingConventions.confidence>.5&&(a.activities=this.applyNamingConventions(a.activities,t.namingConventions,"activity"),a.milestones=this.applyNamingConventions(a.milestones,t.namingConventions,"milestone")),t.complexityFactors.confidence>.5&&(a.metadata=this.enhanceComplexityMetadata(a.metadata,t.complexityFactors,r)),a.learningMetadata={enhanced:!0,confidence:t.confidence,patternsUsed:Object.keys(t).length,enhancedAt:(new Date).toISOString()},console.log("\u2705 Mejoras aplicadas al template:",{confidence:t.confidence,phasesEnhanced:!!t.phaseStructure.confidence,durationsEnhanced:!!t.durationPatterns.confidence,namingEnhanced:!!t.namingConventions.confidence}),a}catch(s){return console.error("\u274c Error aplicando mejoras:",s),this.addFallbackMetadata(e,"enhancement-error",s.message)}}enhancePhaseStructure(e,t){const r=[...e];if(t.recommendedOrder&&t.recommendedOrder.length>0){const e=t.recommendedOrder,a=[];return e.forEach(e=>{const t=r.find(t=>t.name.toLowerCase().includes(e.toLowerCase())||e.toLowerCase().includes(t.name.toLowerCase()));t&&a.push(t)}),r.forEach(e=>{a.find(t=>t.id===e.id)||a.push(e)}),a}return r}enhanceActivityDurations(e,t){return e.map(e=>{const r=this.categorizeActivityType(e.name),a=t.avgDurationsByType[r];return a&&Math.abs(a-e.duration)>2?(0,n.A)((0,n.A)({},e),{},{duration:a,originalDuration:e.duration,enhancedBy:"learning"}):e})}enhanceMilestoneSpacing(e,t){return e.map((e,r)=>{const a=t+5*r;return(0,n.A)((0,n.A)({},e),{},{spacing:a,originalSpacing:e.spacing||14,enhancedBy:"learning"})})}applyNamingConventions(e,t,r){return e.map((e,a)=>{let s=e.name;if("activity"===r&&t.recommendedActivityPrefixes.length>0){const e=t.recommendedActivityPrefixes[a%t.recommendedActivityPrefixes.length];s.toLowerCase().startsWith(e.toLowerCase())||(s="".concat(e," ").concat(s))}else if("milestone"===r&&t.recommendedMilestonePrefixes.length>0){const e=t.recommendedMilestonePrefixes[0];s.toLowerCase().includes(e.toLowerCase())||(s="".concat(e,": ").concat(s))}return s!==e.name?(0,n.A)((0,n.A)({},e),{},{name:s,originalName:e.name,enhancedBy:"learning"}):e})}enhanceComplexityMetadata(e,t,r){return(0,n.A)((0,n.A)({},e),{},{complexity:t.mostCommonComplexity,estimatedTaskCount:t.avgTaskCount,estimatedDuration:t.avgProjectDuration,learningBased:!0,complexityDistribution:t.complexityDistribution})}categorizeActivityType(e){const t=e.toLowerCase(),r={"An\xe1lisis":["an\xe1lisis","analysis","estudio","investigaci\xf3n"],"Dise\xf1o":["dise\xf1o","design","arquitectura","plan"],"Implementaci\xf3n":["implementaci\xf3n","implementation","desarrollo","construcci\xf3n"],Pruebas:["prueba","test","validaci\xf3n","verificaci\xf3n"],"Documentaci\xf3n":["documentaci\xf3n","documentation","manual","gu\xeda"]};for(const[a,s]of Object.entries(r))if(s.some(e=>t.includes(e)))return a;return"General"}addFallbackMetadata(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return mj.createSafeFallback(e,r)}async getLearningStatistics(){try{return{success:!0,statistics:await gj.getLearningStats()}}catch(e){return console.error("\u274c Error obteniendo estad\xedsticas:",e),{success:!1,error:e.message}}}},yj=vj;const wj=new class{constructor(){this.supabase=null,this.organizationId=null,this.currentUser=null}async initialize(e,t,r){this.supabase=e,this.organizationId=t,this.currentUser=r,await yj.initialize(e,t,null===r||void 0===r?void 0:r.id),console.log("\ud83e\udd16 AISchedulerService inicializado:",{organizationId:t,userId:null===r||void 0===r?void 0:r.id})}async generateSmartSchedule(e){try{console.log("\ud83e\udd16 Generando cronograma inteligente:",e);const t=await this.selectBestTemplate(e);console.log("\ud83d\udccb Template seleccionado:",null===t||void 0===t?void 0:t.name);const r=await this.adjustActivitiesByContext(t,e);console.log("\u2699\ufe0f Actividades ajustadas:",r.length);const a=await this.generateSmartMilestones(r,e);console.log("\ud83c\udfaf Hitos generados:",a.length);const s=this.calculateCriticalPath(r);console.log("\ud83d\udd17 Ruta cr\xedtica calculada:",s.length,"actividades");const n=this.generateRecommendations(e,r);console.log("\ud83d\udca1 Recomendaciones generadas:",n.length);const i={activities:r,milestones:a,criticalPath:s,recommendations:n,metadata:{templateUsed:null===t||void 0===t?void 0:t.name,generatedAt:(new Date).toISOString(),wizardData:e,estimatedDuration:this.calculateTotalDuration(r),complexity:this.assessComplexity(e,r)}};return await this.saveGenerationHistory(e,i),console.log("\u2705 Cronograma generado exitosamente"),i}catch(t){throw console.error("\u274c Error generando cronograma:",t),new Error("Error generando cronograma: ".concat(t.message))}}async selectBestTemplate(e){try{var t,r,a;console.log("\ud83d\udd0d Seleccionando template para:",e.projectType,e.industry);let s=await this.getBaseTemplate(e);if(!s)return console.warn("No se pudo obtener template base"),null;console.log("\ud83e\udde0 Aplicando aprendizaje a template base");const n=await yj.generateEnhancedTemplate(s,e.projectType||"general",{industry:e.industry,methodology:e.methodology,teamSize:e.teamSize,budget:e.budget}),i=null!==(t=n.learningMetadata)&&void 0!==t&&t.enhanced?n:s;return console.log("\ud83d\udccb Template final seleccionado:",{name:i.name,enhanced:(null===(r=n.learningMetadata)||void 0===r?void 0:r.enhanced)||!1,confidence:(null===(a=n.learningMetadata)||void 0===a?void 0:a.confidence)||0}),i}catch(s){return console.error("Error seleccionando template:",s),null}}async getBaseTemplate(e){try{const{projectType:t,industry:r,methodology:a}=e;if(!this.supabase)return console.log("\ud83d\udccb Usando template gen\xe9rico (Sin Supabase)"),{id:"generic-template",name:"Template Gen\xe9rico de Proyecto",description:"Template gen\xe9rico basado en mejores pr\xe1cticas de gesti\xf3n de proyectos",project_type:e.projectType||"general",industry:e.industry||"general",methodology:e.methodology||"waterfall",template_data:this.getGenericTemplateData(e)};let s=this.supabase.from("schedule_templates").select("*");s=this.organizationId?s.or("organization_id.eq.".concat(this.organizationId,",organization_id.is.null")):s.is("organization_id",null),t&&(s=s.eq("project_type",t)),r&&(s=s.eq("industry",r)),a&&(s=s.eq("methodology",a));const{data:n,error:i}=await s;if(i)throw console.error("Error obteniendo templates:",i),i;if(console.log("\ud83d\udccb Templates encontrados:",(null===n||void 0===n?void 0:n.length)||0),!n||0===n.length){console.warn("No se encontraron templates espec\xedficos, usando template gen\xe9rico");let t=this.supabase.from("schedule_templates").select("*");t=this.organizationId?t.or("organization_id.eq.".concat(this.organizationId,",organization_id.is.null")):t.is("organization_id",null);const{data:r}=await t.limit(1);return null!==r&&void 0!==r&&r[0]?r[0]:(console.log("\ud83d\udccb Creando template gen\xe9rico para el proyecto"),{id:"generic-template",name:"Template Gen\xe9rico de Proyecto",description:"Template gen\xe9rico basado en mejores pr\xe1cticas de gesti\xf3n de proyectos",project_type:e.projectType||"general",industry:e.industry||"general",methodology:e.methodology||"waterfall",template_data:this.getGenericTemplateData(e)})}return this.rankTemplates(n,e)[0]}catch(t){return console.error("Error obteniendo template base:",t),null}}async adjustActivitiesByContext(e,t){if(!e||!e.template_data)return console.warn("Template no v\xe1lido para ajustar actividades"),[];const{phases:r}=e.template_data,a=[];let s=1;const n=this.calculateTeamSizeMultiplier(t.teamSize),i=this.calculateExperienceMultiplier(t.teamExperience);return r.forEach((e,r)=>{e.activities.forEach((o,l)=>{let c=o.duration;c=Math.ceil(c*n*i),"low"===t.riskTolerance?c=Math.ceil(1.2*c):"high"===t.riskTolerance&&(c=Math.ceil(.8*c));const d={id:"ai-".concat(s++),name:o.name,description:this.generateActivityDescription(o,t),duration:Math.max(1,c),category:o.category||"execution",phase:e.name,phaseIndex:r,activityIndex:l,isMilestone:o.isMilestone||!1,priority:this.determinePriority(o,t),assignedTo:this.suggestAssignee(o,t),dependencies:this.adjustDependencies(o.dependencies,a),estimatedCost:this.estimateCost(o,t),requiredSkills:o.requiredSkills||[],parallel:o.parallel||!1,generatedBy:"ai",confidence:this.calculateConfidence(o,t)};a.push(d)})}),a}async generateSmartMilestones(e,t){const r=[];let a=1;const s={};e.forEach(e=>{s[e.phase]||(s[e.phase]=[]),s[e.phase].push(e)}),Object.entries(s).forEach(e=>{let[s,n]=e;const i={id:"milestone-".concat(a++),name:"HITO: ".concat(s," Completada"),description:"Completar todas las actividades de la fase: ".concat(s),phase:s,isMilestone:!0,duration:0,startDate:null,endDate:null,progress:0,status:"pending",priority:"high",assignedTo:t.projectManager||"Pendiente",dependencies:[],criteria:this.generateMilestoneCriteria(s,n),generatedBy:"ai",confidence:.9};r.push(i)});const n=this.generateSpecificMilestones(t,e);return r.push(...n),r}calculateCriticalPath(e){return e.filter(e=>"high"===e.priority||e.dependencies.length>2||e.estimatedCost>1e4).map(e=>e.id)}generateRecommendations(e,t){const r=[];e.teamSize<3&&r.push({type:"team",priority:"high",title:"Equipo Peque\xf1o",description:"Con un equipo peque\xf1o, considera reducir el paralelismo de actividades para evitar sobrecarga.",action:"Revisar actividades paralelas y secuencializar si es necesario"}),"junior"===e.teamExperience&&r.push({type:"experience",priority:"medium",title:"Equipo Junior",description:"Equipo con poca experiencia. Considera agregar tiempo de capacitaci\xf3n y mentor\xeda.",action:"Agregar actividades de capacitaci\xf3n y revisi\xf3n adicional"});this.calculateTotalDuration(t)>180&&r.push({type:"duration",priority:"high",title:"Proyecto de Larga Duraci\xf3n",description:"Proyecto de m\xe1s de 6 meses. Considera dividir en fases m\xe1s peque\xf1as.",action:"Implementar hitos de control mensuales"});return t.filter(e=>"high"===e.priority).length>.3*t.length&&r.push({type:"complexity",priority:"medium",title:"Alta Complejidad",description:"Muchas actividades de alta complejidad. Considera agregar buffers de tiempo.",action:"Agregar 15% de buffer en estimaciones de tiempo"}),r}async saveGenerationHistory(e,t){try{const r={project_id:e.projectId,template_id:t.metadata.templateUsed,input_data:e,generated_schedule:t,created_by:this.currentUser.id,organization_id:this.organizationId},{error:a}=await this.supabase.from("ai_schedule_generations").insert(r);a?console.error("Error guardando historial de generaci\xf3n:",a):console.log("\u2705 Historial de generaci\xf3n guardado")}catch(r){console.error("Error guardando historial:",r)}}calculateTeamSizeMultiplier(e){return e<=2?1.3:e<=5?1:e<=8?.9:.8}calculateExperienceMultiplier(e){switch(e){case"junior":return 1.4;case"intermediate":return 1.1;case"senior":return.9;case"expert":return.8;default:return 1}}generateActivityDescription(e,t){const r=e.description||"Ejecutar ".concat(e.name);return t.projectDescription?"".concat(r," para el proyecto: ").concat(t.projectDescription):r}determinePriority(e,t){return"planning"===e.category||"testing"===e.category||e.isMilestone?"high":(e.parallel,"medium")}suggestAssignee(e,t){if(t.projectManager)return t.projectManager;switch(e.category){case"planning":case"delivery":return"Project Manager";case"execution":return"Team Lead";case"testing":return"QA Lead";default:return"Pendiente"}}adjustDependencies(e,t){return e&&Array.isArray(e)?e.map(e=>{const r=t.find(t=>t.name===e);return r?r.id:e}):[]}estimateCost(e,t){return(e.estimatedCost||1e3)*(t.teamSize||1)*(e.duration||1)*.1}calculateConfidence(e,t){let r=.7;return t.projectType&&t.industry&&(r+=.2),"senior"!==t.teamExperience&&"expert"!==t.teamExperience||(r+=.1),Math.min(1,r)}generateMilestoneCriteria(e,t){const r=t.map(e=>e.name).join(", ");return"Completar exitosamente: ".concat(r)}generateSpecificMilestones(e,t){const r=[];let a=1e3;switch(e.projectType){case"equipment_installation":r.push({id:"milestone-".concat(a++),name:"HITO: Equipo Recibido y Verificado",description:"Equipo recibido, inspeccionado y verificado seg\xfan especificaciones",isMilestone:!0,duration:0,progress:0,status:"pending",priority:"high",assignedTo:"Quality Inspector",criteria:"Equipo recibido, inspecci\xf3n de calidad aprobada, documentaci\xf3n verificada",generatedBy:"ai",confidence:.9});break;case"development":r.push({id:"milestone-".concat(a++),name:"HITO: C\xf3digo en Producci\xf3n",description:"C\xf3digo desplegado y funcionando en ambiente de producci\xf3n",isMilestone:!0,duration:0,progress:0,status:"pending",priority:"high",assignedTo:"DevOps Lead",criteria:"Deployment exitoso, pruebas de humo pasando, monitoreo activo",generatedBy:"ai",confidence:.9})}return r}calculateTotalDuration(e){return e.reduce((e,t)=>e+(t.duration||0),0)}assessComplexity(e,t){let r="medium";const a=this.calculateTotalDuration(t),s=t.filter(e=>"high"===e.priority).length,n=e.teamSize||1;return a>120||s>5||n<3?r="high":a<30&&s<3&&n>=5&&(r="low"),r}rankTemplates(e,t){return e.sort((e,r)=>{let a=0,s=0;return e.project_type===t.projectType&&(a+=3),r.project_type===t.projectType&&(s+=3),e.industry===t.industry&&(a+=2),r.industry===t.industry&&(s+=2),e.methodology===t.methodology&&(a+=1),r.methodology===t.methodology&&(s+=1),s-a})}getGenericTemplateData(e){const{projectType:t="general",teamSize:r=5}=e,a={manufacturing:[{name:"Planificaci\xf3n",activities:[{name:"Definici\xf3n de requerimientos",duration:5,category:"planning"},{name:"Dise\xf1o conceptual",duration:10,category:"design"},{name:"Planificaci\xf3n de recursos",duration:3,category:"planning"}]},{name:"Dise\xf1o y Desarrollo",activities:[{name:"Dise\xf1o detallado",duration:15,category:"design"},{name:"Especificaciones t\xe9cnicas",duration:8,category:"design"},{name:"Prototipo",duration:20,category:"development"}]},{name:"Implementaci\xf3n",activities:[{name:"Compra e instalaci\xf3n de maquinas y equipos",duration:30,category:"procurement",isMilestone:!0},{name:"Instalaci\xf3n y configuraci\xf3n",duration:15,category:"implementation"},{name:"Pruebas de funcionamiento",duration:10,category:"testing"}]},{name:"Cierre",activities:[{name:"Capacitaci\xf3n del personal",duration:5,category:"training"},{name:"Documentaci\xf3n final",duration:3,category:"documentation"},{name:"Entrega del proyecto",duration:2,category:"delivery",isMilestone:!0}]}],general:[{name:"Inicio",activities:[{name:"Kick-off del proyecto",duration:1,category:"planning",isMilestone:!0},{name:"Definici\xf3n de alcance",duration:5,category:"planning"},{name:"Planificaci\xf3n inicial",duration:7,category:"planning"}]},{name:"Ejecuci\xf3n",activities:[{name:"Desarrollo de actividades principales",duration:20,category:"execution"},{name:"Seguimiento y control",duration:15,category:"monitoring"},{name:"Gesti\xf3n de cambios",duration:8,category:"management"}]},{name:"Cierre",activities:[{name:"Pruebas finales",duration:5,category:"testing"},{name:"Entrega del proyecto",duration:3,category:"delivery",isMilestone:!0}]}]};return{phases:a[t]||a.general,estimatedDuration:60,complexity:"medium",riskLevel:"medium"}}async getAvailableTemplates(){try{let e=this.supabase.from("schedule_templates").select("*");e=this.organizationId?e.or("organization_id.eq.".concat(this.organizationId,",organization_id.is.null")):e.is("organization_id",null);const{data:t,error:r}=await e.order("name");return r?(console.error("Error obteniendo templates:",r),[]):t||[]}catch(e){return console.error("Error obteniendo templates:",e),[]}}async getGenerationHistory(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{let t=this.supabase.from("ai_schedule_generations").select("*").eq("organization_id",this.organizationId).order("created_at",{ascending:!1});e&&(t=t.eq("project_id",e));const{data:r,error:a}=await t;return a?(console.error("Error obteniendo historial:",a),[]):r||[]}catch(t){return console.error("Error obteniendo historial:",t),[]}}async provideFeedback(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";try{const{error:a}=await this.supabase.from("ai_schedule_generations").update({feedback_score:t,feedback_comments:r,updated_at:(new Date).toISOString()}).eq("id",e).eq("organization_id",this.organizationId);return a?(console.error("Error guardando feedback:",a),!1):(console.log("\u2705 Feedback guardado exitosamente"),!0)}catch(a){return console.error("Error guardando feedback:",a),!1}}},jj=e=>{let{isOpen:t,onClose:r,onComplete:s,projectId:i,currentProject:o=null}=e;const[l,c]=(0,a.useState)(1),[d,u]=(0,a.useState)({}),[h,f]=(0,a.useState)(null),[m,p]=(0,a.useState)(!1),[g,x]=(0,a.useState)(null),[b,v]=(0,a.useState)([]);(0,a.useEffect)(()=>{t&&y()},[t]);const y=async()=>{try{c(1),u({}),f(null),x(null),p(!1),await w(),u(o?{projectId:i,projectName:o.name,projectDescription:o.description,projectManager:o.manager||"Pendiente",startDate:o.startDate||(new Date).toISOString().split("T")[0],endDate:o.endDate||null}:{projectId:i,startDate:(new Date).toISOString().split("T")[0]})}catch(g){console.error("Error inicializando wizard:",g),x("Error inicializando el asistente de cronogramas")}},w=async()=>{try{const e=await wj.getAvailableTemplates();v(e),console.log("\ud83d\udccb Templates cargados:",e.length)}catch(g){console.error("Error cargando templates:",g)}},j=e=>{u(t=>(0,n.A)((0,n.A)({},t),e))},N=()=>{l<5&&c(e=>e+1)},k=()=>{c(1),u({}),f(null),x(null),p(!1),r()},S=()=>{switch(l){case 1:return d.projectName&&d.projectType;case 2:return d.teamSize&&d.teamExperience;case 3:return d.milestones&&d.milestones.length>0;case 4:return!0;case 5:return null!==h;default:return!1}};return t?(0,bt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-5xl h-[95vh] max-h-[95vh] overflow-hidden flex flex-col",children:[(0,bt.jsxs)("div",{className:"bg-gradient-to-r from-purple-600 to-blue-600 text-white p-6",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsxs)("h2",{className:"text-2xl font-bold flex items-center",children:[(0,bt.jsx)("span",{className:"text-3xl mr-3",children:"\ud83e\udd16"}),"Asistente Inteligente de Cronogramas"]}),(0,bt.jsx)("p",{className:"text-purple-100 mt-1",children:"Genera cronogramas autom\xe1ticamente con IA"})]}),(0,bt.jsx)("button",{onClick:k,className:"text-white hover:text-purple-200 transition-colors",children:(0,bt.jsx)("span",{className:"text-2xl",children:"\xd7"})})]}),(0,bt.jsxs)("div",{className:"mt-4",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between text-sm text-purple-100 mb-2",children:[(0,bt.jsxs)("span",{children:["Paso ",l," de 5"]}),(0,bt.jsxs)("span",{children:[Math.round(l/5*100),"% completado"]})]}),(0,bt.jsx)("div",{className:"w-full bg-purple-300 rounded-full h-2",children:(0,bt.jsx)("div",{className:"bg-white h-2 rounded-full transition-all duration-300",style:{width:"".concat(l/5*100,"%")}})})]})]}),(0,bt.jsxs)("div",{className:"p-6 overflow-y-auto flex-1",children:[g&&(0,bt.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:(0,bt.jsxs)("div",{className:"flex items-center",children:[(0,bt.jsx)("span",{className:"text-red-500 text-xl mr-3",children:"\u26a0\ufe0f"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h3",{className:"text-red-800 font-semibold",children:"Error"}),(0,bt.jsx)("p",{className:"text-red-600",children:g})]})]})}),1===l&&(0,bt.jsx)(dj,{wizardData:d,onUpdate:j,availableTemplates:b}),2===l&&(0,bt.jsx)(uj,{wizardData:d,onUpdate:j}),3===l&&(0,bt.jsx)(hj,{wizardData:d,onUpdate:j}),4===l&&(0,bt.jsx)(xj,{wizardData:d,onUpdate:j,onComplete:e=>{j(e),N()},projectType:d.projectType}),5===l&&(0,bt.jsx)(bj,{wizardData:d,generatedSchedule:h,isGenerating:m,onGenerate:async()=>{try{p(!0),x(null),console.log("\ud83e\udd16 Iniciando generaci\xf3n de cronograma..."),console.log("\ud83d\udcca Datos del wizard:",d);const e=await wj.generateSmartSchedule(d);f(e),c(3),console.log("\u2705 Cronograma generado exitosamente")}catch(g){console.error("\u274c Error generando cronograma:",g),x("Error generando cronograma: ".concat(g.message))}finally{p(!1)}}})]}),(0,bt.jsxs)("div",{className:"bg-gray-50 px-6 py-4 flex items-center justify-between border-t",children:[(0,bt.jsx)("div",{className:"flex items-center space-x-4",children:l>1&&(0,bt.jsx)("button",{onClick:()=>{l>1&&c(e=>e-1)},className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"\u2190 Anterior"})}),(0,bt.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,bt.jsx)("button",{onClick:k,className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"Cancelar"}),l<5?(0,bt.jsx)("button",{onClick:N,disabled:!S(),className:"px-6 py-2 rounded-lg font-semibold transition-colors ".concat(S()?"bg-purple-600 hover:bg-purple-700 text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"),children:"Siguiente \u2192"}):(0,bt.jsx)("button",{onClick:()=>{h&&s&&(s(h),r())},disabled:!h,className:"px-6 py-2 rounded-lg font-semibold transition-colors ".concat(h?"bg-green-600 hover:bg-green-700 text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"),children:"\u2705 Aplicar Cronograma"})]})]})]})}):null},Nj=864e5,kj=50,Sj=e=>"string"!==typeof e?e:e.replace(/<script[^>]*>.*?<\/script>/gi,"").replace(/javascript:/gi,"").replace(/on\w+=/gi,"").replace(/[<>]/g,"").trim().substring(0,1e3),Ej=e=>e&&"string"===typeof e?e.length<2?{valid:!1,error:"Nombre debe tener al menos 2 caracteres"}:e.length>255?{valid:!1,error:"Nombre muy largo (m\xe1ximo 255 caracteres)"}:{valid:!0,sanitized:Sj(e)}:{valid:!1,error:"Nombre de tarea requerido"},Tj=e=>{const t=parseInt(e);return isNaN(t)||t<0||t>365?{valid:!1,error:"Duraci\xf3n debe ser un n\xfamero entre 0 y 365 d\xedas"}:{valid:!0,value:t}},_j=e=>{if(!e)return{valid:!1,error:"Fecha requerida"};const t=new Date(e);if(isNaN(t.getTime()))return{valid:!1,error:"Fecha inv\xe1lida"};const r=(new Date).getFullYear();return t.getFullYear()<2020||t.getFullYear()>r+10?{valid:!1,error:"Fecha fuera del rango permitido (2020-"+(r+10)+")"}:{valid:!0,value:Cj(t)}},Cj=e=>{if(!e)return(new Date).toISOString().split("T")[0];const t=new Date(e);return isNaN(t.getTime())?(console.warn("Invalid date in toISO:",e),(new Date).toISOString().split("T")[0]):t.toISOString().split("T")[0]},Aj=e=>{const t=new Date(e).getDay();return t>=1&&t<=5},Dj=function(e,t){if(0===t)return e;if(arguments.length>2&&void 0!==arguments[2]&&arguments[2]){const r=new Date(e);return r.setDate(r.getDate()+t),Cj(r)}return Pj(e,t)},Pj=(e,t)=>{if(0===t)return e;let r=new Date(e+"T00:00:00"),a=0;for(;a<t;){r.setDate(r.getDate()+1);const e=Aj(r);r.toLocaleDateString("es-ES",{weekday:"long"});e&&a++}return Cj(r)},Ij=function(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2]){const r=new Date(Cj(e)),a=new Date(Cj(t));return Math.max(0,Math.round((a.getTime()-r.getTime())/Nj))}return Rj(e,t)},Oj=(e,t,r)=>{const a=new Date(Cj(e)),s=new Date(t);let n=0,i=new Date(s);const o=Cj(e).includes("2025-09-01");if(o&&(console.log("\ud83d\udd0d findColumnIndex DEBUG:"),console.log("   targetDate:",Cj(e)),console.log("   referenceStartDate:",t),console.log("   includeWeekends:",r),console.log("   isTargetBeforeStart:",a<s)),a<s){let e=new Date(a);for(;e<s;)(r||Aj(e))&&(n--,o&&console.log("\ud83d\udcc5 Columna negativa:",Cj(e),"\xedndice:",n)),e.setDate(e.getDate()+1)}else for(;i<a;)r||Aj(i)?(n++,o&&console.log("\ud83d\udcc5 Columna contada:",Cj(i),"\xedndice:",n)):o&&console.log("\ud83d\udcc5 D\xeda saltado (fin de semana):",Cj(i)),i.setDate(i.getDate()+1);return o&&console.log("\ud83c\udfaf findColumnIndex resultado final:",n),n},Rj=(e,t)=>{const r=new Date(Cj(e)),a=new Date(Cj(t));return Math.max(0,Math.round((a.getTime()-r.getTime())/Nj))},Mj=function(e,t){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?Ij(e,Dj(t,1,!0),!0):Fj(e,t)},Fj=(e,t)=>{const r=new Date(Cj(e)),a=new Date(Cj(t));return Math.max(1,Math.round((a.getTime()-r.getTime())/Nj)+1)},Lj=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=[],a=new Set;let s=0;for(const l of e)a.has(l.id)?(console.warn("\u26a0\ufe0f Tarea duplicada detectada en CPM: ".concat(l.id," - ").concat(l.name)),s++):(a.add(l.id),r.push(l));s>0&&console.warn("\ud83d\udd27 Se eliminaron ".concat(s," tareas duplicadas en CPM"));const n=new Map(r.map(e=>[e.id,{id:e.id,wbsCode:e.wbsCode,name:e.name,duration:e.duration,startDate:e.startDate,endDate:e.endDate,progress:e.progress,predecessors:[...e.predecessors||[]],cost:e.cost,priority:e.priority,assignedTo:e.assignedTo,isMilestone:e.isMilestone,isCritical:e.isCritical,originalDuration:e.originalDuration,earlyStart:e.earlyStart,earlyFinish:e.earlyFinish,lateStart:e.lateStart,lateFinish:e.lateFinish,totalFloat:e.totalFloat,freeFloat:e.freeFloat,description:e.description,resources:[...e.resources||[]],workPackageId:e.workPackageId,status:e.status,successors:[...e.successors||[]]}])),i=Array.from(n.values());try{(()=>{const e=new Set,r=new Set,a=s=>{if(e.has(s))return;if(r.has(s))return console.warn("Dependencia circular detectada en la tarea: ".concat(s,". Saltando c\xe1lculo.")),e.add(s),void r.delete(s);r.add(s);const i=n.get(s);if(!i)return;let o=new Date(i.startDate);for(const e of i.predecessors){a(e);const t=n.get(e);if(t){let e=new Date(t.earlyFinish);e>o&&(o=e)}}i.predecessors.length>0&&!i.isMilestone&&o.setDate(o.getDate()+1),i.earlyStart=Cj(o),i.isMilestone?i.earlyFinish=i.earlyStart:i.earlyFinish=Dj(i.earlyStart,i.duration,t),r.delete(s),e.add(s)};for(const t of i)a(t.id)})(),(()=>{const e=i.filter(e=>0===e.successors.length);let t=new Date("1900-01-01");for(const s of e){const e=new Date(s.earlyFinish);e>t&&(t=e)}const r=new Set,a=e=>{if(r.has(e))return;const t=n.get(e);if(t){if(0===t.successors.length)t.lateFinish=t.earlyFinish;else{let e=new Date("2100-01-01");for(const r of t.successors){a(r);const t=n.get(r);if(t){let r=new Date(t.lateStart);t.isMilestone||r.setDate(r.getDate()-1),r<e&&(e=r)}}t.lateFinish=Cj(e)}if(t.isMilestone)t.lateStart=t.lateFinish;else{const e=new Date(t.lateFinish);e.setDate(e.getDate()-t.duration),t.lateStart=Cj(e)}r.add(e)}};for(const s of e)a(s.id);for(const s of i)r.has(s.id)||a(s.id);for(const s of i)if(0===s.predecessors.length)if(s.lateStart=s.earlyStart,s.isMilestone)s.lateFinish=s.earlyStart;else{const e=new Date(s.earlyStart);e.setDate(e.getDate()+s.duration),s.lateFinish=Cj(e)}})();let e=0;const r=[];for(const t of i){const e=new Date(t.earlyStart),a=new Date(t.lateStart),s=Math.round((a-e)/Nj);t.totalFloat=Math.max(0,s),t.isCritical=0===t.totalFloat;let o=new Date("2100-01-01");if(0===t.successors.length)t.freeFloat=t.totalFloat;else{for(const a of t.successors){const e=n.get(a);if(e){const t=new Date(e.earlyStart);t<o&&(o=t)}}const e=new Date(t.earlyFinish),r=Math.round((o-e)/Nj);t.freeFloat=Math.max(0,r)}t.isCritical&&(r.push(t.id),t.criticalImpact={delayCost:.1*t.cost,resourceImpact:t.resources.length>0?"Alto":"Bajo",successorImpact:t.successors.length}),t.safetyFloat=Math.max(0,t.totalFloat-t.freeFloat),t.sensitivity=Bj(t,i)}if(i.length>0){const t=i.map(e=>new Date(e.startDate)),a=i.map(e=>new Date(e.endDate)),s=new Date(Math.min(...t)),n=new Date(Math.max(...a)),o=n.getTime()-s.getTime();e=Math.max(0,Math.round(o/864e5)),console.log("\ud83d\udd0d CPM DEBUG - Ruta Cr\xedtica:",{totalTasks:i.length,criticalTasks:r.length,minStart:s&&!isNaN(s.getTime())?s.toISOString().split("T")[0]:"N/A",maxEnd:n&&!isNaN(n.getTime())?n.toISOString().split("T")[0]:"N/A",criticalPathLength:e})}const a=Uj(i),s=Wj(i,r);return console.log("\ud83d\udd0d DEBUG - Tareas y fechas de fin:",i.map(e=>({name:e.name,endDate:e.endDate,endDateObj:e.endDate&&null!==e.endDate&&void 0!==e.endDate?new Date(e.endDate).toISOString().split("T")[0]:"N/A"}))),{tasks:i,error:null,criticalPath:r,criticalPathLength:e,criticalPaths:a,projectMetrics:s}}catch(o){return{tasks:i,error:o.message}}},zj=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=new Map;for(const[a,s]of e.entries()){let e=0;for(const r of s)e+=Ij(r.startDate,Dj(r.endDate,1,t),t);r.set(a,e)}return Object.fromEntries(r)},Bj=(e,t)=>{let r=0;e.isCritical&&(r+=3),0===e.predecessors.length&&(r+=1),0===e.successors.length&&(r+=1),e.resources.length>2&&(r+=2),e.duration>10&&(r+=1);return r+=e.predecessors.filter(e=>{const r=t.find(t=>t.id===e);return r&&r.successors.length>1}).length,Math.min(10,r)},Uj=e=>{const t=[],r=new Set,a=(s,n)=>{if(r.has(s))return;const i=e.find(e=>e.id===s);if(i){if(r.add(s),n.push(s),0===i.successors.length){const r=n.reduce((t,r)=>{const a=e.find(e=>e.id===r);return t+(a?a.duration:0)},0);r===Math.max(...e.map(e=>new Date(e.earlyFinish)-new Date(e.startDate)/Nj))&&t.push(n.slice())}else for(const e of i.successors)a(e,n);n.pop(),r.delete(s)}},s=e.filter(e=>0===e.predecessors.length);for(const n of s)a(n.id,[]);return t},Wj=(e,t)=>{let r=0;if(e.length>0){const t=e.map(e=>new Date(e.startDate)),a=e.map(e=>new Date(e.endDate)),s=new Date(Math.min(...t)),n=new Date(Math.max(...a)).getTime()-s.getTime();r=Math.max(0,Math.round(n/864e5))}const a=t.reduce((t,r)=>{const a=e.find(e=>e.id===r);return t+(a?a.duration:0)},0),s=Math.max(r,a),n=e.reduce((e,t)=>e+(t.cost||0),0),i=t.reduce((t,r)=>{const a=e.find(e=>e.id===r);return t+(a&&a.cost||0)},0);return{totalDuration:s,criticalDuration:Math.round(a),totalCost:n,criticalCost:i,criticalPercentage:Math.round(i/n*100),averageFloat:Math.round(e.reduce((e,t)=>e+t.totalFloat,0)/e.length),maxFloat:Math.max(...e.map(e=>e.totalFloat)),criticalTasksCount:t.length,originalDuration:r,criticalPathLength:a,durationDifference:s-r}},Hj=e=>{var t,r,s,i;let{tasks:o,setTasks:l,importTasks:c,projectData:d,onScheduleDataChange:u,includeWeekends:h,setIncludeWeekends:f,useSupabase:m=!0}=e;(0,a.useEffect)(()=>{if(console.log("\ud83d\udd27 useEffect EJECUT\xc1NDOSE - TAREAS:",(null===o||void 0===o?void 0:o.length)||0),o&&o.length>0){const e=o.filter(e=>e.isMilestone&&e.startDate!==e.endDate);console.log("\ud83d\udd27 HITOS CON FECHAS INCORRECTAS DETECTADOS:",e.length),e.length>0&&(console.log("\ud83d\udd27 EJECUTANDO CORRECCI\xd3N AUTOM\xc1TICA"),l(e=>e.map(e=>e.isMilestone&&e.startDate!==e.endDate?(console.log("\ud83d\udd27 CORRIGIENDO HITO AUTOM\xc1TICAMENTE:",{taskId:e.id,taskName:e.name,startDateOriginal:e.startDate,endDateOriginal:e.endDate,endDateCorregida:e.startDate}),(0,n.A)((0,n.A)({},e),{},{endDate:e.startDate,updatedAt:(new Date).toISOString()})):e)))}},[o.length]),(0,a.useEffect)(()=>{if(u&&o.length>0){const e={tasks:o,projectStart:null===d||void 0===d?void 0:d.startDate,projectEnd:null===d||void 0===d?void 0:d.endDate,totalTasks:o.length,completedTasks:o.filter(e=>"completed"===e.status).length,inProgressTasks:o.filter(e=>"in-progress"===e.status).length,delayedTasks:o.filter(e=>"delayed"===e.status).length,totalProgress:o.reduce((e,t)=>e+(t.progress||0),0)/o.length};u(e),console.log("\ud83d\udcca Datos del cronograma enviados a FinancialManagement")}},[o,u,d]);const p={projectName:d.projectName,startDate:d.startDate,plannedEndDate:d.endDate,totalInvestment:d.totalBudget},[g,x]=(0,a.useState)(null),[b,v]=(0,a.useState)(""),[y,w]=(0,a.useState)("excel"),[j,N]=(0,a.useState)(null),[k,S]=(0,a.useState)(""),[E,T]=(0,a.useState)(null),[_,C]=(0,a.useState)(""),[A,D]=(0,a.useState)(""),P=(0,a.useRef)(null),[I,O]=((0,a.useRef)(null),(0,a.useState)("days")),[R,M]=(0,a.useState)(!0),[F,L]=(0,a.useState)(!0),[z,B]=(0,a.useState)([]),[U,W]=(0,a.useState)(!1),[H,V]=(0,a.useState)(!1),[G,q]=(0,a.useState)(!1),[$,K]=(0,a.useState)(null),[Y,J]=(0,a.useState)(!1),[X,Q]=(0,a.useState)([]),[Z,ee]=(0,a.useState)(!1),[te,re]=(0,a.useState)(null),[ae,se]=(0,a.useState)(!1),[ne,ie]=(0,a.useState)(!1),{logMinutaTaskCreated:oe,logMinutaTaskUpdated:le,addAuditEvent:ce}=Fw(null===d||void 0===d?void 0:d.id,m),[de,ue]=(0,a.useState)("hierarchical"),[he,fe]=(0,a.useState)("TB"),[me,pe]=(0,a.useState)(!1),[ge,xe]=(0,a.useState)(!0),[be,ve]=(0,a.useState)(!1),[ye,we]=(0,a.useState)(!1),[je,Ne]=(0,a.useState)(!0),[ke,Se]=(0,a.useState)(1),[Ee,Te]=(0,a.useState)({x:0,y:0}),[_e,Ce]=(0,a.useState)(null),[Ae,De]=(0,a.useState)({x:0,y:0}),[Pe,Ie]=(0,a.useState)(!1),[Oe,Re]=(0,a.useState)({x:0,y:0}),[Me,Fe]=(0,a.useState)({x:0,y:0}),Le=(0,a.useRef)(null),ze=(0,a.useRef)(null),Be=(0,a.useRef)(null),Ue=(0,a.useRef)(null),We=(0,a.useMemo)(()=>new Map(z.map(e=>[e.id,e])),[z]),He=(0,a.useMemo)(()=>{console.log("\ud83d\udd04 Recalculando CPM con tareas:",o.map(e=>({id:e.id,name:e.name,predecessors:e.predecessors,successors:e.successors,endDate:e.endDate}))),console.log("\ud83d\ude80 DEBUG - Tareas ANTES de calculateCPM:",o.map(e=>({id:e.id,name:e.name,predecessors:e.predecessors,successors:e.successors,endDate:e.endDate})));const e=Lj(o,h);console.log("\ud83d\ude80 DEBUG - Tareas DESPU\xc9S de calculateCPM:",e.tasks.map(e=>({id:e.id,name:e.name,predecessors:e.predecessors,successors:e.successors,endDate:e.endDate}))),console.log("\ud83d\ude80 DEBUG - Resultado CPM:",{criticalPath:e.criticalPath,criticalPathLength:e.criticalPathLength,totalTasks:e.tasks.length}),console.log("\ud83d\ude80 CORRECCI\xd3N SCHEDULE - Usando dependencias originales del usuario");const t=e.tasks.map(e=>({id:e.id,wbsCode:e.wbsCode,name:e.name,duration:e.duration,startDate:e.startDate,endDate:e.endDate,progress:e.progress,predecessors:e.predecessors||[],cost:e.cost,priority:e.priority,assignedTo:e.assignedTo,isMilestone:e.isMilestone,isCritical:e.isCritical,originalDuration:e.originalDuration,earlyStart:e.earlyStart,earlyFinish:e.earlyFinish,lateStart:e.lateStart,lateFinish:e.lateFinish,totalFloat:e.totalFloat,freeFloat:e.freeFloat,description:e.description,resources:[...e.resources||[]],workPackageId:e.workPackageId,status:e.status,successors:e.successors||[]}));return console.log("\ud83d\udd04 Tareas con dependencias FORZADAS despu\xe9s de CPM:",t.map(e=>({id:e.id,name:e.name,predecessors:e.predecessors,successors:e.successors,endDate:e.endDate}))),{criticalPath:e.criticalPath,criticalPathLength:e.criticalPathLength,tasks:t}},[o,h,o.length]),Ve=(0,a.useMemo)(()=>He.tasks.map(e=>e.isMilestone&&(console.log("\ud83d\udd0d HITO DETECTADO:",{id:e.id,name:e.name,startDate:e.startDate,endDate:e.endDate,isMilestone:e.isMilestone}),e.startDate!==e.endDate)?(console.log("\ud83d\udd27 CORRIGIENDO HITO - FORZANDO endDate = startDate"),(0,n.A)((0,n.A)({},e),{},{endDate:e.startDate})):e),[He.tasks]);(0,a.useEffect)(()=>{K(He.error)},[He.error]),(0,a.useEffect)(()=>{if(o&&o.length>0){const e=new Set,t=new Set,r=[],a=function(s){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(t.has(s)){const e=n.indexOf(s),t=n.slice(e).concat([s]);return r.push({taskId:s,cycle:t}),!0}if(e.has(s))return!1;t.add(s),e.add(s);const i=o.find(e=>e.id===s);if(i)for(const e of i.predecessors)if(a(e,[...n,s]))return!0;return t.delete(s),!1};o.forEach(t=>{e.has(t.id)||a(t.id)}),r.length>0?(console.warn("\ud83d\udea8 DEPENDENCIAS CIRCULARES REALES detectadas: ".concat(r.length)),r.forEach(e=>{console.warn("  \u2022 Tarea ".concat(e.taskId,": Ciclo ").concat(e.cycle.join(" \u2192 ")))}),console.warn('\ud83d\udca1 Usa el bot\xf3n "Limpiar Dependencias Circulares" para corregir manualmente')):console.log("\u2705 Sin dependencias circulares detectadas")}},[o]);const Ge=(0,a.useMemo)(()=>function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=new Map,a=[];for(const s of e)if(s&&s.resources&&Array.isArray(s.resources))for(const e of s.resources)r.has(e)||r.set(e,[]),r.get(e).push({taskId:s.id,taskName:s.name,startDate:s.startDate,endDate:s.endDate,allocation:100});for(const[s,n]of r.entries()){const e=n.sort((e,t)=>new Date(e.startDate)-new Date(t.startDate));for(let r=0;r<e.length-1;r++){const n=e[r],i=e[r+1];new Date(n.endDate)>new Date(i.startDate)&&a.push({resource:s,task1:n.taskId,task2:i.taskId,overlapDays:Ij(i.startDate,n.endDate,t)})}}return{resourceLoad:Object.fromEntries(r),conflicts:a,utilization:zj(r,t)}}(Ve,h),[Ve,h]),qe=(0,a.useRef)(h);(0,a.useEffect)(()=>{const e=e=>{console.log("\ud83d\udd04 EVENTO tasksUpdated recibido:",e.detail),l(e=>[...e])};return window.addEventListener("tasksUpdated",e),()=>{window.removeEventListener("tasksUpdated",e)}},[]),(0,a.useEffect)(()=>{if(console.log("\ud83d\udd04 CHECKBOX CAMBI\xd3:",h),qe.current!==h&&o&&o.length>0){console.log("\ud83d\udd04 RECALCULANDO FECHAS..."),qe.current=h;const e=o.map((e,t)=>{if(e.isMilestone)return(0,n.A)((0,n.A)({},e),{},{endDate:e.startDate});if(e.startDate&&e.duration){const t=Dj(e.startDate,e.duration,h);return(0,n.A)((0,n.A)({},e),{},{endDate:t})}return e}),t=e.some((e,t)=>e.endDate!==o[t].endDate);console.log("\ud83d\udd04 hasChanges:",t),t?(console.log("\ud83d\udd04 ACTUALIZANDO TABLA..."),l(e)):console.log("\ud83d\udd04 NO HAY CAMBIOS - las fechas son iguales")}},[h]);const $e=(0,a.useMemo)(()=>{if(0===Ve.length)return[];let e=Ve;be&&(e=e.filter(e=>e.isCritical));const t=ye?100:140,r=ye?60:80,a=ye?150:200,s=ye?100:120,n=[],i=new Map,o=new Set,l=function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Set;if(o.has(t))return i.get(t)||0;if(r.has(t))return console.warn("Dependencia circular detectada en tarea:",t),i.set(t,0),o.add(t),0;const a=e.find(e=>e.id===t);if(!a)return 0;if(0===a.predecessors.length)return i.set(t,0),o.add(t),0;r.add(t);try{const e=(a.predecessors&&a.predecessors.length>0?Math.max(...a.predecessors.map(e=>l(e,r))):0)+1;return i.set(t,e),o.add(t),e}finally{r.delete(t)}};e.forEach(e=>l(e.id));const c=new Map;e.forEach(e=>{const t=i.get(e.id);c.has(t)||c.set(t,[]),c.get(t).push(e)});const d=Math.max(...Array.from(c.keys()));return c.forEach((e,i)=>{const o=(e.length-1)*a,l=100+50*(d-i);e.forEach((e,c)=>{const d=l+o/2-o/2+c*a,u=100+i*s;n.push({id:e.id,x:d,y:u,width:t,height:r,level:i,task:e})})}),console.log("\ud83d\udccd NODOS GENERADOS MEJORADOS:",n.map(e=>({id:e.id,x:e.x,y:e.y,level:e.level,center:"".concat(e.x+e.width/2,",").concat(e.y+e.height/2)}))),n},[Ve,be,ye]),Ke=$e,Ye=()=>{if(!Ke||!Array.isArray(Ke))return console.log("\u26a0\ufe0f networkNodes no disponible a\xfan, usando fallback"),Te({x:0,y:0}),void Se(1);if(console.log("\ud83c\udfaf centerNetwork llamado:",{hasSvgRef:!!Ue.current,nodesLength:Ke.length,nodes:Ke.slice(0,3).map(e=>({id:e.id,x:e.x,y:e.y}))}),Ue.current&&Ke.length>0){let e=1/0,t=1/0,r=-1/0,a=-1/0;Ke.forEach(s=>{e=Math.min(e,s.x),t=Math.min(t,s.y),r=Math.max(r,s.x+s.width),a=Math.max(a,s.y+s.height)}),console.log("\ud83d\udcd0 Bounding box calculado:",{minX:e,minY:t,maxX:r,maxY:a});const s=100,n=r-e+2*s,i=a-t+2*s,o=e-s,l=t-s;console.log("\ud83c\udfaf Centrando en:",{centerX:o,centerY:l,contentWidth:n,contentHeight:i}),Te({x:o,y:l}),Se(1)}else console.log("\u26a0\ufe0f Fallback: no hay nodos o SVG ref"),Te({x:0,y:0}),Se(1)};(0,a.useEffect)(()=>{"network"===y&&Ue.current&&setTimeout(()=>{Ye()},100)},[y]),(0,a.useEffect)(()=>{"network"===y&&Ke.length>0&&setTimeout(()=>{Ye()},100)},[Ke,y]),(0,a.useEffect)(()=>{"network"===y&&setTimeout(()=>{je?At():Ye()},200)},[be,ye,y,je,Ke]),(0,a.useEffect)(()=>{if("network"===y&&Ue.current){Ue.current.setAttribute("viewBox","".concat(Ee.x," ").concat(Ee.y," ").concat(1200/ke," ").concat(600/ke))}},[ke,Ee,y]),(0,a.useEffect)(()=>{(async()=>{if(null!==d&&void 0!==d&&d.id){ee(!0);try{if(m){console.log("\ud83d\udd0d DEBUG: Cargando minutas para proyecto:",d.id);const{success:e,minutas:t}=await Nt.default.loadMinutasByProject(d.id);e?(console.log("\ud83d\udd0d DEBUG: Minutas recibidas de Supabase:",t),Q(t),console.log("\u2705 Minutas cargadas desde Supabase: ".concat(t.length))):console.warn("\u26a0\ufe0f Error cargando minutas desde Supabase")}else{var e;const t=(null===(e=JSON.parse(localStorage.getItem("portfolioData")||"{}").minutasByProject)||void 0===e?void 0:e[d.id])||[];Q(t),console.log("\u2705 Minutas cargadas desde localStorage: ".concat(t.length))}}catch(t){console.error("\u274c Error cargando minutas:",t)}finally{ee(!1)}}})()},[null===d||void 0===d?void 0:d.id,m]);const Je=(0,a.useRef)(null),Xe=(0,a.useRef)(!1),Qe=(0,a.useCallback)((e,t,r)=>{console.log("\ud83d\udd04 updateTask llamado:",{taskId:e,field:t,value:r,selectedTaskId:null===g||void 0===g?void 0:g.id}),e?(l(a=>a.map(a=>{if(a.id!==e)return a;const s={id:a.id,wbsCode:a.wbsCode,name:a.name,duration:a.duration,startDate:a.startDate,endDate:a.endDate,progress:a.progress,predecessors:[...a.predecessors||[]],cost:a.cost,priority:a.priority,assignedTo:a.assignedTo,isMilestone:a.isMilestone,isCritical:a.isCritical,originalDuration:a.originalDuration,earlyStart:a.earlyStart,earlyFinish:a.earlyFinish,lateStart:a.lateStart,lateFinish:a.lateFinish,totalFloat:a.totalFloat,freeFloat:a.freeFloat,description:a.description,resources:[...a.resources||[]],workPackageId:a.workPackageId,status:a.status,successors:[...a.successors||[]]},n=parseFloat(r);switch(t){case"duration":{const e=Number.isFinite(n)?Math.max(0,Math.round(n)):0;s.duration=e,s.isMilestone?s.endDate=s.startDate:s.endDate=Dj(s.startDate,e,h);break}case"startDate":s.startDate=r,s.isMilestone?s.endDate=r:s.endDate=Dj(r,s.duration,h);break;case"progress":{const e=Number.isFinite(n)?Math.round(n):0;s.progress=Math.min(100,Math.max(0,e));break}case"cost":s.cost=Number.isFinite(n)?n:0;break;case"resources":s.resources=Array.isArray(r)?r:[];break;default:s[t]=r,"name"===t?console.log("\ud83d\udd24 CAMPO NOMBRE - Actualizando en tasks array:",{taskId:e,valorAnterior:a[t],valorNuevo:r,taskCompleta:s}):console.log("\ud83d\udd04 Campo '".concat(t,"' actualizado a:"),r)}return s})),g&&g.id===e&&(console.log("\ud83d\udd04 Actualizando selectedTask para:",e),x(a=>{const s={id:a.id,wbsCode:a.wbsCode,name:a.name,duration:a.duration,startDate:a.startDate,endDate:a.endDate,progress:a.progress,predecessors:[...a.predecessors||[]],cost:a.cost,priority:a.priority,assignedTo:a.assignedTo,isMilestone:a.isMilestone,isCritical:a.isCritical,originalDuration:a.originalDuration,earlyStart:a.earlyStart,earlyFinish:a.earlyFinish,lateStart:a.lateStart,lateFinish:a.lateFinish,totalFloat:a.totalFloat,freeFloat:a.freeFloat,description:a.description,resources:[...a.resources||[]],workPackageId:a.workPackageId,status:a.status,successors:[...a.successors||[]]},n=parseFloat(r);switch(t){case"duration":{const e=Number.isFinite(n)?Math.max(0,Math.round(n)):0;s.duration=e,s.isMilestone?s.endDate=s.startDate:s.endDate=Dj(s.startDate,e,h);break}case"startDate":s.startDate=r,s.isMilestone?s.endDate=r:s.endDate=Dj(r,s.duration,h);break;case"progress":{const e=Number.isFinite(n)?Math.round(n):0;s.progress=Math.min(100,Math.max(0,e));break}case"cost":s.cost=Number.isFinite(n)?n:0;break;case"resources":s.resources=Array.isArray(r)?r:[];break;default:s[t]=r,"name"===t?console.log("\ud83d\udd24 CAMPO NOMBRE - Actualizando selectedTask:",{taskId:e,valorAnterior:a[t],valorNuevo:r,selectedTaskCompleta:s}):console.log("\ud83d\udd04 selectedTask campo '".concat(t,"' actualizado a:"),r)}return console.log("\ud83d\udd04 selectedTask actualizado:",s),s}))):console.error("\u274c taskId es null o undefined")},[g]),Ze={FS:{name:"Finish-to-Start",description:"La tarea predecesora debe terminar antes de que la sucesora pueda comenzar",color:"#3b82f6"},SS:{name:"Start-to-Start",description:"La tarea sucesora puede comenzar cuando la predecesora comience",color:"#10b981"},FF:{name:"Finish-to-Finish",description:"La tarea sucesora debe terminar cuando la predecesora termine",color:"#f59e0b"},SF:{name:"Start-to-Finish",description:"La tarea sucesora debe terminar cuando la predecesora comience",color:"#8b5cf6"}},et=(0,a.useCallback)((e,t)=>{const r=new Set,a=new Set,s=e=>{if(a.has(e))return!0;if(r.has(e))return!1;r.add(e),a.add(e);const t=Ve.find(t=>t.id===e);if(t)for(const r of t.predecessors)if(s(r))return!0;return a.delete(e),!1},n=Ve.find(t=>t.id===e),i=n?{id:n.id,wbsCode:n.wbsCode,name:n.name,duration:n.duration,startDate:n.startDate,endDate:n.endDate,progress:n.progress,predecessors:[...n.predecessors||[]],cost:n.cost,priority:n.priority,assignedTo:n.assignedTo,isMilestone:n.isMilestone,isCritical:n.isCritical,originalDuration:n.originalDuration,earlyStart:n.earlyStart,earlyFinish:n.earlyFinish,lateStart:n.lateStart,lateFinish:n.lateFinish,totalFloat:n.totalFloat,freeFloat:n.freeFloat,description:n.description,resources:[...n.resources||[]],workPackageId:n.workPackageId,status:n.status,successors:[...n.successors||[]]}:null;return!!i&&(i.predecessors=[...i.predecessors||[],t],s(t))},[Ve]),tt=(0,a.useCallback)(()=>{console.log("\ud83e\uddf9 Limpiando dependencias circulares...");const e=new Set,t=new Set,r=new Set,a=s=>{if(t.has(s))return r.add(s),!0;if(e.has(s))return!1;t.add(s),e.add(s);const n=o.find(e=>e.id===s);if(n)for(const e of n.predecessors)if(a(e))return r.add(s),!0;return t.delete(s),!1};if(o.forEach(t=>{e.has(t.id)||a(t.id)}),r.size>0){console.warn("\ud83d\udea8 Se encontraron ".concat(r.size," tareas con dependencias circulares:"),Array.from(r));const e=o.map(e=>r.has(e.id)?(console.warn("\ud83d\udd27 Limpiando dependencias circulares de tarea: ".concat(e.name," (").concat(e.id,")")),(0,n.A)((0,n.A)({},e),{},{predecessors:[],successors:[]})):e);return l(e),!0}return!1},[o]);(0,a.useEffect)(()=>{const e=()=>{const e=document.getElementById("newDependencyType"),t=document.getElementById("dependencyTypeInfo");if(e&&t){const r=e.value,a=Ze[r];a&&(t.textContent=a.description)}},t=document.getElementById("newDependencyType");if(t)return t.addEventListener("change",e),e(),()=>{t.removeEventListener("change",e)}},[g]);(0,a.useCallback)((e,t)=>{console.log("\ud83c\udd95 NUEVA FUNCI\xd3N handleTaskEdit - INICIANDO:",{taskId:e,updates:t}),l(r=>{console.log("\ud83d\udd0d SETTASKS #3 - NUEVA FUNCI\xd3N handleTaskEdit:",e,t),console.log("\ud83d\udd0d SETTASKS #3 - Estado ANTES:",JSON.stringify(r.map(e=>({id:e.id,name:e.name,predecessors:e.predecessors,successors:e.successors})),null,2));const a=r.map(r=>{if(r.id===e){const e=(0,n.A)({id:r.id,wbsCode:r.wbsCode,name:r.name,duration:r.duration,startDate:r.startDate,endDate:r.endDate,progress:r.progress,predecessors:[...r.predecessors||[]],cost:r.cost,priority:r.priority,assignedTo:r.assignedTo,isMilestone:r.isMilestone,isCritical:r.isCritical,originalDuration:r.originalDuration,earlyStart:r.earlyStart,earlyFinish:r.earlyFinish,lateStart:r.lateStart,lateFinish:r.lateFinish,totalFloat:r.totalFloat,freeFloat:r.freeFloat,description:r.description,resources:[...r.resources||[]],workPackageId:r.workPackageId,status:r.status,successors:[...r.successors||[]]},t||{});return console.log("\ud83c\udd95 NUEVA FUNCI\xd3N - Tarea actualizada:",{id:e.id,name:e.name,predecessors:e.predecessors,successors:e.successors}),e}return r});return console.log("\ud83d\udd0d SETTASKS #3 - Estado DESPU\xc9S:",JSON.stringify(a.map(e=>({id:e.id,name:e.name,predecessors:e.predecessors,successors:e.successors})),null,2)),console.log("\ud83c\udd95 NUEVA FUNCI\xd3N - Estado actualizado correctamente"),a})},[]),(0,a.useCallback)(function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"FS";console.warn("\ud83d\udea8 updateSuccessors INICIADO:",{taskId:e,successorsString:t,dependencyType:r}),console.error("\ud83d\udea8 updateSuccessors INICIADO:",{taskId:e,successorsString:t,dependencyType:r});const a=t.split(",").map(e=>e.trim()).filter(t=>t&&t!==e);console.log("\ud83d\udd04 Sucesoras procesadas:",a);for(const s of a)if(et(e,s))return console.error("\u274c DEPENDENCIA CIRCULAR DETECTADA:",{taskId:e,succId:s}),void alert("\u274c No se puede crear la dependencia: se detectar\xeda una dependencia circular entre ".concat(e," y ").concat(s));l(t=>{console.log("\ud83d\udd04 Estado anterior de tareas:",t.map(e=>({id:e.id,name:e.name,predecessors:e.predecessors,successors:e.successors})));const r=new Map(t.map(e=>[e.id,new Set(e.predecessors)]));for(const[,a]of r)a.delete(e);for(const i of a){var s;null===(s=r.get(i))||void 0===s||s.add(e)}const n=t.map(t=>({id:t.id,wbsCode:t.wbsCode,name:t.name,duration:t.duration,startDate:t.startDate,endDate:t.endDate,progress:t.progress,predecessors:Array.from(r.get(t.id)||[]),cost:t.cost,priority:t.priority,assignedTo:t.assignedTo,isMilestone:t.isMilestone,isCritical:t.isCritical,originalDuration:t.originalDuration,earlyStart:t.earlyStart,earlyFinish:t.earlyFinish,lateStart:t.lateStart,lateFinish:t.lateFinish,totalFloat:t.totalFloat,freeFloat:t.freeFloat,description:t.description,resources:[...t.resources||[]],workPackageId:t.workPackageId,status:t.status,successors:t.id===e?a:t.successors}));return console.log("\ud83d\udd04 Estado actualizado de tareas:",n.map(e=>({id:e.id,name:e.name,predecessors:e.predecessors,successors:e.successors}))),n}),console.warn("\ud83d\udea8 updateSuccessors COMPLETADO"),console.error("\ud83d\udea8 updateSuccessors COMPLETADO")},[et]);const rt=(0,a.useCallback)(function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"FS";console.warn("\ud83d\udea8 updatePredecessors INICIADO:",{taskId:e,predecessorsString:t,dependencyType:r}),console.error("\ud83d\udea8 updatePredecessors INICIADO:",{taskId:e,predecessorsString:t,dependencyType:r});const a=t.split(",").map(e=>e.trim()).filter(t=>t&&t!==e);console.log("\ud83d\udd04 Predecesoras procesadas:",a);for(const s of a){const t=st(e,s);if(!t.valid)return console.error("\u274c VALIDACI\xd3N FALLIDA:",{taskId:e,predId:s,error:t.error}),void alert(t.error)}l(t=>{console.log("\ud83d\udd04 Estado anterior de tareas:",t.map(e=>({id:e.id,name:e.name,predecessors:e.predecessors,successors:e.successors})));const s=t.map(t=>t.id===e?{id:t.id,wbsCode:t.wbsCode,name:t.name,duration:t.duration,startDate:t.startDate,endDate:t.endDate,progress:t.progress,predecessors:a,cost:t.cost,priority:t.priority,assignedTo:t.assignedTo,isMilestone:t.isMilestone,isCritical:t.isCritical,originalDuration:t.originalDuration,earlyStart:t.earlyStart,earlyFinish:t.earlyFinish,lateStart:t.lateStart,lateFinish:t.lateFinish,totalFloat:t.totalFloat,freeFloat:t.freeFloat,description:t.description,resources:[...t.resources||[]],workPackageId:t.workPackageId,status:t.status,successors:[...t.successors||[]],dependencyType:r}:a.includes(t.id)&&!t.successors.includes(e)?{id:t.id,wbsCode:t.wbsCode,name:t.name,duration:t.duration,startDate:t.startDate,endDate:t.endDate,progress:t.progress,predecessors:[...t.predecessors||[]],cost:t.cost,priority:t.priority,assignedTo:t.assignedTo,isMilestone:t.isMilestone,isCritical:t.isCritical,originalDuration:t.originalDuration,earlyStart:t.earlyStart,earlyFinish:t.earlyFinish,lateStart:t.lateStart,lateFinish:t.lateFinish,totalFloat:t.totalFloat,freeFloat:t.freeFloat,description:t.description,resources:[...t.resources||[]],workPackageId:t.workPackageId,status:t.status,successors:t.successors.slice().concat([e])}:t);if(console.log("\ud83d\udd04 Estado actualizado de tareas:",s.map(e=>({id:e.id,name:e.name,predecessors:e.predecessors,successors:e.successors,dependencyType:e.dependencyType}))),g&&g.id===e){const t=s.find(t=>t.id===e);t&&x(t)}return s})},[et,g]),at=((0,a.useCallback)(e=>{const t=e.target.value;console.log("\ud83d\udd24 CAMPO NOMBRE - handleNameChange:",{valorAnterior:b,valorNuevo:t,taskId:null===g||void 0===g?void 0:g.id}),v(t)},[b,null===g||void 0===g?void 0:g.id]),(0,a.useCallback)(()=>{g&&b!==g.name&&(console.log("\ud83d\udd24 CAMPO NOMBRE - handleNameBlur - Guardando:",{valorAnterior:g.name,valorNuevo:b,taskId:g.id}),Qe(g.id,"name",b))},[g,b,Qe]),(0,a.useCallback)(()=>{g&&(console.log("\ud83d\udd24 CAMPO NOMBRE - handleNameFocus - Restaurando:",{valor:g.name,taskId:g.id}),v(g.name))},[g]),(0,a.useCallback)(e=>{const t=[],r=[];for(const a of e)if(a.predecessors&&0!==a.predecessors.length)for(const s of a.predecessors){let n=e.find(e=>e.id===s);if(!n&&!isNaN(s)){const t=parseInt(s);t>0&&t<=e.length&&(n=e[t-1])}if(!n){t.push('\u274c Tarea "'.concat(a.name,'": La predecesora "').concat(s,'" no existe'));continue}if(a.id===s||a===n){t.push('\u274c Tarea "'.concat(a.name,'": No puede ser predecesora de s\xed misma'));continue}if(et(a.id,n.id)){t.push('\u274c Tarea "'.concat(a.name,'": Dependencia circular con "').concat(n.name,'"'));continue}const i=new Date(a.startDate);new Date(n.endDate)>i&&r.push('\u26a0\ufe0f Tarea "'.concat(a.name,'": La predecesora "').concat(n.name,'" termina despu\xe9s de que inicia la tarea actual'))}return{errors:t,warnings:r}},[et])),st=(0,a.useCallback)((e,t)=>{const r=o.find(e=>e.id===t);if(!r)return{valid:!1,error:"\u274c La tarea predecesora ".concat(t," no existe")};if(e===t)return{valid:!1,error:"\u274c Una tarea no puede ser predecesora de s\xed misma"};const a=o.find(t=>t.id===e);if(a&&r){const e=new Date(a.startDate);if(new Date(r.endDate)>e)return{valid:!1,error:"\u274c La tarea predecesora termina despu\xe9s de que inicia la tarea actual"}}return et(e,t)?{valid:!1,error:"\u274c Se detectar\xeda una dependencia circular entre ".concat(e," y ").concat(t)}:{valid:!0,error:null}},[o,et]);(0,a.useCallback)(e=>{console.log("\ud83d\udd17 SELECT PREDECESORA - EVENTO CAPTURADO:",{event:e,type:e.type,target:e.target,value:e.target.value,selectedTask:null===g||void 0===g?void 0:g.id});const t=e.target.value;if(C(t),t&&g&&!g.predecessors.includes(t)){var r;const e=st(g.id,t);if(!e.valid)return alert(e.error),void(P.current&&(P.current.value=""));const a=[...g.predecessors||[],t],s=(null===(r=document.getElementById("newDependencyType"))||void 0===r?void 0:r.value)||"FS";console.log("\ud83d\udd04 Agregando predecesora desde select:",{tarea:g.id,nuevaPredecesora:t,predecesorasAntes:g.predecessors,predecesorasDespues:a,dependencyType:s}),console.log("\ud83d\udd04 ACTUALIZANDO selectedTask con nuevas predecesoras:",{tarea:g.id,predecesorasAntes:g.predecessors,predecesorasDespues:a,dependencyType:s});const n={id:g.id,wbsCode:g.wbsCode,name:g.name,duration:g.duration,startDate:g.startDate,endDate:g.endDate,progress:g.progress,predecessors:a,cost:g.cost,priority:g.priority,assignedTo:g.assignedTo,isMilestone:g.isMilestone,isCritical:g.isCritical,originalDuration:g.originalDuration,earlyStart:g.earlyStart,earlyFinish:g.earlyFinish,lateStart:g.lateStart,lateFinish:g.lateFinish,totalFloat:g.totalFloat,freeFloat:g.freeFloat,description:g.description,resources:[...g.resources||[]],workPackageId:g.workPackageId,status:g.status,successors:[...g.successors||[]]};console.warn("\ud83d\udea8 ACTUALIZANDO selectedTask:",{antes:g.predecessors,despues:n.predecessors,count:n.predecessors.length}),l(e=>{console.log("\ud83d\udd0d SETTASKS #2 - ACTUALIZANDO ESTADO GLOBAL:",g.id);const t=e.map(e=>e.id===g.id?n:e),r=t.find(e=>e.id===g.id);return r&&x(r),t}),P.current&&(P.current.value="")}},[g,et,rt]);(0,a.useEffect)(()=>{const e=document.getElementById("newSuccessor");if(e){const t=e=>{console.log("\ud83c\udfaf EVENT LISTENER DIRECTO - SUCESORA:",e.target.value,"TIPO:",e.type);const t=e.target.value;if(t&&""!==t.trim()&&"Seleccionar tarea sucesora..."!==t){console.log("\ud83c\udfaf PROCESANDO SUCESORA V\xc1LIDA DIRECTO:",t);let e=g;if(!e){var r;const a=null===(r=document.querySelector("[data-task-id]"))||void 0===r?void 0:r.getAttribute("data-task-id");e=a?o.find(e=>e.id===a):o.find(e=>e.id&&e.id!==t)}if(e&&!e.successors.includes(t)){const r=e.successors.slice().concat([t]);console.log("\ud83c\udfaf Agregando sucesora desde event listener directo:",{tarea:e.id,nuevaSucesora:t,sucesorasAntes:e.successors,sucesorasDespues:r});const a={id:e.id,wbsCode:e.wbsCode,name:e.name,duration:e.duration,startDate:e.startDate,endDate:e.endDate,progress:e.progress,predecessors:[...e.predecessors||[]],cost:e.cost,priority:e.priority,assignedTo:e.assignedTo,isMilestone:e.isMilestone,isCritical:e.isCritical,originalDuration:e.originalDuration,earlyStart:e.earlyStart,earlyFinish:e.earlyFinish,lateStart:e.lateStart,lateFinish:e.lateFinish,totalFloat:e.totalFloat,freeFloat:e.freeFloat,description:e.description,resources:[...e.resources||[]],workPackageId:e.workPackageId,status:e.status,successors:r};x(a),console.log("\ud83c\udfaf SUCESORA AGREGADA A selectedTask (NO al estado global a\xfan)"),console.log("\ud83c\udfaf SUCESORA AGREGADA EXITOSAMENTE DESDE EVENT LISTENER DIRECTO")}}};return e.addEventListener("change",t),e.addEventListener("input",t),()=>{e.removeEventListener("change",t),e.removeEventListener("input",t)}}},[g,o]),(0,a.useEffect)(()=>{console.log("\ud83d\udd27 CONFIGURANDO EVENT DELEGATION GLOBAL");const e=e=>{if("includeWeekends"===e.target.id)return void console.log("\ud83d\udd0d CHECKBOX includeWeekends detectado - NO procesando en event listener global");if("file"===e.target.type)return void console.log("\ud83d\udd0d INPUT FILE detectado - NO procesando en event listener global");const t={timestamp:(new Date).toISOString(),type:e.type,id:e.target.id,value:e.target.value,tagName:e.target.tagName};if(console.log("\ud83d\udd0d EVENTO GLOBAL CAPTURADO:",t),console.log("\ud83d\udd0d LLEGAMOS A LA FUNCI\xd3N GLOBAL - ID:",e.target.id),console.log("\ud83d\udd0d DEPENDENCY_EVENT:",JSON.stringify(t)),console.log("\ud83d\udd0d PROCESANDO EVENTO GLOBAL - ID:",e.target.id,"TIPO:",e.type,"VALOR:",e.target.value),"newPredecessor"===e.target.id){var r;console.log("\ud83d\udd0d PREDECESORA SELECCIONADA VIA DELEGATION:",e.target.value);const t=e.target.value;if(console.warn("\ud83d\udea8 VERIFICANDO CONDICIONES:",{taskId:t,selectedTask:null===g||void 0===g?void 0:g.id,predecessors:null===g||void 0===g?void 0:g.predecessors,includes:null===g||void 0===g||null===(r=g.predecessors)||void 0===r?void 0:r.includes(t)}),t&&g&&!g.predecessors.includes(t)){var a;if(et(g.id,t))return alert("\u274c No se puede crear la dependencia: se detectar\xeda una dependencia circular entre ".concat(g.id," y ").concat(t)),void(e.target.value="");const r=[...g.predecessors||[],t],s=(null===(a=document.getElementById("newDependencyType"))||void 0===a?void 0:a.value)||"FS";console.log("\ud83d\udd04 Agregando predecesora desde delegation:",{tarea:g.id,nuevaPredecesora:t,predecesorasAntes:g.predecessors,predecesorasDespues:r,dependencyType:s}),console.warn("\ud83d\udea8 LLAMANDO updatePredecessors:",{taskId:g.id,predecessors:r.join(","),dependencyType:s});const n={id:g.id,wbsCode:g.wbsCode,name:g.name,duration:g.duration,startDate:g.startDate,endDate:g.endDate,progress:g.progress,predecessors:r,cost:g.cost,priority:g.priority,assignedTo:g.assignedTo,isMilestone:g.isMilestone,isCritical:g.isCritical,originalDuration:g.originalDuration,earlyStart:g.earlyStart,earlyFinish:g.earlyFinish,lateStart:g.lateStart,lateFinish:g.lateFinish,totalFloat:g.totalFloat,freeFloat:g.freeFloat,description:g.description,resources:[...g.resources||[]],workPackageId:g.workPackageId,status:g.status,successors:[...g.successors||[]]};x(n),console.log("\ud83c\udfaf PREDECESORA AGREGADA A selectedTask (NO al estado global a\xfan)"),console.warn("\ud83d\udea8 updatePredecessors COMPLETADO"),e.target.value=""}}else if("newSuccessor"===e.target.id){var s;if(console.warn("\ud83d\udea8 DETECTADO SELECT DE SUCESORA:",e.target.value,"TIPO EVENTO:",e.type),"change"===e.type&&(!e.target.value||""===e.target.value.trim()))return void console.log("\ud83d\udea8 IGNORANDO EVENTO CHANGE VAC\xcdO:",e.type,"para newSuccessor");if("input"!==e.type&&"change"!==e.type)return void console.log("\ud83d\udea8 IGNORANDO EVENTO:",e.type,"para newSuccessor");console.log("\ud83d\udd0d SUCESORA SELECCIONADA VIA DELEGATION:",e.target.value),console.log("\ud83d\udea8 EVENTO SUCESORA CAPTURADO - timestamp:",(new Date).toISOString()),console.log("\ud83d\udea8 VALOR DEL SELECT:",e.target.value,"TIPO:",typeof e.target.value,"LONGITUD:",null===(s=e.target.value)||void 0===s?void 0:s.length),console.log("\ud83d\udea8 OPCIONES DEL SELECT:",Array.from(e.target.options).map(e=>({value:e.value,text:e.text,selected:e.selected})));const t=e.target.value;if(console.log("\ud83d\udea8 VALOR ACTUAL INMEDIATO:",t),t&&""!==t.trim()&&"Seleccionar tarea sucesora..."!==t){var n;if("true"===e.target.dataset.processing)return void console.log("\ud83d\udea8 YA SE EST\xc1 PROCESANDO ESTA SUCESORA, IGNORANDO");e.target.dataset.processing="true",console.log("\ud83d\udea8 PROCESANDO SUCESORA V\xc1LIDA:",t);const r=t;console.warn("\ud83d\udea8 VERIFICANDO CONDICIONES SUCESORA:",{taskId:r,selectedTask:null===g||void 0===g?void 0:g.id,successors:null===g||void 0===g?void 0:g.successors,includes:null===g||void 0===g||null===(n=g.successors)||void 0===n?void 0:n.includes(r)});let a=g;if(!a){var i;console.warn("\ud83d\udea8 selectedTask es undefined, obteniendo del estado global...");const e=null===(i=document.querySelector("[data-task-id]"))||void 0===i?void 0:i.getAttribute("data-task-id");var c;if(e)a=o.find(t=>t.id===e),console.warn("\ud83d\udea8 selectedTask recuperado por modal ID:",e);else a=o.find(e=>e.id&&e.id!==r),console.warn("\ud83d\udea8 selectedTask recuperado por fallback:",null===(c=a)||void 0===c?void 0:c.id)}if(!a&&o.length>0&&(a=o[0],console.warn("\ud83d\udea8 selectedTask recuperado por primera tarea disponible:",a.id)),a||(console.warn("\ud83d\udea8 selectedTask no encontrado, creando uno temporal..."),a={id:crypto.randomUUID(),name:"Tarea Temporal",successors:[],predecessors:[]},console.warn("\ud83d\udea8 selectedTask temporal creado:",a.id)),a.successors||(a.successors=[],console.warn("\ud83d\udea8 currentSelectedTask.successors inicializado como array vac\xedo")),a.predecessors||(a.predecessors=[],console.warn("\ud83d\udea8 currentSelectedTask.predecessors inicializado como array vac\xedo")),a.id||(a.id=crypto.randomUUID(),console.warn("\ud83d\udea8 currentSelectedTask.id inicializado como:",a.id)),a.name||(a.name="Tarea Temporal",console.warn("\ud83d\udea8 currentSelectedTask.name inicializado como:",a.name)),r&&a&&!a.successors.includes(r)){const e=a.successors.slice().concat([r]);console.log("\ud83d\udd04 Agregando sucesora desde delegation:",{tarea:a.id,nuevaSucesora:r,sucesorasAntes:a.successors,sucesorasDespues:e});const t={id:a.id,wbsCode:a.wbsCode,name:a.name,duration:a.duration,startDate:a.startDate,endDate:a.endDate,progress:a.progress,predecessors:[...a.predecessors||[]],cost:a.cost,priority:a.priority,assignedTo:a.assignedTo,isMilestone:a.isMilestone,isCritical:a.isCritical,originalDuration:a.originalDuration,earlyStart:a.earlyStart,earlyFinish:a.earlyFinish,lateStart:a.lateStart,lateFinish:a.lateFinish,totalFloat:a.totalFloat,freeFloat:a.freeFloat,description:a.description,resources:[...a.resources||[]],workPackageId:a.workPackageId,status:a.status,successors:e};l(e=>{const s=e.map(e=>e.id===a.id?t:e.id===r?{id:e.id,wbsCode:e.wbsCode,name:e.name,duration:e.duration,startDate:e.startDate,endDate:e.endDate,progress:e.progress,predecessors:[...e.predecessors||[],a.id],cost:e.cost,priority:e.priority,assignedTo:e.assignedTo,isMilestone:e.isMilestone,isCritical:e.isCritical,originalDuration:e.originalDuration,earlyStart:e.earlyStart,earlyFinish:e.earlyFinish,lateStart:e.lateStart,lateFinish:e.lateFinish,totalFloat:e.totalFloat,freeFloat:e.freeFloat,description:e.description,resources:[...e.resources||[]],workPackageId:e.workPackageId,status:e.status,successors:[...e.successors||[]]}:e),n=s.find(e=>e.id===a.id);return n&&x(n),s}),console.log("\ud83d\udea8 SUCESORA AGREGADA EXITOSAMENTE - timestamp:",(new Date).toISOString())}else{var d,u;console.warn("\ud83d\udea8 CONDICIONES NO CUMPLIDAS PARA SUCESORA:",{taskId:!!r,currentSelectedTask:!!a,notIncluded:!(null!==(d=a)&&void 0!==d&&null!==(u=d.successors)&&void 0!==u&&u.includes(r))})}e.target.dataset.processing="false"}else console.warn("\ud83d\udea8 VALOR VAC\xcdO O INV\xc1LIDO:",t)}};return document.addEventListener("change",e),document.addEventListener("input",e),document.addEventListener("click",e),console.log("\ud83d\udd27 EVENT LISTENERS AGREGADOS AL DOCUMENTO"),()=>{document.removeEventListener("change",e),document.removeEventListener("input",e)}},[g,et,rt]);(0,a.useCallback)((e,t)=>{console.log("updateBusinessCase called:",e,t)},[]);const nt=(0,a.useCallback)(()=>{const e=Ve.map(e=>{var t;return{ID:e.id,WBS:e.wbsCode,Name:e.name,Duration:e.duration,StartDate:e.startDate,EndDate:e.endDate,Progress:e.progress,Predecessors:(null===(t=e.predecessors)||void 0===t?void 0:t.join(", "))||"",Resources:e.resources.join(", "),Cost:e.cost,IsMilestone:e.isMilestone,IsCritical:e.isCritical,Status:e.status,EarlyStart:e.earlyStart,EarlyFinish:e.earlyFinish,LateStart:e.lateStart,LateFinish:e.lateFinish,TotalFloat:e.totalFloat,FreeFloat:e.freeFloat}}),t=Ew.json_to_sheet(e),r=Ew.book_new();Ew.book_append_sheet(r,t,"Cronograma");const a=[["Campo","Valor"],["Nombre del Proyecto",p.projectName],["Objetivo",p.objective],["Patrocinador",p.sponsor],["Gerente del Proyecto",p.manager],["Inversi\xf3n Total",p.totalInvestment],["Beneficios Esperados",p.expectedBenefits],["TIR (%)",p.irr],["ROI (%)",p.roi],["Tiempo de Retorno (a\xf1os)",p.paybackPeriod],["VPN",p.npv]],s=Ew.aoa_to_sheet(a);Ew.book_append_sheet(r,s,"Caso de Negocio"),mw(r,"".concat(d.projectName,"-").concat((new Date).toISOString().split("T")[0],".xlsx"))},[Ve,d]),it=(0,a.useCallback)(()=>{const e=Ew.book_new(),t=[["#","Tarea","Duraci\xf3n","Inicio","Fin","Progreso (%)","Prioridad","Asignado","Costo","Predecesoras","Hito","Cr\xedtica","Ruta Cr\xedtica"]];Ve.forEach((e,r)=>{var a;t.push([r+1,e.name,"".concat(e.duration,"d"),e.startDate,e.endDate,e.progress||0,e.priority||"Media",e.assignedTo||"Sin asignar",e.cost||0,(null===(a=e.predecessors)||void 0===a?void 0:a.join(", "))||"Sin",e.isMilestone?"S\xed":"No",e.isCritical?"S\xed":"No",e.isCritical?"S\xed":"No"])});const r=Ew.aoa_to_sheet(t);r["!cols"]=[{wch:5},{wch:40},{wch:10},{wch:12},{wch:12},{wch:12},{wch:12},{wch:20},{wch:12},{wch:30},{wch:8},{wch:8},{wch:12}],Ew.book_append_sheet(e,r,"Cronograma");const a=[["INFORMACI\xd3N DEL PROYECTO"],["Nombre del Proyecto",d.projectName],["Fecha de Inicio",d.startDate],["Fecha de Fin",d.endDate],["Presupuesto Total",d.totalBudget],[""],["ESTAD\xcdSTICAS DEL CRONOGRAMA"],["Total de Tareas",Ve.length],["Tareas Cr\xedticas",Ve.filter(e=>e.isCritical).length],["Hitos",Ve.filter(e=>e.isMilestone).length],["Duraci\xf3n Total (d\xedas)",Math.max(...Ve.map(e=>new Date(e.endDate).getTime()))-Math.min(...Ve.map(e=>new Date(e.startDate).getTime()))/864e5],[""],["FECHA DE EXPORTACI\xd3N"],["Exportado el",(new Date).toLocaleString("es-ES")]],s=Ew.aoa_to_sheet(a);s["!cols"]=[{wch:25},{wch:30}],Ew.book_append_sheet(e,s,"Resumen"),mw(e,"Cronograma-".concat(d.projectName,"-").concat((new Date).toISOString().split("T")[0],".xlsx"))},[Ve,d]),ot=((0,a.useCallback)(e=>{var t;const r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!r)return;const a=new FileReader;a.onload=e=>{try{const s=JSON.parse(e.target.result);var t,r,a;if(s.tasks&&l(s.tasks),s.baseline&&B(s.baseline),s.settings)w(s.settings.viewMode||"excel"),O(s.settings.ganttScale||"days"),M(null===(t=s.settings.showCriticalPath)||void 0===t||t),L(null===(r=s.settings.showDependencies)||void 0===r||r),W(null!==(a=s.settings.showBaseline)&&void 0!==a&&a);alert("Proyecto cargado exitosamente")}catch(s){alert("Error al cargar el proyecto. Verifica el formato del archivo.")}},a.readAsText(r)},[]),(0,a.useMemo)(()=>{var e,t;if(0===o.length)return{start:new Date,end:new Date};const r=o.flatMap(e=>[new Date(e.startDate),new Date(e.endDate)]),a={start:new Date(Math.min(...r.map(e=>e.getTime()))),end:new Date(Math.max(...r.map(e=>e.getTime())))};return console.log("\ud83d\udcc5 PROJECT DATES CALCULADO (FECHAS ORIGINALES):",{start:Cj(a.start),end:Cj(a.end),totalTasks:o.length,firstTaskDate:null===(e=o[0])||void 0===e?void 0:e.startDate,lastTaskDate:null===(t=o[o.length-1])||void 0===t?void 0:t.endDate,allStartDates:o.map(e=>e.startDate),minStartDate:Math.min(...o.map(e=>new Date(e.startDate).getTime())),minStartDateISO:Cj(new Date(Math.min(...o.map(e=>new Date(e.startDate).getTime()))))}),a},[o])),lt=(0,a.useMemo)(()=>{const e=Cj(ot.start),t=Cj(ot.end);return Math.max(1,Ij(e,Dj(t,1,h),h))},[ot]),ct=(0,a.useMemo)(()=>{switch(I){case"days":return 28;case"weeks":return 10;case"months":return 4;default:return 20}},[I]),dt=(0,a.useMemo)(()=>lt*ct,[lt,ct]),ut=(0,a.useMemo)(()=>{const e=Ve.filter(e=>e.isCritical).length,t=Ve.filter(e=>100===e.progress).length,r=Ve.reduce((e,t)=>e+t.cost,0),a=Cj(new Date),s=Ve.reduce((e,t)=>{const r=Math.max(1,Mj(t.startDate,t.endDate,h)),s=(n=Ij(t.startDate,a,h)/r,Math.min(1,Math.max(0,n)));var n;return e+t.cost*s},0),n=Ve.reduce((e,t)=>e+t.cost*(t.progress/100),0),i=s>0?n/s:1,o=n>0?n/n:1,l=Ve.length>0?t/Ve.length*100:0,c=r,u=d.totalBudget>0?r/d.totalBudget*100:0;return{totalTasks:Ve.length,criticalTasks:e,completedTasks:t,totalCost:r,earnedValue:Math.round(n),plannedValue:Math.round(s),spi:i.toFixed(2),cpi:o.toFixed(2),progressPercentage:l.toFixed(1),investmentToDate:c,projectedROI:u.toFixed(1)}},[Ve,d]),[ht,ft]=(0,a.useState)(!1),[mt,pt]=(0,a.useState)({name:"",duration:5,startDate:Cj(new Date),endDate:Dj(Cj(new Date),5),description:"",priority:"medium",assignedTo:"",cost:0,selectedPredecessors:[]}),gt=e=>{console.log("\ud83d\udcca FALLBACK: Intentando con FileReader...");const t=new FileReader;t.onload=e=>{try{console.log("\ud83d\udcca FileReader fallback: datos recibidos");const t=new Uint8Array(e.target.result);if(console.log("\ud83d\udcca Datos convertidos a Uint8Array, tama\xf1o:",t.length),0===t.length)throw new Error("El archivo est\xe1 vac\xedo");const r=ow(t,{type:"array"});console.log("\ud83d\udcca Workbook creado exitosamente en fallback"),xt(r)}catch(t){console.error("\u274c Error procesando en fallback:",t),alert("\u274c No se pudo procesar el archivo Excel. Verifica que el archivo no est\xe9 corrupto y que sea un formato v\xe1lido (.xlsx o .xls).")}},t.onerror=e=>{var t;console.error("\u274c Error en FileReader fallback:",e),console.error("\u274c Detalles del error fallback:",null===(t=e.target)||void 0===t?void 0:t.error),alert("\u274c No se pudo leer el archivo con ning\xfan m\xe9todo. Por favor intenta con otro archivo o verifica que no est\xe9 corrupto.")},t.readAsDataURL(e)},xt=e=>{try{console.log("\ud83d\udcca Procesando workbook, hojas disponibles:",e.SheetNames);const t=e.Sheets[e.SheetNames[0]],r=Ew.sheet_to_json(t,{header:1});if(console.log("\ud83d\udcca Datos convertidos a JSON, filas:",r.length),console.log("\ud83d\udcca Datos Excel importados:",r),r.length<2)return void alert("El archivo Excel debe tener al menos una fila de encabezados y una fila de datos");const a=r[0];console.log("\ud83d\udcca Encabezados encontrados:",a);const s={nombre:a.findIndex(e=>e&&e.toString().toLowerCase().includes("nombre")),duracion:a.findIndex(e=>e&&e.toString().toLowerCase().includes("duraci")),inicio:a.findIndex(e=>e&&e.toString().toLowerCase().includes("inicio")),fin:a.findIndex(e=>e&&e.toString().toLowerCase().includes("fin")),progreso:a.findIndex(e=>e&&e.toString().toLowerCase().includes("progreso")),prioridad:a.findIndex(e=>e&&e.toString().toLowerCase().includes("prioridad")),asignado:a.findIndex(e=>e&&e.toString().toLowerCase().includes("asignado")),costo:a.findIndex(e=>e&&e.toString().toLowerCase().includes("costo")),predecesoras:a.findIndex(e=>e&&e.toString().toLowerCase().includes("predecesor")),hitos:a.findIndex(e=>e&&e.toString().toLowerCase().includes("hito"))};console.log("\ud83d\udcca Mapeo de columnas:",s);const n=[];(new Date).toISOString();for(let e=1;e<r.length;e++){const t=r[e];if(!t||t.every(e=>!e))continue;const a=parseInt(t[s.duracion])||5;let i=0===a;if(-1!==s.hitos&&t[s.hitos]){const e=t[s.hitos].toString().toLowerCase().trim();i="s\xed"===e||"si"===e||"yes"===e||"1"===e||"true"===e}const o=e=>{if(!e)return(new Date).toISOString().split("T")[0];if("number"===typeof e)try{return ld.parse_date_code(e)}catch(t){return console.warn("Error parsing date code:",e,t),(new Date).toISOString().split("T")[0]}try{const t=new Date(e);return isNaN(t.getTime())?(console.warn("Invalid date value:",e),(new Date).toISOString().split("T")[0]):t.toISOString().split("T")[0]}catch(t){return console.warn("Error parsing date:",e,t),(new Date).toISOString().split("T")[0]}},l=o(t[s.inicio]),c=i?l:o(t[s.fin]),d=t[s.nombre]||"Tarea ".concat(e),u=Ej(d);if(!u.valid){console.error("\u274c Error en fila ".concat(e+1,": ").concat(u.error));continue}const f=Tj(a);if(!f.valid){console.error("\u274c Error en fila ".concat(e+1,": ").concat(f.error));continue}const m=_j(l);if(!m.valid){console.error("\u274c Error en fila ".concat(e+1,": ").concat(m.error));continue}const p={id:crypto.randomUUID(),wbsCode:"".concat(e),name:u.sanitized,duration:i?0:Math.max(1,Mj(l,c,h)),startDate:m.value,endDate:c,progress:Math.max(0,Math.min(100,parseInt(t[s.progreso])||0)),priority:Sj(t[s.prioridad]||"medium"),assignedTo:Sj(t[s.asignado]||""),cost:Math.max(0,parseFloat(t[s.costo])||0),predecessors:[],successors:[],isMilestone:i,originalDuration:i?1:a,description:"",resources:[],status:"pending"};if(t[s.predecesoras]){const r=t[s.predecesoras].toString();console.log("\ud83d\udd0d Procesando predecesoras para tarea ".concat(e,': "').concat(r,'"'));const a=r.split(",").map(e=>e.trim()).filter(Boolean);console.log("\ud83d\udd0d Valores de predecesoras procesados: [".concat(a.join(", "),"]")),p.predecessors=a,console.log("\ud83d\udd0d Predecesoras finales: [".concat(p.predecessors.join(", "),"]"))}n.push(p)}if(console.log("\ud83d\udcca Tareas procesadas:",n),0===n.length)return void alert("No se encontraron tareas v\xe1lidas en el archivo Excel");console.log("\ud83d\udd0d Validando predecesoras del Excel...");const i=at(n);if(i.errors.length>0){const e="\u274c ERRORES ENCONTRADOS EN EL ARCHIVO EXCEL:\n\n".concat(i.errors.join("\n"));return void alert(e)}if(i.warnings.length>0){const e="\u26a0\ufe0f ADVERTENCIAS ENCONTRADAS:\n\n".concat(i.warnings.join("\n"),"\n\n\xbfDeseas continuar con la importaci\xf3n?");if(!window.confirm(e))return}console.log("\u2705 Validaci\xf3n de predecesoras completada exitosamente"),console.log("\ud83d\udcca IMPORTACI\xd3N - REEMPLAZANDO CRONOGRAMA COMPLETO"),console.log("\ud83d\udcca IMPORTACI\xd3N - Tareas anteriores:",(null===o||void 0===o?void 0:o.length)||0),console.log("\ud83d\udcca IMPORTACI\xd3N - Nuevas tareas:",n.length),console.log("\ud83d\udcca IMPORTACI\xd3N - Primeras 3 tareas nuevas:",n.slice(0,3)),console.log("\ud83d\udcca IMPORTACI\xd3N - importTasks es funci\xf3n?",typeof c);const d="\u26a0\ufe0f IMPORTACI\xd3N DE CRONOGRAMA COMPLETO\n\n"+"Tareas actuales: ".concat((null===o||void 0===o?void 0:o.length)||0,"\n")+"Nuevas tareas: ".concat(n.length,"\n\n")+"Esto REEMPLAZAR\xc1 COMPLETAMENTE el cronograma actual.\nLas tareas de minuta existentes podr\xedan quedar sin hito asignado.\n\n\xbfContinuar con la importaci\xf3n?";if(!window.confirm(d))return void console.log("\ud83d\udcca IMPORTACI\xd3N - Cancelada por el usuario");if("function"===typeof c)c(n),console.log("\ud83d\udcca IMPORTACI\xd3N - importTasks llamado exitosamente - CRONOGRAMA REEMPLAZADO");else{if(console.error("\u274c IMPORTACI\xd3N - importTasks no est\xe1 disponible, usando setTasks como fallback"),"function"!==typeof l)return console.error("\u274c IMPORTACI\xd3N - Ni importTasks ni setTasks est\xe1n disponibles"),void alert("Error: No se puede completar la importaci\xf3n. Las funciones de actualizaci\xf3n no est\xe1n disponibles.");l(n),console.log("\ud83d\udcca IMPORTACI\xd3N - setTasks llamado como fallback - CRONOGRAMA REEMPLAZADO")}const f=new CustomEvent("dataChange",{detail:{type:"schedule_imported",taskCount:n.length,timestamp:(new Date).toISOString()}});window.dispatchEvent(f);const m=n.map(e=>new Date(e.startDate)),p=n.map(e=>new Date(e.endDate)),g=new Date(Math.min(...m)),x=new Date(Math.max(...p));u&&u({tasks:n,projectStart:g.toISOString().split("T")[0],projectEnd:x.toISOString().split("T")[0],totalTasks:n.length,completedTasks:n.filter(e=>"completed"===e.status).length,totalCost:n.reduce((e,t)=>e+(t.cost||0),0)}),alert("\u2705 CRONOGRAMA REEMPLAZADO EXITOSAMENTE!\n\n\ud83d\udcca ".concat(n.length," tareas cargadas (cronograma anterior eliminado)\n\ud83d\udcc5 Proyecto: ").concat(g.toLocaleDateString("es")," - ").concat(x.toLocaleDateString("es"),"\n\n\u26a0\ufe0f Las tareas de minuta existentes podr\xedan necesitar reasignaci\xf3n de hitos."))}catch(t){console.error("\u274c Error al procesar workbook:",t),alert("Error al procesar el archivo Excel. Verifica que tenga el formato correcto.")}},vt=(e,t,r)=>{if(N({taskId:e,field:t}),"startDate"===t||"endDate"===t)if(r)if(r.match(/^\d{4}-\d{2}-\d{2}$/))S(r);else{const e=r.split("/");if(3===e.length){const t=e[0].padStart(2,"0"),r=e[1].padStart(2,"0"),a=e[2];S("".concat(a,"-").concat(r,"-").concat(t))}else S(r)}else S("");else S(r)},yt=()=>{J(!0)},wt=e=>{re(e),se(!0)};(0,a.useEffect)(()=>{(async()=>{if(m&&null!==d&&void 0!==d&&d.id)try{var e;console.log("\ud83d\udd0d DEBUG - Inicializando servicio de IA:",{projectId:d.id,organizationId:d.organizationId,organizationIdType:typeof d.organizationId,hasOrganizationId:!!d.organizationId,currentUser:null===(e=Nt.default.currentUser)||void 0===e?void 0:e.email}),await wj.initialize(Nt.default.supabase,d.organizationId,Nt.default.currentUser),console.log("\ud83e\udd16 Servicio de IA inicializado para proyecto:",d.id)}catch(t){console.error("\u274c Error inicializando servicio de IA:",t)}else console.log("\u26a0\ufe0f No se puede inicializar servicio de IA:",{useSupabase:m,hasProjectId:!(null===d||void 0===d||!d.id),projectData:d})})()},[m,null===d||void 0===d?void 0:d.id,null===d||void 0===d?void 0:d.organizationId]);const jt=()=>{if(!j)return;const{taskId:e,field:t}=j,r=k;if(console.log("\ud83d\udcbe SAVEEDIT - INICIANDO:",{taskId:e,field:t,newValue:r,tasksLength:o?o.length:"UNDEFINED"}),"dependencies"===t)return void Et();l(a=>(console.log("\ud83d\udcbe SAVEEDIT - Estado ANTES de actualizar:",{prevLength:a?a.length:"UNDEFINED",prevTasks:a?a.map(e=>({id:e.id,name:e.name})):"UNDEFINED"}),a.map(a=>{if(a.id===e){const e={id:a.id,wbsCode:a.wbsCode,name:a.name,duration:a.duration,startDate:a.startDate,endDate:a.endDate,progress:a.progress,predecessors:[...a.predecessors||[]],cost:a.cost,priority:a.priority,assignedTo:a.assignedTo,isMilestone:a.isMilestone,isCritical:a.isCritical,originalDuration:a.originalDuration,earlyStart:a.earlyStart,earlyFinish:a.earlyFinish,lateStart:a.lateStart,lateFinish:a.lateFinish,totalFloat:a.totalFloat,freeFloat:a.freeFloat,description:a.description,resources:[...a.resources||[]],workPackageId:a.workPackageId,status:a.status,successors:[...a.successors||[]]};switch(t){case"name":e.name=r;break;case"duration":const t=parseInt(r)||1;if(e.duration=t,e.isMilestone)e.endDate=e.startDate;else if(h){const r=new Date(e.startDate);r.setDate(r.getDate()+t-1),e.endDate=Cj(r)}else e.endDate=Dj(e.startDate,t,h);break;case"startDate":if(e.startDate=r,e.isMilestone)e.endDate=r;else if(h){const t=new Date(r);t.setDate(t.getDate()+e.duration-1),e.endDate=Cj(t)}else e.endDate=Dj(r,e.duration,h);break;case"endDate":e.endDate=r;break;case"progress":e.progress=Math.max(0,Math.min(100,parseInt(r)||0));break;case"priority":e.priority=r;break;case"assignedTo":e.assignedTo=r;break;case"cost":e.cost=parseFloat(r)||0}return e}return a})));const a=new CustomEvent("dataChange",{detail:{type:"taskUpdated",taskId:e,field:t,newValue:r,timestamp:(new Date).toISOString()}});window.dispatchEvent(a),console.log("\ud83d\udcbe SAVEEDIT - COMPLETADO"),N(null),S("")},kt=()=>{N(null),S("")},St=e=>{j&&("Enter"===e.key?(e.preventDefault(),jt()):"Escape"===e.key&&(e.preventDefault(),kt()))},Et=()=>{if(!j||"dependencies"!==j.field)return;const{taskId:e}=j;try{const t=k.split(",").map(e=>parseInt(e.trim())).filter(e=>!isNaN(e)&&e>0&&e<=o.length).map(e=>{var t;return null===(t=o[e-1])||void 0===t?void 0:t.id}).filter(e=>e);l(r=>r.map(r=>{if(r.id===e){const a={id:r.id,wbsCode:r.wbsCode,name:r.name,duration:r.duration,startDate:r.startDate,endDate:r.endDate,progress:r.progress,predecessors:[...r.predecessors||[]],cost:r.cost,priority:r.priority,assignedTo:r.assignedTo,isMilestone:r.isMilestone,isCritical:r.isCritical,originalDuration:r.originalDuration,earlyStart:r.earlyStart,earlyFinish:r.earlyFinish,lateStart:r.lateStart,lateFinish:r.lateFinish,totalFloat:r.totalFloat,freeFloat:r.freeFloat,description:r.description,resources:[...r.resources||[]],workPackageId:r.workPackageId,status:r.status,successors:[...r.successors||[]]};return a.predecessors=t,a.successors=[],((e,t)=>{l(r=>r.map(r=>{if(r.id===e)return{id:r.id,wbsCode:r.wbsCode,name:r.name,duration:r.duration,startDate:r.startDate,endDate:r.endDate,progress:r.progress,predecessors:[...t||[]],cost:r.cost,priority:r.priority,assignedTo:r.assignedTo,isMilestone:r.isMilestone,isCritical:r.isCritical,originalDuration:r.originalDuration,earlyStart:r.earlyStart,earlyFinish:r.earlyFinish,lateStart:r.lateStart,lateFinish:r.lateFinish,totalFloat:r.totalFloat,freeFloat:r.freeFloat,description:r.description,resources:[...r.resources||[]],workPackageId:r.workPackageId,status:r.status,successors:[]};let a={id:r.id,wbsCode:r.wbsCode,name:r.name,duration:r.duration,startDate:r.startDate,endDate:r.endDate,progress:r.progress,predecessors:[...r.predecessors||[]],cost:r.cost,priority:r.priority,assignedTo:r.assignedTo,isMilestone:r.isMilestone,isCritical:r.isCritical,originalDuration:r.originalDuration,earlyStart:r.earlyStart,earlyFinish:r.earlyFinish,lateStart:r.lateStart,lateFinish:r.lateFinish,totalFloat:r.totalFloat,freeFloat:r.freeFloat,description:r.description,resources:[...r.resources||[]],workPackageId:r.workPackageId,status:r.status,successors:[...r.successors||[]]};return t.includes(r.id)?a.successors.includes(e)||(a.successors=a.successors.slice().concat([e])):a.successors=a.successors.filter(t=>t!==e),a}))})(e,t),a}return r})),N(null),S("")}catch(t){console.error("Error al guardar dependencias:",t),N(null),S("")}},Tt=(0,a.useMemo)(()=>{const e=Cj(ot.start),t=e;return console.log("\ud83c\udfaf TIMELINE REFERENCE DATE CALCULADO (CORREGIDO):",{originalProjectStart:e,includeWeekends:h,referenceDate:t,isShifted:e!==t,shiftDays:e!==t?Math.round((new Date(t)-new Date(e))/864e5):0,note:"Usando fecha original sin aplicar findFirstWorkingDay para alineaci\xf3n perfecta con tabla"}),t},[ot.start,h]),_t=(0,a.useMemo)(()=>{const e=Cj(new Date),t=Oj(e,Tt,h);return Math.min(Math.max(0,t*ct),dt)},[Tt,ct,dt,h]),Ct=()=>{const e=Tt;return console.log("\ud83c\udfaf GANTT BARS REFERENCIA:",{pStart:e,projectDatesStart:Cj(ot.start),includeWeekends:h,pxPerDay:ct}),Ve.map(t=>{const r=t.startDate,a=t.endDate,s=Oj(r,e,!0),n=Oj(a,r,!0)+1;if(t.name.includes("Aprobaci\xf3n")||t.name.includes("Generaci\xf3n")||t.name.includes("Env\xedo")||t.name.includes("Soluci\xf3n")){console.log("\ud83c\udd95 GANTT USANDO FECHAS DE TABLA (CORREGIDO):"),console.log("   taskName:",t.name),console.log("   \ud83d\udccb FECHAS DE TABLA (las que rigen):"),console.log("   - tableStartDate:",r),console.log("   - tableEndDate:",a),console.log("   \ud83e\uddee FECHAS CALCULADAS POR CPM (solo informativas):"),console.log("   - earlyStart:",t.earlyStart),console.log("   - earlyFinish:",t.earlyFinish),console.log("   \ud83d\udcca C\xc1LCULOS GANTT (usando d\xedas calendario):"),console.log("   - projectStart:",e),console.log("   - leftDays (d\xedas calendario):",s),console.log("   - durDays (d\xedas calendario):",n),console.log("   - leftPx calculado:",s*ct),console.log("   - includeWeekends config:",h,"(pero usando d\xedas calendario para fechas de tareas)"),t.name.includes("Aprobaci\xf3n")&&(console.log("\ud83d\udd0d DEBUG ESPEC\xcdFICO TAREA 1:"),console.log("   - Fecha inicio tabla:",r),console.log("   - Fecha referencia proyecto:",e),console.log("   - Diferencia en d\xedas:",Math.round((new Date(r)-new Date(e))/864e5)),console.log("   - leftDays calculado:",s),console.log("   - leftPx calculado:",s*ct),console.log("   - \xbfDeber\xeda ser 0?",r===e?"S\xcd":"NO"));const i=new Date(r).toLocaleDateString("es-ES"),o=new Date(a).toLocaleDateString("es-ES");console.log("   \ud83d\udccb FORMATO TABLA:"),console.log("   - Inicio formateado:",i),console.log("   - Fin formateado:",o),r===t.earlyStart&&a===t.earlyFinish||(console.log("   \u26a0\ufe0f DIFERENCIA ENTRE TABLA Y CPM:"),console.log("   - Tabla inicio:",r,"vs CPM inicio:",t.earlyStart),console.log("   - Tabla fin:",a,"vs CPM fin:",t.earlyFinish),console.log("   \u2705 GANTT USAR\xc1 FECHAS DE TABLA (correcto)"))}return{id:t.id,wbsCode:t.wbsCode,name:t.name,duration:t.duration,startDate:r,endDate:a,progress:t.progress,predecessors:[...t.predecessors||[]],cost:t.cost,priority:t.priority,assignedTo:t.assignedTo,isMilestone:t.isMilestone,isCritical:t.isCritical,originalDuration:t.originalDuration,earlyStart:t.earlyStart,earlyFinish:t.earlyFinish,lateStart:t.lateStart,lateFinish:t.lateFinish,totalFloat:t.totalFloat,freeFloat:t.freeFloat,description:t.description,resources:[...t.resources||[]],workPackageId:t.workPackageId,status:t.status,successors:[...t.successors||[]],leftPx:s*ct,widthPx:t.isMilestone?12:Math.max(1,n*ct)}})},At=((0,a.useMemo)(()=>{if(0===Ve.length)return[];const e=[];return Ve.forEach(t=>{t.predecessors.forEach(r=>{const a=Ve.find(e=>e.id===r);a&&e.push({id:"".concat(r,"-").concat(t.id),source:r,target:t.id,type:"predecessor",isCritical:t.isCritical&&a.isCritical})})}),e},[Ve]),()=>{if(!Ue.current||0===Ke.length)return;let e=1/0,t=1/0,r=-1/0,a=-1/0;Ke.forEach(s=>{e=Math.min(e,s.x),t=Math.min(t,s.y),r=Math.max(r,s.x+s.width),a=Math.max(a,s.y+s.height)});const s=r-e,n=a-t;if(0===s||0===n)return;const i=1200/s,o=600/n,l=Math.min(i,o,2),c=Math.max(.3,l);Se(c);Te({x:(e+r)/2-1200/(2*c),y:(t+a)/2-600/(2*c)})});(0,a.useMemo)(()=>{const e=Ve.length,t=Ve.reduce((e,t)=>e+t.predecessors.length,0),r=Ve.filter(e=>e.isCritical).length;console.log("\ud83d\udcca M\xc9TRICAS DEL DIAGRAMA:",{totalNodes:e,totalEdges:t,criticalPathLength:r,tareasConDeps:Ve.filter(e=>e.predecessors.length>0).length,detalleDeps:Ve.map(e=>({id:e.id,name:e.name,predecessors:e.predecessors,count:e.predecessors.length}))});const a=new Map,s=new Set,n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;if(s.has(e))return a.get(e)||0;if(r.has(e))return console.warn("Dependencia circular detectada en tarea (an\xe1lisis):",e),a.set(e,t),s.add(e),t;r.add(e),s.add(e);const i=Ve.find(t=>t.id===e);if(!i)return r.delete(e),t;let o=t;for(const a of i.predecessors){const e=n(a,t+1,r);o=Math.max(o,e)}return a.set(e,o),r.delete(e),o};for(const i of Ve)n(i.id);return{totalNodes:e,totalEdges:t,criticalPathLength:r,maxDepth:Math.max(...a.values(),0)}},[Ve]);return(0,bt.jsxs)("div",{className:"space-y-6",children:[(0,bt.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 via-indigo-50 to-purple-50 rounded-2xl shadow-lg p-6 mb-8 border border-blue-200 relative overflow-hidden",children:[(0,bt.jsx)("div",{className:"absolute top-0 right-0 w-32 h-32 bg-blue-100/30 rounded-full -translate-y-16 translate-x-16"}),(0,bt.jsx)("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-indigo-100/30 rounded-full translate-y-12 -translate-x-12"}),(0,bt.jsxs)("div",{className:"relative z-10",children:[(0,bt.jsxs)("div",{className:"flex flex-col lg:flex-row items-start lg:items-center justify-between gap-6 mb-6",children:[(0,bt.jsxs)("div",{className:"flex items-center",children:[(0,bt.jsx)("div",{className:"bg-blue-100 rounded-2xl p-3 mr-4",children:(0,bt.jsx)("span",{className:"text-2xl",children:"\ud83d\udcc5"})}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Cronograma del Proyecto"}),(0,bt.jsx)("p",{className:"text-gray-600 text-lg",children:"Gesti\xf3n de tiempo, dependencias y recursos integrada con EVM"})]})]}),(0,bt.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,bt.jsxs)("button",{onClick:nt,className:"bg-white text-gray-700 px-4 py-2 rounded-xl hover:bg-blue-50 flex items-center space-x-2 transition-all duration-300 border border-gray-300 hover:border-blue-300 text-sm shadow-sm",children:[(0,bt.jsx)("span",{children:"\ud83d\udce5"}),(0,bt.jsx)("span",{children:"Exportar"})]}),(0,bt.jsxs)("button",{onClick:()=>(()=>{const e=Ve.filter(e=>e.isCritical);if(0===e.length)return void alert("No hay tareas cr\xedticas para comprimir");const t=e.map(e=>({id:e.id,wbsCode:e.wbsCode,name:e.name,duration:e.duration,startDate:e.startDate,endDate:e.endDate,progress:e.progress,predecessors:[...e.predecessors||[]],cost:e.cost,priority:e.priority,assignedTo:e.assignedTo,isMilestone:e.isMilestone,isCritical:e.isCritical,originalDuration:e.originalDuration,earlyStart:e.earlyStart,earlyFinish:e.earlyFinish,lateStart:e.lateStart,lateFinish:e.lateFinish,totalFloat:e.totalFloat,freeFloat:e.freeFloat,description:e.description,resources:[...e.resources||[]],workPackageId:e.workPackageId,status:e.status,successors:[...e.successors||[]],compressionPotential:Math.min(.3*e.duration,5),compressionCost:.2*e.cost})).sort((e,t)=>t.compressionPotential-e.compressionPotential).slice(0,3).map(e=>"".concat(e.name,": -").concat(e.compressionPotential," d\xedas ($").concat(e.compressionCost.toFixed(2),"/d\xeda)")).join("\n"),r=prompt("\xbfCu\xe1ntos d\xedas quieres comprimir del cronograma?\n\nOpciones de compresi\xf3n:\n".concat(t,"\n\nIngresa el n\xfamero de d\xedas:"),"1");if(r&&!isNaN(r)){const e=parseInt(r);let t=0,a=0;const s=Ve.map(r=>{if(r.isCritical&&t<e){const s=Math.min(r.compressionPotential,e-t);if(s>0)return t+=s,a+=s*r.compressionCost,{id:r.id,wbsCode:r.wbsCode,name:r.name,duration:Math.max(1,r.duration-s),startDate:r.startDate,endDate:r.endDate,progress:r.progress,predecessors:[...r.predecessors||[]],cost:r.cost,priority:r.priority,assignedTo:r.assignedTo,isMilestone:r.isMilestone,isCritical:r.isCritical,originalDuration:r.originalDuration,earlyStart:r.earlyStart,earlyFinish:r.earlyFinish,lateStart:r.lateStart,lateFinish:r.lateFinish,totalFloat:r.totalFloat,freeFloat:r.freeFloat,description:r.description,resources:[...r.resources||[]],workPackageId:r.workPackageId,status:r.status,successors:[...r.successors||[]],compressedDays:(r.compressedDays||0)+s,compressionCost:(r.compressionCost||0)+s*r.compressionCost}}return r});t>0?(l(s),alert("\u2705 Cronograma comprimido ".concat(t," d\xedas\n\ud83d\udcb0 Costo adicional: $").concat(a.toFixed(2)))):alert("No se pudo comprimir el cronograma con los par\xe1metros especificados")}})(),className:"bg-white text-gray-700 px-4 py-2 rounded-xl hover:bg-blue-50 flex items-center space-x-2 transition-all duration-300 border border-gray-300 hover:border-blue-300 text-sm shadow-sm",title:"Comprimir cronograma (en desarrollo)",children:[(0,bt.jsx)("span",{children:"\ud83d\ude80"}),(0,bt.jsx)("span",{children:"Comprimir"})]})]})]}),(0,bt.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-6 gap-4 mb-6",children:[(0,bt.jsxs)("div",{className:"bg-white rounded-xl p-4 border border-blue-200 hover:shadow-md transition-all duration-300",children:[(0,bt.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,bt.jsx)("span",{className:"text-lg",children:"\ud83d\udcc5"}),(0,bt.jsx)("span",{className:"text-sm font-medium text-blue-600",children:"Inicio"})]}),(0,bt.jsx)("div",{className:"text-lg font-bold text-gray-800",children:Ve.length>0?(()=>{const e=Ve.map(e=>new Date(e.startDate));return new Date(Math.min(...e)).toLocaleDateString("es")})():null!==d&&void 0!==d&&d.startDate?new Date(d.startDate).toLocaleDateString("es"):"N/A"})]}),(0,bt.jsxs)("div",{className:"bg-white rounded-xl p-4 border border-blue-200 hover:shadow-md transition-all duration-300",children:[(0,bt.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,bt.jsx)("span",{className:"text-lg",children:"\ud83d\udcc5"}),(0,bt.jsx)("span",{className:"text-sm font-medium text-blue-600",children:"Fin"})]}),(0,bt.jsx)("div",{className:"text-lg font-bold text-gray-800",children:(()=>{if(Ve.length>0){const e=Ve.filter(e=>e.endDate&&null!==e.endDate&&void 0!==e.endDate).map(e=>{const[t,r,a]=e.endDate.split("-");return new Date(parseInt(t),parseInt(r)-1,parseInt(a))}).filter(e=>!isNaN(e.getTime())),t=new Date(Math.max(...e)),r=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0"),n="".concat(s,"/").concat(a,"/").concat(r);return console.log("\ud83d\udd0d DEBUG - Fecha de fin del cronograma (usando fechas de tabla):",{totalTasks:Ve.length,originalEndDates:e.map(e=>e&&!isNaN(e.getTime())?e.toISOString().split("T")[0]:"N/A"),maxEndDate:t&&!isNaN(t.getTime())?t.toISOString().split("T")[0]:"N/A",year:r,month:a,day:s,formattedDate:n}),n}return null!==d&&void 0!==d&&d.endDate?new Date(d.endDate).toLocaleDateString("es"):"N/A"})()})]}),(0,bt.jsxs)("div",{className:"bg-white rounded-xl p-4 border border-blue-200 hover:shadow-md transition-all duration-300",children:[(0,bt.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,bt.jsx)("span",{className:"text-lg",children:"\ud83d\udcb0"}),(0,bt.jsx)("span",{className:"text-sm font-medium text-blue-600",children:"Presupuesto"})]}),(0,bt.jsxs)("div",{className:"text-lg font-bold text-gray-800",children:["$",Ve.reduce((e,t)=>e+(t.cost||0),0).toLocaleString()]})]}),(0,bt.jsxs)("div",{className:"bg-white rounded-xl p-4 border border-red-200 hover:shadow-md transition-all duration-300",children:[(0,bt.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,bt.jsx)("span",{className:"text-lg",children:"\ud83d\udd25"}),(0,bt.jsx)("span",{className:"text-sm font-medium text-red-600",children:"Ruta Cr\xedtica"})]}),(0,bt.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:(null===He||void 0===He?void 0:He.criticalPathLength)||0}),(0,bt.jsx)("div",{className:"text-sm text-red-600",children:"d\xedas"})]}),(0,bt.jsxs)("div",{className:"bg-white rounded-xl p-4 border border-red-200 hover:shadow-md transition-all duration-300",children:[(0,bt.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,bt.jsx)("span",{className:"text-lg",children:"\u26a0\ufe0f"}),(0,bt.jsx)("span",{className:"text-sm font-medium text-red-600",children:"Tareas Cr\xedticas"})]}),(0,bt.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:(null===He||void 0===He||null===(t=He.criticalPath)||void 0===t?void 0:t.length)||0}),(0,bt.jsx)("div",{className:"text-sm text-red-600",children:"tareas"})]})]}),(0,bt.jsx)("div",{className:"bg-white/60 backdrop-blur rounded-xl p-4 border border-blue-200 mb-4",children:(0,bt.jsxs)("div",{className:"flex flex-col lg:flex-row items-center justify-between gap-4",children:[(0,bt.jsxs)("div",{className:"text-center lg:text-left",children:[(0,bt.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 mb-1 flex items-center justify-center lg:justify-start",children:[(0,bt.jsx)("span",{className:"mr-2 text-xl",children:"\ud83d\udcca"}),"Selecciona la Vista"]}),(0,bt.jsx)("p",{className:"text-gray-600 text-sm",children:"Elige la visualizaci\xf3n que mejor se adapte a tu an\xe1lisis"})]}),(0,bt.jsxs)("div",{className:"flex flex-wrap justify-center lg:justify-end gap-2",children:[(0,bt.jsxs)("button",{onClick:()=>w("gantt"),className:"px-4 py-2 rounded-lg font-medium text-sm transition-all duration-300 flex items-center space-x-2 ".concat("gantt"===y?"bg-indigo-600 text-white shadow-md hover:shadow-lg":"bg-white text-gray-600 hover:bg-indigo-50 hover:text-indigo-700 border border-gray-300 hover:border-indigo-300"),children:[(0,bt.jsx)("span",{children:"\ud83d\udcca"}),(0,bt.jsx)("span",{children:"Gantt"})]}),(0,bt.jsxs)("button",{onClick:()=>w("excel"),className:"px-4 py-2 rounded-lg font-medium text-sm transition-all duration-300 flex items-center space-x-2 ".concat("excel"===y?"bg-indigo-600 text-white shadow-md hover:shadow-lg":"bg-white text-gray-600 hover:bg-indigo-50 hover:text-indigo-700 border border-gray-300 hover:border-indigo-300"),children:[(0,bt.jsx)("span",{children:"\ud83d\udccb"}),(0,bt.jsx)("span",{children:"Tabla"})]}),(0,bt.jsxs)("button",{onClick:()=>w("minutas"),className:"px-4 py-2 rounded-lg font-medium text-sm transition-all duration-300 flex items-center space-x-2 ".concat("minutas"===y?"bg-indigo-600 text-white shadow-md hover:shadow-lg":"bg-white text-gray-600 hover:bg-indigo-50 hover:text-indigo-700 border border-gray-300 hover:border-indigo-300"),children:[(0,bt.jsx)("span",{children:"\ud83d\udccb"}),(0,bt.jsx)("span",{children:"Tareas de minutas"})]})]})]})}),(0,bt.jsxs)("div",{className:"space-y-3",children:[$&&(0,bt.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-xl p-3",children:(0,bt.jsxs)("div",{className:"flex items-center",children:[(0,bt.jsx)("span",{className:"mr-2 text-red-500",children:"\u26a0\ufe0f"}),(0,bt.jsxs)("span",{className:"text-sm text-red-700",children:["Error CPM: ",$]})]})}),Ge.conflicts.length>0&&(0,bt.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-3",children:(0,bt.jsxs)("div",{className:"flex items-center",children:[(0,bt.jsx)("span",{className:"mr-2 text-yellow-500",children:"\u26a0\ufe0f"}),(0,bt.jsxs)("span",{className:"text-sm text-yellow-700",children:[Ge.conflicts.length," conflicto(s) de recursos detectado(s)"]})]})})]})]})]}),"excel"===y&&(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-6",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,bt.jsx)("h2",{className:"text-2xl font-bold",children:"\ud83d\udccb Vista Tabla - Cronograma"}),(0,bt.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,bt.jsxs)("div",{className:"flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-2",children:[(0,bt.jsx)("input",{type:"checkbox",id:"includeWeekends",checked:h,onChange:e=>{e.stopPropagation(),console.log("\ud83d\udd04 CHECKBOX CLICK:",e.target.checked),f(e.target.checked)},className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2"}),(0,bt.jsx)("label",{htmlFor:"includeWeekends",className:"text-sm font-medium text-gray-700",children:"S\xe1bados y domingos son laborables"})]}),(0,bt.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg px-3 py-2",children:(0,bt.jsxs)("div",{className:"flex items-center space-x-2 text-sm",children:[(0,bt.jsx)("span",{className:"text-blue-600",children:"\ud83d\udcc5 Configuraci\xf3n actual:"}),(0,bt.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(h?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"),children:h?"Lunes a Domingo":"Lunes a Viernes"})]})}),(0,bt.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg px-3 py-2",children:(0,bt.jsxs)("div",{className:"flex items-center space-x-2 text-sm",children:[(0,bt.jsx)("span",{className:"text-green-600",children:"\ud83d\udd17 Validaci\xf3n:"}),(0,bt.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Predecesoras validadas"})]})})]}),(0,bt.jsxs)("div",{className:"flex space-x-2",children:[(0,bt.jsxs)("button",{onClick:()=>{console.log("\ud83d\udcca GENERANDO ARCHIVO EXCEL DE EJEMPLO");const e=Ew.book_new(),t=Ew.aoa_to_sheet([["#","Nombre","Duraci\xf3n","Inicio","Fin","Progreso","Prioridad","Asignado","Costo","Predecesoras","Hitos"],[1,"Inicio del Proyecto",0,"2024-01-01","2024-01-01",100,"Alta","PM",0,"","S\xed"],[2,"An\xe1lisis de Requisitos",5,"2024-01-02","2024-01-08",80,"Alta","Analista",5e3,"1","No"],[3,"Dise\xf1o del Sistema",7,"2024-01-09","2024-01-17",60,"Alta","Arquitecto",8e3,"2","No"],[4,"Aprobaci\xf3n del Dise\xf1o",0,"2024-01-18","2024-01-18",0,"Alta","Cliente",0,"3","S\xed"],[5,"Desarrollo Frontend",10,"2024-01-19","2024-01-30",40,"Media","Dev Frontend",12e3,"4","No"],[6,"Desarrollo Backend",12,"2024-01-22","2024-02-06",30,"Media","Dev Backend",15e3,"4","No"],[7,"Integraci\xf3n",3,"2024-02-07","2024-02-11",0,"Alta","Dev Lead",3e3,"5,6","No"],[8,"Pruebas Unitarias",4,"2024-02-12","2024-02-17",0,"Media","QA",2e3,"7","No"],[9,"Pruebas de Integraci\xf3n",0,"2024-02-18","2024-02-18",0,"Alta","QA Lead",0,"8","S\xed"],[10,"Despliegue en Producci\xf3n",2,"2024-02-19","2024-02-22",0,"Alta","DevOps",1e3,"9","No"],[11,"Cierre del Proyecto",0,"2024-02-23","2024-02-23",0,"Alta","PM",0,"10","S\xed"]]);t["!cols"]=[{wch:5},{wch:25},{wch:10},{wch:12},{wch:12},{wch:10},{wch:12},{wch:15},{wch:10},{wch:15},{wch:8}],Ew.book_append_sheet(e,t,"Cronograma");const r="Cronograma_Ejemplo_".concat((new Date).toISOString().split("T")[0],".xlsx");mw(e,r),console.log("\ud83d\udcca Archivo Excel de ejemplo generado:",r)},className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 flex items-center space-x-2",title:"Descargar archivo Excel de ejemplo con hitos",children:[(0,bt.jsx)("span",{children:"\ud83d\udccb"}),(0,bt.jsx)("span",{children:"Descargar Ejemplo"})]}),(0,bt.jsxs)("button",{onClick:()=>{var e;return null===(e=Be.current)||void 0===e?void 0:e.click()},className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center space-x-2",title:"Importar cronograma desde Excel (reemplaza datos existentes)",children:[(0,bt.jsx)("span",{children:"\ud83d\udcca"}),(0,bt.jsx)("span",{children:"Importar Cronograma"})]}),(0,bt.jsxs)("button",{onClick:()=>ie(!0),className:"bg-gradient-to-r from-purple-600 to-pink-600 text-white px-4 py-2 rounded-lg hover:from-purple-700 hover:to-pink-700 flex items-center space-x-2 transition-all transform hover:scale-105",title:"Generar cronograma autom\xe1ticamente con Asistente de IA",children:[(0,bt.jsx)("span",{children:"\ud83e\udd16"}),(0,bt.jsx)("span",{children:"Asistente de IA"})]}),(0,bt.jsx)("input",{ref:Be,type:"file",accept:".xlsx,.xls",onChange:e=>{var t;const r=null===(t=e.target.files)||void 0===t?void 0:t[0];r&&(e=>{if(console.log("\ud83d\udcca IMPORTANDO CRONOGRAMA COMPLETO desde:",e.name),console.log("\ud83d\udcca Tama\xf1o del archivo:",e.size,"bytes"),console.log("\ud83d\udcca Tipo de archivo:",e.type),e)if(e.size>10485760)alert("\u274c El archivo es demasiado grande. El tama\xf1o m\xe1ximo es 10MB");else if(0!==e.size)if(e.type.includes("sheet")||e.type.includes("excel")||e.name.endsWith(".xlsx")||e.name.endsWith(".xls")){console.log("\u2705 Validaciones de archivo pasadas, iniciando lectura...");try{const t=URL.createObjectURL(e);console.log("\ud83d\udcca URL del archivo creada:",t),fetch(t).then(e=>{if(console.log("\ud83d\udcca Fetch response status:",e.status),!e.ok)throw new Error("HTTP error! status: ".concat(e.status));return e.arrayBuffer()}).then(e=>{console.log("\ud83d\udcca ArrayBuffer recibido, tama\xf1o:",e.byteLength);try{const r=new Uint8Array(e);if(console.log("\ud83d\udcca Datos convertidos a Uint8Array, tama\xf1o:",r.length),0===r.length)throw new Error("El archivo est\xe1 vac\xedo");const a=ow(r,{type:"array"});console.log("\ud83d\udcca Workbook creado exitosamente, hojas disponibles:",a.SheetNames),xt(a),URL.revokeObjectURL(t)}catch(r){console.error("\u274c Error procesando datos:",r),URL.revokeObjectURL(t),alert("\u274c No se pudo procesar el archivo Excel. Verifica que el archivo no est\xe9 corrupto y que sea un formato v\xe1lido (.xlsx o .xls).")}}).catch(r=>{console.error("\u274c Error en fetch:",r),URL.revokeObjectURL(t),console.log("\ud83d\udcca Intentando fallback con FileReader..."),gt(e)})}catch(t){console.error("\u274c Error creando URL del objeto:",t),console.log("\ud83d\udcca Intentando fallback con FileReader..."),gt(e)}}else alert("\u274c Por favor selecciona un archivo Excel v\xe1lido (.xlsx o .xls)");else alert("\u274c El archivo est\xe1 vac\xedo");else alert("\u274c No se seleccion\xf3 ning\xfan archivo")})(r)},style:{display:"none"}}),(0,bt.jsxs)("button",{onClick:it,className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 flex items-center space-x-2",children:[(0,bt.jsx)("span",{children:"\ud83d\udcca"}),(0,bt.jsx)("span",{children:"Descargar Excel"})]})]})]}),(0,bt.jsx)("div",{className:"overflow-x-auto overflow-y-auto max-h-[85vh] border border-gray-200 rounded-lg",children:(0,bt.jsxs)("table",{className:"w-full border-collapse border border-gray-300",children:[(0,bt.jsx)("thead",{children:(0,bt.jsxs)("tr",{className:"bg-gray-50",children:[(0,bt.jsx)("th",{className:"border border-gray-300 px-2 py-1.5 text-left text-sm font-medium text-gray-700 w-8",children:"#"}),(0,bt.jsx)("th",{className:"border border-gray-300 px-2 py-1.5 text-left text-sm font-medium text-gray-700 w-12",children:"Acci\xf3n"}),(0,bt.jsx)("th",{className:"border border-gray-300 px-2 py-1.5 text-left text-sm font-medium text-gray-700 w-48",children:"Tarea"}),(0,bt.jsx)("th",{className:"border border-gray-300 px-2 py-1.5 text-left text-sm font-medium text-gray-700 w-12",children:"\ud83c\udff9"}),(0,bt.jsx)("th",{className:"border border-gray-300 px-2 py-1.5 text-left text-sm font-medium text-gray-700 w-16",children:"Duraci\xf3n"}),(0,bt.jsx)("th",{className:"border border-gray-300 px-2 py-1.5 text-left text-sm font-medium text-gray-700 w-24",children:"Inicio"}),(0,bt.jsx)("th",{className:"border border-gray-300 px-2 py-1.5 text-left text-sm font-medium text-gray-700 w-24",children:"Fin"}),(0,bt.jsx)("th",{className:"border border-gray-300 px-2 py-1.5 text-left text-sm font-medium text-gray-700 w-16",children:"Progreso"}),(0,bt.jsx)("th",{className:"border border-gray-300 px-2 py-1.5 text-left text-sm font-medium text-gray-700 w-16",children:"Prioridad"}),(0,bt.jsx)("th",{className:"border border-gray-300 px-2 py-1.5 text-left text-sm font-medium text-gray-700 w-24",children:"Asignado"}),(0,bt.jsx)("th",{className:"border border-gray-300 px-2 py-1.5 text-left text-sm font-medium text-gray-700 w-16",children:"Costo"}),(0,bt.jsx)("th",{className:"border border-gray-300 px-2 py-1.5 text-left text-sm font-medium text-gray-700 w-20",children:"Predecesoras"})]})}),(0,bt.jsx)("tbody",{onKeyDown:St,children:Ve.map((e,t)=>(0,bt.jsxs)("tr",{className:"hover:bg-gray-50 ".concat(E===e.id?"bg-blue-50":""),onClick:()=>T(e.id),children:[(0,bt.jsx)("td",{className:"border border-gray-300 px-2 py-1 text-sm text-gray-600 text-center",children:t+1}),(0,bt.jsx)("td",{className:"border border-gray-300 px-2 py-1",children:(0,bt.jsxs)("div",{className:"flex space-x-1",children:[(0,bt.jsx)("button",{onClick:t=>{t.stopPropagation(),(e=>{const t=o.findIndex(t=>t.id===e);if(-1===t)return;const r=o[t],a=Dj(r.endDate,1,h),s=Dj(a,5,h),n={id:crypto.randomUUID(),name:"Nueva Tarea",duration:5,startDate:a,endDate:s,progress:0,priority:"medium",status:"in-progress",assignedTo:"",cost:0,predecessors:[e],successors:[],resources:[],isMilestone:!1,originalDuration:5,description:""};l(e=>{const r=e.slice();return r.splice(t+1,0,n),r})})(e.id)},className:"text-green-600 hover:text-green-800 text-xs px-1 py-1 rounded",title:"Insertar fila despu\xe9s",children:"\u2795"}),(0,bt.jsx)("button",{onClick:t=>{t.stopPropagation(),(e=>{const t=o.find(t=>t.id===e);if(!t)return;const r=o.filter(t=>{var r,a;return(null===(r=t.predecessors)||void 0===r?void 0:r.includes(e))||(null===(a=t.successors)||void 0===a?void 0:a.includes(e))});let a='\xbfEst\xe1s seguro de que quieres eliminar la tarea "'.concat(t.name,'"?');r.length>0&&(a+="\n\n\u26a0\ufe0f ADVERTENCIA: Esta tarea tiene dependencias:\n",r.forEach(t=>{var r,s;null!==(r=t.predecessors)&&void 0!==r&&r.includes(e)&&(a+='\u2022 "'.concat(t.name,'" depende de esta tarea\n')),null!==(s=t.successors)&&void 0!==s&&s.includes(e)&&(a+='\u2022 Esta tarea depende de "'.concat(t.name,'"\n'))}),a+="\nLas dependencias se limpiar\xe1n autom\xe1ticamente, pero esto podr\xeda afectar el cronograma."),a+="\n\nEsta acci\xf3n no se puede deshacer.",window.confirm(a)&&(console.log("\ud83d\uddd1\ufe0f Eliminando tarea:",t.name,"ID:",e),console.log("\ud83d\udd17 Tareas dependientes encontradas:",r.length),l(t=>{const a=t.filter(t=>t.id!==e).map(t=>{var r,a;return(0,n.A)((0,n.A)({},t),{},{predecessors:(null===(r=t.predecessors)||void 0===r?void 0:r.filter(t=>t!==e))||[],successors:(null===(a=t.successors)||void 0===a?void 0:a.filter(t=>t!==e))||[]})}),s=r.map(e=>e.id);console.log("\ud83d\udd04 Recalculando CPM para tareas afectadas:",s);const i=Lj(a,h);return console.log("\u2705 Tarea eliminada exitosamente"),console.log("\ud83d\udcca Cronograma recalculado autom\xe1ticamente"),i}))})(e.id)},className:"text-red-600 hover:text-red-800 text-xs px-1 py-1 rounded",title:"Eliminar tarea",children:"\ud83d\uddd1\ufe0f"})]})}),(0,bt.jsx)("td",{className:"border border-gray-300 px-2 py-1",children:(null===j||void 0===j?void 0:j.taskId)===e.id&&"name"===(null===j||void 0===j?void 0:j.field)?(0,bt.jsx)("input",{type:"text",value:k,onChange:e=>S(e.target.value),onBlur:jt,onKeyDown:St,className:"w-full px-2 py-1 border border-blue-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0}):(0,bt.jsx)("div",{className:"cursor-pointer hover:bg-gray-100 px-2 py-1 rounded min-h-[24px] flex items-center",onClick:()=>vt(e.id,"name",e.name),children:e.name})}),(0,bt.jsx)("td",{className:"border border-gray-300 px-2 py-1 text-center",children:(0,bt.jsx)("button",{onClick:()=>(e=>{l(t=>t.map(t=>{if(t.id!==e)return t;if(!t.isMilestone)return console.log("\ud83d\udd0d DEBUG - Creando hito:",{taskId:e,taskName:t.name,startDate:t.startDate,endDate:t.startDate,duration:0}),{id:t.id,wbsCode:t.wbsCode,name:t.name,duration:0,startDate:t.startDate,endDate:t.startDate,progress:t.progress,predecessors:[...t.predecessors||[]],cost:t.cost,priority:t.priority,assignedTo:t.assignedTo,isMilestone:!0,isCritical:t.isCritical,originalDuration:t.originalDuration,earlyStart:t.earlyStart,earlyFinish:t.earlyFinish,lateStart:t.lateStart,lateFinish:t.lateFinish,totalFloat:t.totalFloat,freeFloat:t.freeFloat,description:t.description,resources:[...t.resources||[]],workPackageId:t.workPackageId,status:t.status,successors:[...t.successors||[]],updatedAt:(new Date).toISOString()};{const e=t.originalDuration||1,r=Dj(t.startDate,e,h);return{id:t.id,wbsCode:t.wbsCode,name:t.name,duration:e,startDate:t.startDate,endDate:r,progress:t.progress,predecessors:[...t.predecessors||[]],cost:t.cost,priority:t.priority,assignedTo:t.assignedTo,isMilestone:!1,isCritical:t.isCritical,originalDuration:t.originalDuration,earlyStart:t.earlyStart,earlyFinish:t.earlyFinish,lateStart:t.lateStart,lateFinish:t.lateFinish,totalFloat:t.totalFloat,freeFloat:t.freeFloat,description:t.description,resources:[...t.resources||[]],workPackageId:t.workPackageId,status:t.status,successors:[...t.successors||[]],updatedAt:(new Date).toISOString()}}}));const t=new CustomEvent("dataChange",{detail:{type:"milestone_toggled",taskId:e,timestamp:(new Date).toISOString()}});window.dispatchEvent(t)})(e.id),className:"w-8 h-8 rounded-full border-2 flex items-center justify-center transition-all duration-200 ".concat(e.isMilestone?"bg-indigo-500 border-indigo-500 text-white shadow-lg":"bg-white border-gray-300 text-gray-400 hover:border-indigo-300 hover:text-indigo-400"),title:e.isMilestone?"Quitar hito":"Marcar como hito",children:"\ud83c\udff9"})}),(0,bt.jsx)("td",{className:"border border-gray-300 px-2 py-1",children:e.isMilestone?(0,bt.jsx)("div",{className:"px-2 py-1 rounded bg-purple-100 text-purple-800 text-center font-medium",children:"0d"}):(null===j||void 0===j?void 0:j.taskId)===e.id&&"duration"===(null===j||void 0===j?void 0:j.field)?(0,bt.jsx)("input",{type:"number",value:k,onChange:e=>S(e.target.value),onBlur:jt,onKeyDown:St,className:"w-full px-2 py-1 border border-blue-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0}):(0,bt.jsxs)("div",{className:"cursor-pointer hover:bg-gray-100 px-2 py-1 rounded min-h-[24px] flex items-center",onClick:()=>vt(e.id,"duration",e.duration),children:[e.duration,"d"]})}),(0,bt.jsx)("td",{className:"border border-gray-300 px-2 py-1",children:(null===j||void 0===j?void 0:j.taskId)===e.id&&"startDate"===(null===j||void 0===j?void 0:j.field)?(0,bt.jsx)("input",{type:"date",value:k,onChange:e=>S(e.target.value),onBlur:jt,onKeyDown:St,className:"w-full px-2 py-1 border border-blue-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0}):(0,bt.jsx)("div",{className:"cursor-pointer hover:bg-gray-100 px-2 py-1 rounded min-h-[24px] flex items-center text-sm",onClick:()=>vt(e.id,"startDate",e.startDate),children:e.startDate&&null!==e.startDate&&void 0!==e.startDate?e.startDate.split("-").reverse().join("/"):""})}),(0,bt.jsx)("td",{className:"border border-gray-300 px-2 py-1",children:e.isMilestone?(0,bt.jsx)("div",{className:"px-2 py-1 rounded bg-purple-100 text-purple-800 text-center font-medium text-sm",children:(()=>{if(!e.startDate||null===e.startDate||void 0===e.startDate)return"";const[t,r,a]=e.startDate.split("-");return new Date(t,r-1,a).toLocaleDateString("es")})()}):(null===j||void 0===j?void 0:j.taskId)===e.id&&"endDate"===(null===j||void 0===j?void 0:j.field)?(0,bt.jsx)("input",{type:"date",value:k,onChange:e=>S(e.target.value),onBlur:jt,onKeyDown:St,className:"w-full px-2 py-1 border border-blue-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0}):(0,bt.jsx)("div",{className:"cursor-pointer hover:bg-gray-100 px-2 py-1 rounded min-h-[24px] flex items-center text-sm",onClick:()=>vt(e.id,"endDate",e.endDate),children:e.isMilestone?e.startDate&&null!==e.startDate&&void 0!==e.startDate?e.startDate.split("-").reverse().join("/"):"":e.endDate&&null!==e.endDate&&void 0!==e.endDate?e.endDate.split("-").reverse().join("/"):""})}),(0,bt.jsx)("td",{className:"border border-gray-300 px-2 py-1",children:(null===j||void 0===j?void 0:j.taskId)===e.id&&"progress"===(null===j||void 0===j?void 0:j.field)?(0,bt.jsx)("input",{type:"number",min:"0",max:"100",value:k,onChange:e=>S(e.target.value),onBlur:jt,onKeyDown:St,className:"w-full px-2 py-1 border border-blue-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0}):(0,bt.jsx)("div",{className:"cursor-pointer hover:bg-gray-100 px-2 py-1 rounded min-h-[24px] flex items-center",onClick:()=>vt(e.id,"progress",e.progress),children:(0,bt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,bt.jsx)("div",{className:"w-16 bg-gray-200 rounded-full h-2",children:(0,bt.jsx)("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:"".concat(e.progress,"%")}})}),(0,bt.jsxs)("span",{className:"text-xs",children:[e.progress,"%"]})]})})}),(0,bt.jsx)("td",{className:"border border-gray-300 px-2 py-1",children:(null===j||void 0===j?void 0:j.taskId)===e.id&&"priority"===(null===j||void 0===j?void 0:j.field)?(0,bt.jsxs)("select",{value:k,onChange:e=>S(e.target.value),onBlur:jt,className:"w-full px-2 py-1 border border-blue-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0,children:[(0,bt.jsx)("option",{value:"low",children:"Baja"}),(0,bt.jsx)("option",{value:"medium",children:"Media"}),(0,bt.jsx)("option",{value:"high",children:"Alta"}),(0,bt.jsx)("option",{value:"critical",children:"Cr\xedtica"})]}):(0,bt.jsx)("div",{className:"cursor-pointer hover:bg-gray-100 px-2 py-1 rounded min-h-[24px] flex items-center",onClick:()=>vt(e.id,"priority",e.priority),children:(0,bt.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat("critical"===e.priority?"bg-red-100 text-red-800":"high"===e.priority?"bg-orange-100 text-orange-800":"medium"===e.priority?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"),children:"critical"===e.priority?"Cr\xedtica":"high"===e.priority?"Alta":"medium"===e.priority?"Media":"Baja"})})}),(0,bt.jsx)("td",{className:"border border-gray-300 px-2 py-1",children:(null===j||void 0===j?void 0:j.taskId)===e.id&&"assignedTo"===(null===j||void 0===j?void 0:j.field)?(0,bt.jsx)("input",{type:"text",value:k,onChange:e=>S(e.target.value),onBlur:jt,onKeyDown:St,className:"w-full px-2 py-1 border border-blue-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0}):(0,bt.jsx)("div",{className:"cursor-pointer hover:bg-gray-100 px-2 py-1 rounded min-h-[24px] flex items-center",onClick:()=>vt(e.id,"assignedTo",e.assignedTo),children:e.assignedTo||"Sin asignar"})}),(0,bt.jsx)("td",{className:"border border-gray-300 px-2 py-1",children:(null===j||void 0===j?void 0:j.taskId)===e.id&&"cost"===(null===j||void 0===j?void 0:j.field)?(0,bt.jsx)("input",{type:"number",step:"0.01",value:k,onChange:e=>S(e.target.value),onBlur:jt,onKeyDown:St,className:"w-full px-2 py-1 border border-blue-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0}):(0,bt.jsxs)("div",{className:"cursor-pointer hover:bg-gray-100 px-2 py-1 rounded min-h-[24px] flex items-center",onClick:()=>vt(e.id,"cost",e.cost),children:["$",e.cost.toLocaleString()]})}),(0,bt.jsx)("td",{className:"border border-gray-300 px-2 py-1",children:(null===j||void 0===j?void 0:j.taskId)===e.id&&"dependencies"===(null===j||void 0===j?void 0:j.field)?(0,bt.jsxs)("div",{className:"space-y-2",children:[(0,bt.jsx)("div",{className:"text-xs text-gray-600 mb-1",children:"Escribe los n\xfameros de fila separados por comas (ej: 1, 2, 3)"}),(0,bt.jsx)("input",{type:"text",value:k,onChange:e=>S(e.target.value),onBlur:jt,onKeyDown:St,className:"w-full px-2 py-1 border border-blue-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",placeholder:"1, 2, 3",autoFocus:!0}),(0,bt.jsxs)("div",{className:"flex space-x-1",children:[(0,bt.jsx)("button",{onClick:jt,className:"text-xs bg-green-500 text-white px-2 py-1 rounded hover:bg-green-600",children:"Guardar"}),(0,bt.jsx)("button",{onClick:kt,className:"text-xs bg-gray-500 text-white px-2 py-1 rounded hover:bg-gray-600",children:"Cancelar"})]})]}):(0,bt.jsx)("div",{className:"cursor-pointer hover:bg-gray-100 px-2 py-1 rounded min-h-[24px] flex items-center",onClick:()=>(e=>{const t=o.find(t=>t.id===e);if(!t)return;const r=t.predecessors.map(e=>o.findIndex(t=>t.id===e)+1);N({taskId:e,field:"dependencies"}),S(r.join(", "))})(e.id),title:"Click para editar predecesoras",children:(0,bt.jsx)("div",{className:"flex items-center space-x-2 text-xs",children:e.predecessors.length>0?(0,bt.jsx)("div",{className:"flex flex-wrap gap-1",children:e.predecessors.map(e=>{let t=o.findIndex(t=>t.id===e);if(-1===t&&!isNaN(e)){const r=parseInt(e);r>0&&r<=o.length&&(t=r-1)}const r=-1!==t?t+1:e;return(0,bt.jsx)("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full font-medium",children:r},e)})}):(0,bt.jsx)("span",{className:"text-gray-400",children:"Sin predecesoras"})})})})]},e.id))})]})}),(0,bt.jsx)("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:(0,bt.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("span",{className:"font-medium text-gray-700",children:"Total Tareas:"}),(0,bt.jsx)("span",{className:"ml-2 text-gray-600",children:Ve.length})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("span",{className:"font-medium text-gray-700",children:"Duraci\xf3n Total:"}),(0,bt.jsxs)("span",{className:"ml-2 text-gray-600",children:[Ve.reduce((e,t)=>e+t.duration,0)," d\xedas"]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("span",{className:"font-medium text-gray-700",children:"Progreso Promedio:"}),(0,bt.jsxs)("span",{className:"ml-2 text-gray-600",children:[Math.round(Ve.reduce((e,t)=>e+t.progress,0)/Ve.length),"%"]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("span",{className:"font-medium text-gray-700",children:"Costo Total:"}),(0,bt.jsxs)("span",{className:"ml-2 text-gray-600",children:["$",Ve.reduce((e,t)=>e+t.cost,0).toLocaleString()]})]})]})})]}),"gantt"===y&&(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-6",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,bt.jsx)("h2",{className:"text-2xl font-bold",children:"Diagrama Gantt"}),(0,bt.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg px-3 py-2",children:(0,bt.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-blue-700",children:[(0,bt.jsx)("span",{children:"\ud83d\udc41\ufe0f"}),(0,bt.jsx)("span",{children:"Solo lectura - Edita desde la Vista Tabla"})]})})]}),(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,bt.jsxs)("div",{className:"flex space-x-2",children:[(0,bt.jsxs)("select",{value:I,onChange:e=>O(e.target.value),className:"px-3 py-2 border rounded-lg",children:[(0,bt.jsx)("option",{value:"days",children:"D\xedas"}),(0,bt.jsx)("option",{value:"weeks",children:"Semanas"}),(0,bt.jsx)("option",{value:"months",children:"Meses"})]}),(0,bt.jsx)("button",{onClick:()=>W(!U),className:"px-3 py-2 rounded-lg transition-colors duration-200 ".concat(U?"bg-green-500 text-white hover:bg-green-600":"bg-gray-200 text-gray-700 hover:bg-gray-300"),disabled:0===z.length,children:"Baseline"}),(0,bt.jsxs)("button",{onClick:()=>{try{const e=Ve.map(e=>({id:e.id,wbsCode:e.wbsCode,name:e.name,duration:e.duration,startDate:e.startDate,endDate:e.endDate,progress:e.progress,priority:e.priority,assignedTo:e.assignedTo,cost:e.cost,predecessors:[...e.predecessors||[]],successors:[...e.successors||[]],isMilestone:e.isMilestone,originalDuration:e.originalDuration,description:e.description,resources:[...e.resources||[]],earlyStart:e.earlyStart,earlyFinish:e.earlyFinish,lateStart:e.lateStart,lateFinish:e.lateFinish,isCritical:e.isCritical,slack:e.slack}));B(e),W(!0),alert("Baseline guardado exitosamente")}catch(e){console.error("Error al guardar baseline:",e),alert("Error al guardar el baseline. Por favor intenta de nuevo.")}},className:"bg-indigo-600 text-white px-3 py-2 rounded-lg hover:bg-indigo-700 flex items-center space-x-2",children:[(0,bt.jsx)("span",{children:"\ud83d\udcbe"}),(0,bt.jsx)("span",{children:"Guardar Baseline"})]})]}),(0,bt.jsx)("div",{className:"flex space-x-2",children:(0,bt.jsxs)("button",{onClick:tt,className:"bg-orange-600 text-white px-4 py-2 rounded-lg hover:bg-orange-700 flex items-center space-x-2",title:"Limpiar dependencias circulares que causan duplicaci\xf3n de tareas",children:[(0,bt.jsx)("span",{children:"\ud83e\uddf9"}),(0,bt.jsx)("span",{children:"Limpiar Dependencias Circulares"})]})})]}),(0,bt.jsxs)("div",{className:"bg-white border rounded-lg overflow-hidden max-w-full",children:[(0,bt.jsx)("div",{className:"bg-blue-50 border-b border-blue-200 p-2",children:(0,bt.jsxs)("div",{className:"flex items-center justify-center text-sm text-blue-700",children:[(0,bt.jsx)("span",{className:"mr-2",children:"\u2194\ufe0f"}),(0,bt.jsx)("span",{children:"Usa el scroll horizontal para navegar por el cronograma completo"})]})}),(0,bt.jsxs)("div",{className:"flex",children:[(0,bt.jsx)("div",{ref:Le,onScroll:e=>{ze.current&&(ze.current.scrollTop=e.currentTarget.scrollTop)},className:"w-80 bg-gray-50 border-r overflow-y-auto",style:{height:"600px"},children:(0,bt.jsxs)("div",{className:"p-4",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,bt.jsx)("div",{className:"text-sm font-medium text-gray-700",children:"TAREAS DEL PROYECTO"}),(0,bt.jsxs)("div",{className:"text-xs text-gray-500",children:[Ve.length," tareas"]})]}),Ct().map((e,t)=>(0,bt.jsx)("div",{className:"mb-2",children:(0,bt.jsxs)("div",{className:"group flex items-center p-3 rounded-lg transition-all duration-200 border ".concat((null===g||void 0===g?void 0:g.id)===e.id?"bg-indigo-100 border-indigo-300 shadow-md":"hover:bg-white hover:border-gray-300 hover:shadow-sm"),onClick:()=>{console.log("\ud83d\udd24 SELECCI\xd3N TAREA - Tarea seleccionada para ver:",{taskId:e.id,nombre:e.name,tareaCompleta:e}),x(e)},style:{height:kj},children:[(0,bt.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,bt.jsxs)("div",{className:"font-medium text-sm text-gray-900 truncate mb-1",children:[e.name,e.isMilestone&&(0,bt.jsx)("span",{className:"ml-2 text-indigo-600 text-lg",children:"\ud83c\udff9"})]}),e.isCritical&&(0,bt.jsx)("div",{className:"text-xs text-red-600 font-medium",children:"\ud83d\udd25 Tarea Cr\xedtica"})]}),e.isCritical&&(0,bt.jsx)("div",{className:"ml-3",children:(0,bt.jsx)("span",{className:"inline-block bg-red-100 text-red-800 text-xs px-2 py-1 rounded-full",children:"\ud83d\udd25 Cr\xedtica"})})]})},e.id)),(0,bt.jsxs)("div",{className:"mt-4 p-3 bg-white rounded-lg border border-gray-200",children:[(0,bt.jsx)("div",{className:"text-xs font-medium text-gray-700 mb-2",children:"RESUMEN"}),(0,bt.jsxs)("div",{className:"space-y-1 text-xs text-gray-600",children:[(0,bt.jsxs)("div",{className:"flex justify-between",children:[(0,bt.jsx)("span",{children:"Progreso Total:"}),(0,bt.jsxs)("span",{className:"font-medium",children:[ut.progressPercentage,"%"]})]}),(0,bt.jsxs)("div",{className:"flex justify-between",children:[(0,bt.jsx)("span",{children:"Tareas Cr\xedticas:"}),(0,bt.jsx)("span",{className:"font-medium text-red-600",children:ut.criticalTasks})]}),(0,bt.jsxs)("div",{className:"flex justify-between",children:[(0,bt.jsx)("span",{children:"Completadas:"}),(0,bt.jsx)("span",{className:"font-medium text-green-600",children:ut.completedTasks})]})]})]})]})}),(0,bt.jsxs)("div",{className:"flex-1 flex flex-col max-w-full",style:{height:"600px",maxWidth:"calc(100vw - 400px)"},children:[(0,bt.jsx)("div",{className:"bg-gray-100 border-b p-2 flex-shrink-0",style:{backgroundColor:"#f9fafb",borderBottom:"1px solid #e5e7eb"},children:(0,bt.jsx)("div",{ref:Je,onScroll:e=>{ze.current&&!Xe.current&&(Xe.current=!0,console.log("\ud83d\udd04 SINCRONIZANDO CONTENIDO - scrollLeft:",e.currentTarget.scrollLeft),console.log("\ud83d\udccf ANCHOS CONTENEDORES (desde headers):",{headerContainerWidth:e.currentTarget.scrollWidth,headerContainerClientWidth:e.currentTarget.clientWidth,rightContainerWidth:ze.current.scrollWidth,rightContainerClientWidth:ze.current.clientWidth,chartWidthPx:dt}),ze.current.scrollLeft=e.currentTarget.scrollLeft,setTimeout(()=>{Xe.current=!1},10))},className:"overflow-x-auto scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-200",style:{width:"100%",maxWidth:"100%"},children:(0,bt.jsx)("div",{className:"flex",style:{width:Math.max(dt+100,800),minWidth:Math.max(dt+100,800)},children:(()=>{const e=[],t=Tt,r=new Date(t),a=new Date(Cj(ot.end));if(console.log("\ud83c\udfc1 TIMELINE HEADERS RANGO:",{startDate:Cj(r),endDate:Cj(a),ganttScale:I,projectDatesStart:Cj(ot.start),projectDatesEnd:Cj(ot.end),includeWeekends:h,startReference:Cj(t),pxPerDay:ct,chartWidthPx:dt}),"days"===I){const t=new Date(r);for(;t<=a;)(h||Aj(t))&&e.push({label:t.getDate(),sub:t.toLocaleDateString("es",{month:"short"}),width:ct}),t.setDate(t.getDate()+1)}else if("weeks"===I){const t=new Date(r);for(;t<=a;){const r=new Date(t),s=new Date(t);s.setDate(s.getDate()+6);const n=Math.min(7,Ij(r,Dj(a,1,h),h));e.push({label:"S ".concat(r.getDate(),"\u2014").concat(s.getDate()),sub:r.toLocaleDateString("es",{month:"short"}),width:n*ct}),t.setDate(t.getDate()+7)}}else{const t=new Date(r.getFullYear(),r.getMonth(),1);for(;t<=a;){const r=new Date(t.getFullYear(),t.getMonth()+1,1),a=Ij(Cj(t),Cj(r),h);e.push({label:t.toLocaleDateString("es",{month:"short"}),sub:t.getFullYear(),width:a*ct}),t.setMonth(t.getMonth()+1)}}return console.log("\ud83c\udfc1 TIMELINE HEADERS GENERADOS:",{totalHeaders:e.length,totalWidth:e.reduce((e,t)=>e+t.width,0),firstHeader:e[0],lastHeader:e[e.length-1]}),e})().map((e,t)=>(0,bt.jsxs)("div",{className:"text-xs text-gray-600 text-center border-r border-gray-200 flex-shrink-0",style:{width:e.width,minWidth:e.width},children:[(0,bt.jsx)("div",{className:"font-medium",children:e.label}),(0,bt.jsx)("div",{className:"text-gray-400",children:e.sub})]},t))})})}),(0,bt.jsx)("div",{ref:ze,onScroll:e=>{Le.current&&(Le.current.scrollTop=e.currentTarget.scrollTop),Je.current&&!Xe.current&&(Xe.current=!0,console.log("\ud83d\udd04 SINCRONIZANDO HEADERS - scrollLeft:",e.currentTarget.scrollLeft),console.log("\ud83d\udccf ANCHOS CONTENEDORES:",{headerContainerWidth:Je.current.scrollWidth,headerContainerClientWidth:Je.current.clientWidth,rightContainerWidth:e.currentTarget.scrollWidth,rightContainerClientWidth:e.currentTarget.clientWidth,chartWidthPx:dt}),Je.current.scrollLeft=e.currentTarget.scrollLeft,setTimeout(()=>{Xe.current=!1},10))},className:"flex-1 overflow-x-auto overflow-y-auto scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-200",children:(0,bt.jsx)("div",{style:{width:Math.max(dt+100,800)},children:(0,bt.jsxs)("div",{className:"relative",children:[_t>0&&_t<dt&&(0,bt.jsx)("div",{className:"absolute z-10 w-0.5 bg-red-500",style:{left:_t,top:0,height:"600px"},children:(0,bt.jsx)("div",{className:"bg-red-500 text-white text-xs px-1 py-0.5 rounded -mt-2 -ml-6",children:"HOY"})}),Ct().map((e,t)=>(0,bt.jsxs)("div",{className:"absolute",style:{left:e.leftPx,top:58*t+10+5,width:e.widthPx,height:40},children:[(0,bt.jsxs)("div",{className:"h-8 transition-all duration-200 cursor-default hover:opacity-80 ".concat(e.isMilestone?"rounded-full":"rounded-lg"),title:"Solo lectura - Edita desde la Vista Tabla",style:{width:e.isMilestone?"12px":"100%",height:"100%",background:e.isMilestone?"linear-gradient(45deg, #8b5cf6, #7c3aed)":e.isCritical&&R?"linear-gradient(45deg, #ef4444, #dc2626)":e.isCritical?"linear-gradient(45deg, #f97316, #ea580c)":"linear-gradient(45deg, #6366f1, #4f46e5)",border:e.isCritical&&R?"2px solid #dc2626":"none",boxShadow:e.isCritical&&R?"0 0 10px rgba(239, 68, 68, 0.5)":"none"},children:[(0,bt.jsx)("div",{className:"h-full bg-green-400 rounded-l transition-all duration-200",style:{width:"".concat(e.progress,"%"),background:"linear-gradient(45deg, #4ade80, #22c55e)"}}),(0,bt.jsx)("div",{className:"absolute inset-0 flex items-center justify-center text-white text-xs font-medium px-2",children:(0,bt.jsx)("span",{className:"truncate",children:e.name})})]}),U&&We.has(e.id)&&(0,bt.jsx)("div",{className:"absolute top-0 h-full border-2 border-dashed border-gray-700 opacity-90",style:{left:"".concat(Ij(Cj(ot.start),We.get(e.id).startDate,h)*ct,"px"),width:"".concat(Math.max(1,Mj(We.get(e.id).startDate,We.get(e.id).endDate,h)*ct),"px"),boxShadow:"0 0 4px rgba(55, 65, 81, 0.4)"}}),F&&e.predecessors.length>0&&(0,bt.jsx)("div",{className:"absolute -top-2 left-0 w-full",children:e.predecessors.map((r,a)=>{if(!Ve.find(e=>e.id===r))return null;const s=Ct().find(e=>e.id===r);if(!s)return null;const n=s.leftPx+s.widthPx,i=58*Ve.findIndex(e=>e.id===r)+10+5+20,o=e.leftPx,l=58*t+10+5+20;return(0,bt.jsxs)("svg",{className:"absolute pointer-events-none",style:{left:0,top:0,width:"100%",height:"100%"},children:[(0,bt.jsx)("defs",{children:(0,bt.jsx)("marker",{id:"arrow-".concat(e.id,"-").concat(r),markerWidth:"10",markerHeight:"10",refX:"9",refY:"3",orient:"auto",markerUnits:"strokeWidth",children:(0,bt.jsx)("polygon",{points:"0,0 0,6 9,3",fill:e.isCritical?"#ef4444":"#6366f1"})})}),(0,bt.jsx)("line",{x1:n,y1:i,x2:o,y2:l,stroke:e.isCritical?"#ef4444":"#6366f1",strokeWidth:"2",markerEnd:"url(#arrow-".concat(e.id,"-").concat(r,")"),strokeDasharray:e.isCritical?"none":"5,5"})]},a)})})]},e.id))]})})})]})]})]})]}),!1,"minutas"===y&&(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-6 pb-32",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,bt.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"\ud83d\udccb Tareas de Minutas"}),(0,bt.jsxs)("button",{onClick:yt,className:"bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 flex items-center space-x-2 transition-all duration-300",children:[(0,bt.jsx)("span",{children:"\u2795"}),(0,bt.jsx)("span",{children:"Nueva Minuta"})]})]}),Z?(0,bt.jsx)("div",{className:"text-center py-12",children:(0,bt.jsxs)("div",{className:"bg-gray-100 rounded-xl p-8",children:[(0,bt.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,bt.jsx)("h3",{className:"text-xl font-semibold text-gray-600 mb-2",children:"Cargando minutas..."}),(0,bt.jsxs)("p",{className:"text-gray-500",children:["Obteniendo datos desde ",m?"Supabase":"localStorage"]})]})}):0===X.length?(0,bt.jsx)("div",{className:"text-center py-12",children:(0,bt.jsxs)("div",{className:"bg-gray-100 rounded-xl p-8",children:[(0,bt.jsx)("span",{className:"text-6xl mb-4 block",children:"\ud83d\udcdd"}),(0,bt.jsx)("h3",{className:"text-xl font-semibold text-gray-600 mb-2",children:"No hay tareas de minutas"}),(0,bt.jsx)("p",{className:"text-gray-500 mb-4",children:'Crea tu primera minuta haciendo clic en "Nueva Minuta"'}),(0,bt.jsx)("button",{onClick:yt,className:"bg-green-500 text-white px-6 py-3 rounded-lg hover:bg-green-600 transition-colors",children:"\u2795 Crear Primera Minuta"})]})}):(0,bt.jsxs)("div",{className:"space-y-6",children:[o.filter(e=>e.isMilestone).map(e=>{const t=X.filter(t=>t.hitoId===e.id);return 0===t.length?null:(0,bt.jsxs)("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[(0,bt.jsx)("div",{className:"bg-blue-50 px-4 py-3 border-b border-gray-200",children:(0,bt.jsxs)("h3",{className:"font-semibold text-gray-800",children:["\ud83c\udfaf ",e.wbsCode," - ",e.name]})}),(0,bt.jsx)("div",{className:"overflow-x-auto",children:(0,bt.jsxs)("table",{className:"w-full",children:[(0,bt.jsx)("thead",{className:"bg-gray-50",children:(0,bt.jsxs)("tr",{children:[(0,bt.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 w-1/3",children:"Tarea"}),(0,bt.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 w-1/6",children:"Responsable"}),(0,bt.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 w-1/8",children:"Fecha"}),(0,bt.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 w-1/8",children:"Estatus"}),(0,bt.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 w-1/8",children:"Creada"}),(0,bt.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 w-1/8",children:"Acciones"})]})}),(0,bt.jsx)("tbody",{className:"divide-y divide-gray-200",children:t.sort((e,t)=>new Date(e.fecha)-new Date(t.fecha)).map((e,t)=>(0,bt.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,bt.jsx)("td",{className:"px-4 py-3 text-sm text-gray-900",children:e.tarea}),(0,bt.jsx)("td",{className:"px-4 py-3 text-sm text-gray-700",children:e.responsable}),(0,bt.jsx)("td",{className:"px-4 py-3 text-sm text-gray-700",children:(()=>{try{const t=new Date(e.fecha);return isNaN(t.getTime())?"Fecha inv\xe1lida":t.toLocaleDateString("es-ES")}catch(t){return"Fecha inv\xe1lida"}})()}),(0,bt.jsx)("td",{className:"px-4 py-3 text-sm",children:(0,bt.jsxs)("select",{value:e.estatus,onChange:async t=>{const r=t.target.value;if(Q(t=>t.map(t=>t.id===e.id?(0,n.A)((0,n.A)({},t),{},{estatus:r}):t)),m)try{const t=await Nt.default.updateMinutaStatus(e.id,r);t.success||(console.error("\u274c Error actualizando estatus en Supabase:",t.error),Q(t=>t.map(t=>t.id===e.id?(0,n.A)((0,n.A)({},t),{},{estatus:e.estatus}):t)))}catch(a){console.error("\u274c Error actualizando estatus:",a)}},className:"px-3 py-1 rounded-full text-xs font-medium border-none ".concat("Pendiente"===e.estatus?"bg-yellow-100 text-yellow-800":"En Proceso"===e.estatus?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"),children:[(0,bt.jsx)("option",{value:"Pendiente",children:"Pendiente"}),(0,bt.jsx)("option",{value:"En Proceso",children:"En Proceso"}),(0,bt.jsx)("option",{value:"Completado",children:"Completado"})]})}),(0,bt.jsx)("td",{className:"px-4 py-3 text-sm text-gray-500",children:(()=>{try{const t=new Date(e.fechaCreacion);return isNaN(t.getTime())?"Fecha inv\xe1lida":t.toLocaleDateString("es-ES")}catch(t){return"Fecha inv\xe1lida"}})()}),(0,bt.jsx)("td",{className:"px-4 py-3 text-sm",children:(0,bt.jsx)("button",{onClick:()=>wt(e),className:"text-blue-600 hover:text-blue-800 transition-colors",title:"Editar minuta",children:"\u270f\ufe0f Editar"})})]},e.id))})]})})]},e.id)}),X.filter(e=>{if(!e.hitoId)return!0;const t=o.find(t=>t.id===e.hitoId&&t.isMilestone);return t||(console.log("\ud83d\udd0d DEBUG: Tarea ".concat(e.id," busca hito ").concat(e.hitoId," pero no se encuentra")),console.log("\ud83d\udd0d DEBUG: Hitos disponibles:",o.filter(e=>e.isMilestone).map(e=>({id:e.id,name:e.name})))),!t}).length>0&&(0,bt.jsxs)("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[(0,bt.jsx)("div",{className:"bg-gray-50 px-4 py-3 border-b border-gray-200",children:(0,bt.jsx)("h3",{className:"font-semibold text-gray-800",children:"\ud83d\udccb Sin hito asignado"})}),(0,bt.jsx)("div",{className:"overflow-x-auto",children:(0,bt.jsxs)("table",{className:"w-full",children:[(0,bt.jsx)("thead",{className:"bg-gray-50",children:(0,bt.jsxs)("tr",{children:[(0,bt.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 w-1/3",children:"Tarea"}),(0,bt.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 w-1/6",children:"Responsable"}),(0,bt.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 w-1/8",children:"Fecha"}),(0,bt.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 w-1/8",children:"Estatus"}),(0,bt.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 w-1/8",children:"Creada"}),(0,bt.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 w-1/8",children:"Acciones"})]})}),(0,bt.jsx)("tbody",{className:"divide-y divide-gray-200",children:X.filter(e=>{if(!e.hitoId)return!0;return!o.find(t=>t.id===e.hitoId&&t.isMilestone)}).sort((e,t)=>new Date(e.fecha)-new Date(t.fecha)).map(e=>(0,bt.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,bt.jsx)("td",{className:"px-4 py-3 text-sm text-gray-900",children:e.tarea}),(0,bt.jsx)("td",{className:"px-4 py-3 text-sm text-gray-700",children:e.responsable}),(0,bt.jsx)("td",{className:"px-4 py-3 text-sm text-gray-700",children:(()=>{try{const t=new Date(e.fecha);return isNaN(t.getTime())?"Fecha inv\xe1lida":t.toLocaleDateString("es-ES")}catch(t){return"Fecha inv\xe1lida"}})()}),(0,bt.jsx)("td",{className:"px-4 py-3 text-sm",children:(0,bt.jsxs)("select",{value:e.estatus,onChange:async t=>{const r=t.target.value;if(Q(t=>t.map(t=>t.id===e.id?(0,n.A)((0,n.A)({},t),{},{estatus:r}):t)),m)try{const t=await Nt.default.updateMinutaStatus(e.id,r);t.success||(console.error("\u274c Error actualizando estatus en Supabase:",t.error),Q(t=>t.map(t=>t.id===e.id?(0,n.A)((0,n.A)({},t),{},{estatus:e.estatus}):t)))}catch(a){console.error("\u274c Error actualizando estatus:",a)}},className:"px-3 py-1 rounded-full text-xs font-medium border-none ".concat("Pendiente"===e.estatus?"bg-yellow-100 text-yellow-800":"En Proceso"===e.estatus?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"),children:[(0,bt.jsx)("option",{value:"Pendiente",children:"Pendiente"}),(0,bt.jsx)("option",{value:"En Proceso",children:"En Proceso"}),(0,bt.jsx)("option",{value:"Completado",children:"Completado"})]})}),(0,bt.jsx)("td",{className:"px-4 py-3 text-sm text-gray-500",children:(()=>{try{const t=new Date(e.fechaCreacion);return isNaN(t.getTime())?"Fecha inv\xe1lida":t.toLocaleDateString("es-ES")}catch(t){return"Fecha inv\xe1lida"}})()}),(0,bt.jsx)("td",{className:"px-4 py-3 text-sm",children:(0,bt.jsx)("button",{onClick:()=>wt(e),className:"text-blue-600 hover:text-blue-800 transition-colors",title:"Editar minuta",children:"\u270f\ufe0f Editar"})})]},e.id))})]})})]})]})]}),g&&"gantt"===y&&(0,bt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-md",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,bt.jsx)("h2",{className:"text-xl font-bold text-gray-800",children:"\ud83d\udcca Vista Solo Lectura"}),(0,bt.jsx)("button",{onClick:()=>x(null),className:"text-gray-500 hover:text-gray-700 text-2xl",children:"\u2715"})]}),(0,bt.jsxs)("div",{className:"text-center",children:[(0,bt.jsx)("div",{className:"text-4xl mb-4",children:"\ud83d\udc41\ufe0f"}),(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:g.name}),(0,bt.jsx)("p",{className:"text-gray-600 mb-4",children:"Esta es la vista de solo lectura del diagrama Gantt."}),(0,bt.jsxs)("p",{className:"text-sm text-gray-500 mb-6",children:["Para editar esta tarea, cambia a la ",(0,bt.jsx)("strong",{children:"Vista Tabla"}),"."]}),(0,bt.jsxs)("div",{className:"flex space-x-3",children:[(0,bt.jsx)("button",{onClick:()=>w("excel"),className:"flex-1 bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors",children:"\ud83d\udccb Ir a Vista Tabla"}),(0,bt.jsx)("button",{onClick:()=>x(null),className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cerrar"})]})]})]})}),g&&"gantt"!==y&&(0,bt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,bt.jsx)("h2",{className:"text-2xl font-bold",children:g.name}),(0,bt.jsx)("button",{onClick:()=>x(null),className:"text-gray-500 hover:text-gray-700 text-2xl",children:"\u2715"})]}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Informaci\xf3n B\xe1sica"}),(0,bt.jsxs)("div",{className:"space-y-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre de la Tarea"}),(0,bt.jsx)("input",{type:"text",value:g.name,onChange:e=>x(t=>({id:t.id,wbsCode:t.wbsCode,name:e.target.value,duration:t.duration,startDate:t.startDate,endDate:t.endDate,progress:t.progress,predecessors:[...t.predecessors||[]],cost:t.cost,priority:t.priority,assignedTo:t.assignedTo,isMilestone:t.isMilestone,isCritical:t.isCritical,originalDuration:t.originalDuration,earlyStart:t.earlyStart,earlyFinish:t.earlyFinish,lateStart:t.lateStart,lateFinish:t.lateFinish,totalFloat:t.totalFloat,freeFloat:t.freeFloat,description:t.description,resources:[...t.resources||[]],workPackageId:t.workPackageId,status:t.status,successors:[...t.successors||[]]})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Duraci\xf3n (d\xedas)"}),(0,bt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,bt.jsx)("button",{onClick:()=>x(e=>({id:e.id,wbsCode:e.wbsCode,name:e.name,duration:Math.max(1,e.duration-1),startDate:e.startDate,endDate:e.endDate,progress:e.progress,predecessors:[...e.predecessors||[]],cost:e.cost,priority:e.priority,assignedTo:e.assignedTo,isMilestone:e.isMilestone,isCritical:e.isCritical,originalDuration:e.originalDuration,earlyStart:e.earlyStart,earlyFinish:e.earlyFinish,lateStart:e.lateStart,lateFinish:e.lateFinish,totalFloat:e.totalFloat,freeFloat:e.freeFloat,description:e.description,resources:[...e.resources||[]],workPackageId:e.workPackageId,status:e.status,successors:[...e.successors||[]]})),className:"px-3 py-1 bg-gray-200 rounded hover:bg-gray-300",children:"-"}),(0,bt.jsx)("input",{type:"number",value:g.duration,onChange:e=>x(t=>({id:t.id,wbsCode:t.wbsCode,name:t.name,duration:parseInt(e.target.value)||1,startDate:t.startDate,endDate:t.endDate,progress:t.progress,predecessors:[...t.predecessors||[]],cost:t.cost,priority:t.priority,assignedTo:t.assignedTo,isMilestone:t.isMilestone,isCritical:t.isCritical,originalDuration:t.originalDuration,earlyStart:t.earlyStart,earlyFinish:t.earlyFinish,lateStart:t.lateStart,lateFinish:t.lateFinish,totalFloat:t.totalFloat,freeFloat:t.freeFloat,description:t.description,resources:[...t.resources||[]],workPackageId:t.workPackageId,status:t.status,successors:[...t.successors||[]]})),className:"w-20 px-3 py-2 border border-gray-300 rounded-lg text-center focus:outline-none focus:ring-2 focus:ring-indigo-500",min:"1"}),(0,bt.jsx)("button",{onClick:()=>x(e=>({id:e.id,wbsCode:e.wbsCode,name:e.name,duration:e.duration+1,startDate:e.startDate,endDate:e.endDate,progress:e.progress,predecessors:[...e.predecessors||[]],cost:e.cost,priority:e.priority,assignedTo:e.assignedTo,isMilestone:e.isMilestone,isCritical:e.isCritical,originalDuration:e.originalDuration,earlyStart:e.earlyStart,earlyFinish:e.earlyFinish,lateStart:e.lateStart,lateFinish:e.lateFinish,totalFloat:e.totalFloat,freeFloat:e.freeFloat,description:e.description,resources:[...e.resources||[]],workPackageId:e.workPackageId,status:e.status,successors:[...e.successors||[]]})),className:"px-3 py-1 bg-gray-200 rounded hover:bg-gray-300",children:"+"})]})]})]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Dependencias"}),(0,bt.jsxs)("div",{className:"mb-6",children:[(0,bt.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Predecesoras (",(null===(r=g.predecessors)||void 0===r?void 0:r.length)||0,")"]}),(0,bt.jsx)("div",{className:"space-y-2 max-h-32 overflow-y-auto border border-gray-200 rounded-lg p-2",children:o.filter(e=>e.id!==g.id).map(e=>{var t;return(0,bt.jsxs)("label",{className:"flex items-center space-x-2 cursor-pointer hover:bg-gray-50 p-1 rounded",children:[(0,bt.jsx)("input",{type:"checkbox",checked:(null===(t=g.predecessors)||void 0===t?void 0:t.includes(e.id))||!1,onChange:t=>{const r=g.predecessors||[];t.target.checked?x(t=>({id:t.id,wbsCode:t.wbsCode,name:t.name,duration:t.duration,startDate:t.startDate,endDate:t.endDate,progress:t.progress,predecessors:[...r||[],e.id],cost:t.cost,priority:t.priority,assignedTo:t.assignedTo,isMilestone:t.isMilestone,isCritical:t.isCritical,originalDuration:t.originalDuration,earlyStart:t.earlyStart,earlyFinish:t.earlyFinish,lateStart:t.lateStart,lateFinish:t.lateFinish,totalFloat:t.totalFloat,freeFloat:t.freeFloat,description:t.description,resources:[...t.resources||[]],workPackageId:t.workPackageId,status:t.status,successors:[...t.successors||[]]})):x(t=>({id:t.id,wbsCode:t.wbsCode,name:t.name,duration:t.duration,startDate:t.startDate,endDate:t.endDate,progress:t.progress,predecessors:r.filter(t=>t!==e.id),cost:t.cost,priority:t.priority,assignedTo:t.assignedTo,isMilestone:t.isMilestone,isCritical:t.isCritical,originalDuration:t.originalDuration,earlyStart:t.earlyStart,earlyFinish:t.earlyFinish,lateStart:t.lateStart,lateFinish:t.lateFinish,totalFloat:t.totalFloat,freeFloat:t.freeFloat,description:t.description,resources:[...t.resources||[]],workPackageId:t.workPackageId,status:t.status,successors:[...t.successors||[]]}))},className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),(0,bt.jsxs)("span",{className:"text-sm",children:[e.wbsCode," - ",e.name]})]},e.id)})})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Sucesoras (",(null===(s=g.successors)||void 0===s?void 0:s.length)||0,")"]}),(0,bt.jsx)("div",{className:"space-y-2 max-h-32 overflow-y-auto border border-gray-200 rounded-lg p-2",children:o.filter(e=>e.id!==g.id).map(e=>{var t;return(0,bt.jsxs)("label",{className:"flex items-center space-x-2 cursor-pointer hover:bg-gray-50 p-1 rounded",children:[(0,bt.jsx)("input",{type:"checkbox",checked:(null===(t=g.successors)||void 0===t?void 0:t.includes(e.id))||!1,onChange:t=>{const r=g.successors||[];t.target.checked?x(t=>({id:t.id,wbsCode:t.wbsCode,name:t.name,duration:t.duration,startDate:t.startDate,endDate:t.endDate,progress:t.progress,predecessors:[...t.predecessors||[]],cost:t.cost,priority:t.priority,assignedTo:t.assignedTo,isMilestone:t.isMilestone,isCritical:t.isCritical,originalDuration:t.originalDuration,earlyStart:t.earlyStart,earlyFinish:t.earlyFinish,lateStart:t.lateStart,lateFinish:t.lateFinish,totalFloat:t.totalFloat,freeFloat:t.freeFloat,description:t.description,resources:[...t.resources||[]],workPackageId:t.workPackageId,status:t.status,successors:r.slice().concat([e.id])})):x(t=>({id:t.id,wbsCode:t.wbsCode,name:t.name,duration:t.duration,startDate:t.startDate,endDate:t.endDate,progress:t.progress,predecessors:[...t.predecessors||[]],cost:t.cost,priority:t.priority,assignedTo:t.assignedTo,isMilestone:t.isMilestone,isCritical:t.isCritical,originalDuration:t.originalDuration,earlyStart:t.earlyStart,earlyFinish:t.earlyFinish,lateStart:t.lateStart,lateFinish:t.lateFinish,totalFloat:t.totalFloat,freeFloat:t.freeFloat,description:t.description,resources:[...t.resources||[]],workPackageId:t.workPackageId,status:t.status,successors:r.filter(t=>t!==e.id)}))},className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),(0,bt.jsxs)("span",{className:"text-sm",children:[e.wbsCode," - ",e.name]})]},e.id)})})]})]})]}),(0,bt.jsxs)("div",{className:"flex justify-end space-x-3 mt-6 pt-6 border-t border-gray-200",children:[(0,bt.jsx)("button",{onClick:()=>x(null),className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancelar"}),(0,bt.jsx)("button",{onClick:()=>{console.log("\ud83c\udd95 MODAL NUEVO - Guardando tarea:",g),l(e=>e.map(e=>e.id===g.id?{id:e.id,wbsCode:e.wbsCode,name:g.name,duration:g.duration,startDate:e.startDate,endDate:e.endDate,progress:e.progress,predecessors:[...e.predecessors||[]],cost:e.cost,priority:e.priority,assignedTo:e.assignedTo,isMilestone:e.isMilestone,isCritical:e.isCritical,originalDuration:e.originalDuration,earlyStart:e.earlyStart,earlyFinish:e.earlyFinish,lateStart:e.lateStart,lateFinish:e.lateFinish,totalFloat:e.totalFloat,freeFloat:e.freeFloat,description:e.description,resources:[...e.resources||[]],workPackageId:e.workPackageId,status:e.status,successors:[...e.successors||[]],predecessors:g.predecessors||[],successors:g.successors||[]}:e)),x(null)},className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700",children:"Guardar Cambios"})]})]})}),!1,console.log("\ud83d\udd0d RENDERIZADO - selectedTask existe?",!!g,g),!1,H&&(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-6",children:[(0,bt.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Caso de Negocio"}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h3",{className:"text-xl font-semibold mb-2",children:"Informaci\xf3n del Proyecto"}),(0,bt.jsxs)("p",{children:[(0,bt.jsx)("strong",{children:"Nombre:"})," ",p.projectName]}),(0,bt.jsxs)("p",{children:[(0,bt.jsx)("strong",{children:"Fecha de Inicio:"})," ",new Date(p.startDate).toLocaleDateString("es")]}),(0,bt.jsxs)("p",{children:[(0,bt.jsx)("strong",{children:"Fecha de Fin Planificada:"})," ",new Date(p.plannedEndDate).toLocaleDateString("es")]}),(0,bt.jsxs)("p",{children:[(0,bt.jsx)("strong",{children:"Inversi\xf3n Total:"})," $",p.totalInvestment.toLocaleString()]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h3",{className:"text-xl font-semibold mb-2",children:"Beneficios Esperados"}),(0,bt.jsxs)("p",{children:[(0,bt.jsx)("strong",{children:"Objetivo:"})," ",p.objective]}),(0,bt.jsxs)("p",{children:[(0,bt.jsx)("strong",{children:"Patrocinador:"})," ",p.sponsor]}),(0,bt.jsxs)("p",{children:[(0,bt.jsx)("strong",{children:"Gerente del Proyecto:"})," ",p.manager]}),(0,bt.jsxs)("p",{children:[(0,bt.jsx)("strong",{children:"Beneficios:"})," ",p.expectedBenefits]}),(0,bt.jsxs)("p",{children:[(0,bt.jsx)("strong",{children:"TIR (%):"})," ",p.irr]}),(0,bt.jsxs)("p",{children:[(0,bt.jsx)("strong",{children:"ROI (%):"})," ",p.roi]}),(0,bt.jsxs)("p",{children:[(0,bt.jsx)("strong",{children:"Tiempo de Retorno (a\xf1os):"})," ",p.paybackPeriod]}),(0,bt.jsxs)("p",{children:[(0,bt.jsx)("strong",{children:"VPN:"})," $",p.npv.toLocaleString()]})]})]}),(0,bt.jsx)("div",{className:"flex justify-end mt-4",children:(0,bt.jsx)("button",{onClick:()=>V(!1),className:"bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400",children:"Cerrar"})})]}),G&&(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-6",children:[(0,bt.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"An\xe1lisis de Recursos"}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h3",{className:"text-xl font-semibold mb-2",children:"Carga de Recursos"}),Object.entries(Ge.resourceLoad).map(e=>{let[t,r]=e;return(0,bt.jsxs)("div",{children:[(0,bt.jsxs)("p",{children:[(0,bt.jsxs)("strong",{children:[t,":"]})," ",r.length," tareas"]}),(0,bt.jsx)("ul",{children:r.map(e=>(0,bt.jsxs)("li",{children:[e.taskName," (D\xedas: ",Ij(e.startDate,Dj(e.endDate,1,h),h),")"]},e.taskId))})]},t)})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h3",{className:"text-xl font-semibold mb-2",children:"Conflictos de Recursos"}),Ge.conflicts.map(e=>(0,bt.jsxs)("p",{className:"text-red-600 text-sm",children:["Conflicto entre ",e.task1," y ",e.task2,' por el recurso "',e.resource,'" por ',e.overlapDays," d\xedas."]},e.resource))]})]}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h3",{className:"text-xl font-semibold mb-2",children:"Utilizaci\xf3n de Recursos"}),Object.entries(Ge.utilization).map(e=>{let[t,r]=e;return(0,bt.jsxs)("p",{children:[(0,bt.jsxs)("strong",{children:[t,":"]})," ",r," d\xedas"]},t)})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h3",{className:"text-xl font-semibold mb-2",children:"M\xe9tricas de Recursos"}),(0,bt.jsxs)("p",{children:[(0,bt.jsx)("strong",{children:"Total de Recursos:"})," ",Object.keys(Ge.utilization).length]}),(0,bt.jsxs)("p",{children:[(0,bt.jsx)("strong",{children:"Total de D\xedas Asignados:"})," ",Object.values(Ge.utilization).reduce((e,t)=>e+t,0)," d\xedas"]})]})]}),(0,bt.jsx)("div",{className:"flex justify-end mt-4",children:(0,bt.jsx)("button",{onClick:()=>q(!1),className:"bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400",children:"Cerrar"})})]}),!1,ht&&(0,bt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,bt.jsx)("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:(0,bt.jsxs)("div",{className:"p-6",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:mt.insertAfterTaskId?"\ud83d\ude80 Insertar Nueva Tarea":"\ud83d\ude80 Agregar Nueva Tarea"}),mt.insertAfterTaskId&&(0,bt.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["La tarea se insertar\xe1 despu\xe9s de: ",(0,bt.jsx)("span",{className:"font-medium text-indigo-600",children:(null===(i=Ve.find(e=>e.id===mt.insertAfterTaskId))||void 0===i?void 0:i.name)||"Tarea anterior"})]})]}),(0,bt.jsx)("button",{onClick:()=>ft(!1),className:"text-gray-400 hover:text-gray-600 text-2xl",children:"\xd7"})]}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,bt.jsxs)("div",{className:"space-y-4",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-700 border-b pb-2",children:"\ud83d\udccb Informaci\xf3n B\xe1sica"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre de la Tarea *"}),(0,bt.jsx)("input",{type:"text",value:mt.name,onChange:e=>pt(t=>({name:e.target.value,duration:t.duration,startDate:t.startDate,endDate:t.endDate,description:t.description,priority:t.priority,assignedTo:t.assignedTo,cost:t.cost,selectedPredecessors:[...t.selectedPredecessors||[]],selectedSuccessors:[...t.selectedSuccessors||[]]})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Ingresa el nombre de la tarea"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripci\xf3n"}),(0,bt.jsx)("textarea",{value:mt.description,onChange:e=>pt(t=>({name:t.name,duration:t.duration,startDate:t.startDate,endDate:t.endDate,description:e.target.value,priority:t.priority,assignedTo:t.assignedTo,cost:t.cost,selectedPredecessors:[...t.selectedPredecessors||[]],selectedSuccessors:[...t.selectedSuccessors||[]]})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:"3",placeholder:"Describe la tarea..."})]}),(0,bt.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Duraci\xf3n (d\xedas) *"}),(0,bt.jsx)("input",{type:"number",min:"1",value:mt.duration,onChange:e=>{const t=parseInt(e.target.value)||1,r=Dj(mt.startDate,t,h);pt(e=>({name:e.name,duration:t,startDate:e.startDate,endDate:r,description:e.description,priority:e.priority,assignedTo:e.assignedTo,cost:e.cost,selectedPredecessors:[...e.selectedPredecessors||[]],selectedSuccessors:[...e.selectedSuccessors||[]]}))},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Costo ($)"}),(0,bt.jsx)("input",{type:"number",min:"0",step:"0.01",value:mt.cost,onChange:e=>pt(t=>({name:t.name,duration:t.duration,startDate:t.startDate,endDate:t.endDate,description:t.description,priority:t.priority,assignedTo:t.assignedTo,cost:parseFloat(e.target.value)||0,selectedPredecessors:[...t.selectedPredecessors||[]],selectedSuccessors:[...t.selectedSuccessors||[]]})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),(0,bt.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha de Inicio *"}),(0,bt.jsx)("input",{type:"date",value:mt.startDate,onChange:e=>{const t=e.target.value,r=Dj(t,mt.duration,h);pt(e=>({name:e.name,duration:e.duration,startDate:t,endDate:r,description:e.description,priority:e.priority,assignedTo:e.assignedTo,cost:e.cost,selectedPredecessors:[...e.selectedPredecessors||[]],selectedSuccessors:[...e.selectedSuccessors||[]]}))},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha de Fin"}),(0,bt.jsx)("input",{type:"date",value:mt.endDate,onChange:e=>{const t=e.target.value,r=Math.ceil((new Date(t)-new Date(mt.startDate))/864e5);pt(e=>({name:e.name,duration:r>0?r:1,startDate:e.startDate,endDate:t,description:e.description,priority:e.priority,assignedTo:e.assignedTo,cost:e.cost,selectedPredecessors:[...e.selectedPredecessors||[]],selectedSuccessors:[...e.selectedSuccessors||[]]}))},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),(0,bt.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prioridad"}),(0,bt.jsxs)("select",{value:mt.priority,onChange:e=>pt(t=>({name:t.name,duration:t.duration,startDate:t.startDate,endDate:t.endDate,description:t.description,priority:e.target.value,assignedTo:t.assignedTo,cost:t.cost,selectedPredecessors:[...t.selectedPredecessors||[]],selectedSuccessors:[...t.selectedSuccessors||[]]})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,bt.jsx)("option",{value:"low",children:"\ud83d\udfe2 Baja"}),(0,bt.jsx)("option",{value:"medium",children:"\ud83d\udfe1 Media"}),(0,bt.jsx)("option",{value:"high",children:"\ud83d\udd34 Alta"}),(0,bt.jsx)("option",{value:"critical",children:"\ud83d\udea8 Cr\xedtica"})]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asignado a"}),(0,bt.jsx)("input",{type:"text",value:mt.assignedTo,onChange:e=>pt(t=>({name:t.name,duration:t.duration,startDate:t.startDate,endDate:t.endDate,description:t.description,priority:t.priority,assignedTo:e.target.value,cost:t.cost,selectedPredecessors:[...t.selectedPredecessors||[]],selectedSuccessors:[...t.selectedSuccessors||[]]})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Nombre del responsable"})]})]})]}),(0,bt.jsxs)("div",{className:"space-y-4",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-700 border-b pb-2",children:"\ud83d\udd17 Dependencias"}),(0,bt.jsxs)("div",{children:[(0,bt.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Predecesoras (",mt.selectedPredecessors.length,")"]}),(0,bt.jsx)("div",{className:"space-y-2 max-h-40 overflow-y-auto border border-gray-200 rounded-lg p-3 bg-gray-50",children:0===o.length?(0,bt.jsx)("p",{className:"text-sm text-gray-500 italic",children:"No hay tareas existentes"}):o.map(e=>(0,bt.jsxs)("label",{className:"flex items-center space-x-2 cursor-pointer hover:bg-white p-2 rounded",children:[(0,bt.jsx)("input",{type:"checkbox",checked:mt.selectedPredecessors.includes(e.id),onChange:t=>{t.target.checked?(console.log("\ud83d\ude80 NUEVO SISTEMA - Agregando predecesora:",e.id,e.wbsCode,e.name),pt(t=>{const r=t.selectedPredecessors.slice().concat([e.id]);return console.log("\ud83d\ude80 NUEVO SISTEMA - Predecesoras actualizadas:",r),{name:t.name,duration:t.duration,startDate:t.startDate,endDate:t.endDate,description:t.description,priority:t.priority,assignedTo:t.assignedTo,cost:t.cost,selectedPredecessors:r,selectedSuccessors:[...t.selectedSuccessors||[]]}})):(console.log("\ud83d\ude80 NUEVO SISTEMA - Removiendo predecesora:",e.id,e.wbsCode,e.name),pt(t=>{const r=t.selectedPredecessors.filter(t=>t!==e.id);return console.log("\ud83d\ude80 NUEVO SISTEMA - Predecesoras actualizadas:",r),{name:t.name,duration:t.duration,startDate:t.startDate,endDate:t.endDate,description:t.description,priority:t.priority,assignedTo:t.assignedTo,cost:t.cost,selectedPredecessors:r,selectedSuccessors:[...t.selectedSuccessors||[]]}}))},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,bt.jsxs)("span",{className:"text-sm",children:[(0,bt.jsx)("span",{className:"font-medium",children:e.wbsCode})," - ",e.name]})]},e.id))})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Sucesoras (",mt.selectedSuccessors.length,")"]}),(0,bt.jsx)("div",{className:"space-y-2 max-h-40 overflow-y-auto border border-gray-200 rounded-lg p-3 bg-gray-50",children:0===o.length?(0,bt.jsx)("p",{className:"text-sm text-gray-500 italic",children:"No hay tareas existentes"}):o.map(e=>(0,bt.jsxs)("label",{className:"flex items-center space-x-2 cursor-pointer hover:bg-white p-2 rounded",children:[(0,bt.jsx)("input",{type:"checkbox",checked:mt.selectedSuccessors.includes(e.id),onChange:t=>{t.target.checked?(console.log("\ud83d\ude80 NUEVO SISTEMA - Agregando sucesora:",e.id,e.wbsCode,e.name),pt(t=>{const r=t.selectedSuccessors.slice().concat([e.id]);return console.log("\ud83d\ude80 NUEVO SISTEMA - Sucesoras actualizadas:",r),{name:t.name,duration:t.duration,startDate:t.startDate,endDate:t.endDate,description:t.description,priority:t.priority,assignedTo:t.assignedTo,cost:t.cost,selectedPredecessors:[...t.selectedPredecessors||[]],selectedSuccessors:r}})):(console.log("\ud83d\ude80 NUEVO SISTEMA - Removiendo sucesora:",e.id,e.wbsCode,e.name),pt(t=>{const r=t.selectedSuccessors.filter(t=>t!==e.id);return console.log("\ud83d\ude80 NUEVO SISTEMA - Sucesoras actualizadas:",r),{name:t.name,duration:t.duration,startDate:t.startDate,endDate:t.endDate,description:t.description,priority:t.priority,assignedTo:t.assignedTo,cost:t.cost,selectedPredecessors:[...t.selectedPredecessors||[]],selectedSuccessors:r}}))},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,bt.jsxs)("span",{className:"text-sm",children:[(0,bt.jsx)("span",{className:"font-medium",children:e.wbsCode})," - ",e.name]})]},e.id))})]}),(0,bt.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[(0,bt.jsx)("h4",{className:"text-sm font-medium text-blue-800 mb-2",children:"\ud83d\udca1 Informaci\xf3n sobre Dependencias"}),(0,bt.jsxs)("ul",{className:"text-xs text-blue-700 space-y-1",children:[(0,bt.jsxs)("li",{children:["\u2022 ",(0,bt.jsx)("strong",{children:"Predecesoras:"})," Tareas que deben completarse antes de esta"]}),(0,bt.jsxs)("li",{children:["\u2022 ",(0,bt.jsx)("strong",{children:"Sucesoras:"})," Tareas que dependen de esta tarea"]}),(0,bt.jsx)("li",{children:"\u2022 Las dependencias se sincronizan autom\xe1ticamente"})]})]})]})]}),(0,bt.jsxs)("div",{className:"flex justify-end space-x-3 mt-8 pt-6 border-t border-gray-200",children:[(0,bt.jsx)("button",{onClick:()=>ft(!1),className:"px-6 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancelar"}),(0,bt.jsxs)("button",{onClick:()=>{try{if(console.log("\ud83d\ude80 NUEVO SISTEMA - Creando tarea desde modal"),console.log("\ud83d\ude80 NUEVO SISTEMA - Datos completos del modal:",mt),console.log("\ud83d\ude80 NUEVO SISTEMA - Predecesoras seleccionadas:",mt.selectedPredecessors),console.log("\ud83d\ude80 NUEVO SISTEMA - Sucesoras seleccionadas:",mt.selectedSuccessors),!mt.name.trim())return void alert("Por favor ingresa un nombre para la tarea");if(mt.duration<=0)return void alert("La duraci\xf3n debe ser mayor a 0");const e=()=>{let e,t=1;do{e="1.".concat(t),t++}while(o.some(t=>t.wbsCode===e));return e},t=(()=>{let e,t=1;do{e="TASK-".concat(String(t).padStart(4,"0")),t++}while(o.some(t=>t.id===e));return e})(),r=e();console.log("\ud83d\ude80 DEBUG - Creando tarea con dependencias:",{selectedPredecessors:mt.selectedPredecessors,selectedSuccessors:mt.selectedSuccessors,predecessorsLength:mt.selectedPredecessors.length,successorsLength:mt.selectedSuccessors.length});const a={id:t,wbsCode:r,name:mt.name.trim(),duration:mt.duration,startDate:mt.startDate,endDate:mt.endDate,progress:0,predecessors:mt.selectedPredecessors.slice(),successors:mt.selectedSuccessors.slice(),resources:[],cost:mt.cost,isMilestone:!1,isCritical:!1,originalDuration:mt.duration,earlyStart:mt.startDate,earlyFinish:mt.endDate,lateStart:mt.startDate,lateFinish:mt.endDate,totalFloat:0,freeFloat:0,status:"pending",workPackageId:t,plannedValue:0,earnedValue:0,actualCost:0,description:mt.description,priority:mt.priority,assignedTo:mt.assignedTo,createdDate:Cj(new Date),lastModified:Cj(new Date)};console.log("\ud83d\ude80 NUEVO SISTEMA - Tarea creada:",a),console.log("\ud83d\ude80 DEBUG - Dependencias en la tarea creada:",{predecessors:a.predecessors,successors:a.successors,predecessorsLength:a.predecessors.length,successorsLength:a.successors.length}),console.log("\ud83d\ude80 NUEVO SISTEMA - Dependencias seleccionadas:",{predecessors:mt.selectedPredecessors,successors:mt.selectedSuccessors}),l(e=>{var r,s;let n;if(mt.insertAfterTaskId){const t=e.findIndex(e=>e.id===mt.insertAfterTaskId);if(-1!==t){const r=e.slice();r.splice(t+1,0,a),n=r,console.log("\ud83d\ude80 NUEVA FUNCI\xd3N - Tarea insertada en posici\xf3n:",t+1)}else{const t=e.slice();t.push(a),n=t,console.log("\ud83d\ude80 NUEVA FUNCI\xd3N - Tarea agregada al final (posici\xf3n no encontrada)")}}else{const t=e.slice();t.push(a),n=t,console.log("\ud83d\ude80 NUEVO SISTEMA - Tarea agregada al final. Total tareas:",n.length)}const i=n.find(e=>e.id===t);return console.log("\ud83d\ude80 DEBUG - Tarea en el estado despu\xe9s de agregar:",{id:null===i||void 0===i?void 0:i.id,name:null===i||void 0===i?void 0:i.name,predecessors:null===i||void 0===i?void 0:i.predecessors,successors:null===i||void 0===i?void 0:i.successors,predecessorsLength:null===i||void 0===i||null===(r=i.predecessors)||void 0===r?void 0:r.length,successorsLength:null===i||void 0===i||null===(s=i.successors)||void 0===s?void 0:s.length}),mt.selectedPredecessors.length>0||mt.selectedSuccessors.length>0?(console.log("\ud83d\ude80 NUEVO SISTEMA - Sincronizando dependencias..."),n.map(e=>{if(e.id===t)return e;let r={id:e.id,wbsCode:e.wbsCode,name:e.name,duration:e.duration,startDate:e.startDate,endDate:e.endDate,progress:e.progress,predecessors:[...e.predecessors||[]],cost:e.cost,priority:e.priority,assignedTo:e.assignedTo,isMilestone:e.isMilestone,isCritical:e.isCritical,originalDuration:e.originalDuration,earlyStart:e.earlyStart,earlyFinish:e.earlyFinish,lateStart:e.lateStart,lateFinish:e.lateFinish,totalFloat:e.totalFloat,freeFloat:e.freeFloat,description:e.description,resources:[...e.resources||[]],workPackageId:e.workPackageId,status:e.status,successors:[...e.successors||[]]};return mt.selectedPredecessors.includes(e.id)&&(r.successors.includes(t)||(r.successors=r.successors.slice().concat([t]),console.log("\ud83d\ude80 NUEVO SISTEMA - Agregando ".concat(t," como sucesora de ").concat(e.id)))),mt.selectedSuccessors.includes(e.id)&&(r.predecessors.includes(t)||(r.predecessors=[...r.predecessors||[],t],console.log("\ud83d\ude80 NUEVO SISTEMA - Agregando ".concat(t," como predecesora de ").concat(e.id)))),r})):n}),ft(!1),pt({name:"",duration:5,startDate:Cj(new Date),endDate:Dj(Cj(new Date),5),description:"",priority:"medium",assignedTo:"",cost:0,selectedPredecessors:[],insertAfterTaskId:null}),console.log("\ud83d\ude80 NUEVO SISTEMA - Proceso completado exitosamente"),setTimeout(()=>{console.log("\ud83d\ude80 DEBUG - Estado final de todas las tareas:"),l(e=>(e.forEach(e=>{var t,r;console.log("\ud83d\ude80 DEBUG - Tarea ".concat(e.name," (").concat(e.id,"):"),{predecessors:e.predecessors,successors:e.successors,predecessorsLength:(null===(t=e.predecessors)||void 0===t?void 0:t.length)||0,successorsLength:(null===(r=e.successors)||void 0===r?void 0:r.length)||0})}),e))},100)}catch(e){console.error("\u274c NUEVO SISTEMA - Error al crear tarea:",e),alert("Error al crear la tarea. Por favor intenta de nuevo.")}},className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[(0,bt.jsx)("span",{children:"\u2705"}),(0,bt.jsx)("span",{children:"Crear Tarea"})]})]})]})})}),(0,bt.jsx)(lj,{isOpen:Y,onClose:()=>{J(!1)},hitos:o.filter(e=>e.isMilestone),onSave:async e=>{console.log("\ud83d\udcbe Guardando tareas de minuta:",e);try{if(m&&null!==d&&void 0!==d&&d.id){const t=await Nt.default.saveMinutas(d.id,e);if(!t.success)return console.error("\u274c Error guardando en Supabase:",t.error),void alert("\u274c Error guardando las minutas: ".concat(t.error.message||"Error desconocido"));Q(t=>[...t,...e]),e.forEach(e=>{oe(e,d)}),alert("\u2705 Se han guardado ".concat(e.length," tareas de la minuta en Supabase."))}else Q(t=>[...t,...e]),alert("\ud83d\udcdd Se han guardado ".concat(e.length," tareas de la minuta localmente."));if("undefined"!==typeof window){const t=new CustomEvent("dataChange",{detail:{type:"minutasUpdated",projectId:null===d||void 0===d?void 0:d.id,minutasCount:e.length}});window.dispatchEvent(t)}}catch(t){console.error("\u274c Error guardando minutas:",t),alert("\u274c Error guardando las minutas: ".concat(t.message))}}}),(0,bt.jsx)(cj,{isOpen:ae,onClose:()=>{re(null),se(!1)},minuta:te,hitos:o.filter(e=>e.isMilestone),onUpdate:async e=>{try{if(m){const t=await Nt.default.updateMinuta(e.id,{task_description:e.tarea,responsible_person:e.responsable,due_date:e.fecha,milestone_id:e.hitoId,status:e.estatus});if(t.success){Q(t=>t.map(t=>t.id===e.id?e:t));const t={task_description:e.tarea,responsible_person:e.responsable,due_date:e.fecha,milestone_id:e.hitoId,status:e.estatus};le(e,t,d),alert("\u2705 Minuta actualizada correctamente")}else console.error("\u274c Error actualizando minuta:",t.error),alert("\u274c Error actualizando minuta: ".concat(t.error.message||"Error desconocido"))}else Q(t=>t.map(t=>t.id===e.id?e:t)),alert("\u2705 Minuta actualizada localmente")}catch(t){console.error("\u274c Error actualizando minuta:",t),alert("\u274c Error actualizando minuta: ".concat(t.message))}}}),(0,bt.jsx)(jj,{isOpen:ne,onClose:()=>ie(!1),onComplete:async e=>{try{var t,r,a,s;console.log("\ud83e\udd16 Aplicando cronograma generado por IA:",e);const o=new Date,c=Cj(o),d=e.activities.map((e,t)=>{const r=Dj(c,t,h),a=Dj(r,(e.duration||1)-1,h);return{id:e.id,name:e.name,description:e.description||"",duration:e.duration||1,startDate:r,endDate:a,progress:0,status:"pending",priority:e.priority||"medium",assignedTo:e.assignedTo||"Pendiente",dependencies:e.dependencies||[],predecessors:e.dependencies||[],successors:[],isMilestone:!1,estimatedCost:e.estimatedCost||0,category:e.category||"execution",phase:e.phase||"General",generatedBy:"ai",confidence:e.confidence||.8,criteria:e.criteria||""}}),u=(e.milestones||[]).map((e,t)=>{const r=Dj(c,d.length+t,h);return{id:e.id,name:e.name,description:e.description||"",duration:0,startDate:r,endDate:r,progress:0,status:"pending",priority:e.priority||"high",assignedTo:e.assignedTo||"Pendiente",dependencies:e.dependencies||[],predecessors:e.dependencies||[],successors:[],isMilestone:!0,estimatedCost:e.estimatedCost||0,category:e.category||"milestone",phase:e.phase||"General",generatedBy:"ai",confidence:e.confidence||.9,criteria:e.criteria||""}}),f=[],m=new Set,p={};d.forEach(e=>{const t=e.phase||"General";p[t]||(p[t]=[]),p[t].push(e)}),Object.entries(p).forEach(e=>{let[t,r]=e;f.push(...r);const a=u.filter(e=>e.phase===t&&!m.has(e.id));f.push(...a),a.forEach(e=>m.add(e.id))});const g=u.filter(e=>!e.phase||"General"===e.phase);f.push(...g),console.log("\ud83d\udd04 Cronograma IA procesado:",{totalItems:f.length,activities:f.filter(e=>!e.isMilestone).length,milestones:f.filter(e=>e.isMilestone).length,phases:[...new Set(f.map(e=>e.phase))]}),console.log("\ud83d\udd0d DEBUG - Orden de tareas antes de CPM:",{activitiesByPhase:Object.keys(p),allAITasksOrder:f.map((e,t)=>({index:t,id:e.id,name:e.name,isMilestone:e.isMilestone,phase:e.phase}))});const x=f.filter(e=>!e.isMilestone).length,b=f.filter(e=>e.isMilestone).length,v="\ud83e\udd16 CRONOGRAMA GENERADO POR IA\n\n"+"Actividades: ".concat(x,"\n")+"Hitos: ".concat(b,"\n")+"Duraci\xf3n estimada: ".concat(Math.round((null===(t=e.metadata)||void 0===t?void 0:t.estimatedDuration)||0)," d\xedas\n\n")+"Esto REEMPLAZAR\xc1 COMPLETAMENTE el cronograma actual.\n\xbfContinuar con la aplicaci\xf3n del cronograma generado por IA?";if(!window.confirm(v))return void console.log("\ud83e\udd16 Aplicaci\xf3n de cronograma IA cancelada por el usuario");const y=Lj(f,h),w=y.tasks||y,j=[],N=new Map(w.map(e=>[e.id,e]));if(f.forEach(e=>{const t=N.get(e.id);t&&j.push(t)}),w.forEach(e=>{N.has(e.id)&&f.find(t=>t.id===e.id)||j.push(e)}),console.log("\ud83d\udd0d DEBUG - Resultado CPM:",{cpmResultType:typeof y,cpmResultKeys:Object.keys(y),tasksType:typeof w,tasksIsArray:Array.isArray(w),tasksLength:Array.isArray(w)?w.length:"N/A",orderedTasksLength:j.length,orderPreserved:f.length===j.length}),console.log("\ud83d\udd04 Orden preservado despu\xe9s de CPM:",{originalOrder:f.map(e=>({id:e.id,name:e.name,isMilestone:e.isMilestone})),finalOrder:j.map(e=>({id:e.id,name:e.name,isMilestone:e.isMilestone}))}),console.log("\ud83d\udd0d DEBUG - Verificaci\xf3n de intercalado:",{milestonesPositions:j.map((e,t)=>e.isMilestone?{index:t,name:e.name,phase:e.phase}:null).filter(Boolean),activitiesBeforeMilestones:j.map((e,t)=>{if(e.isMilestone){const r=j.slice(0,t).filter(e=>!e.isMilestone);return{milestone:e.name,activitiesBefore:r.length}}return null}).filter(Boolean),sampleTasksWithDates:j.slice(0,5).map(e=>({id:e.id,name:e.name,startDate:e.startDate,endDate:e.endDate,isMilestone:e.isMilestone}))}),l(j),ce({category:"ai-scheduler",action:"schedule-applied",description:"Cronograma generado por IA aplicado al proyecto",details:{activitiesCount:x,milestonesCount:b,templateUsed:null===(r=e.metadata)||void 0===r?void 0:r.templateUsed,estimatedDuration:null===(a=e.metadata)||void 0===a?void 0:a.estimatedDuration,complexity:null===(s=e.metadata)||void 0===s?void 0:s.complexity}}),e.recommendations&&e.recommendations.length>0){var n;const t=e.recommendations.map(e=>"\u2022 ".concat(e.title,": ").concat(e.description)).join("\n");alert("\u2705 CRONOGRAMA DE IA APLICADO EXITOSAMENTE!\n\n"+"\ud83d\udcca ".concat(f.length," elementos generados\n")+"\ud83c\udfaf ".concat(b," hitos creados\n")+"\u23f1\ufe0f Duraci\xf3n estimada: ".concat(Math.round((null===(n=e.metadata)||void 0===n?void 0:n.estimatedDuration)||0)," d\xedas\n\n")+"\ud83d\udca1 RECOMENDACIONES:\n".concat(t))}else{var i;alert("\u2705 CRONOGRAMA DE IA APLICADO EXITOSAMENTE!\n\n"+"\ud83d\udcca ".concat(f.length," elementos generados\n")+"\ud83c\udfaf ".concat(b," hitos creados\n")+"\u23f1\ufe0f Duraci\xf3n estimada: ".concat(Math.round((null===(i=e.metadata)||void 0===i?void 0:i.estimatedDuration)||0)," d\xedas"))}console.log("\u2705 Cronograma de IA aplicado exitosamente")}catch(o){console.error("\u274c Error aplicando cronograma de IA:",o),alert("\u274c Error aplicando cronograma de IA: ".concat(o.message))}},projectId:null===d||void 0===d?void 0:d.id,currentProject:d})]})},Vj=e=>{let{workPackages:t,setWorkPackages:s,currentProject:i,risks:o=[],scheduleData:l=null,includeWeekends:c=!1,purchaseOrders:d=[],setPurchaseOrders:u,advances:h=[],setAdvances:f,invoices:m=[],setInvoices:p,contracts:g=[],setContracts:x,useSupabase:b=!1}=e;const[v,y]=(0,a.useState)(!1),[w,j]=(0,a.useState)(!1),[N,k]=(0,a.useState)(!1),[S,E]=(0,a.useState)(null),[T,_]=(0,a.useState)(null),[C,A]=(0,a.useState)(null),[D,P]=(0,a.useState)(!1),[I,O]=(0,a.useState)(null),{logFinancialEvent:R}=Fw(null===i||void 0===i?void 0:i.id,b);a.useEffect(()=>{l&&(e=>{if(!e||!e.tasks)return;console.log("\ud83d\udd04 Sincronizando m\xe9tricas financieras con cronograma...");const r=t.map(t=>{const r=e.tasks.find(e=>e.workPackageId===t.id);return r?{id:t.id,name:t.name,description:t.description,startDate:t.startDate,endDate:t.endDate,budget:t.budget,actualCost:t.actualCost,status:t.status,priority:t.priority,percentComplete:r.progress||t.percentComplete,plannedValue:t.plannedValue,earnedValue:r.progress?t.plannedValue*r.progress/100:t.earnedValue,resources:t.resources,startDate:r.startDate||t.startDate,endDate:r.endDate||t.endDate,status:r.status||t.status}:t});s(r),console.log("\u2705 Work packages actualizados desde cronograma")})(l)},[l]);const M=()=>{if(!o||!Array.isArray(o))return.05*((null===i||void 0===i?void 0:i.budget)||0);const e=o.filter(e=>"active"===e.status);if(0===e.length)return.05*((null===i||void 0===i?void 0:i.budget)||0);return.05*((null===i||void 0===i?void 0:i.budget)||0)+e.reduce((e,t)=>e+(t.probability||0)*(t.costImpact||0)*("high"===t.priority?1.5:"medium"===t.priority?1.2:1),0)},F=()=>{if(!i)return 0;const e=i.budget||0;if(!o||!Array.isArray(o))return.1*e;const t=o.filter(e=>"active"===e.status);let r=.1*e;t.length>10?r*=1.2:t.length>5&&(r*=1.1);return t.filter(e=>"high"===e.priority).length>3&&(r*=1.15),r},L=(0,a.useMemo)(()=>{const e=Array.isArray(d)?d:[],t=Array.isArray(h)?h:[],r=Array.isArray(m)?m:[];console.log("\ud83d\udd0d FINANCIAL METRICS DEBUG:",{purchaseOrdersType:typeof d,purchaseOrdersIsArray:Array.isArray(d),purchaseOrdersLength:e.length,advancesType:typeof h,advancesIsArray:Array.isArray(h),advancesLength:t.length,invoicesType:typeof m,invoicesIsArray:Array.isArray(m),invoicesLength:r.length});const a=e.reduce((e,t)=>e+(t.totalAmount||0),0),s=t.reduce((e,t)=>e+(t.amount||0),0),n=r.reduce((e,t)=>e+(t.amount||0),0),o=r.filter(e=>"paid"===e.status).reduce((e,t)=>e+(t.amount||0),0),l=n-o,c=(null===i||void 0===i?void 0:i.budget)||0,u=n,f=o,p=a+s,x=g.reduce((e,t)=>e+(t.value||0),0),b=g.filter(e=>"active"===e.status).reduce((e,t)=>e+(t.value||0),0),v=c-f,y=u+v;return{totalPO:a,totalAdvances:s,totalInvoices:n,paidInvoices:o,pendingInvoices:l,totalContracts:x,activeContracts:b,committedBudget:a+s+b,availableBudget:c-(a+s+b),BAC:c,AC:u,EV:f,PV:p,CV:f-u,SV:f-p,CPI:u>0?f/u:1,SPI:p>0?f/p:1,ETC:v,EAC:y,VAC:c-y,TCPI:(c-f)/(c-u),percentComplete:c>0?f/c*100:0,percentSpent:c>0?u/c*100:0,contingencyReserve:M(),managementReserve:F(),totalReserves:M()+F(),totalProjectBudget:((null===i||void 0===i?void 0:i.budget)||0)+M()+F()}},[d,h,m,g,i,o]),z=e=>{switch(e){case"paid":return"bg-green-100 text-green-800";case"pending":return"bg-yellow-100 text-yellow-800";case"overdue":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return(0,bt.jsxs)("div",{className:"space-y-6",children:[(0,bt.jsxs)("div",{className:"bg-gradient-to-r from-green-50 to-emerald-100 rounded-2xl shadow-lg p-6 text-gray-800 relative overflow-hidden",children:[(0,bt.jsx)("div",{className:"absolute top-0 right-0 w-32 h-32 bg-green-100/30 rounded-full -translate-y-16 translate-x-16"}),(0,bt.jsx)("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-emerald-100/30 rounded-full translate-y-12 -translate-x-12"}),(0,bt.jsx)("div",{className:"relative z-10",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{className:"flex items-center",children:[(0,bt.jsx)("div",{className:"bg-white/60 backdrop-blur rounded-2xl p-3 mr-4 shadow-sm",children:(0,bt.jsx)("span",{className:"text-3xl",children:"\ud83d\udcb0"})}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h1",{className:"text-4xl font-bold mb-2 text-gray-800",children:"Gesti\xf3n Financiera"}),(0,bt.jsx)("p",{className:"text-gray-600 text-lg",children:"Control de costos, \xf3rdenes de compra, anticipos y facturas"})]})]}),(0,bt.jsx)("div",{className:"bg-white/60 backdrop-blur rounded-2xl px-4 py-2 shadow-sm",children:(0,bt.jsxs)("div",{className:"flex items-center space-x-2 text-sm",children:[(0,bt.jsx)("span",{className:"text-gray-600",children:"\ud83d\udcc5 D\xedas laborables:"}),(0,bt.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(c?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"),children:c?"Lunes a Domingo":"Lunes a Viernes"})]})})]})})]}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,bt.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-blue-500",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsxs)("div",{className:"text-xs text-gray-500 mb-1 flex items-center",children:["BAC (Presupuesto)",(0,bt.jsx)("span",{className:"ml-1 text-blue-500 cursor-help",title:"Budget at Completion: Presupuesto total aprobado para el proyecto",children:"\u2753"})]}),(0,bt.jsxs)("div",{className:"text-2xl font-bold text-blue-600",children:["$",(L.BAC/1e3).toFixed(0),"K"]})]}),(0,bt.jsx)("div",{className:"text-blue-500 text-2xl",children:"\ud83d\udcb0"})]})}),(0,bt.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-green-500",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsxs)("div",{className:"text-xs text-gray-500 mb-1 flex items-center",children:["EV (Valor Ganado)",(0,bt.jsx)("span",{className:"ml-1 text-green-500 cursor-help",title:"Earned Value: Valor del trabajo realmente completado",children:"\u2753"})]}),(0,bt.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:["$",(L.EV/1e3).toFixed(0),"K"]})]}),(0,bt.jsx)("div",{className:"text-green-500 text-2xl",children:"\ud83d\udcc8"})]})}),(0,bt.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-yellow-500",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsxs)("div",{className:"text-xs text-gray-500 mb-1 flex items-center",children:["AC (Costo Real)",(0,bt.jsx)("span",{className:"ml-1 text-yellow-500 cursor-help",title:"Actual Cost: Costo real incurrido hasta la fecha",children:"\u2753"})]}),(0,bt.jsxs)("div",{className:"text-2xl font-bold text-yellow-600",children:["$",(L.AC/1e3).toFixed(0),"K"]})]}),(0,bt.jsx)("div",{className:"text-yellow-500 text-2xl",children:"\ud83d\udcb8"})]})}),(0,bt.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-purple-500",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsxs)("div",{className:"text-xs text-gray-500 mb-1 flex items-center",children:["EAC (Estimaci\xf3n Final)",(0,bt.jsx)("span",{className:"ml-1 text-purple-500 cursor-help",title:"Estimate at Completion: Estimaci\xf3n del costo total al terminar",children:"\u2753"})]}),(0,bt.jsxs)("div",{className:"text-2xl font-bold text-purple-600",children:["$",(L.EAC/1e3).toFixed(0),"K"]})]}),(0,bt.jsx)("div",{className:"text-purple-500 text-2xl",children:"\ud83c\udfaf"})]})})]}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,bt.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-blue-500",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsxs)("div",{className:"text-xs text-gray-500 mb-1 flex items-center",children:["CPI",(0,bt.jsx)("span",{className:"ml-1 text-blue-500 cursor-help",title:"Cost Performance Index: EV/AC",children:"\u2753"})]}),(0,bt.jsx)("div",{className:"text-2xl font-bold ".concat(L.CPI>=1?"text-green-600":"text-red-600"),children:L.CPI.toFixed(2)}),(0,bt.jsx)("div",{className:"text-xs text-gray-600",children:"Cost Performance"})]}),(0,bt.jsx)("div",{className:"text-blue-500 text-2xl",children:"\ud83d\udcca"})]})}),(0,bt.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-orange-500",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsxs)("div",{className:"text-xs text-gray-500 mb-1 flex items-center",children:["SPI",(0,bt.jsx)("span",{className:"ml-1 text-orange-500 cursor-help",title:"Schedule Performance Index: EV/PV",children:"\u2753"})]}),(0,bt.jsx)("div",{className:"text-2xl font-bold ".concat(L.SPI>=1?"text-green-600":"text-red-600"),children:L.SPI.toFixed(2)}),(0,bt.jsx)("div",{className:"text-xs text-gray-600",children:"Schedule Performance"})]}),(0,bt.jsx)("div",{className:"text-orange-500 text-2xl",children:"\u23f1\ufe0f"})]})}),(0,bt.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-red-500",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsxs)("div",{className:"text-xs text-gray-500 mb-1 flex items-center",children:["VAC",(0,bt.jsx)("span",{className:"ml-1 text-red-500 cursor-help",title:"Variance at Completion: BAC-EAC",children:"\u2753"})]}),(0,bt.jsxs)("div",{className:"text-2xl font-bold ".concat(L.VAC>=0?"text-green-600":"text-red-600"),children:["$",(L.VAC/1e3).toFixed(0),"K"]}),(0,bt.jsx)("div",{className:"text-xs text-gray-600",children:"Variance at Completion"})]}),(0,bt.jsx)("div",{className:"text-red-500 text-2xl",children:"\ud83d\udcc9"})]})}),(0,bt.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-teal-500",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsxs)("div",{className:"text-xs text-gray-500 mb-1 flex items-center",children:["TCPI",(0,bt.jsx)("span",{className:"ml-1 text-teal-500 cursor-help",title:"To Complete Performance Index",children:"\u2753"})]}),(0,bt.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:L.TCPI.toFixed(2)}),(0,bt.jsx)("div",{className:"text-xs text-gray-600",children:"To Complete Performance"})]}),(0,bt.jsx)("div",{className:"text-teal-500 text-2xl",children:"\ud83c\udfaf"})]})})]}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,bt.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-purple-500",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsxs)("div",{className:"text-xs text-gray-500 mb-1 flex items-center",children:["Contratos Activos",(0,bt.jsx)("span",{className:"ml-1 text-purple-500 cursor-help",title:"Valor total de contratos activos",children:"\u2753"})]}),(0,bt.jsxs)("div",{className:"text-2xl font-bold text-gray-800",children:["$",(L.activeContracts/1e3).toFixed(0),"K"]}),(0,bt.jsx)("div",{className:"text-xs text-gray-600",children:"Valor total"})]}),(0,bt.jsx)("div",{className:"text-purple-500 text-2xl",children:"\ud83d\udccb"})]})}),(0,bt.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-green-500",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsxs)("div",{className:"text-xs text-gray-500 mb-1 flex items-center",children:["% Completado",(0,bt.jsx)("span",{className:"ml-1 text-green-500 cursor-help",title:"Porcentaje de trabajo completado",children:"\u2753"})]}),(0,bt.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:[L.percentComplete.toFixed(1),"%"]}),(0,bt.jsx)("div",{className:"text-xs text-gray-600",children:"Progreso del proyecto"})]}),(0,bt.jsx)("div",{className:"text-green-500 text-2xl",children:"\ud83d\udcc8"})]})}),(0,bt.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-orange-500",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsxs)("div",{className:"text-xs text-gray-500 mb-1 flex items-center",children:["% Gastado",(0,bt.jsx)("span",{className:"ml-1 text-orange-500 cursor-help",title:"Porcentaje del presupuesto utilizado",children:"\u2753"})]}),(0,bt.jsxs)("div",{className:"text-2xl font-bold text-gray-800",children:[L.percentSpent.toFixed(1),"%"]}),(0,bt.jsx)("div",{className:"text-xs text-gray-600",children:"Presupuesto utilizado"})]}),(0,bt.jsx)("div",{className:"text-orange-500 text-2xl",children:"\ud83d\udcb8"})]})})]}),(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"\ud83d\udee1\ufe0f Reservas y Contingencias"}),(0,bt.jsx)("span",{className:"text-sm text-gray-500",children:"Basado en an\xe1lisis de riesgos"})]}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,bt.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsxs)("div",{className:"text-xs text-gray-500 mb-1 flex items-center",children:["Presupuesto Base",(0,bt.jsx)("span",{className:"ml-1 text-gray-500 cursor-help",title:"Presupuesto inicial aprobado del proyecto",children:"\u2753"})]}),(0,bt.jsxs)("div",{className:"text-2xl font-bold text-gray-800",children:["$",(((null===i||void 0===i?void 0:i.budget)||0)/1e3).toFixed(0),"K"]})]}),(0,bt.jsx)("div",{className:"text-gray-500 text-2xl",children:"\ud83d\udcb0"})]})}),(0,bt.jsx)("div",{className:"bg-blue-50 rounded-lg p-4",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsxs)("div",{className:"text-xs text-gray-500 mb-1 flex items-center",children:["Reserva de Contingencia",(0,bt.jsx)("span",{className:"ml-1 text-blue-500 cursor-help",title:"Reserva para riesgos identificados. F\xf3rmula: 5% base + impacto esperado de riesgos activos",children:"\u2753"})]}),(0,bt.jsxs)("div",{className:"text-2xl font-bold text-blue-800",children:["$",(L.contingencyReserve/1e3).toFixed(0),"K"]})]}),(0,bt.jsx)("div",{className:"text-blue-500 text-2xl",children:"\ud83d\udee1\ufe0f"})]})}),(0,bt.jsx)("div",{className:"bg-green-50 rounded-lg p-4",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsxs)("div",{className:"text-xs text-gray-500 mb-1 flex items-center",children:["Reserva de Gesti\xf3n",(0,bt.jsx)("span",{className:"ml-1 text-green-500 cursor-help",title:"Reserva para riesgos no identificados. F\xf3rmula: 10% base + ajustes por complejidad",children:"\u2753"})]}),(0,bt.jsxs)("div",{className:"text-2xl font-bold text-green-800",children:["$",(L.managementReserve/1e3).toFixed(0),"K"]})]}),(0,bt.jsx)("div",{className:"text-green-500 text-2xl",children:"\ud83d\udcca"})]})}),(0,bt.jsx)("div",{className:"bg-purple-50 rounded-lg p-4",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsxs)("div",{className:"text-xs text-gray-500 mb-1 flex items-center",children:["Presupuesto Total",(0,bt.jsx)("span",{className:"ml-1 text-purple-500 cursor-help",title:"Presupuesto base + reservas de contingencia y gesti\xf3n",children:"\u2753"})]}),(0,bt.jsxs)("div",{className:"text-2xl font-bold text-purple-800",children:["$",(L.totalProjectBudget/1e3).toFixed(0),"K"]})]}),(0,bt.jsx)("div",{className:"text-purple-500 text-2xl",children:"\ud83c\udfaf"})]})})]}),(0,bt.jsxs)("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:[(0,bt.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"\ud83d\udccb Detalles del C\xe1lculo"}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-xs text-gray-600",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsxs)("p",{children:[(0,bt.jsx)("strong",{children:"Reserva de Contingencia:"})," 5% del presupuesto base + impacto esperado de riesgos activos"]}),(0,bt.jsxs)("p",{children:[(0,bt.jsx)("strong",{children:"Riesgos Activos:"})," ",(null===o||void 0===o?void 0:o.filter(e=>"active"===e.status).length)||0," identificados"]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsxs)("p",{children:[(0,bt.jsx)("strong",{children:"Reserva de Gesti\xf3n:"})," 10% del presupuesto base + ajustes por complejidad"]}),(0,bt.jsxs)("p",{children:[(0,bt.jsx)("strong",{children:"Riesgos de Alta Prioridad:"})," ",(null===o||void 0===o?void 0:o.filter(e=>"active"===e.status&&"high"===e.priority).length)||0," identificados"]})]})]})]})]}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 gap-6",children:[(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"\ud83d\udccb \xd3rdenes de Compra"}),(0,bt.jsx)("button",{onClick:()=>{E({id:"",number:"",supplier:"",description:"",totalAmount:0,currency:"USD",status:"pending",requestDate:(new Date).toISOString().split("T")[0],approvalDate:"",expectedDate:"",projectId:(null===i||void 0===i?void 0:i.id)||""}),y(!0)},className:"bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700",children:"+ Nueva"})]}),(0,bt.jsx)("div",{className:"space-y-3",children:Array.isArray(d)&&0!==d.length?d.map(e=>{var t;return(0,bt.jsx)("div",{className:"border rounded p-3",children:(0,bt.jsxs)("div",{className:"flex justify-between items-start",children:[(0,bt.jsxs)("div",{className:"flex-1",children:[(0,bt.jsx)("div",{className:"font-medium text-sm",children:e.number}),(0,bt.jsx)("div",{className:"text-xs text-gray-600",children:e.supplier}),(0,bt.jsxs)("div",{className:"text-xs text-gray-600",children:["$",null===(t=e.totalAmount)||void 0===t?void 0:t.toLocaleString()]}),(0,bt.jsxs)("div",{className:"flex items-center space-x-2 mt-1",children:[(0,bt.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("approved"===e.status?"bg-green-100 text-green-800":"pending"===e.status?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:"approved"===e.status?"Aprobada":"pending"===e.status?"Pendiente":"Rechazada"}),"approved"===e.status&&(0,bt.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(e.approvalDate&&""!==e.approvalDate.trim()?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"),children:e.approvalDate&&""!==e.approvalDate.trim()?"\u2705 ".concat(new Date(e.approvalDate+"T00:00:00").toLocaleDateString("es-ES")):"\u26a0\ufe0f Sin fecha de aprobaci\xf3n"})]})]}),(0,bt.jsxs)("div",{className:"flex space-x-1",children:[(0,bt.jsx)("button",{onClick:()=>{E(e),y(!0)},className:"text-blue-600 hover:text-blue-800 text-sm",children:"\u270f\ufe0f"}),(0,bt.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("\xbfEst\xe1s seguro de que quieres eliminar esta orden de compra?"))try{const{default:t}=await Promise.resolve().then(r.bind(r,874)),a=await t.deletePurchaseOrder(e);if(a.success){const t=(Array.isArray(d)?d:[]).filter(t=>t.id!==e);console.log("\ud83d\uddd1\ufe0f ELIMINANDO OC:",e,"\xd3rdenes restantes:",t.length),u(t),console.log("\u2705 Orden de compra eliminada localmente y de Supabase")}else console.error("\u274c Error eliminando orden de compra de Supabase:",a.error),alert("Error eliminando la orden de compra. Int\xe9ntalo de nuevo.")}catch(t){console.error("\u274c Error inesperado eliminando orden de compra:",t),alert("Error inesperado eliminando la orden de compra. Int\xe9ntalo de nuevo.")}})(e.id),className:"text-red-600 hover:text-red-800 text-sm",children:"\ud83d\uddd1\ufe0f"})]})]})},e.id)}):(0,bt.jsx)("p",{className:"text-gray-500 text-sm",children:"No hay \xf3rdenes de compra"})})]}),(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"\ud83d\udcb3 Anticipos"}),(0,bt.jsx)("button",{onClick:()=>{_({}),j(!0)},className:"bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700",children:"+ Nuevo"})]}),(0,bt.jsx)("div",{className:"space-y-3",children:0===h.length?(0,bt.jsx)("p",{className:"text-gray-500 text-sm",children:"No hay anticipos"}):h.map(e=>{var t;return(0,bt.jsx)("div",{className:"border rounded p-3",children:(0,bt.jsxs)("div",{className:"flex justify-between items-start",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("div",{className:"font-medium text-sm",children:e.number}),(0,bt.jsx)("div",{className:"text-xs text-gray-600",children:e.supplier}),(0,bt.jsxs)("div",{className:"text-xs text-gray-600",children:["$",null===(t=e.amount)||void 0===t?void 0:t.toLocaleString()]})]}),(0,bt.jsxs)("div",{className:"flex space-x-1",children:[(0,bt.jsx)("button",{onClick:()=>{_(e),j(!0)},className:"text-blue-600 hover:text-blue-800 text-sm",children:"\u270f\ufe0f"}),(0,bt.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("\xbfEst\xe1s seguro de que quieres eliminar este anticipo?"))try{const{default:t}=await Promise.resolve().then(r.bind(r,874)),a=await t.deleteAdvance(e);if(a.success){const t=(Array.isArray(h)?h:[]).filter(t=>t.id!==e);f(t),console.log("\u2705 Anticipo eliminado localmente y de Supabase")}else console.error("\u274c Error eliminando anticipo de Supabase:",a.error),alert("Error eliminando el anticipo. Int\xe9ntalo de nuevo.")}catch(t){console.error("\u274c Error inesperado eliminando anticipo:",t),alert("Error inesperado eliminando el anticipo. Int\xe9ntalo de nuevo.")}})(e.id),className:"text-red-600 hover:text-red-800 text-sm",children:"\ud83d\uddd1\ufe0f"})]})]})},e.id)})})]}),(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"\ud83d\udcc4 Facturas"}),(0,bt.jsx)("button",{onClick:()=>{A({}),k(!0)},className:"bg-purple-600 text-white px-3 py-1 rounded text-sm hover:bg-purple-700",children:"+ Nueva"})]}),(0,bt.jsx)("div",{className:"space-y-3",children:0===m.length?(0,bt.jsx)("p",{className:"text-gray-500 text-sm",children:"No hay facturas"}):m.map(e=>{var t;return(0,bt.jsx)("div",{className:"border rounded p-3",children:(0,bt.jsxs)("div",{className:"flex justify-between items-start",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("div",{className:"font-medium text-sm",children:e.number}),(0,bt.jsx)("div",{className:"text-xs text-gray-600",children:e.supplier}),(0,bt.jsxs)("div",{className:"text-xs text-gray-600",children:["$",null===(t=e.amount)||void 0===t?void 0:t.toLocaleString()]}),(0,bt.jsx)("span",{className:"inline-block px-2 py-1 rounded-full text-xs font-medium ".concat(z(e.status)),children:e.status})]}),(0,bt.jsxs)("div",{className:"flex space-x-1",children:[(0,bt.jsx)("button",{onClick:()=>{A(e),k(!0)},className:"text-blue-600 hover:text-blue-800 text-sm",children:"\u270f\ufe0f"}),(0,bt.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("\xbfEst\xe1s seguro de que quieres eliminar esta factura?"))try{const{default:t}=await Promise.resolve().then(r.bind(r,874)),a=await t.deleteInvoice(e);if(a.success){const t=(Array.isArray(m)?m:[]).filter(t=>t.id!==e);p(t),console.log("\u2705 Factura eliminada localmente y de Supabase")}else console.error("\u274c Error eliminando factura de Supabase:",a.error),alert("Error eliminando la factura. Int\xe9ntalo de nuevo.")}catch(t){console.error("\u274c Error inesperado eliminando factura:",t),alert("Error inesperado eliminando la factura. Int\xe9ntalo de nuevo.")}})(e.id),className:"text-red-600 hover:text-red-800 text-sm",children:"\ud83d\uddd1\ufe0f"})]})]})},e.id)})})]})]}),v&&(0,bt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:(0,bt.jsx)("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:(0,bt.jsxs)("div",{className:"p-6",children:[(0,bt.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,bt.jsx)("h2",{className:"text-xl font-bold",children:null!==S&&void 0!==S&&S.id?"Editar Orden de Compra":"Nueva Orden de Compra"}),(0,bt.jsx)("button",{onClick:()=>y(!1),className:"text-gray-500 hover:text-gray-700 text-xl",children:"\u2715"})]}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"N\xfamero de OC *"}),(0,bt.jsx)("input",{type:"text",className:"w-full border rounded px-3 py-2",value:(null===S||void 0===S?void 0:S.number)||"",onChange:e=>E((0,n.A)((0,n.A)({},S),{},{number:e.target.value})),placeholder:"PO-2025-XXX"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Proveedor *"}),(0,bt.jsx)("input",{type:"text",className:"w-full border rounded px-3 py-2",value:(null===S||void 0===S?void 0:S.supplier)||"",onChange:e=>E((0,n.A)((0,n.A)({},S),{},{supplier:e.target.value})),placeholder:"Nombre del proveedor"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monto Total *"}),(0,bt.jsx)("input",{type:"number",className:"w-full border rounded px-3 py-2",value:(null===S||void 0===S?void 0:S.totalAmount)||"",onChange:e=>E((0,n.A)((0,n.A)({},S),{},{totalAmount:Number(e.target.value)})),min:"0",step:"0.01"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estado"}),(0,bt.jsxs)("select",{className:"w-full border rounded px-3 py-2",value:(null===S||void 0===S?void 0:S.status)||"pending",onChange:e=>E((0,n.A)((0,n.A)({},S),{},{status:e.target.value})),children:[(0,bt.jsx)("option",{value:"pending",children:"Pendiente"}),(0,bt.jsx)("option",{value:"approved",children:"Aprobada"}),(0,bt.jsx)("option",{value:"rejected",children:"Rechazada"})]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Fecha de Aprobaci\xf3n *",(0,bt.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,bt.jsx)("input",{type:"date",className:"w-full border rounded px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:(null===S||void 0===S?void 0:S.approvalDate)||"",onChange:e=>E((0,n.A)((0,n.A)({},S),{},{approvalDate:e.target.value})),required:!0}),(0,bt.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Fecha cuando la orden fue aprobada (usada para flujo de caja)"})]}),(0,bt.jsxs)("div",{className:"md:col-span-2",children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripci\xf3n"}),(0,bt.jsx)("textarea",{className:"w-full border rounded px-3 py-2",rows:"3",value:(null===S||void 0===S?void 0:S.description)||"",onChange:e=>E((0,n.A)((0,n.A)({},S),{},{description:e.target.value})),placeholder:"Descripci\xf3n de los productos/servicios"})]})]}),(0,bt.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,bt.jsx)("button",{onClick:()=>y(!1),className:"px-4 py-2 border border-gray-300 rounded text-gray-700 hover:bg-gray-50",children:"Cancelar"}),(0,bt.jsx)("button",{onClick:()=>{if(console.log("\ud83d\udcbe GUARDANDO OC - editingPO:",S),"approved"===S.status&&(!S.approvalDate||""===S.approvalDate.trim()))return void alert("\u26a0\ufe0f Error: Las \xf3rdenes de compra aprobadas deben tener una fecha de aprobaci\xf3n para el c\xe1lculo del flujo de caja.");const e=Array.isArray(d)?d:[];if(S.id){const t=e.map(e=>e.id===S.id?S:e);console.log("\ud83d\udcdd EDITANDO OC EXISTENTE:",S.id,"Total \xf3rdenes:",t.length),u(t)}else{const t={id:Date.now().toString(),number:S.number,supplier:S.supplier,description:S.description,totalAmount:S.totalAmount,currency:S.currency||"USD",status:S.status,requestDate:S.requestDate,approvalDate:S.approvalDate,expectedDate:S.expectedDate,projectId:S.projectId},r=[...e,t];console.log("\u2795 CREANDO NUEVA OC:",t.id,"Total \xf3rdenes:",r.length),u(r),R&&i&&R("purchase-order",t,i)}y(!1),E(null)},className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Guardar"})]})]})})}),w&&(0,bt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:(0,bt.jsx)("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:(0,bt.jsxs)("div",{className:"p-6",children:[(0,bt.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,bt.jsx)("h2",{className:"text-xl font-bold",children:null!==T&&void 0!==T&&T.id?"Editar Anticipo":"Nuevo Anticipo"}),(0,bt.jsx)("button",{onClick:()=>j(!1),className:"text-gray-500 hover:text-gray-700 text-xl",children:"\u2715"})]}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"N\xfamero de Anticipo *"}),(0,bt.jsx)("input",{type:"text",className:"w-full border rounded px-3 py-2",value:(null===T||void 0===T?void 0:T.number)||"",onChange:e=>_({id:T.id,number:T.number,supplier:T.supplier,amount:T.amount,paymentDate:T.paymentDate,description:T.description,projectId:T.projectId,number:e.target.value}),placeholder:"ADV-2025-XXX"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Proveedor *"}),(0,bt.jsx)("input",{type:"text",className:"w-full border rounded px-3 py-2",value:(null===T||void 0===T?void 0:T.supplier)||"",onChange:e=>_({id:T.id,number:T.number,supplier:T.supplier,amount:T.amount,paymentDate:T.paymentDate,description:T.description,projectId:T.projectId,supplier:e.target.value}),placeholder:"Nombre del proveedor"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monto *"}),(0,bt.jsx)("input",{type:"number",className:"w-full border rounded px-3 py-2",value:(null===T||void 0===T?void 0:T.amount)||"",onChange:e=>_({id:T.id,number:T.number,supplier:T.supplier,amount:T.amount,paymentDate:T.paymentDate,description:T.description,projectId:T.projectId,amount:Number(e.target.value)}),min:"0",step:"0.01"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha de Pago"}),(0,bt.jsx)("input",{type:"date",className:"w-full border rounded px-3 py-2",value:(null===T||void 0===T?void 0:T.paymentDate)||"",onChange:e=>_({id:T.id,number:T.number,supplier:T.supplier,amount:T.amount,paymentDate:T.paymentDate,description:T.description,projectId:T.projectId,paymentDate:e.target.value})})]}),(0,bt.jsxs)("div",{className:"md:col-span-2",children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripci\xf3n"}),(0,bt.jsx)("textarea",{className:"w-full border rounded px-3 py-2",rows:"3",value:(null===T||void 0===T?void 0:T.description)||"",onChange:e=>_({id:T.id,number:T.number,supplier:T.supplier,amount:T.amount,paymentDate:T.paymentDate,description:T.description,projectId:T.projectId,description:e.target.value}),placeholder:"Descripci\xf3n del anticipo"})]})]}),(0,bt.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,bt.jsx)("button",{onClick:()=>j(!1),className:"px-4 py-2 border border-gray-300 rounded text-gray-700 hover:bg-gray-50",children:"Cancelar"}),(0,bt.jsx)("button",{onClick:()=>{const e=Array.isArray(h)?h:[];if(T.id){const t=e.map(e=>e.id===T.id?T:e);f(t)}else{const t={id:Date.now().toString(),number:T.number,supplier:T.supplier,amount:T.amount,paymentDate:T.paymentDate,description:T.description,projectId:T.projectId},r=[...e,t];f(r),R&&i&&R("advance",t,i)}j(!1),_(null)},className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:"Guardar"})]})]})})}),N&&(0,bt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:(0,bt.jsx)("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:(0,bt.jsxs)("div",{className:"p-6",children:[(0,bt.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,bt.jsx)("h2",{className:"text-xl font-bold",children:null!==C&&void 0!==C&&C.id?"Editar Factura":"Nueva Factura"}),(0,bt.jsx)("button",{onClick:()=>k(!1),className:"text-gray-500 hover:text-gray-700 text-xl",children:"\u2715"})]}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"N\xfamero de Factura *"}),(0,bt.jsx)("input",{type:"text",className:"w-full border rounded px-3 py-2",value:(null===C||void 0===C?void 0:C.number)||"",onChange:e=>A({id:C.id,number:C.number,supplier:C.supplier,amount:C.amount,status:C.status,receivedDate:C.receivedDate,dueDate:C.dueDate,description:C.description,projectId:C.projectId,number:e.target.value}),placeholder:"INV-2025-XXX"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Proveedor *"}),(0,bt.jsx)("input",{type:"text",className:"w-full border rounded px-3 py-2",value:(null===C||void 0===C?void 0:C.supplier)||"",onChange:e=>A({id:C.id,number:C.number,supplier:C.supplier,amount:C.amount,status:C.status,receivedDate:C.receivedDate,dueDate:C.dueDate,description:C.description,projectId:C.projectId,supplier:e.target.value}),placeholder:"Nombre del proveedor"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monto *"}),(0,bt.jsx)("input",{type:"number",className:"w-full border rounded px-3 py-2",value:(null===C||void 0===C?void 0:C.amount)||"",onChange:e=>A({id:C.id,number:C.number,supplier:C.supplier,amount:C.amount,status:C.status,receivedDate:C.receivedDate,dueDate:C.dueDate,description:C.description,projectId:C.projectId,amount:Number(e.target.value)}),min:"0",step:"0.01"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estado"}),(0,bt.jsxs)("select",{className:"w-full border rounded px-3 py-2",value:(null===C||void 0===C?void 0:C.status)||"pending",onChange:e=>A({id:C.id,number:C.number,supplier:C.supplier,amount:C.amount,status:C.status,receivedDate:C.receivedDate,dueDate:C.dueDate,description:C.description,projectId:C.projectId,status:e.target.value}),children:[(0,bt.jsx)("option",{value:"pending",children:"Pendiente"}),(0,bt.jsx)("option",{value:"paid",children:"Pagada"}),(0,bt.jsx)("option",{value:"overdue",children:"Vencida"})]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha de Recepci\xf3n"}),(0,bt.jsx)("input",{type:"date",className:"w-full border rounded px-3 py-2",value:(null===C||void 0===C?void 0:C.receivedDate)||"",onChange:e=>A({id:C.id,number:C.number,supplier:C.supplier,amount:C.amount,status:C.status,receivedDate:C.receivedDate,dueDate:C.dueDate,description:C.description,projectId:C.projectId,receivedDate:e.target.value})})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha de Vencimiento"}),(0,bt.jsx)("input",{type:"date",className:"w-full border rounded px-3 py-2",value:(null===C||void 0===C?void 0:C.dueDate)||"",onChange:e=>A({id:C.id,number:C.number,supplier:C.supplier,amount:C.amount,status:C.status,receivedDate:C.receivedDate,dueDate:C.dueDate,description:C.description,projectId:C.projectId,dueDate:e.target.value})})]}),(0,bt.jsxs)("div",{className:"md:col-span-2",children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripci\xf3n"}),(0,bt.jsx)("textarea",{className:"w-full border rounded px-3 py-2",rows:"3",value:(null===C||void 0===C?void 0:C.description)||"",onChange:e=>A({id:C.id,number:C.number,supplier:C.supplier,amount:C.amount,status:C.status,receivedDate:C.receivedDate,dueDate:C.dueDate,description:C.description,projectId:C.projectId,description:e.target.value}),placeholder:"Descripci\xf3n de la factura"})]})]}),(0,bt.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,bt.jsx)("button",{onClick:()=>k(!1),className:"px-4 py-2 border border-gray-300 rounded text-gray-700 hover:bg-gray-50",children:"Cancelar"}),(0,bt.jsx)("button",{onClick:()=>{const e=Array.isArray(m)?m:[];if(C.id){const t=e.map(e=>e.id===C.id?C:e);p(t)}else{const t={id:Date.now().toString(),number:C.number,supplier:C.supplier,amount:C.amount,dueDate:C.dueDate,description:C.description,projectId:C.projectId},r=[...e,t];p(r),R&&i&&R("invoice",t,i)}k(!1),A(null)},className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700",children:"Guardar"})]})]})})})]})},Gj=e=>{let{projects:t,workPackages:r,currentProject:s,globalResources:n,setGlobalResources:i,includeWeekends:o=!1,getCurrentProjectResourceAssignments:l,updateCurrentProjectResourceAssignments:c,getCurrentProjectResources:d,getAvailableResources:u,calculateResourceWorkload:h}=e;const f=n||[],[m,p]=(0,a.useState)(!1),[g,x]=(0,a.useState)(!1),[b,v]=(0,a.useState)(!1),[y,w]=(0,a.useState)(!1),[j,N]=(0,a.useState)(null),[k,S]=(0,a.useState)(null),[E,T]=(0,a.useState)(""),[_,C]=(0,a.useState)("all"),[A,D]=(0,a.useState)({name:"",role:"",skills:"",availability:100,hourlyRate:0,status:"active"}),[P,I]=(0,a.useState)({resourceId:"",projectId:"",workPackageId:"",allocation:0,startDate:"",endDate:""}),O=(0,a.useMemo)(()=>f.filter(e=>{const t=!E||e.name.toLowerCase().includes(E.toLowerCase())||e.role.toLowerCase().includes(E.toLowerCase()),r="all"===_||e.role===_;return t&&r}),[f,E,_]),R=(0,a.useMemo)(()=>{const e=f.map(e=>e.role);return Array.from(new Set(e))},[f]),M=(0,a.useMemo)(()=>({totalResources:f.length,activeResources:f.filter(e=>"active"===e.status).length,overworkedResources:f.filter(e=>h(e.id)>90).length,availableResources:f.filter(e=>h(e.id)<50).length,totalCost:f.reduce((e,t)=>e+160*t.availability*t.hourlyRate,0),averageWorkload:f.length>0?f.reduce((e,t)=>e+h(t.id),0)/f.length:0}),[f,h]),F=e=>{N({id:e.id,name:e.name,role:e.role,availability:e.availability,hourlyRate:e.hourlyRate,skills:Array.isArray(e.skills)?e.skills.join(", "):e.skills,email:e.email,phone:e.phone,department:e.department,experience:e.experience,certifications:Array.isArray(e.certifications)?e.certifications.join(", "):e.certifications,notes:e.notes,status:e.status}),v(!0)};return(0,bt.jsxs)("div",{className:"space-y-6",children:[(0,bt.jsxs)("div",{className:"bg-gradient-to-r from-green-50 to-teal-100 rounded-2xl shadow-lg p-6 text-gray-800 relative overflow-hidden",children:[(0,bt.jsx)("div",{className:"absolute top-0 right-0 w-32 h-32 bg-green-100/30 rounded-full -translate-y-16 translate-x-16"}),(0,bt.jsx)("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-teal-100/30 rounded-full translate-y-12 -translate-x-12"}),(0,bt.jsx)("div",{className:"relative z-10",children:(0,bt.jsx)("div",{className:"flex items-center justify-between",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{className:"flex items-center",children:[(0,bt.jsx)("div",{className:"bg-white/60 backdrop-blur rounded-2xl p-3 mr-4 shadow-sm",children:(0,bt.jsx)("span",{className:"text-3xl",children:"\ud83d\udc65"})}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h1",{className:"text-4xl font-bold mb-2 text-gray-800",children:"Gesti\xf3n de Recursos"}),(0,bt.jsx)("p",{className:"text-gray-600 text-lg",children:"Administraci\xf3n de recursos humanos y asignaci\xf3n de proyectos"})]})]}),(0,bt.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,bt.jsx)("div",{className:"bg-white/60 backdrop-blur rounded-2xl px-4 py-2 shadow-sm",children:(0,bt.jsxs)("div",{className:"flex items-center space-x-2 text-sm",children:[(0,bt.jsx)("span",{className:"text-gray-600",children:"\ud83d\udcc5 D\xedas laborables:"}),(0,bt.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(o?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"),children:o?"Lunes a Domingo":"Lunes a Viernes"})]})}),(0,bt.jsxs)("div",{className:"text-right",children:[(0,bt.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:M.totalResources}),(0,bt.jsx)("div",{className:"text-gray-600",children:"Recursos Totales"})]})]})]})})})]}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,bt.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-green-500",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:"Recursos Activos"}),(0,bt.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:M.activeResources})]}),(0,bt.jsx)("div",{className:"text-green-500 text-2xl",children:"\ud83d\udc65"})]})}),(0,bt.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-red-500",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:"Sobrecargados"}),(0,bt.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:M.overworkedResources})]}),(0,bt.jsx)("div",{className:"text-red-500 text-2xl",children:"\u26a0\ufe0f"})]})}),(0,bt.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-blue-500",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:"Disponibles"}),(0,bt.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:M.availableResources})]}),(0,bt.jsx)("div",{className:"text-blue-500 text-2xl",children:"\u2705"})]})}),(0,bt.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-purple-500",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:"Costo Mensual"}),(0,bt.jsxs)("div",{className:"text-2xl font-bold text-gray-800",children:["$",(M.totalCost/1e3).toFixed(0),"K"]})]}),(0,bt.jsx)("div",{className:"text-purple-500 text-2xl",children:"\ud83d\udcb0"})]})})]}),(0,bt.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4",children:(0,bt.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0",children:[(0,bt.jsxs)("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-4",children:[(0,bt.jsx)("input",{type:"text",placeholder:"Buscar recursos...",value:E,onChange:e=>T(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md text-sm"}),(0,bt.jsxs)("select",{value:_,onChange:e=>C(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md text-sm",children:[(0,bt.jsx)("option",{value:"all",children:"Todos los roles"}),R.map(e=>(0,bt.jsx)("option",{value:e,children:e},e))]})]}),(0,bt.jsxs)("div",{className:"flex space-x-2",children:[(0,bt.jsx)("button",{onClick:()=>x(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"\ud83d\udccb Asignar Recurso"}),(0,bt.jsx)("button",{onClick:()=>p(!0),className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:"\u2795 Agregar Recurso"})]})]})}),(0,bt.jsx)("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:(0,bt.jsx)("div",{className:"overflow-x-auto",children:(0,bt.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,bt.jsx)("thead",{className:"bg-gray-50",children:(0,bt.jsxs)("tr",{children:[(0,bt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Recurso"}),(0,bt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rol"}),(0,bt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Carga de Trabajo"}),(0,bt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Proyectos"}),(0,bt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Costo/Hora"}),(0,bt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estado"}),(0,bt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),(0,bt.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:O.map(e=>{return(0,bt.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,bt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,bt.jsxs)("div",{className:"flex items-center",children:[(0,bt.jsx)("div",{className:"flex-shrink-0 h-10 w-10",children:(0,bt.jsx)("div",{className:"h-10 w-10 rounded-full bg-gray-300 flex items-center justify-center",children:(0,bt.jsx)("span",{className:"text-sm font-medium text-gray-700",children:e.name.split(" ").map(e=>e[0]).join("")})})}),(0,bt.jsxs)("div",{className:"ml-4",children:[(0,bt.jsx)("div",{className:"text-sm font-medium text-gray-900 cursor-pointer hover:text-blue-600",onClick:()=>{S(e),w(!0)},children:e.name}),(0,bt.jsx)("div",{className:"text-sm text-gray-500",children:Array.isArray(e.skills)?e.skills.slice(0,2).join(", "):e.skills})]})]})}),(0,bt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,bt.jsx)("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:e.role})}),(0,bt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,bt.jsxs)("div",{className:"flex items-center",children:[(0,bt.jsx)("span",{className:"mr-2",children:(t=h(e.id),t>90?"\ud83d\udd34":t>75?"\ud83d\udfe1":t>50?"\ud83d\udd35":"\ud83d\udfe2")}),(0,bt.jsxs)("div",{className:"flex-1",children:[(0,bt.jsx)("div",{className:"flex justify-between text-sm",children:(0,bt.jsxs)("span",{children:[h(e.id),"%"]})}),(0,bt.jsx)("div",{className:"w-20 bg-gray-200 rounded-full h-2",children:(0,bt.jsx)("div",{className:"h-2 rounded-full ".concat(h(e.id)>90?"bg-red-500":h(e.id)>75?"bg-yellow-500":h(e.id)>50?"bg-blue-500":"bg-green-500"),style:{width:"".concat(h(e.id),"%")}})})]})]})}),(0,bt.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[l().filter(t=>t.resourceId===e.id).length," asignaciones"]}),(0,bt.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["$",e.hourlyRate,"/h"]}),(0,bt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,bt.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat("active"===e.status?"bg-green-100 text-green-800":"inactive"===e.status?"bg-gray-100 text-gray-800":"on-leave"===e.status?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:"active"===e.status?"Activo":"inactive"===e.status?"Inactivo":"on-leave"===e.status?"Licencia":"Terminado"})}),(0,bt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,bt.jsxs)("div",{className:"flex space-x-2",children:[(0,bt.jsx)("button",{onClick:()=>F(e),className:"text-green-600 hover:text-green-900",title:"Editar recurso",children:"\u270f\ufe0f"}),(0,bt.jsx)("button",{onClick:()=>{S(e),x(!0)},className:"text-blue-600 hover:text-blue-900",title:"Asignar a proyecto",children:"\ud83d\udccb"}),(0,bt.jsx)("button",{onClick:()=>{return t=e.id,void(window.confirm("\xbfEst\xe1s seguro de que quieres eliminar este recurso?")&&i(e=>e.filter(e=>e.id!==t)));var t},className:"text-red-600 hover:text-red-900",title:"Eliminar recurso",children:"\ud83d\uddd1\ufe0f"})]})})]},e.id);var t})})]})})}),m&&(0,bt.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,bt.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:(0,bt.jsxs)("div",{className:"mt-3",children:[(0,bt.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Agregar Nuevo Recurso"}),(0,bt.jsxs)("div",{className:"space-y-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Nombre"}),(0,bt.jsx)("input",{type:"text",value:A.name,onChange:e=>D({name:e.target.value,role:A.role,skills:A.skills,availability:A.availability,hourlyRate:A.hourlyRate,email:A.email,phone:A.phone,department:A.department,experience:A.experience,certifications:A.certifications,notes:A.notes}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Rol"}),(0,bt.jsx)("input",{type:"text",value:A.role,onChange:e=>D({name:A.name,role:e.target.value,skills:A.skills,availability:A.availability,hourlyRate:A.hourlyRate,email:A.email,phone:A.phone,department:A.department,experience:A.experience,certifications:A.certifications,notes:A.notes}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Habilidades (separadas por comas)"}),(0,bt.jsx)("input",{type:"text",value:A.skills,onChange:e=>D({name:A.name,role:A.role,skills:A.skills,availability:A.availability,hourlyRate:A.hourlyRate,email:A.email,phone:A.phone,department:A.department,experience:A.experience,certifications:A.certifications,notes:A.notes,skills:e.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Disponibilidad (%)"}),(0,bt.jsx)("input",{type:"number",value:A.availability,onChange:e=>D({name:A.name,role:A.role,skills:A.skills,availability:A.availability,hourlyRate:A.hourlyRate,email:A.email,phone:A.phone,department:A.department,experience:A.experience,certifications:A.certifications,notes:A.notes,availability:Number(e.target.value)}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Costo por Hora ($)"}),(0,bt.jsx)("input",{type:"number",value:A.hourlyRate,onChange:e=>D({name:A.name,role:A.role,skills:A.skills,availability:A.availability,hourlyRate:A.hourlyRate,email:A.email,phone:A.phone,department:A.department,experience:A.experience,certifications:A.certifications,notes:A.notes,hourlyRate:Number(e.target.value)}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2"})]})]}),(0,bt.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,bt.jsx)("button",{onClick:()=>p(!1),className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400",children:"Cancelar"}),(0,bt.jsx)("button",{onClick:()=>{if(!A.name||!A.role)return;const e={id:"res-"+String(Date.now()).slice(-6),name:A.name,role:A.role,availability:A.availability,hourlyRate:A.hourlyRate,skills:A.skills.split(",").map(e=>e.trim()),email:A.email||"",phone:A.phone||"",department:A.department||"",experience:A.experience||"",certifications:A.certifications?A.certifications.split(",").map(e=>e.trim()):[],notes:A.notes||""};i(t=>{const r=t.slice();return r.push(e),r}),p(!1),D({name:"",role:"",skills:"",availability:100,hourlyRate:0,status:"active",email:"",phone:"",department:"",experience:"",certifications:"",notes:""})},className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:"Agregar"})]})]})})}),g&&(0,bt.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,bt.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:(0,bt.jsxs)("div",{className:"mt-3",children:[(0,bt.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Asignar Recurso a Proyecto"}),(0,bt.jsxs)("div",{className:"space-y-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Recurso"}),(0,bt.jsxs)("select",{value:P.resourceId,onChange:e=>I({resourceId:e.target.value,projectId:P.projectId,taskId:P.taskId,allocation:P.allocation,hourlyRate:P.hourlyRate,startDate:P.startDate,endDate:P.endDate,notes:P.notes}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2",children:[(0,bt.jsx)("option",{value:"",children:"Seleccionar recurso"}),f.map(e=>(0,bt.jsxs)("option",{value:e.id,children:[e.name," (",e.role,")"]},e.id))]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Proyecto"}),(0,bt.jsxs)("select",{value:P.projectId,onChange:e=>I({resourceId:P.resourceId,projectId:P.projectId,taskId:P.taskId,allocation:P.allocation,hourlyRate:P.hourlyRate,startDate:P.startDate,endDate:P.endDate,notes:P.notes,projectId:e.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2",children:[(0,bt.jsx)("option",{value:"",children:"Seleccionar proyecto"}),t.map(e=>(0,bt.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Asignaci\xf3n (%)"}),(0,bt.jsx)("input",{type:"number",value:P.allocation,onChange:e=>I({resourceId:P.resourceId,projectId:P.projectId,taskId:P.taskId,allocation:P.allocation,hourlyRate:P.hourlyRate,startDate:P.startDate,endDate:P.endDate,notes:P.notes,allocation:Number(e.target.value)}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Fecha de Inicio"}),(0,bt.jsx)("input",{type:"date",value:P.startDate,onChange:e=>I({resourceId:P.resourceId,projectId:P.projectId,taskId:P.taskId,allocation:P.allocation,hourlyRate:P.hourlyRate,startDate:P.startDate,endDate:P.endDate,notes:P.notes,startDate:e.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Fecha de Fin"}),(0,bt.jsx)("input",{type:"date",value:P.endDate,onChange:e=>I({resourceId:P.resourceId,projectId:P.projectId,taskId:P.taskId,allocation:P.allocation,hourlyRate:P.hourlyRate,startDate:P.startDate,endDate:P.endDate,notes:P.notes,endDate:e.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2"})]})]}),(0,bt.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,bt.jsx)("button",{onClick:()=>x(!1),className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400",children:"Cancelar"}),(0,bt.jsx)("button",{onClick:()=>{if(!P.resourceId||!P.projectId)return;const e=l(),t={id:"assign-"+String(Date.now()).slice(-6),projectId:(null===s||void 0===s?void 0:s.id)||"",resourceId:P.resourceId,workPackageId:P.workPackageId,role:P.role,allocation:P.allocation,startDate:P.startDate,endDate:P.endDate,hourlyRate:P.hourlyRate,status:"active",notes:P.notes||""};c(()=>{const r=e.slice();return r.push(t),r}),x(!1),I({resourceId:"",projectId:"",workPackageId:"",allocation:0,startDate:"",endDate:"",role:"",hourlyRate:0,notes:""})},className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Asignar"})]})]})})}),b&&j&&(0,bt.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,bt.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:(0,bt.jsxs)("div",{className:"mt-3",children:[(0,bt.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Editar Recurso"}),(0,bt.jsxs)("div",{className:"space-y-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Nombre"}),(0,bt.jsx)("input",{type:"text",value:j.name,onChange:e=>N({id:j.id,name:j.name,role:j.role,availability:j.availability,hourlyRate:j.hourlyRate,skills:j.skills,email:j.email,phone:j.phone,department:j.department,experience:j.experience,certifications:j.certifications,notes:j.notes,status:j.status,name:e.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Rol"}),(0,bt.jsx)("input",{type:"text",value:j.role,onChange:e=>N({id:j.id,name:j.name,role:j.role,availability:j.availability,hourlyRate:j.hourlyRate,skills:j.skills,email:j.email,phone:j.phone,department:j.department,experience:j.experience,certifications:j.certifications,notes:j.notes,status:j.status,role:e.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Habilidades (separadas por comas)"}),(0,bt.jsx)("input",{type:"text",value:j.skills,onChange:e=>N({id:j.id,name:j.name,role:j.role,availability:j.availability,hourlyRate:j.hourlyRate,skills:j.skills,email:j.email,phone:j.phone,department:j.department,experience:j.experience,certifications:j.certifications,notes:j.notes,status:j.status,skills:e.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Disponibilidad (%)"}),(0,bt.jsx)("input",{type:"number",value:j.availability,onChange:e=>N({id:j.id,name:j.name,role:j.role,availability:j.availability,hourlyRate:j.hourlyRate,skills:j.skills,email:j.email,phone:j.phone,department:j.department,experience:j.experience,certifications:j.certifications,notes:j.notes,status:j.status,availability:Number(e.target.value)}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Costo por Hora ($)"}),(0,bt.jsx)("input",{type:"number",value:j.hourlyRate,onChange:e=>N({id:j.id,name:j.name,role:j.role,availability:j.availability,hourlyRate:j.hourlyRate,skills:j.skills,email:j.email,phone:j.phone,department:j.department,experience:j.experience,certifications:j.certifications,notes:j.notes,status:j.status,hourlyRate:Number(e.target.value)}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Estado"}),(0,bt.jsxs)("select",{value:j.status,onChange:e=>N({id:j.id,name:j.name,role:j.role,availability:j.availability,hourlyRate:j.hourlyRate,skills:j.skills,email:j.email,phone:j.phone,department:j.department,experience:j.experience,certifications:j.certifications,notes:j.notes,status:j.status,status:e.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2",children:[(0,bt.jsx)("option",{value:"active",children:"Activo"}),(0,bt.jsx)("option",{value:"inactive",children:"Inactivo"}),(0,bt.jsx)("option",{value:"on-leave",children:"En licencia"}),(0,bt.jsx)("option",{value:"terminated",children:"Terminado"})]})]})]}),(0,bt.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,bt.jsx)("button",{onClick:()=>{v(!1),N(null)},className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400",children:"Cancelar"}),(0,bt.jsx)("button",{onClick:()=>{j&&(i(e=>e.map(e=>e.id===j.id?{id:e.id,name:j.name,role:j.role,availability:j.availability,hourlyRate:j.hourlyRate,skills:j.skills.split(",").map(e=>e.trim()),email:j.email||e.email,phone:j.phone||e.phone,department:j.department||e.department,experience:j.experience||e.experience,certifications:j.certifications?j.certifications.split(",").map(e=>e.trim()):e.certifications,notes:j.notes||e.notes,status:j.status}:e)),v(!1),N(null))},className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:"Guardar Cambios"})]})]})})}),y&&k&&(0,bt.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,bt.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:(0,bt.jsxs)("div",{className:"mt-3",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,bt.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Detalles del Recurso"}),(0,bt.jsx)("button",{onClick:()=>w(!1),className:"text-gray-400 hover:text-gray-600",children:"\u2715"})]}),(0,bt.jsxs)("div",{className:"space-y-4",children:[(0,bt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,bt.jsx)("div",{className:"h-12 w-12 rounded-full bg-gray-300 flex items-center justify-center",children:(0,bt.jsx)("span",{className:"text-lg font-medium text-gray-700",children:k.name.split(" ").map(e=>e[0]).join("")})}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h4",{className:"text-lg font-semibold text-gray-900",children:k.name}),(0,bt.jsx)("p",{className:"text-sm text-gray-600",children:k.role})]})]}),(0,bt.jsxs)("div",{className:"border-t pt-4",children:[(0,bt.jsx)("h5",{className:"font-medium text-gray-700 mb-2",children:"Informaci\xf3n General"}),(0,bt.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,bt.jsxs)("div",{className:"flex justify-between",children:[(0,bt.jsx)("span",{className:"text-gray-600",children:"Estado:"}),(0,bt.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat("active"===k.status?"bg-green-100 text-green-800":"inactive"===k.status?"bg-gray-100 text-gray-800":"on-leave"===k.status?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:"active"===k.status?"Activo":"inactive"===k.status?"Inactivo":"on-leave"===k.status?"Licencia":"Terminado"})]}),(0,bt.jsxs)("div",{className:"flex justify-between",children:[(0,bt.jsx)("span",{className:"text-gray-600",children:"Disponibilidad:"}),(0,bt.jsxs)("span",{className:"font-medium",children:[k.availability,"%"]})]}),(0,bt.jsxs)("div",{className:"flex justify-between",children:[(0,bt.jsx)("span",{className:"text-gray-600",children:"Costo por hora:"}),(0,bt.jsxs)("span",{className:"font-medium",children:["$",k.hourlyRate]})]}),(0,bt.jsxs)("div",{className:"flex justify-between",children:[(0,bt.jsx)("span",{className:"text-gray-600",children:"Carga actual:"}),(0,bt.jsxs)("span",{className:"font-medium ".concat(h(k.id)>90?"text-red-600":h(k.id)>75?"text-yellow-600":h(k.id)>50?"text-blue-600":"text-green-600"),children:[h(k.id),"%"]})]})]})]}),(0,bt.jsxs)("div",{className:"border-t pt-4",children:[(0,bt.jsx)("h5",{className:"font-medium text-gray-700 mb-2",children:"Habilidades"}),(0,bt.jsx)("div",{className:"flex flex-wrap gap-2",children:Array.isArray(k.skills)?k.skills.map((e,t)=>(0,bt.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:e},t)):(0,bt.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:k.skills})})]}),(0,bt.jsxs)("div",{className:"border-t pt-4",children:[(0,bt.jsx)("h5",{className:"font-medium text-gray-700 mb-2",children:"Proyectos Asignados"}),(0,bt.jsx)("div",{className:"space-y-1",children:l().filter(e=>e.resourceId===k.id).length>0?l().filter(e=>e.resourceId===k.id).map((e,r)=>{const a=t.find(t=>t.id===e.projectId);return a?(0,bt.jsxs)("div",{className:"text-sm text-gray-600",children:["\u2022 ",a.name]},r):null}):(0,bt.jsx)("div",{className:"text-sm text-gray-500 italic",children:"No hay proyectos asignados"})})]})]}),(0,bt.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,bt.jsx)("button",{onClick:()=>F(k),className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:"\u270f\ufe0f Editar"}),(0,bt.jsx)("button",{onClick:()=>w(!1),className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400",children:"Cerrar"})]})]})})})]})},qj=e=>{let{projects:t,currentProjectId:r,workPackages:s,risks:n,tasks:i,purchaseOrders:o,advances:l,invoices:c,contracts:d,resourceAssignments:u,useSupabase:h=!0}=e;const[f,m]=(0,a.useState)("overview"),[p,g]=(0,a.useState)("all"),[x,b]=(0,a.useState)("all"),[v,y]=(0,a.useState)(""),w=t.find(e=>e.id===r),{auditLog:j,exportAuditLog:N,clearAuditLog:k}=Fw(r,h),S=(0,a.useMemo)(()=>{if(!w)return[];const e=[],t=new Date(w.updatedAt||w.createdAt);return e.push(...j),"active"!==w.status||j.find(e=>"project-activated"===e.action)||e.push({id:"event-".concat(Date.now(),"-1"),timestamp:t,category:"project-status",action:"project-activated",description:'Proyecto "'.concat(w.name,'" activado'),details:{previousStatus:"inactive",newStatus:"active",manager:w.manager,budget:w.budget,startDate:w.startDate,endDate:w.endDate},severity:"high",user:w.manager}),s.forEach((r,a)=>{"active"!==r.status&&"in-progress"!==r.status&&"completed"!==r.status||e.push({id:"event-".concat(Date.now(),"-wp-").concat(a),timestamp:new Date(r.updatedAt||r.createdAt||t),category:"work-package",action:"work-package-created",description:'Work Package "'.concat(r.name,'" creado'),details:{workPackageId:r.id,name:r.name,budget:r.budget,status:r.status,progress:r.progress||0},severity:"medium",user:w.manager})}),n.forEach((r,a)=>{"active"!==r.status&&"mitigated"!==r.status||e.push({id:"event-".concat(Date.now(),"-risk-").concat(a),timestamp:new Date(r.updatedAt||r.createdAt||t),category:"risk",action:"risk-identified",description:'Riesgo "'.concat(r.name,'" identificado'),details:{riskId:r.id,name:r.name,probability:r.probability,impact:r.impact,priority:r.priority,status:r.status},severity:"high"===r.priority?"high":"medium",user:w.manager})}),i.forEach((r,a)=>{"active"!==r.status&&"in-progress"!==r.status&&"completed"!==r.status||e.push({id:"event-".concat(Date.now(),"-task-").concat(a),timestamp:new Date(r.updatedAt||r.createdAt||t),category:"schedule",action:"task-created",description:'Tarea "'.concat(r.name,'" creada'),details:{taskId:r.id,name:r.name,duration:r.duration,status:r.status,startDate:r.startDate,endDate:r.endDate},severity:"medium",user:w.manager})}),o.forEach((r,a)=>{e.push({id:"event-".concat(Date.now(),"-po-").concat(a),timestamp:new Date(r.updatedAt||r.createdAt||t),category:"financial",action:"purchase-order-created",description:'Orden de Compra "'.concat(r.description,'" creada'),details:{poId:r.id,description:r.description,amount:r.amount,status:r.status,supplier:r.supplier},severity:"high",user:w.manager})}),l.forEach((r,a)=>{e.push({id:"event-".concat(Date.now(),"-advance-").concat(a),timestamp:new Date(r.updatedAt||r.createdAt||t),category:"financial",action:"advance-created",description:'Anticipo "'.concat(r.description,'" creado'),details:{advanceId:r.id,description:r.description,amount:r.amount,status:r.status,recipient:r.recipient},severity:"high",user:w.manager})}),c.forEach((r,a)=>{e.push({id:"event-".concat(Date.now(),"-invoice-").concat(a),timestamp:new Date(r.updatedAt||r.createdAt||t),category:"financial",action:"invoice-created",description:'Factura "'.concat(r.description,'" creada'),details:{invoiceId:r.id,description:r.description,amount:r.amount,status:r.status,supplier:r.supplier},severity:"high",user:w.manager})}),d.forEach((r,a)=>{e.push({id:"event-".concat(Date.now(),"-contract-").concat(a),timestamp:new Date(r.updatedAt||r.createdAt||t),category:"contracts",action:"contract-created",description:'Contrato "'.concat(r.name,'" creado'),details:{contractId:r.id,name:r.name,value:r.value,status:r.status,contractor:r.contractor},severity:"high",user:w.manager})}),u.forEach((r,a)=>{e.push({id:"event-".concat(Date.now(),"-resource-").concat(a),timestamp:new Date(r.updatedAt||r.createdAt||t),category:"resources",action:"resource-assigned",description:"Recurso asignado al proyecto",details:{assignmentId:r.id,resourceId:r.resourceId,role:r.role,startDate:r.startDate,endDate:r.endDate,allocation:r.allocation},severity:"medium",user:w.manager})}),e.sort((e,t)=>t.timestamp-e.timestamp)},[w,s,n,i,o,l,c,d,u,j]),E=(0,a.useMemo)(()=>{let e=S;if("all"!==x&&(e=e.filter(e=>e.category===x)),"all"!==p){new Date;const t=new Date;switch(p){case"today":t.setHours(0,0,0,0),e=e.filter(e=>e.timestamp>=t);break;case"week":t.setDate(t.getDate()-7),e=e.filter(e=>e.timestamp>=t);break;case"month":t.setMonth(t.getMonth()-1),e=e.filter(e=>e.timestamp>=t);break;case"quarter":t.setMonth(t.getMonth()-3),e=e.filter(e=>e.timestamp>=t)}}return v&&(e=e.filter(e=>{var t,r;return e.description.toLowerCase().includes(v.toLowerCase())||(null===(t=e.details)||void 0===t||null===(r=t.name)||void 0===r?void 0:r.toLowerCase().includes(v.toLowerCase()))||e.category.toLowerCase().includes(v.toLowerCase())})),e},[S,x,p,v]),T=e=>{switch(e){case"project-status":return"\ud83c\udfe2";case"work-package":return"\ud83d\udce6";case"risk":return"\u26a0\ufe0f";case"schedule":return"\ud83d\udcc5";case"financial":return"\ud83d\udcb0";case"contracts":return"\ud83d\udccb";case"resources":return"\ud83d\udc65";case"minutes":return"\ud83d\udcdd";default:return"\ud83d\udcc4"}},_=e=>{switch(e){case"high":return"text-red-600 bg-red-50 border-red-200";case"medium":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"low":return"text-green-600 bg-green-50 border-green-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},C=e=>{switch(e){case"project-activated":return"Proyecto Activado";case"work-package-created":return"Work Package Creado";case"risk-identified":return"Riesgo Identificado";case"task-created":return"Tarea Creada";case"purchase-order-created":return"Orden de Compra Creada";case"advance-created":return"Anticipo Creado";case"invoice-created":return"Factura Creada";case"contract-created":return"Contrato Creado";case"resource-assigned":return"Recurso Asignado";case"minute-task-created":return"Tarea de Minuta Creada";case"minute-task-updated":return"Tarea de Minuta Actualizada";case"created":return"Creado";case"modified":return"Modificado";default:return e}};return w?(0,bt.jsxs)("div",{className:"space-y-6",children:[(0,bt.jsxs)("div",{className:"bg-gradient-to-r from-purple-50 to-indigo-100 rounded-2xl shadow-lg p-6 text-gray-800 relative overflow-hidden",children:[(0,bt.jsx)("div",{className:"absolute top-0 right-0 w-32 h-32 bg-purple-100/30 rounded-full -translate-y-16 translate-x-16"}),(0,bt.jsx)("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-indigo-100/30 rounded-full translate-y-12 -translate-x-12"}),(0,bt.jsx)("div",{className:"relative z-10",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{className:"flex items-center",children:[(0,bt.jsx)("div",{className:"bg-white/60 backdrop-blur rounded-2xl p-3 mr-4 shadow-sm",children:(0,bt.jsx)("span",{className:"text-3xl",children:"\ud83d\udccb"})}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h1",{className:"text-4xl font-bold mb-2 text-gray-800",children:"Auditor\xeda Documental"}),(0,bt.jsxs)("p",{className:"text-gray-600 text-lg",children:['Registro completo de movimientos del proyecto "',w.name,'"']})]})]}),(0,bt.jsxs)("div",{className:"text-right",children:[(0,bt.jsx)("div",{className:"text-4xl font-bold text-gray-800",children:E.length}),(0,bt.jsx)("div",{className:"text-gray-600",children:"Eventos Registrados"})]})]})})]}),(0,bt.jsx)("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:(0,bt.jsxs)("div",{className:"flex items-center",children:[(0,bt.jsx)("div",{className:"text-purple-600 text-xl mr-3",children:"\u2139\ufe0f"}),(0,bt.jsxs)("div",{className:"text-purple-800",children:[(0,bt.jsx)("strong",{children:"Sistema de Auditor\xeda Autom\xe1tica:"}),' Este sistema registra autom\xe1ticamente todos los movimientos del proyecto desde que cambia a estado "Activo". Los eventos se guardan localmente y se pueden exportar para an\xe1lisis externos o cumplimiento regulatorio.']})]})}),(0,bt.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Categor\xeda"}),(0,bt.jsxs)("select",{className:"w-full border border-gray-300 rounded px-3 py-2",value:x,onChange:e=>b(e.target.value),children:[(0,bt.jsx)("option",{value:"all",children:"Todas las categor\xedas"}),(0,bt.jsx)("option",{value:"project-status",children:"Estado del Proyecto"}),(0,bt.jsx)("option",{value:"work-package",children:"Work Packages"}),(0,bt.jsx)("option",{value:"risk",children:"Riesgos"}),(0,bt.jsx)("option",{value:"schedule",children:"Cronograma"}),(0,bt.jsx)("option",{value:"financial",children:"Financiero"}),(0,bt.jsx)("option",{value:"contracts",children:"Contratos"}),(0,bt.jsx)("option",{value:"resources",children:"Recursos"}),(0,bt.jsx)("option",{value:"minutes",children:"Minutas"})]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Per\xedodo"}),(0,bt.jsxs)("select",{className:"w-full border border-gray-300 rounded px-3 py-2",value:p,onChange:e=>g(e.target.value),children:[(0,bt.jsx)("option",{value:"all",children:"Todo el per\xedodo"}),(0,bt.jsx)("option",{value:"today",children:"Hoy"}),(0,bt.jsx)("option",{value:"week",children:"\xdaltima semana"}),(0,bt.jsx)("option",{value:"month",children:"\xdaltimo mes"}),(0,bt.jsx)("option",{value:"quarter",children:"\xdaltimo trimestre"})]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Buscar"}),(0,bt.jsx)("input",{type:"text",className:"w-full border border-gray-300 rounded px-3 py-2",placeholder:"Buscar eventos...",value:v,onChange:e=>y(e.target.value)})]}),(0,bt.jsxs)("div",{className:"flex items-end space-x-2",children:[(0,bt.jsx)("button",{onClick:()=>{N()},className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"\ud83d\udcc4 Exportar Reporte"}),(0,bt.jsx)("button",{onClick:()=>{window.confirm("\xbfEst\xe1 seguro de limpiar todo el log de auditor\xeda? Esta acci\xf3n no se puede deshacer.")&&k()},className:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700",title:"Limpiar log de auditor\xeda",children:"\ud83d\uddd1\ufe0f"})]})]})}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-blue-500",children:[(0,bt.jsx)("div",{className:"text-sm text-gray-500 mb-1",children:"Total Eventos"}),(0,bt.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:E.length})]}),(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-green-500",children:[(0,bt.jsx)("div",{className:"text-sm text-gray-500 mb-1",children:"Eventos Financieros"}),(0,bt.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:E.filter(e=>"financial"===e.category).length})]}),(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-red-500",children:[(0,bt.jsx)("div",{className:"text-sm text-gray-500 mb-1",children:"Alta Severidad"}),(0,bt.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:E.filter(e=>"high"===e.severity).length})]}),(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-purple-500",children:[(0,bt.jsx)("div",{className:"text-sm text-gray-500 mb-1",children:"\xdaltimo Evento"}),(0,bt.jsx)("div",{className:"text-sm font-bold text-gray-800",children:E.length>0?new Date(E[0].timestamp).toLocaleDateString():"N/A"})]})]}),(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm",children:[(0,bt.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Registro de Eventos"})}),(0,bt.jsx)("div",{className:"max-h-96 overflow-y-auto",children:0===E.length?(0,bt.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,bt.jsx)("div",{className:"text-4xl mb-4",children:"\ud83d\udced"}),(0,bt.jsx)("div",{className:"text-lg mb-2",children:"No hay eventos que coincidan con los filtros"})]}):(0,bt.jsx)("div",{className:"divide-y divide-gray-200",children:E.map(e=>(0,bt.jsx)("div",{className:"p-6 hover:bg-gray-50",children:(0,bt.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,bt.jsx)("div",{className:"text-2xl",children:T(e.category)}),(0,bt.jsxs)("div",{className:"flex-1",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,bt.jsx)("h4",{className:"font-semibold text-gray-900",children:e.description}),(0,bt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,bt.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium border ".concat(_(e.severity)),children:e.severity.toUpperCase()}),(0,bt.jsx)("span",{className:"text-sm text-gray-500",children:new Date(e.timestamp).toLocaleString()})]})]}),(0,bt.jsxs)("div",{className:"text-sm text-gray-600 mb-2",children:[(0,bt.jsx)("strong",{children:"Acci\xf3n:"})," ",C(e.action)]}),(0,bt.jsxs)("div",{className:"text-sm text-gray-600 mb-2",children:[(0,bt.jsx)("strong",{children:"Usuario:"})," ",e.user]}),e.details&&(0,bt.jsxs)("div",{className:"bg-gray-50 rounded p-3",children:[(0,bt.jsx)("div",{className:"text-sm text-gray-700",children:(0,bt.jsx)("strong",{children:"Detalles:"})}),(0,bt.jsx)("div",{className:"text-xs text-gray-600 mt-1",children:Object.entries(e.details).map(e=>{let[t,r]=e;return(0,bt.jsxs)("div",{className:"flex justify-between",children:[(0,bt.jsxs)("span",{className:"font-medium",children:[t,":"]}),(0,bt.jsx)("span",{children:String(r)})]},t)})})]})]})]})},e.id))})})]})]}):(0,bt.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,bt.jsx)("div",{className:"text-4xl mb-4",children:"\ud83d\udccb"}),(0,bt.jsx)("div",{className:"text-lg mb-2",children:"Selecciona un proyecto para ver su auditor\xeda"})]})},$j=e=>{var t,r,s,i,o,l;let{currentProjectId:c,projects:d,workPackages:u,tasks:h,purchaseOrders:f,advances:m,invoices:p,contracts:g,onUpdateProject:x}=e;const[b,v]=(0,a.useState)([]),[y,w]=(0,a.useState)(!1),[j,N]=(0,a.useState)(null),[k,S]=(0,a.useState)("all"),[E,T]=(0,a.useState)("all"),[_,C]=(0,a.useState)(""),[A,D]=(0,a.useState)(null),{addAuditEvent:P}=Fw(c),[I,O]=(0,a.useState)({title:"",description:"",justification:"",impactScope:"",impactSchedule:"",impactCost:"",impactQuality:"",impactResources:"",priority:"medium",category:"scope",requestedBy:"",requestedDate:(new Date).toISOString().split("T")[0],expectedImplementationDate:"",attachments:[],stakeholders:[]});(0,a.useEffect)(()=>{if(c){const e=localStorage.getItem("project-changes-".concat(c));e&&v(JSON.parse(e))}},[c]);const R=e=>{c&&localStorage.setItem("project-changes-".concat(c),JSON.stringify(e))},M={scope:{label:"Alcance",icon:"\ud83d\udccb",color:"bg-blue-100 text-blue-800"},schedule:{label:"Cronograma",icon:"\ud83d\udcc5",color:"bg-green-100 text-green-800"},cost:{label:"Costos",icon:"\ud83d\udcb0",color:"bg-yellow-100 text-yellow-800"},quality:{label:"Calidad",icon:"\u2b50",color:"bg-purple-100 text-purple-800"},resources:{label:"Recursos",icon:"\ud83d\udc65",color:"bg-indigo-100 text-indigo-800"},risk:{label:"Riesgos",icon:"\ud83d\udee1\ufe0f",color:"bg-red-100 text-red-800"},procurement:{label:"Adquisiciones",icon:"\ud83d\uded2",color:"bg-orange-100 text-orange-800"},communication:{label:"Comunicaciones",icon:"\ud83d\udce2",color:"bg-teal-100 text-teal-800"}},F={submitted:{label:"Enviado",icon:"\ud83d\udce4",color:"bg-gray-100 text-gray-800"},underReview:{label:"En Revisi\xf3n",icon:"\ud83d\udd0d",color:"bg-blue-100 text-blue-800"},approved:{label:"Aprobado",icon:"\u2705",color:"bg-green-100 text-green-800"},rejected:{label:"Rechazado",icon:"\u274c",color:"bg-red-100 text-red-800"},implemented:{label:"Implementado",icon:"\ud83d\ude80",color:"bg-emerald-100 text-emerald-800"},cancelled:{label:"Cancelado",icon:"\u23f9\ufe0f",color:"bg-gray-100 text-gray-600"}},L={low:{label:"Baja",icon:"\ud83d\udfe2",color:"bg-green-100 text-green-800"},medium:{label:"Media",icon:"\ud83d\udfe1",color:"bg-yellow-100 text-yellow-800"},high:{label:"Alta",icon:"\ud83d\udfe0",color:"bg-orange-100 text-orange-800"},critical:{label:"Cr\xedtica",icon:"\ud83d\udd34",color:"bg-red-100 text-red-800"}},z=(0,a.useMemo)(()=>{let e=b;return"all"!==k&&(e=e.filter(e=>e.status===k)),"all"!==E&&(e=e.filter(e=>e.priority===E)),_&&(e=e.filter(e=>e.title.toLowerCase().includes(_.toLowerCase())||e.description.toLowerCase().includes(_.toLowerCase())||e.requestedBy.toLowerCase().includes(_.toLowerCase()))),e.sort((e,t)=>new Date(t.requestedDate)-new Date(e.requestedDate))},[b,k,E,_]),B=(0,a.useMemo)(()=>({totalChanges:b.length,pendingChanges:b.filter(e=>["submitted","underReview"].includes(e.status)).length,approvedChanges:b.filter(e=>"approved"===e.status).length,implementedChanges:b.filter(e=>"implemented"===e.status).length,rejectedChanges:b.filter(e=>"rejected"===e.status).length,totalCostImpact:b.filter(e=>"approved"===e.status||"implemented"===e.status).reduce((e,t)=>e+(parseFloat(t.impactCost)||0),0),totalScheduleImpact:b.filter(e=>"approved"===e.status||"implemented"===e.status).reduce((e,t)=>e+(parseFloat(t.impactSchedule)||0),0)}),[b]),U=function(e,t){var r;let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const s=b.map(r=>{if(r.id===e){const e=(0,n.A)((0,n.A)({},r),{},{status:t,updatedAt:(new Date).toISOString(),statusHistory:[...r.statusHistory||[],{status:t,date:(new Date).toISOString(),comments:a,updatedBy:"Project Manager"}]});return"approved"===t&&W(e),e}return r});v(s),R(s),P("change_management","change_status_updated",{changeId:e,oldStatus:null===(r=b.find(t=>t.id===e))||void 0===r?void 0:r.status,newStatus:t,comments:a})},W=e=>{x&&console.log("Actualizando proyecto con cambio:",e)},H=e=>e<10?"text-green-600":e<25?"text-yellow-600":e<50?"text-orange-600":"text-red-600";return(0,bt.jsxs)("div",{className:"min-h-screen bg-gray-50 p-6",children:[(0,bt.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,bt.jsxs)("div",{className:"bg-gradient-to-r from-purple-50 to-indigo-100 rounded-2xl shadow-lg p-8 mb-8 text-gray-800 relative overflow-hidden",children:[(0,bt.jsx)("div",{className:"absolute top-0 right-0 w-32 h-32 bg-purple-100/30 rounded-full -translate-y-16 translate-x-16"}),(0,bt.jsx)("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-indigo-100/30 rounded-full translate-y-12 -translate-x-12"}),(0,bt.jsx)("div",{className:"relative z-10",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{className:"flex items-center",children:[(0,bt.jsx)("div",{className:"bg-white/60 backdrop-blur rounded-2xl p-3 mr-4 shadow-sm",children:(0,bt.jsx)("span",{className:"text-3xl",children:"\ud83d\udd04"})}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h1",{className:"text-4xl font-bold mb-3 text-gray-800",children:"Control de Cambios"}),(0,bt.jsx)("p",{className:"text-gray-600 text-lg",children:"Gesti\xf3n integral de cambios del proyecto seg\xfan PMBOK v7"}),(0,bt.jsxs)("div",{className:"mt-4 flex items-center space-x-6 text-sm text-gray-700",children:[(0,bt.jsxs)("span",{className:"flex items-center space-x-1",children:[(0,bt.jsx)("span",{className:"text-gray-500",children:"\ud83d\udccb"}),(0,bt.jsxs)("span",{children:["Total: ",B.totalChanges]})]}),(0,bt.jsxs)("span",{className:"flex items-center space-x-1",children:[(0,bt.jsx)("span",{className:"text-gray-500",children:"\u23f3"}),(0,bt.jsxs)("span",{children:["Pendientes: ",B.pendingChanges]})]}),(0,bt.jsxs)("span",{className:"flex items-center space-x-1",children:[(0,bt.jsx)("span",{className:"text-gray-500",children:"\u2705"}),(0,bt.jsxs)("span",{children:["Aprobados: ",B.approvedChanges]})]}),(0,bt.jsxs)("span",{className:"flex items-center space-x-1",children:[(0,bt.jsx)("span",{className:"text-gray-500",children:"\ud83d\ude80"}),(0,bt.jsxs)("span",{children:["Implementados: ",B.implementedChanges]})]})]})]})]}),(0,bt.jsx)("button",{onClick:()=>w(!0),className:"px-8 py-4 bg-white text-purple-700 rounded-xl hover:bg-purple-50 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-1 font-semibold border border-purple-200",children:"\ud83d\udcdd Solicitar Cambio"})]})})]}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,bt.jsx)("div",{className:"bg-white rounded-xl shadow-sm p-6 border-l-4 border-purple-500",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:B.totalChanges}),(0,bt.jsx)("div",{className:"text-sm text-gray-600",children:"Total de Cambios"})]}),(0,bt.jsx)("div",{className:"p-3 bg-purple-100 rounded-lg",children:(0,bt.jsx)("span",{className:"text-2xl",children:"\ud83d\udd04"})})]})}),(0,bt.jsx)("div",{className:"bg-white rounded-xl shadow-sm p-6 border-l-4 border-blue-500",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:B.pendingChanges}),(0,bt.jsx)("div",{className:"text-sm text-gray-600",children:"Pendientes"})]}),(0,bt.jsx)("div",{className:"p-3 bg-blue-100 rounded-lg",children:(0,bt.jsx)("span",{className:"text-2xl",children:"\u23f3"})})]})}),(0,bt.jsx)("div",{className:"bg-white rounded-xl shadow-sm p-6 border-l-4 border-green-500",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsxs)("div",{className:"text-2xl font-bold text-gray-800",children:["$",B.totalCostImpact.toFixed(0),"K"]}),(0,bt.jsx)("div",{className:"text-sm text-gray-600",children:"Impacto en Costos"})]}),(0,bt.jsx)("div",{className:"p-3 bg-green-100 rounded-lg",children:(0,bt.jsx)("span",{className:"text-2xl",children:"\ud83d\udcb0"})})]})}),(0,bt.jsx)("div",{className:"bg-white rounded-xl shadow-sm p-6 border-l-4 border-yellow-500",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:B.totalScheduleImpact}),(0,bt.jsx)("div",{className:"text-sm text-gray-600",children:"D\xedas de Impacto"})]}),(0,bt.jsx)("div",{className:"p-3 bg-yellow-100 rounded-lg",children:(0,bt.jsx)("span",{className:"text-2xl",children:"\ud83d\udcc5"})})]})})]}),(0,bt.jsx)("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-8",children:(0,bt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-4",children:[(0,bt.jsx)("div",{className:"lg:col-span-2",children:(0,bt.jsxs)("div",{className:"relative",children:[(0,bt.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,bt.jsx)("span",{className:"text-gray-400",children:"\ud83d\udd0d"})}),(0,bt.jsx)("input",{type:"text",placeholder:"Buscar cambios por t\xedtulo, descripci\xf3n o solicitante...",value:_,onChange:e=>C(e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200"})]})}),(0,bt.jsx)("div",{children:(0,bt.jsxs)("select",{value:k,onChange:e=>S(e.target.value),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200",children:[(0,bt.jsx)("option",{value:"all",children:"Todos los Estados"}),Object.entries(F).map(e=>{let[t,r]=e;return(0,bt.jsxs)("option",{value:t,children:[r.icon," ",r.label]},t)})]})}),(0,bt.jsx)("div",{children:(0,bt.jsxs)("select",{value:E,onChange:e=>T(e.target.value),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200",children:[(0,bt.jsx)("option",{value:"all",children:"Todas las Prioridades"}),Object.entries(L).map(e=>{let[t,r]=e;return(0,bt.jsxs)("option",{value:t,children:[r.icon," ",r.label]},t)})]})})]})}),(0,bt.jsx)("div",{className:"space-y-4",children:0===z.length?(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-12 text-center",children:[(0,bt.jsx)("div",{className:"text-6xl mb-6",children:"\ud83d\udcdd"}),(0,bt.jsx)("div",{className:"text-2xl font-bold text-gray-700 mb-2",children:"No hay cambios registrados"}),(0,bt.jsx)("div",{className:"text-gray-500",children:_||"all"!==k||"all"!==E?"No se encontraron cambios con los filtros aplicados":"Comienza solicitando el primer cambio del proyecto"})]}):z.map(e=>{var t,r,a,s,n,i,o,l,c;return(0,bt.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 hover:shadow-md transition-all duration-200",children:(0,bt.jsx)("div",{className:"p-6",children:(0,bt.jsxs)("div",{className:"flex items-start justify-between",children:[(0,bt.jsxs)("div",{className:"flex-1",children:[(0,bt.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[(0,bt.jsxs)("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat(null===(t=M[e.category])||void 0===t?void 0:t.color),children:[null===(r=M[e.category])||void 0===r?void 0:r.icon," ",null===(a=M[e.category])||void 0===a?void 0:a.label]}),(0,bt.jsxs)("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat(null===(s=F[e.status])||void 0===s?void 0:s.color),children:[null===(n=F[e.status])||void 0===n?void 0:n.icon," ",null===(i=F[e.status])||void 0===i?void 0:i.label]}),(0,bt.jsxs)("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat(null===(o=L[e.priority])||void 0===o?void 0:o.color),children:[null===(l=L[e.priority])||void 0===l?void 0:l.icon," ",null===(c=L[e.priority])||void 0===c?void 0:c.label]}),(0,bt.jsx)("span",{className:"text-sm text-gray-500 font-mono",children:e.changeNumber})]}),(0,bt.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:e.title}),(0,bt.jsx)("p",{className:"text-gray-600 mb-3 line-clamp-2",children:e.description}),(0,bt.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("span",{className:"text-gray-500",children:"Solicitante:"}),(0,bt.jsx)("div",{className:"font-medium",children:e.requestedBy})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("span",{className:"text-gray-500",children:"Fecha:"}),(0,bt.jsx)("div",{className:"font-medium",children:new Date(e.requestedDate).toLocaleDateString()})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("span",{className:"text-gray-500",children:"Impacto Costo:"}),(0,bt.jsxs)("div",{className:"font-medium ".concat(H(e.impactCost)),children:["$",e.impactCost||0,"K"]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("span",{className:"text-gray-500",children:"Impacto Cronograma:"}),(0,bt.jsxs)("div",{className:"font-medium ".concat(H(e.impactSchedule)),children:[e.impactSchedule||0," d\xedas"]})]})]})]}),(0,bt.jsxs)("div",{className:"flex items-center space-x-2 ml-4",children:[(0,bt.jsx)("button",{onClick:()=>D(e),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Ver detalles",children:"\ud83d\udc41\ufe0f"}),"submitted"===e.status&&(0,bt.jsx)(bt.Fragment,{children:(0,bt.jsx)("button",{onClick:()=>U(e.id,"underReview","Enviado a revisi\xf3n"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm",children:"\ud83d\udd0d Revisar"})}),"underReview"===e.status&&(0,bt.jsxs)(bt.Fragment,{children:[(0,bt.jsx)("button",{onClick:()=>U(e.id,"approved","Cambio aprobado"),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm mr-2",children:"\u2705 Aprobar"}),(0,bt.jsx)("button",{onClick:()=>U(e.id,"rejected","Cambio rechazado"),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm",children:"\u274c Rechazar"})]}),"approved"===e.status&&(0,bt.jsx)("button",{onClick:()=>U(e.id,"implemented","Cambio implementado"),className:"px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors text-sm",children:"\ud83d\ude80 Implementar"})]})]})})},e.id)})})]}),y&&(0,bt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:(0,bt.jsx)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:(0,bt.jsxs)("div",{className:"p-8",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,bt.jsx)("h2",{className:"text-3xl font-bold text-gray-800",children:"\ud83d\udcdd Solicitar Cambio"}),(0,bt.jsx)("button",{onClick:()=>w(!1),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-full transition-colors",children:"\u2715"})]}),(0,bt.jsxs)("form",{onSubmit:e=>{e.preventDefault(),(()=>{const e=(0,n.A)((0,n.A)({id:"change-".concat(Date.now())},I),{},{status:"submitted",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),changeNumber:"CHG-".concat(b.length+1).padStart(6,"0")}),t=[e].concat(b);v(t),R(t),P("change_management","change_created",{changeId:e.id,changeTitle:e.title,changeNumber:e.changeNumber}),O({title:"",description:"",justification:"",impactScope:"",impactSchedule:"",impactCost:"",impactQuality:"",impactResources:"",priority:"medium",category:"scope",requestedBy:"",requestedDate:(new Date).toISOString().split("T")[0],expectedImplementationDate:"",attachments:[],stakeholders:[]}),w(!1)})()},className:"space-y-6",children:[(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\ud83d\udccb T\xedtulo del Cambio *"}),(0,bt.jsx)("input",{type:"text",required:!0,value:I.title,onChange:e=>O({id:I.id,title:I.title,category:I.category,priority:I.priority,requestedBy:I.requestedBy,description:I.description,justification:I.justification,impactCost:I.impactCost,impactSchedule:I.impactSchedule,impactQuality:I.impactQuality,impactResources:I.impactResources,impactRisk:I.impactRisk,status:I.status,projectId:I.projectId,createdAt:I.createdAt,updatedAt:I.updatedAt,title:e.target.value}),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-colors",placeholder:"T\xedtulo descriptivo del cambio"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\ud83c\udff7\ufe0f Categor\xeda *"}),(0,bt.jsx)("select",{required:!0,value:I.category,onChange:e=>O({id:I.id,title:I.title,category:I.category,priority:I.priority,requestedBy:I.requestedBy,description:I.description,justification:I.justification,impactCost:I.impactCost,impactSchedule:I.impactSchedule,impactQuality:I.impactQuality,impactResources:I.impactResources,impactRisk:I.impactRisk,status:I.status,projectId:I.projectId,createdAt:I.createdAt,updatedAt:I.updatedAt,category:e.target.value}),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-colors",children:Object.entries(M).map(e=>{let[t,r]=e;return(0,bt.jsxs)("option",{value:t,children:[r.icon," ",r.label]},t)})})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\u26a1 Prioridad *"}),(0,bt.jsx)("select",{required:!0,value:I.priority,onChange:e=>O({id:I.id,title:I.title,category:I.category,priority:I.priority,requestedBy:I.requestedBy,description:I.description,justification:I.justification,impactCost:I.impactCost,impactSchedule:I.impactSchedule,impactQuality:I.impactQuality,impactResources:I.impactResources,impactRisk:I.impactRisk,status:I.status,projectId:I.projectId,createdAt:I.createdAt,updatedAt:I.updatedAt,priority:e.target.value}),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-colors",children:Object.entries(L).map(e=>{let[t,r]=e;return(0,bt.jsxs)("option",{value:t,children:[r.icon," ",r.label]},t)})})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\ud83d\udc64 Solicitante *"}),(0,bt.jsx)("input",{type:"text",required:!0,value:I.requestedBy,onChange:e=>O({id:I.id,title:I.title,category:I.category,priority:I.priority,requestedBy:I.requestedBy,description:I.description,justification:I.justification,impactCost:I.impactCost,impactSchedule:I.impactSchedule,impactQuality:I.impactQuality,impactResources:I.impactResources,impactRisk:I.impactRisk,status:I.status,projectId:I.projectId,createdAt:I.createdAt,updatedAt:I.updatedAt,requestedBy:e.target.value}),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-colors",placeholder:"Nombre del solicitante"})]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\ud83d\udcdd Descripci\xf3n Detallada *"}),(0,bt.jsx)("textarea",{required:!0,rows:4,value:I.description,onChange:e=>O({id:I.id,title:I.title,category:I.category,priority:I.priority,requestedBy:I.requestedBy,description:I.description,justification:I.justification,impactCost:I.impactCost,impactSchedule:I.impactSchedule,impactQuality:I.impactQuality,impactResources:I.impactResources,impactRisk:I.impactRisk,status:I.status,projectId:I.projectId,createdAt:I.createdAt,updatedAt:I.updatedAt,description:e.target.value}),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-colors resize-none",placeholder:"Describe detalladamente el cambio solicitado, incluyendo el contexto y la necesidad"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\ud83c\udfaf Justificaci\xf3n del Cambio *"}),(0,bt.jsx)("textarea",{required:!0,rows:3,value:I.justification,onChange:e=>O({id:I.id,title:I.title,category:I.category,priority:I.priority,requestedBy:I.requestedBy,description:I.description,justification:I.justification,impactCost:I.impactCost,impactSchedule:I.impactSchedule,impactQuality:I.impactQuality,impactResources:I.impactResources,impactRisk:I.impactRisk,status:I.status,projectId:I.projectId,createdAt:I.createdAt,updatedAt:I.updatedAt,justification:e.target.value}),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-colors resize-none",placeholder:"Explica por qu\xe9 es necesario este cambio y qu\xe9 beneficios aportar\xe1"})]}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\ud83d\udcb0 Impacto en Costos (USD)"}),(0,bt.jsx)("input",{type:"number",value:I.impactCost,onChange:e=>O({id:I.id,title:I.title,category:I.category,priority:I.priority,requestedBy:I.requestedBy,description:I.description,justification:I.justification,impactCost:I.impactCost,impactSchedule:I.impactSchedule,impactQuality:I.impactQuality,impactResources:I.impactResources,impactRisk:I.impactRisk,status:I.status,projectId:I.projectId,createdAt:I.createdAt,updatedAt:I.updatedAt,impactCost:e.target.value}),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-colors",placeholder:"0",min:"0",step:"0.01"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\ud83d\udcc5 Impacto en Cronograma (d\xedas)"}),(0,bt.jsx)("input",{type:"number",value:I.impactSchedule,onChange:e=>O({id:I.id,title:I.title,category:I.category,priority:I.priority,requestedBy:I.requestedBy,description:I.description,justification:I.justification,impactCost:I.impactCost,impactSchedule:I.impactSchedule,impactQuality:I.impactQuality,impactResources:I.impactResources,impactRisk:I.impactRisk,status:I.status,projectId:I.projectId,createdAt:I.createdAt,updatedAt:I.updatedAt,impactSchedule:e.target.value}),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-colors",placeholder:"0",min:"0",step:"0.5"})]})]}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\ud83d\udcc5 Fecha de Solicitud"}),(0,bt.jsx)("input",{type:"date",value:I.requestedDate,onChange:e=>O({id:I.id,title:I.title,category:I.category,priority:I.priority,requestedBy:I.requestedBy,description:I.description,justification:I.justification,impactCost:I.impactCost,impactSchedule:I.impactSchedule,impactQuality:I.impactQuality,impactResources:I.impactResources,impactRisk:I.impactRisk,status:I.status,projectId:I.projectId,createdAt:I.createdAt,updatedAt:I.updatedAt,requestedDate:e.target.value}),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-colors"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\ud83c\udfaf Fecha Esperada de Implementaci\xf3n"}),(0,bt.jsx)("input",{type:"date",value:I.expectedImplementationDate,onChange:e=>O({id:I.id,title:I.title,category:I.category,priority:I.priority,requestedBy:I.requestedBy,description:I.description,justification:I.justification,impactCost:I.impactCost,impactSchedule:I.impactSchedule,impactQuality:I.impactQuality,impactResources:I.impactResources,impactRisk:I.impactRisk,status:I.status,projectId:I.projectId,createdAt:I.createdAt,updatedAt:I.updatedAt,expectedImplementationDate:e.target.value}),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-colors"})]})]}),(0,bt.jsxs)("div",{className:"flex justify-end space-x-4 pt-6 border-t",children:[(0,bt.jsx)("button",{type:"button",onClick:()=>w(!1),className:"px-6 py-3 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-xl transition-colors font-medium",children:"Cancelar"}),(0,bt.jsx)("button",{type:"submit",className:"px-8 py-3 bg-gradient-to-r from-purple-600 to-indigo-600 text-white rounded-xl hover:from-purple-700 hover:to-indigo-700 transition-all duration-200 font-medium shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",children:"\ud83d\udce4 Enviar Solicitud"})]})]})]})})}),A&&(0,bt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:(0,bt.jsx)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:(0,bt.jsxs)("div",{className:"p-8",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,bt.jsxs)("h2",{className:"text-3xl font-bold text-gray-800",children:["\ud83d\udccb Detalles del Cambio: ",A.changeNumber]}),(0,bt.jsx)("button",{onClick:()=>D(null),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-full transition-colors",children:"\u2715"})]}),(0,bt.jsxs)("div",{className:"space-y-6",children:[(0,bt.jsxs)("div",{className:"bg-gray-50 rounded-xl p-6",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"\ud83d\udccb Informaci\xf3n B\xe1sica"}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("span",{className:"text-sm text-gray-500",children:"T\xedtulo:"}),(0,bt.jsx)("div",{className:"font-medium",children:A.title})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("span",{className:"text-sm text-gray-500",children:"Categor\xeda:"}),(0,bt.jsxs)("div",{className:"font-medium",children:[null===(t=M[A.category])||void 0===t?void 0:t.icon," ",null===(r=M[A.category])||void 0===r?void 0:r.label]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("span",{className:"text-sm text-gray-500",children:"Prioridad:"}),(0,bt.jsxs)("div",{className:"font-medium",children:[null===(s=L[A.priority])||void 0===s?void 0:s.icon," ",null===(i=L[A.priority])||void 0===i?void 0:i.label]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("span",{className:"text-sm text-gray-500",children:"Estado:"}),(0,bt.jsxs)("div",{className:"font-medium",children:[null===(o=F[A.status])||void 0===o?void 0:o.icon," ",null===(l=F[A.status])||void 0===l?void 0:l.label]})]})]})]}),(0,bt.jsxs)("div",{className:"bg-gray-50 rounded-xl p-6",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"\ud83d\udcdd Descripci\xf3n y Justificaci\xf3n"}),(0,bt.jsxs)("div",{className:"space-y-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("span",{className:"text-sm text-gray-500",children:"Descripci\xf3n:"}),(0,bt.jsx)("div",{className:"mt-1",children:A.description})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("span",{className:"text-sm text-gray-500",children:"Justificaci\xf3n:"}),(0,bt.jsx)("div",{className:"mt-1",children:A.justification})]})]})]}),(0,bt.jsxs)("div",{className:"bg-gray-50 rounded-xl p-6",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"\ud83d\udcca An\xe1lisis de Impactos"}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("span",{className:"text-sm text-gray-500",children:"Impacto en Costos:"}),(0,bt.jsxs)("div",{className:"font-medium text-lg",children:["$",A.impactCost||0,"K"]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("span",{className:"text-sm text-gray-500",children:"Impacto en Cronograma:"}),(0,bt.jsxs)("div",{className:"font-medium text-lg",children:[A.impactSchedule||0," d\xedas"]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("span",{className:"text-sm text-gray-500",children:"Impacto en Alcance:"}),(0,bt.jsx)("div",{className:"font-medium",children:A.impactScope||"No especificado"})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("span",{className:"text-sm text-gray-500",children:"Impacto en Calidad:"}),(0,bt.jsx)("div",{className:"font-medium",children:A.impactQuality||"No especificado"})]})]})]}),A.statusHistory&&A.statusHistory.length>0&&(0,bt.jsxs)("div",{className:"bg-gray-50 rounded-xl p-6",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"\ud83d\udcc8 Historial de Estados"}),(0,bt.jsx)("div",{className:"space-y-3",children:A.statusHistory.map((e,t)=>{var r,a,s;return(0,bt.jsxs)("div",{className:"flex items-center space-x-3 p-3 bg-white rounded-lg",children:[(0,bt.jsxs)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(null===(r=F[e.status])||void 0===r?void 0:r.color),children:[null===(a=F[e.status])||void 0===a?void 0:a.icon," ",null===(s=F[e.status])||void 0===s?void 0:s.label]}),(0,bt.jsx)("span",{className:"text-sm text-gray-500",children:new Date(e.date).toLocaleDateString()}),e.comments&&(0,bt.jsxs)("span",{className:"text-sm text-gray-600",children:["- ",e.comments]})]},t)})})]}),(0,bt.jsxs)("div",{className:"flex justify-end space-x-4 pt-6 border-t",children:[(0,bt.jsx)("button",{onClick:()=>D(null),className:"px-6 py-3 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-xl transition-colors font-medium",children:"Cerrar"}),"submitted"===A.status&&(0,bt.jsx)("button",{onClick:()=>{U(A.id,"underReview","Enviado a revisi\xf3n"),D(null)},className:"px-6 py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors font-medium",children:"\ud83d\udd0d Enviar a Revisi\xf3n"}),"underReview"===A.status&&(0,bt.jsxs)(bt.Fragment,{children:[(0,bt.jsx)("button",{onClick:()=>{U(A.id,"approved","Cambio aprobado"),D(null)},className:"px-6 py-3 bg-green-600 text-white rounded-xl hover:bg-green-700 transition-colors font-medium",children:"\u2705 Aprobar"}),(0,bt.jsx)("button",{onClick:()=>{U(A.id,"rejected","Cambio rechazado"),D(null)},className:"px-6 py-3 bg-red-600 text-white rounded-xl hover:bg-red-700 transition-colors font-medium",children:"\u274c Rechazar"})]}),"approved"===A.status&&(0,bt.jsx)("button",{onClick:()=>{U(A.id,"implemented","Cambio implementado"),D(null)},className:"px-6 py-3 bg-emerald-600 text-white rounded-xl hover:bg-emerald-700 transition-colors font-medium",children:"\ud83d\ude80 Marcar como Implementado"})]})]})]})})})]})},Kj=e=>{let{currentProjectId:t,currentProject:r,projects:s,workPackages:n,tasks:i,purchaseOrders:o,advances:l,invoices:c,contracts:d}=e;const u=(0,a.useMemo)(()=>Math.random().toString(36).substr(2,9),[]);console.log("\ud83d\udd0d CASHFLOW COMPONENT - INSTANCIA ".concat(u," INICIANDO:"),{currentProject:null===r||void 0===r?void 0:r.name,tasksCount:(null===i||void 0===i?void 0:i.length)||0,timestamp:(new Date).toISOString()}),console.log("\ud83d\udd0d CASHFLOW COMPONENT [".concat(u,"] - TAREAS RECIBIDAS:"),{totalTasks:(null===i||void 0===i?void 0:i.length)||0,tasksWithCosts:(null===i||void 0===i?void 0:i.filter(e=>e.cost>0).length)||0,tasksWithCostsDetails:(null===i||void 0===i?void 0:i.filter(e=>e.cost>0).map(e=>({id:e.id,name:e.name,cost:e.cost,startDate:e.startDate,endDate:e.endDate,isMilestone:e.isMilestone})))||[]});const[h,f]=(0,a.useState)("12"),[m,p]=(0,a.useState)((new Date).toISOString().split("T")[0]),[g,x]=(0,a.useState)(!1),[b,v]=(0,a.useState)({paymentTerms:"milestone",revenueRecognition:"percentage_completion"}),{addAuditEvent:y}=Fw(t);console.log("\ud83d\udd0d CASHFLOW DEBUG - currentProject recibido:",r),console.log("\ud83d\udd0d CASHFLOW DEBUG - currentProjectId:",t);const w=e=>{if(!r||!i)return console.log("\ud83d\udd0d CashFlow: No hay proyecto o tareas:",{currentProject:!!r,tasks:!!i}),0;const t=new Date(e.getFullYear(),e.getMonth(),1),a=new Date(e.getFullYear(),e.getMonth()+1,0);if(console.log("\ud83d\udd0d CashFlow: Calculando gasto planificado para mes:",{month:e.toLocaleDateString("es-ES",{year:"numeric",month:"long"}),monthStart:t.toISOString().split("T")[0],monthEnd:a.toISOString().split("T")[0],totalTasks:i.length}),6===e.getMonth()&&2026===e.getFullYear()){console.log("\ud83d\udd0d DEBUG JULIO 2026 - AN\xc1LISIS COMPLETO DE TAREAS:"),console.log("\ud83d\udd0d Rango del mes julio 2026:",{monthStart:t.toISOString().split("T")[0],monthEnd:a.toISOString().split("T")[0]});let e=0,r=0,s=[];i.forEach((n,i)=>{if(n.cost&&n.cost>0){e+=n.cost;const o=new Date(n.startDate),l=new Date(n.endDate);let c=!1;c=n.isMilestone||0===n.duration?o>=t&&o<=a:o<=a&&l>=t,c?(r++,console.log("  \u2705 INCLUIDA - Tarea ".concat(i+1,":"),{name:n.name||n.title,cost:n.cost,startDate:n.startDate,endDate:n.endDate,isMilestone:n.isMilestone,duration:n.duration,taskStart:o.toISOString().split("T")[0],taskEnd:l.toISOString().split("T")[0]})):s.push({index:i+1,name:n.name||n.title,cost:n.cost,startDate:n.startDate,taskStart:o.toISOString().split("T")[0],isMilestone:n.isMilestone,razon:n.isMilestone?"Hito fuera del rango: ".concat(o.toISOString().split("T")[0]," no est\xe1 entre ").concat(t.toISOString().split("T")[0]," y ").concat(a.toISOString().split("T")[0]):"Tarea normal sin intersecci\xf3n: ".concat(o.toISOString().split("T")[0]," - ").concat(l.toISOString().split("T")[0]," no intersecta con ").concat(t.toISOString().split("T")[0]," - ").concat(a.toISOString().split("T")[0])})}}),console.log("\ud83d\udd0d JULIO 2026 - Resumen:",{totalTareas:i.length,tareasConCosto:i.filter(e=>e.cost>0).length,tareasEnJulio:r,costoTotalEsperado:e,costoPromedioPorTarea:e/i.filter(e=>e.cost>0).length}),console.log("\ud83d\udd0d JULIO 2026 - Tareas EXCLUIDAS (posibles causas del error):",s)}let s=0,n=0,o=0;return i.forEach((r,i)=>{if(console.log("\ud83d\udd0d CashFlow: Tarea ".concat(i+1,":"),{name:r.name||r.title,cost:r.cost,startDate:r.startDate,endDate:r.endDate,hasCost:!!r.cost,hasDates:!(!r.startDate||!r.endDate),isMilestone:r.isMilestone,duration:r.duration}),44===i){const s=e.toLocaleDateString("es-ES",{year:"numeric",month:"long"});console.log("\ud83d\udea8 DEBUG TAREA 45 ESPEC\xcdFICA:",{taskName:r.name||r.title,taskCost:r.cost,taskStartDate:r.startDate,taskEndDate:r.endDate,isMilestone:r.isMilestone,duration:r.duration,monthStart:t.toISOString().split("T")[0],monthEnd:a.toISOString().split("T")[0],monthName:s}),"agosto de 2026"===s&&r.cost>0&&console.log("\ud83d\udd0d CASHFLOW [".concat(u,"] - TAREA CON COSTO EN AGOSTO 2026:"),{taskIndex:i,taskId:r.id,taskName:r.name,taskCost:r.cost,taskStartDate:r.startDate,taskEndDate:r.endDate,isMilestone:r.isMilestone,duration:r.duration,monthName:s,monthStart:t.toISOString().split("T")[0],monthEnd:a.toISOString().split("T")[0]})}if(r.cost&&r.startDate&&r.endDate){n++;const l=new Date(r.startDate),c=new Date(r.endDate),d=e.toLocaleDateString("es-ES",{year:"numeric",month:"long"});("julio de 2026"===d||"agosto de 2026"===d)&&r.cost>0&&console.log("\ud83d\udd0d CASHFLOW [".concat(u,"] - TAREA CON COSTO EN ").concat(d.toUpperCase(),":"),{taskIndex:i,taskId:r.id,taskName:r.name,taskCost:r.cost,taskStartDate:r.startDate,taskEndDate:r.endDate,isMilestone:r.isMilestone,duration:r.duration,monthName:d,monthStart:t.toISOString().split("T")[0],monthEnd:a.toISOString().split("T")[0]});let h=!1;if(r.isMilestone||0===r.duration?(h=l>=t&&l<=a,r.cost>0&&("julio de 2026"===d||"agosto de 2026"===d)&&console.log("\ud83c\udfaf DEBUG HITO [".concat(u,"] - Verificaci\xf3n de mes:"),{taskName:r.name||r.title,taskStartDate:r.startDate,taskStart:l.toISOString().split("T")[0],monthStart:t.toISOString().split("T")[0],monthEnd:a.toISOString().split("T")[0],isInMonth:h,monthName:d,comparison:{taskStartGreaterEqualMonthStart:l>=t,taskStartLessEqualMonthEnd:l<=a,taskStartTime:l.getTime(),monthStartTime:t.getTime(),monthEndTime:a.getTime()}})):h=l<=a&&c>=t,h)if(o++,r.isMilestone||0===r.duration){const e=r.cost||0;s+=e,console.log('\ud83d\udcb0 CashFlow: HITO "'.concat(r.name||r.title,'" en mes:'),{taskCost:r.cost,isMilestone:!0,startDate:r.startDate,endDate:r.endDate,costInMonth:e.toFixed(2)}),r.cost&&r.cost>3e5&&console.log("\ud83d\udea8 DEBUG HITO PROBLEM\xc1TICO:",{taskName:r.name||r.title,taskCost:r.cost,taskStartDate:r.startDate,taskEndDate:r.endDate,monthStart:t.toISOString().split("T")[0],monthEnd:a.toISOString().split("T")[0],isInMonth:l<=a&&c>=t,plannedExpenseBefore:s-e,plannedExpenseAfter:s})}else{const e=c-l+1,n=new Date(Math.max(l.getTime(),t.getTime())),i=new Date(Math.min(c.getTime(),a.getTime()))-n+1;if(i>0){const t=i/e,a=(r.cost||0)*t;s+=a,console.log('\ud83d\udcb0 CashFlow: Tarea "'.concat(r.name||r.title,'" en mes:'),{taskCost:r.cost,percentageInMonth:(100*t).toFixed(1)+"%",costInMonth:a.toFixed(2)})}}}}),console.log("\ud83d\udd0d CashFlow: Resumen del mes:",{totalTasks:i.length,tasksWithCosts:n,tasksInMonth:o,plannedExpense:s.toFixed(2)}),6===e.getMonth()&&2026===e.getFullYear()&&console.log("\ud83c\udfaf JULIO 2026 - VALOR FINAL CALCULADO:",{plannedExpense:s,plannedExpenseFixed:s.toFixed(3),valorEsperadoPorUsuario:385953.528,diferencia:s-385953.528,porcentajeDelEsperado:(s/385953.528*100).toFixed(2)+"%"}),s},j=(e,t)=>{if(!r)return 0;console.log("\ud83d\udd0d CASHFLOW PROJECTION - calculateMonthCommittedExpense iniciando:",{monthDate:e.toISOString().substring(0,7),purchaseOrdersLength:(null===o||void 0===o?void 0:o.length)||0,purchaseOrders:o});const a=(null===o||void 0===o?void 0:o.filter(e=>"approved"===e.status))||[];console.log("\ud83d\udd0d CASHFLOW PROJECTION - \xd3rdenes de compra aprobadas:",a.map(e=>({id:e.id,number:e.number,status:e.status,totalAmount:e.totalAmount,approvalDate:e.approvalDate,requestDate:e.requestDate,hasApprovalDate:!(!e.approvalDate||""===e.approvalDate.trim()),hasRequestDate:!(!e.requestDate||""===e.requestDate.trim())})));let s=0;const n=new Date(e.getFullYear(),e.getMonth(),1),i=new Date(e.getFullYear(),e.getMonth()+1,0);n.setHours(0,0,0,0),i.setHours(23,59,59,999),console.log("\ud83d\udd0d CASHFLOW PROJECTION - Rango de fechas:",{monthStart:n.toISOString().split("T")[0],monthEnd:i.toISOString().split("T")[0]});const l=(null===o||void 0===o?void 0:o.filter(e=>{if("approved"!==e.status)return!1;if(!e.approvalDate||""===e.approvalDate.trim())return console.log("\u26a0\ufe0f CASHFLOW PROJECTION - OC sin fecha de aprobaci\xf3n:",{id:e.id,number:e.number,status:e.status,totalAmount:e.totalAmount,approvalDate:e.approvalDate}),!1;const r=new Date(e.approvalDate+"T00:00:00"),a=new Date(r);a.setDate(r.getDate()+t);const s=a>=n&&a<=i;return console.log("\ud83d\udd0d CASHFLOW PROJECTION - Evaluando OC:",{id:e.id,number:e.number,approvalDate:e.approvalDate,approvalDateParsed:r.toISOString().split("T")[0],adjustedDate:a.toISOString().split("T")[0],monthStart:n.toISOString().split("T")[0],monthEnd:i.toISOString().split("T")[0],daysToPayment:t,status:e.status,totalAmount:e.totalAmount,isInMonth:s,willInclude:s}),s}))||[];return s+=l.reduce((e,t)=>(console.log("\u2705 CASHFLOW PROJECTION - INCLUYENDO OC ".concat(t.number,": $").concat(t.totalAmount)),e+(t.totalAmount||0)),0),console.log("\ud83d\udd0d CASHFLOW PROJECTION - Resultado final:",{monthPOsCount:l.length,committedExpense:s}),s},N=e=>{if(!r)return 0;let t=0;const a=new Date(e.getFullYear(),e.getMonth(),1),s=new Date(e.getFullYear(),e.getMonth()+1,0);t+=((null===l||void 0===l?void 0:l.filter(e=>{if("paid"!==e.status)return!1;const t=new Date(e.paymentDate||e.date);return t>=a&&t<=s}))||[]).reduce((e,t)=>e+(t.amount||0),0);return t+=((null===c||void 0===c?void 0:c.filter(e=>{if("paid"!==e.status)return!1;const t=new Date(e.paymentDate||e.date);return t>=a&&t<=s}))||[]).reduce((e,t)=>e+(t.amount||0),0),t},k=(0,a.useMemo)(()=>Date.now(),[r,i,h,m]),S=(0,a.useMemo)(()=>{if(!r)return null;console.log("\ud83d\udd04 CASHFLOW PROJECTION [".concat(u,"] - FORZANDO REC\xc1LCULO COMPLETO:"),{currentProject:null===r||void 0===r?void 0:r.name,projectionPeriod:h,projectionStartDate:m,purchaseOrders:(null===o||void 0===o?void 0:o.length)||0,advances:(null===l||void 0===l?void 0:l.length)||0,invoices:(null===c||void 0===c?void 0:c.length)||0,tasks:(null===i||void 0===i?void 0:i.length)||0,forceRecalculation:k,timestamp:(new Date).toISOString()});const e=new Date(m),t=parseInt(h),a=[],s={net30:30,net60:60,net90:90,advance:-15,milestone:0}[b.paymentTerms];console.log("\ud83d\udd0d CASHFLOW PROJECTION - CONFIGURACI\xd3N COMPLETA:",{startDate:e.toISOString().split("T")[0],months:t,projectionStartDate:m,projectionPeriod:h,currentProject:null===r||void 0===r?void 0:r.name});for(let r=0;r<t;r++){const t=new Date(e.getFullYear(),e.getMonth()+r,1),n=t.toISOString().slice(0,7),i=t.toLocaleDateString("es-ES",{year:"numeric",month:"long"});console.log("\ud83d\udd0d CASHFLOW PROJECTION - Procesando mes ".concat(r+1,": ").concat(n," (").concat(i,")")),"2026-07"===n&&console.log("\ud83c\udfaf JULIO 2026 DETECTADO - Iniciando c\xe1lculo detallado...");const o=w(t);console.log("\ud83d\udd0d CASHFLOW PROJECTION [".concat(u,"] - RESULTADO calculateMonthPlannedExpense para ").concat(n,": $").concat(o)),console.log("\ud83d\udd0d CASHFLOW PROJECTION - LLAMANDO calculateMonthCommittedExpense para mes ".concat(n));const l=j(t,s);console.log("\ud83d\udd0d CASHFLOW PROJECTION - RESULTADO calculateMonthCommittedExpense: $".concat(l));const c=N(t),d={month:r+1,monthKey:n,monthLabel:i,date:t,revenue:o,expenses:l,realExpenses:c,netCashFlow:o-c,cumulativeBalance:(r>0?a[r-1].cumulativeBalance:0)+o,cashIn:o,cashOut:c};"2026-07"!==n&&"2026-08"!==n||console.log("\ud83d\udd0d CASHFLOW PROJECTION [".concat(u,"] - ASIGNANDO VALORES para ").concat(n,":"),{monthPlannedExpense:o,revenue:d.revenue,monthLabel:d.monthLabel,monthKey:d.monthKey}),a.push(d)}return console.log("\ud83d\udd0d CASHFLOW PROJECTION [".concat(u,"] - PROYECCI\xd3N FINAL COMPLETA:"),{totalMonths:a.length,julio2026:a.find(e=>"2026-07"===e.monthKey),agosto2026:a.find(e=>"2026-08"===e.monthKey),timestamp:(new Date).toISOString()}),a},[r,h,m,b,o,l,c,d,i,k]),E=(0,a.useMemo)(()=>{if(!S)return null;const e=S.reduce((e,t)=>e+t.revenue,0),t=S.reduce((e,t)=>e+t.expenses,0),r=S.reduce((e,t)=>e+t.realExpenses,0);return{totalRevenue:e,totalPlannedExpense:e,totalCommittedExpenses:t,totalRealExpenses:r,totalExpenses:t,totalNetCashFlow:e-r,maxCashOutflow:Math.min(...S.map(e=>e.cumulativeBalance)),maxCashInflow:Math.max(...S.map(e=>e.cumulativeBalance)),positiveMonths:S.filter(e=>e.netCashFlow>0).length,negativeMonths:S.filter(e=>e.netCashFlow<0).length,averageMonthlyRevenue:e/S.length,averageMonthlyExpenses:t/S.length,averageMonthlyRealExpenses:r/S.length,projectDuration:S.length}},[S]),T=e=>{if(null===e||void 0===e||isNaN(e))return"$0,00";const t=new Intl.NumberFormat("es-MX",{minimumFractionDigits:2,maximumFractionDigits:3}).format(e);return"$".concat(t)},_=e=>e>0?"text-green-600":e<0?"text-red-600":"text-gray-600",C=e=>e>0?"text-green-700":e<0?"text-red-700":"text-gray-700";return r?(0,bt.jsxs)("div",{className:"min-h-screen bg-gray-50 p-6",children:[(0,bt.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,bt.jsxs)("div",{className:"bg-gradient-to-r from-green-50 to-emerald-100 rounded-2xl shadow-lg p-8 mb-8 text-gray-800 relative overflow-hidden",children:[(0,bt.jsx)("div",{className:"absolute top-0 right-0 w-32 h-32 bg-green-100/30 rounded-full -translate-y-16 translate-x-16"}),(0,bt.jsx)("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-emerald-100/30 rounded-full translate-y-12 -translate-x-12"}),(0,bt.jsx)("div",{className:"relative z-10",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{className:"flex items-center",children:[(0,bt.jsx)("div",{className:"bg-white/60 backdrop-blur rounded-2xl p-3 mr-4 shadow-sm",children:(0,bt.jsx)("span",{className:"text-3xl",children:"\ud83d\udcb0"})}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h1",{className:"text-4xl font-bold mb-3 text-gray-800",children:"Proyecci\xf3n de Flujo de Caja"}),(0,bt.jsx)("p",{className:"text-gray-600 text-lg",children:"An\xe1lisis financiero del proyecto seg\xfan PMBOK v7 - Gesti\xf3n de Costos"}),(0,bt.jsxs)("div",{className:"mt-4 flex items-center space-x-6 text-sm text-gray-700",children:[(0,bt.jsxs)("span",{className:"flex items-center space-x-1",children:[(0,bt.jsx)("span",{className:"text-gray-500",children:"\ud83d\udcca"}),(0,bt.jsxs)("span",{children:["Proyecto: ",r.name]})]}),(0,bt.jsxs)("span",{className:"flex items-center space-x-1",children:[(0,bt.jsx)("span",{className:"text-gray-500",children:"\ud83d\udcc5"}),(0,bt.jsxs)("span",{children:["Per\xedodo: ",h," meses"]})]}),(0,bt.jsxs)("span",{className:"flex items-center space-x-1",children:[(0,bt.jsx)("span",{className:"text-gray-500",children:"\ud83d\udcb5"}),(0,bt.jsxs)("span",{children:["Presupuesto: $",(r.budget/1e3).toFixed(0),"K"]})]}),(0,bt.jsxs)("span",{className:"flex items-center space-x-1",children:[(0,bt.jsx)("span",{className:"text-gray-500",children:"\ud83d\udee1\ufe0f"}),(0,bt.jsxs)("span",{children:["Reserva: $",((r.contingencyReserve+r.managementReserve)/1e3).toFixed(0),"K"]})]})]})]})]}),(0,bt.jsx)("div",{className:"flex items-center space-x-4",children:(0,bt.jsx)("button",{onClick:()=>{if(!S)return;const e=[["Mes","Gasto Planificado","Gasto Comprometido (OCs)","Gasto Real","Saldo Acumulado"],...S.map(e=>[e.monthLabel,T(e.revenue),T(e.expenses),T(e.realExpenses),T(e.cumulativeBalance)])].map(e=>e.join(",")).join("\n"),a=new Blob([e],{type:"text/csv"}),s=window.URL.createObjectURL(a),n=document.createElement("a");n.href=s,n.download="proyeccion-flujo-caja-".concat((null===r||void 0===r?void 0:r.name)||"proyecto",".csv"),n.click(),window.URL.revokeObjectURL(s),y("cash_flow","projection_exported",{projectId:t,period:h,startDate:m})},className:"px-6 py-3 bg-white text-green-700 rounded-xl hover:bg-green-50 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-1 font-semibold border border-green-200",children:"\ud83d\udcca Exportar"})})]})})]}),E&&(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,bt.jsx)("div",{className:"bg-white rounded-xl shadow-sm p-6 border-l-4 border-orange-500",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:T(E.totalRevenue)}),(0,bt.jsx)("div",{className:"text-sm text-gray-600",children:"Gasto Planificado Total"})]}),(0,bt.jsx)("div",{className:"p-3 bg-orange-100 rounded-lg",children:(0,bt.jsx)("span",{className:"text-2xl",children:"\ud83d\udcb0"})})]})}),(0,bt.jsx)("div",{className:"bg-white rounded-xl shadow-sm p-6 border-l-4 border-red-500",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:T(E.totalExpenses)}),(0,bt.jsx)("div",{className:"text-sm text-gray-600",children:"Gastos Totales"})]}),(0,bt.jsx)("div",{className:"p-3 bg-red-100 rounded-lg",children:(0,bt.jsx)("span",{className:"text-2xl",children:"\ud83d\udcc9"})})]})}),(0,bt.jsx)("div",{className:"bg-white rounded-xl shadow-sm p-6 border-l-4 border-blue-500",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("div",{className:"text-2xl font-bold ".concat(_(E.totalNetCashFlow)),children:T(E.totalNetCashFlow)}),(0,bt.jsx)("div",{className:"text-sm text-gray-600",children:"Flujo Neto"})]}),(0,bt.jsx)("div",{className:"p-3 bg-blue-100 rounded-lg",children:(0,bt.jsx)("span",{className:"text-2xl",children:"\ud83d\udcb0"})})]})}),(0,bt.jsx)("div",{className:"bg-white rounded-xl shadow-sm p-6 border-l-4 border-purple-500",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("div",{className:"text-2xl font-bold ".concat(C(E.maxCashOutflow)),children:T(E.maxCashOutflow)}),(0,bt.jsx)("div",{className:"text-sm text-gray-600",children:"M\xe1ximo D\xe9ficit"})]}),(0,bt.jsx)("div",{className:"p-3 bg-purple-100 rounded-lg",children:(0,bt.jsx)("span",{className:"text-2xl",children:"\u26a0\ufe0f"})})]})})]}),(0,bt.jsx)("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-8",children:(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\ud83d\udcc5 Per\xedodo de Proyecci\xf3n (meses)"}),(0,bt.jsxs)("select",{value:h,onChange:e=>f(e.target.value),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-colors",children:[(0,bt.jsx)("option",{value:"6",children:"6 meses"}),(0,bt.jsx)("option",{value:"12",children:"12 meses"}),(0,bt.jsx)("option",{value:"18",children:"18 meses"}),(0,bt.jsx)("option",{value:"24",children:"24 meses"}),(0,bt.jsx)("option",{value:"36",children:"36 meses"})]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\ud83d\ude80 Fecha de Inicio"}),(0,bt.jsx)("input",{type:"date",value:m,onChange:e=>p(e.target.value),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-colors"})]}),(0,bt.jsx)("div",{className:"flex items-end",children:(0,bt.jsx)("button",{onClick:()=>x(!0),className:"w-full px-6 py-3 bg-gradient-to-r from-green-600 to-emerald-600 text-white rounded-xl hover:from-green-700 hover:to-emerald-700 transition-all duration-200 shadow-sm hover:shadow-md",children:"\u2699\ufe0f Configuraci\xf3n Avanzada"})})]})}),S&&(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:[(0,bt.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"\ud83d\udcca Proyecci\xf3n Mensual de Flujo de Caja"})}),(0,bt.jsx)("div",{className:"overflow-x-auto",children:(0,bt.jsxs)("table",{className:"w-full",children:[(0,bt.jsx)("thead",{className:"bg-gradient-to-r from-gray-50 to-gray-100",children:(0,bt.jsxs)("tr",{children:[(0,bt.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Mes"}),(0,bt.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Gasto Planificado"}),(0,bt.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Gasto Comprometido (OCs)"}),(0,bt.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Gasto Real"}),(0,bt.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Saldo Acumulado"}),(0,bt.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estado"})]})}),(0,bt.jsx)("tbody",{className:"divide-y divide-gray-100",children:S.map(e=>("2026-07"!==e.monthKey&&"2026-08"!==e.monthKey||console.log("\ud83d\udd0d CASHFLOW RENDER [".concat(u,"] - RENDERIZANDO ").concat(e.monthKey,":"),{monthLabel:e.monthLabel,revenue:e.revenue,formattedRevenue:T(e.revenue),monthObject:e}),(0,bt.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors",children:[(0,bt.jsxs)("td",{className:"px-6 py-4",children:[(0,bt.jsx)("div",{className:"font-medium text-gray-900",children:e.monthLabel}),(0,bt.jsxs)("div",{className:"text-sm text-gray-500",children:["Mes ",e.month]})]}),(0,bt.jsx)("td",{className:"px-6 py-4",children:(0,bt.jsx)("div",{className:"text-orange-600 font-medium",children:T(e.revenue)})}),(0,bt.jsx)("td",{className:"px-6 py-4",children:(0,bt.jsx)("div",{className:"text-blue-600 font-medium",children:T(e.expenses)})}),(0,bt.jsx)("td",{className:"px-6 py-4",children:(0,bt.jsx)("div",{className:"text-red-600 font-medium",children:T(e.realExpenses)})}),(0,bt.jsx)("td",{className:"px-6 py-4",children:(0,bt.jsx)("div",{className:"font-medium ".concat(C(e.cumulativeBalance)),children:T(e.cumulativeBalance)})}),(0,bt.jsx)("td",{className:"px-6 py-4",children:(0,bt.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-medium ".concat(e.cumulativeBalance>0?"bg-green-100 text-green-800":e.cumulativeBalance<0?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"),children:e.cumulativeBalance>0?"\u2705 Positivo":e.cumulativeBalance<0?"\u26a0\ufe0f D\xe9ficit":"\u2696\ufe0f Equilibrio"})})]},e.month)))})]})})]}),S&&(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6 mt-8",children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-6",children:"\ud83d\udcc8 Gr\xe1fico de Flujo de Caja"}),(0,bt.jsxs)("div",{className:"mb-8",children:[(0,bt.jsx)("h4",{className:"text-md font-medium text-gray-700 mb-4",children:"\ud83d\udcb0 Flujo Neto Mensual"}),(0,bt.jsx)("div",{className:"h-48 flex items-end justify-between space-x-2",children:S.map(e=>{const t=Math.max(...S.map(e=>Math.abs(e.netCashFlow)));let r=0;return t>0&&(r=Math.abs(e.netCashFlow)/t*192),0===e.netCashFlow&&(r=2),(0,bt.jsxs)("div",{className:"flex-1 flex flex-col items-center",children:[(0,bt.jsx)("div",{className:"text-xs text-gray-500 mb-2 text-center",children:e.monthLabel.slice(0,3)}),(0,bt.jsx)("div",{className:"w-full rounded-t transition-all duration-300 ".concat(e.netCashFlow>0?"bg-green-500":e.netCashFlow<0?"bg-red-500":"bg-gray-400"),style:{height:"".concat(r,"px")}}),(0,bt.jsx)("div",{className:"text-xs font-medium mt-1 ".concat(_(e.netCashFlow)),children:T(e.netCashFlow)})]},"net-".concat(e.month))})})]}),(0,bt.jsxs)("div",{className:"mb-8",children:[(0,bt.jsx)("h4",{className:"text-md font-medium text-gray-700 mb-4",children:"\ud83d\udcca Saldo Acumulado (L\xednea de Tiempo)"}),(0,bt.jsxs)("div",{className:"h-48 relative",children:[(0,bt.jsxs)("svg",{className:"w-full h-full",viewBox:"0 0 ".concat(100*S.length," 200"),children:[(0,bt.jsx)("line",{x1:"0",y1:"100",x2:100*S.length,y2:"100",stroke:"#e5e7eb",strokeWidth:"1",strokeDasharray:"5,5"}),(()=>{const e=Math.min(...S.map(e=>e.cumulativeBalance)),t=Math.max(...S.map(e=>e.cumulativeBalance))-e,r=S.map((r,a)=>{const s=200-180*(t>0?(r.cumulativeBalance-e)/t:.5);return"".concat(100*a+50,",").concat(s)}).join(" ");return(0,bt.jsx)("polyline",{points:r,fill:"none",stroke:"#3b82f6",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"})})(),(()=>{const e=Math.min(...S.map(e=>e.cumulativeBalance)),t=Math.max(...S.map(e=>e.cumulativeBalance))-e;return S.map((r,a)=>{const s=200-180*(t>0?(r.cumulativeBalance-e)/t:.5);return(0,bt.jsx)("circle",{cx:100*a+50,cy:s,r:"4",fill:r.cumulativeBalance>0?"#10b981":r.cumulativeBalance<0?"#ef4444":"#6b7280",stroke:"white",strokeWidth:"2"},"point-".concat(r.month))})})()]}),(0,bt.jsx)("div",{className:"absolute bottom-0 left-0 right-0 flex justify-between px-4",children:S.map(e=>(0,bt.jsx)("div",{className:"text-xs text-gray-500",children:e.monthLabel.slice(0,3)},"label-".concat(e.month)))})]})]})]})]}),g&&(0,bt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:(0,bt.jsx)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:(0,bt.jsxs)("div",{className:"p-8",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,bt.jsx)("h2",{className:"text-3xl font-bold text-gray-800",children:"\u2699\ufe0f Configuraci\xf3n de Proyecci\xf3n"}),(0,bt.jsx)("button",{onClick:()=>x(!1),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-full transition-colors",children:"\u2715"})]}),(0,bt.jsxs)("div",{className:"space-y-6",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\ud83d\udcca T\xe9rminos de Pago para \xd3rdenes de Compra"}),(0,bt.jsxs)("select",{value:b.paymentTerms,onChange:e=>v({projectId:b.projectId,startDate:b.startDate,endDate:b.endDate,paymentTerms:e.target.value,revenueRecognition:b.revenueRecognition,expenseTiming:b.expenseTiming,cashFlowBuffer:b.cashFlowBuffer}),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-colors",children:[(0,bt.jsx)("option",{value:"net30",children:"Net 30 d\xedas"}),(0,bt.jsx)("option",{value:"net60",children:"Net 60 d\xedas"}),(0,bt.jsx)("option",{value:"net90",children:"Net 90 d\xedas"}),(0,bt.jsx)("option",{value:"advance",children:"Anticipado (15 d\xedas antes)"}),(0,bt.jsx)("option",{value:"milestone",children:"Por hitos"})]}),(0,bt.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Define cu\xe1ndo se registran los gastos de las \xf3rdenes de compra en el flujo de caja"}),(0,bt.jsxs)("div",{className:"text-xs text-gray-400 mt-2 space-y-1",children:[(0,bt.jsxs)("div",{children:["\u2022 ",(0,bt.jsx)("strong",{children:"Por hitos:"})," Usa la fecha de aprobaci\xf3n directamente"]}),(0,bt.jsxs)("div",{children:["\u2022 ",(0,bt.jsx)("strong",{children:"Net 30/60/90:"})," Fecha de aprobaci\xf3n + d\xedas de pago"]}),(0,bt.jsxs)("div",{children:["\u2022 ",(0,bt.jsx)("strong",{children:"Anticipado:"})," Fecha de aprobaci\xf3n - 15 d\xedas"]})]})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\ud83d\udcc8 Reconocimiento de Ingresos"}),(0,bt.jsxs)("select",{value:b.revenueRecognition,onChange:e=>v({projectId:b.projectId,startDate:b.startDate,endDate:b.endDate,paymentTerms:b.paymentTerms,revenueRecognition:e.target.value,expenseTiming:b.expenseTiming,cashFlowBuffer:b.cashFlowBuffer}),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-colors",children:[(0,bt.jsx)("option",{value:"uniform",children:"Distribuci\xf3n Uniforme"}),(0,bt.jsx)("option",{value:"percentage_completion",children:"Por Progreso del Proyecto"})]}),(0,bt.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"C\xf3mo se distribuye el presupuesto del proyecto a lo largo del tiempo"})]})]}),(0,bt.jsxs)("div",{className:"flex justify-end space-x-4 pt-6 border-t mt-8",children:[(0,bt.jsx)("button",{onClick:()=>x(!1),className:"px-6 py-3 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-xl transition-colors font-medium",children:"Cancelar"}),(0,bt.jsx)("button",{onClick:()=>x(!1),className:"px-6 py-3 bg-gradient-to-r from-green-600 to-emerald-600 text-white rounded-xl hover:from-green-700 hover:to-emerald-700 transition-all duration-200 font-medium shadow-lg hover:shadow-xl",children:"\ud83d\udcbe Guardar Configuraci\xf3n"})]})]})})})]}):(0,bt.jsx)("div",{className:"min-h-screen bg-gray-50 p-6",children:(0,bt.jsx)("div",{className:"max-w-7xl mx-auto",children:(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-12 text-center",children:[(0,bt.jsx)("div",{className:"text-6xl mb-6",children:"\ud83d\udcb0"}),(0,bt.jsx)("div",{className:"text-2xl font-bold text-gray-700 mb-2",children:"Proyecto no seleccionado"}),(0,bt.jsx)("div",{className:"text-gray-500",children:"Selecciona un proyecto para ver la proyecci\xf3n de flujo de caja"})]})})})},Yj=e=>{let{orphanedTasks:t,availableMilestones:r,onReassign:s,updateMinutaTaskHito:i}=e;const[o,l]=(0,a.useState)({});return 0===t.length?null:(0,bt.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,bt.jsxs)("h3",{className:"text-yellow-800 font-semibold flex items-center",children:[(0,bt.jsx)("span",{className:"mr-2",children:"\u26a0\ufe0f"}),"Tareas de Minuta sin Hito Asignado"]}),(0,bt.jsxs)("span",{className:"text-sm bg-yellow-200 text-yellow-800 px-2 py-1 rounded-full",children:[t.length," tareas"]})]}),(0,bt.jsx)("p",{className:"text-yellow-700 text-sm mb-3",children:"Estas tareas perdieron su hito asignado. Reas\xedgnalas para mantener la organizaci\xf3n."}),(0,bt.jsx)("div",{className:"space-y-2",children:t.map(e=>{const t=Math.ceil((new Date(e.fecha)-new Date)/864e5),a=t<=3?"text-red-600 bg-red-100":t<=7?"text-orange-600 bg-orange-100":"text-yellow-600 bg-yellow-100";return(0,bt.jsx)("div",{className:"bg-white p-3 rounded border border-yellow-200",children:(0,bt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,bt.jsxs)("div",{className:"flex-1",children:[(0,bt.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,bt.jsx)("span",{className:"text-sm font-medium text-gray-800",children:e.tarea}),(0,bt.jsxs)("span",{className:"text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full flex items-center",children:[(0,bt.jsx)("span",{className:"mr-1",children:"\ud83d\udcdd"}),"Minuta"]})]}),(0,bt.jsxs)("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[(0,bt.jsxs)("span",{children:["\ud83d\udc64 ",e.responsable]}),(0,bt.jsxs)("span",{children:["\ud83d\udcc5 ",new Date(e.fecha).toLocaleDateString("es-ES")]}),(0,bt.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat("Completado"===e.estatus?"bg-green-100 text-green-800":"En Proceso"===e.estatus?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:e.estatus})]})]}),(0,bt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,bt.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(a),children:0===t?"Hoy":1===t?"Ma\xf1ana":"".concat(t," d\xedas")}),(0,bt.jsxs)("select",{value:e.hitoId||"",onChange:t=>(async(e,t)=>{if(t){l(t=>(0,n.A)((0,n.A)({},t),{},{[e]:!0}));try{await i(e,t)?(s(e,t),alert("\u2705 Tarea reasignada exitosamente")):alert("\u274c Error al reasignar tarea")}catch(r){console.error("Error en reasignaci\xf3n:",r),alert("\u274c Error al reasignar tarea")}finally{l(t=>(0,n.A)((0,n.A)({},t),{},{[e]:!1}))}}})(e.id,t.target.value),disabled:o[e.id],className:"text-xs border border-gray-300 rounded px-2 py-1 min-w-[200px]",children:[(0,bt.jsx)("option",{value:"",children:"Seleccionar hito..."}),r.map(e=>(0,bt.jsx)("option",{value:e.id,children:e.name},e.id))]}),o[e.id]&&(0,bt.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-yellow-600"})]})]})},e.id)})})]})},Jj=e=>{var t;let{projects:s,currentProjectId:i,setCurrentProjectId:o,workPackages:l,setWorkPackages:c,risks:d,setRisks:u,reportingDate:h,setReportingDate:f,tasks:m,setTasks:p,importTasks:g,includeWeekends:x,setIncludeWeekends:b,purchaseOrders:v,setPurchaseOrders:y,advances:w,setAdvances:j,invoices:N,setInvoices:k,contracts:S,setContracts:E,resourceAssignments:T,useSupabase:_=!1}=e;const{permissions:C,isReadOnly:A}=kt(),[D,P]=(0,a.useState)("summary"),[I,O]=(0,a.useState)(null),[R,M]=(0,a.useState)([]),[F,L]=(0,a.useState)([]),[z,B]=(0,a.useState)(!1),U=[{id:"summary",name:"Dashboard Resumen",icon:"\ud83d\udcca",requiresEdit:!1},{id:"risks",name:"Gesti\xf3n de Riesgos",icon:"\ud83d\udee1\ufe0f",requiresEdit:!0},{id:"schedule",name:"Cronograma",icon:"\ud83d\udcc5",requiresEdit:!0},{id:"financial",name:"Gesti\xf3n Financiera",icon:"\ud83d\udcb0",requiresEdit:!0},{id:"resources",name:"Gesti\xf3n de Recursos",icon:"\ud83d\udc65",requiresEdit:!0},{id:"changes",name:"Control de Cambios",icon:"\ud83d\udd04",requiresEdit:!0},{id:"cashflow",name:"Flujo de Caja",icon:"\ud83d\udcb8",requiresEdit:!1},{id:"files",name:"Archivos",icon:"\ud83d\udcce",requiresEdit:!1},{id:"audit",name:"Auditor\xeda Documental",icon:"\ud83d\udccb",requiresEdit:!1}].filter(e=>!e.requiresEdit||!A());(0,a.useEffect)(()=>{const e=e=>{const t=e.detail;t&&t!==D&&P(t)};return window.addEventListener("changeTab",e),()=>{window.removeEventListener("changeTab",e)}},[D]),(0,a.useEffect)(()=>{const e=U.map(e=>e.id);e.includes(D)||e.length>0&&P(e[0])},[U,D]),(0,a.useEffect)(()=>{(async()=>{if(i){B(!0);try{if(_){console.log("\ud83d\udd0d DEBUG: Cargando minutas para proyecto:",i);const{default:e}=await Promise.resolve().then(r.bind(r,874)),{success:t,minutas:a}=await e.loadMinutasByProject(i);t?(console.log("\ud83d\udd0d DEBUG: Minutas recibidas de Supabase:",a),L(a),console.log("\u2705 Minutas cargadas desde Supabase: ".concat(a.length))):(console.warn("\u26a0\ufe0f Error cargando minutas desde Supabase"),L([]))}else{var e;const t=(null===(e=JSON.parse(localStorage.getItem("portfolioData")||"{}").minutasByProject)||void 0===e?void 0:e[i])||[];L(t),console.log("\u2705 Minutas cargadas desde localStorage: ".concat(t.length))}}catch(t){console.error("\u274c Error cargando minutas:",t),L([])}finally{B(!1)}}})()},[i,_]);const W=(e,t)=>{if(!e||!t)return 0;const r=e.progress||0;return console.log("\ud83c\udfaf C\xc1LCULO PROGRESO HITO CORREGIDO:",{milestoneName:e.name,milestoneId:e.id,milestoneProgress:r,milestoneStatus:e.status,milestoneProgressField:e.progress}),r},H=(e,t)=>e&&t?e.filter(e=>!t.find(t=>t.id===e.hitoId&&t.isMilestone)):[],V=async(e,t)=>{try{if(_){const{default:a}=await Promise.resolve().then(r.bind(r,874)),{success:s}=await a.updateMinuta(e,{milestone_id:t});if(!s)throw new Error("Error actualizando en Supabase")}else{var a;const r=JSON.parse(localStorage.getItem("portfolioData")||"{}"),s=((null===(a=r.minutasByProject)||void 0===a?void 0:a[i])||[]).map(r=>r.id===e?(0,n.A)((0,n.A)({},r),{},{hitoId:t}):r);r.minutasByProject=(0,n.A)((0,n.A)({},r.minutasByProject),{},{[i]:s}),localStorage.setItem("portfolioData",JSON.stringify(r))}return L(r=>r.map(r=>r.id===e?(0,n.A)((0,n.A)({},r),{},{hitoId:t}):r)),!0}catch(s){return console.error("Error actualizando tarea de minuta:",s),!1}},G=(e,t)=>{const r=(e=>{if(!e)return[];const t=new Date,r=new Date;r.setDate(t.getDate()+15);const a=e.filter(e=>{if(e.isMilestone)return!1;if(e.progress>=100)return!1;const a=new Date(e.endDate);return a>=t&&a<=r}),s={};return e.filter(e=>e.isMilestone).sort((e,t)=>new Date(e.startDate)-new Date(t.startDate)).forEach(e=>{const t=new Date(e.startDate),r=a.filter(e=>new Date(e.endDate)<=t),n=new Set;Object.values(s).forEach(e=>{e.tasks.forEach(e=>n.add(e.id))});const i=r.filter(e=>!n.has(e.id));i.length>0&&(s[e.id]={milestone:e,tasks:i})}),console.log("\ud83c\udfaf TAREAS AGRUPADAS POR HITO (CORREGIDO):",{tasksNearDeadline:a.length,tasksByMilestone:Object.keys(s).length,details:Object.values(s).map(e=>({milestoneName:e.milestone.name,milestoneId:e.milestone.id,tasksCount:e.tasks.length,tasksNames:e.tasks.map(e=>e.name)}))}),Object.values(s)})(e),a=((e,t)=>{if(!t||0===t.length)return[];const r=new Date,a=new Date;a.setDate(r.getDate()+15);const s=t.filter(e=>{if("Completado"===e.estatus)return!1;const t=new Date(e.fecha);return t>=r&&t<=a}),n={};return s.forEach(t=>{const r=e.find(e=>e.id===t.hitoId&&e.isMilestone);if(r){n[r.id]||(n[r.id]={milestone:r,tasks:[]});const e={id:t.id,name:t.tarea,endDate:t.fecha,progress:"Completado"===t.estatus?100:"En Proceso"===t.estatus?50:0,responsable:t.responsable,estatus:t.estatus,source:"minuta"};n[r.id].tasks.push(e)}}),Object.values(n)})(e,t),s=[...r.map(e=>(0,n.A)((0,n.A)({},e),{},{source:"cronograma",tasks:e.tasks.map(e=>(0,n.A)((0,n.A)({},e),{},{source:"cronograma"}))})),...a.map(e=>(0,n.A)((0,n.A)({},e),{},{source:"minuta",tasks:e.tasks.map(e=>(0,n.A)((0,n.A)({},e),{},{source:"minuta"}))}))],i={};s.forEach(e=>{const t=e.milestone.id;i[t]||(i[t]={milestone:e.milestone,tasks:[]}),i[t].tasks.push(...e.tasks)});const o=Object.values(i).sort((e,t)=>new Date(e.milestone.startDate)-new Date(t.milestone.startDate));return console.log("\ud83c\udfaf HITOS ORDENADOS POR FECHA:",{totalGroups:o.length,order:o.map(e=>({milestoneName:e.milestone.name,milestoneDate:e.milestone.startDate,tasksCount:e.tasks.length}))}),o},q=(null===s||void 0===s?void 0:s.find(e=>e.id===i))||s[0],$=Array.isArray(l)?l:[],K=Array.isArray(m)?m:[],Y=Array.isArray(v)?v:[],J=Array.isArray(w)?w:[],X=Array.isArray(N)?N:[],Q=Array.isArray(S)?S:[],Z=Array.isArray(d)?d:[],ee=(Array.isArray(T),(null===s||void 0===s?void 0:s.filter(e=>"active"===e.status))||[]),te=(()=>{if(!q)return{};const e=Array.isArray(m)?m:[];if(0===e.length)return{percentComplete:0};const t=e.filter(e=>!e.isMilestone);if(0===t.length)return{percentComplete:0};const r=t.reduce((e,t)=>e+(t.progress||0),0),a=Math.round(r/t.length);if(Array.isArray($)&&$.length>0){const e=$.reduce((e,t)=>e+(t.budget||0),0),t=$.reduce((e,t)=>e+(t.plannedValue||0),0),r=$.reduce((e,t)=>e+(t.earnedValue||0),0),s=$.reduce((e,t)=>e+(t.actualCost||0),0);return{BAC:e,PV:t,EV:r,AC:s,CV:r-s,SV:r-t,CPI:s>0?r/s:0,SPI:t>0?r/t:0,percentComplete:a,percentSpent:e>0?s/e*100:0}}return{percentComplete:a}})(),re=(()=>{if(!m||0===m.length)return null;const e=m.filter(e=>!e.startDate||null===e.startDate||void 0===e.startDate);e.length>0&&console.log("\u26a0\ufe0f Tareas con fechas de inicio inv\xe1lidas:",e.map(e=>({id:e.id,name:e.name,startDate:e.startDate,isMilestone:e.isMilestone})));const t=m.filter(e=>e.startDate&&null!==e.startDate&&void 0!==e.startDate).map(e=>new Date(e.startDate)).filter(e=>!isNaN(e.getTime()));if(0===t.length)return console.log("\u26a0\ufe0f No se encontraron fechas de inicio v\xe1lidas"),null;const r=new Date(Math.min(...t));return isNaN(r.getTime())?(console.log("\u26a0\ufe0f Fecha m\xednima calculada es inv\xe1lida"),null):(console.log("\u2705 Fecha de inicio calculada:",r.toISOString().split("T")[0]),r.toISOString().split("T")[0])})(),ae=(()=>{if(!m||0===m.length)return null;const e=m.filter(e=>!e.endDate||null===e.endDate||void 0===e.endDate);e.length>0&&console.log("\u26a0\ufe0f Tareas con fechas de fin inv\xe1lidas:",e.map(e=>({id:e.id,name:e.name,endDate:e.endDate,isMilestone:e.isMilestone})));const t=m.filter(e=>e.endDate&&null!==e.endDate&&void 0!==e.endDate).map(e=>new Date(e.endDate)).filter(e=>!isNaN(e.getTime()));if(0===t.length)return console.log("\u26a0\ufe0f No se encontraron fechas de fin v\xe1lidas"),null;const r=new Date(Math.max(...t));return isNaN(r.getTime())?(console.log("\u26a0\ufe0f Fecha m\xe1xima calculada es inv\xe1lida"),null):(console.log("\u2705 Fecha de fin calculada:",r.toISOString().split("T")[0]),r.toISOString().split("T")[0])})();return q?(0,bt.jsxs)("div",{className:"space-y-6",children:[(0,bt.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-purple-100 rounded-2xl shadow-lg p-6 text-gray-800 relative overflow-hidden",children:[(0,bt.jsx)("div",{className:"absolute top-0 right-0 w-32 h-32 bg-blue-100/30 rounded-full -translate-y-16 translate-x-16"}),(0,bt.jsx)("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-purple-100/30 rounded-full translate-y-12 -translate-x-12"}),(0,bt.jsx)("div",{className:"relative z-10",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{className:"flex items-center",children:[(0,bt.jsx)("div",{className:"bg-white/60 backdrop-blur rounded-2xl p-3 mr-4 shadow-sm",children:(0,bt.jsx)("span",{className:"text-3xl",children:"\ud83d\udcca"})}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h1",{className:"text-4xl font-bold mb-2 text-gray-800",children:q.name}),(0,bt.jsx)("p",{className:"text-gray-600 text-lg",children:q.description||"Gesti\xf3n integral del proyecto - PMBOK v7"}),(0,bt.jsxs)("div",{className:"flex items-center space-x-4 mt-2 text-sm text-gray-700",children:[(0,bt.jsxs)("span",{className:"flex items-center space-x-1",children:[(0,bt.jsx)("span",{className:"text-gray-500",children:"\ud83d\udc64"}),(0,bt.jsx)("span",{children:q.manager})]}),(0,bt.jsxs)("span",{className:"flex items-center space-x-1",children:[(0,bt.jsx)("span",{className:"text-yellow-600",children:"\ud83d\udcb0"}),(0,bt.jsxs)("span",{children:["$",(q.budget/1e3).toFixed(0),"K"]})]}),(0,bt.jsxs)("span",{className:"flex items-center space-x-1",children:[(0,bt.jsx)("span",{className:"text-green-500",children:"\ud83d\udcbc"}),(0,bt.jsxs)("span",{className:"px-2 py-1 rounded bg-gray-100 text-gray-800 ml-2",children:[(null===(t=te.percentComplete)||void 0===t?void 0:t.toFixed(1))||0,"% completado"]})]})]}),(0,bt.jsx)("div",{className:"mt-3",children:(0,bt.jsx)("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 rounded-lg p-4 border border-green-200",children:(0,bt.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,bt.jsx)("span",{className:"text-green-600 text-lg",children:"\ud83d\udcbc"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h4",{className:"font-semibold text-green-800 mb-2",children:"Caso de Negocio"}),(0,bt.jsx)("p",{className:"text-gray-700 text-sm leading-relaxed",children:q.businessCase||"Sin caso de negocio definido"})]})]})})})]})]}),(0,bt.jsxs)("div",{className:"text-right",children:[(0,bt.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Fecha de Reporte"}),(0,bt.jsx)("input",{type:"date",value:h,onChange:e=>f(e.target.value),className:"px-3 py-1 rounded bg-white text-gray-800 text-sm border border-gray-300 shadow-sm"})]})]})})]}),(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-4",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Proyecto Activo"}),(0,bt.jsx)("div",{className:"px-4 py-2 rounded-lg text-sm font-medium ".concat(_?"bg-green-100 text-green-800 border border-green-300":"bg-red-100 text-red-800 border border-red-300"),children:_?"\ud83d\udfe2 Estado: Online":"\ud83d\udd34 Estado: Offline"})]}),(0,bt.jsxs)("select",{value:i,onChange:e=>o(e.target.value),className:"w-full p-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,bt.jsx)("option",{value:"",disabled:!0,children:"Seleccionar proyecto activo"}),ee.map(e=>(0,bt.jsxs)("option",{value:e.id,children:[e.name," - ",e.manager]},e.id))]}),i&&(0,bt.jsx)("div",{className:"mt-3 p-3 bg-green-50 border border-green-200 rounded-lg",children:(0,bt.jsxs)("div",{className:"flex items-center text-green-800 text-sm",children:[(0,bt.jsx)("span",{className:"mr-2",children:"\u2705"}),(0,bt.jsxs)("span",{children:[(0,bt.jsx)("strong",{children:"Filtrado por proyecto implementado:"})," Todas las pesta\xf1as muestran \xfanicamente la informaci\xf3n de",(0,bt.jsxs)("strong",{children:[" ",null===q||void 0===q?void 0:q.name]}),". Los datos de otros proyectos NO se incluyen en las m\xe9tricas ni en los m\xf3dulos."]})]})})]}),(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm",children:[(0,bt.jsx)("div",{className:"border-b border-gray-200",children:(0,bt.jsx)("nav",{className:"flex flex-wrap gap-1 px-4 overflow-x-auto scrollbar-hide tab-container",children:U.map(e=>(0,bt.jsxs)("button",{onClick:()=>P(e.id),className:"\n                  py-3 px-2 border-b-2 font-medium text-xs sm:text-sm transition-colors whitespace-nowrap min-w-fit\n                  ".concat(D===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","\n                "),children:[(0,bt.jsx)("span",{className:"mr-1 sm:mr-2",children:e.icon}),(0,bt.jsx)("span",{className:"hidden sm:inline",children:e.name}),(0,bt.jsx)("span",{className:"sm:hidden",children:e.name.split(" ")[0]})]},e.id))})}),(0,bt.jsxs)("div",{children:["summary"===D&&(0,bt.jsxs)("div",{className:"space-y-8",children:[(0,bt.jsxs)("div",{className:"bg-gradient-to-r from-indigo-600 via-purple-600 to-blue-600 rounded-xl shadow-lg p-6 text-white",children:[(0,bt.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"\ud83d\udcca Dashboard Resumen"}),(0,bt.jsxs)("p",{className:"text-indigo-100 text-lg",children:[(null===q||void 0===q?void 0:q.name)||"Proyecto no seleccionado"," - Vista ejecutiva del estado del proyecto"]})]}),(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-blue-500",children:[(0,bt.jsxs)("h2",{className:"text-2xl font-bold text-gray-800 mb-6 flex items-center",children:[(0,bt.jsx)("span",{className:"text-3xl mr-3",children:"\ud83d\udcc8"}),"Informaci\xf3n del Proyecto"]}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,bt.jsxs)("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 p-6 rounded-lg border border-blue-200",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,bt.jsx)("span",{className:"text-2xl",children:"\ud83d\udcb0"}),(0,bt.jsx)("span",{className:"text-sm font-medium text-blue-600",children:"Presupuesto"})]}),(0,bt.jsxs)("div",{className:"text-3xl font-bold text-blue-800",children:["$",(((null===q||void 0===q?void 0:q.budget)||0)/1e3).toFixed(0),"K"]}),(0,bt.jsx)("div",{className:"text-sm text-blue-600 mt-1",children:"Presupuesto asignado"})]}),(0,bt.jsxs)("div",{className:"bg-gradient-to-br from-green-50 to-green-100 p-6 rounded-lg border border-green-200",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,bt.jsx)("span",{className:"text-2xl",children:"\ud83d\udcc5"}),(0,bt.jsx)("span",{className:"text-sm font-medium text-green-600",children:"Inicio"})]}),(0,bt.jsx)("div",{className:"text-xl font-bold text-green-800",children:re?new Date(re).toLocaleDateString("es-ES"):"N/A"}),(0,bt.jsx)("div",{className:"text-sm text-green-600 mt-1",children:"Fecha de inicio del cronograma"})]}),(0,bt.jsxs)("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 p-6 rounded-lg border border-purple-200",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,bt.jsx)("span",{className:"text-2xl",children:"\ud83c\udfc1"}),(0,bt.jsx)("span",{className:"text-sm font-medium text-purple-600",children:"Fin"})]}),(0,bt.jsx)("div",{className:"text-xl font-bold text-purple-800",children:ae?new Date(ae).toLocaleDateString("es-ES"):"N/A"}),(0,bt.jsx)("div",{className:"text-sm text-purple-600 mt-1",children:"Fecha de fin del cronograma"})]})]})]}),(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-green-500",children:[(0,bt.jsxs)("h2",{className:"text-2xl font-bold text-gray-800 mb-6 flex items-center",children:[(0,bt.jsx)("span",{className:"text-3xl mr-3",children:"\ud83d\udcb3"}),"Gesti\xf3n Financiera"]}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,bt.jsxs)("div",{className:"bg-gradient-to-br from-emerald-50 to-emerald-100 p-6 rounded-lg border border-emerald-200",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,bt.jsx)("span",{className:"text-2xl",children:"\ud83d\udccb"}),(0,bt.jsx)("span",{className:"text-sm font-medium text-emerald-600",children:"\xd3rdenes de Compra"})]}),(0,bt.jsxs)("div",{className:"text-3xl font-bold text-emerald-800",children:["$",(((null===Y||void 0===Y?void 0:Y.reduce((e,t)=>e+(t.totalAmount||0),0))||0)/1e3).toFixed(0),"K"]}),(0,bt.jsx)("div",{className:"text-sm text-emerald-600 mt-1",children:"Monto en OC aprobadas"})]}),(0,bt.jsxs)("div",{className:"bg-gradient-to-br from-amber-50 to-amber-100 p-6 rounded-lg border border-amber-200",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,bt.jsx)("span",{className:"text-2xl",children:"\ud83d\udcb8"}),(0,bt.jsx)("span",{className:"text-sm font-medium text-amber-600",children:"Anticipos"})]}),(0,bt.jsxs)("div",{className:"text-3xl font-bold text-amber-800",children:["$",(((null===J||void 0===J?void 0:J.reduce((e,t)=>e+(t.amount||0),0))||0)/1e3).toFixed(0),"K"]}),(0,bt.jsx)("div",{className:"text-sm text-amber-600 mt-1",children:"Anticipos solicitados"})]}),(0,bt.jsxs)("div",{className:"bg-gradient-to-br from-cyan-50 to-cyan-100 p-6 rounded-lg border border-cyan-200",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,bt.jsx)("span",{className:"text-2xl",children:"\ud83e\uddfe"}),(0,bt.jsx)("span",{className:"text-sm font-medium text-cyan-600",children:"Facturas"})]}),(0,bt.jsxs)("div",{className:"text-3xl font-bold text-cyan-800",children:["$",(((null===X||void 0===X?void 0:X.reduce((e,t)=>e+(t.amount||0),0))||0)/1e3).toFixed(0),"K"]}),(0,bt.jsx)("div",{className:"text-sm text-cyan-600 mt-1",children:"Facturas ingresadas"})]})]})]}),(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-red-500",children:[(0,bt.jsxs)("h2",{className:"text-2xl font-bold text-gray-800 mb-6 flex items-center",children:[(0,bt.jsx)("span",{className:"text-3xl mr-3",children:"\ud83d\udee1\ufe0f"}),"Reservas y Riesgos"]}),(0,bt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,bt.jsxs)("div",{className:"space-y-4",children:[(0,bt.jsxs)("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 p-6 rounded-lg border border-orange-200",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,bt.jsx)("span",{className:"text-2xl",children:"\u26a0\ufe0f"}),(0,bt.jsx)("span",{className:"text-sm font-medium text-orange-600",children:"Reserva de Contingencia"})]}),(0,bt.jsxs)("div",{className:"text-3xl font-bold text-orange-800",children:["$",(.05*((null===q||void 0===q?void 0:q.budget)||0)/1e3).toFixed(0),"K"]}),(0,bt.jsx)("div",{className:"text-sm text-orange-600 mt-1",children:"5% del presupuesto total"})]}),(0,bt.jsxs)("div",{className:"bg-gradient-to-br from-pink-50 to-pink-100 p-6 rounded-lg border border-pink-200",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,bt.jsx)("span",{className:"text-2xl",children:"\ud83c\udfaf"}),(0,bt.jsx)("span",{className:"text-sm font-medium text-pink-600",children:"Reserva de Gesti\xf3n"})]}),(0,bt.jsxs)("div",{className:"text-3xl font-bold text-pink-800",children:["$",(.1*((null===q||void 0===q?void 0:q.budget)||0)/1e3).toFixed(0),"K"]}),(0,bt.jsx)("div",{className:"text-sm text-pink-600 mt-1",children:"10% del presupuesto total"})]})]}),(0,bt.jsxs)("div",{className:"bg-gradient-to-br from-red-50 to-red-100 p-6 rounded-lg border border-red-200",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,bt.jsx)("span",{className:"text-2xl",children:"\ud83d\udea8"}),(0,bt.jsx)("span",{className:"text-sm font-medium text-red-600",children:"Principales Riesgos"})]}),(0,bt.jsxs)("div",{className:"space-y-3",children:[null===Z||void 0===Z?void 0:Z.slice(0,3).map((e,t)=>{const r=(e.probability||0)*(e.costImpact||0);return(0,bt.jsxs)("div",{className:"p-3 bg-white rounded-lg border",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,bt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,bt.jsx)("span",{className:"w-3 h-3 rounded-full ".concat("high"===e.priority?"bg-red-500":"medium"===e.priority?"bg-yellow-500":"bg-green-500")}),(0,bt.jsx)("span",{className:"text-sm font-medium text-gray-800 truncate",children:e.name})]}),(0,bt.jsx)("span",{className:"text-xs px-2 py-1 rounded-full ".concat("high"===e.priority?"bg-red-100 text-red-800":"medium"===e.priority?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"),children:e.priority})]}),(0,bt.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-600",children:[(0,bt.jsx)("span",{children:"Costo probable:"}),(0,bt.jsxs)("span",{className:"font-semibold text-red-600",children:["$",(r/1e3).toFixed(1),"K"]})]}),(0,bt.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500 mt-1",children:[(0,bt.jsxs)("span",{children:["Prob: ",(100*(e.probability||0)).toFixed(0),"%"]}),(0,bt.jsxs)("span",{children:["Impacto: $",((e.costImpact||0)/1e3).toFixed(0),"K"]})]})]},e.id)}),(!Z||0===Z.length)&&(0,bt.jsx)("div",{className:"text-center text-gray-500 py-4",children:"No hay riesgos registrados"})]})]})]})]}),(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-purple-500",children:[(0,bt.jsxs)("h2",{className:"text-2xl font-bold text-gray-800 mb-6 flex items-center justify-between",children:[(0,bt.jsxs)("div",{className:"flex items-center",children:[(0,bt.jsx)("span",{className:"text-3xl mr-3",children:"\ud83c\udfaf"}),"Hitos del Proyecto"]}),(0,bt.jsxs)("span",{className:"text-sm bg-purple-100 text-purple-800 px-3 py-1 rounded-full",children:[(null===K||void 0===K?void 0:K.filter(e=>e.isMilestone).length)||0," hitos"]})]}),(0,bt.jsxs)("div",{className:"space-y-4 max-h-96 overflow-y-auto scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100",children:[null===K||void 0===K?void 0:K.filter(e=>e.isMilestone).sort((e,t)=>{const r=e.wbsCode||e.name,a=t.wbsCode||t.name;return r.localeCompare(a,"es",{numeric:!0})}).map((e,t)=>(0,bt.jsx)("div",{className:"bg-gradient-to-r from-gray-50 to-gray-100 p-4 rounded-lg border border-gray-200",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,bt.jsx)("div",{className:"w-4 h-4 rounded-full ".concat("completed"===e.status?"bg-green-500":"in-progress"===e.status?"bg-yellow-500":"delayed"===e.status?"bg-red-500":"bg-gray-400")}),(0,bt.jsxs)("div",{children:[(0,bt.jsxs)("h3",{className:"font-semibold text-gray-800",children:[e.name,(0,bt.jsxs)("span",{className:"ml-2 text-sm font-medium text-blue-600",children:["[",W(e,K),"%]"]})]}),(0,bt.jsx)("p",{className:"text-sm text-gray-600",children:e.endDate?new Date(e.endDate).toLocaleDateString("es-ES"):"Sin fecha"})]})]}),(0,bt.jsx)("div",{className:"flex items-center space-x-2",children:C.canEdit?(0,bt.jsxs)("select",{value:e.status||"in-progress",onChange:t=>{const r=t.target.value;console.log("\ud83c\udfaf CAMBIO DE ESTADO DE HITO:",{milestoneId:e.id,milestoneName:e.name,oldStatus:e.status,newStatus:r,currentProjectId:i});const a=K.map(t=>t.id===e.id?(0,n.A)((0,n.A)({},t),{},{status:r}):t);console.log("\ud83c\udfaf TAREAS ACTUALIZADAS:",{totalTasks:a.length,milestoneTasks:a.filter(e=>e.isMilestone).length,updatedMilestone:a.find(t=>t.id===e.id)}),p(a)},className:"px-3 py-1 rounded-full text-xs font-medium border-0 focus:ring-2 focus:ring-blue-500 ".concat("completed"===e.status?"bg-green-100 text-green-800":"in-progress"===e.status?"bg-yellow-100 text-yellow-800":"delayed"===e.status?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"),children:[(0,bt.jsx)("option",{value:"in-progress",className:"bg-yellow-100 text-yellow-800",children:"En Proceso"}),(0,bt.jsx)("option",{value:"completed",className:"bg-green-100 text-green-800",children:"Realizado"}),(0,bt.jsx)("option",{value:"delayed",className:"bg-red-100 text-red-800",children:"Atrasado"})]}):(0,bt.jsxs)("div",{className:"px-3 py-1 rounded-full text-xs font-medium ".concat("completed"===e.status?"bg-green-100 text-green-800":"in-progress"===e.status?"bg-yellow-100 text-yellow-800":"delayed"===e.status?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"),children:["completed"===e.status?"Realizado":"in-progress"===e.status?"En Proceso":"delayed"===e.status?"Atrasado":"Pendiente",(0,bt.jsx)("span",{className:"ml-1 text-gray-500",children:"\ud83d\udc40"})]})})]})},e.id)),(!K||0===K.filter(e=>e.isMilestone).length)&&(0,bt.jsxs)("div",{className:"text-center text-gray-500 py-8",children:[(0,bt.jsx)("span",{className:"text-4xl mb-4 block",children:"\ud83c\udfaf"}),(0,bt.jsx)("p",{children:"No hay hitos definidos para este proyecto"})]})]})]}),(0,bt.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-orange-500",children:[(0,bt.jsxs)("h2",{className:"text-2xl font-bold text-gray-800 mb-6 flex items-center justify-between",children:[(0,bt.jsxs)("div",{className:"flex items-center",children:[(0,bt.jsx)("span",{className:"text-3xl mr-3",children:"\u26a0\ufe0f"}),"Alerta Tareas por Vencer",(0,bt.jsx)("span",{className:"text-sm text-gray-500 ml-2",children:"(Cronograma + Minutas)"})]}),(0,bt.jsx)("span",{className:"text-sm bg-orange-100 text-orange-800 px-3 py-1 rounded-full",children:(()=>{const e=H(F,K),t=G(K,F).reduce((e,t)=>e+t.tasks.length,0)+e.length;return"".concat(t," tareas")})()})]}),(()=>{const e=H(F,K),t=G(K,F);return t.length>0||e.length>0?(0,bt.jsxs)("div",{className:"space-y-6",children:[e.length>0&&(0,bt.jsx)(Yj,{orphanedTasks:e,availableMilestones:K.filter(e=>e.isMilestone),onReassign:(e,t)=>{L(r=>r.map(r=>r.id===e?(0,n.A)((0,n.A)({},r),{},{hitoId:t}):r))},updateMinutaTaskHito:V}),t.map((e,t)=>(0,bt.jsxs)("div",{className:"bg-gradient-to-r from-orange-50 to-red-50 p-4 rounded-lg border border-orange-200",children:[(0,bt.jsxs)("div",{className:"flex items-center mb-3",children:[(0,bt.jsx)("div",{className:"w-3 h-3 rounded-full bg-orange-500 mr-3"}),(0,bt.jsx)("h3",{className:"font-semibold text-gray-800 text-lg",children:e.milestone.name}),(0,bt.jsxs)("span",{className:"ml-2 text-sm text-orange-600",children:["(",e.tasks.length," tareas)"]})]}),(0,bt.jsx)("div",{className:"space-y-2",children:e.tasks.map((e,t)=>{const r=Math.ceil((new Date(e.endDate)-new Date)/864e5),a=r<=3?"text-red-600 bg-red-100":r<=7?"text-orange-600 bg-orange-100":"text-yellow-600 bg-yellow-100";return(0,bt.jsx)("div",{className:"bg-white p-3 rounded-lg border border-gray-200 shadow-sm",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{className:"flex-1",children:[(0,bt.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,bt.jsx)("h4",{className:"font-medium text-gray-800",children:e.name}),"cronograma"===e.source?(0,bt.jsxs)("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full flex items-center",children:[(0,bt.jsx)("span",{className:"mr-1",children:"\ud83d\udccb"}),"Cronograma"]}):(0,bt.jsxs)("span",{className:"text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full flex items-center",children:[(0,bt.jsx)("span",{className:"mr-1",children:"\ud83d\udcdd"}),"Minuta"]})]}),(0,bt.jsxs)("div",{className:"flex items-center space-x-4 mt-1 text-sm text-gray-600",children:[(0,bt.jsxs)("span",{children:["\ud83d\udcc5 ",new Date(e.endDate).toLocaleDateString("es-ES")]}),(0,bt.jsxs)("span",{children:["\ud83d\udc64 ",e.assignedTo||e.responsable||"Sin asignar"]}),(0,bt.jsxs)("span",{children:["\ud83d\udcca ",e.progress||0,"% completado"]}),e.estatus&&(0,bt.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat("Completado"===e.estatus?"bg-green-100 text-green-800":"En Proceso"===e.estatus?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:e.estatus})]})]}),(0,bt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,bt.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(a),children:0===r?"Hoy":1===r?"Ma\xf1ana":"".concat(r," d\xedas")}),(0,bt.jsx)("div",{className:"w-16 bg-gray-200 rounded-full h-2",children:(0,bt.jsx)("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:"".concat(e.progress||0,"%")}})})]})]})},e.id)})})]},e.milestone.id))]}):(0,bt.jsxs)("div",{className:"text-center text-gray-500 py-8",children:[(0,bt.jsx)("span",{className:"text-4xl mb-4 block",children:"\u2705"}),(0,bt.jsx)("p",{children:"\xa1Excelente! No hay tareas pr\xf3ximas a vencer"}),(0,bt.jsx)("p",{className:"text-sm mt-2",children:"Todas las tareas del cronograma y minutas est\xe1n al d\xeda o completadas"})]})})()]})]}),"risks"===D&&(0,bt.jsx)(oj,{projects:s,currentProjectId:i,setCurrentProjectId:o,risks:Z,setRisks:u,useSupabase:_}),"schedule"===D&&(0,bt.jsx)(Hj,{tasks:K,setTasks:p,importTasks:g,projectData:q,onScheduleDataChange:O,includeWeekends:x,setIncludeWeekends:b}),"financial"===D&&(0,bt.jsx)(Vj,{workPackages:$,setWorkPackages:c,currentProject:q,risks:Z,scheduleData:I,includeWeekends:x,purchaseOrders:v,setPurchaseOrders:y,advances:w,setAdvances:j,invoices:N,setInvoices:k,contracts:S,setContracts:E,useSupabase:_}),"resources"===D&&(0,bt.jsx)(Gj,{projects:s,workPackages:$,currentProject:q,includeWeekends:x}),"changes"===D&&(0,bt.jsx)($j,{currentProjectId:i,projects:s,workPackages:$,tasks:K,purchaseOrders:Y,advances:J,invoices:X,contracts:Q,onUpdateProject:()=>{console.log("Proyecto actualizado por cambio aprobado")}}),"cashflow"===D&&(0,bt.jsx)(Kj,{currentProjectId:null===q||void 0===q?void 0:q.id,currentProject:q,projects:s,workPackages:$,tasks:m,purchaseOrders:Y,advances:J,invoices:X,contracts:Q}),"files"===D&&(0,bt.jsx)(Dw,{projectId:i,category:"general",onFileUploaded:()=>{}}),"audit"===D&&(0,bt.jsx)(qj,{projects:s,currentProjectId:i,workPackages:l,risks:d,tasks:m,purchaseOrders:v,advances:w,invoices:N,contracts:S,resourceAssignments:T,useSupabase:_})]})]})]}):(0,bt.jsxs)("div",{className:"text-center py-12",children:[(0,bt.jsx)("div",{className:"text-4xl mb-4",children:"\ud83d\udcca"}),(0,bt.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Selecciona un Proyecto"}),(0,bt.jsx)("p",{className:"text-gray-600",children:"Elige un proyecto activo para ver su gesti\xf3n detallada"})]})},Xj=e=>{let{useSupabase:t,supabaseInitialized:r,isAuthenticated:s}=e;const[n,i]=(0,a.useState)(!1),[o,l]=(0,a.useState)(!1),[c,d]=(0,a.useState)(null),[u,h]=(0,a.useState)(null),[f,m]=(0,a.useState)(!1);(0,a.useEffect)(()=>{const e=e=>{i(!0),d(new Date),setTimeout(()=>{i(!1)},2e3)},t=e=>{l(!0),h(new Date),setTimeout(()=>{l(!1)},1500)},r=()=>{m(!0),setTimeout(()=>m(!1),3e3)};return window.addEventListener("dataSync",e),window.addEventListener("dataSave",t),window.addEventListener("dataChange",r),()=>{window.removeEventListener("dataSync",e),window.removeEventListener("dataSave",t),window.removeEventListener("dataChange",r)}},[]);const p=void 0!==t;return f||n||o||p?(0,bt.jsxs)("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:[o&&(0,bt.jsxs)("div",{className:"flex items-center space-x-2 px-4 py-2 rounded-lg shadow-lg bg-orange-500 text-white transition-all duration-300",children:[(0,bt.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),(0,bt.jsx)("span",{className:"text-sm font-medium",children:"Guardando..."})]}),n&&(0,bt.jsxs)("div",{className:"flex items-center space-x-2 px-4 py-2 rounded-lg shadow-lg bg-blue-500 text-white transition-all duration-300",children:[(0,bt.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),(0,bt.jsx)("span",{className:"text-sm font-medium",children:"Sincronizando..."})]}),p&&!n&&!o&&(0,bt.jsxs)("div",{className:"flex items-center space-x-2 px-4 py-2 rounded-lg shadow-lg text-white transition-all duration-300 ".concat(t&&s?"bg-green-500":t&&!s?"bg-yellow-500":"bg-gray-500"),children:[(0,bt.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(t&&s?"bg-white":t&&!s?"bg-orange-300":"bg-white")}),(0,bt.jsx)("span",{className:"text-sm font-medium",children:t&&s?"\u2601\ufe0f Nube":t&&!s?"\u26a0\ufe0f Sin autenticar":"\ud83d\udcbe Local"})]}),!n&&!o&&f&&(0,bt.jsxs)("div",{className:"flex items-center space-x-2 px-4 py-2 rounded-lg shadow-lg bg-green-500 text-white transition-all duration-300",children:[(0,bt.jsx)("div",{className:"w-2 h-2 bg-white rounded-full"}),(0,bt.jsxs)("span",{className:"text-sm font-medium",children:["Guardado ",u&&"(".concat(u.toLocaleTimeString(),")")]})]})]}):null},Qj=e=>{let{projects:t,workPackagesByProject:r,risksByProject:s,tasksByProject:n,purchaseOrdersByProject:i,advancesByProject:o,invoicesByProject:l,contractsByProject:c,globalResources:d,resourceAssignmentsByProject:u,viewMode:h,currentProjectId:f}=e;const[m,p]=(0,a.useState)([]),[g,x]=(0,a.useState)(!1);(0,a.useEffect)(()=>{b()},[]);const b=()=>{const e=localStorage.getItem("mi-dashboard-backups");if(e)try{p(JSON.parse(e))}catch(t){console.error("Error cargando backups:",t)}},v=e=>{localStorage.setItem("mi-dashboard-backups",JSON.stringify(e)),p(e)},y=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const a=(new Date).toISOString(),p={id:"backup-".concat(Date.now()),name:e?"Backup Autom\xe1tico - ".concat((new Date).toLocaleString()):"Backup Manual - ".concat((new Date).toLocaleString()),timestamp:a,data:{projects:t,currentProjectId:f,workPackagesByProject:r,risksByProject:s,tasksByProject:n,purchaseOrdersByProject:i,advancesByProject:o,invoicesByProject:l,contractsByProject:c,globalResources:d,resourceAssignmentsByProject:u,viewMode:h},size:JSON.stringify({projects:t,workPackagesByProject:r,risksByProject:s,tasksByProject:n,purchaseOrdersByProject:i,advancesByProject:o,invoicesByProject:l,contractsByProject:c,globalResources:d,resourceAssignmentsByProject:u}).length,isAutomatic:e},g="mi-dashboard-backup-".concat((new Date).toISOString().split("T")[0],"-").concat(Date.now(),".json"),x=JSON.stringify(p.data,null,2),b=new Blob([x],{type:"application/json"}),y=URL.createObjectURL(b),w=document.createElement("a");w.href=y,w.download=g,document.body.appendChild(w),w.click(),document.body.removeChild(w),URL.revokeObjectURL(y);const j=[p,...m].slice(0,10);v(j);const N=new CustomEvent("backupCreated",{detail:{backupId:p.id,isAutomatic:e,timestamp:a,fileName:g}});return window.dispatchEvent(N),p},w=e=>{if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]};return g?(0,bt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[80vh] overflow-hidden",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between p-6 border-b",children:[(0,bt.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"\ud83d\udcbe Gesti\xf3n de Backups"}),(0,bt.jsxs)("div",{className:"flex space-x-2",children:[(0,bt.jsx)("button",{onClick:()=>y(!1),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"\ud83d\udce5 Crear Backup Manual"}),(0,bt.jsx)("button",{onClick:()=>{const e=document.createElement("input");e.type="file",e.accept=".json",e.onchange=e=>{const t=e.target.files[0];if(t){const e=new FileReader;e.onload=e=>{try{const r=JSON.parse(e.target.result);if(window.confirm("\xbfEst\xe1 seguro de importar este backup? Esto reemplazar\xe1 todos los datos actuales.")){const e=new CustomEvent("dataImport",{detail:{fileName:t.name,timestamp:(new Date).toISOString(),data:r}});window.dispatchEvent(e),alert('\u2705 Backup "'.concat(t.name,'" importado exitosamente. Recarga la p\xe1gina para ver los cambios.'))}}catch(r){alert("\u274c Error al importar el backup. Verifique que el archivo sea v\xe1lido."),console.error("Error importing backup:",r)}},e.readAsText(t)}},e.click()},className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors",children:"\ud83d\udce4 Importar Backup"}),(0,bt.jsx)("button",{onClick:()=>x(!1),className:"bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"\u2715 Cerrar"})]})]}),(0,bt.jsx)("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:0===m.length?(0,bt.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,bt.jsx)("div",{className:"text-4xl mb-4",children:"\ud83d\udcbe"}),(0,bt.jsx)("div",{children:"No hay backups disponibles"}),(0,bt.jsx)("div",{className:"text-sm mt-2",children:"Los backups autom\xe1ticos se crean cada 30 minutos"})]}):(0,bt.jsx)("div",{className:"space-y-4",children:m.map(e=>{return(0,bt.jsx)("div",{className:"border rounded-lg p-4 hover:bg-gray-50 transition-colors",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{className:"flex-1",children:[(0,bt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,bt.jsx)("h3",{className:"font-semibold text-gray-800",children:e.name}),e.isAutomatic&&(0,bt.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:"Autom\xe1tico"})]}),(0,bt.jsxs)("div",{className:"text-sm text-gray-600 mt-1",children:[(0,bt.jsxs)("div",{children:["\ud83d\udcc5 ",(t=e.timestamp,new Date(t).toLocaleString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}))]}),(0,bt.jsxs)("div",{children:["\ud83d\udcca ",w(e.size)]}),(0,bt.jsxs)("div",{children:["\ud83c\udd94 ",e.id]})]})]}),(0,bt.jsxs)("div",{className:"flex space-x-2",children:[(0,bt.jsx)("button",{onClick:()=>(e=>{const t=m.find(t=>t.id===e);if(t&&window.confirm('\xbfEst\xe1 seguro de restaurar el backup "'.concat(t.name,'"? Esto reemplazar\xe1 todos los datos actuales.'))){const{data:r}=t,a=new CustomEvent("dataRestore",{detail:{backupId:e,backupName:t.name,timestamp:(new Date).toISOString(),data:r}});window.dispatchEvent(a),alert('\u2705 Backup "'.concat(t.name,'" restaurado exitosamente. Recarga la p\xe1gina para ver los cambios.'))}})(e.id),className:"bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700 transition-colors",title:"Restaurar este backup",children:"\ud83d\udd04 Restaurar"}),(0,bt.jsx)("button",{onClick:()=>(e=>{if(window.confirm("\xbfEst\xe1 seguro de eliminar este backup?")){const t=m.filter(t=>t.id!==e);v(t)}})(e.id),className:"bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 transition-colors",title:"Eliminar este backup",children:"\ud83d\uddd1\ufe0f Eliminar"})]})]})},e.id);var t})})}),(0,bt.jsx)("div",{className:"p-6 border-t bg-gray-50",children:(0,bt.jsx)("div",{className:"text-sm text-gray-600",children:(0,bt.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,bt.jsxs)("span",{children:["\ud83d\udcca Total de backups: ",m.length]}),(0,bt.jsx)("span",{children:"\ud83d\udd04 Backups autom\xe1ticos cada 30 minutos"}),(0,bt.jsx)("span",{children:"\ud83d\udcbe M\xe1ximo 10 backups guardados"})]})})})]})}):(0,bt.jsxs)("button",{onClick:()=>x(!0),className:"fixed bottom-4 left-4 bg-purple-600 text-white px-4 py-2 rounded-lg shadow-lg hover:bg-purple-700 transition-colors z-40",title:"Gestionar Backups",children:["\ud83d\udcbe Backups (",m.length,")"]})},Zj=Vw("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),eN=Vw("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),tN=Vw("cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]),rN=()=>{const[e,t]=(0,a.useState)({isInitialized:!1,isSyncing:!1,lastSave:null,lastBackup:null,error:null});(0,a.useEffect)(()=>{const e=e=>{t(t=>(0,n.A)((0,n.A)({},t),{},{lastSave:e.detail.timestamp,error:null}))},r=e=>{t(t=>(0,n.A)((0,n.A)({},t),{},{lastBackup:e.detail.timestamp,error:null}))},a=e=>{t(t=>(0,n.A)((0,n.A)({},t),{},{lastSave:e.detail.timestamp,error:null}))},s=e=>{t(t=>(0,n.A)((0,n.A)({},t),{},{error:e.detail.message}))};return window.addEventListener("fileDataSaved",e),window.addEventListener("autoBackupCreated",r),window.addEventListener("fileDataImported",a),window.addEventListener("filePersistenceError",s),setTimeout(()=>{t(e=>(0,n.A)((0,n.A)({},e),{},{isInitialized:!0,isSyncing:!0}))},1e3),()=>{window.removeEventListener("fileDataSaved",e),window.removeEventListener("autoBackupCreated",r),window.removeEventListener("fileDataImported",a),window.removeEventListener("filePersistenceError",s)}},[]);const r=e=>e?new Date(e).toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit",second:"2-digit"}):"Nunca";return(0,bt.jsxs)("div",{className:"fixed bottom-4 right-4 bg-white rounded-lg shadow-lg border p-3 z-40",children:[(0,bt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,bt.jsxs)("div",{className:"flex items-center space-x-1 ".concat(e.error?"text-red-600":e.isInitialized&&e.isSyncing?"text-green-600":e.isInitialized?"text-yellow-600":"text-gray-600"),children:[e.error?(0,bt.jsx)(Kw,{className:"w-4 h-4"}):e.isInitialized&&e.isSyncing?(0,bt.jsx)(Zj,{className:"w-4 h-4"}):e.isInitialized?(0,bt.jsx)(eN,{className:"w-4 h-4"}):(0,bt.jsx)(tN,{className:"w-4 h-4"}),(0,bt.jsx)("span",{className:"text-sm font-medium",children:e.error?"Error en archivos":e.isInitialized&&e.isSyncing?"Sincronizando":e.isInitialized?"Inicializado":"Conectando..."})]}),e.isInitialized&&(0,bt.jsxs)("div",{className:"text-xs text-gray-500 ml-2",children:[(0,bt.jsxs)("div",{children:["\ud83d\udcbe ",r(e.lastSave)]}),e.lastBackup&&(0,bt.jsxs)("div",{children:["\ud83d\udce6 ",r(e.lastBackup)]})]})]}),e.error&&(0,bt.jsx)("div",{className:"mt-2 text-xs text-red-600 bg-red-50 p-2 rounded",children:e.error})]})},aN=e=>{let{onAuthSuccess:t,onAuthCancel:r}=e;const[s,n]=(0,a.useState)(!0),[i,o]=(0,a.useState)(""),[l,c]=(0,a.useState)(""),[d,u]=(0,a.useState)(""),[h,f]=(0,a.useState)(!1),[m,p]=(0,a.useState)(""),[g,x]=(0,a.useState)("");(0,a.useEffect)(()=>{p(""),x("")},[s]);const b=()=>{r&&r()};return(0,bt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 p-6",children:[(0,bt.jsxs)("div",{className:"text-center mb-6",children:[(0,bt.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:s?"Iniciar Sesi\xf3n":"Crear Cuenta"}),(0,bt.jsx)("p",{className:"text-gray-600",children:s?"Accede a tu cuenta de StrategiaPM":"Crea tu cuenta para sincronizar en la nube"})]}),(0,bt.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),f(!0),p(""),x("");try{let e;if(s)if(e=await Nt.default.signIn(i,l),e.success){const r=e.invitationActivation;if(r&&r.activated>0){const a=r.organizations.map(e=>e.name).join(", ");x("\xa1Sesi\xf3n iniciada exitosamente! \ud83c\udf89\n\n\xa1Nuevas invitaciones activadas!\nAhora tienes acceso a: ".concat(a)),setTimeout(()=>{t&&t(e.user)},3e3)}else x("\xa1Sesi\xf3n iniciada exitosamente!"),setTimeout(()=>{t&&t(e.user)},1e3)}else p(e.error||"Error al iniciar sesi\xf3n");else{if(!d.trim())return p("El nombre es requerido"),void f(!1);if(e=await Nt.default.signUp(i,l,d),e.success){const r=e.invitationActivation;if(r&&r.activated>0){const e=r.organizations.map(e=>e.name).join(", ");x("\xa1Cuenta creada exitosamente! \ud83c\udf89\n            \nHas sido agregado autom\xe1ticamente a: ".concat(e,"\n            \nYa puedes acceder a los proyectos de tu organizaci\xf3n."))}else x("\xa1Cuenta creada exitosamente! Revisa tu correo para confirmar.");setTimeout(()=>{t&&t(e.user)},3e3)}else p(e.error||"Error al crear la cuenta")}}catch(m){p("Error inesperado: "+m.message)}finally{f(!1)}},className:"space-y-4",children:[!s&&(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre completo"}),(0,bt.jsx)("input",{type:"text",value:d,onChange:e=>u(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Tu nombre completo",required:!s})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Correo electr\xf3nico"}),(0,bt.jsx)("input",{type:"email",value:i,onChange:e=>o(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"tu@email.com",required:!0})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contrase\xf1a"}),(0,bt.jsx)("input",{type:"password",value:l,onChange:e=>c(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",required:!0,minLength:6})]}),m&&(0,bt.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:m}),g&&(0,bt.jsx)("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-md",children:g}),(0,bt.jsxs)("div",{className:"flex space-x-3",children:[(0,bt.jsx)("button",{type:"submit",disabled:h,className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:h?(0,bt.jsxs)("div",{className:"flex items-center justify-center",children:[(0,bt.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-2"}),s?"Iniciando...":"Creando..."]}):s?"Iniciar Sesi\xf3n":"Crear Cuenta"}),(0,bt.jsx)("button",{type:"button",onClick:b,className:"px-4 py-2 text-gray-600 hover:text-gray-800 focus:outline-none",children:"Cancelar"})]})]}),(0,bt.jsx)("div",{className:"mt-6 text-center",children:(0,bt.jsx)("button",{onClick:()=>n(!s),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:s?"\xbfNo tienes cuenta? Crear una":"\xbfYa tienes cuenta? Iniciar sesi\xf3n"})}),(0,bt.jsx)("div",{className:"mt-4 text-center",children:(0,bt.jsx)("button",{onClick:b,className:"text-gray-500 hover:text-gray-700 text-sm",children:"Continuar sin cuenta (modo local)"})})]})})},sN=e=>{let{currentProject:t,useSupabase:s=!1,onMemberAdded:n}=e;const[i,o]=(0,a.useState)([]),[l,c]=(0,a.useState)([]),[d,u]=(0,a.useState)(!1),[h,f]=(0,a.useState)(""),[m,p]=(0,a.useState)("organization_member_write"),[g,x]=(0,a.useState)(!1),[b,v]=(0,a.useState)(null),[y,w]=(0,a.useState)(""),[j,N]=(0,a.useState)(!1),[k,S]=(0,a.useState)(null),{addAuditEvent:E}=Fw(null===t||void 0===t?void 0:t.id,s),[T,_]=(0,a.useState)((null===t||void 0===t?void 0:t.organization_id)||"73bf164f-f3e8-4207-95a6-e3e3d385148d");(0,a.useEffect)(()=>{if(s&&null!==Nt.default&&void 0!==Nt.default&&Nt.default.getCurrentOrganization()){const e=Nt.default.getCurrentOrganization();e&&e!==T&&(console.log("\ud83d\udd04 Actualizando organization ID detectado:",e),_(e))}},[s,T]);const C=async()=>{if(console.log("\ud83d\udd0d DEBUG - loadOrganizationMembers ejecut\xe1ndose",{useSupabase:s,organizationId:T}),s&&T)try{N(!0);const{default:e}=await Promise.resolve().then(r.bind(r,874));if(e.isAuthenticated()){console.log("\ud83d\udd0d DEBUG - Usuario autenticado:",e.getCurrentUser()),console.log("\ud83d\udd0d DEBUG - Organization ID:",T);const{data:t,error:r}=await e.supabase.from("organization_members").select("*");console.log("\ud83d\udd0d DEBUG - Todos los miembros (sin filtro):",{allMembers:t,allError:r});const{data:a,error:s}=await e.supabase.from("organization_members").select("*").eq("organization_id",T).order("joined_at",{ascending:!1});if(s)console.error("\u274c Error cargando miembros:",s),S("Error cargando miembros de la organizaci\xf3n");else{console.log("\ud83d\udd0d DEBUG - Datos cargados:",a);const e=(a||[]).filter(e=>"active"===e.status);o(e);const t=(a||[]).filter(e=>"pending"===e.status);c(t),console.log("\ud83d\udd0d DEBUG - Miembros activos:",e),console.log("\ud83d\udd0d DEBUG - Invitaciones pendientes:",t)}}}catch(k){console.error("Error cargando miembros:",k),S("Error cargando miembros de la organizaci\xf3n")}finally{N(!1)}},A=async(e,t)=>{const a=i.find(e=>{var t;return e.user_email===(null===(t=Nt.default.getCurrentUser())||void 0===t?void 0:t.email)});if(!("owner"===(null===a||void 0===a?void 0:a.role)||"admin"===(null===a||void 0===a?void 0:a.role)))return void alert("\u274c No tienes permisos para eliminar miembros. Solo owners y administradores pueden realizar esta acci\xf3n.");const s=i.find(t=>t.id===e);if("owner"!==(null===s||void 0===s?void 0:s.role)){if(window.confirm("\u26a0\ufe0f ELIMINACI\xd3N COMPLETA DE USUARIO\n\n\xbfEst\xe1s seguro de que quieres eliminar COMPLETAMENTE a ".concat(t,"?\n\nEsto eliminar\xe1:\n\u2022 Su membres\xeda en la organizaci\xf3n\n\u2022 Todos sus roles y permisos\n\u2022 Su acceso a todos los proyectos\n\nEsta acci\xf3n NO se puede deshacer.")))try{N(!0);const{default:a}=await Promise.resolve().then(r.bind(r,874));if(a.isAuthenticated()){console.log("\ud83d\uddd1\ufe0f Iniciando eliminaci\xf3n completa de usuario:",t),console.log("\ud83d\uddd1\ufe0f Eliminando de organization_members...");const{error:r}=await a.supabase.from("organization_members").delete().eq("id",e);if(r)throw console.error("\u274c Error eliminando de organization_members:",r),new Error("Error eliminando membres\xeda: ".concat(r.message));console.log("\ud83d\uddd1\ufe0f Eliminando de user_organization_roles...");const{error:s}=await a.supabase.from("user_organization_roles").delete().eq("user_email",t).eq("organization_id",T);s&&console.warn("\u26a0\ufe0f Error eliminando de user_organization_roles (puede no existir):",s),console.log("\ud83d\uddd1\ufe0f Buscando referencias adicionales...");const{error:i}=await a.supabase.from("tasks").update({assigned_to:null}).eq("assigned_to",t);i&&console.warn("\u26a0\ufe0f Error actualizando tareas:",i);const{error:l}=await a.supabase.from("risks").update({owner:null}).eq("owner",t);l&&console.warn("\u26a0\ufe0f Error actualizando riesgos:",l),console.log("\ud83d\uddd1\ufe0f Limpiando cach\xe9 local del usuario eliminado...");try{["mi-dashboard-portfolio","lastSelectedProjectId","portfolioData","audit-log-"+t,"user-preferences-"+t].forEach(e=>{const r=localStorage.getItem(e);if(r)try{const a=JSON.parse(r);JSON.stringify(a).includes(t)&&(console.log("\ud83d\uddd1\ufe0f Limpiando localStorage key: ".concat(e)),localStorage.removeItem(e))}catch(bN){console.log("\ud83d\uddd1\ufe0f Limpiando localStorage key (raw): ".concat(e)),localStorage.removeItem(e)}});["currentUser","userSession","organizationData"].forEach(e=>{const r=sessionStorage.getItem(e);r&&r.includes(t)&&(console.log("\ud83d\uddd1\ufe0f Limpiando sessionStorage key: ".concat(e)),sessionStorage.removeItem(e))}),console.log("\u2705 Cach\xe9 local limpiado para usuario eliminado")}catch(o){console.warn("\u26a0\ufe0f Error limpiando cach\xe9 local:",o)}var n;if(E)E({category:"organization",action:"member-completely-removed",description:'Usuario "'.concat(t,'" eliminado COMPLETAMENTE de la organizaci\xf3n'),details:{userEmail:t,organizationId:T,tablesCleaned:["organization_members","user_organization_roles","tasks","risks"],localCacheCleaned:!0},severity:"high",user:(null===(n=a.getCurrentUser())||void 0===n?void 0:n.email)||"Sistema"});console.log("\u2705 Usuario eliminado completamente de todas las tablas y cach\xe9 local");const c="\u2705 Usuario ".concat(t," eliminado COMPLETAMENTE de la organizaci\xf3n\n\nSe elimin\xf3 de:\n\u2022 organization_members (membres\xeda principal)\n\u2022 user_organization_roles (roles y permisos)\n\u2022 Referencias en tareas y riesgos\n\u2022 Cach\xe9 local del navegador\n\n\u26a0\ufe0f IMPORTANTE: El usuario eliminado debe:\n1. Cerrar sesi\xf3n completamente\n2. Cerrar el navegador\n3. Volver a abrir el navegador\n4. Iniciar sesi\xf3n nuevamente\n\nSolo as\xed ver\xe1 que ya no tiene acceso a la organizaci\xf3n.");alert(c),await C()}}catch(k){console.error("\u274c Error eliminando miembro:",k),S("Error eliminando miembro: ".concat(k.message)),alert("\u274c Error eliminando usuario: ".concat(k.message,"\n\nPor favor, intenta nuevamente o contacta al administrador."))}finally{N(!1)}}else alert("\u274c No se puede eliminar al propietario de la organizaci\xf3n.")};if((0,a.useEffect)(()=>{console.log("\ud83d\udd0d DEBUG - OrganizationMembers useEffect ejecut\xe1ndose"),C()},[T,s]),!s)return(0,bt.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:(0,bt.jsxs)("div",{className:"flex items-center",children:[(0,bt.jsx)("span",{className:"text-yellow-600 text-xl mr-3",children:"\u26a0\ufe0f"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h3",{className:"text-yellow-800 font-medium",children:"Supabase no habilitado"}),(0,bt.jsx)("p",{className:"text-yellow-700 text-sm",children:"Para compartir proyectos con otros usuarios, necesitas habilitar Supabase en la configuraci\xf3n."})]})]})});if(!T)return(0,bt.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,bt.jsxs)("div",{className:"flex items-center",children:[(0,bt.jsx)("span",{className:"text-red-600 text-xl mr-3",children:"\u274c"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h3",{className:"text-red-800 font-medium",children:"Proyecto sin organizaci\xf3n"}),(0,bt.jsx)("p",{className:"text-red-700 text-sm",children:"Este proyecto no est\xe1 asociado a una organizaci\xf3n. No se puede compartir."})]})]})});const D=e=>{switch(e){case"owner":return"bg-purple-100 text-purple-800";case"admin":return"bg-blue-100 text-blue-800";case"member":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},P=e=>{switch(e){case"organization_owner":case"admin":return"\ud83d\udc51 Administrador";case"organization_member_write":return"\u270f\ufe0f Miembro (Editar)";case"organization_member_read":return"\ud83d\udc40 Miembro (Solo lectura)";case"owner":return"\ud83d\udc51 Propietario";case"member":return"\u270f\ufe0f Miembro";default:return e}};return(0,bt.jsxs)("div",{className:"space-y-6",children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"Miembros de la Organizaci\xf3n"}),(0,bt.jsx)("p",{className:"text-gray-600",children:"Gestiona qui\xe9n puede ver y editar los proyectos de tu organizaci\xf3n"})]}),(()=>{const e=i.find(e=>{var t;return e.user_email===(null===(t=Nt.default.getCurrentUser())||void 0===t?void 0:t.email)});return"owner"===(null===e||void 0===e?void 0:e.role)||"admin"===(null===e||void 0===e?void 0:e.role)?(0,bt.jsxs)("button",{onClick:()=>u(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center space-x-2",children:[(0,bt.jsx)("span",{children:"+"}),(0,bt.jsx)("span",{children:"Invitar Miembro"})]}):(0,bt.jsxs)("div",{className:"text-sm text-gray-500 italic bg-gray-50 px-3 py-2 rounded-lg border",children:[(0,bt.jsx)("span",{children:"\ud83d\udd12"})," Solo administradores pueden invitar miembros"]})})()]}),k&&(0,bt.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,bt.jsxs)("div",{className:"flex items-center",children:[(0,bt.jsx)("span",{className:"text-red-600 text-xl mr-3",children:"\u274c"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h3",{className:"text-red-800 font-medium",children:"Error"}),(0,bt.jsx)("p",{className:"text-red-700 text-sm",children:k})]})]})}),l.length>0&&(0,bt.jsxs)("div",{className:"bg-yellow-50 rounded-lg shadow-sm border border-yellow-200",children:[(0,bt.jsx)("div",{className:"p-4 border-b border-yellow-200",children:(0,bt.jsxs)("h3",{className:"text-lg font-semibold text-yellow-800",children:["Invitaciones Pendientes (",l.length,")"]})}),(0,bt.jsx)("div",{className:"divide-y divide-yellow-200",children:l.map(e=>(0,bt.jsxs)("div",{className:"p-4 flex items-center justify-between",children:[(0,bt.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,bt.jsx)("div",{className:"w-10 h-10 bg-yellow-200 rounded-full flex items-center justify-center",children:(0,bt.jsx)("span",{className:"text-yellow-700 font-medium",children:"\u23f3"})}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("p",{className:"font-medium text-yellow-900",children:e.user_email}),(0,bt.jsxs)("p",{className:"text-sm text-yellow-600",children:["Invitado como ",P(e.role)]})]})]}),(0,bt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,bt.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"Pendiente"}),(()=>{const t=i.find(e=>{var t;return e.user_email===(null===(t=Nt.default.getCurrentUser())||void 0===t?void 0:t.email)});return"owner"===(null===t||void 0===t?void 0:t.role)||"admin"===(null===t||void 0===t?void 0:t.role)?(0,bt.jsx)("button",{onClick:()=>A(e.id,e.user_email),className:"text-red-600 hover:text-red-800 text-sm",title:"Cancelar invitaci\xf3n",children:"\ud83d\uddd1\ufe0f"}):null})()]})]},e.id))})]}),(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border",children:[(0,bt.jsx)("div",{className:"p-4 border-b",children:(0,bt.jsxs)("h3",{className:"text-lg font-semibold text-gray-800",children:["Miembros Activos (",i.length,")"]})}),(0,bt.jsx)("div",{className:"divide-y divide-gray-200",children:j?(0,bt.jsxs)("div",{className:"p-8 text-center",children:[(0,bt.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),(0,bt.jsx)("p",{className:"text-gray-600 mt-2",children:"Cargando miembros..."})]}):0===i.length?(0,bt.jsxs)("div",{className:"p-8 text-center text-gray-500",children:[(0,bt.jsx)("span",{className:"text-4xl mb-4 block",children:"\ud83d\udc65"}),(0,bt.jsx)("p",{children:"No hay miembros en la organizaci\xf3n"}),(0,bt.jsx)("p",{className:"text-sm",children:"Invita a otros usuarios para compartir tus proyectos"})]}):i.map(e=>(0,bt.jsxs)("div",{className:"p-4 flex items-center justify-between",children:[(0,bt.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,bt.jsx)("div",{className:"w-10 h-10 bg-gray-200 rounded-full flex items-center justify-center",children:(0,bt.jsx)("span",{className:"text-gray-600 font-medium",children:e.user_email.charAt(0).toUpperCase()})}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("p",{className:"font-medium text-gray-900",children:e.user_email}),(0,bt.jsxs)("p",{className:"text-sm text-gray-500",children:["Se uni\xf3 el ",new Date(e.joined_at).toLocaleDateString()]})]})]}),(0,bt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,bt.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(D(e.role)),children:P(e.role)}),(()=>{const t=i.find(e=>{var t;return e.user_email===(null===(t=Nt.default.getCurrentUser())||void 0===t?void 0:t.email)});return"owner"===(null===t||void 0===t?void 0:t.role)||"admin"===(null===t||void 0===t?void 0:t.role)?(0,bt.jsxs)("div",{className:"flex items-center space-x-2",children:["owner"!==e.role&&(0,bt.jsx)("button",{onClick:()=>(e=>{v(e),w(e.role),x(!0)})(e),className:"text-blue-600 hover:text-blue-800 text-sm",title:"Cambiar rol",children:"\u270f\ufe0f"}),"owner"!==e.role&&(0,bt.jsx)("button",{onClick:()=>A(e.id,e.user_email),className:"text-red-600 hover:text-red-800 text-sm",title:"Eliminar miembro",children:"\ud83d\uddd1\ufe0f"})]}):null})()]})]},e.id))})]}),d&&(0,bt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:(0,bt.jsx)("div",{className:"bg-white rounded-lg max-w-md w-full",children:(0,bt.jsxs)("div",{className:"p-6",children:[(0,bt.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,bt.jsx)("h2",{className:"text-xl font-bold",children:"Invitar Miembro"}),(0,bt.jsx)("button",{onClick:()=>u(!1),className:"text-gray-500 hover:text-gray-700 text-xl",children:"\u2715"})]}),(0,bt.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!h||!T)return;const t=i.find(e=>{var t;return e.user_email===(null===(t=Nt.default.getCurrentUser())||void 0===t?void 0:t.email)});if("owner"===(null===t||void 0===t?void 0:t.role)||"admin"===(null===t||void 0===t?void 0:t.role))try{N(!0),S(null);const{default:e}=await Promise.resolve().then(r.bind(r,874));if(e.isAuthenticated()){var a;console.log("\ud83d\udd0d DEBUG - Usuario autenticado:",e.getCurrentUser()),console.log("\ud83d\udd0d DEBUG - Organization ID:",T);const{data:t,error:r}=await e.supabase.from("user_organization_roles").select("role, organization_id").eq("user_id",null===(a=e.getCurrentUser())||void 0===a?void 0:a.id);console.log("\ud83d\udd0d DEBUG - RLS Context:",{rlsTest:t,rlsError:r});const{data:i,error:o}=await e.supabase.from("organization_members").select("*").eq("organization_id",T).eq("user_email",h).single();if(i)return void alert("\u26a0\ufe0f El usuario ".concat(h," ya es miembro de esta organizaci\xf3n."));console.log("\ud83d\udd0d DEBUG - Datos de inserci\xf3n:",{organization_id:T,user_id:null,user_email:h,role:m,status:"pending"});const{data:l,error:c}=await e.supabase.rpc("invite_member",{p_organization_id:T,p_user_email:h,p_role:m});if(c)throw c;if(l&&!l.success)throw new Error(l.error||"Error al invitar miembro");var s;if(E)E({category:"organization",action:"member-invited",description:'Invitaci\xf3n enviada a "'.concat(h,'" con rol "').concat(m,'"'),details:{userEmail:h,role:m,organizationId:T},severity:"medium",user:(null===(s=e.getCurrentUser())||void 0===s?void 0:s.email)||"Sistema"});const d="localhost"===window.location.hostname?"https://strategiapm.vercel.app":window.location.origin;alert("\u2705 Invitaci\xf3n enviada a ".concat(h," con rol ").concat(m,"\n\n\ud83d\udce7 El usuario recibir\xe1 acceso cuando:\n1. Se registre en la aplicaci\xf3n con este email\n2. O cuando acepte la invitaci\xf3n si ya est\xe1 registrado\n\nPuedes compartir este enlace para que se registren:\n").concat(d)),await C(),f(""),p("organization_member_write"),u(!1),n&&n()}}catch(k){console.error("Error invitando miembro:",k),S("Error invitando miembro: ".concat(k.message))}finally{N(!1)}else alert("\u274c No tienes permisos para invitar miembros. Solo owners y administradores pueden realizar esta acci\xf3n.")},children:[(0,bt.jsxs)("div",{className:"space-y-4",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email del Usuario *"}),(0,bt.jsx)("input",{type:"email",className:"w-full border rounded px-3 py-2",value:h,onChange:e=>f(e.target.value),placeholder:"usuario@ejemplo.com",required:!0})]}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rol"}),(0,bt.jsxs)("select",{className:"w-full border rounded px-3 py-2",value:m,onChange:e=>p(e.target.value),children:[(0,bt.jsx)("option",{value:"organization_owner",children:"\ud83d\udc51 Administrador (Gestionar organizaci\xf3n)"}),(0,bt.jsx)("option",{value:"organization_member_write",children:"\u270f\ufe0f Miembro (Ver y editar proyectos)"}),(0,bt.jsx)("option",{value:"organization_member_read",children:"\ud83d\udc40 Miembro (Solo lectura)"})]})]})]}),(0,bt.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,bt.jsx)("button",{type:"button",onClick:()=>u(!1),className:"px-4 py-2 border border-gray-300 rounded text-gray-700 hover:bg-gray-50",disabled:j,children:"Cancelar"}),(0,bt.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",disabled:j,children:j?"Enviando...":"Invitar"})]})]})]})})}),g&&(0,bt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,bt.jsx)("div",{className:"bg-white rounded-lg max-w-md w-full mx-4",children:(0,bt.jsxs)("div",{className:"p-6",children:[(0,bt.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,bt.jsx)("h2",{className:"text-xl font-bold",children:"Cambiar Rol de Usuario"}),(0,bt.jsx)("button",{onClick:()=>{x(!1),v(null),w("")},className:"text-gray-500 hover:text-gray-700 text-xl",children:"\u2715"})]}),(0,bt.jsxs)("div",{className:"mb-4",children:[(0,bt.jsxs)("p",{className:"text-gray-600 mb-2",children:["Cambiando rol de: ",(0,bt.jsx)("strong",{children:null===b||void 0===b?void 0:b.user_email})]}),(0,bt.jsxs)("p",{className:"text-sm text-gray-500",children:["Rol actual: ",(0,bt.jsx)("span",{className:"font-medium",children:b?P(b.role):""})]})]}),(0,bt.jsxs)("div",{className:"mb-6",children:[(0,bt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nuevo Rol"}),(0,bt.jsxs)("select",{value:y,onChange:e=>w(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,bt.jsx)("option",{value:"organization_member_write",children:"\u270f\ufe0f Miembro (Ver y editar proyectos)"}),(0,bt.jsx)("option",{value:"organization_member_read",children:"\ud83d\udc40 Miembro (Solo lectura)"}),(0,bt.jsx)("option",{value:"admin",children:"\ud83d\udc51 Administrador"})]}),(0,bt.jsxs)("div",{className:"mt-2 text-xs text-gray-500",children:[(0,bt.jsxs)("p",{children:[(0,bt.jsx)("strong",{children:"Solo lectura:"})," Puede ver proyectos pero no editarlos"]}),(0,bt.jsxs)("p",{children:[(0,bt.jsx)("strong",{children:"Editar:"})," Puede ver y modificar proyectos"]}),(0,bt.jsxs)("p",{children:[(0,bt.jsx)("strong",{children:"Administrador:"})," Puede gestionar usuarios y proyectos"]})]})]}),(0,bt.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,bt.jsx)("button",{onClick:()=>{x(!1),v(null),w("")},className:"px-4 py-2 text-gray-600 border border-gray-300 rounded hover:bg-gray-50",disabled:j,children:"Cancelar"}),(0,bt.jsx)("button",{onClick:async()=>{if(!b||!y)return;const e=i.find(e=>{var t;return e.user_email===(null===(t=Nt.default.getCurrentUser())||void 0===t?void 0:t.email)});if("owner"===(null===e||void 0===e?void 0:e.role)||"admin"===(null===e||void 0===e?void 0:e.role))if("owner"!==b.role)try{N(!0);const{default:e}=await Promise.resolve().then(r.bind(r,874));if(e.isAuthenticated()){const{error:r}=await e.supabase.from("organization_members").update({role:y}).eq("id",b.id);if(r)throw r;var t;if(E)E({category:"organization",action:"member-role-updated",description:'Rol de "'.concat(b.user_email,'" cambiado a "').concat(P(y),'"'),details:{userEmail:b.user_email,oldRole:b.role,newRole:y,organizationId:T},severity:"medium",user:(null===(t=e.getCurrentUser())||void 0===t?void 0:t.email)||"Sistema"});alert("\u2705 Rol de ".concat(b.user_email," actualizado exitosamente")),await C(),x(!1),v(null),w("")}}catch(k){console.error("Error actualizando rol:",k),S("Error actualizando rol: ".concat(k.message))}finally{N(!1)}else alert("\u274c No se puede cambiar el rol del propietario de la organizaci\xf3n.");else alert("\u274c No tienes permisos para cambiar roles. Solo owners y administradores pueden realizar esta acci\xf3n.")},className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",disabled:j||!y||y===(null===b||void 0===b?void 0:b.role),children:j?"Actualizando...":"Cambiar Rol"})]})]})})})]})},nN=e=>{let{currentProject:t,useSupabase:r=!1,projects:s=[]}=e;const[i,o]=(0,a.useState)("members"),[l,c]=(0,a.useState)({totalMembers:0,pendingInvitations:0,activeProjects:0});(0,a.useEffect)(()=>{if(s&&s.length>0){const e=s.filter(e=>"active"===e.status).length;c(t=>(0,n.A)((0,n.A)({},t),{},{activeProjects:e}))}},[s]);const d=e=>{switch(e){case"super_admin":return"Acceso total al sistema, puede gestionar todas las organizaciones";case"organization_owner":return"Control total de la organizaci\xf3n, puede gestionar miembros y proyectos";case"organization_member_write":return"Puede crear, editar y eliminar proyectos de la organizaci\xf3n";case"organization_member_read":return"Solo puede ver proyectos de la organizaci\xf3n";default:return"Rol no definido"}},u=e=>{switch(e){case"super_admin":return"bg-red-100 text-red-800 border-red-200";case"organization_owner":return"bg-purple-100 text-purple-800 border-purple-200";case"organization_member_write":return"bg-blue-100 text-blue-800 border-blue-200";case"organization_member_read":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},h=e=>{switch(e){case"super_admin":return"Super Administrador";case"organization_owner":return"Propietario de Organizaci\xf3n";case"organization_member_write":return"Miembro con Escritura";case"organization_member_read":return"Miembro de Solo Lectura";default:return e}};return(0,bt.jsxs)("div",{className:"space-y-6",children:[(0,bt.jsx)("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:(0,bt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h1",{className:"text-3xl font-bold text-gray-800",children:"Gesti\xf3n de Usuarios"}),(0,bt.jsx)("p",{className:"text-gray-600 mt-2",children:"Administra usuarios, roles y permisos de tu organizaci\xf3n"})]}),(0,bt.jsxs)("div",{className:"text-right",children:[(0,bt.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:l.activeProjects}),(0,bt.jsx)("div",{className:"text-sm text-gray-500",children:"Proyectos Activos"})]})]})}),(0,bt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border",children:[(0,bt.jsx)("div",{className:"border-b border-gray-200",children:(0,bt.jsx)("nav",{className:"flex space-x-8 px-6",children:[{id:"members",name:"Miembros",icon:"\ud83d\udc65",description:"Gestionar usuarios y roles"},{id:"roles",name:"Roles",icon:"\ud83d\udd10",description:"Configurar permisos y accesos"},{id:"invitations",name:"Invitaciones",icon:"\ud83d\udce7",description:"Ver invitaciones pendientes"}].map(e=>(0,bt.jsx)("button",{onClick:()=>o(e.id),className:"py-4 px-1 border-b-2 font-medium text-sm transition-colors ".concat(i===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:(0,bt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,bt.jsx)("span",{className:"text-lg",children:e.icon}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("div",{className:"font-medium",children:e.name}),(0,bt.jsx)("div",{className:"text-xs text-gray-400",children:e.description})]})]})},e.id))})}),(0,bt.jsxs)("div",{className:"p-6",children:["members"===i&&(0,bt.jsx)(sN,{currentProject:t,useSupabase:r,onMemberAdded:()=>{console.log("Miembro agregado, actualizando estad\xedsticas...")}}),"roles"===i&&(0,bt.jsxs)("div",{className:"space-y-6",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Roles Disponibles en el Sistema"}),(0,bt.jsx)("p",{className:"text-gray-600 mb-6",children:"Los roles determinan qu\xe9 acciones puede realizar cada usuario en la organizaci\xf3n."})]}),(0,bt.jsx)("div",{className:"grid gap-4",children:[{role:"super_admin",permissions:["Acceso total a todas las organizaciones","Puede gestionar usuarios y roles globalmente","Puede ver, crear, editar y eliminar cualquier dato","Acceso a configuraciones del sistema"]},{role:"organization_owner",permissions:["Control total de su organizaci\xf3n","Puede gestionar miembros de la organizaci\xf3n","Puede crear, editar y eliminar proyectos","Puede asignar roles a otros miembros"]},{role:"organization_member_write",permissions:["Puede crear, editar y eliminar proyectos","Puede gestionar tareas y cronogramas","Puede gestionar riesgos y finanzas","No puede gestionar otros miembros"]},{role:"organization_member_read",permissions:["Solo puede ver proyectos y datos","No puede crear, editar o eliminar","Acceso de solo lectura a la organizaci\xf3n","Ideal para consultores o revisores"]}].map(e=>{let{role:t,permissions:r}=e;return(0,bt.jsxs)("div",{className:"border rounded-lg p-4 ".concat(u(t)),children:[(0,bt.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,bt.jsx)("h4",{className:"font-semibold text-lg",children:h(t)}),(0,bt.jsx)("span",{className:"text-sm font-medium",children:t})]}),(0,bt.jsx)("p",{className:"text-sm mb-3 opacity-80",children:d(t)}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h5",{className:"font-medium mb-2",children:"Permisos:"}),(0,bt.jsx)("ul",{className:"text-sm space-y-1",children:r.map((e,t)=>(0,bt.jsxs)("li",{className:"flex items-start",children:[(0,bt.jsx)("span",{className:"text-green-500 mr-2",children:"\u2713"}),e]},t))})]})]},t)})})]}),"invitations"===i&&(0,bt.jsxs)("div",{className:"space-y-6",children:[(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Sistema de Invitaciones"}),(0,bt.jsx)("p",{className:"text-gray-600 mb-6",children:"Las invitaciones permiten agregar nuevos usuarios a tu organizaci\xf3n de forma segura."})]}),(0,bt.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:(0,bt.jsxs)("div",{className:"flex items-start",children:[(0,bt.jsx)("span",{className:"text-blue-500 text-xl mr-3",children:"\u2139\ufe0f"}),(0,bt.jsxs)("div",{children:[(0,bt.jsx)("h4",{className:"font-semibold text-blue-800 mb-2",children:"C\xf3mo Funciona el Sistema de Invitaciones"}),(0,bt.jsxs)("ol",{className:"text-sm text-blue-700 space-y-2",children:[(0,bt.jsxs)("li",{children:[(0,bt.jsx)("strong",{children:"1. Invitar Usuario:"})," Env\xedas una invitaci\xf3n con el email y rol deseado"]}),(0,bt.jsxs)("li",{children:[(0,bt.jsx)("strong",{children:"2. Estado Pendiente:"}),' La invitaci\xf3n queda en estado "pendiente" hasta que el usuario se registre']}),(0,bt.jsxs)("li",{children:[(0,bt.jsx)("strong",{children:"3. Registro del Usuario:"})," Cuando el usuario se registra con ese email, autom\xe1ticamente se une a la organizaci\xf3n"]}),(0,bt.jsxs)("li",{children:[(0,bt.jsx)("strong",{children:"4. Acceso Inmediato:"})," El usuario obtiene acceso seg\xfan el rol asignado"]})]})]})]})}),(0,bt.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,bt.jsxs)("div",{className:"bg-white border rounded-lg p-4",children:[(0,bt.jsx)("h4",{className:"font-semibold text-gray-800 mb-3",children:"\ud83d\udce7 Enviar Invitaci\xf3n"}),(0,bt.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:'Para invitar un nuevo usuario, ve a la pesta\xf1a "Miembros" y haz clic en "Invitar Miembro".'}),(0,bt.jsxs)("div",{className:"text-sm text-gray-500",children:[(0,bt.jsx)("p",{children:"\u2022 Ingresa el email del usuario"}),(0,bt.jsx)("p",{children:"\u2022 Selecciona el rol apropiado"}),(0,bt.jsx)("p",{children:"\u2022 El usuario recibir\xe1 acceso al registrarse"})]})]}),(0,bt.jsxs)("div",{className:"bg-white border rounded-lg p-4",children:[(0,bt.jsx)("h4",{className:"font-semibold text-gray-800 mb-3",children:"\ud83d\udd17 Compartir Enlace"}),(0,bt.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Puedes compartir este enlace para que los usuarios se registren:"}),(0,bt.jsx)("div",{className:"bg-gray-100 rounded p-2 text-sm font-mono break-all",children:"localhost"===window.location.hostname?"https://strategiapm.vercel.app":window.location.origin}),"localhost"===window.location.hostname&&(0,bt.jsx)("p",{className:"text-xs text-amber-600 mt-2",children:"\u26a0\ufe0f En desarrollo local - Usa el enlace de producci\xf3n para compartir"})]})]})]})]})]})]})},iN=e=>{let{onComplete:t}=e;const[r,s]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{const e=setTimeout(()=>{s(!1),setTimeout(()=>{t()},500)},4e3);return()=>clearTimeout(e)},[t]),r?(0,bt.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-gradient-to-br from-indigo-500 to-purple-600 overflow-hidden",children:[(0,bt.jsx)("div",{className:"absolute -top-1/2 -left-1/2 w-[200%] h-[200%] bg-radial-gradient from-indigo-400/10 to-transparent animate-pulse"}),(0,bt.jsxs)("div",{className:"absolute inset-0 overflow-hidden",children:[(0,bt.jsx)("div",{className:"absolute top-[10%] left-[10%] w-15 h-15 bg-blue-500 rotate-45 opacity-10 animate-float"}),(0,bt.jsx)("div",{className:"absolute top-[20%] right-[15%] w-10 h-10 bg-red-500 rounded-full opacity-10 animate-float",style:{animationDelay:"1s"}}),(0,bt.jsx)("div",{className:"absolute bottom-[20%] left-[20%] w-0 h-0 border-l-[30px] border-r-[30px] border-b-[50px] border-l-transparent border-r-transparent border-b-orange-500 opacity-10 animate-float",style:{animationDelay:"2s"}}),(0,bt.jsx)("div",{className:"absolute bottom-[15%] right-[10%] w-12 h-8 bg-purple-500 rounded-full opacity-10 animate-float",style:{animationDelay:"3s"}})]}),(0,bt.jsxs)("div",{className:"relative z-10 w-full max-w-4xl h-[600px] bg-white/95 backdrop-blur-lg rounded-3xl shadow-2xl flex flex-col items-center justify-center text-center p-10",children:[(0,bt.jsx)("div",{className:"absolute top-5 right-5 bg-slate-800 text-white px-4 py-2 rounded-full text-sm font-bold tracking-wider",children:"PMBOK BASED"}),(0,bt.jsx)("div",{className:"text-6xl font-bold bg-gradient-to-r from-indigo-500 to-purple-600 bg-clip-text text-transparent mb-3 tracking-tight",children:"StrategiaPM"}),(0,bt.jsx)("div",{className:"text-xl text-gray-600 mb-8 font-light",children:"Donde la estrategia se convierte en resultados"}),(0,bt.jsxs)("div",{className:"flex justify-around w-full mt-10",children:[(0,bt.jsxs)("div",{className:"flex flex-col items-center opacity-80",children:[(0,bt.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-xl flex items-center justify-center text-white text-2xl mb-2 shadow-lg shadow-indigo-500/30",children:"\ud83d\udcca"}),(0,bt.jsxs)("div",{className:"text-sm text-gray-600 font-medium text-center",children:["Planificaci\xf3n",(0,bt.jsx)("br",{}),"Estrat\xe9gica"]})]}),(0,bt.jsxs)("div",{className:"flex flex-col items-center opacity-80",children:[(0,bt.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-xl flex items-center justify-center text-white text-2xl mb-2 shadow-lg shadow-indigo-500/30",children:"\u26a1"}),(0,bt.jsxs)("div",{className:"text-sm text-gray-600 font-medium text-center",children:["Ejecuci\xf3n",(0,bt.jsx)("br",{}),"Eficiente"]})]}),(0,bt.jsxs)("div",{className:"flex flex-col items-center opacity-80",children:[(0,bt.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-xl flex items-center justify-center text-white text-2xl mb-2 shadow-lg shadow-indigo-500/30",children:"\ud83c\udfaf"}),(0,bt.jsxs)("div",{className:"text-sm text-gray-600 font-medium text-center",children:["Resultados",(0,bt.jsx)("br",{}),"Medibles"]})]}),(0,bt.jsxs)("div",{className:"flex flex-col items-center opacity-80",children:[(0,bt.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-xl flex items-center justify-center text-white text-2xl mb-2 shadow-lg shadow-indigo-500/30",children:"\ud83d\udc65"}),(0,bt.jsxs)("div",{className:"text-sm text-gray-600 font-medium text-center",children:["Colaboraci\xf3n",(0,bt.jsx)("br",{}),"en Equipo"]})]})]}),(0,bt.jsx)("div",{className:"absolute bottom-5 right-5 text-gray-400 text-sm",children:"v1.0"})]}),(0,bt.jsx)("style",{jsx:!0,children:"\n        @keyframes float {\n          0%, 100% { transform: translateY(0px) rotate(0deg); }\n          50% { transform: translateY(-20px) rotate(10deg); }\n        }\n        .animate-float {\n          animation: float 6s ease-in-out infinite;\n        }\n        .bg-radial-gradient {\n          background: radial-gradient(circle, rgba(102, 126, 234, 0.1) 0%, transparent 70%);\n        }\n      "})]}):null};const oN=new class{constructor(){this.dataFileName="portfolio-data.json",this.backupDir="backups",this.syncInterval=3e4,this.isInitialized=!1,this.syncTimer=null,this.fileCreated=!1,this.lastBackupTime=null,this.dbName="MiDashboardDB",this.dbVersion=1,this.storeName="portfolioData"}async initialize(){if(!this.isInitialized)try{await this.createBackupDirectory(),this.startAutoSync(),this.isInitialized=!0,console.log("\u2705 FilePersistenceService inicializado correctamente")}catch(e){console.error("\u274c Error inicializando FilePersistenceService:",e)}}async createBackupDirectory(){try{console.log("\ud83d\udcc1 Directorio de respaldos creado/verificado")}catch(e){console.error("Error creando directorio de respaldos:",e)}}async loadData(){try{if(this.isSafari()){console.log("\ud83c\udf4e Safari detectado - cargando desde IndexedDB");const t=await this.loadFromIndexedDB();var e;if(t)return console.log("\ud83d\udcc2 Datos cargados desde IndexedDB - globalResources:",t.globalResources),console.log("\ud83d\udcc2 Cantidad de recursos cargados:",(null===(e=t.globalResources)||void 0===e?void 0:e.length)||0),t;const r=localStorage.getItem("mi-dashboard-portfolio");if(r){const e=JSON.parse(r);return console.log("\ud83d\udcc2 Datos cargados desde localStorage (fallback)"),e}return null}if("showOpenFilePicker"in window)try{const[e]=await window.showOpenFilePicker({types:[{description:"JSON files",accept:{"application/json":[".json"]}}]});this.fileHandle=e;const t=await e.getFile(),r=await t.text(),a=JSON.parse(r);return console.log("\ud83d\udcc2 Datos cargados desde archivo del sistema:",a),a}catch(r){console.log("File System Access API no disponible, usando localStorage")}console.log("\ud83d\udcc2 Cargando datos desde localStorage...");const a=localStorage.getItem("mi-dashboard-portfolio");if(a){var t;const e=JSON.parse(a);return console.log("\ud83d\udcc2 Datos cargados - globalResources:",e.globalResources),console.log("\ud83d\udcc2 Cantidad de recursos cargados:",(null===(t=e.globalResources)||void 0===t?void 0:t.length)||0),e}return console.log("\ud83d\udcc2 No hay datos guardados"),null}catch(r){return console.error("\u274c Error cargando datos:",r),null}}async loadFromFile(){try{if(console.log("\ud83d\udcc2 Intentando cargar desde archivo..."),"showOpenFilePicker"in window)try{const[e]=await window.showOpenFilePicker({types:[{description:"JSON files",accept:{"application/json":[".json"]}}]}),t=await e.getFile(),r=await t.text(),a=JSON.parse(r);return console.log("\ud83d\udcc2 Datos cargados desde archivo del sistema:",a),a}catch(e){console.log("File System Access API no disponible, usando input de archivo")}const t=document.createElement("input");return t.type="file",t.accept=".json",t.style.display="none",new Promise(r=>{t.onchange=t=>{const a=t.target.files[0];if(a){const t=new FileReader;t.onload=t=>{try{const e=JSON.parse(t.target.result);console.log("\ud83d\udcc2 Datos cargados desde archivo:",e),r(e)}catch(e){console.error("\u274c Error parseando archivo:",e),r(null)}},t.readAsText(a)}else r(null)},document.body.appendChild(t),t.click(),document.body.removeChild(t)})}catch(e){return console.error("\u274c Error cargando desde archivo:",e),null}}async saveData(e){try{const r=JSON.stringify(e,null,2),a=new Blob([r]).size;a>5242880&&(console.warn("\u26a0\ufe0f Datos exceden l\xedmite de memoria:",a,"bytes"),this.cleanOldData(e)),localStorage.setItem("mi-dashboard-portfolio",r);try{await this.saveToIndexedDB(e),this.fileCreated=!0,console.log("\u2705 Datos guardados exitosamente en IndexedDB")}catch(t){console.error("\u274c Error guardando en IndexedDB:",t),console.log("\u26a0\ufe0f Los datos se mantienen en localStorage como respaldo")}const s=new CustomEvent("fileDataSaved",{detail:{fileName:this.dataFileName,timestamp:(new Date).toISOString(),dataSize:r.length,path:"IndexedDB + localStorage"}});return window.dispatchEvent(s),!0}catch(t){return console.error("Error guardando datos:",t),!1}}async createDataFile(e){try{const t=JSON.stringify(e,null,2);localStorage.setItem("mi-dashboard-portfolio",t),await this.saveToIndexedDB(e),this.fileCreated=!0,console.log("\u2705 Archivo de datos creado en IndexedDB (persistencia local)")}catch(t){console.error("Error creando archivo de datos:",t)}}downloadDataFile(e,t){const r=JSON.stringify(e,null,2),a=new Blob([r],{type:"application/json"}),s=URL.createObjectURL(a),n=document.createElement("a");n.href=s,n.download=t,n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(s),console.log("\ud83d\udcbe Archivo ".concat(t," descargado para actualizaci\xf3n"))}isSafari(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}cleanDataForIndexedDB(e){try{return JSON.parse(JSON.stringify(e))}catch(t){console.warn("\u26a0\ufe0f Error limpiando datos, usando clonaci\xf3n manual:",t);const a={};for(const s in e)if(e.hasOwnProperty(s))try{Array.isArray(e[s])?a[s]=e[s].map(e=>"object"===typeof e&&null!==e?JSON.parse(JSON.stringify(e)):e):"object"===typeof e[s]&&null!==e[s]?a[s]=JSON.parse(JSON.stringify(e[s])):a[s]=e[s]}catch(r){console.warn("\u26a0\ufe0f Saltando propiedad no serializable: ".concat(s),r)}return a}}async saveToIndexedDB(e){return new Promise((t,r)=>{console.log("\ud83d\udd0d Abriendo IndexedDB para guardar...");const a=indexedDB.open(this.dbName,this.dbVersion);a.onerror=()=>{console.error("\u274c Error abriendo IndexedDB:",a.error),r(a.error)},a.onsuccess=()=>{console.log("\u2705 IndexedDB abierto para guardar");const s=a.result.transaction([this.storeName],"readwrite").objectStore(this.storeName);console.log("\ud83d\udcbe Guardando datos en IndexedDB..."),console.log("\ud83d\udcbe Datos a guardar:",Object.keys(e));const n=this.cleanDataForIndexedDB(e),i=s.put(n,"portfolio-data");i.onsuccess=()=>{console.log("\ud83d\udcbe Datos guardados en IndexedDB (persistencia real)"),console.log("\ud83d\udcbe Clave guardada: portfolio-data"),t()},i.onerror=()=>{console.error("\u274c Error guardando en IndexedDB:",i.error),r(i.error)}},a.onupgradeneeded=e=>{console.log("\ud83d\udd27 Creando/actualizando estructura de IndexedDB para guardar...");const t=e.target.result;t.objectStoreNames.contains(this.storeName)||(t.createObjectStore(this.storeName),console.log("\u2705 ObjectStore creado para guardar:",this.storeName))}})}async loadFromIndexedDB(){return new Promise((e,t)=>{console.log("\ud83d\udd0d Intentando abrir IndexedDB...");const r=indexedDB.open(this.dbName,this.dbVersion);r.onerror=()=>{console.error("\u274c Error abriendo IndexedDB:",r.error),t(r.error)},r.onsuccess=()=>{console.log("\u2705 IndexedDB abierto correctamente");const a=r.result.transaction([this.storeName],"readonly").objectStore(this.storeName);console.log("\ud83d\udd0d Buscando datos en IndexedDB...");const s=a.get("portfolio-data");s.onsuccess=()=>{console.log("\ud83d\udd0d Resultado de b\xfasqueda en IndexedDB:",s.result),s.result?(console.log("\ud83d\udcc2 Datos cargados desde IndexedDB (persistencia real)"),console.log("\ud83d\udcc2 Datos encontrados:",Object.keys(s.result)),e(s.result)):(console.log("\ud83d\udcc2 No hay datos en IndexedDB"),e(null))},s.onerror=()=>{console.error("\u274c Error cargando desde IndexedDB:",s.error),t(s.error)}},r.onupgradeneeded=e=>{console.log("\ud83d\udd27 Creando/actualizando estructura de IndexedDB...");const t=e.target.result;t.objectStoreNames.contains(this.storeName)||(t.createObjectStore(this.storeName),console.log("\u2705 ObjectStore creado:",this.storeName))}})}async createBackup(e){try{const t=(new Date).toISOString(),r="backup-".concat(t.split("T")[0],"-").concat(Date.now(),".json"),a=new Date;if(this.lastBackupTime&&a-this.lastBackupTime<6e5)return console.log("\ud83d\udce6 Respaldo omitido - muy reciente"),!0;const s=JSON.stringify(e,null,2),n=new Blob([s],{type:"application/json"}),i=URL.createObjectURL(n),o=document.createElement("a");o.href=i,o.download=r,o.style.display="none";const l=window.location.origin.replace("localhost:3000","mi-dashboard");o.setAttribute("data-path",l),document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i),this.lastBackupTime=a,console.log("\ud83d\udce6 Respaldo autom\xe1tico creado:",r),console.log("\ud83d\udce6 Respaldo guardado en la ra\xedz del proyecto");const c=new CustomEvent("autoBackupCreated",{detail:{fileName:r,timestamp:t,dataSize:JSON.stringify(e).length,path:"ra\xedz del proyecto"}});return window.dispatchEvent(c),!0}catch(t){return console.error("Error creando respaldo:",t),!1}}startAutoSync(){this.syncTimer&&clearInterval(this.syncTimer),this.syncTimer=setInterval(()=>{this.performAutoSync()},this.syncInterval),console.log("\ud83d\udd04 Sincronizaci\xf3n autom\xe1tica iniciada cada 30 segundos")}stopAutoSync(){this.syncTimer&&(clearInterval(this.syncTimer),this.syncTimer=null,console.log("\u23f9\ufe0f Sincronizaci\xf3n autom\xe1tica detenida"))}async performAutoSync(){try{console.log("\ud83d\udd04 Ejecutando sincronizaci\xf3n autom\xe1tica...");const e=localStorage.getItem("mi-dashboard-portfolio");if(e){const t=JSON.parse(e);await this.saveToIndexedDB(t),console.log("\u2705 Sincronizaci\xf3n autom\xe1tica completada (IndexedDB)")}else console.log("\u26a0\ufe0f No hay datos para sincronizar")}catch(e){console.error("\u274c Error en sincronizaci\xf3n autom\xe1tica:",e)}}cleanOldData(e){try{if(console.log("\ud83e\uddf9 Limpiando datos antiguos para reducir tama\xf1o..."),e.auditLogsByProject)for(const t in e.auditLogsByProject){const r=e.auditLogsByProject[t];Array.isArray(r)&&r.length>100&&(e.auditLogsByProject[t]=r.slice(-100),console.log("\ud83e\uddf9 Limpiados logs antiguos del proyecto ".concat(t)))}if(e.filesByProject)for(const t in e.filesByProject){const r=e.filesByProject[t];Array.isArray(r)&&r.length>50&&(e.filesByProject[t]=r.slice(-50),console.log("\ud83e\uddf9 Limpiados archivos antiguos del proyecto ".concat(t)))}console.log("\u2705 Limpieza de datos completada")}catch(t){console.error("\u274c Error limpiando datos antiguos:",t)}}exportData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{const r=(new Date).toISOString(),a=t||"strategiapm-backup-".concat(r.split("T")[0],".json"),s=JSON.stringify(e,null,2),n=new Blob([s],{type:"application/json"}),i=URL.createObjectURL(n),o=document.createElement("a");return o.href=i,o.download=a,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i),console.log("\ud83d\udce4 Backup manual creado:",a),!0}catch(r){return console.error("Error exportando datos:",r),!1}}async createManualBackup(e){try{const t=(new Date).toISOString(),r="strategiapm-backup-".concat(t.split("T")[0],"-").concat(Date.now(),".json");return this.exportData(e,r),console.log("\ud83d\udce6 Backup manual creado:",r),!0}catch(t){return console.error("Error creando backup manual:",t),!1}}async importData(e){try{return new Promise((t,r)=>{const a=new FileReader;a.onload=async a=>{try{const r=JSON.parse(a.target.result);await this.saveData(r);const s=new CustomEvent("fileDataImported",{detail:{fileName:e.name,timestamp:(new Date).toISOString(),dataSize:JSON.stringify(r).length}});window.dispatchEvent(s),t(r)}catch(s){r(s)}},a.onerror=r,a.readAsText(e)})}catch(t){throw console.error("Error importando datos:",t),t}}getStatus(){return{isInitialized:this.isInitialized,isSyncing:null!==this.syncTimer,syncInterval:this.syncInterval,dataFileName:this.dataFileName,backupDir:this.backupDir}}},lN=oN,cN={projects:[],currentProjectId:null,workPackages:[],purchaseOrders:[],advances:[],invoices:[],risks:[],viewMode:"dashboard",reportingDate:(new Date).toISOString().split("T")[0],isLoading:!1,error:null},dN={SET_PROJECTS:"SET_PROJECTS",SET_CURRENT_PROJECT:"SET_CURRENT_PROJECT",SET_WORK_PACKAGES:"SET_WORK_PACKAGES",SET_PURCHASE_ORDERS:"SET_PURCHASE_ORDERS",SET_ADVANCES:"SET_ADVANCES",SET_INVOICES:"SET_INVOICES",SET_RISKS:"SET_RISKS",SET_VIEW_MODE:"SET_VIEW_MODE",SET_REPORTING_DATE:"SET_REPORTING_DATE",SET_LOADING:"SET_LOADING",SET_ERROR:"SET_ERROR",ADD_PROJECT:"ADD_PROJECT",UPDATE_PROJECT:"UPDATE_PROJECT",DELETE_PROJECT:"DELETE_PROJECT",ADD_WORK_PACKAGE:"ADD_WORK_PACKAGE",UPDATE_WORK_PACKAGE:"UPDATE_WORK_PACKAGE",DELETE_WORK_PACKAGE:"DELETE_WORK_PACKAGE",ADD_PURCHASE_ORDER:"ADD_PURCHASE_ORDER",UPDATE_PURCHASE_ORDER:"UPDATE_PURCHASE_ORDER",DELETE_PURCHASE_ORDER:"DELETE_PURCHASE_ORDER",ADD_ADVANCE:"ADD_ADVANCE",UPDATE_ADVANCE:"UPDATE_ADVANCE",DELETE_ADVANCE:"DELETE_ADVANCE",ADD_INVOICE:"ADD_INVOICE",UPDATE_INVOICE:"UPDATE_INVOICE",DELETE_INVOICE:"DELETE_INVOICE",ADD_RISK:"ADD_RISK",UPDATE_RISK:"UPDATE_RISK",DELETE_RISK:"DELETE_RISK"};function uN(e,t){switch(t.type){case dN.SET_PROJECTS:return Object.assign({},e,{projects:t.payload});case dN.SET_CURRENT_PROJECT:return Object.assign({},e,{currentProjectId:t.payload});case dN.SET_WORK_PACKAGES:return Object.assign({},e,{workPackages:t.payload});case dN.SET_PURCHASE_ORDERS:return Object.assign({},e,{purchaseOrders:t.payload});case dN.SET_ADVANCES:return Object.assign({},e,{advances:t.payload});case dN.SET_INVOICES:return Object.assign({},e,{invoices:t.payload});case dN.SET_RISKS:return Object.assign({},e,{risks:t.payload});case dN.SET_VIEW_MODE:return Object.assign({},e,{viewMode:t.payload});case dN.SET_REPORTING_DATE:return Object.assign({},e,{reportingDate:t.payload});case dN.SET_LOADING:return Object.assign({},e,{isLoading:t.payload});case dN.SET_ERROR:return Object.assign({},e,{error:t.payload});case dN.ADD_PROJECT:return Object.assign({},e,{projects:e.projects.slice().concat([t.payload])});case dN.UPDATE_PROJECT:return Object.assign({},e,{projects:e.projects.map(e=>e.id===t.payload.id?t.payload:e)});case dN.DELETE_PROJECT:return Object.assign({},e,{projects:e.projects.filter(e=>e.id!==t.payload)});case dN.ADD_WORK_PACKAGE:return Object.assign({},e,{workPackages:e.workPackages.slice().concat([t.payload])});case dN.UPDATE_WORK_PACKAGE:return Object.assign({},e,{workPackages:e.workPackages.map(e=>e.id===t.payload.id?t.payload:e)});case dN.DELETE_WORK_PACKAGE:return Object.assign({},e,{workPackages:e.workPackages.filter(e=>e.id!==t.payload)});case dN.ADD_PURCHASE_ORDER:return Object.assign({},e,{purchaseOrders:e.purchaseOrders.slice().concat([t.payload])});case dN.UPDATE_PURCHASE_ORDER:return Object.assign({},e,{purchaseOrders:e.purchaseOrders.map(e=>e.id===t.payload.id?t.payload:e)});case dN.DELETE_PURCHASE_ORDER:return Object.assign({},e,{purchaseOrders:e.purchaseOrders.filter(e=>e.id!==t.payload)});case dN.ADD_ADVANCE:return Object.assign({},e,{advances:e.advances.slice().concat([t.payload])});case dN.UPDATE_ADVANCE:return Object.assign({},e,{advances:e.advances.map(e=>e.id===t.payload.id?t.payload:e)});case dN.DELETE_ADVANCE:return Object.assign({},e,{advances:e.advances.filter(e=>e.id!==t.payload)});case dN.ADD_INVOICE:return Object.assign({},e,{invoices:e.invoices.slice().concat([t.payload])});case dN.UPDATE_INVOICE:return Object.assign({},e,{invoices:e.invoices.map(e=>e.id===t.payload.id?t.payload:e)});case dN.DELETE_INVOICE:return Object.assign({},e,{invoices:e.invoices.filter(e=>e.id!==t.payload)});case dN.ADD_RISK:return Object.assign({},e,{risks:e.risks.slice().concat([t.payload])});case dN.UPDATE_RISK:return Object.assign({},e,{risks:e.risks.map(e=>e.id===t.payload.id?t.payload:e)});case dN.DELETE_RISK:return Object.assign({},e,{risks:e.risks.filter(e=>e.id!==t.payload)});default:return e}}const hN=(0,a.createContext)();function fN(e){let{children:t}=e;const[r,s]=(0,a.useReducer)(uN,cN),i=(0,n.A)((0,n.A)({},r),{},{dispatch:s,getCurrentProject:()=>r.projects.find(e=>e.id===r.currentProjectId)||r.projects[0],getWorkPackagesByProject:e=>r.workPackages.filter(t=>t.projectId===e),getPurchaseOrdersByWorkPackage:e=>r.purchaseOrders.filter(t=>t.workPackageId===e),getInvoicesByPurchaseOrder:e=>r.invoices.filter(t=>t.purchaseOrderId===e),getAdvancesByPurchaseOrder:e=>r.advances.filter(t=>t.purchaseOrderId===e),getRisksByProject:e=>r.risks.filter(t=>t.projectId===e),ACTIONS:dN});return(0,bt.jsx)(hN.Provider,{value:i,children:t})}function mN(){const{user:e,showSplash:t,completeSplash:r}=wt();(0,a.useEffect)(()=>{0},[]);const[s,i]=(0,a.useState)([{id:"demo-001",name:"Proyecto de Demostraci\xf3n",description:"Proyecto de ejemplo para familiarizarse con el sistema. Puede eliminarse cuando agregue sus proyectos reales.",status:"active",priority:"medium",startDate:(new Date).toISOString().split("T")[0],endDate:new Date(Date.now()+2592e6).toISOString().split("T")[0],budget:1e5,contingencyReserve:1e4,managementReserve:5e3,manager:"Usuario Demo",sponsor:"Organizaci\xf3n",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),version:"1.0.0",progress:0}]),[o,l]=(0,a.useState)(()=>{const e=localStorage.getItem("lastSelectedProjectId");if(e){const t=s.find(t=>t.id===e);if(t&&"active"===t.status)return e}const t=s.find(e=>"active"===e.status);return t?t.id:s.length>0?s[0].id:"demo-001"}),[c,d]=(0,a.useState)("portfolio"),[u,h]=(0,a.useState)("dashboard"),[f,m]=(0,a.useState)(!1),[p,g]=(0,a.useState)(!1),[x,b]=(0,a.useState)(!1);(0,a.useEffect)(()=>{if(s&&s.length>0){if(!s.find(e=>e.id===o)){const e=s.find(e=>"active"===e.status),t=e?e.id:s[0].id;console.log("\ud83d\udd27 CORRIGIENDO currentProjectId:",{currentProjectId:o,availableProjects:s.map(e=>({id:e.id,name:e.name,status:e.status})),fallbackTo:t,reason:"Proyecto no encontrado, usando primer proyecto disponible"}),l(t)}}},[s,o]);const[v,y]=(0,a.useState)({"demo-001":[]}),[w,j]=(0,a.useState)({"demo-001":!1}),N=()=>{const e=v[o]||[];return console.log("\ud83d\udd0d getCurrentProjectTasks - Proyecto ".concat(o,":"),{currentProjectId:o,tasksCount:e.length,tasksWithDifferentProjects:e.filter(e=>e.projectId&&e.projectId!==o).length,sampleTasks:e.slice(0,3).map(e=>({id:e.id,name:e.name,projectId:e.projectId,startDate:e.startDate,endDate:e.endDate,cost:e.cost,isMilestone:e.isMilestone})),tasksWithCosts:e.filter(e=>e.cost>0).length,tasksWithCostsDetails:e.filter(e=>e.cost>0).map(e=>({id:e.id,name:e.name,startDate:e.startDate,endDate:e.endDate,cost:e.cost,isMilestone:e.isMilestone}))}),Array.isArray(e)?e:(console.warn("\u26a0\ufe0f Datos corruptos detectados en getCurrentProjectTasks:",{currentProjectId:o,tasksType:typeof e,tasksValue:e}),[])},k=(0,a.useRef)(!1),S=(0,a.useCallback)(()=>{if(!k.current&&v&&"object"===typeof v&&!Array.isArray(v)&&Object.keys(v).length>0){let e=!1;for(const[t,r]of Object.entries(v))if("function"===typeof r||r&&!Array.isArray(r)){e=!0,console.warn("\u26a0\ufe0f Datos corruptos detectados en tasksByProject para proyecto:",t,"tipo:",typeof r);break}if(e){const e=(e=>{if(!e||"object"!==typeof e)return console.warn("\ud83d\udea8 CORRUPCI\xd3N REAL: data no es un objeto v\xe1lido"),{};const t={};let r=!1,a=[];if(Object.keys(e).forEach(s=>{const n=e[s];"function"===typeof n?(console.warn("\ud83d\udea8 CORRUPCI\xd3N REAL detectada en proyecto ".concat(s,": funci\xf3n en lugar de array")),a.push("".concat(s,": funci\xf3n")),t[s]=[],r=!0):n&&!Array.isArray(n)&&"object"===typeof n&&n.constructor!==Array?(console.warn("\ud83d\udea8 CORRUPCI\xd3N REAL detectada en proyecto ".concat(s,": objeto no-array")),a.push("".concat(s,": objeto no-array")),t[s]=[],r=!0):t[s]=n}),r){console.warn("\ud83d\udea8 CORRUPCI\xd3N REAL detectada y corregida:",a);const t=JSON.stringify(e);localStorage.setItem("corruption-backup-"+Date.now(),t),console.log("\ud83d\udcbe Backup de datos corruptos creado")}else console.log("\u2705 Datos v\xe1lidos, sin limpieza necesaria");return t})(v);e!==v&&(console.warn("\u26a0\ufe0f Datos corruptos detectados en tasksByProject, limpiando..."),_(e))}k.current=!0}},[v]),E=(0,a.useRef)(!1),T=(0,a.useRef)(!1),_=(0,a.useCallback)(e=>{if(T.current)return void console.warn("\u26a0\ufe0f safeSetTasksByProject - ACTUALIZACI\xd3N EN PROGRESO, OMITIENDO");if(console.log("\ud83d\udcca safeSetTasksByProject - INICIANDO:",{newTasksByProjectType:typeof e,isArray:Array.isArray(e),keys:e&&"object"===typeof e?Object.keys(e):"N/A"}),T.current=!0,!e||"object"!==typeof e||Array.isArray(e))return console.error("\u274c safeSetTasksByProject - DATOS INV\xc1LIDOS:",{type:typeof e,isArray:Array.isArray(e),value:e}),void(T.current=!1);let t=0,r=0;Object.entries(e).forEach(e=>{let[a,s]=e;if(Array.isArray(s)){t+=s.length;const e=new Set;s.forEach(t=>{e.has(t.id)?r++:e.add(t.id)})}}),r>0&&console.warn("\u26a0\ufe0f safeSetTasksByProject - DUPLICADOS DETECTADOS: ".concat(r," de ").concat(t," tareas")),y(e),setTimeout(()=>{T.current=!1,console.log("\ud83d\udcca safeSetTasksByProject - FLAG LIBERADO")},100)},[]),C=function(e){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])&&E.current)return void console.warn("\u26a0\ufe0f updateCurrentProjectTasks - ACTUALIZACI\xd3N EN PROGRESO, OMITIENDO");if(console.log("\ud83d\udcca updateCurrentProjectTasks - INICIANDO:",{currentProjectId:o,newTasksLength:null===e||void 0===e?void 0:e.length,newTasksType:typeof e}),!Array.isArray(e))return void console.error("\u274c updateCurrentProjectTasks - newTasks NO ES UN ARRAY:",{currentProjectId:o,newTasksType:typeof e,newTasksValue:e});E.current=!0;const t=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}),r=new Set,a=new Set,s=[];let n=0,i=0;const l=new Map;for(const o of e){const e=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;let c=o.id;const d=o.id;e.test(c)||(console.warn("\u26a0\ufe0f ID inv\xe1lido detectado: ".concat(c," - ").concat(o.name,", generando nuevo UUID")),c=t(),i++,l.set(d,c));const u=JSON.stringify({name:o.name,duration:o.duration,startDate:o.startDate,endDate:o.endDate,description:o.description,predecessors:o.predecessors,successors:o.successors}),h=r.has(c),f=a.has(u);if(h||f){console.warn("\u26a0\ufe0f Tarea duplicada detectada: ".concat(c," - ").concat(o.name," (por ").concat(h?"ID":"contenido",")")),n++;continue}r.add(c),a.add(u);const m=(o.predecessors||[]).map(e=>l.get(e)||e),p=(o.successors||[]).map(e=>l.get(e)||e),g={id:c,name:o.name,description:o.description,duration:o.duration,startDate:o.startDate,endDate:o.endDate,progress:o.progress||0,priority:o.priority,cost:o.cost||0,predecessors:m,successors:p,resources:o.resources||[],status:o.status||"pending",wbsCode:o.wbsCode,assignedTo:o.assignedTo,isMilestone:o.isMilestone||!1,originalDuration:o.originalDuration};Object.keys(g).forEach(e=>{void 0!==g[e]&&null!==g[e]||delete g[e]}),s.push(g)}n>0&&console.warn("\u26a0\ufe0f Se encontraron ".concat(n," tareas duplicadas, eliminando duplicados...")),i>0&&(console.warn("\ud83d\udd27 Se corrigieron ".concat(i," IDs inv\xe1lidos con UUIDs v\xe1lidos")),console.log("\ud83d\udd0d Mapeo de IDs actualizado:",Array.from(l.entries()))),0===s.length&&console.warn("\u26a0\ufe0f updateCurrentProjectTasks - TAREAS VAC\xcdAS:",{currentProjectId:o,newTasksLength:s.length}),y(e=>{var t;if(console.log("\ud83d\udcca updateCurrentProjectTasks - setTasksByProject INICIANDO:",{currentProjectId:o,prevKeys:Object.keys(e||{}),newTasksLength:s.length,duplicatesRemoved:n}),!e||"object"!==typeof e||Array.isArray(e))return console.error("\u274c updateCurrentProjectTasks - prev NO ES UN OBJETO V\xc1LIDO:",{prevType:typeof e,prevValue:e}),e;const r=Object.assign({},e);return r[o]=s,console.log("\ud83d\udcca updateCurrentProjectTasks - setTasksByProject COMPLETADO:",{currentProjectId:o,updatedKeys:Object.keys(r),tasksInProject:null===(t=r[o])||void 0===t?void 0:t.length,duplicatesRemoved:n}),r}),setTimeout(()=>{E.current=!1,console.log("\ud83d\udcca updateCurrentProjectTasks - FLAG LIBERADO")},100)},[A,D]=(0,a.useState)({"demo-001":[]}),P=()=>A[o]||[],[I,O]=(0,a.useState)({"demo-001":[]}),[R,M]=(0,a.useState)({"demo-001":[]}),[F,L]=(0,a.useState)({"demo-001":[]}),[z,B]=(0,a.useState)({"demo-001":[]}),U=()=>I[o]||[],W=()=>R[o]||[],H=()=>F[o]||[],V=()=>z[o]||[],[G,q]=(0,a.useState)([]),[$,K]=(0,a.useState)({"demo-001":[]}),[Y,J]=(0,a.useState)({"demo-001":[]}),[X,Q]=(0,a.useState)(!1);(0,a.useEffect)(()=>{(async()=>{try{console.log("\ud83d\ude80 Iniciando carga de datos..."),console.log("\ud83d\udd27 Inicializando Supabase...");const e=await Nt.default.initialize();if(g(e),e)if(Nt.default.getCurrentUser()){console.log("\u2705 Supabase inicializado con usuario autenticado"),m(!0),console.log("\ud83d\udd0d Cargando datos desde Supabase...");const e=await Nt.default.loadPortfolioData();if(console.log("\ud83d\udd0d Resultado de loadPortfolioData():",e),e)return console.log("\ud83d\udcc2 Datos encontrados en Supabase, cargando..."),e.projects&&Array.isArray(e.projects)&&e.projects.length>0&&(console.log("\ud83d\udcc2 Cargando proyectos desde Supabase:",e.projects.length),i(e.projects)),e.currentProjectId&&l(e.currentProjectId),e.tasksByProject&&_(e.tasksByProject),e.risksByProject&&D(e.risksByProject),e.purchaseOrdersByProject&&O(e.purchaseOrdersByProject),e.advancesByProject&&M(e.advancesByProject),e.invoicesByProject&&L(e.invoicesByProject),e.contractsByProject&&B(e.contractsByProject),e.globalResources&&q(e.globalResources),void Q(!0)}else console.log("\u26a0\ufe0f Supabase disponible pero sin usuario autenticado"),b(!0);console.log("\u26a0\ufe0f Supabase no disponible, usando localStorage..."),m(!1),console.log("\ud83d\udd27 Inicializando filePersistenceService..."),await lN.initialize(),console.log("\u2705 filePersistenceService inicializado"),console.log("\ud83d\udd0d Llamando a filePersistenceService.loadData()...");const t=await lN.loadData();console.log("\ud83d\udd0d Resultado de loadData():",t),t?(console.log("\ud83d\udcc2 Datos encontrados, cargando..."),console.log("\ud83d\udcc2 globalResources en datos guardados:",t.globalResources),t.projects&&Array.isArray(t.projects)&&t.projects.length>0?(console.log("\ud83d\udcc2 Cargando proyectos guardados:",t.projects.length),i(t.projects)):console.log("\ud83d\udcc2 No hay proyectos guardados v\xe1lidos, manteniendo proyectos iniciales"),t.currentProjectId&&l(t.currentProjectId),t.tasksByProject&&_(t.tasksByProject),t.includeWeekendsByProject&&j(t.includeWeekendsByProject),t.risksByProject&&D(t.risksByProject),t.purchaseOrdersByProject&&O(t.purchaseOrdersByProject),t.advancesByProject&&M(t.advancesByProject),t.invoicesByProject&&L(t.invoicesByProject),t.contractsByProject&&B(t.contractsByProject),t.globalResources&&(console.log("\ud83d\udcc2 Estableciendo globalResources:",t.globalResources),q(t.globalResources)),t.resourceAssignmentsByProject&&K(t.resourceAssignmentsByProject),t.auditLogsByProject&&J(t.auditLogsByProject)):(console.log("\ud83d\udcc2 No se encontraron datos guardados"),console.log("\ud83d\udcc2 savedData es:",t)),S(),console.log("\u2705 Marcando dataLoaded como true"),Q(!0)}catch(e){console.error("\u274c Error al cargar datos:",e),console.error("\u274c Stack trace:",e.stack),Q(!0)}})()},[]),(0,a.useEffect)(()=>{if(!X||!f||!Nt.default.isAuthenticated())return;(async()=>{try{console.log("\ud83d\udd04 Recargando datos para el proyecto actual:",o);const e=await Nt.default.loadPortfolioData();e&&(e.purchaseOrdersByProject&&O(e.purchaseOrdersByProject),e.risksByProject&&D(e.risksByProject),e.tasksByProject&&_(e.tasksByProject),e.advancesByProject&&M(e.advancesByProject),e.invoicesByProject&&L(e.invoicesByProject),e.contractsByProject&&B(e.contractsByProject))}catch(e){console.error("\u274c Error recargando datos del proyecto:",e)}})()},[o,X,f]),(0,a.useEffect)(()=>{const e=e=>{const{data:t}=e.detail;t.projects&&i(t.projects),t.currentProjectId&&l(t.currentProjectId),t.tasksByProject&&_(t.tasksByProject),t.risksByProject&&D(t.risksByProject),t.purchaseOrdersByProject&&O(t.purchaseOrdersByProject),t.advancesByProject&&M(t.advancesByProject),t.invoicesByProject&&L(t.invoicesByProject),t.contractsByProject&&B(t.contractsByProject),t.globalResources&&q(t.globalResources),t.resourceAssignmentsByProject&&K(t.resourceAssignmentsByProject),t.auditLogsByProject&&J(t.auditLogsByProject)},t=e=>{const{data:t}=e.detail;t.projects&&i(t.projects),t.currentProjectId&&l(t.currentProjectId),t.tasksByProject&&_(t.tasksByProject),t.risksByProject&&D(t.risksByProject),t.purchaseOrdersByProject&&O(t.purchaseOrdersByProject),t.advancesByProject&&M(t.advancesByProject),t.invoicesByProject&&L(t.invoicesByProject),t.contractsByProject&&B(t.contractsByProject),t.globalResources&&q(t.globalResources),t.resourceAssignmentsByProject&&K(t.resourceAssignmentsByProject),t.auditLogsByProject&&J(t.auditLogsByProject)},r=e=>{const{useSupabase:t}=e.detail;console.log("\ud83d\udd04 Toggle Supabase desde ProjectManagementTabs:",t),m(t)},a=e=>{const{action:t}=e.detail;console.log("\ud83d\udd10 Solicitud de autenticaci\xf3n Supabase:",t),"activate"===t&&(Nt.default.isAuthenticated()?(console.log("\u2705 Ya est\xe1 autenticado, activando Supabase..."),m(!0),alert("\u2705 Supabase activado\n\nLos datos se sincronizar\xe1n autom\xe1ticamente con la base de datos en la nube.")):(console.log("\ud83d\udd10 No est\xe1 autenticado, mostrando modal..."),b(!0)))};return window.addEventListener("dataRestore",e),window.addEventListener("dataImport",t),window.addEventListener("toggleSupabase",r),window.addEventListener("requestSupabaseAuth",a),()=>{window.removeEventListener("dataRestore",e),window.removeEventListener("dataImport",t),window.removeEventListener("toggleSupabase",r),window.removeEventListener("requestSupabaseAuth",a)}},[]);const Z=(0,a.useRef)(null),ee=(0,a.useRef)(null),te=(0,a.useRef)(!1),re=(0,a.useCallback)(e=>{if(Z.current&&clearTimeout(Z.current),t=e,(r=ee.current)&&!["projects","currentProjectId","tasksByProject","risksByProject","globalResources","purchaseOrdersByProject","advancesByProject","invoicesByProject","contractsByProject","resourceAssignmentsByProject","auditLogsByProject"].some(e=>{const a=t[e],s=r[e];if("tasksByProject"===e){if(!a||!s)return a!==s;const e=Object.values(a).reduce((e,t)=>e+((null===t||void 0===t?void 0:t.length)||0),0),t=Object.values(s).reduce((e,t)=>e+((null===t||void 0===t?void 0:t.length)||0),0);if(e!==t)return console.log("\ud83d\udcca Cambio detectado en tareas: ".concat(t," \u2192 ").concat(e)),!0;for(const r in a){const e=a[r]||[],t=s[r]||[];if(e.length!==t.length)return console.log("\ud83d\udcca Cambio en n\xfamero de tareas del proyecto ".concat(r,": ").concat(t.length," \u2192 ").concat(e.length)),!0;const n=e.map(e=>JSON.stringify({id:e.id,name:e.name,duration:e.duration,startDate:e.startDate,endDate:e.endDate,progress:e.progress,status:e.status,predecessors:e.predecessors,successors:e.successors})).sort(),i=t.map(e=>JSON.stringify({id:e.id,name:e.name,duration:e.duration,startDate:e.startDate,endDate:e.endDate,progress:e.progress,status:e.status,predecessors:e.predecessors,successors:e.successors})).sort();if(JSON.stringify(n)!==JSON.stringify(i))return console.log("\ud83d\udcca Cambio detectado en contenido de tareas del proyecto ".concat(r)),!0}return!1}return"projects"===e||"risksByProject"===e||"globalResources"===e||"purchaseOrdersByProject"===e||"advancesByProject"===e||"invoicesByProject"===e||"contractsByProject"===e||"resourceAssignmentsByProject"===e||"auditLogsByProject"===e?JSON.stringify(a)!==JSON.stringify(s):a!==s}))return void console.log("\u23ed\ufe0f Datos sin cambios, omitiendo guardado");var t,r;if(te.current)return void console.log("\u23f3 Ya hay un guardado en progreso, omitiendo");const a=e.tasksByProject||{},s=Object.values(a).reduce((e,t)=>e+((null===t||void 0===t?void 0:t.length)||0),0),n=Object.keys(a).length,i=n>0?s/n:0;if(s>1e3&&i>800)return console.error("\ud83d\udea8 ALERTA: Posible duplicaci\xf3n masiva detectada:"),console.error("  \u2022 Total tareas: ".concat(s)),console.error("  \u2022 Proyectos: ".concat(n)),console.error("  \u2022 Promedio por proyecto: ".concat(i.toFixed(1))),void console.error("  \u2022 Cancelando guardado por seguridad");s>500&&console.log("\ud83d\udcca Proyecto grande detectado: ".concat(s," tareas en ").concat(n," proyectos (promedio: ").concat(i.toFixed(1)," tareas/proyecto)")),Z.current=setTimeout(async()=>{try{if(te.current=!0,console.log("\ud83d\udcbe Guardando datos con throttling..."),f&&Nt.default.isAuthenticated()){console.log("\ud83d\udcbe Guardando en Supabase...");if(!await Nt.default.savePortfolioData(e))throw new Error("Error guardando en Supabase");console.log("\u2705 Datos guardados en Supabase")}else{try{localStorage.setItem("mi-dashboard-portfolio",JSON.stringify(e)),console.log("\u2705 Datos guardados en localStorage")}catch(t){throw console.error("\u274c Error guardando en localStorage:",t),"QuotaExceededError"===t.name&&console.log("\ud83e\uddf9 Espacio insuficiente, limpiando datos antiguos..."),t}let r=3;for(;r>0;)try{await lN.saveData(e);break}catch(t){if(r--,0===r)throw t;console.log("\ud83d\udd04 Reintentando guardado... (".concat(r," intentos restantes)")),await new Promise(e=>setTimeout(e,1e3))}}if(ee.current=e,console.log("\u2705 Datos guardados exitosamente"),X){const e=new CustomEvent("dataSync",{detail:{type:"portfolio_data_saved",timestamp:(new Date).toISOString(),source:"throttled_save"}});window.dispatchEvent(e)}}catch(t){console.error("\u274c Error guardando datos:",t)}finally{te.current=!1}},1e3)},[X]);(0,a.useEffect)(()=>{if(!X)return void console.log("\u23f3 Esperando a que se carguen los datos iniciales...");console.log("\ud83d\udd04 useEffect GUARDADO - EJECUT\xc1NDOSE:",{tasksByProjectKeys:Object.keys(v),tasksForCurrentProject:v[o]?v[o].length:"UNDEFINED",currentProjectId:o,totalTasks:Object.values(v).reduce((e,t)=>e+((null===t||void 0===t?void 0:t.length)||0),0)});const e={projects:s,currentProjectId:o,tasksByProject:v,includeWeekendsByProject:w,risksByProject:A,purchaseOrdersByProject:I,advancesByProject:R,invoicesByProject:F,contractsByProject:z,globalResources:G,resourceAssignmentsByProject:$,auditLogsByProject:Y,timestamp:(new Date).toISOString()};re(e)},[s,o,v,w,A,I,R,F,z,G,$,Y,X]),(0,a.useEffect)(()=>()=>{Z.current&&clearTimeout(Z.current)},[]),(0,a.useEffect)(()=>{if(!X||!v)return;console.log("\ud83d\udd04 ACTUALIZANDO PROGRESO AUTOM\xc1TICO DE PROYECTOS");let e=!1;const t=[];s.forEach(r=>{if("active"===r.status){const a=ae(r.id);a!==r.progress&&(console.log("\ud83d\udcca Actualizando progreso del proyecto ".concat(r.name,": ").concat(r.progress,"% \u2192 ").concat(a,"%")),t.push({id:r.id,progress:a}),e=!0)}}),e&&i(e=>e.map(e=>{const r=t.find(t=>t.id===e.id);return r?(0,n.A)((0,n.A)({},e),{},{progress:r.progress,updatedAt:(new Date).toISOString()}):e}))},[v,X]);const ae=e=>{const t=v[e]||[];if(0===t.length)return 0;const r=t.filter(e=>!e.isMilestone);if(0===r.length)return 0;const a=r.reduce((e,t)=>e+(t.progress||0),0),s=Math.round(a/r.length);return console.log("\ud83d\udd04 C\xc1LCULO PROGRESO AUTOM\xc1TICO:",{projectId:e,totalTasks:t.length,regularTasks:r.length,totalProgress:a,averageProgress:s,tasksDetails:r.map(e=>({name:e.name,progress:e.progress,isMilestone:e.isMilestone}))}),Math.min(100,Math.max(0,s))},se=(0,a.useMemo)(()=>{const e=s.length,t=s.filter(e=>"active"===e.status).length,r=s.filter(e=>"completed"===e.status).length,a=s.reduce((e,t)=>e+(t.budget||0),0),n=s.reduce((e,t)=>e+(t.progress||0),0),i=e>0?n/e:0;return{totalProjects:e,activeProjects:t,completedProjects:r,totalBudget:a,averageProgress:i,healthScore:i>80?"excellent":i>60?"good":"needs_attention"}},[s]),[ne,ie]=(0,a.useState)(""),[oe,le]=(0,a.useState)("all"),[ce,de]=(0,a.useState)(!1),[ue,he]=(0,a.useState)(!1),[fe,me]=(0,a.useState)((new Date).toISOString().split("T")[0]),[pe,ge]=(0,a.useState)(!1),[xe,be]=(0,a.useState)("portfolio"),[ve,ye]=(0,a.useState)(!1),[we,je]=(0,a.useState)(!1),[Ne,ke]=(0,a.useState)(!1),[Se,Ee]=(0,a.useState)(!1),[Te,_e]=(0,a.useState)(null),[Ce,Ae]=(0,a.useState)(null),[De,Pe]=(0,a.useState)(null),Ie=s.find(e=>e.id===o);return(0,bt.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[x&&(0,bt.jsx)(aN,{onAuthSuccess:async e=>{console.log("\u2705 Usuario autenticado:",e),m(!0),b(!1);const t=await Nt.default.loadPortfolioData();t&&(t.projects&&Array.isArray(t.projects)&&t.projects.length>0&&i(t.projects),t.currentProjectId&&l(t.currentProjectId),t.tasksByProject&&_(t.tasksByProject),t.risksByProject&&D(t.risksByProject),t.globalResources&&q(t.globalResources))},onAuthCancel:()=>{console.log("\u274c Usuario cancel\xf3 autenticaci\xf3n, usando modo local"),b(!1),m(!1)}}),(0,bt.jsx)(Xj,{useSupabase:f,supabaseInitialized:p,isAuthenticated:Nt.default.isAuthenticated()}),!f&&p&&(0,bt.jsx)("div",{className:"fixed top-20 right-4 z-40",children:(0,bt.jsx)("button",{onClick:()=>b(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg shadow-lg hover:bg-blue-700 transition-colors",children:"\u2601\ufe0f Conectar con la Nube"})}),(0,bt.jsx)(rN,{}),(0,bt.jsx)(Qj,{onRestoreData:e=>{try{e.projects&&i(e.projects),e.currentProjectId&&l(e.currentProjectId),e.tasksByProject&&_(e.tasksByProject),e.includeWeekendsByProject&&j(e.includeWeekendsByProject),e.risksByProject&&D(e.risksByProject),e.purchaseOrdersByProject&&O(e.purchaseOrdersByProject),e.advancesByProject&&M(e.advancesByProject),e.invoicesByProject&&L(e.invoicesByProject),e.contractsByProject&&B(e.contractsByProject),e.globalResources&&q(e.globalResources),e.resourceAssignmentsByProject&&K(e.resourceAssignmentsByProject),e.auditLogsByProject&&J(e.auditLogsByProject);const t=new CustomEvent("dataSync",{detail:{type:"data_imported",timestamp:(new Date).toISOString()}});return window.dispatchEvent(t),!0}catch(t){return console.error("Error al importar datos:",t),!1}}}),(0,bt.jsxs)("div",{className:"flex",children:[(0,bt.jsx)(St,{activeSection:xe,onSectionChange:e=>{be(e),ye(!0)},projects:s,currentProjectId:o,workPackages:[],risks:P(),isCollapsed:ve,onToggleCollapse:()=>ye(!ve)}),(0,bt.jsx)("main",{className:"flex-1 transition-all duration-300 ".concat(ve?"ml-16":"ml-80 lg:ml-72"),children:(0,bt.jsxs)("div",{className:"transition-all duration-300 ".concat(ve?"p-4":"p-6"),children:["executive"===xe&&(0,bt.jsx)(_w,{projects:s,portfolioMetrics:se,workPackages:[],risks:Object.values(A).flat(),purchaseOrders:Object.values(I).flat(),advances:Object.values(R).flat(),invoices:Object.values(F).flat(),tasksByProject:v,purchaseOrdersByProject:I,advancesByProject:R,invoicesByProject:F}),"user-management"===xe&&(0,bt.jsx)(nN,{currentProject:Ie,useSupabase:f,projects:s}),"portfolio"===xe&&(0,bt.jsx)(Mw,{projects:s,currentProjectId:o,setCurrentProjectId:l,workPackages:[],risks:P(),globalResources:G,setGlobalResources:q,createProject:e=>{const t={id:"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}),name:e.name,description:e.description,startDate:e.startDate,endDate:e.endDate,budget:e.budget,status:e.status,priority:e.priority,manager:e.manager,sponsor:e.sponsor||"",objective:e.objective||"",businessCase:e.businessCase||"",irr:e.irr||0,roi:e.roi||0,contingencyReserve:e.contingencyReserve||0,managementReserve:e.managementReserve||0,kickoffDate:e.kickoffDate||"",stakeholders:e.stakeholders||[],team:e.team||[],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),version:"1.0.0",progress:0};return i(e=>{const r=e.slice();return r.push(t),r}),y(e=>{const r=Object.assign({},e);return r[t.id]=[],r}),j(e=>{const r=Object.assign({},e);return r[t.id]=!1,r}),D(e=>{const r=Object.assign({},e);return r[t.id]=[],r}),t},updateProject:(e,t)=>{const r=void 0!==t.progress?t.progress:ae(e);i(a=>a.map(a=>a.id===e?{id:a.id,name:t.name||a.name,description:t.description||a.description,startDate:t.startDate||a.startDate,endDate:t.endDate||a.endDate,budget:t.budget||a.budget,status:t.status||a.status,priority:t.priority||a.priority,manager:t.manager||a.manager,sponsor:t.sponsor||a.sponsor,irr:void 0!==t.irr?t.irr:a.irr,objective:t.objective||a.objective,businessCase:t.businessCase||a.businessCase,team:t.team||a.team,createdAt:a.createdAt,updatedAt:(new Date).toISOString(),version:a.version,progress:r}:a))},deleteProject:async e=>{if(f&&Nt.default.isAuthenticated()){console.log("\ud83d\uddd1\ufe0f Eliminando proyecto ".concat(e," de Supabase..."));await Nt.default.deleteProject(e)?console.log("\u2705 Proyecto ".concat(e," eliminado de Supabase")):console.warn("\u26a0\ufe0f Error eliminando proyecto ".concat(e," de Supabase"))}i(t=>t.filter(t=>t.id!==e)),y(t=>{const r=Object.assign({},t);return delete r[e],r}),D(t=>{const r=Object.assign({},t);return delete r[e],r})},tasks:N(),purchaseOrders:U(),advances:W(),invoices:H(),contracts:V(),auditLogs:Y[o]||[]}),"project-management"===xe&&(0,bt.jsx)(Jj,{projects:s,currentProjectId:o,setCurrentProjectId:l,workPackages:[],setWorkPackages:()=>{},risks:P(),setRisks:e=>{if("function"===typeof e){const t=P(),r=e(t);D(e=>{const t=Object.assign({},e);return t[o]=r,t})}else D(t=>{const r=Object.assign({},t);return r[o]=e,r})},reportingDate:fe,setReportingDate:me,tasks:N(),setTasks:e=>{if("function"===typeof e){const t=e(N());C(t)}else C(e)},importTasks:e=>{var t;console.log("\ud83d\udcca importTasksToCurrentProject - REEMPLAZO COMPLETO DE CRONOGRAMA:",{currentProjectId:o,currentTasksCount:(null===(t=N())||void 0===t?void 0:t.length)||0,newTasksLength:null===e||void 0===e?void 0:e.length}),console.log("\ud83d\udd04 REEMPLAZANDO CRONOGRAMA COMPLETO - Tareas anteriores ser\xe1n eliminadas"),C(e,!0),console.log("\u2705 CRONOGRAMA REEMPLAZADO EXITOSAMENTE")},includeWeekends:w[o]||!1,setIncludeWeekends:e=>{j(t=>{const r=Object.assign({},t);return r[o]=e,r})},purchaseOrders:U(),setPurchaseOrders:e=>{const t=Array.isArray(e)?e:[];console.log("\ud83d\udcbe ACTUALIZANDO \xd3RDENES DE COMPRA:",{currentProjectId:o,newPurchaseOrdersType:typeof e,newPurchaseOrdersIsArray:Array.isArray(e),newPurchaseOrdersLength:t.length,newPurchaseOrders:t}),O(e=>{const r=Object.assign({},e);return r[o]=t,r})},advances:W(),setAdvances:e=>{const t=Array.isArray(e)?e:[];console.log("\ud83d\udcbe ACTUALIZANDO ANTICIPOS:",{currentProjectId:o,newAdvancesType:typeof e,newAdvancesIsArray:Array.isArray(e),newAdvancesLength:t.length}),M(e=>{const r=Object.assign({},e);return r[o]=t,r})},invoices:H(),setInvoices:e=>{const t=Array.isArray(e)?e:[];console.log("\ud83d\udcbe ACTUALIZANDO FACTURAS:",{currentProjectId:o,newInvoicesType:typeof e,newInvoicesIsArray:Array.isArray(e),newInvoicesLength:t.length}),L(e=>{const r=Object.assign({},e);return r[o]=t,r})},contracts:V(),setContracts:e=>{const t=Array.isArray(e)?e:[];console.log("\ud83d\udcbe ACTUALIZANDO CONTRATOS:",{currentProjectId:o,newContractsType:typeof e,newContractsIsArray:Array.isArray(e),newContractsLength:t.length}),B(e=>{const r=Object.assign({},e);return r[o]=t,r})},resourceAssignments:$[o]||[],useSupabase:f}),"organization-members"===xe&&(0,bt.jsx)(sN,{currentProject:Ie,useSupabase:f,onMemberAdded:()=>{console.log("\u2705 Nuevo miembro agregado a la organizaci\xf3n")}})]})})]})]})}function pN(){const{showSplash:e,completeSplash:t,isAuthenticated:r}=wt();return e?(0,bt.jsx)(iN,{onComplete:t}):(0,bt.jsx)(mN,{})}const gN=function(){return(0,bt.jsx)(lt,{children:(0,bt.jsx)(jt,{children:(0,bt.jsx)(fN,{children:(0,bt.jsx)(pN,{})})})})},xN=e=>{e&&e instanceof Function&&r.e(206).then(r.bind(r,206)).then(t=>{let{getCLS:r,getFID:a,getFCP:s,getLCP:n,getTTFB:i}=t;r(e),a(e),s(e),n(e),i(e)})};window.supabaseService=Nt.default,window.debugAppState=()=>{var e,t;console.log("=== DEBUG APP STATE ==="),console.log("Supabase service:",window.supabaseService),console.log("Current user:",null===(e=window.supabaseService)||void 0===e?void 0:e.getCurrentUser()),console.log("Current organization:",null===(t=window.supabaseService)||void 0===t?void 0:t.getCurrentOrganization())};s.createRoot(document.getElementById("root")).render((0,bt.jsx)(a.StrictMode,{children:(0,bt.jsx)(gN,{})})),xN()})();