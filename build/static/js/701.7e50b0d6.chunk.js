"use strict";(self.webpackChunkmi_dashboard=self.webpackChunkmi_dashboard||[]).push([[701],{701:(e,s,t)=>{t.r(s),t.d(s,{default:()=>o});var a=t(9379),l=t(5452),r=t(5043),d=t(9543),i=t(6877),n=t(8625),c=t(579);const o=e=>{let{workPackages:s,setWorkPackages:o,currentProject:x,risks:m=[],scheduleData:u=null,includeWeekends:p=!1,purchaseOrders:h=[],setPurchaseOrders:v,advances:g=[],setAdvances:b,invoices:j=[],setInvoices:N,contracts:f=[],setContracts:y,useSupabase:w=!1}=e;const[A,C]=(0,r.useState)(!1),[E,D]=(0,r.useState)(!1),[V,I]=(0,r.useState)(!1),[k,P]=(0,r.useState)(null),[F,R]=(0,r.useState)(null),[S,O]=(0,r.useState)(null),[T,M]=(0,r.useState)(!1),[B,K]=(0,r.useState)(null),[$,L]=(0,r.useState)(!1),{logFinancialEvent:q}=(0,d.A)(null===x||void 0===x?void 0:x.id,w);(0,r.useEffect)(()=>{(async()=>{if(w&&null!==x&&void 0!==x&&x.organizationId)try{const e=await i.A.canEdit(x.organizationId);L(!e.allowed),e.allowed||l.vF.warn("[READ-ONLY MODE] Edici\xf3n financiera deshabilitada:",e.message)}catch(e){l.vF.error("[READ-ONLY MODE] Error verificando permisos:",e),L(!1)}})()},[w,null===x||void 0===x?void 0:x.organizationId]);r.useEffect(()=>{u&&(e=>{if(!e||!e.tasks)return;l.vF.debug("\ud83d\udd04 Sincronizando m\xe9tricas financieras con cronograma...");const t=s.map(s=>{const t=e.tasks.find(e=>e.workPackageId===s.id);return t?{id:s.id,name:s.name,description:s.description,budget:s.budget,actualCost:s.actualCost,priority:s.priority,percentComplete:t.progress||s.percentComplete,plannedValue:s.plannedValue,earnedValue:t.progress?s.plannedValue*t.progress/100:s.earnedValue,resources:s.resources,startDate:t.startDate||s.startDate,endDate:t.endDate||s.endDate,status:t.status||s.status}:s});o(t),l.vF.debug("\u2705 Work packages actualizados desde cronograma")})(u)},[u]);const G=()=>{if(!m||!Array.isArray(m))return.05*((null===x||void 0===x?void 0:x.budget)||0);const e=m.filter(e=>"active"===e.status);if(0===e.length)return.05*((null===x||void 0===x?void 0:x.budget)||0);return.05*((null===x||void 0===x?void 0:x.budget)||0)+e.reduce((e,s)=>e+(s.probability||0)*(s.costImpact||0)*("high"===s.priority?1.5:"medium"===s.priority?1.2:1),0)},z=()=>{if(!x)return 0;const e=x.budget||0;if(!m||!Array.isArray(m))return.1*e;const s=m.filter(e=>"active"===e.status);let t=.1*e;s.length>10?t*=1.2:s.length>5&&(t*=1.1);return s.filter(e=>"high"===e.priority).length>3&&(t*=1.15),t},X=(0,r.useMemo)(()=>{const e=Array.isArray(h)?h:[],s=Array.isArray(g)?g:[],t=Array.isArray(j)?j:[];l.vF.debug("\ud83d\udd0d FINANCIAL METRICS DEBUG:",{purchaseOrdersType:typeof h,purchaseOrdersIsArray:Array.isArray(h),purchaseOrdersLength:e.length,advancesType:typeof g,advancesIsArray:Array.isArray(g),advancesLength:s.length,invoicesType:typeof j,invoicesIsArray:Array.isArray(j),invoicesLength:t.length});const a=e.reduce((e,s)=>e+(s.totalAmount||0),0),r=s.reduce((e,s)=>e+(s.amount||0),0),d=t.reduce((e,s)=>e+(s.amount||0),0),i=t.filter(e=>"paid"===e.status).reduce((e,s)=>e+(s.amount||0),0),n=d-i,c=(null===x||void 0===x?void 0:x.budget)||0,o=d,m=i,u=a+r,p=f.reduce((e,s)=>e+(s.value||0),0),v=f.filter(e=>"active"===e.status).reduce((e,s)=>e+(s.value||0),0),b=c-m,N=o+b;return{totalPO:a,totalAdvances:r,totalInvoices:d,paidInvoices:i,pendingInvoices:n,totalContracts:p,activeContracts:v,committedBudget:a+r+v,availableBudget:c-(a+r+v),BAC:c,AC:o,EV:m,PV:u,CV:m-o,SV:m-u,CPI:o>0?m/o:1,SPI:u>0?m/u:1,ETC:b,EAC:N,VAC:c-N,TCPI:(c-m)/(c-o),percentComplete:c>0?m/c*100:0,percentSpent:c>0?o/c*100:0,contingencyReserve:G(),managementReserve:z(),totalReserves:G()+z(),totalProjectBudget:((null===x||void 0===x?void 0:x.budget)||0)+G()+z()}},[h,g,j,f,x,m]),U=(0,r.useMemo)(()=>{const e=Array.isArray(null===u||void 0===u?void 0:u.tasks)?u.tasks:[],s=e.reduce((e,s)=>e+(s.businessValue||0),0),t=(null===x||void 0===x?void 0:x.plannedValue)||0,a=Math.max(t,s),r=e.reduce((e,s)=>e+(s.businessValue||0)*((s.progress||0)/100),0),d=(0,n.g5)(t,e),i=X.AC>0?r/X.AC:0,c=X.EAC>0?(a-X.EAC)/X.EAC*100:0,o=a-r,m=a>0?r/a*100:0,p=r>0?X.AC/r:0;return l.vF.debug("\ud83d\udcca VALUE METRICS DEBUG:",{plannedBusinessValue:a,deliveredValue:r,VEI:i,projectedROI:c,valueGap:o,valueDeliveryRate:m,costToValueRatio:p}),{plannedBusinessValue:a,deliveredValue:r,VEI:i,projectedROI:c,valueGap:o,valueDeliveryRate:m,costToValueRatio:p,validation:d,totalPlannedValueFromTasks:s}},[u,x,X]),W=e=>{switch(e){case"paid":return"bg-green-100 text-green-800";case"pending":return"bg-yellow-100 text-yellow-800";case"overdue":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return(0,c.jsxs)("div",{className:"space-y-6",children:[(0,c.jsxs)("div",{className:"bg-gradient-to-r from-green-50 to-emerald-100 rounded-2xl shadow-lg p-6 text-gray-800 relative overflow-hidden",children:[(0,c.jsx)("div",{className:"absolute top-0 right-0 w-32 h-32 bg-green-100/30 rounded-full -translate-y-16 translate-x-16"}),(0,c.jsx)("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-emerald-100/30 rounded-full translate-y-12 -translate-x-12"}),(0,c.jsx)("div",{className:"relative z-10",children:(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)("div",{className:"bg-white/60 backdrop-blur rounded-2xl p-3 mr-4 shadow-sm",children:(0,c.jsx)("span",{className:"text-3xl",children:"\ud83d\udcb0"})}),(0,c.jsxs)("div",{children:[(0,c.jsx)("h1",{className:"text-4xl font-bold mb-2 text-gray-800",children:"Gesti\xf3n Financiera"}),(0,c.jsx)("p",{className:"text-gray-600 text-lg",children:"Control de costos, \xf3rdenes de compra, anticipos y facturas"})]})]}),(0,c.jsx)("div",{className:"bg-white/60 backdrop-blur rounded-2xl px-4 py-2 shadow-sm",children:(0,c.jsxs)("div",{className:"flex items-center space-x-2 text-sm",children:[(0,c.jsx)("span",{className:"text-gray-600",children:"\ud83d\udcc5 D\xedas laborables:"}),(0,c.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(p?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"),children:p?"Lunes a Domingo":"Lunes a Viernes"})]})})]})})]}),(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,c.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-blue-500",children:(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"text-xs text-gray-500 mb-1 flex items-center",children:["BAC (Presupuesto)",(0,c.jsx)("span",{className:"ml-1 text-blue-500 cursor-help",title:"Budget at Completion: Presupuesto total aprobado para el proyecto",children:"\u2753"})]}),(0,c.jsxs)("div",{className:"text-2xl font-bold text-blue-600",children:["$",(X.BAC/1e3).toFixed(0),"K"]})]}),(0,c.jsx)("div",{className:"text-blue-500 text-2xl",children:"\ud83d\udcb0"})]})}),(0,c.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-green-500",children:(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"text-xs text-gray-500 mb-1 flex items-center",children:["EV (Valor Ganado)",(0,c.jsx)("span",{className:"ml-1 text-green-500 cursor-help",title:"Earned Value: Valor del trabajo realmente completado",children:"\u2753"})]}),(0,c.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:["$",(X.EV/1e3).toFixed(0),"K"]})]}),(0,c.jsx)("div",{className:"text-green-500 text-2xl",children:"\ud83d\udcc8"})]})}),(0,c.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-yellow-500",children:(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"text-xs text-gray-500 mb-1 flex items-center",children:["AC (Costo Real)",(0,c.jsx)("span",{className:"ml-1 text-yellow-500 cursor-help",title:"Actual Cost: Costo real incurrido hasta la fecha",children:"\u2753"})]}),(0,c.jsxs)("div",{className:"text-2xl font-bold text-yellow-600",children:["$",(X.AC/1e3).toFixed(0),"K"]})]}),(0,c.jsx)("div",{className:"text-yellow-500 text-2xl",children:"\ud83d\udcb8"})]})}),(0,c.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-purple-500",children:(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"text-xs text-gray-500 mb-1 flex items-center",children:["EAC (Estimaci\xf3n Final)",(0,c.jsx)("span",{className:"ml-1 text-purple-500 cursor-help",title:"Estimate at Completion: Estimaci\xf3n del costo total al terminar",children:"\u2753"})]}),(0,c.jsxs)("div",{className:"text-2xl font-bold text-purple-600",children:["$",(X.EAC/1e3).toFixed(0),"K"]})]}),(0,c.jsx)("div",{className:"text-purple-500 text-2xl",children:"\ud83c\udfaf"})]})})]}),(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,c.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-blue-500",children:(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"text-xs text-gray-500 mb-1 flex items-center",children:["CPI",(0,c.jsx)("span",{className:"ml-1 text-blue-500 cursor-help",title:"Cost Performance Index: EV/AC",children:"\u2753"})]}),(0,c.jsx)("div",{className:"text-2xl font-bold ".concat(X.CPI>=1?"text-green-600":"text-red-600"),children:X.CPI.toFixed(2)}),(0,c.jsx)("div",{className:"text-xs text-gray-600",children:"Cost Performance"})]}),(0,c.jsx)("div",{className:"text-blue-500 text-2xl",children:"\ud83d\udcca"})]})}),(0,c.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-orange-500",children:(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"text-xs text-gray-500 mb-1 flex items-center",children:["SPI",(0,c.jsx)("span",{className:"ml-1 text-orange-500 cursor-help",title:"Schedule Performance Index: EV/PV",children:"\u2753"})]}),(0,c.jsx)("div",{className:"text-2xl font-bold ".concat(X.SPI>=1?"text-green-600":"text-red-600"),children:X.SPI.toFixed(2)}),(0,c.jsx)("div",{className:"text-xs text-gray-600",children:"Schedule Performance"})]}),(0,c.jsx)("div",{className:"text-orange-500 text-2xl",children:"\u23f1\ufe0f"})]})}),(0,c.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-red-500",children:(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"text-xs text-gray-500 mb-1 flex items-center",children:["VAC",(0,c.jsx)("span",{className:"ml-1 text-red-500 cursor-help",title:"Variance at Completion: BAC-EAC",children:"\u2753"})]}),(0,c.jsxs)("div",{className:"text-2xl font-bold ".concat(X.VAC>=0?"text-green-600":"text-red-600"),children:["$",(X.VAC/1e3).toFixed(0),"K"]}),(0,c.jsx)("div",{className:"text-xs text-gray-600",children:"Variance at Completion"})]}),(0,c.jsx)("div",{className:"text-red-500 text-2xl",children:"\ud83d\udcc9"})]})}),(0,c.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-teal-500",children:(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"text-xs text-gray-500 mb-1 flex items-center",children:["TCPI",(0,c.jsx)("span",{className:"ml-1 text-teal-500 cursor-help",title:"To Complete Performance Index",children:"\u2753"})]}),(0,c.jsx)("div",{className:"text-2xl font-bold text-gray-800",children:X.TCPI.toFixed(2)}),(0,c.jsx)("div",{className:"text-xs text-gray-600",children:"To Complete Performance"})]}),(0,c.jsx)("div",{className:"text-teal-500 text-2xl",children:"\ud83c\udfaf"})]})})]}),(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,c.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-purple-500",children:(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"text-xs text-gray-500 mb-1 flex items-center",children:["Contratos Activos",(0,c.jsx)("span",{className:"ml-1 text-purple-500 cursor-help",title:"Valor total de contratos activos",children:"\u2753"})]}),(0,c.jsxs)("div",{className:"text-2xl font-bold text-gray-800",children:["$",(X.activeContracts/1e3).toFixed(0),"K"]}),(0,c.jsx)("div",{className:"text-xs text-gray-600",children:"Valor total"})]}),(0,c.jsx)("div",{className:"text-purple-500 text-2xl",children:"\ud83d\udccb"})]})}),(0,c.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-green-500",children:(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"text-xs text-gray-500 mb-1 flex items-center",children:["% Completado",(0,c.jsx)("span",{className:"ml-1 text-green-500 cursor-help",title:"Porcentaje de trabajo completado",children:"\u2753"})]}),(0,c.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:[X.percentComplete.toFixed(1),"%"]}),(0,c.jsx)("div",{className:"text-xs text-gray-600",children:"Progreso del proyecto"})]}),(0,c.jsx)("div",{className:"text-green-500 text-2xl",children:"\ud83d\udcc8"})]})}),(0,c.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 border-l-4 border-orange-500",children:(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"text-xs text-gray-500 mb-1 flex items-center",children:["% Gastado",(0,c.jsx)("span",{className:"ml-1 text-orange-500 cursor-help",title:"Porcentaje del presupuesto utilizado",children:"\u2753"})]}),(0,c.jsxs)("div",{className:"text-2xl font-bold text-gray-800",children:[X.percentSpent.toFixed(1),"%"]}),(0,c.jsx)("div",{className:"text-xs text-gray-600",children:"Presupuesto utilizado"})]}),(0,c.jsx)("div",{className:"text-orange-500 text-2xl",children:"\ud83d\udcb8"})]})})]}),(0,c.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[(0,c.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,c.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"\ud83d\udee1\ufe0f Reservas y Contingencias"}),(0,c.jsx)("span",{className:"text-sm text-gray-500",children:"Basado en an\xe1lisis de riesgos"})]}),(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,c.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"text-xs text-gray-500 mb-1 flex items-center",children:["Presupuesto Base",(0,c.jsx)("span",{className:"ml-1 text-gray-500 cursor-help",title:"Presupuesto inicial aprobado del proyecto",children:"\u2753"})]}),(0,c.jsxs)("div",{className:"text-2xl font-bold text-gray-800",children:["$",(((null===x||void 0===x?void 0:x.budget)||0)/1e3).toFixed(0),"K"]})]}),(0,c.jsx)("div",{className:"text-gray-500 text-2xl",children:"\ud83d\udcb0"})]})}),(0,c.jsx)("div",{className:"bg-blue-50 rounded-lg p-4",children:(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"text-xs text-gray-500 mb-1 flex items-center",children:["Reserva de Contingencia",(0,c.jsx)("span",{className:"ml-1 text-blue-500 cursor-help",title:"Reserva para riesgos identificados. F\xf3rmula: 5% base + impacto esperado de riesgos activos",children:"\u2753"})]}),(0,c.jsxs)("div",{className:"text-2xl font-bold text-blue-800",children:["$",(X.contingencyReserve/1e3).toFixed(0),"K"]})]}),(0,c.jsx)("div",{className:"text-blue-500 text-2xl",children:"\ud83d\udee1\ufe0f"})]})}),(0,c.jsx)("div",{className:"bg-green-50 rounded-lg p-4",children:(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"text-xs text-gray-500 mb-1 flex items-center",children:["Reserva de Gesti\xf3n",(0,c.jsx)("span",{className:"ml-1 text-green-500 cursor-help",title:"Reserva para riesgos no identificados. F\xf3rmula: 10% base + ajustes por complejidad",children:"\u2753"})]}),(0,c.jsxs)("div",{className:"text-2xl font-bold text-green-800",children:["$",(X.managementReserve/1e3).toFixed(0),"K"]})]}),(0,c.jsx)("div",{className:"text-green-500 text-2xl",children:"\ud83d\udcca"})]})}),(0,c.jsx)("div",{className:"bg-purple-50 rounded-lg p-4",children:(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"text-xs text-gray-500 mb-1 flex items-center",children:["Presupuesto Total",(0,c.jsx)("span",{className:"ml-1 text-purple-500 cursor-help",title:"Presupuesto base + reservas de contingencia y gesti\xf3n",children:"\u2753"})]}),(0,c.jsxs)("div",{className:"text-2xl font-bold text-purple-800",children:["$",(X.totalProjectBudget/1e3).toFixed(0),"K"]})]}),(0,c.jsx)("div",{className:"text-purple-500 text-2xl",children:"\ud83c\udfaf"})]})})]}),(0,c.jsxs)("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:[(0,c.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"\ud83d\udccb Detalles del C\xe1lculo"}),(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-xs text-gray-600",children:[(0,c.jsxs)("div",{children:[(0,c.jsxs)("p",{children:[(0,c.jsx)("strong",{children:"Reserva de Contingencia:"})," 5% del presupuesto base + impacto esperado de riesgos activos"]}),(0,c.jsxs)("p",{children:[(0,c.jsx)("strong",{children:"Riesgos Activos:"})," ",(null===m||void 0===m?void 0:m.filter(e=>"active"===e.status).length)||0," identificados"]})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)("p",{children:[(0,c.jsx)("strong",{children:"Reserva de Gesti\xf3n:"})," 10% del presupuesto base + ajustes por complejidad"]}),(0,c.jsxs)("p",{children:[(0,c.jsx)("strong",{children:"Riesgos de Alta Prioridad:"})," ",(null===m||void 0===m?void 0:m.filter(e=>"active"===e.status&&"high"===e.priority).length)||0," identificados"]})]})]})]})]}),(0,c.jsxs)("div",{className:"bg-gradient-to-r from-indigo-50 via-purple-50 to-pink-50 rounded-2xl shadow-lg p-6 mb-6 border-l-4 border-indigo-500",children:[(0,c.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)("div",{className:"bg-white/60 backdrop-blur rounded-xl p-2 mr-3",children:(0,c.jsx)("span",{className:"text-2xl",children:"\ud83c\udfaf"})}),(0,c.jsxs)("div",{children:[(0,c.jsx)("h3",{className:"text-xl font-bold text-gray-800",children:"Entrega de Valor (PMBOK 7)"}),(0,c.jsx)("p",{className:"text-sm text-gray-600",children:"Alineaci\xf3n con Principio 4: Focus on Value"})]})]}),(0,c.jsx)("div",{className:"bg-white/60 backdrop-blur rounded-lg px-3 py-1",children:(0,c.jsx)("span",{className:"text-xs font-medium text-indigo-700",children:"Value-Driven PM"})})]}),U.validation&&!U.validation.isValid&&(0,c.jsx)("div",{className:"mb-4 bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-lg",children:(0,c.jsxs)("div",{className:"flex items-start",children:[(0,c.jsx)("div",{className:"flex-shrink-0",children:(0,c.jsx)("span",{className:"text-2xl",children:"\u26a0\ufe0f"})}),(0,c.jsxs)("div",{className:"ml-3 flex-1",children:[(0,c.jsx)("h3",{className:"text-sm font-medium text-yellow-800",children:"Discrepancia en Valor Planificado"}),(0,c.jsxs)("div",{className:"mt-2 text-sm text-yellow-700",children:[(0,c.jsxs)("p",{children:["El ",(0,c.jsx)("strong",{children:"Valor Planificado del Proyecto"})," ($",(U.validation.plannedValue/1e3).toFixed(0),"K)"," ","difiere de la ",(0,c.jsx)("strong",{children:"suma de valores de tareas"})," ($",(U.validation.totalTasksValue/1e3).toFixed(0),"K)"," ","en un ",(0,c.jsxs)("strong",{children:[Math.abs(U.validation.percentageDiff).toFixed(1),"%"]}),"."]}),(0,c.jsxs)("p",{className:"mt-1",children:["\ud83d\udca1 ",(0,c.jsx)("em",{children:"Sugerencia: Recalcula los valores de negocio de las tareas en el Cronograma para que la suma coincida con el Valor Planificado."})]})]})]})]})}),(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[(0,c.jsx)("div",{className:"bg-white/80 backdrop-blur rounded-lg p-4 shadow-sm",children:(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{className:"flex-1",children:[(0,c.jsxs)("div",{className:"text-xs text-gray-500 mb-1 flex items-center",children:["Valor Planificado",(0,c.jsx)("span",{className:"ml-1 text-blue-500 cursor-help",title:"Valor de negocio total esperado del proyecto al completarse",children:"\u2753"})]}),(0,c.jsxs)("div",{className:"text-2xl font-bold text-blue-800",children:["$",(U.plannedBusinessValue/1e3).toFixed(0),"K"]}),(0,c.jsx)("div",{className:"text-xs text-gray-600 mt-1",children:"Meta del proyecto"})]}),(0,c.jsx)("div",{className:"text-blue-500 text-2xl",children:"\ud83d\udcca"})]})}),(0,c.jsx)("div",{className:"bg-white/80 backdrop-blur rounded-lg p-4 shadow-sm",children:(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{className:"flex-1",children:[(0,c.jsxs)("div",{className:"text-xs text-gray-500 mb-1 flex items-center",children:["Valor Entregado",(0,c.jsx)("span",{className:"ml-1 text-green-500 cursor-help",title:"Valor de negocio entregado hasta la fecha basado en completitud de work packages",children:"\u2753"})]}),(0,c.jsxs)("div",{className:"text-2xl font-bold text-green-800",children:["$",(U.deliveredValue/1e3).toFixed(0),"K"]}),(0,c.jsxs)("div",{className:"text-xs text-gray-600 mt-1",children:[U.valueDeliveryRate.toFixed(1),"% completado"]})]}),(0,c.jsx)("div",{className:"text-green-500 text-2xl",children:"\u2705"})]})}),(0,c.jsx)("div",{className:"bg-white/80 backdrop-blur rounded-lg p-4 shadow-sm",children:(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{className:"flex-1",children:[(0,c.jsxs)("div",{className:"text-xs text-gray-500 mb-1 flex items-center",children:["VEI (Value Efficiency)",(0,c.jsx)("span",{className:"ml-1 text-purple-500 cursor-help",title:"Value Efficiency Index: Valor Entregado \xf7 Costo Real. VEI > 1 = Eficiente. M\xe9trica PMBOK 7",children:"\u2753"})]}),(0,c.jsx)("div",{className:"text-2xl font-bold ".concat(U.VEI>=1.2?"text-green-600":U.VEI>=1?"text-blue-600":U.VEI>=.8?"text-yellow-600":"text-red-600"),children:U.VEI.toFixed(2)}),(0,c.jsx)("div",{className:"text-xs text-gray-600 mt-1",children:U.VEI>=1?"\u2705 Eficiente":"\u26a0\ufe0f Ineficiente"})]}),(0,c.jsx)("div",{className:"text-purple-500 text-2xl",children:"\u26a1"})]})}),(0,c.jsx)("div",{className:"bg-white/80 backdrop-blur rounded-lg p-4 shadow-sm",children:(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{className:"flex-1",children:[(0,c.jsxs)("div",{className:"text-xs text-gray-500 mb-1 flex items-center",children:["ROI Proyectado",(0,c.jsx)("span",{className:"ml-1 text-orange-500 cursor-help",title:"Return on Investment proyectado: (Valor Planificado - EAC) \xf7 EAC \xd7 100",children:"\u2753"})]}),(0,c.jsxs)("div",{className:"text-2xl font-bold ".concat(U.projectedROI>=20?"text-green-800":U.projectedROI>=0?"text-blue-800":"text-red-800"),children:[U.projectedROI.toFixed(1),"%"]}),(0,c.jsx)("div",{className:"text-xs text-gray-600 mt-1",children:U.projectedROI>=0?"\ud83d\udcc8 Positivo":"\ud83d\udcc9 Negativo"})]}),(0,c.jsx)("div",{className:"text-orange-500 text-2xl",children:"\ud83d\udc8e"})]})})]}),(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,c.jsx)("div",{className:"bg-white/80 backdrop-blur rounded-lg p-4 shadow-sm",children:(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{className:"flex-1",children:[(0,c.jsxs)("div",{className:"text-xs text-gray-500 mb-1 flex items-center",children:["Brecha de Valor",(0,c.jsx)("span",{className:"ml-1 text-amber-500 cursor-help",title:"Valor planificado - Valor entregado. Indica cu\xe1nto valor falta por entregar",children:"\u2753"})]}),(0,c.jsxs)("div",{className:"text-xl font-bold text-amber-800",children:["$",(U.valueGap/1e3).toFixed(0),"K"]}),(0,c.jsx)("div",{className:"text-xs text-gray-600 mt-1",children:"Pendiente por entregar"})]}),(0,c.jsx)("div",{className:"text-amber-500 text-xl",children:"\ud83d\udccf"})]})}),(0,c.jsx)("div",{className:"bg-white/80 backdrop-blur rounded-lg p-4 shadow-sm",children:(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{className:"flex-1",children:[(0,c.jsxs)("div",{className:"text-xs text-gray-500 mb-1 flex items-center",children:["Tasa de Entrega",(0,c.jsx)("span",{className:"ml-1 text-teal-500 cursor-help",title:"Porcentaje del valor planificado que ha sido entregado",children:"\u2753"})]}),(0,c.jsxs)("div",{className:"text-xl font-bold text-teal-800",children:[U.valueDeliveryRate.toFixed(1),"%"]}),(0,c.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:(0,c.jsx)("div",{className:"bg-teal-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(Math.min(U.valueDeliveryRate,100),"%")}})})]}),(0,c.jsx)("div",{className:"text-teal-500 text-xl",children:"\ud83d\udcc8"})]})}),(0,c.jsx)("div",{className:"bg-white/80 backdrop-blur rounded-lg p-4 shadow-sm",children:(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{className:"flex-1",children:[(0,c.jsxs)("div",{className:"text-xs text-gray-500 mb-1 flex items-center",children:["Ratio Costo-Valor",(0,c.jsx)("span",{className:"ml-1 text-cyan-500 cursor-help",title:"Costo Real \xf7 Valor Entregado. Cu\xe1nto cuesta generar cada unidad de valor. Menor es mejor",children:"\u2753"})]}),(0,c.jsx)("div",{className:"text-xl font-bold text-cyan-800",children:U.costToValueRatio>0?U.costToValueRatio.toFixed(2):"N/A"}),(0,c.jsx)("div",{className:"text-xs text-gray-600 mt-1",children:U.costToValueRatio<1?"\u2705 Excelente":U.costToValueRatio<1.5?"\u2713 Bueno":"\u26a0\ufe0f Alto"})]}),(0,c.jsx)("div",{className:"text-cyan-500 text-xl",children:"\u2696\ufe0f"})]})})]}),(0,c.jsxs)("div",{className:"mt-4 p-4 bg-white/60 backdrop-blur rounded-lg border border-indigo-200",children:[(0,c.jsxs)("h4",{className:"text-sm font-semibold text-indigo-800 mb-2 flex items-center",children:[(0,c.jsx)("span",{className:"mr-2",children:"\ud83d\udcda"}),"Alineaci\xf3n con PMBOK 7 - Principio de Valor"]}),(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-xs text-gray-700",children:[(0,c.jsxs)("div",{children:[(0,c.jsxs)("p",{className:"mb-1",children:[(0,c.jsx)("strong",{children:"\u2713 Enfoque en Resultados:"})," Mide valor entregado, no solo tareas completadas"]}),(0,c.jsxs)("p",{className:"mb-1",children:[(0,c.jsx)("strong",{children:"\u2713 Eficiencia de Valor:"})," VEI mide cu\xe1nto valor se genera por cada unidad monetaria gastada"]})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)("p",{className:"mb-1",children:[(0,c.jsx)("strong",{children:"\u2713 ROI Transparente:"})," Visibilidad del retorno de inversi\xf3n esperado del proyecto"]}),(0,c.jsxs)("p",{className:"mb-1",children:[(0,c.jsx)("strong",{children:"\u2713 Toma de Decisiones:"})," M\xe9tricas que gu\xedan decisiones basadas en valor, no solo en costo"]})]})]})]})]}),(0,c.jsxs)("div",{className:"grid grid-cols-1 gap-6",children:[(0,c.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,c.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,c.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"\ud83d\udccb \xd3rdenes de Compra"}),(0,c.jsx)("button",{onClick:()=>{P({id:"",number:"",supplier:"",description:"",totalAmount:0,currency:"USD",status:"pending",requestDate:(new Date).toISOString().split("T")[0],approvalDate:"",expectedDate:"",projectId:(null===x||void 0===x?void 0:x.id)||""}),C(!0)},disabled:$,className:"px-3 py-1 rounded text-sm ".concat($?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),title:$?"No disponible (modo solo lectura)":"Crear nueva orden de compra",children:"+ Nueva"})]}),(0,c.jsx)("div",{className:"space-y-3",children:Array.isArray(h)&&0!==h.length?h.map(e=>{var s;return(0,c.jsx)("div",{className:"border rounded p-3",children:(0,c.jsxs)("div",{className:"flex justify-between items-start",children:[(0,c.jsxs)("div",{className:"flex-1",children:[(0,c.jsx)("div",{className:"font-medium text-sm",children:e.number}),(0,c.jsx)("div",{className:"text-xs text-gray-600",children:e.supplier}),(0,c.jsxs)("div",{className:"text-xs text-gray-600",children:["$",null===(s=e.totalAmount)||void 0===s?void 0:s.toLocaleString()]}),(0,c.jsxs)("div",{className:"flex items-center space-x-2 mt-1",children:[(0,c.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("approved"===e.status?"bg-green-100 text-green-800":"pending"===e.status?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:"approved"===e.status?"Aprobada":"pending"===e.status?"Pendiente":"Rechazada"}),"approved"===e.status&&(0,c.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(e.approvalDate&&""!==e.approvalDate.trim()?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"),children:e.approvalDate&&""!==e.approvalDate.trim()?"\u2705 ".concat(new Date(e.approvalDate+"T00:00:00").toLocaleDateString("es-ES")):"\u26a0\ufe0f Sin fecha de aprobaci\xf3n"})]})]}),(0,c.jsxs)("div",{className:"flex space-x-1",children:[(0,c.jsx)("button",{onClick:()=>{P(e),C(!0)},className:"text-blue-600 hover:text-blue-800 text-sm",children:"\u270f\ufe0f"}),(0,c.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("\xbfEst\xe1s seguro de que quieres eliminar esta orden de compra?"))try{const{default:s}=await Promise.resolve().then(t.bind(t,2416)),a=await s.deletePurchaseOrder(e);if(a.success){const s=(Array.isArray(h)?h:[]).filter(s=>s.id!==e);l.vF.debug("\ud83d\uddd1\ufe0f ELIMINANDO OC:",e,"\xd3rdenes restantes:",s.length),v(s),l.vF.debug("\u2705 Orden de compra eliminada localmente y de Supabase")}else l.vF.error("\u274c Error eliminando orden de compra de Supabase:",a.error),alert("Error eliminando la orden de compra. Int\xe9ntalo de nuevo.")}catch(s){l.vF.error("\u274c Error inesperado eliminando orden de compra:",s),alert("Error inesperado eliminando la orden de compra. Int\xe9ntalo de nuevo.")}})(e.id),className:"text-red-600 hover:text-red-800 text-sm",children:"\ud83d\uddd1\ufe0f"})]})]})},e.id)}):(0,c.jsx)("p",{className:"text-gray-500 text-sm",children:"No hay \xf3rdenes de compra"})})]}),(0,c.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,c.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,c.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"\ud83d\udcb3 Anticipos"}),(0,c.jsx)("button",{onClick:()=>{R({}),D(!0)},disabled:$,className:"px-3 py-1 rounded text-sm ".concat($?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"),title:$?"No disponible (modo solo lectura)":"Crear nuevo anticipo",children:"+ Nuevo"})]}),(0,c.jsx)("div",{className:"space-y-3",children:0===g.length?(0,c.jsx)("p",{className:"text-gray-500 text-sm",children:"No hay anticipos"}):g.map(e=>{var s;return(0,c.jsx)("div",{className:"border rounded p-3",children:(0,c.jsxs)("div",{className:"flex justify-between items-start",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{className:"font-medium text-sm",children:e.number}),(0,c.jsx)("div",{className:"text-xs text-gray-600",children:e.supplier}),(0,c.jsxs)("div",{className:"text-xs text-gray-600",children:["$",null===(s=e.amount)||void 0===s?void 0:s.toLocaleString()]})]}),(0,c.jsxs)("div",{className:"flex space-x-1",children:[(0,c.jsx)("button",{onClick:()=>{R(e),D(!0)},className:"text-blue-600 hover:text-blue-800 text-sm",children:"\u270f\ufe0f"}),(0,c.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("\xbfEst\xe1s seguro de que quieres eliminar este anticipo?"))try{const{default:s}=await Promise.resolve().then(t.bind(t,2416)),a=await s.deleteAdvance(e);if(a.success){const s=(Array.isArray(g)?g:[]).filter(s=>s.id!==e);b(s),l.vF.debug("\u2705 Anticipo eliminado localmente y de Supabase")}else l.vF.error("\u274c Error eliminando anticipo de Supabase:",a.error),alert("Error eliminando el anticipo. Int\xe9ntalo de nuevo.")}catch(s){l.vF.error("\u274c Error inesperado eliminando anticipo:",s),alert("Error inesperado eliminando el anticipo. Int\xe9ntalo de nuevo.")}})(e.id),className:"text-red-600 hover:text-red-800 text-sm",children:"\ud83d\uddd1\ufe0f"})]})]})},e.id)})})]}),(0,c.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,c.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,c.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"\ud83d\udcc4 Facturas"}),(0,c.jsx)("button",{onClick:()=>{O({}),I(!0)},disabled:$,className:"px-3 py-1 rounded text-sm ".concat($?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-purple-600 text-white hover:bg-purple-700"),title:$?"No disponible (modo solo lectura)":"Crear nueva factura",children:"+ Nueva"})]}),(0,c.jsx)("div",{className:"space-y-3",children:0===j.length?(0,c.jsx)("p",{className:"text-gray-500 text-sm",children:"No hay facturas"}):j.map(e=>{var s;return(0,c.jsx)("div",{className:"border rounded p-3",children:(0,c.jsxs)("div",{className:"flex justify-between items-start",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{className:"font-medium text-sm",children:e.number}),(0,c.jsx)("div",{className:"text-xs text-gray-600",children:e.supplier}),(0,c.jsxs)("div",{className:"text-xs text-gray-600",children:["$",null===(s=e.amount)||void 0===s?void 0:s.toLocaleString()]}),(0,c.jsx)("span",{className:"inline-block px-2 py-1 rounded-full text-xs font-medium ".concat(W(e.status)),children:e.status})]}),(0,c.jsxs)("div",{className:"flex space-x-1",children:[(0,c.jsx)("button",{onClick:()=>{O(e),I(!0)},className:"text-blue-600 hover:text-blue-800 text-sm",children:"\u270f\ufe0f"}),(0,c.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("\xbfEst\xe1s seguro de que quieres eliminar esta factura?"))try{const{default:s}=await Promise.resolve().then(t.bind(t,2416)),a=await s.deleteInvoice(e);if(a.success){const s=(Array.isArray(j)?j:[]).filter(s=>s.id!==e);N(s),l.vF.debug("\u2705 Factura eliminada localmente y de Supabase")}else l.vF.error("\u274c Error eliminando factura de Supabase:",a.error),alert("Error eliminando la factura. Int\xe9ntalo de nuevo.")}catch(s){l.vF.error("\u274c Error inesperado eliminando factura:",s),alert("Error inesperado eliminando la factura. Int\xe9ntalo de nuevo.")}})(e.id),className:"text-red-600 hover:text-red-800 text-sm",children:"\ud83d\uddd1\ufe0f"})]})]})},e.id)})})]})]}),A&&(0,c.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:(0,c.jsx)("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:(0,c.jsxs)("div",{className:"p-6",children:[(0,c.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,c.jsx)("h2",{className:"text-xl font-bold",children:null!==k&&void 0!==k&&k.id?"Editar Orden de Compra":"Nueva Orden de Compra"}),(0,c.jsx)("button",{onClick:()=>C(!1),className:"text-gray-500 hover:text-gray-700 text-xl",children:"\u2715"})]}),(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"N\xfamero de OC *"}),(0,c.jsx)("input",{type:"text",className:"w-full border rounded px-3 py-2",value:(null===k||void 0===k?void 0:k.number)||"",onChange:e=>P((0,a.A)((0,a.A)({},k),{},{number:e.target.value})),placeholder:"PO-2025-XXX"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Proveedor *"}),(0,c.jsx)("input",{type:"text",className:"w-full border rounded px-3 py-2",value:(null===k||void 0===k?void 0:k.supplier)||"",onChange:e=>P((0,a.A)((0,a.A)({},k),{},{supplier:e.target.value})),placeholder:"Nombre del proveedor"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monto Total *"}),(0,c.jsx)("input",{type:"number",className:"w-full border rounded px-3 py-2",value:(null===k||void 0===k?void 0:k.totalAmount)||"",onChange:e=>P((0,a.A)((0,a.A)({},k),{},{totalAmount:Number(e.target.value)})),min:"0",step:"0.01"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estado"}),(0,c.jsxs)("select",{className:"w-full border rounded px-3 py-2",value:(null===k||void 0===k?void 0:k.status)||"pending",onChange:e=>P((0,a.A)((0,a.A)({},k),{},{status:e.target.value})),children:[(0,c.jsx)("option",{value:"pending",children:"Pendiente"}),(0,c.jsx)("option",{value:"approved",children:"Aprobada"}),(0,c.jsx)("option",{value:"rejected",children:"Rechazada"})]})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Fecha de Aprobaci\xf3n *",(0,c.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,c.jsx)("input",{type:"date",className:"w-full border rounded px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:(null===k||void 0===k?void 0:k.approvalDate)||"",onChange:e=>P((0,a.A)((0,a.A)({},k),{},{approvalDate:e.target.value})),required:!0}),(0,c.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Fecha cuando la orden fue aprobada (usada para flujo de caja)"})]}),(0,c.jsxs)("div",{className:"md:col-span-2",children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripci\xf3n"}),(0,c.jsx)("textarea",{className:"w-full border rounded px-3 py-2",rows:"3",value:(null===k||void 0===k?void 0:k.description)||"",onChange:e=>P((0,a.A)((0,a.A)({},k),{},{description:e.target.value})),placeholder:"Descripci\xf3n de los productos/servicios"})]})]}),(0,c.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,c.jsx)("button",{onClick:()=>C(!1),className:"px-4 py-2 border border-gray-300 rounded text-gray-700 hover:bg-gray-50",children:"Cancelar"}),(0,c.jsx)("button",{onClick:()=>{if(l.vF.debug("\ud83d\udcbe GUARDANDO OC - editingPO:",k),"approved"===k.status&&(!k.approvalDate||""===k.approvalDate.trim()))return void alert("\u26a0\ufe0f Error: Las \xf3rdenes de compra aprobadas deben tener una fecha de aprobaci\xf3n para el c\xe1lculo del flujo de caja.");const e=Array.isArray(h)?h:[];if(k.id){const s=e.map(e=>e.id===k.id?k:e);l.vF.debug("\ud83d\udcdd EDITANDO OC EXISTENTE:",k.id,"Total \xf3rdenes:",s.length),v(s)}else{const s={id:Date.now().toString(),number:k.number,supplier:k.supplier,description:k.description,totalAmount:k.totalAmount,currency:k.currency||"USD",status:k.status,requestDate:k.requestDate,approvalDate:k.approvalDate,expectedDate:k.expectedDate,projectId:k.projectId},t=[...e,s];l.vF.debug("\u2795 CREANDO NUEVA OC:",s.id,"Total \xf3rdenes:",t.length),v(t),q&&x&&q("purchase-order",s,x)}C(!1),P(null)},className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Guardar"})]})]})})}),E&&(0,c.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:(0,c.jsx)("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:(0,c.jsxs)("div",{className:"p-6",children:[(0,c.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,c.jsx)("h2",{className:"text-xl font-bold",children:null!==F&&void 0!==F&&F.id?"Editar Anticipo":"Nuevo Anticipo"}),(0,c.jsx)("button",{onClick:()=>D(!1),className:"text-gray-500 hover:text-gray-700 text-xl",children:"\u2715"})]}),(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"N\xfamero de Anticipo *"}),(0,c.jsx)("input",{type:"text",className:"w-full border rounded px-3 py-2",value:(null===F||void 0===F?void 0:F.number)||"",onChange:e=>R((0,a.A)((0,a.A)({},F),{},{number:e.target.value})),placeholder:"ADV-2025-XXX"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Proveedor *"}),(0,c.jsx)("input",{type:"text",className:"w-full border rounded px-3 py-2",value:(null===F||void 0===F?void 0:F.supplier)||"",onChange:e=>R((0,a.A)((0,a.A)({},F),{},{supplier:e.target.value})),placeholder:"Nombre del proveedor"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monto *"}),(0,c.jsx)("input",{type:"number",className:"w-full border rounded px-3 py-2",value:(null===F||void 0===F?void 0:F.amount)||"",onChange:e=>R((0,a.A)((0,a.A)({},F),{},{amount:Number(e.target.value)})),min:"0",step:"0.01"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha de Pago"}),(0,c.jsx)("input",{type:"date",className:"w-full border rounded px-3 py-2",value:(null===F||void 0===F?void 0:F.paymentDate)||"",onChange:e=>R({id:F.id,number:F.number,supplier:F.supplier,amount:F.amount,description:F.description,projectId:F.projectId,paymentDate:e.target.value})})]}),(0,c.jsxs)("div",{className:"md:col-span-2",children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripci\xf3n"}),(0,c.jsx)("textarea",{className:"w-full border rounded px-3 py-2",rows:"3",value:(null===F||void 0===F?void 0:F.description)||"",onChange:e=>R({id:F.id,number:F.number,supplier:F.supplier,amount:F.amount,paymentDate:F.paymentDate,projectId:F.projectId,description:e.target.value}),placeholder:"Descripci\xf3n del anticipo"})]})]}),(0,c.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,c.jsx)("button",{onClick:()=>D(!1),className:"px-4 py-2 border border-gray-300 rounded text-gray-700 hover:bg-gray-50",children:"Cancelar"}),(0,c.jsx)("button",{onClick:()=>{const e=Array.isArray(g)?g:[];if(F.id){const s=e.map(e=>e.id===F.id?F:e);b(s)}else{const s={id:Date.now().toString(),number:F.number,supplier:F.supplier,amount:F.amount,paymentDate:F.paymentDate,description:F.description,projectId:F.projectId},t=[...e,s];b(t),q&&x&&q("advance",s,x)}D(!1),R(null)},className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:"Guardar"})]})]})})}),V&&(0,c.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:(0,c.jsx)("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:(0,c.jsxs)("div",{className:"p-6",children:[(0,c.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,c.jsx)("h2",{className:"text-xl font-bold",children:null!==S&&void 0!==S&&S.id?"Editar Factura":"Nueva Factura"}),(0,c.jsx)("button",{onClick:()=>I(!1),className:"text-gray-500 hover:text-gray-700 text-xl",children:"\u2715"})]}),(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"N\xfamero de Factura *"}),(0,c.jsx)("input",{type:"text",className:"w-full border rounded px-3 py-2",value:(null===S||void 0===S?void 0:S.number)||"",onChange:e=>O({id:S.id,number:S.number,supplier:S.supplier,amount:S.amount,status:S.status,receivedDate:S.receivedDate,dueDate:S.dueDate,description:S.description,projectId:S.projectId,number:e.target.value}),placeholder:"INV-2025-XXX"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Proveedor *"}),(0,c.jsx)("input",{type:"text",className:"w-full border rounded px-3 py-2",value:(null===S||void 0===S?void 0:S.supplier)||"",onChange:e=>O((0,a.A)((0,a.A)({},S),{},{supplier:e.target.value})),placeholder:"Nombre del proveedor"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monto *"}),(0,c.jsx)("input",{type:"number",className:"w-full border rounded px-3 py-2",value:(null===S||void 0===S?void 0:S.amount)||"",onChange:e=>O((0,a.A)((0,a.A)({},S),{},{amount:Number(e.target.value)})),min:"0",step:"0.01"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estado"}),(0,c.jsxs)("select",{className:"w-full border rounded px-3 py-2",value:(null===S||void 0===S?void 0:S.status)||"pending",onChange:e=>O({id:S.id,number:S.number,supplier:S.supplier,amount:S.amount,receivedDate:S.receivedDate,dueDate:S.dueDate,description:S.description,status:e.target.value}),children:[(0,c.jsx)("option",{value:"pending",children:"Pendiente"}),(0,c.jsx)("option",{value:"paid",children:"Pagada"}),(0,c.jsx)("option",{value:"overdue",children:"Vencida"})]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha de Recepci\xf3n"}),(0,c.jsx)("input",{type:"date",className:"w-full border rounded px-3 py-2",value:(null===S||void 0===S?void 0:S.receivedDate)||"",onChange:e=>O((0,a.A)((0,a.A)({},S),{},{receivedDate:e.target.value}))})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha de Vencimiento"}),(0,c.jsx)("input",{type:"date",className:"w-full border rounded px-3 py-2",value:(null===S||void 0===S?void 0:S.dueDate)||"",onChange:e=>O((0,a.A)((0,a.A)({},S),{},{dueDate:e.target.value}))})]}),(0,c.jsxs)("div",{className:"md:col-span-2",children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripci\xf3n"}),(0,c.jsx)("textarea",{className:"w-full border rounded px-3 py-2",rows:"3",value:(null===S||void 0===S?void 0:S.description)||"",onChange:e=>O((0,a.A)((0,a.A)({},S),{},{description:e.target.value})),placeholder:"Descripci\xf3n de la factura"})]})]}),(0,c.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,c.jsx)("button",{onClick:()=>I(!1),className:"px-4 py-2 border border-gray-300 rounded text-gray-700 hover:bg-gray-50",children:"Cancelar"}),(0,c.jsx)("button",{onClick:()=>{const e=Array.isArray(j)?j:[];if(S.id){const s=e.map(e=>e.id===S.id?S:e);N(s)}else{const s={id:Date.now().toString(),number:S.number,supplier:S.supplier,amount:S.amount,dueDate:S.dueDate,description:S.description,projectId:S.projectId},t=[...e,s];N(t),q&&x&&q("invoice",s,x)}I(!1),O(null)},className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700",children:"Guardar"})]})]})})})]})}}}]);
//# sourceMappingURL=701.7e50b0d6.chunk.js.map